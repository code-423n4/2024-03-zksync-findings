## Low Findings

|    | Issue | Instances |
|----|-------|:---------:|
| [L-01] | Centralization issue caused by admin privileges | 99 |
| [L-02] | `decimals()` is not part of the ERC20 standard | 1 |
| [L-03] | Large transfers may not work with some `ERC20` tokens | 7 |
| [L-04] | `assert()` should only be used for tests | 5 |
| [L-05] | Code does not follow the best practice of check-effects-interaction | 1 |
| [L-06] | Use of `ecrecover` is susceptible to signature malleability | 1 |
| [L-07] | Initializers can be front-run | 8 |
| [L-08] | `.call` bypasses function existence check, type checking and argument packing | 1 |
| [L-09] | Prefer skip over `revert` model in loops | 2 |
| [L-10] | Unbounded loop may run out of gas | 11 |
| [L-11] | Lack of index element validation in external/public function | 70 |
| [L-12] | Consider checking that transfer to `address(this)` is disabled | 1 |
| [L-13] | Possible division by 0 is not prevented | 5 |
| [L-14] | Using Draft Contract Imports | 1 |
| [L-15] | Initializer missing `address(0)` Check before assignment | 3 |
| [L-16] | Missing checks for `address(0)` when updating state variables | 15 |
| [L-17] | Input Validation Missing in Setter Functions | 12 |
| [L-18] | File allows a version of solidity that is susceptible to .selector-related optimizer bug | 15 |
| [L-19] | Missing checks for state variable assignments | 13 |
| [L-20] | Missing checks in constructor/initialize | 8 |
| [L-21] | Mint to zero address | 1 |
| [L-22] | Owner can renounce Ownership | 5 |
| [L-23] | Numbers downcast to `address`es may result in collisions | 10 |
| [L-24] | State variables are not limited to a reasonable range | 9 |
| [L-25] | Missing contract-existence checks before low-level calls | 2 |
| [L-26] | Events may be emitted out of order due to reentrancy | 2 |
| [L-27] | External calls in an unbounded loop can result in a DoS | 20 |
| [L-28] | Critical functions should be a two step procedure | 29 |
| [L-29] | Upper Limits for Fees/Rates Should Be Implemented | 1 |
| [L-30] | `onlyOwner` functions not accessible if `owner` renounces ownership | 17 |
| [L-31] | Avoid Upcasting `address` Types and Comparing to Values Larger Than `uint160` | 1 |
| [L-32] | safeApprove is deprecated | 1 |
| [L-33] | Implement two-step ownership transfers | 6 |
| [L-34] | Loss of precision on division | 5 |
| [L-35] | Unbounded Gas Consumption on External Calls | 1 |
| [L-36] | Unsafe downcast from larger to smaller integer types | 40 |
| [L-37] | Lack of two-step update for updating protocol addresses | 11 |
| [L-38] | Missing checks for `address(0)` in constructor | 7 |
| [L-39] | Functions calling contracts with transfer hooks are missing reentrancy guards | 4 |
| [L-40] | Missing `__gap[50]` storage variable in Upgradeable contracts | 1 |
| [L-41] | Casting `block.timestamp` to Smaller Integer Types Limit Contract Lifespan | 2 |

## NonCritical Findings

|    | Issue | Instances |
|----|-------|:---------:|
| [N-01] | `internal/private` Function calls within for loops | 26 |
| [N-02] | For loops in public or external functions should be avoided due to high gas costs and possible `revert` | 4 |
| [N-03] | Function Parameters in Public Accessible Functions Need `address(0)` Check | 66 |
| [N-04] | Array indices should be referenced via `enum`s rather than via numeric literals | 41 |
| [N-05] | Consider splitting long calculations | 1 |
| [N-06] | Use custom errors instead of `require()/assert()` | 339 |
| [N-07] | Missing Event Emission After Critical Initialize() Function | 8 |
| [N-08] | Mixed usage of `int/uint` with `int256/uint256` | 1 |
| [N-09] | Avoid Hard-Coded Addresses | 2 |
| [N-10] | Variables need not be initialized to zero | 39 |
| [N-11] | Multiple Interfaces in Single File | 3 |
| [N-12] | Multiple Libraries in One File | 2 |
| [N-13] | `require()/revert()` statements without reason strings | 5 |
| [N-14] | Multiple `address`/ID mappings can be combined into a single `mapping` of an `address`/ID to a `struct`, for readability | 23 |
| [N-15] | Consider returning a `struct` rather than having multiple `return` values | 5 |
| [N-16] | Consider using a `struct` rather than having many function input parameters | 35 |
| [N-17] | Prefer Custom Errors Over Unnamed `revert()` | 14 |
| [N-18] | Simplify complex require statements | 3 |
| [N-19] | Consider using descriptive `constant`s when passing zero as a function argument | 20 |
| [N-20] | Avoid Empty Blocks in Code | 8 |
| [N-21] | File with Library declaration Shoulde contain only Library | 4 |
| [N-22] | Consider Using Parameters in Events | 2 |
| [N-23] | Consider using OpenZeppelin's SafeCast for any casting | 255 |
| [N-24] | `uint/int` variables should have the bit size defined explicitly | 1 |
| [N-25] | Consider using `delete` rather than assigning `false` to clear values | 3 |
| [N-26] | Consider using `delete` rather than assigning `zero` to clear values | 3 |
| [N-27] | Avoid external calls in modifiers | 5 |
| [N-28] | Consider emitting an event at the end of the constructor | 10 |
| [N-29] | Consider moving duplicated strings to constants | 14 |
| [N-30] | Consider using named returns | 147 |
| [N-31] | Style guide: Initialisms should be capitalized | 144 |
| [N-32] | Expressions for constant values should use `immutable` rather than `constant` | 108 |
| [N-33] | Consider using named function arguments | 87 |
| [N-34] | Assembly block creates dirty bits | 5 |
| [N-35] | Contract/Library Names Not in `CapWords` Style (CamelCase) | 5 |
| [N-36] | Events are missing sender information | 50 |
| [N-37] | Leverage Recent Solidity Features with `0.8.23` | 106 |
| [N-38] | NatSpec: Function `@param` tag is missing | 195 |
| [N-39] | Consider Using OpenZeppelin's ReentrancyGuard Instead of Custom Implementation | 1 |
| [N-40] | High cyclomatic complexity | 2 |
| [N-41] | NatSpec: Function declarations should have descriptions | 209 |
| [N-42] | Contract uses both `require()`/`revert()` as well as custom errors | 1 |
| [N-43] | Modifiers Missing NatSpec `@param` Tag | 5 |
| [N-44] | Inconsistent spacing in comments | 2590 |
| [N-45] | Critical system parameter changes should be behind a timelock | 29 |
| [N-46] | Outdated Solidity Version | 106 |
| [N-47] | Library Should be in a Separate File | 7 |
| [N-48] | Ensure Non-Empty Check for Bytes in Function Parameters | 159 |
| [N-49] | Adding a `return` statement when the function defines a named return variable, is redundant | 1 |
| [N-50] | Assembly blocks should have extensive comments | 69 |
| [N-51] | Use `bytes.concat()` instead of `abi.encodePacked()` | 16 |
| [N-52] | Function/Constructor Argument Names Not in mixedCase | 374 |
| [N-53] | NatSpec: Function `@return` tag is missing | 129 |
| [N-54] | State-Altering Functions Should Emit Events | 21 |
| [N-55] | Upgrade `openzeppelin` to the Latest Version - 5.0.0 | 22 |
| [N-56] | Interface Names Should Begin with a Capital `I` | 1 |
| [N-57] | Duplicated `require()`/`revert()` checks should be refactored to a modifier or function | 7 |
| [N-58] | Non-specific Imports | 41 |
| [N-59] | Event is not properly `indexed` | 42 |
| [N-60] | Consider Adding Emergency-Stop Functionality | 35 |
| [N-61] | Missing NatSpec Descriptions for Modifier Declarations | 11 |
| [N-62] | `constant` variables not using all capital letters | 7 |
| [N-63] | Consider adding a block/deny-list | 4 |
| [N-64] | Non-uppercase/Constant-case Naming for `immutable` Variables | 6 |
| [N-65] | Not using the named return variables anywhere in the function is confusing | 3 |
| [N-66] | Function Names Not in mixedCase | 12 |
| [N-67] | Insufficient Comments in Complex Functions | 16 |
| [N-68] | Common functions should be refactored to a common base contract | 46 |
| [N-69] | NatSpec: Non-public state variable declarations should use `@dev` tags | 46 |
| [N-70] | `constant`s should be defined rather than using magic numbers | 122 |
| [N-71] | `require()`/`revert()` statements should have descriptive reason strings | 146 |
| [N-72] | Variable Names Not in mixedCase | 12 |
| [N-73] | Consider moving `msg.sender` checks to a common authorization `modifier` | 14 |
| [N-74] | NatSpec: Contract declarations should have descriptions | 23 |
| [N-75] | NatSpec: Contract declarations should have `@author` tag | 25 |
| [N-76] | Style guide: Non-`external`/`public` function names should begin with an underscore | 109 |
| [N-77] | Missing NatSpec Descriptions for Event Declarations | 29 |
| [N-78] | Unused Function Parameters | 4 |
| [N-79] | Consider defining system-wide constants in a single file | 9 |
| [N-80] | Add inline comments for unnamed variables | 18 |
| [N-81] | Consider making contracts `Upgradeable` | 38 |
| [N-82] | Events that mark critical parameter changes should contain both the old and the new value | 6 |
| [N-83] | Style guide: Non-`external`/`public` variable names should begin with an underscore | 204 |
| [N-84] | Use type(uint<n>).max instead of 2**<n> - 1 | 1 |
| [N-85] | Style guide: Contract does not follow the Solidity style guide's suggested layout ordering | 12 |
| [N-86] | Style guide: Control structures do not follow the Solidity Style Guide | 3 |
| [N-87] | Using Low-Level Call for Transfers | 1 |
| [N-88] | Consider bounding input array length | 9 |
| [N-89] | NatSpec: Function declarations should have `@notice` tag | 285 |
| [N-90] | Constants in comparisons should appear on the left side | 156 |
| [N-91] | NatSpec: Contract declarations should have `@notice` tag | 54 |
| [N-92] | Large numeric literals should use underscores for readability | 7 |
| [N-93] | Named Imports of Parent Contracts Are Missing | 5 |
| [N-94] | Long functions should be refactored into multiple, smaller, functions | 16 |
| [N-95] | NatSpec: Contract declarations should have `@dev` tags | 70 |
| [N-96] | The nonReentrant modifier should occur before all other modifiers | 2 |
| [N-97] | `public` functions not called by the contract should be declared `external` instead | 11 |
| [N-98] | Large multiples of ten should use scientific notation | 1 |
| [N-99] | Prefer Casting to `bytes` or `bytes32` Over `abi.encodePacked()` for Single Arguments | 1 |
| [N-100] | Complex casting | 101 |
| [N-101] | Unused Event Declarations | 3 |
| [N-102] | Non-assembly High-Level Solidity Functions Available | 7 |
| [N-103] | Equal `block.timestamp` Cases Not Handled | 1 |
| [N-104] | `else`-block not required | 2 |
| [N-105] | Polymorphic functions make security audits more time-consuming and error-prone | 4 |
| [N-106] | Style guide: Function ordering does not follow the Solidity style guide | 88 |
| [N-107] | Style guide: Lines are too long | 171 |
| [N-108] | Style guide: Extraneous whitespace | 16 |
| [N-109] | Contract/Libraries Names Do Not Match Their Filenames | 5 |
| [N-110] | Avoid the use of sensitive terms | 65 |
| [N-111] | Unused import | 40 |
| [N-112] | `if`-statement can be converted to a ternary | 5 |
| [N-113] | Unused Structs Declaration | 1 |
| [N-114] | Consider using named mappings | 11 |
| [N-115] | Use of `override` is unnecessary | 54 |
| [N-116] | Setters should prevent re-setting of the same value | 22 |
| [N-117] | NatSpec: Contract declarations should have `@title` tags | 83 |
| [N-118] | Use Unchecked for Divisions on Constant or Immutable Values | 3 |
| [N-119] | Explicit Visibility Recommended in Variable/Function Definitions | 163 |
| [N-120] | Open TODOs | 2 |
| [N-121] | Contracts should have full test coverage | 1 |
| [N-122] | Large or complicated code bases should implement invariant tests | 1 |
| [N-123] | Implement Formal Verification Proofs to Improve Security | 1 |

## Low Findings Details

### [L-01] Centralization issue caused by admin privileges

There are priviliged roles that are a single point of failure, who can use critical functions, posing a centralization issue.

<details>
<summary><i>99 issue instances in 19 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

116: function transferFundsFromLegacy(address _token, address _target, uint256 _targetChainId) external onlyOwner
142: function initializeChainGovernance(uint256 _chainId, address _l2BridgeAddress) external onlyOwner
148: function bridgehubDepositBaseToken(
        uint256 _chainId,
        address _prevMsgSender,
        address _l1Token,
        uint256 _amount
    ) external payable virtual onlyBridgehubOrEra(_chainId)
182: function bridgehubDeposit(
        uint256 _chainId,
        address _prevMsgSender,
        uint256, // l2Value, needed for Weth deposits in the future
        bytes calldata _data
    ) external payable override onlyBridgehub returns (L2TransactionRequestTwoBridgesInner memory request)
232: function bridgehubConfirmL2Transaction(
        uint256 _chainId,
        bytes32 _txDataHash,
        bytes32 _txHash
    ) external override onlyBridgehub
554: function depositLegacyErc20Bridge(
        address _prevMsgSender,
        address _l2Receiver,
        address _l1Token,
        uint256 _amount,
        uint256 _l2TxGasLimit,
        uint256 _l2TxGasPerPubdataByte,
        address _refundRecipient
    ) external payable override onlyLegacyBridge nonReentrant returns (bytes32 l2TxHash)
615: function finalizeWithdrawalLegacyErc20Bridge(
        uint256 _l2BatchNumber,
        uint256 _l2MessageIndex,
        uint16 _l2TxNumberInBatch,
        bytes calldata _message,
        bytes32[] calldata _merkleProof
    ) external override onlyLegacyBridge returns (address l1Receiver, address l1Token, uint256 amount)
644: function claimFailedDepositLegacyErc20Bridge(
        address _depositSender,
        address _l1Token,
        uint256 _amount,
        bytes32 _l2TxHash,
        uint256 _l2BatchNumber,
        uint256 _l2MessageIndex,
        uint16 _l2TxNumberInBatch,
        bytes32[] calldata _merkleProof
    ) external override onlyLegacyBridge
```
[116](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L116) | [142](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L142) | [148](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L148) | [182](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L182) | [232](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L232) | [554](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L554) | [615](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L615) | [644](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L644)

```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

51: function setPendingAdmin(address _newPendingAdmin) external onlyOwnerOrAdmin
82: function addStateTransitionManager(address _stateTransitionManager) external onlyOwner
92: function removeStateTransitionManager(address _stateTransitionManager) external onlyOwner
101: function addToken(address _token) external onlyOwner
108: function setSharedBridge(address _sharedBridge) external onlyOwner
114: function createNewChain(
        uint256 _chainId,
        address _stateTransitionManager,
        address _baseToken,
        uint256, //_salt
        address _admin,
        bytes calldata _initData
    ) external onlyOwnerOrAdmin nonReentrant returns (uint256 chainId)
```
[51](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L51) | [82](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L82) | [92](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L92) | [101](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L101) | [108](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L108) | [114](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L114)

```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

129: function scheduleTransparent(Operation calldata _operation, uint256 _delay) external onlyOwner
142: function scheduleShadow(bytes32 _id, uint256 _delay) external onlyOwner
154: function cancel(bytes32 _id) external onlyOwner
167: function execute(Operation calldata _operation) external payable onlyOwnerOrSecurityCouncil
186: function executeInstant(Operation calldata _operation) external payable onlySecurityCouncil
249: function updateDelay(uint256 _newDelay) external onlySelf
256: function updateSecurityCouncil(address _newSecurityCouncil) external onlySelf
```
[129](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L129) | [142](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L142) | [154](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L154) | [167](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L167) | [186](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L186) | [249](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L249) | [256](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L256)

```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

110: function setPendingAdmin(address _newPendingAdmin) external onlyOwnerOrAdmin
132: function setValidatorTimelock(address _validatorTimelock) external onlyOwnerOrAdmin
137: function setInitialCutHash(Diamond.DiamondCutData calldata _diamondCut) external onlyOwner
142: function setNewVersionUpgrade(
        Diamond.DiamondCutData calldata _cutData,
        uint256 _oldProtocolVersion,
        uint256 _newProtocolVersion
    ) external onlyOwner
152: function setUpgradeDiamondCut(
        Diamond.DiamondCutData calldata _cutData,
        uint256 _oldProtocolVersion
    ) external onlyOwner
160: function freezeChain(uint256 _chainId) external onlyOwner
165: function unfreezeChain(uint256 _chainId) external onlyOwner
170: function revertBatches(uint256 _chainId, uint256 _newLastBatch) external onlyOwnerOrAdmin
230: function registerAlreadyDeployedStateTransition(
        uint256 _chainId,
        address _stateTransitionContract
    ) external onlyOwner
239: function createNewChain(
        uint256 _chainId,
        address _baseToken,
        address _sharedBridge,
        address _admin,
        bytes calldata _diamondCut
    ) external onlyBridgehub
```
[110](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L110) | [132](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L132) | [137](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L137) | [142](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L142) | [152](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L152) | [160](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L160) | [165](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L165) | [170](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L170) | [230](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L230) | [239](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L239)

```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

73: function setStateTransitionManager(IStateTransitionManager _stateTransitionManager) external onlyOwner
78: function addValidator(uint256 _chainId, address _newValidator) external onlyChainAdmin(_chainId)
87: function removeValidator(uint256 _chainId, address _validator) external onlyChainAdmin(_chainId)
96: function setExecutionDelay(uint32 _executionDelay) external onlyOwner
108: function commitBatches(
        StoredBatchInfo calldata,
        CommitBatchInfo[] calldata _newBatchesData
    ) external onlyValidator(ERA_CHAIN_ID)
126: function commitBatchesSharedBridge(
        uint256 _chainId,
        StoredBatchInfo calldata,
        CommitBatchInfo[] calldata _newBatchesData
    ) external onlyValidator(_chainId)
146: function revertBatches(uint256) external onlyValidator(ERA_CHAIN_ID)
153: function revertBatchesSharedBridge(uint256 _chainId, uint256) external onlyValidator(_chainId)
160: function proveBatches(
        StoredBatchInfo calldata,
        StoredBatchInfo[] calldata,
        ProofInput calldata
    ) external onlyValidator(ERA_CHAIN_ID)
171: function proveBatchesSharedBridge(
        uint256 _chainId,
        StoredBatchInfo calldata,
        StoredBatchInfo[] calldata,
        ProofInput calldata
    ) external onlyValidator(_chainId)
182: function executeBatches(StoredBatchInfo[] calldata _newBatchesData) external onlyValidator(ERA_CHAIN_ID)
203: function executeBatchesSharedBridge(
        uint256 _chainId,
        StoredBatchInfo[] calldata _newBatchesData
    ) external onlyValidator(_chainId)
```
[73](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L73) | [78](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L78) | [87](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L87) | [96](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L96) | [108](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L108) | [126](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L126) | [146](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L146) | [153](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L153) | [160](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L160) | [171](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L171) | [182](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L182) | [203](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L203)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol

23: function setPendingAdmin(address _newPendingAdmin) external onlyAdmin
45: function setValidator(address _validator, bool _active) external onlyStateTransitionManager
51: function setPorterAvailability(bool _zkPorterIsAvailable) external onlyStateTransitionManager
58: function setPriorityTxMaxGasLimit(uint256 _newPriorityTxMaxGasLimit) external onlyStateTransitionManager
67: function changeFeeParams(FeeParams calldata _newFeeParams) external onlyAdminOrStateTransitionManager
79: function setTokenMultiplier(uint128 _nominator, uint128 _denominator) external onlyAdminOrStateTransitionManager
89: function setValidiumMode(PubdataPricingMode _validiumMode) external onlyAdmin
100: function upgradeChainFromVersion(
        uint256 _oldProtocolVersion,
        Diamond.DiamondCutData calldata _diamondCut
    ) external onlyAdminOrStateTransitionManager
123: function executeUpgrade(Diamond.DiamondCutData calldata _diamondCut) external onlyStateTransitionManager
133: function freezeDiamond() external onlyAdminOrStateTransitionManager
143: function unfreezeDiamond() external onlyAdminOrStateTransitionManager
```
[23](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L23) | [45](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L45) | [51](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L51) | [58](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L58) | [67](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L67) | [79](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L79) | [89](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L89) | [100](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L100) | [123](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L123) | [133](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L133) | [143](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L143)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

199: function commitBatches(
        StoredBatchInfo memory _lastCommittedBatchData,
        CommitBatchInfo[] calldata _newBatchesData
    ) external nonReentrant onlyValidator
207: function commitBatchesSharedBridge(
        uint256, // _chainId
        StoredBatchInfo memory _lastCommittedBatchData,
        CommitBatchInfo[] calldata _newBatchesData
    ) external nonReentrant onlyValidator
337: function executeBatchesSharedBridge(
        uint256,
        StoredBatchInfo[] calldata _batchesData
    ) external nonReentrant onlyValidator
345: function executeBatches(StoredBatchInfo[] calldata _batchesData) external nonReentrant onlyValidator
368: function proveBatches(
        StoredBatchInfo calldata _prevBatch,
        StoredBatchInfo[] calldata _committedBatches,
        ProofInput calldata _proof
    ) external nonReentrant onlyValidator
377: function proveBatchesSharedBridge(
        uint256, // _chainId
        StoredBatchInfo calldata _prevBatch,
        StoredBatchInfo[] calldata _committedBatches,
        ProofInput calldata _proof
    ) external nonReentrant onlyValidator
472: function revertBatches(uint256 _newLastBatch) external nonReentrant onlyValidatorOrStateTransitionManager
477: function revertBatchesSharedBridge(uint256, uint256 _newLastBatch) external nonReentrant onlyValidator
```
[199](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L199) | [207](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L207) | [337](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L337) | [345](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L345) | [368](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L368) | [377](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L377) | [472](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L472) | [477](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L477)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

38: function transferEthToSharedBridge() external onlyBaseTokenBridge
47: function bridgehubRequestL2Transaction(
        BridgehubL2TransactionRequest memory _request
    ) external payable onlyBridgehub returns (bytes32 canonicalTxHash)
```
[38](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L38) | [47](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L47)

```solidity
File: code/system-contracts/contracts/AccountCodeStorage.sol

35: function storeAccountConstructingCodeHash(address _address, bytes32 _hash) external override onlyDeployer
46: function storeAccountConstructedCodeHash(address _address, bytes32 _hash) external override onlyDeployer
54: function markAccountCodeHashAsConstructed(address _address) external override onlyDeployer
```
[35](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/AccountCodeStorage.sol#L35) | [46](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/AccountCodeStorage.sol#L46) | [54](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/AccountCodeStorage.sol#L54)

```solidity
File: code/system-contracts/contracts/Compressor.sol

44: function publishCompressedBytecode(
        bytes calldata _bytecode,
        bytes calldata _rawCompressedData
    ) external payable onlyCallFromBootloader returns (bytes32 bytecodeHash)
110: function verifyCompressedStateDiffs(
        uint256 _numberOfStateDiffs,
        uint256 _enumerationIndexSize,
        bytes calldata _stateDiffs,
        bytes calldata _compressedStateDiffs
    ) external payable onlyCallFrom(address(L1_MESSENGER_CONTRACT)) returns (bytes32 stateDiffHash)
```
[44](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L44) | [110](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L110)

```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

65: function updateAccountVersion(AccountAbstractionVersion _version) external onlySystemCall
74: function updateNonceOrdering(AccountNonceOrdering _nonceOrdering) external onlySystemCall
162: function create2Account(
        bytes32 _salt,
        bytes32 _bytecodeHash,
        bytes calldata _input,
        AccountAbstractionVersion _aaVersion
    ) public payable override onlySystemCall returns (address)
182: function createAccount(
        bytes32, // salt
        bytes32 _bytecodeHash,
        bytes calldata _input,
        AccountAbstractionVersion _aaVersion
    ) public payable override onlySystemCall returns (address)
213: function forceDeployOnAddress(ForceDeployment calldata _deployment, address _sender) external payable onlySelf
```
[65](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L65) | [74](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L74) | [162](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L162) | [182](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L182) | [213](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L213)

```solidity
File: code/system-contracts/contracts/KnownCodesStorage.sol

27: function markFactoryDeps(bool _shouldSendToL1, bytes32[] calldata _hashes) external onlyCallFromBootloader
39: function markBytecodeAsPublished(bytes32 _bytecodeHash) external onlyCompressor
```
[27](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/KnownCodesStorage.sol#L27) | [39](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/KnownCodesStorage.sol#L39)

```solidity
File: code/system-contracts/contracts/L1Messenger.sol

70: function sendL2ToL1Log(
        bool _isService,
        bytes32 _key,
        bytes32 _value
    ) external onlyCallFromSystemContract returns (uint256 logIdInMerkleTree)
161: function requestBytecodeL1Publication(
        bytes32 _bytecodeHash
    ) external override onlyCallFrom(address(KNOWN_CODE_STORAGE_CONTRACT))
194: function publishPubdataAndClearState(
        bytes calldata _totalL2ToL1PubdataAndStateDiffs
    ) external onlyCallFromBootloader
```
[70](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L70) | [161](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L161) | [194](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L194)

```solidity
File: code/system-contracts/contracts/L2BaseToken.sol

64: function mint(address _account, uint256 _amount) external override onlyCallFromBootloader
```
[64](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L2BaseToken.sol#L64)

```solidity
File: code/system-contracts/contracts/MsgValueSimulator.sol

47: fallback(bytes calldata _data) external onlySystemCall returns (bytes memory)
```
[47](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/MsgValueSimulator.sol#L47)

```solidity
File: code/system-contracts/contracts/NonceHolder.sol

65: function increaseMinNonce(uint256 _value) public onlySystemCall returns (uint256 oldMinNonce)
82: function setValueUnderNonce(uint256 _key, uint256 _value) public onlySystemCall
110: function incrementMinNonceIfEquals(uint256 _expectedNonce) external onlySystemCall
```
[65](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L65) | [82](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L82) | [110](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L110)

```solidity
File: code/system-contracts/contracts/PubdataChunkPublisher.sol

21: function chunkAndPublishPubdata(bytes calldata _pubdata) external onlyCallFrom(address(L1_MESSENGER_CONTRACT))
```
[21](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/PubdataChunkPublisher.sol#L21)

```solidity
File: code/system-contracts/contracts/SystemContext.sol

84: function setChainId(uint256 _newChainId) external onlyCallFromForceDeployer
99: function setTxOrigin(address _newOrigin) external onlyCallFromBootloader
105: function setGasPrice(uint256 _gasPrice) external onlyCallFromBootloader
112: function setPubdataInfo(uint256 _gasPerPubdataByte, uint256 _basePubdataSpent) external onlyCallFromBootloader
341: function setL2Block(
        uint128 _l2BlockNumber,
        uint128 _l2BlockTimestamp,
        bytes32 _expectedPrevL2BlockHash,
        bool _isFirstInBatch,
        uint128 _maxVirtualBlocksToCreate
    ) external onlyCallFromBootloader
402: function appendTransactionToCurrentL2Block(bytes32 _txHash) external onlyCallFromBootloader
408: function publishTimestampDataToL1() external onlyCallFromBootloader
444: function setNewBatch(
        bytes32 _prevBatchHash,
        uint128 _newTimestamp,
        uint128 _expectedNewNumber,
        uint256 _baseFee
    ) external onlyCallFromBootloader
471: function unsafeOverrideBatch(
        uint256 _newTimestamp,
        uint256 _number,
        uint256 _baseFee
    ) external onlyCallFromBootloader
482: function incrementTxNumberInBatch() external onlyCallFromBootloader
486: function resetTxNumberInBatch() external onlyCallFromBootloader
```
[84](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L84) | [99](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L99) | [105](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L105) | [112](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L112) | [341](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L341) | [402](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L402) | [408](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L408) | [444](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L444) | [471](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L471) | [482](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L482) | [486](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L486)

```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

111: function reinitializeToken(
        ERC20Getters calldata _availableGetters,
        string memory _newName,
        string memory _newSymbol,
        uint8 _version
    ) external onlyNextVersion(_version) reinitializer(_version)
145: function bridgeMint(address _to, uint256 _amount) external override onlyBridge
154: function bridgeBurn(address _from, uint256 _amount) external override onlyBridge
```
[111](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L111) | [145](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L145) | [154](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L154)
</details>

### [L-02] `decimals()` is not part of the ERC20 standard

The `decimals` function is not part of the `ERC20` standard, and they may revert with some tokens if the don't also extend the `IERC20Metadata` interface.

<details>
<summary><i>1 issue instances in 1 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

264: (, bytes memory data3) = _token.staticcall(abi.encodeCall(IERC20Metadata.decimals, ()));
```
[264](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L264)
</details>

### [L-03] Large transfers may not work with some `ERC20` tokens

Some `IERC20` implementations (e.g `UNI`, `COMP`)
            
- [COMP (Compound Protocol)](https://github.com/compound-finance/compound-protocol/blob/a3214f67b73310d547e00fc578e8355911c9d376/contracts/Governance/Comp.sol#L115-L142)
- [UNI (Uniswap)](https://github.com/Uniswap/governance/blob/eabd8c71ad01f61fb54ed6945162021ee419998e/contracts/Uni.sol#L209-L236)
            
may fail if the valued `transferred` is larger than `uint96`.

<details>
<summary><i>7 issue instances in 3 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

67: IERC20(_token).safeTransfer(address(sharedBridge), amount)
162: _token.safeTransferFrom(_from, address(sharedBridge), _amount)
```
[67](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L67) | [162](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L162)

```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

67: IERC20(_token).safeTransfer(address(sharedBridge), amount)
162: _token.safeTransferFrom(_from, address(sharedBridge), _amount)
```
[67](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L67) | [162](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L162)

```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

175: _token.safeTransferFrom(_from, address(this), _amount)
362: IERC20(_l1Token).safeTransfer(_depositSender, _amount)
452: IERC20(l1Token).safeTransfer(l1Receiver, amount)
```
[175](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L175) | [362](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L362) | [452](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L452)
</details>

### [L-04] `assert()` should only be used for tests

From (documentation)[https://docs.soliditylang.org/en/v0.8.20/control-structures.html#panic-via-assert-and-error-via-require]:
```text
The assert function creates an error of type Panic(uint256). The same error is created by the compiler in certain situations as listed below.
Assert should only be used to test for internal errors, and to check invariants. Properly functioning code should never create a Panic, not even on invalid external input. If this happens, then there is a bug in your contract which you should fix. Language analysis tools can evaluate your contract to identify the conditions and function calls which will cause a Panic.
```

<details>
<summary><i>5 issue instances in 5 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

106: assert(L2_TO_L1_LOG_SERIALIZE_SIZE != 2 * 32)
```
[106](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L106)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol

51: assert(L2_TO_L1_LOG_SERIALIZE_SIZE != 2 * 32)
```
[51](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol#L51)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

426: assert(block.chainid != 1)
```
[426](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L426)

```solidity
File: code/system-contracts/contracts/DefaultAccount.sol

222: assert(msg.sender != BOOTLOADER_FORMAL_ADDRESS)
```
[222](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L222)

```solidity
File: code/system-contracts/contracts/libraries/RLPEncoder.sol

50: assert(_len != 1)
```
[50](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/RLPEncoder.sol#L50)
</details>

### [L-05] Code does not follow the best practice of check-effects-interaction

Code should follow the best-practice of [CEI](https://blockchain-academy.hs-mittweida.de/courses/solidity-coding-beginners-to-intermediate/lessons/solidity-11-coding-patterns/topic/checks-effects-interactions/), where state variables are updated before any external calls are made. Doing so prevents a large class of reentrancy bugs.

<details>
<summary><i>1 issue instances in 1 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

/// @audit - State change after external call: `IMailbox(_target).transferEthToSharedBridge()`
122: chainBalance[_targetChainId][ETH_TOKEN_ADDRESS] =
                chainBalance[_targetChainId][ETH_TOKEN_ADDRESS] +
                balanceAfter -
                balanceBefore
```
[122](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L122)
</details>

### [L-06] Use of `ecrecover` is susceptible to signature malleability

The built-in EVM precompile ecrecover is susceptible to signature malleability, which could lead to replay attacks.
References: https://swcregistry.io/docs/SWC-117, https://swcregistry.io/docs/SWC-121.
While this is not immediately exploitable, this may become a vulnerability if used elsewhere.
[Consider using OpenZeppelin’s ECDSA library](https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/utils/cryptography/ECDSA.sol) (which prevents this malleability) instead of the built-in function.

<details>
<summary><i>1 issue instances in 1 files:</i></summary>

```solidity
File: code/system-contracts/contracts/DefaultAccount.sol

186: ecrecover(_hash, v, r, s)
```
[186](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L186)
</details>

### [L-07] Initializers can be front-run

Initializers could be vulnerable to front-running attacks.
This might allow an attacker to set their own values, take ownership of the contract, or force a redeployment in the best-case scenario.
Be cautious of potential front-running risks in the following instances found in the code.

<details>
<summary><i>8 issue instances in 8 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

60: function initialize() external reentrancyGuardInitializer
```
[60](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L60)

```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

60: function initialize() external reentrancyGuardInitializer
```
[60](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L60)

```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

104: function initialize(
        address _owner,
        uint256 _eraFirstPostUpgradeBatch
    ) external reentrancyGuardInitializer initializer
```
[104](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L104)

```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

41: function initialize(address _owner) external reentrancyGuardInitializer
```
[41](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L41)

```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

79: function initialize(
        StateTransitionManagerInitializeData calldata _initializeData
    ) external reentrancyGuardInitializer
```
[79](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L79)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol

24: function initialize(InitializeData calldata _initializeData) external reentrancyGuardInitializer returns (bytes32)
```
[24](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol#L24)

```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

49: function initialize(
        address _l1Bridge,
        address _l1LegecyBridge,
        bytes32 _l2TokenProxyBytecodeHash,
        address _aliasedOwner
    ) external reinitializer(2)
```
[49](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L49)

```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

50: function bridgeInitialize(address _l1Address, bytes memory _data) external initializer
```
[50](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L50)
</details>

### [L-08] `.call` bypasses function existence check, type checking and argument packing

Using the `.call` method in Solidity enables direct communication with an address, bypassing function existence checks, type checking, and argument packing.
While this can save gas and provide flexibility, it can also introduce security risks and potential errors. The absence of these checks can lead to unexpected behavior if the callee contract's interface changes or if the input parameters are not crafted with care.
The resolution to these issues is to use Solidity's high-level interface for calling functions when possible, as it automatically manages these aspects.
If using `.call` is necessary, ensure that the inputs are carefully validated and that awareness of the called contract's behavior is maintained.

<details>
<summary><i>1 issue instances in 1 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

226: _calls[i].target.call{value: _calls[i].value}(_calls[i].data)
```
[226](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L226)
</details>

### [L-09] Prefer skip over `revert` model in loops

When dealing with array operations in Solidity, it's often wiser to opt for skipping over reverting.
Instead of halting the entire transaction when a condition isn't met, suggests simply moving on to the next array index.
The reason behind this choice is to reduce the risk of malicious actors intentionally introducing array objects that fail conditional checks within loops, causing group operations to fail.
Unless there's a compelling security or logical justification for reverting, it's recommended to embrace the skip-over approach for a more robust codebase.

<details>
<summary><i>2 issue instances in 2 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

184: revert("ul")
```
[184](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L184)

```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol

116: revert("C")
```
[116](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L116)
</details>

### [L-10] Unbounded loop may run out of gas

Unbounded loops in smart contracts pose a risk because they iterate over an unknown number of elements, potentially consuming all available gas for a transaction.
This can result in unintended transaction failures. Gas consumption increases linearly with the number of iterations, and if it surpasses the gas limit, the transaction reverts, wasting the gas spent.
To mitigate this, developers should either set a maximum limit on loop iterations.

<details>
<summary><i>11 issue instances in 5 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

225: for (uint256 i = 0; i < _calls.length; ++i)
```
[225](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L225)

```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

116: for (uint256 i = 0; i < _newBatchesData.length; ++i)
135: for (uint256 i = 0; i < _newBatchesData.length; ++i)
185: for (uint256 i = 0; i < _newBatchesData.length; ++i)
209: for (uint256 i = 0; i < _newBatchesData.length; ++i)
```
[116](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L116) | [135](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L135) | [185](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L185) | [209](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L209)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

142: for (uint256 i = 0; i < emittedL2Logs.length; i = i.uncheckedAdd(L2_TO_L1_LOG_SERIALIZE_SIZE))
257: for (uint256 i = 0; i < _newBatchesData.length; i = i.uncheckedInc())
289: for (uint256 i = 0; i < _newBatchesData.length; i = i.uncheckedInc())
636: for (uint256 i = 0; i < _pubdataCommitments.length; i += PUBDATA_COMMITMENT_SIZE)
```
[142](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L142) | [257](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L257) | [289](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L289) | [636](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L636)

```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol

226: for (uint256 i = 0; i < _factoryDeps.length; ++i)
```
[226](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L226)

```solidity
File: code/system-contracts/contracts/Compressor.sol

61: for (uint256 encodedDataPointer = 0; encodedDataPointer < encodedData.length; encodedDataPointer += 2)
```
[61](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L61)
</details>

### [L-11] Lack of index element validation in external/public function

There's no validation to check whether the index element provided as an argument actually exists in the call. This omission could lead to unintended behavior if an element that does not exist in the call is passed to the function.

The function should validate that the provided index element exists in the call before proceeding.

Without this validation, the function could cause unintended behaviour as it will call an non-existing index element. This could lead to inconsistencies in data and potentially affect the integrity of the call structure.

<details>
<summary><i>70 issue instances in 15 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

154: depositAmount[msg.sender][_l1Token]
185: depositAmount[_depositSender][_l1Token][_l2TxHash]
185: depositAmount[_depositSender][_l1Token]
185: depositAmount[_depositSender]
187: depositAmount[_depositSender][_l1Token][_l2TxHash]
187: depositAmount[_depositSender][_l1Token]
187: depositAmount[_depositSender]
```
[154](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L154) | [185](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L185) | [185](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L185) | [185](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L185) | [187](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L187) | [187](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L187) | [187](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L187)

```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

154: depositAmount[msg.sender][_l1Token]
185: depositAmount[_depositSender][_l1Token][_l2TxHash]
185: depositAmount[_depositSender][_l1Token]
185: depositAmount[_depositSender]
187: depositAmount[_depositSender][_l1Token][_l2TxHash]
187: depositAmount[_depositSender][_l1Token]
187: depositAmount[_depositSender]
```
[154](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L154) | [185](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L185) | [185](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L185) | [185](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L185) | [187](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L187) | [187](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L187) | [187](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L187)

```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

122: chainBalance[_targetChainId]
123: chainBalance[_targetChainId]
133: chainBalance[_targetChainId][_token]
133: chainBalance[_targetChainId]
133: chainBalance[_targetChainId][_token]
133: chainBalance[_targetChainId]
143: l2BridgeAddress[_chainId]
164: hyperbridgingEnabled[_chainId]
165: chainBalance[_chainId][_l1Token]
165: chainBalance[_chainId]
```
[122](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L122) | [123](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L123) | [133](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L133) | [133](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L133) | [133](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L133) | [133](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L133) | [143](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L143) | [164](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L164) | [165](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L165) | [165](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L165)

```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

76: stateTransitionManager[_chainId]
```
[76](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L76)

```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

106: timestamps[_id]
```
[106](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L106)

```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

75: stateTransition[_chainId]
147: upgradeCutHash[_oldProtocolVersion]
156: upgradeCutHash[_oldProtocolVersion]
161: stateTransition[_chainId]
166: stateTransition[_chainId]
171: stateTransition[_chainId]
234: stateTransition[_chainId]
246: stateTransition[_chainId]
282: stateTransition[_chainId]
```
[75](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L75) | [147](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L147) | [156](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L156) | [161](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L161) | [166](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L166) | [171](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L171) | [234](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L234) | [246](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L246) | [282](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L282)

```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

79: validators[_chainId][_newValidator]
79: validators[_chainId]
82: validators[_chainId][_newValidator]
82: validators[_chainId]
88: validators[_chainId][_validator]
88: validators[_chainId]
91: validators[_chainId][_validator]
91: validators[_chainId]
103: committedBatchTimestamp[_chainId]
136: committedBatchTimestamp[_chainId]
210: committedBatchTimestamp[_chainId]
```
[79](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L79) | [79](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L79) | [82](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L82) | [82](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L82) | [88](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L88) | [88](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L88) | [91](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L91) | [91](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L91) | [103](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L103) | [136](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L136) | [210](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L210)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol

46: s.validators[_validator]
```
[46](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L46)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol

113: s.validators[_address]
118: s.l2LogsRootHashes[_batchNumber]
123: s.storedBatchHashes[_batchNumber]
168: ds.facetToSelectors[_facet]
170: ds.facetToSelectors[_facet]
189: s.isEthWithdrawalFinalized[_l2BatchNumber][_l2MessageIndex]
189: s.isEthWithdrawalFinalized[_l2BatchNumber]
219: ds.facetToSelectors[_facet]
231: ds.selectorToFacet[_selector]
255: s.storedBatchHashes[_batchNumber]
```
[113](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L113) | [118](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L118) | [123](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L123) | [168](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L168) | [170](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L170) | [189](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L189) | [189](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L189) | [219](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L219) | [231](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L231) | [255](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L255)

```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

35: accountInfo[_address]
41: accountInfo[_address]
```
[35](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L35) | [41](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L41)

```solidity
File: code/system-contracts/contracts/ImmutableSimulator.sol

28: immutableDataStorage[uint256(uint160(_dest))][_index]
```
[28](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ImmutableSimulator.sol#L28)

```solidity
File: code/system-contracts/contracts/L2BaseToken.sol

40: balance[_from]
43: balance[_from]
46: balance[_to]
66: balance[_account]
```
[40](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L2BaseToken.sol#L40) | [43](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L2BaseToken.sol#L43) | [46](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L2BaseToken.sol#L46) | [66](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L2BaseToken.sol#L66)

```solidity
File: code/system-contracts/contracts/NonceHolder.sol

104: nonceValues[addressAsKey][_key]
156: nonceValues[addressAsKey][_nonce]
```
[104](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L104) | [156](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L156)

```solidity
File: code/system-contracts/contracts/SystemContext.sol

149: batchHashes[_block]
167: batchHashes[_batchNumber]
510: batchHashes[_blockNumber]
```
[149](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L149) | [167](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L167) | [510](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L510)

```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

128: l1TokenAddress[_l2Token]
```
[128](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L128)
</details>

### [L-12] Consider checking that transfer to `address(this)` is disabled

Functions allowing users to specify the receiving address should check whether the referenced address is not `address(this)`.

This would prevent tokens to remain lock inside the contract due to an incorrect `transfer` or `mint`.

<details>
<summary><i>1 issue instances in 1 files:</i></summary>

```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

146: _mint(_to, _amount)
```
[146](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L146)
</details>

### [L-13] Possible division by 0 is not prevented

These functions can be called with 0 value in the input and this value is not checked for being bigger than 0, that means in some scenarios this can potentially trigger a division by zero.

<details>
<summary><i>5 issue instances in 2 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

/// @audit s - can be zero
159: uint256 l1GasPriceConverted = (_l1GasPrice * s.baseTokenGasPriceMultiplierNominator) /
            s.baseTokenGasPriceMultiplierDenominator;
/// @audit uint256 - can be zero
168: batchOverheadBaseToken /
            uint256(feeParams.maxPubdataPerBatch);
/// @audit uint256 - can be zero
171: uint256 l2GasPrice = feeParams.minimalL2GasPrice + batchOverheadBaseToken / uint256(feeParams.maxL2GasPerBatch);
/// @audit gasPrPubdata - can be zero
172: uint256 minL2GasPriceBaseToken = (fullPubdataPriceBaseToken + _gasPerPubdata - 1) / _gasPerPubdata;
```
[159](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L159) | [168](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L168) | [171](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L171) | [172](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L172)

```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol

/// @audit transaction - can be zero
30: require(l2GasForTxBody / _transaction.gasPerPubdataByteLimit <= _priorityTxMaxPubdata, "uk");
```
[30](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L30)
</details>

### [L-14] Using Draft Contract Imports

Draft contracts, like those from OpenZeppelin, although audited and safe to use, are based on non-finalized EIPs and may be subject to breaking changes in even minor releases.
If a bug is found in the version of OpenZeppelin you're using, and the bug-fix release contains breaking changes, this could lead to unnecessary delays in porting and testing replacement contracts.

It's recommended to have extensive test coverage to detect differences automatically and a plan for testing new versions of these contracts if they change unexpectedly.
Consider creating a forked version of the file rather than importing it from the package, and manually patching your fork as changes are made, to maintain better control over your dependencies and to mitigate this risk.

<details>
<summary><i>1 issue instances in 1 files:</i></summary>

```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

5: import {ERC20PermitUpgradeable} from "@openzeppelin/contracts-upgradeable/token/ERC20/extensions/draft-ERC20PermitUpgradeable.sol";
```
[5](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L5)
</details>

### [L-15] Initializer missing `address(0)` Check before assignment

The initializer does not include a check for `address(0)` when initializing state variables that hold addresses.
Initializing a state variable with `address(0)` can lead to unintended behavior and vulnerabilities in the contract, 
such as sending funds to an inaccessible address. 
It is recommended to include a validation step to ensure that address parameters are not set to `address(0)`.

<details>
<summary><i>3 issue instances in 3 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

/// @audit `_l2BridgeAddress` has lack of `address(0)` check before use
142: function initializeChainGovernance(uint256 _chainId, address _l2BridgeAddress) external onlyOwner {
```
[142](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L142)

```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

/// @audit `_owner` has lack of `address(0)` check before use
41: function initialize(address _owner) external reentrancyGuardInitializer {
```
[41](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L41)

```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

/// @audit `_availableGetters` has lack of `address(0)` check before use
111: function reinitializeToken(
        ERC20Getters calldata _availableGetters,
        string memory _newName,
        string memory _newSymbol,
        uint8 _version
    ) external onlyNextVersion(_version) reinitializer(_version) {
```
[111](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L111)
</details>

### [L-16] Missing checks for `address(0)` when updating state variables

Check for zero-address to avoid the risk of setting `address(0)` for state variables after an update.

<details>
<summary><i>15 issue instances in 5 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

143: l2BridgeAddress[_chainId] = _l2BridgeAddress;
```
[143](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L143)

```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

55: pendingAdmin = _newPendingAdmin;
109: sharedBridge = IL1SharedBridge(_sharedBridge);
```
[55](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L55) | [109](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L109)

```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

85: genesisUpgrade = _initializeData.genesisUpgrade;
87: validatorTimelock = _initializeData.validatorTimelock;
114: pendingAdmin = _newPendingAdmin;
133: validatorTimelock = _validatorTimelock;
234: stateTransition[_chainId] = _stateTransitionContract;
282: stateTransition[_chainId] = stateTransitionAddress;
```
[85](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L85) | [87](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L87) | [114](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L114) | [133](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L133) | [234](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L234) | [282](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L282)

```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

74: stateTransitionManager = _stateTransitionManager;
```
[74](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L74)

```solidity
File: code/system-contracts/contracts/SystemContext.sol

100: origin = _newOrigin;
271: currentVirtualL2BlockInfo = currentL2BlockInfo;
316: currentL2BlockInfo = BlockInfo({number: _l2BlockNumber, timestamp: _l2BlockTimestamp});
461: currentBatchInfo = newBlockInfo;
477: currentBatchInfo = newBlockInfo;
```
[100](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L100) | [271](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L271) | [316](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L316) | [461](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L461) | [477](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L477)
</details>

### [L-17] Input Validation Missing in Setter Functions

Setter functions are utilized to update the state variables of a contract.
It is critical to ensure these functions have adequate input sanitization to prevent unwanted alterations or malicious attacks.
Without input validation, there's a potential risk of enabling vulnerabilities like overflow/underflow, unauthorized access, or insertion of invalid data.
Consider incorporating appropriate validation mechanisms, such as checking the range or type of inputs, to enhance the security of your contract.

<details>
<summary><i>12 issue instances in 4 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

/// @audit `setValidatorTimelock` function does not validate `_validatorTimelock` input
132: function setValidatorTimelock(address _validatorTimelock) external onlyOwnerOrAdmin {
/// @audit `setNewVersionUpgrade` function does not validate `_oldProtocolVersion` input
142: function setNewVersionUpgrade(
        Diamond.DiamondCutData calldata _cutData,
        uint256 _oldProtocolVersion,
        uint256 _newProtocolVersion
    ) external onlyOwner {
/// @audit `setNewVersionUpgrade` function does not validate `_newProtocolVersion` input
142: function setNewVersionUpgrade(
        Diamond.DiamondCutData calldata _cutData,
        uint256 _oldProtocolVersion,
        uint256 _newProtocolVersion
    ) external onlyOwner {
/// @audit `setUpgradeDiamondCut` function does not validate `_oldProtocolVersion` input
152: function setUpgradeDiamondCut(
        Diamond.DiamondCutData calldata _cutData,
        uint256 _oldProtocolVersion
    ) external onlyOwner {
```
[132](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L132) | [142](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L142) | [142](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L142) | [152](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L152)

```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

/// @audit `setStateTransitionManager` function does not validate `_stateTransitionManager` input
73: function setStateTransitionManager(IStateTransitionManager _stateTransitionManager) external onlyOwner {
```
[73](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L73)

```solidity
File: code/system-contracts/contracts/ImmutableSimulator.sol

/// @audit `setImmutables` function does not validate `_immutables` input
34: function setImmutables(address _dest, ImmutableData[] calldata _immutables) external override {
```
[34](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ImmutableSimulator.sol#L34)

```solidity
File: code/system-contracts/contracts/SystemContext.sol

/// @audit `setChainId` function does not validate `_newChainId` input
84: function setChainId(uint256 _newChainId) external onlyCallFromForceDeployer {
/// @audit `setTxOrigin` function does not validate `_newOrigin` input
99: function setTxOrigin(address _newOrigin) external onlyCallFromBootloader {
/// @audit `setGasPrice` function does not validate `_gasPrice` input
105: function setGasPrice(uint256 _gasPrice) external onlyCallFromBootloader {
/// @audit `setPubdataInfo` function does not validate `_gasPerPubdataByte` input
112: function setPubdataInfo(uint256 _gasPerPubdataByte, uint256 _basePubdataSpent) external onlyCallFromBootloader {
/// @audit `setPubdataInfo` function does not validate `_basePubdataSpent` input
112: function setPubdataInfo(uint256 _gasPerPubdataByte, uint256 _basePubdataSpent) external onlyCallFromBootloader {
/// @audit `setNewBatch` function does not validate `_baseFee` input
444: function setNewBatch(
        bytes32 _prevBatchHash,
        uint128 _newTimestamp,
        uint128 _expectedNewNumber,
        uint256 _baseFee
    ) external onlyCallFromBootloader {
```
[84](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L84) | [99](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L99) | [105](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L105) | [112](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L112) | [112](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L112) | [444](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L444)
</details>

### [L-18] File allows a version of solidity that is susceptible to .selector-related optimizer bug

In solidity versions prior to 0.8.21, there is a legacy code generation [bug](https://soliditylang.org/blog/2023/07/19/missing-side-effects-on-selector-access-bug/) where if foo().selector is called, foo() doesn't actually get evaluated.
It is listed as low-severity, because projects usually use the contract name rather than a function call to look up the selector.

<details>
<summary><i>15 issue instances in 9 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

504: if (bytes4(functionSignature) == IMailbox.finalizeEthWithdrawal.selector) {
509: } else if (bytes4(functionSignature) == IL1ERC20Bridge.finalizeWithdrawal.selector) {
```
[504](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L504) | [509](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L509)

```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

262: IDiamondInit.initialize.selector,
```
[262](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L262)

```solidity
File: code/system-contracts/contracts/DefaultAccount.sol

144: selector == DEPLOYER_SYSTEM_CONTRACT.create.selector ||
145: selector == DEPLOYER_SYSTEM_CONTRACT.create2.selector ||
146: selector == DEPLOYER_SYSTEM_CONTRACT.createAccount.selector ||
147: selector == DEPLOYER_SYSTEM_CONTRACT.create2Account.selector;
```
[144](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L144) | [145](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L145) | [146](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L146) | [147](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L147)

```solidity
File: code/system-contracts/contracts/L2BaseToken.sol

113: return abi.encodePacked(IMailbox.finalizeEthWithdrawal.selector, _to, _amount);
123: return abi.encodePacked(IMailbox.finalizeEthWithdrawal.selector, _to, _amount, _sender, _additionalData);
```
[113](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L2BaseToken.sol#L113) | [123](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L2BaseToken.sol#L123)

```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

366: if (paymasterInputSelector == IPaymasterFlow.approvalBased.selector) {
385: } else if (paymasterInputSelector == IPaymasterFlow.general.selector) {
```
[366](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L366) | [385](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L385)

```solidity
File: code/system-contracts/contracts/interfaces/IAccount.sol

7: bytes4 constant ACCOUNT_VALIDATION_SUCCESS_MAGIC = IAccount.validateTransaction.selector;
```
[7](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IAccount.sol#L7)

```solidity
File: code/system-contracts/contracts/interfaces/IPaymaster.sol

12: bytes4 constant PAYMASTER_VALIDATION_SUCCESS_MAGIC = IPaymaster.validateAndPayForPaymasterTransaction.selector;
```
[12](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IPaymaster.sol#L12)

```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

145: return abi.encodePacked(IL1ERC20Bridge.finalizeWithdrawal.selector, _to, _l1Token, _amount);
```
[145](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L145)

```solidity
File: code/contracts/zksync/contracts/interfaces/IPaymaster.sol

12: bytes4 constant PAYMASTER_VALIDATION_SUCCESS_MAGIC = IPaymaster.validateAndPayForPaymasterTransaction.selector;
```
[12](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/interfaces/IPaymaster.sol#L12)
</details>

### [L-19] Missing checks for state variable assignments

There are some missing checks in these functions, and this could lead to unexpected scenarios. Consider always adding a sanity check for state variables.

<details>
<summary><i>13 issue instances in 4 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

55: pendingAdmin = _newPendingAdmin;
```
[55](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L55)

```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

114: pendingAdmin = _newPendingAdmin;
133: validatorTimelock = _validatorTimelock;
148: protocolVersion = _newProtocolVersion;
```
[114](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L114) | [133](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L133) | [148](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L148)

```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

74: stateTransitionManager = _stateTransitionManager;
97: executionDelay = _executionDelay;
```
[74](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L74) | [97](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L97)

```solidity
File: code/system-contracts/contracts/SystemContext.sol

85: chainId = _newChainId;
100: origin = _newOrigin;
106: gasPrice = _gasPrice;
113: basePubdataSpent = _basePubdataSpent;
114: gasPerPubdataByte = _gasPerPubdataByte;
455: batchHashes[previousBatchNumber] = _prevBatchHash;
462: baseFee = _baseFee;
```
[85](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L85) | [100](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L100) | [106](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L106) | [113](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L113) | [114](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L114) | [455](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L455) | [462](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L462)
</details>

### [L-20] Missing checks in constructor/initialize

There are some missing checks in these functions, and this could lead to unexpected scenarios. Consider always adding a sanity check for state variables.

<details>
<summary><i>8 issue instances in 6 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

/// @audit `_sharedBridge` is not validated before use
55: constructor(IL1SharedBridge _sharedBridge) reentrancyGuardInitializer {
/// @audit `_sharedBridge` is not validated before use
55: constructor(IL1SharedBridge _sharedBridge) reentrancyGuardInitializer {
```
[55](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L55) | [55](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L55)

```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

/// @audit `_bridgehub` is not validated before use
/// @audit `_legacyBridge` is not validated before use
90: constructor(
        address _l1WethAddress,
        IBridgehub _bridgehub,
        IL1ERC20Bridge _legacyBridge
    ) reentrancyGuardInitializer {
/// @audit `_eraFirstPostUpgradeBatch` is not validated before use
104: function initialize(
        address _owner,
        uint256 _eraFirstPostUpgradeBatch
    ) external reentrancyGuardInitializer initializer {
```
[90](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L90) | [104](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L104)

```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

/// @audit `_minDelay` is not validated before use
/// @audit `_minDelay` is not validated before use
41: constructor(address _admin, address _securityCouncil, uint256 _minDelay) {
```
[41](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L41)

```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

/// @audit `_executionDelay` is not validated before use
55: constructor(address _initialOwner, uint32 _executionDelay) {
```
[55](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L55)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol

/// @audit `_diamondCut` is not validated before use
11: constructor(uint256 _chainId, Diamond.DiamondCutData memory _diamondCut) {
```
[11](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol#L11)

```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

/// @audit `_data` is not validated before use
50: function bridgeInitialize(address _l1Address, bytes memory _data) external initializer {
```
[50](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L50)
</details>

### [L-21] Mint to zero address

Minting tokens to the zero address should be avoided. In several locations in the code, precautions are not being taken to prevent minting to the zero address. This may lead to unintended consequences.
Consider applying checks in the minting functions to ensure tokens are not minted to the zero address.

<details>
<summary><i>1 issue instances in 1 files:</i></summary>

```solidity
File: code/system-contracts/contracts/L2BaseToken.sol

64: function mint(address _account, uint256 _amount) external override onlyCallFromBootloader {
```
[64](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L2BaseToken.sol#L64)
</details>

### [L-22] Owner can renounce Ownership

Each of the following contracts implements or inherits the `renounceOwnership` function.
This can represent a certain risk if the ownership is renounced for any other reason than by design. Renouncing ownership will leave the contract without an owner, thereby removing any functionality that is only available to the owner.

<details>
<summary><i>5 issue instances in 5 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

6: import {Ownable2Step} from "@openzeppelin/contracts/access/Ownable2Step.sol";
```
[6](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L6)

```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

5: import {Ownable2Step} from "@openzeppelin/contracts/access/Ownable2Step.sol";
```
[5](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L5)

```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

5: import {Ownable2Step} from "@openzeppelin/contracts/access/Ownable2Step.sol";
```
[5](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L5)

```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

16: import {Ownable2Step} from "@openzeppelin/contracts/access/Ownable2Step.sol";
```
[16](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L16)

```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

5: import {Ownable2Step} from "@openzeppelin/contracts/access/Ownable2Step.sol";
```
[5](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L5)
</details>

### [L-23] Numbers downcast to `address`es may result in collisions

The contracts in this project contain instances where numbers are downcast to `address` types. This operation truncates the upper bytes, leading to a risk of address collision.

Specifically, more than one number could map to the same address when this downcasting occurs, which can introduce vulnerabilities or logical errors in the contract.

Carefully review the areas where such downcasting is done and consider whether the collision risk is appropriately managed.

<details>
<summary><i>10 issue instances in 7 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol

/// @audit casted from `uint256` to `address`
71: return address(uint160(uint256(data)));
```
[71](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L71)

```solidity
File: code/system-contracts/contracts/AccountCodeStorage.sol

/// @audit cast from `uint256 _input` to `address`
92: address account = address(uint160(_input));
/// @audit cast from `uint256 _input` to `address`
120: address account = address(uint160(_input));
```
[92](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/AccountCodeStorage.sol#L92) | [120](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/AccountCodeStorage.sol#L120)

```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

/// @audit casted from `uint256` to `address`
109: newAddress = address(uint160(uint256(hash)));
/// @audit casted from `uint256` to `address`
125: newAddress = address(uint160(uint256(hash)));
```
[109](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L109) | [125](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L125)

```solidity
File: code/system-contracts/contracts/L2BaseToken.sol

/// @audit cast from `uint256 _account` to `address`
57: return balance[address(uint160(_account))];
```
[57](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L2BaseToken.sol#L57)

```solidity
File: code/system-contracts/contracts/MsgValueSimulator.sol

/// @audit cast from `uint256 addressAsUint` to `address`
32: to = address(uint160(addressAsUint));
```
[32](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/MsgValueSimulator.sol#L32)

```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

/// @audit cast from `uint256 _transaction.paymaster` to `address`
375: address paymaster = address(uint160(_transaction.paymaster));
/// @audit cast from `uint256 _transaction.paymaster` to `address`
406: if (address(uint160(_transaction.paymaster)) != address(0)) {
```
[375](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L375) | [406](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L406)

```solidity
File: code/contracts/zksync/contracts/L2ContractHelper.sol

/// @audit casted from `uint256` to `address`
112: return address(uint160(uint256(data)));
```
[112](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/L2ContractHelper.sol#L112)
</details>

### [L-24] State variables are not limited to a reasonable range

There are some missing limits in these functions, and this could lead to unexpected scenarios. Consider adding a min/max limit for the following values, when appropriate.

<details>
<summary><i>9 issue instances in 4 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

148: protocolVersion = _newProtocolVersion;
```
[148](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L148)

```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

97: executionDelay = _executionDelay;
```
[97](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L97)

```solidity
File: code/system-contracts/contracts/SystemContext.sol

85: chainId = _newChainId;
106: gasPrice = _gasPrice;
113: basePubdataSpent = _basePubdataSpent;
114: gasPerPubdataByte = _gasPerPubdataByte;
462: baseFee = _baseFee;
478: baseFee = _baseFee;
```
[85](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L85) | [106](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L106) | [113](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L113) | [114](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L114) | [462](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L462) | [478](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L478)

```solidity
File: code/system-contracts/contracts/libraries/SystemContractHelper.sol

131: rawParams = _inputMemoryOffset;
```
[131](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L131)
</details>

### [L-25] Missing contract-existence checks before low-level calls

Low-level calls return success if there is no code present at the specified address, and this could lead to unexpected scenarios.

Ensure that the code is initialized by checking `<address>.code.length > 0`

<details>
<summary><i>2 issue instances in 2 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

226: (bool success, bytes memory returnData) = _calls[i].target.call{value: _calls[i].value}(_calls[i].data);
```
[226](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L226)

```solidity
File: code/system-contracts/contracts/GasBoundCaller.sol

57: bytes memory returnData = EfficientCall.call(gasleft(), _to, msg.value, _data, false);
```
[57](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/GasBoundCaller.sol#L57)
</details>

### [L-26] Events may be emitted out of order due to reentrancy

It's essential to ensure that events follow the best practice of check-effects-interaction and are emitted before any external calls to prevent out-of-order events due to reentrancy.
Emitting events post external interactions may cause them to be out of order due to reentrancy, which can be misleading or erroneous for event listeners.
[Refer to the Solidity Documentation for best practices.](https://solidity.readthedocs.io/en/latest/security-considerations.html#reentrancy)

<details>
<summary><i>2 issue instances in 1 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

/// @audit `safeTransfer()` before `ClaimedFailedDepositSharedBridge` event emit
366: emit ClaimedFailedDepositSharedBridge(_chainId, _depositSender, _l1Token, _amount);
/// @audit `safeTransfer()` before `WithdrawalFinalizedSharedBridge` event emit
454: emit WithdrawalFinalizedSharedBridge(_chainId, l1Receiver, l1Token, amount);
```
[366](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L366) | [454](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L454)
</details>

### [L-27] External calls in an unbounded loop can result in a DoS

Consider limiting the number of iterations in loops that make external calls, as just a single one of them failing will result in a revert.

<details>
<summary><i>20 issue instances in 5 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

/// @audit 3 external calls in unbounded for-loop -> 142: for (uint256 i = 0; i < emittedL2Logs.length; i = i.uncheckedAdd(L2_TO_L1_LOG_SERIALIZE_SIZE)) {
144: (address logSender, ) = UnsafeBytes.readAddress(emittedL2Logs, i + L2_LOG_ADDRESS_OFFSET);
145: (uint256 logKey, ) = UnsafeBytes.readUint256(emittedL2Logs, i + L2_LOG_KEY_OFFSET);
146: (bytes32 logValue, ) = UnsafeBytes.readBytes32(emittedL2Logs, i + L2_LOG_VALUE_OFFSET);
/// @audit 1 external calls in unbounded for-loop -> 405: for (uint256 i = 0; i < committedBatchesLength; i = i.uncheckedInc()) {
406: currentTotalBatchesVerified = currentTotalBatchesVerified.uncheckedInc();
```
[144](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L144) | [145](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L145) | [146](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L146) | [406](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L406)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

/// @audit 1 external calls in unbounded for-loop -> 356: for (uint256 i = 0; i < factoryDepsLen; i = i.uncheckedInc()) {
357: bytes32 hashedBytecode = L2ContractHelper.hashL2Bytecode(_factoryDeps[i]);
```
[357](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L357)

```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol

/// @audit 1 external calls in unbounded for-loop -> 226: for (uint256 i = 0; i < _factoryDeps.length; ++i) {
228: L2ContractHelper.hashL2Bytecode(_factoryDeps[i]) == bytes32(_expectedHashes[i]),
```
[228](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L228)

```solidity
File: code/system-contracts/contracts/Compressor.sol

/// @audit 3 external calls in unbounded for-loop -> 61: for (uint256 encodedDataPointer = 0; encodedDataPointer < encodedData.length; encodedDataPointer += 2) {
62: uint256 indexOfEncodedChunk = uint256(encodedData.readUint16(encodedDataPointer)) * 8;
65: uint64 encodedChunk = dictionary.readUint64(indexOfEncodedChunk);
66: uint64 realChunk = _bytecode.readUint64(encodedDataPointer * 4);
/// @audit 5 external calls in unbounded for-loop -> 127: for (uint256 i = 0; i < _numberOfStateDiffs * STATE_DIFF_ENTRY_SIZE; i += STATE_DIFF_ENTRY_SIZE) {
129: uint64 enumIndex = stateDiff.readUint64(84);
137: bytes32 derivedKey = stateDiff.readBytes32(52);
138: uint256 initValue = stateDiff.readUint256(92);
139: uint256 finalValue = stateDiff.readUint256(124);
140: require(derivedKey == _compressedStateDiffs.readBytes32(stateDiffPtr), "iw: initial key mismatch");
/// @audit 3 external calls in unbounded for-loop -> 159: for (uint256 i = 0; i < _numberOfStateDiffs * STATE_DIFF_ENTRY_SIZE; i += STATE_DIFF_ENTRY_SIZE) {
161: uint64 enumIndex = stateDiff.readUint64(84);
166: uint256 initValue = stateDiff.readUint256(92);
167: uint256 finalValue = stateDiff.readUint256(124);
```
[62](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L62) | [65](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L65) | [66](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L66) | [129](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L129) | [137](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L137) | [138](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L138) | [139](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L139) | [140](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L140) | [161](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L161) | [166](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L166) | [167](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L167)

```solidity
File: code/system-contracts/contracts/L1Messenger.sol

/// @audit 1 external calls in unbounded for-loop -> 206: for (uint256 i = 0; i < numberOfL2ToL1Logs; ++i) {
207: bytes32 hashedLog = EfficientCall.keccak(
/// @audit 1 external calls in unbounded for-loop -> 236: for (uint256 i = 0; i < numberOfMessages; ++i) {
239: bytes32 hashedMessage = EfficientCall.keccak(
/// @audit 1 external calls in unbounded for-loop -> 254: for (uint256 i = 0; i < numberOfBytecodes; ++i) {
262: Utils.hashL2Bytecode(
```
[207](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L207) | [239](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L239) | [262](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L262)
</details>

### [L-28] Critical functions should be a two step procedure

Critical functions in Solidity contracts should follow a two-step procedure to enhance security, minimize human error, and ensure proper access control. By dividing sensitive operations into distinct phases, such as initiation and confirmation, developers can introduce a safeguard against unintended actions or unauthorized access.

<details>
<summary><i>29 issue instances in 10 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

51: function setPendingAdmin(address _newPendingAdmin) external onlyOwnerOrAdmin {
108: function setSharedBridge(address _sharedBridge) external onlyOwner {
```
[51](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L51) | [108](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L108)

```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

249: function updateDelay(uint256 _newDelay) external onlySelf {
256: function updateSecurityCouncil(address _newSecurityCouncil) external onlySelf {
```
[249](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L249) | [256](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L256)

```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

110: function setPendingAdmin(address _newPendingAdmin) external onlyOwnerOrAdmin {
132: function setValidatorTimelock(address _validatorTimelock) external onlyOwnerOrAdmin {
137: function setInitialCutHash(Diamond.DiamondCutData calldata _diamondCut) external onlyOwner {
142: function setNewVersionUpgrade(
        Diamond.DiamondCutData calldata _cutData,
        uint256 _oldProtocolVersion,
        uint256 _newProtocolVersion
    ) external onlyOwner {
152: function setUpgradeDiamondCut(
        Diamond.DiamondCutData calldata _cutData,
        uint256 _oldProtocolVersion
    ) external onlyOwner {
```
[110](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L110) | [132](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L132) | [137](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L137) | [142](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L142) | [152](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L152)

```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

73: function setStateTransitionManager(IStateTransitionManager _stateTransitionManager) external onlyOwner {
96: function setExecutionDelay(uint32 _executionDelay) external onlyOwner {
```
[73](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L73) | [96](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L96)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol

23: function setPendingAdmin(address _newPendingAdmin) external onlyAdmin {
45: function setValidator(address _validator, bool _active) external onlyStateTransitionManager {
51: function setPorterAvailability(bool _zkPorterIsAvailable) external onlyStateTransitionManager {
58: function setPriorityTxMaxGasLimit(uint256 _newPriorityTxMaxGasLimit) external onlyStateTransitionManager {
67: function changeFeeParams(FeeParams calldata _newFeeParams) external onlyAdminOrStateTransitionManager {
79: function setTokenMultiplier(uint128 _nominator, uint128 _denominator) external onlyAdminOrStateTransitionManager {
88: function setValidiumMode(PubdataPricingMode _validiumMode) external onlyAdmin {
```
[23](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L23) | [45](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L45) | [51](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L51) | [58](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L58) | [67](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L67) | [79](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L79) | [88](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L88)

```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

65: function updateAccountVersion(AccountAbstractionVersion _version) external onlySystemCall {
74: function updateNonceOrdering(AccountNonceOrdering _nonceOrdering) external onlySystemCall {
```
[65](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L65) | [74](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L74)

```solidity
File: code/system-contracts/contracts/ImmutableSimulator.sol

34: function setImmutables(address _dest, ImmutableData[] calldata _immutables) external override {
```
[34](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ImmutableSimulator.sol#L34)

```solidity
File: code/system-contracts/contracts/NonceHolder.sol

82: function setValueUnderNonce(uint256 _key, uint256 _value) public onlySystemCall {
```
[82](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L82)

```solidity
File: code/system-contracts/contracts/SystemContext.sol

84: function setChainId(uint256 _newChainId) external onlyCallFromForceDeployer {
99: function setTxOrigin(address _newOrigin) external onlyCallFromBootloader {
105: function setGasPrice(uint256 _gasPrice) external onlyCallFromBootloader {
112: function setPubdataInfo(uint256 _gasPerPubdataByte, uint256 _basePubdataSpent) external onlyCallFromBootloader {
341: function setL2Block(
        uint128 _l2BlockNumber,
        uint128 _l2BlockTimestamp,
        bytes32 _expectedPrevL2BlockHash,
        bool _isFirstInBatch,
        uint128 _maxVirtualBlocksToCreate
    ) external onlyCallFromBootloader {
444: function setNewBatch(
        bytes32 _prevBatchHash,
        uint128 _newTimestamp,
        uint128 _expectedNewNumber,
        uint256 _baseFee
    ) external onlyCallFromBootloader {
```
[84](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L84) | [99](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L99) | [105](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L105) | [112](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L112) | [341](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L341) | [444](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L444)

```solidity
File: code/system-contracts/contracts/libraries/SystemContractHelper.sol

168: function setValueForNextFarCall(uint128 _value) internal returns (bool success) {
```
[168](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L168)
</details>

### [L-29] Upper Limits for Fees/Rates Should Be Implemented

It is critical for the functionality and reliability of a smart contract that any fees or rates are constrained to a sensible range, preferably significantly below 100%.
Such a limitation prevents excessive charges and protects users from unpredictable fee fluctuations.
This measure also enhances the user experience, as they can interact with the protocol without the necessity to constantly check the blockchain for any abrupt changes in fees or rates.

<details>
<summary><i>1 issue instances in 1 files:</i></summary>

```solidity
File: code/system-contracts/contracts/SystemContext.sol

463: baseFee = _baseFee;
```
[463](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L463)
</details>

### [L-30] `onlyOwner` functions not accessible if `owner` renounces ownership

The `owner` is able to perform certain privileged activities, but it's possible to set the `owner` to `address(0)`. This can represent a certain risk if the ownership is renounced for any other reason than by design.

Renouncing ownership will leave the contract without an `owner`, therefore limiting any functionality that needs authority.

<details>
<summary><i>17 issue instances in 5 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

116: function transferFundsFromLegacy(address _token, address _target, uint256 _targetChainId) external onlyOwner {
142: function initializeChainGovernance(uint256 _chainId, address _l2BridgeAddress) external onlyOwner {
```
[116](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L116) | [142](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L142)

```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

82: function addStateTransitionManager(address _stateTransitionManager) external onlyOwner {
92: function removeStateTransitionManager(address _stateTransitionManager) external onlyOwner {
101: function addToken(address _token) external onlyOwner {
108: function setSharedBridge(address _sharedBridge) external onlyOwner {
```
[82](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L82) | [92](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L92) | [101](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L101) | [108](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L108)

```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

129: function scheduleTransparent(Operation calldata _operation, uint256 _delay) external onlyOwner {
142: function scheduleShadow(bytes32 _id, uint256 _delay) external onlyOwner {
154: function cancel(bytes32 _id) external onlyOwner {
```
[129](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L129) | [142](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L142) | [154](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L154)

```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

137: function setInitialCutHash(Diamond.DiamondCutData calldata _diamondCut) external onlyOwner {
142: function setNewVersionUpgrade(
        Diamond.DiamondCutData calldata _cutData,
        uint256 _oldProtocolVersion,
        uint256 _newProtocolVersion
    ) external onlyOwner {
152: function setUpgradeDiamondCut(
        Diamond.DiamondCutData calldata _cutData,
        uint256 _oldProtocolVersion
    ) external onlyOwner {
160: function freezeChain(uint256 _chainId) external onlyOwner {
165: function unfreezeChain(uint256 _chainId) external onlyOwner {
229: function registerAlreadyDeployedStateTransition(
        uint256 _chainId,
        address _stateTransitionContract
    ) external onlyOwner {
```
[137](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L137) | [142](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L142) | [152](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L152) | [160](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L160) | [165](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L165) | [229](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L229)

```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

73: function setStateTransitionManager(IStateTransitionManager _stateTransitionManager) external onlyOwner {
96: function setExecutionDelay(uint32 _executionDelay) external onlyOwner {
```
[73](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L73) | [96](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L96)
</details>

### [L-31] Avoid Upcasting `address` Types and Comparing to Values Larger Than `uint160`

Upcasting an `address` to a value larger than `uint160` can result in unexpected collisions.
Such conversions can lead to incorrect behavior when checking for address equality, especially when these values are compared against larger numbers.

To ensure safety, always compare addresses in their native format or within their native value range.

<details>
<summary><i>1 issue instances in 1 files:</i></summary>

```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

95: return _addr == uint256(uint160(address(BASE_TOKEN_SYSTEM_CONTRACT))) || _addr == 0;
```
[95](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L95)
</details>

### [L-32] safeApprove is deprecated

The usage of deprecated library functions should be discouraged, as safeApprove is also potentially [dangerous](https://github.com/OpenZeppelin/openzeppelin-contracts/issues/2219).

<details>
<summary><i>1 issue instances in 1 files:</i></summary>

```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

383: IERC20(token).safeApprove(paymaster, minAllowance);
```
[383](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L383)
</details>

### [L-33] Implement two-step ownership transfers

Single-step ownership transfers can be risky due to the potential for errors or wrong address inputs.
In worst-case scenarios, your contract could become `ownerless`.
To mitigate these risks, consider using a two-step ownership transfers.
In this process, a new potential owner is first designated, and then they must accept the ownership to complete the transfer.
This two-step procedure ensures a more secure and reliable transfer of contract ownership.

<details>
<summary><i>6 issue instances in 6 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

109: _transferOwnership(_owner);
```
[109](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L109)

```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

42: _transferOwnership(_owner);
```
[42](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L42)

```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

44: _transferOwnership(_admin);
```
[44](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L44)

```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

83: _transferOwnership(_initializeData.governor);
```
[83](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L83)

```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

56: _transferOwnership(_initialOwner);
```
[56](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L56)

```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

66: l2TokenBeacon.transferOwnership(_aliasedOwner);
```
[66](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L66)
</details>

### [L-34] Loss of precision on division

Solidity doesn't support fractions, so divisions by large numbers could result in the quotient being zero.

To avoid this, it's recommended to require a minimum numerator amount to ensure that it is always greater than the denominator.

<details>
<summary><i>5 issue instances in 3 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

168: batchOverheadBaseToken /
            uint256(feeParams.maxPubdataPerBatch);
171: uint256 l2GasPrice = feeParams.minimalL2GasPrice + batchOverheadBaseToken / uint256(feeParams.maxL2GasPerBatch);
172: uint256 minL2GasPriceBaseToken = (fullPubdataPriceBaseToken + _gasPerPubdata - 1) / _gasPerPubdata;
```
[168](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L168) | [171](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L171) | [172](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L172)

```solidity
File: code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol

25: uint256 bytecodeLenInWords = _bytecode.length / 32;
```
[25](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L25)

```solidity
File: code/system-contracts/contracts/libraries/Utils.sol

86: uint256 lengthInWords = _bytecode.length / 32;
```
[86](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L86)
</details>

### [L-35] Unbounded Gas Consumption on External Calls

Consider using `addr.call{gas: <amount>}("")` to set a gas limit and prevent potential reversion due to gas consumption.

<details>
<summary><i>1 issue instances in 1 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

226: (bool success, bytes memory returnData) = _calls[i].target.call{value: _calls[i].value}(_calls[i].data);
```
[226](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L226)
</details>

### [L-36] Unsafe downcast from larger to smaller integer types

When a type is downcast to a smaller type, the higher order bits are discarded, resulting in the application of a modulo operation to the original value.

If the downcasted value is large enough, this may result in an overflow that will not revert.

<details>
<summary><i>40 issue instances in 16 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

/// @audit cast from `uint256` to `uint8`
149: require(!_checkBit(processedLogs, uint8(logKey)), "kp");
/// @audit cast from `uint256` to `uint8`
150: processedLogs = _setBit(processedLogs, uint8(logKey));
```
[149](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L149) | [150](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L150)

```solidity
File: code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol

/// @audit casted from `uint256` to `uint160`
71: return address(uint160(uint256(data)));
```
[71](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L71)

```solidity
File: code/system-contracts/contracts/AccountCodeStorage.sol

/// @audit cast from `uint256` to `uint160`
92: address account = address(uint160(_input));
/// @audit cast from `uint256` to `uint160`
93: if (uint160(account) <= CURRENT_MAX_PRECOMPILE_ADDRESS) {
/// @audit cast from `uint256` to `uint160`
120: address account = address(uint160(_input));
/// @audit cast from `uint256` to `uint160`
132: uint160(account) > CURRENT_MAX_PRECOMPILE_ADDRESS &&
```
[92](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/AccountCodeStorage.sol#L92) | [93](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/AccountCodeStorage.sol#L93) | [120](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/AccountCodeStorage.sol#L120) | [132](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/AccountCodeStorage.sol#L132)

```solidity
File: code/system-contracts/contracts/BootloaderUtilities.sol

/// @audit cast from `uint256` to `uint64`
68: uint64 txDataLen = uint64(_transaction.data.length);
/// @audit cast from `uint256` to `uint64`
116: encodedListLength = RLPEncoder.encodeListLen(uint64(listLength));
/// @audit cast from `uint256` to `uint64`
164: uint64 txDataLen = uint64(_transaction.data.length);
/// @audit cast from `uint256` to `uint64`
207: encodedListLength = RLPEncoder.encodeListLen(uint64(listLength));
/// @audit cast from `uint256` to `uint64`
259: uint64 txDataLen = uint64(_transaction.data.length);
/// @audit cast from `uint256` to `uint64`
302: encodedListLength = RLPEncoder.encodeListLen(uint64(listLength));
```
[68](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L68) | [116](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L116) | [164](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L164) | [207](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L207) | [259](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L259) | [302](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L302)

```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

/// @audit casted from `uint256` to `uint160`
109: newAddress = address(uint160(uint256(hash)));
/// @audit casted from `uint256` to `uint160`
125: newAddress = address(uint160(uint256(hash)));
/// @audit cast from `uint256` to `uint128`
341: SystemContractHelper.setValueForNextFarCall(uint128(value));
```
[109](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L109) | [125](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L125) | [341](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L341)

```solidity
File: code/system-contracts/contracts/ImmutableSimulator.sol

/// @audit cast from `uint256` to `uint160`
28: return immutableDataStorage[uint256(uint160(_dest))][_index];
/// @audit cast from `uint256` to `uint160`
41: immutableDataStorage[uint256(uint160(_dest))][index] = value;
```
[28](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ImmutableSimulator.sol#L28) | [41](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ImmutableSimulator.sol#L41)

```solidity
File: code/system-contracts/contracts/L1Messenger.sol

/// @audit cast from `uint256` to `uint32`
154: SystemContractHelper.burnGas(Utils.safeCastToU32(gasToPay), uint32(pubdataLen));
/// @audit cast from `uint256` to `uint32`
179: SystemContractHelper.burnGas(Utils.safeCastToU32(gasToPay), uint32(pubdataLen));
```
[154](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L154) | [179](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L179)

```solidity
File: code/system-contracts/contracts/L2BaseToken.sol

/// @audit cast from `uint256` to `uint160`
57: return balance[address(uint160(_account))];
```
[57](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L2BaseToken.sol#L57)

```solidity
File: code/system-contracts/contracts/MsgValueSimulator.sol

/// @audit cast from `uint256` to `uint160`
32: to = address(uint160(addressAsUint));
```
[32](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/MsgValueSimulator.sol#L32)

```solidity
File: code/system-contracts/contracts/SystemContext.sol

/// @audit cast from `uint256` to `uint32`
157: // that's why the legacy L2 blocks' hashes are keccak256(abi.encodePacked(uint32(_block))), while these are equivalent to
/// @audit cast from `uint128` to `uint32`
234: return keccak256(abi.encodePacked(uint32(_blockNumber)));
/// @audit cast from `uint256` to `uint128`
476: BlockInfo memory newBlockInfo = BlockInfo({number: uint128(_number), timestamp: uint128(_newTimestamp)});
```
[157](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L157) | [234](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L234) | [476](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L476)

```solidity
File: code/system-contracts/contracts/libraries/EfficientCall.sol

/// @audit cast from `uint256` to `uint32`
259: SystemContractHelper.ptrAddIntoActive(uint32(dataOffset));
```
[259](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L259)

```solidity
File: code/system-contracts/contracts/libraries/RLPEncoder.sol

/// @audit cast from `uint256` to `uint8`
29: encoded[0] = (_val == 0) ? bytes1(uint8(128)) : bytes1(uint8(_val));
```
[29](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/RLPEncoder.sol#L29)

```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

/// @audit cast from `uint256` to `uint64`
171: uint64 txDataLen = uint64(_transaction.data.length);
/// @audit cast from `uint256` to `uint64`
199: encodedListLength = RLPEncoder.encodeListLen(uint64(listLength));
/// @audit cast from `uint256` to `uint64`
249: uint64 txDataLen = uint64(_transaction.data.length);
/// @audit cast from `uint256` to `uint64`
271: encodedListLength = RLPEncoder.encodeListLen(uint64(listLength));
/// @audit cast from `uint256` to `uint64`
321: uint64 txDataLen = uint64(_transaction.data.length);
/// @audit cast from `uint256` to `uint64`
343: encodedListLength = RLPEncoder.encodeListLen(uint64(listLength));
/// @audit cast from `uint256` to `uint160`
375: address paymaster = address(uint160(_transaction.paymaster));
/// @audit cast from `uint256` to `uint160`
406: if (address(uint160(_transaction.paymaster)) != address(0)) {
```
[171](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L171) | [199](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L199) | [249](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L249) | [271](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L271) | [321](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L321) | [343](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L343) | [375](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L375) | [406](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L406)

```solidity
File: code/system-contracts/contracts/libraries/Utils.sol

/// @audit cast from `uint256` to `uint128`
23: return uint128(_x);
/// @audit cast from `uint256` to `uint32`
29: return uint32(_x);
/// @audit cast from `uint256` to `uint24`
35: return uint24(_x);
```
[23](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L23) | [29](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L29) | [35](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L35)

```solidity
File: code/contracts/zksync/contracts/L2ContractHelper.sol

/// @audit casted from `uint256` to `uint160`
112: return address(uint160(uint256(data)));
```
[112](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/L2ContractHelper.sol#L112)

```solidity
File: code/contracts/zksync/contracts/SystemContractsCaller.sol

/// @audit cast from `uint256` to `uint32`
30: return uint32(_x);
```
[30](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/SystemContractsCaller.sol#L30)
</details>

### [L-37] Lack of two-step update for updating protocol addresses

Add a two-step process for any critical address changes.

<details>
<summary><i>11 issue instances in 5 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

/// @audit `pendingAdmin` is changed
55: pendingAdmin = _newPendingAdmin;
/// @audit `stateTransitionManager[_chainId]` is changed
133: stateTransitionManager[_chainId] = _stateTransitionManager;
/// @audit `baseToken[_chainId]` is changed
135: baseToken[_chainId] = _baseToken;
/// @audit `_recipient` is changed
333: _recipient = _refundRecipient;
```
[55](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L55) | [133](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L133) | [135](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L135) | [333](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L333)

```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

/// @audit `securityCouncil` is changed
258: securityCouncil = _newSecurityCouncil;
```
[258](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L258)

```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

/// @audit `pendingAdmin` is changed
114: pendingAdmin = _newPendingAdmin;
/// @audit `validatorTimelock` is changed
133: validatorTimelock = _validatorTimelock;
/// @audit `protocolVersion` is changed
148: protocolVersion = _newProtocolVersion;
/// @audit `stateTransition[_chainId]` is changed
234: stateTransition[_chainId] = _stateTransitionContract;
```
[114](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L114) | [133](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L133) | [148](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L148) | [234](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L234)

```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

/// @audit `stateTransitionManager` is changed
74: stateTransitionManager = _stateTransitionManager;
```
[74](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L74)

```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

/// @audit `availableGetters` is changed
124: availableGetters = _availableGetters;
```
[124](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L124)
</details>

### [L-38] Missing checks for `address(0)` in constructor

Check for zero-address to avoid the risk of setting `address(0)` for state variables when deploying.

<details>
<summary><i>7 issue instances in 6 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

/// @audit `_sharedBridge` has lack of `address(0)` check before use
55: constructor(IL1SharedBridge _sharedBridge) reentrancyGuardInitializer {
/// @audit `_sharedBridge` has lack of `address(0)` check before use
55: constructor(IL1SharedBridge _sharedBridge) reentrancyGuardInitializer {
```
[55](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L55) | [55](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L55)

```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

/// @audit `_l1WethAddress` has lack of `address(0)` check before use
/// @audit `_bridgehub` has lack of `address(0)` check before use
/// @audit `_legacyBridge` has lack of `address(0)` check before use
90: constructor(
        address _l1WethAddress,
        IBridgehub _bridgehub,
        IL1ERC20Bridge _legacyBridge
    ) reentrancyGuardInitializer {
```
[90](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L90)

```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

/// @audit `_securityCouncil` has lack of `address(0)` check before use
41: constructor(address _admin, address _securityCouncil, uint256 _minDelay) {
```
[41](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L41)

```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

/// @audit `_bridgehub` has lack of `address(0)` check before use
58: constructor(address _bridgehub) reentrancyGuardInitializer {
```
[58](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L58)

```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

/// @audit `_initialOwner` has lack of `address(0)` check before use
54: constructor(address _initialOwner, uint32 _executionDelay) {
```
[54](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L54)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol

/// @audit `_diamondCut` has lack of `address(0)` check before use
11: constructor(uint256 _chainId, Diamond.DiamondCutData memory _diamondCut) {
```
[11](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol#L11)
</details>

### [L-39] Functions calling contracts with transfer hooks are missing reentrancy guards

Even if the function follows the best practice of check-effects-interaction, not using a reentrancy guard when there may be transfer hooks will open the users of this protocol up to read-only reentrancies with no way to protect against it, except by block-listing the whole protocol.

<details>
<summary><i>4 issue instances in 1 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

/// @audit function `tranferTokenToSharedBridge()` 
67: IERC20(_token).safeTransfer(address(sharedBridge), amount);
/// @audit function `_depositFundsToSharedBridge()` 
162: _token.safeTransferFrom(_from, address(sharedBridge), _amount);
/// @audit function `tranferTokenToSharedBridge()` 
67: IERC20(_token).safeTransfer(address(sharedBridge), amount);
/// @audit function `_depositFundsToSharedBridge()` 
162: _token.safeTransferFrom(_from, address(sharedBridge), _amount);
```
[67](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L67) | [162](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L162) | [67](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L67) | [162](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L162)
</details>

### [L-40] Missing `__gap[50]` storage variable in Upgradeable contracts

In the context of upgradeable contracts, ensuring forward compatibility between different contract versions is a critical concern. One key strategy for ensuring this compatibility is the use of a `__gap` storage variable.

The `__gap` variable acts as a reserved space in the contract's storage layout. This space can then be utilized for adding new state variables in future contract upgrades, while maintaining the original storage layout of the contract.

Without the `__gap` storage variable, adding new state variables in a contract upgrade can risk overwriting the existing contract storage, potentially leading to unpredictable behavior or data loss.

Therefore, if your contract is designed to be upgradeable, it's crucial to include a `__gap` storage variable. The absence of this variable in an upgradeable contract can signify a potential risk for future upgrades.

<details>
<summary><i>1 issue instances in 1 files:</i></summary>

```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

15: contract L2StandardERC20 is ERC20PermitUpgradeable, IL2StandardToken, ERC1967Upgrade {
```
[15](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L15)
</details>

### [L-41] Casting `block.timestamp` to Smaller Integer Types Limit Contract Lifespan

Casting `block.timestamp` to a smaller integer type like uint32 can potentially reduce the lifespan of a contract.
While the current Unix timestamp fits within the uint32 range as of now, it will eventually exceed this range by the year 2106.

At this point, casting the Unix timestamp to a uint32 will lead to overflow errors, resulting in unpredictable contract behavior.
To future-proof your contract, it's advisable to use larger integer types such as uint40 or uint (up to uint256) when dealing with timestamps.

<details>
<summary><i>2 issue instances in 1 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

115: uint32 timestamp = uint32(block.timestamp);
134: uint32 timestamp = uint32(block.timestamp);
```
[115](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L115) | [134](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L134)
</details>


## NonCritical Findings Details

### [N-01] `internal/private` Function calls within for loops

Making function calls or external calls within loops in Solidity can lead to inefficient gas usage, potential bottlenecks, and increased vulnerability to attacks.
Each function call or external call consumes gas, and when executed within a loop, the gas cost multiplies, potentially causing the transaction to run out of gas or exceed block gas limits.
This can result in transaction failure or unpredictable behavior.

<details>
<summary><i>26 issue instances in 6 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

149: _checkBit(processedLogs, uint8(logKey))
150: _setBit(processedLogs, uint8(logKey))
258: _commitOneBatch(_lastCommittedBatchData, _newBatchesData[i], bytes32(0))
260: _hashStoredBatchInfo(_lastCommittedBatchData)
292: _commitOneBatch(
                _lastCommittedBatchData,
                _newBatchesData[i],
                expectedUpgradeTxHash
            )
298: _hashStoredBatchInfo(_lastCommittedBatchData)
352: _executeOneBatch(_batchesData[i], i)
408: _hashStoredBatchInfo(_committedBatches[i])
413: _getBatchProofPublicInput(
                prevBatchCommitment,
                currentBatchCommitment,
                verifierParams
            )
637: _getBlobVersionedHash(versionedHashIndex)
647: _pointEvaluationPrecompile(
                blobVersionedHash,
                openingPoint,
                _pubdataCommitments[i + PUBDATA_COMMITMENT_CLAIMED_VALUE_OFFSET:i + PUBDATA_COMMITMENT_SIZE]
            )
```
[149](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L149) | [150](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L150) | [258](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L258) | [260](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L260) | [292](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L292) | [298](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L298) | [352](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L352) | [408](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L408) | [413](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L413) | [637](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L637) | [647](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L647)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol

212: Facet(facetAddr, facetToSelectors.selectors)
```
[212](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L212)

```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol

110: _addFunctions(facet, selectors, isFacetFreezable)
112: _replaceFunctions(facet, selectors, isFacetFreezable)
114: _removeFunctions(facet, selectors)
143: _addOneFunction(_facet, selector, _isFacetFreezable)
163: _removeOneFunction(oldFacet.facetAddress, selector)
165: _saveFacetIfNew(_facet)
166: _addOneFunction(_facet, selector, _isFacetFreezable)
183: _removeOneFunction(oldFacet.facetAddress, selector)
```
[110](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L110) | [112](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L112) | [114](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L114) | [143](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L143) | [163](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L163) | [165](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L165) | [166](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L166) | [183](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L183)

```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol

31: _efficientHash(currentHash, _path[i])
32: _efficientHash(_path[i], currentHash)
```
[31](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol#L31) | [32](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol#L32)

```solidity
File: code/system-contracts/contracts/Compressor.sol

147: _verifyValueCompression(
                initValue,
                finalValue,
                operation,
                _compressedStateDiffs[stateDiffPtr:stateDiffPtr + len]
            )
168: _sliceToUint256(
                _compressedStateDiffs[stateDiffPtr:stateDiffPtr + _enumerationIndexSize]
            )
178: _verifyValueCompression(
                initValue,
                finalValue,
                operation,
                _compressedStateDiffs[stateDiffPtr:stateDiffPtr + len]
            )
```
[147](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L147) | [168](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L168) | [178](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L178)

```solidity
File: code/system-contracts/contracts/KnownCodesStorage.sol

31: _markBytecodeAsPublished(_hashes[i], _shouldSendToL1)
```
[31](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/KnownCodesStorage.sol#L31)
</details>

### [N-02] For loops in public or external functions should be avoided due to high gas costs and possible `revert`

Loops in public or external functions can lead to high gas costs, as their unpredictable gas consumption and externally-influenced logic might make these functions costly.

<details>
<summary><i>4 issue instances in 3 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol

208: for (uint256 i = 0; i < facetsLen; i = i.uncheckedInc()) {
```
[208](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L208)

```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

248: for (uint256 i = 0; i < deploymentsLength; ++i) {
253: for (uint256 i = 0; i < deploymentsLength; ++i) {
```
[248](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L248) | [253](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L253)

```solidity
File: code/system-contracts/contracts/ImmutableSimulator.sol

38: for (uint256 i = 0; i < immutablesLength; ++i) {
```
[38](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ImmutableSimulator.sol#L38)
</details>

### [N-03] Function Parameters in Public Accessible Functions Need `address(0)` Check

Parameters of type `address` in your functions should be checked to ensure that they are not assigned the null address (`address(0x0)`). 
Failure to validate these parameters can lead to transaction reverts, wasted gas, the need for transaction resubmission, and may even require redeployment of contracts within the protocol in certain situations.
Implement checks for `address(0x0)` to avoid these potential issues.

<details>
<summary><i>66 issue instances in 19 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

/// @audit `_token` parameter without address(0) check
63: function tranferTokenToSharedBridge(address _token, uint256 _amount) external {
/// @audit `_l1Token` parameter without address(0) check
75: function l2TokenAddress(address _l1Token) external view returns (address) {
/// @audit `_l2Receiver` parameter without address(0) check
/// @audit `_l1Token` parameter without address(0) check
98: function deposit(
        address _l2Receiver,
        address _l1Token,
        uint256 _amount,
        uint256 _l2TxGasLimit,
        uint256 _l2TxGasPerPubdataByte
    ) external payable returns (bytes32 l2TxHash) {
/// @audit `_l2Receiver` parameter without address(0) check
/// @audit `_l1Token` parameter without address(0) check
/// @audit `_refundRecipient` parameter without address(0) check
133: function deposit(
        address _l2Receiver,
        address _l1Token,
        uint256 _amount,
        uint256 _l2TxGasLimit,
        uint256 _l2TxGasPerPubdataByte,
        address _refundRecipient
    ) public payable nonReentrant returns (bytes32 l2TxHash) {
/// @audit `_depositSender` parameter without address(0) check
/// @audit `_l1Token` parameter without address(0) check
176: function claimFailedDeposit(
        address _depositSender,
        address _l1Token,
        bytes32 _l2TxHash,
        uint256 _l2BatchNumber,
        uint256 _l2MessageIndex,
        uint16 _l2TxNumberInBatch,
        bytes32[] calldata _merkleProof
    ) external nonReentrant {
/// @audit `_token` parameter without address(0) check
63: function tranferTokenToSharedBridge(address _token, uint256 _amount) external {
/// @audit `_l1Token` parameter without address(0) check
75: function l2TokenAddress(address _l1Token) external view returns (address) {
/// @audit `_l2Receiver` parameter without address(0) check
/// @audit `_l1Token` parameter without address(0) check
98: function deposit(
        address _l2Receiver,
        address _l1Token,
        uint256 _amount,
        uint256 _l2TxGasLimit,
        uint256 _l2TxGasPerPubdataByte
    ) external payable returns (bytes32 l2TxHash) {
/// @audit `_l2Receiver` parameter without address(0) check
/// @audit `_l1Token` parameter without address(0) check
/// @audit `_refundRecipient` parameter without address(0) check
133: function deposit(
        address _l2Receiver,
        address _l1Token,
        uint256 _amount,
        uint256 _l2TxGasLimit,
        uint256 _l2TxGasPerPubdataByte,
        address _refundRecipient
    ) public payable nonReentrant returns (bytes32 l2TxHash) {
/// @audit `_depositSender` parameter without address(0) check
/// @audit `_l1Token` parameter without address(0) check
176: function claimFailedDeposit(
        address _depositSender,
        address _l1Token,
        bytes32 _l2TxHash,
        uint256 _l2BatchNumber,
        uint256 _l2MessageIndex,
        uint16 _l2TxNumberInBatch,
        bytes32[] calldata _merkleProof
    ) external nonReentrant {
```
[63](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L63) | [75](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L75) | [98](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L98) | [133](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L133) | [176](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L176) | [63](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L63) | [75](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L75) | [98](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L98) | [133](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L133) | [176](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L176)

```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

/// @audit `_token` parameter without address(0) check
/// @audit `_target` parameter without address(0) check
116: function transferFundsFromLegacy(address _token, address _target, uint256 _targetChainId) external onlyOwner {
/// @audit `_l2BridgeAddress` parameter without address(0) check
142: function initializeChainGovernance(uint256 _chainId, address _l2BridgeAddress) external onlyOwner {
/// @audit `_prevMsgSender` parameter without address(0) check
/// @audit `_l1Token` parameter without address(0) check
148: function bridgehubDepositBaseToken(
        uint256 _chainId,
        address _prevMsgSender,
        address _l1Token,
        uint256 _amount
    ) external payable virtual onlyBridgehubOrEra(_chainId) {
/// @audit `_prevMsgSender` parameter without address(0) check
182: function bridgehubDeposit(
        uint256 _chainId,
        address _prevMsgSender,
        uint256, // l2Value, needed for Weth deposits in the future
        bytes calldata _data
    ) external payable override onlyBridgehub returns (L2TransactionRequestTwoBridgesInner memory request) {
/// @audit `_depositSender` parameter without address(0) check
/// @audit `_l1Token` parameter without address(0) check
277: function claimFailedDeposit(
        uint256 _chainId,
        address _depositSender,
        address _l1Token,
        uint256 _amount,
        bytes32 _l2TxHash,
        uint256 _l2BatchNumber,
        uint256 _l2MessageIndex,
        uint16 _l2TxNumberInBatch,
        bytes32[] calldata _merkleProof
    ) external override {
/// @audit `_prevMsgSender` parameter without address(0) check
/// @audit `_l2Receiver` parameter without address(0) check
/// @audit `_l1Token` parameter without address(0) check
554: function depositLegacyErc20Bridge(
        address _prevMsgSender,
        address _l2Receiver,
        address _l1Token,
        uint256 _amount,
        uint256 _l2TxGasLimit,
        uint256 _l2TxGasPerPubdataByte,
        address _refundRecipient
    ) external payable override onlyLegacyBridge nonReentrant returns (bytes32 l2TxHash) {
/// @audit `_depositSender` parameter without address(0) check
/// @audit `_l1Token` parameter without address(0) check
644: function claimFailedDepositLegacyErc20Bridge(
        address _depositSender,
        address _l1Token,
        uint256 _amount,
        bytes32 _l2TxHash,
        uint256 _l2BatchNumber,
        uint256 _l2MessageIndex,
        uint16 _l2TxNumberInBatch,
        bytes32[] calldata _merkleProof
    ) external override onlyLegacyBridge {
```
[116](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L116) | [142](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L142) | [148](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L148) | [182](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L182) | [277](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L277) | [554](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L554) | [644](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L644)

```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

/// @audit `_owner` parameter without address(0) check
41: function initialize(address _owner) external reentrancyGuardInitializer {
/// @audit `_newPendingAdmin` parameter without address(0) check
51: function setPendingAdmin(address _newPendingAdmin) external onlyOwnerOrAdmin {
/// @audit `_stateTransitionManager` parameter without address(0) check
82: function addStateTransitionManager(address _stateTransitionManager) external onlyOwner {
/// @audit `_stateTransitionManager` parameter without address(0) check
92: function removeStateTransitionManager(address _stateTransitionManager) external onlyOwner {
/// @audit `_token` parameter without address(0) check
101: function addToken(address _token) external onlyOwner {
/// @audit `_sharedBridge` parameter without address(0) check
108: function setSharedBridge(address _sharedBridge) external onlyOwner {
/// @audit `_stateTransitionManager` parameter without address(0) check
/// @audit `_baseToken` parameter without address(0) check
/// @audit `_admin` parameter without address(0) check
114: function createNewChain(
        uint256 _chainId,
        address _stateTransitionManager,
        address _baseToken,
        uint256, //_salt
        address _admin,
        bytes calldata _initData
    ) external onlyOwnerOrAdmin nonReentrant returns (uint256 chainId) {
```
[41](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L41) | [51](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L51) | [82](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L82) | [92](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L92) | [101](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L101) | [108](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L108) | [114](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L114)

```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

/// @audit `_newSecurityCouncil` parameter without address(0) check
256: function updateSecurityCouncil(address _newSecurityCouncil) external onlySelf {
```
[256](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L256)

```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

/// @audit `_newPendingAdmin` parameter without address(0) check
110: function setPendingAdmin(address _newPendingAdmin) external onlyOwnerOrAdmin {
/// @audit `_validatorTimelock` parameter without address(0) check
132: function setValidatorTimelock(address _validatorTimelock) external onlyOwnerOrAdmin {
/// @audit `_stateTransitionContract` parameter without address(0) check
230: function registerAlreadyDeployedStateTransition(
        uint256 _chainId,
        address _stateTransitionContract
    ) external onlyOwner {
/// @audit `_baseToken` parameter without address(0) check
/// @audit `_sharedBridge` parameter without address(0) check
/// @audit `_admin` parameter without address(0) check
239: function createNewChain(
        uint256 _chainId,
        address _baseToken,
        address _sharedBridge,
        address _admin,
        bytes calldata _diamondCut
    ) external onlyBridgehub {
```
[110](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L110) | [132](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L132) | [230](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L230) | [239](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L239)

```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

/// @audit `_newValidator` parameter without address(0) check
78: function addValidator(uint256 _chainId, address _newValidator) external onlyChainAdmin(_chainId) {
/// @audit `_validator` parameter without address(0) check
87: function removeValidator(uint256 _chainId, address _validator) external onlyChainAdmin(_chainId) {
```
[78](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L78) | [87](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L87)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol

/// @audit `_newPendingAdmin` parameter without address(0) check
23: function setPendingAdmin(address _newPendingAdmin) external onlyAdmin {
/// @audit `_validator` parameter without address(0) check
45: function setValidator(address _validator, bool _active) external onlyStateTransitionManager {
```
[23](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L23) | [45](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L45)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol

/// @audit `_address` parameter without address(0) check
112: function isValidator(address _address) external view returns (bool) {
/// @audit `_facet` parameter without address(0) check
163: function isFacetFreezable(address _facet) external view returns (bool isFreezable) {
/// @audit `_facet` parameter without address(0) check
217: function facetFunctionSelectors(address _facet) external view returns (bytes4[] memory) {
```
[112](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L112) | [163](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L163) | [217](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L217)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

/// @audit `_contractL2` parameter without address(0) check
/// @audit `_refundRecipient` parameter without address(0) check
197: function requestL2Transaction(
        address _contractL2,
        uint256 _l2Value,
        bytes calldata _calldata,
        uint256 _l2GasLimit,
        uint256 _l2GasPerPubdataByteLimit,
        bytes[] calldata _factoryDeps,
        address _refundRecipient
    ) external payable returns (bytes32 canonicalTxHash) {
```
[197](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L197)

```solidity
File: code/system-contracts/contracts/AccountCodeStorage.sol

/// @audit `_address` parameter without address(0) check
35: function storeAccountConstructingCodeHash(address _address, bytes32 _hash) external override onlyDeployer {
/// @audit `_address` parameter without address(0) check
46: function storeAccountConstructedCodeHash(address _address, bytes32 _hash) external override onlyDeployer {
/// @audit `_address` parameter without address(0) check
54: function markAccountCodeHashAsConstructed(address _address) external override onlyDeployer {
/// @audit `_address` parameter without address(0) check
78: function getRawCodeHash(address _address) public view override returns (bytes32 codeHash) {
```
[35](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/AccountCodeStorage.sol#L35) | [46](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/AccountCodeStorage.sol#L46) | [54](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/AccountCodeStorage.sol#L54) | [78](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/AccountCodeStorage.sol#L78)

```solidity
File: code/system-contracts/contracts/ComplexUpgrader.sol

/// @audit `_delegateTo` parameter without address(0) check
21: function upgrade(address _delegateTo, bytes calldata _calldata) external payable {
```
[21](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ComplexUpgrader.sol#L21)

```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

/// @audit `_address` parameter without address(0) check
34: function getAccountInfo(address _address) external view returns (AccountInfo memory info) {
/// @audit `_address` parameter without address(0) check
40: function extendedAccountVersion(address _address) public view returns (AccountAbstractionVersion) {
/// @audit `_sender` parameter without address(0) check
95: function getNewAddressCreate2(
        address _sender,
        bytes32 _bytecodeHash,
        bytes32 _salt,
        bytes calldata _input
    ) public view override returns (address newAddress) {
/// @audit `_sender` parameter without address(0) check
115: function getNewAddressCreate(
        address _sender,
        uint256 _senderNonce
    ) public pure override returns (address newAddress) {
/// @audit `_sender` parameter without address(0) check
213: function forceDeployOnAddress(ForceDeployment calldata _deployment, address _sender) external payable onlySelf {
```
[34](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L34) | [40](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L40) | [95](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L95) | [115](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L115) | [213](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L213)

```solidity
File: code/system-contracts/contracts/ImmutableSimulator.sol

/// @audit `_dest` parameter without address(0) check
27: function getImmutable(address _dest, uint256 _index) external view override returns (bytes32) {
/// @audit `_dest` parameter without address(0) check
34: function setImmutables(address _dest, ImmutableData[] calldata _immutables) external override {
```
[27](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ImmutableSimulator.sol#L27) | [34](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ImmutableSimulator.sol#L34)

```solidity
File: code/system-contracts/contracts/L2BaseToken.sol

/// @audit `_from` parameter without address(0) check
/// @audit `_to` parameter without address(0) check
32: function transferFromTo(address _from, address _to, uint256 _amount) external override {
/// @audit `_account` parameter without address(0) check
64: function mint(address _account, uint256 _amount) external override onlyCallFromBootloader {
/// @audit `_l1Receiver` parameter without address(0) check
72: function withdraw(address _l1Receiver) external payable override {
/// @audit `_l1Receiver` parameter without address(0) check
85: function withdrawWithMessage(address _l1Receiver, bytes memory _additionalData) external payable override {
```
[32](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L2BaseToken.sol#L32) | [64](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L2BaseToken.sol#L64) | [72](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L2BaseToken.sol#L72) | [85](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L2BaseToken.sol#L85)

```solidity
File: code/system-contracts/contracts/NonceHolder.sol

/// @audit `_address` parameter without address(0) check
46: function getMinNonce(address _address) public view returns (uint256) {
/// @audit `_address` parameter without address(0) check
57: function getRawNonce(address _address) public view returns (uint256) {
/// @audit `_address` parameter without address(0) check
125: function getDeploymentNonce(address _address) external view returns (uint256 deploymentNonce) {
/// @audit `_address` parameter without address(0) check
135: function incrementDeploymentNonce(address _address) external returns (uint256 prevDeploymentNonce) {
/// @audit `_address` parameter without address(0) check
154: function isNonceUsed(address _address, uint256 _nonce) public view returns (bool) {
/// @audit `_address` parameter without address(0) check
166: function validateNonceUsage(address _address, uint256 _key, bool _shouldBeUsed) external view {
```
[46](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L46) | [57](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L57) | [125](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L125) | [135](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L135) | [154](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L154) | [166](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L166)

```solidity
File: code/system-contracts/contracts/SystemContext.sol

/// @audit `_newOrigin` parameter without address(0) check
99: function setTxOrigin(address _newOrigin) external onlyCallFromBootloader {
```
[99](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L99)

```solidity
File: code/system-contracts/contracts/GasBoundCaller.sol

/// @audit `_to` parameter without address(0) check
35: function gasBoundCall(address _to, uint256 _maxTotalGas, bytes calldata _data) external payable {
```
[35](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/GasBoundCaller.sol#L35)

```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

/// @audit `_l1Sender` parameter without address(0) check
/// @audit `_l2Receiver` parameter without address(0) check
/// @audit `_l1Token` parameter without address(0) check
79: function finalizeDeposit(
        address _l1Sender,
        address _l2Receiver,
        address _l1Token,
        uint256 _amount,
        bytes calldata _data
    ) external payable override {
/// @audit `_l1Receiver` parameter without address(0) check
/// @audit `_l2Token` parameter without address(0) check
123: function withdraw(address _l1Receiver, address _l2Token, uint256 _amount) external override {
/// @audit `_l1Token` parameter without address(0) check
149: function l2TokenAddress(address _l1Token) public view override returns (address) {
```
[79](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L79) | [123](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L123) | [149](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L149)

```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

/// @audit `_to` parameter without address(0) check
145: function bridgeMint(address _to, uint256 _amount) external override onlyBridge {
/// @audit `_from` parameter without address(0) check
154: function bridgeBurn(address _from, uint256 _amount) external override onlyBridge {
```
[145](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L145) | [154](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L154)
</details>

### [N-04] Array indices should be referenced via `enum`s rather than via numeric literals

Using constant array indexes can make your Solidity code harder to read and maintain.
To improve clarity, consider using commented enum values in place of constant array indexes.

Enums provide a way to define a type that has a few pre-defined values, making your code more self-explanatory and easy to understand.
This can be particularly helpful in large codebases or when working with a team.

<details>
<summary><i>41 issue instances in 13 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol

41: s.storedBatchHashes[0]
```
[41](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol#L41)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

39: _newBatch.pubdataCommitments[0]
55: blobHashes[0]
56: blobHashes[1]
66: blobHashes[0]
67: blobCommitments[0]
287: _newBatchesData[0]
```
[39](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L39) | [55](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L55) | [56](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L56) | [66](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L66) | [67](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L67) | [287](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L287)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol

170: ds.facetToSelectors[_facet].selectors[0]
```
[170](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L170)

```solidity
File: code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol

40: _bytecodeHash[0]
41: _bytecodeHash[1]
50: _bytecodeHash[2]
50: _bytecodeHash[3]
```
[40](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L40) | [41](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L41) | [50](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L50) | [50](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L50)

```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol

214: ds.facetToSelectors[_facet].selectors[0]
```
[214](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L214)

```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol

54: _transaction.reserved[0]
55: _transaction.reserved[1]
56: _transaction.reserved[2]
57: _transaction.reserved[3]
```
[54](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L54) | [55](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L55) | [56](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L56) | [57](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L57)

```solidity
File: code/system-contracts/contracts/BootloaderUtilities.sol

72: _transaction.data[0]
91: _transaction.signature[64]
96: _transaction.reserved[0]
168: _transaction.data[0]
190: _transaction.signature[64]
263: _transaction.data[0]
285: _transaction.signature[64]
```
[72](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L72) | [91](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L91) | [96](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L96) | [168](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L168) | [190](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L190) | [263](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L263) | [285](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L285)

```solidity
File: code/system-contracts/contracts/KnownCodesStorage.sol

75: _bytecodeHash[0]
76: _bytecodeHash[1]
```
[75](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/KnownCodesStorage.sol#L75) | [76](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/KnownCodesStorage.sol#L76)

```solidity
File: code/system-contracts/contracts/L1Messenger.sol

230: l2ToL1LogsTreeArray[0]
```
[230](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L230)

```solidity
File: code/system-contracts/contracts/PubdataChunkPublisher.sol

55: blobHashes[0]
56: blobHashes[1]
```
[55](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/PubdataChunkPublisher.sol#L55) | [56](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/PubdataChunkPublisher.sol#L56)

```solidity
File: code/system-contracts/contracts/libraries/RLPEncoder.sol

29: encoded[0]
34: encoded[0]
64: encoded[0]
69: encoded[0]
```
[29](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/RLPEncoder.sol#L29) | [34](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/RLPEncoder.sol#L34) | [64](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/RLPEncoder.sol#L64) | [69](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/RLPEncoder.sol#L69)

```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

175: _transaction.data[0]
184: _transaction.reserved[0]
253: _transaction.data[0]
325: _transaction.data[0]
```
[175](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L175) | [184](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L184) | [253](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L253) | [325](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L325)

```solidity
File: code/system-contracts/contracts/libraries/Utils.sol

46: _bytecodeHash[2]
46: _bytecodeHash[3]
52: _bytecodeHash[1]
57: _bytecodeHash[1]
```
[46](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L46) | [46](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L46) | [52](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L52) | [57](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L57)
</details>

### [N-05] Consider splitting long calculations

For improved readability and maintainability, it's suggested to limit arithmetic operations to 3 per expression.
Excessive operations can convolute the code, making it more prone to errors and more difficult to debug or review.
Splitting operations across multiple lines is often a good approach.
Special care should be taken with division operations. The number of arithmetic operations per line ideally shouldn't exceed three.

<details>
<summary><i>1 issue instances in 1 files:</i></summary>

```solidity
File: code/system-contracts/contracts/L1Messenger.sol

62: SHA256_ROUND_GAS_COST * ((_length + 8) / SHA256_ROUND_NUMBER_OF_BYTES + 1)
```
[62](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L62)
</details>

### [N-06] Use custom errors instead of `require()/assert()`

Starting from Solidity 0.8.4, custom errors have been introduced to improve readability and clarity in your code. Instead of using `require()/assert()` with strings, custom errors can provide more expressive and understandable error conditions.

This change not only reduces unnecessary clutter in your codebase but also promotes a more streamlined contract structure, ultimately improving the quality of your Solidity code.

<details>
<summary><i>339 issue instances in 46 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

64: require(msg.sender == address(sharedBridge), "Not shared bridge")
66: require(amount == _amount, "Incorrect amount")
141: require(_amount != 0, "0T")
143: require(amount == _amount, "3T")
186: require(amount != 0, "2T")
215: require(!isWithdrawalFinalized[_l2BatchNumber][_l2MessageIndex], "pw")
```
[64](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L64) | [66](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L66) | [141](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L141) | [143](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L143) | [186](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L186) | [215](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L215)

```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

64: require(msg.sender == address(sharedBridge), "Not shared bridge")
66: require(amount == _amount, "Incorrect amount")
141: require(_amount != 0, "0T")
143: require(amount == _amount, "3T")
186: require(amount != 0, "2T")
215: require(!isWithdrawalFinalized[_l2BatchNumber][_l2MessageIndex], "pw")
```
[64](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L64) | [66](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L66) | [141](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L141) | [143](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L143) | [186](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L186) | [215](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L215)

```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

69: require(msg.sender == address(bridgehub), "ShB not BH")
75: require(
            msg.sender == address(bridgehub) || (_chainId == ERA_CHAIN_ID && msg.sender == ERA_DIAMOND_PROXY),
            "L1SharedBridge: not bridgehub or era chain"
        )
84: require(msg.sender == address(legacyBridge), "ShB not legacy bridge")
108: require(_owner != address(0), "ShB owner 0")
121: require(balanceAfter > balanceBefore, "ShB: 0 eth transferred")
129: require(amount > 0, "ShB: 0 amount to transfer")
132: require(balanceAfter - balanceBefore == amount, "ShB: wrong amount transferred")
138: require(bridgehub.getStateTransition(_chainId) == msg.sender, "receiveEth not state transition")
155: require(msg.value == _amount, "L1SharedBridge: msg.value not equal to amount")
158: require(msg.value == 0, "ShB m.v > 0 b d.it")
161: require(amount == _amount, "3T")
188: require(l2BridgeAddress[_chainId] != address(0), "ShB l2 bridge not deployed")
194: require(_l1Token != l1WethAddress, "ShB: WETH deposit not supported")
195: require(bridgehub.baseToken(_chainId) != _l1Token, "ShB: baseToken deposit not supported")
200: require(_depositAmount == 0, "ShB wrong withdraw amount")
202: require(msg.value == 0, "ShB m.v > 0 for BH d.it 2")
206: require(withdrawAmount == _depositAmount, "5T")
208: require(amount != 0, "6T")
237: require(depositHappened[_chainId][_txHash] == 0x00, "ShB tx hap")
325: require(proofValid, "yn")
327: require(_amount > 0, "y1")
342: require(dataHash == txDataHash, "ShB: d.it not hap")
349: require(chainBalance[_chainId][_l1Token] >= _amount, "ShB n funds")
360: require(callSuccess, "ShB: claimFailedDeposit failed")
396: require(!legacyBridge.isWithdrawalFinalized(_l2BatchNumber, _l2MessageIndex), "ShB: legacy withdrawal")
417: require(!isWithdrawalFinalized[_chainId][_l2BatchNumber][_l2MessageIndex], "Withdrawal is already finalized")
427: require(!alreadyFinalized, "Withdrawal is already finalized 2")
439: require(chainBalance[_chainId][l1Token] >= amount, "ShB not enough funds 2")
449: require(callSuccess, "ShB: withdraw failed")
484: require(success, "ShB withd w proof")
501: require(_l2ToL1message.length >= 56, "ShB wrong msg len")
517: require(_l2ToL1message.length == 76, "ShB wrong msg len 2")
563: require(l2BridgeAddress[ERA_CHAIN_ID] != address(0), "ShB b. n dep")
564: require(_l1Token != l1WethAddress, "ShB: WETH deposit not supported 2")
```
[69](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L69) | [75](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L75) | [84](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L84) | [108](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L108) | [121](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L121) | [129](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L129) | [132](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L132) | [138](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L138) | [155](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L155) | [158](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L158) | [161](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L161) | [188](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L188) | [194](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L194) | [195](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L195) | [200](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L200) | [202](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L202) | [206](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L206) | [208](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L208) | [237](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L237) | [325](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L325) | [327](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L327) | [342](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L342) | [349](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L349) | [360](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L360) | [396](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L396) | [417](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L417) | [427](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L427) | [439](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L439) | [449](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L449) | [484](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L484) | [501](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L501) | [517](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L517) | [563](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L563) | [564](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L564)

```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

46: require(msg.sender == admin || msg.sender == owner(), "Bridgehub: not owner or admin")
62: require(msg.sender == currentPendingAdmin, "n42")
83: require(
            !stateTransitionManagerIsRegistered[_stateTransitionManager],
            "Bridgehub: state transition already registered"
        )
93: require(
            stateTransitionManagerIsRegistered[_stateTransitionManager],
            "Bridgehub: state transition not registered yet"
        )
102: require(!tokenIsRegistered[_token], "Bridgehub: token already registered")
122: require(_chainId != 0, "Bridgehub: chainId cannot be 0")
123: require(_chainId <= type(uint48).max, "Bridgehub: chainId too large")
125: require(
            stateTransitionManagerIsRegistered[_stateTransitionManager],
            "Bridgehub: state transition not registered"
        )
129: require(tokenIsRegistered[_baseToken], "Bridgehub: token not registered")
130: require(address(sharedBridge) != address(0), "Bridgehub: weth bridge not set")
132: require(stateTransitionManager[_chainId] == address(0), "Bridgehub: chainId already registered")
223: require(msg.value == _request.mintValue, "Bridgehub: msg.value mismatch 1")
225: require(msg.value == 0, "Bridgehub: non-eth bridge with msg.value")
269: require(
                    msg.value == _request.mintValue + _request.secondBridgeValue,
                    "Bridgehub: msg.value mismatch 2"
                )
275: require(msg.value == _request.secondBridgeValue, "Bridgehub: msg.value mismatch 3")
296: require(outputRequest.magicValue == TWO_BRIDGES_MAGIC_VALUE, "Bridgehub: magic value mismatch")
300: require(
            _request.secondBridgeAddress > BRIDGEHUB_MIN_SECOND_BRIDGE_ADDRESS,
            "Bridgehub: second bridge address too low"
        )
```
[46](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L46) | [62](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L62) | [83](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L83) | [93](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L93) | [102](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L102) | [122](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L122) | [123](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L123) | [125](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L125) | [129](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L129) | [130](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L130) | [132](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L132) | [223](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L223) | [225](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L225) | [269](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L269) | [275](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L275) | [296](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L296) | [300](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L300)

```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

42: require(_admin != address(0), "Admin should be non zero address")
59: require(msg.sender == address(this), "Only governance contract itself is allowed to call this function")
65: require(msg.sender == securityCouncil, "Only security council is allowed to call this function")
71: require(
            msg.sender == owner() || msg.sender == securityCouncil,
            "Only the owner and security council are allowed to call this function"
        )
155: require(isOperationPending(_id), "Operation must be pending")
172: require(isOperationReady(id), "Operation must be ready before execution")
177: require(isOperationReady(id), "Operation must be ready after execution")
191: require(isOperationPending(id), "Operation must be pending before execution")
196: require(isOperationPending(id), "Operation must be pending after execution")
216: require(!isOperation(_id), "Operation with this proposal id already exists")
217: require(_delay >= minDelay, "Proposed delay is less than minimum delay")
240: require(_predecessorId == bytes32(0) || isOperationDone(_predecessorId), "Predecessor operation not completed")
```
[42](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L42) | [59](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L59) | [65](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L65) | [71](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L71) | [155](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L155) | [172](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L172) | [177](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L177) | [191](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L191) | [196](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L196) | [216](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L216) | [217](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L217) | [240](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L240)

```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

64: require(msg.sender == bridgehub, "StateTransition: only bridgehub")
70: require(msg.sender == admin || msg.sender == owner(), "Bridgehub: not owner or admin")
82: require(_initializeData.governor != address(0), "StateTransition: governor zero")
106: assert(L2_TO_L1_LOG_SERIALIZE_SIZE != 2 * 32)
121: require(msg.sender == currentPendingAdmin, "n42")
256: require(cutHashInput == initialCutHash, "StateTransition: initial cutHash mismatch")
```
[64](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L64) | [70](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L70) | [82](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L82) | [106](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L106) | [121](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L121) | [256](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L256)

```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

62: require(msg.sender == stateTransitionManager.getChainAdmin(_chainId), "ValidatorTimelock: only chain admin")
68: require(validators[_chainId][msg.sender] == true, "ValidatorTimelock: only validator")
195: require(block.timestamp >= commitBatchTimestamp + delay, "5c")
217: require(block.timestamp >= commitBatchTimestamp + delay, "5c")
```
[62](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L62) | [68](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L68) | [195](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L195) | [217](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L217)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol

25: require(address(_initializeData.verifier) != address(0), "vt")
26: require(_initializeData.admin != address(0), "vy")
27: require(_initializeData.validatorTimelock != address(0), "hc")
28: require(_initializeData.priorityTxMaxGasLimit <= MAX_GAS_PER_TRANSACTION, "vu")
51: assert(L2_TO_L1_LOG_SERIALIZE_SIZE != 2 * 32)
```
[25](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol#L25) | [26](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol#L26) | [27](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol#L27) | [28](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol#L28) | [51](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol#L51)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol

14: require(_chainId == block.chainid, "pr")
25: require(msg.data.length >= 4 || msg.data.length == 0, "Ut")
30: require(facetAddress != address(0), "F")
31: require(!diamondStorage.isFrozen || !facet.isFreezable, "q1")
```
[14](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol#L14) | [25](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol#L25) | [30](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol#L30) | [31](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol#L31)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol

34: require(msg.sender == pendingAdmin, "n4")
59: require(_newPriorityTxMaxGasLimit <= MAX_GAS_PER_TRANSACTION, "n5")
70: require(_newFeeParams.maxPubdataPerBatch >= _newFeeParams.priorityTxMaxPubdata, "n6")
90: require(s.totalBatchesCommitted == 0, "AdminFacet: set validium only after genesis")
105: require(
            cutHashInput == IStateTransitionManager(s.stateTransitionManager).upgradeCutHash(_oldProtocolVersion),
            "StateTransition: cutHash mismatch"
        )
110: require(
            s.protocolVersion == _oldProtocolVersion,
            "StateTransition: protocolVersion mismatch in STC when upgrading"
        )
116: require(
            s.protocolVersion > _oldProtocolVersion,
            "StateTransition: protocolVersion mismatch in STC after upgrading"
        )
136: require(!diamondStorage.isFrozen, "a9")
146: require(diamondStorage.isFrozen, "a7")
```
[34](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L34) | [59](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L59) | [70](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L70) | [90](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L90) | [105](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L105) | [110](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L110) | [116](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L116) | [136](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L136) | [146](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L146)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

37: require(_newBatch.batchNumber == _previousBatch.batchNumber + 1, "f")
40: require(pubdataSource == uint8(PubdataSource.Calldata) || pubdataSource == uint8(PubdataSource.Blob), "us")
50: require(logOutput.pubdataHash == 0x00, "v0h")
51: require(_newBatch.pubdataCommitments.length == 1)
61: require(
                logOutput.pubdataHash ==
                    keccak256(_newBatch.pubdataCommitments[1:_newBatch.pubdataCommitments.length - 32]),
                "wp"
            )
74: require(_previousBatch.batchHash == logOutput.previousBatchHash, "l")
76: require(logOutput.chainedPriorityTxsHash == _newBatch.priorityOperationsHash, "t")
78: require(logOutput.numberOfLayer1Txs == _newBatch.numberOfLayer1Txs, "ta")
110: require(batchTimestamp == _expectedBatchTimestamp, "tb")
114: require(_previousBatchTimestamp < batchTimestamp, "h3")
122: require(block.timestamp - COMMIT_TIMESTAMP_NOT_OLDER <= batchTimestamp, "h1")
123: require(lastL2BlockTimestamp <= block.timestamp + COMMIT_TIMESTAMP_APPROXIMATION_DELTA, "h2")
149: require(!_checkBit(processedLogs, uint8(logKey)), "kp")
154: require(logSender == L2_TO_L1_MESSENGER_SYSTEM_CONTRACT_ADDR, "lm")
157: require(logSender == L2_TO_L1_MESSENGER_SYSTEM_CONTRACT_ADDR, "ln")
160: require(logSender == L2_TO_L1_MESSENGER_SYSTEM_CONTRACT_ADDR, "lb")
163: require(logSender == L2_SYSTEM_CONTEXT_SYSTEM_CONTRACT_ADDR, "sc")
166: require(logSender == L2_SYSTEM_CONTEXT_SYSTEM_CONTRACT_ADDR, "sv")
169: require(logSender == L2_BOOTLOADER_ADDRESS, "bl")
172: require(logSender == L2_BOOTLOADER_ADDRESS, "bk")
175: require(logSender == L2_PUBDATA_CHUNK_PUBLISHER_ADDR, "pc")
178: require(logSender == L2_PUBDATA_CHUNK_PUBLISHER_ADDR, "pd")
181: require(logSender == L2_BOOTLOADER_ADDRESS, "bu")
182: require(_expectedSystemContractUpgradeTxHash == logValue, "ut")
192: require(processedLogs == 511, "b7")
194: require(processedLogs == 1023, "b8")
226: require(
            IStateTransitionManager(s.stateTransitionManager).protocolVersion() == s.protocolVersion,
            "Executor facet: wrong protocol version"
        )
231: require(_newBatchesData.length == 1, "e4")
233: require(s.storedBatchHashes[s.totalBatchesCommitted] == _hashStoredBatchInfo(_lastCommittedBatchData), "i")
284: require(s.l2SystemContractsUpgradeBatchNumber == 0, "ik")
323: require(currentBatchNumber == s.totalBatchesExecuted + _executedBatchIdx + 1, "k")
324: require(
            _hashStoredBatchInfo(_storedBatch) == s.storedBatchHashes[currentBatchNumber],
            "exe10" // executing batch should be committed
        )
330: require(priorityOperationsHash == _storedBatch.priorityOperationsHash, "x")
358: require(newTotalBatchesExecuted <= s.totalBatchesVerified, "n")
402: require(_hashStoredBatchInfo(_prevBatch) == s.storedBatchHashes[currentTotalBatchesVerified], "t1")
407: require(
                _hashStoredBatchInfo(_committedBatches[i]) == s.storedBatchHashes[currentTotalBatchesVerified],
                "o1"
            )
421: require(currentTotalBatchesVerified <= s.totalBatchesCommitted, "q")
426: assert(block.chainid != 1)
442: require(proofPublicInput.length == 1, "t4")
449: require(successVerifyProof, "p")
482: require(s.totalBatchesCommitted > _newLastBatch, "v1")
483: require(_newLastBatch >= s.totalBatchesExecuted, "v2")
543: require(_batch.systemLogs.length <= MAX_L2_TO_L1_LOGS_COMMITMENT_BYTES, "pu")
567: require(_blobCommitments.length == MAX_NUMBER_OF_BLOBS, "b10")
568: require(_blobHashes.length == MAX_NUMBER_OF_BLOBS, "b11")
616: require(success, "failed to call point evaluation precompile")
618: require(result == BLS_MODULUS, "precompile unexpected output")
631: require(_pubdataCommitments.length > 0, "pl")
632: require(_pubdataCommitments.length <= PUBDATA_COMMITMENT_SIZE * MAX_NUMBER_OF_BLOBS, "bd")
633: require(_pubdataCommitments.length % PUBDATA_COMMITMENT_SIZE == 0, "bs")
639: require(blobVersionedHash != bytes32(0), "vh")
663: require(versionedHash == bytes32(0), "lh")
668: require(
                (_blobHashes[i] == bytes32(0) && blobCommitments[i] == bytes32(0)) ||
                    (_blobHashes[i] != bytes32(0) && blobCommitments[i] != bytes32(0)),
                "bh"
            )
681: require(success, "vc")
```
[37](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L37) | [40](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L40) | [50](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L50) | [51](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L51) | [61](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L61) | [74](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L74) | [76](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L76) | [78](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L78) | [110](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L110) | [114](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L114) | [122](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L122) | [123](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L123) | [149](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L149) | [154](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L154) | [157](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L157) | [160](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L160) | [163](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L163) | [166](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L166) | [169](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L169) | [172](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L172) | [175](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L175) | [178](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L178) | [181](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L181) | [182](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L182) | [192](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L192) | [194](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L194) | [226](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L226) | [231](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L231) | [233](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L233) | [284](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L284) | [323](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L323) | [324](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L324) | [330](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L330) | [358](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L358) | [402](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L402) | [407](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L407) | [421](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L421) | [426](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L426) | [442](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L442) | [449](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L449) | [482](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L482) | [483](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L483) | [543](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L543) | [567](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L567) | [568](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L568) | [616](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L616) | [618](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L618) | [631](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L631) | [632](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L632) | [633](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L633) | [639](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L639) | [663](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L663) | [668](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L668) | [681](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L681)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol

183: require(ds.selectorToFacet[_selector].facetAddress != address(0), "g2")
```
[183](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L183)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

39: require(s.chainId == ERA_CHAIN_ID, "transferEthToSharedBridge only available for Era on mailbox")
110: require(_batchNumber <= s.totalBatchesExecuted, "xx")
117: require(hashedLog != L2_L1_LOGS_TREE_DEFAULT_LEAF_HASH, "tw")
158: require(s.baseTokenGasPriceMultiplierDenominator > 0, "Mailbox: baseTokenGasPriceDenominator not set")
185: require(s.chainId == ERA_CHAIN_ID, "finalizeEthWithdrawal only available for Era on mailbox")
206: require(s.chainId == ERA_CHAIN_ID, "legacy interface only available for era token")
243: require(_request.l2GasPerPubdataByteLimit == REQUIRED_L2_GAS_PRICE_PER_PUBDATA, "qp")
264: require(_factoryDeps.length <= MAX_NEW_FACTORY_DEPS, "uj")
272: require(_mintValue >= baseCost + _params.l2Value, "mv")
```
[39](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L39) | [110](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L110) | [117](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L117) | [158](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L158) | [185](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L185) | [206](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L206) | [243](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L243) | [264](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L264) | [272](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L272)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol

16: require(msg.sender == s.admin, "StateTransition Chain: not admin")
22: require(s.validators[msg.sender], "StateTransition Chain: not validator")
27: require(msg.sender == s.stateTransitionManager, "StateTransition Chain: not state transition manager")
32: require(msg.sender == s.bridgehub, "StateTransition Chain: not bridgehub")
37: require(
            msg.sender == s.admin || msg.sender == s.stateTransitionManager,
            "StateTransition Chain: Only by admin or state transition manager"
        )
45: require(
            s.validators[msg.sender] || msg.sender == s.stateTransitionManager,
            "StateTransition Chain: Only by validator or state transition manager"
        )
53: require(msg.sender == s.baseTokenBridge, "Only shared bridge can call this function")
```
[16](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L16) | [22](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L22) | [27](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L27) | [32](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L32) | [37](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L37) | [45](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L45) | [53](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L53)

```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol

72: require(block.timestamp >= _proposedUpgrade.upgradeTimestamp, "Upgrade is not ready yet")
190: require(_l2ProtocolUpgradeTx.txType == SYSTEM_UPGRADE_L2_TX_TYPE, "L2 system upgrade tx type is wrong")
205: require(
            _l2ProtocolUpgradeTx.nonce == _newProtocolVersion,
            "The new protocol version should be included in the L2 system upgrade tx"
        )
223: require(_factoryDeps.length == _expectedHashes.length, "Wrong number of factory deps")
224: require(_factoryDeps.length <= MAX_NEW_FACTORY_DEPS, "Factory deps can be at most 32")
227: require(
                L2ContractHelper.hashL2Bytecode(_factoryDeps[i]) == bytes32(_expectedHashes[i]),
                "Wrong factory dep hash"
            )
238: require(
            _newProtocolVersion > previousProtocolVersion,
            "New protocol version is not greater than the current one"
        )
242: require(
            _newProtocolVersion - previousProtocolVersion <= MAX_ALLOWED_PROTOCOL_VERSION_DELTA,
            "Too big protocol version difference"
        )
249: require(s.l2SystemContractsUpgradeTxHash == bytes32(0), "Previous upgrade has not been finalized")
250: require(
            s.l2SystemContractsUpgradeBatchNumber == 0,
            "The batch number of the previous upgrade has not been cleaned"
        )
```
[72](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L72) | [190](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L190) | [205](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L205) | [223](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L223) | [224](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L224) | [227](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L227) | [238](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L238) | [242](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L242) | [249](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L249) | [250](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L250)

```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol

22: require(
            // Genesis Upgrade difference: Note this is the only thing change > to >=
            _newProtocolVersion >= previousProtocolVersion,
            "New protocol version is not greater than the current one"
        )
27: require(
            _newProtocolVersion - previousProtocolVersion <= MAX_ALLOWED_PROTOCOL_VERSION_DELTA,
            "Too big protocol version difference"
        )
33: require(s.l2SystemContractsUpgradeTxHash == bytes32(0), "Previous upgrade has not been finalized")
34: require(
            s.l2SystemContractsUpgradeBatchNumber == 0,
            "The batch number of the previous upgrade has not been cleaned"
        )
52: require(block.timestamp >= _proposedUpgrade.upgradeTimestamp, "Upgrade is not ready yet")
```
[22](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L22) | [27](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L27) | [33](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L33) | [34](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L34) | [52](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L52)

```solidity
File: code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol

23: require(_bytecode.length % 32 == 0, "pq")
26: require(bytecodeLenInWords < 2 ** 16, "pp")
27: require(bytecodeLenInWords % 2 == 1, "ps")
41: require(version == 1 && _bytecodeHash[1] == bytes1(0), "zf")
43: require(bytecodeLen(_bytecodeHash) % 2 == 1, "uy")
```
[23](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L23) | [26](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L26) | [27](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L27) | [41](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L41) | [43](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L43)

```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol

107: require(selectors.length > 0, "B")
132: require(_facet.code.length > 0, "G")
141: require(oldFacet.facetAddress == address(0), "J")
155: require(_facet.code.length > 0, "K")
161: require(oldFacet.facetAddress != address(0), "L")
175: require(_facet == address(0), "a1")
181: require(oldFacet.facetAddress != address(0), "a2")
215: require(_isSelectorFreezable == ds.selectorToFacet[selector0].isFreezable, "J1")
280: require(_calldata.length == 0, "H")
297: require(data.length == 32, "lp")
298: require(abi.decode(data, (bytes32)) == DIAMOND_INIT_SUCCESS_RETURN_VALUE, "lp1")
```
[107](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L107) | [132](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L132) | [141](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L141) | [155](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L155) | [161](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L161) | [175](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L175) | [181](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L181) | [215](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L215) | [280](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L280) | [297](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L297) | [298](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L298)

```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol

24: require(pathLength > 0, "xc")
25: require(pathLength < 256, "bt")
26: require(_index < (1 << pathLength), "px")
```
[24](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol#L24) | [25](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol#L25) | [26](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol#L26)

```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol

65: require(!_queue.isEmpty(), "D")
73: require(!_queue.isEmpty(), "s")
```
[65](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L65) | [73](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L73)

```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol

28: require(l2GasForTxBody <= _priorityTxMaxGasLimit, "ui")
30: require(l2GasForTxBody / _transaction.gasPerPubdataByteLimit <= _priorityTxMaxPubdata, "uk")
34: require(
            getMinimalPriorityTransactionGasLimit(
                _encoded.length,
                _transaction.factoryDeps.length,
                _transaction.gasPerPubdataByteLimit
            ) <= l2GasForTxBody,
            "up"
        )
48: require(_transaction.from <= type(uint16).max, "ua")
49: require(_transaction.to <= type(uint160).max, "ub")
50: require(_transaction.paymaster == 0, "uc")
51: require(_transaction.value == 0, "ud")
52: require(_transaction.maxFeePerGas == 0, "uq")
53: require(_transaction.maxPriorityFeePerGas == 0, "ux")
54: require(_transaction.reserved[0] == 0, "ue")
55: require(_transaction.reserved[1] <= type(uint160).max, "uf")
56: require(_transaction.reserved[2] == 0, "ug")
57: require(_transaction.reserved[3] == 0, "uo")
58: require(_transaction.signature.length == 0, "uh")
59: require(_transaction.paymasterInput.length == 0, "ul1")
60: require(_transaction.reservedDynamic.length == 0, "um")
115: require(_totalGasLimit >= overhead, "my")
```
[28](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L28) | [30](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L30) | [34](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L34) | [48](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L48) | [49](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L49) | [50](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L50) | [51](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L51) | [52](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L52) | [53](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L53) | [54](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L54) | [55](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L55) | [56](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L56) | [57](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L57) | [58](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L58) | [59](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L59) | [60](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L60) | [115](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L115)

```solidity
File: code/contracts/ethereum/contracts/common/ReentrancyGuard.sol

58: require(lockSlotOldValue == 0, "1B")
75: require(_status == _NOT_ENTERED, "r1")
```
[58](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/ReentrancyGuard.sol#L58) | [75](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/ReentrancyGuard.sol#L75)

```solidity
File: code/system-contracts/contracts/AccountCodeStorage.sol

26: require(msg.sender == address(DEPLOYER_SYSTEM_CONTRACT), "Callable only by the deployer system contract")
37: require(Utils.isContractConstructing(_hash), "Code hash is not for a contract on constructor")
48: require(Utils.isContractConstructed(_hash), "Code hash is not for a constructed contract")
57: require(Utils.isContractConstructing(codeHash), "Code hash is not for a contract on constructor")
```
[26](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/AccountCodeStorage.sol#L26) | [37](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/AccountCodeStorage.sol#L37) | [48](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/AccountCodeStorage.sol#L48) | [57](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/AccountCodeStorage.sol#L57)

```solidity
File: code/system-contracts/contracts/BootloaderUtilities.sol

92: require(vInt == 27 || vInt == 28, "Invalid v value")
191: require(vInt == 27 || vInt == 28, "Invalid v value")
286: require(vInt == 27 || vInt == 28, "Invalid v value")
```
[92](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L92) | [191](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L191) | [286](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L286)

```solidity
File: code/system-contracts/contracts/ComplexUpgrader.sol

22: require(msg.sender == FORCE_DEPLOYER, "Can only be called by FORCE_DEPLOYER")
24: require(_delegateTo.code.length > 0, "Delegatee is an EOA")
```
[22](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ComplexUpgrader.sol#L22) | [24](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ComplexUpgrader.sol#L24)

```solidity
File: code/system-contracts/contracts/Compressor.sol

51: require(
                encodedData.length * 4 == _bytecode.length,
                "Encoded data length should be 4 times shorter than the original bytecode"
            )
56: require(
                dictionary.length / 8 <= encodedData.length / 2,
                "Dictionary should have at most the same number of entries as the encoded data"
            )
63: require(indexOfEncodedChunk < dictionary.length, "Encoded chunk index is out of bounds")
68: require(encodedChunk == realChunk, "Encoded chunk does not match the original bytecode")
119: require(_enumerationIndexSize <= MAX_ENUMERATION_INDEX_SIZE, "enumeration index size is too large")
140: require(derivedKey == _compressedStateDiffs.readBytes32(stateDiffPtr), "iw: initial key mismatch")
156: require(numInitialWritesProcessed == numberOfInitialWrites, "Incorrect number of initial storage diffs")
171: require(enumIndex == compressedEnumIndex, "rw: enum key mismatch")
187: require(stateDiffPtr == _compressedStateDiffs.length, "Extra data in _compressedStateDiffs")
230: require(convertedValue == _finalValue, "transform or no compression: compressed and final mismatch")
232: require(
                    _initialValue + convertedValue == _finalValue,
                    "add: initial plus converted not equal to final"
                )
237: require(
                    _initialValue - convertedValue == _finalValue,
                    "sub: initial minus converted not equal to final"
                )
```
[51](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L51) | [56](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L56) | [63](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L63) | [68](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L68) | [119](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L119) | [140](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L140) | [156](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L156) | [171](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L171) | [187](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L187) | [230](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L230) | [232](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L232) | [237](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L237)

```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

29: require(msg.sender == address(this), "Callable only by self")
77: require(
            _nonceOrdering == AccountNonceOrdering.Arbitrary &&
                currentInfo.nonceOrdering == AccountNonceOrdering.Sequential,
            "It is only possible to change from sequential to arbitrary ordering"
        )
239: require(
            msg.sender == FORCE_DEPLOYER || msg.sender == address(COMPLEX_UPGRADER_CONTRACT),
            "Can only be called by FORCE_DEPLOYER or COMPLEX_UPGRADER_CONTRACT"
        )
251: require(msg.value == sumOfValues, "`value` provided is not equal to the combined `value`s of deployments")
264: require(_bytecodeHash != bytes32(0x0), "BytecodeHash cannot be zero")
265: require(uint160(_newAddress) > MAX_SYSTEM_CONTRACT_ADDRESS, "Can not deploy contracts in kernel space")
268: require(
            ACCOUNT_CODE_STORAGE_SYSTEM_CONTRACT.getCodeHash(uint256(uint160(_newAddress))) == 0x0,
            "Code hash is non-zero"
        )
273: require(NONCE_HOLDER_SYSTEM_CONTRACT.getRawNonce(_newAddress) == 0x00, "Account is occupied")
303: require(knownCodeMarker > 0, "The code hash is not known")
350: require(value == 0, "The value must be zero if we do not call the constructor")
```
[29](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L29) | [77](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L77) | [239](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L239) | [251](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L251) | [264](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L264) | [265](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L265) | [268](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L268) | [273](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L273) | [303](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L303) | [350](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L350)

```solidity
File: code/system-contracts/contracts/DefaultAccount.sol

100: require(totalRequiredBalance <= address(this).balance, "Not enough balance for fee + value")
160: require(_signature.length == 65, "Signature length is incorrect")
173: require(v == 27 || v == 28, "v is neither 27 nor 28")
184: require(uint256(s) <= 0x7FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF5D576E7357A4501DDFE92F46681B20A0, "Invalid s")
202: require(success, "Failed to pay the fee to the operator")
222: assert(msg.sender != BOOTLOADER_FORMAL_ADDRESS)
```
[100](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L100) | [160](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L160) | [173](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L173) | [184](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L184) | [202](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L202) | [222](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L222)

```solidity
File: code/system-contracts/contracts/ImmutableSimulator.sol

35: require(msg.sender == address(DEPLOYER_SYSTEM_CONTRACT), "Callable only by the deployer system contract")
```
[35](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ImmutableSimulator.sol#L35)

```solidity
File: code/system-contracts/contracts/KnownCodesStorage.sol

20: require(msg.sender == address(COMPRESSOR_CONTRACT), "Callable only by the compressor")
76: require(version == 1 && _bytecodeHash[1] == bytes1(0), "Incorrectly formatted bytecodeHash")
78: require(Utils.bytecodeLenInWords(_bytecodeHash) % 2 == 1, "Code length in words must be odd")
```
[20](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/KnownCodesStorage.sol#L20) | [76](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/KnownCodesStorage.sol#L76) | [78](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/KnownCodesStorage.sol#L78)

```solidity
File: code/system-contracts/contracts/L1Messenger.sol

201: require(numberOfL2ToL1Logs <= L2_TO_L1_LOGS_MERKLE_TREE_LEAVES, "Too many L2->L1 logs")
214: require(
            reconstructedChainedLogsHash == chainedLogsHash,
            "reconstructedChainedLogsHash is not equal to chainedLogsHash"
        )
245: require(
            reconstructedChainedMessagesHash == chainedMessagesHash,
            "reconstructedChainedMessagesHash is not equal to chainedMessagesHash"
        )
269: require(
            reconstructedChainedL1BytecodesRevealDataHash == chainedL1BytecodesRevealDataHash,
            "reconstructedChainedL1BytecodesRevealDataHash is not equal to chainedL1BytecodesRevealDataHash"
        )
279: require(
            uint256(uint8(bytes1(_totalL2ToL1PubdataAndStateDiffs[calldataPtr]))) ==
                STATE_DIFF_COMPRESSION_VERSION_NUMBER,
            "state diff compression version mismatch"
        )
298: require(calldataPtr <= MAX_ALLOWED_PUBDATA_PER_BATCH, "L1 Messenger pubdata is too long")
315: require(calldataPtr == _totalL2ToL1PubdataAndStateDiffs.length, "Extra data in the totalL2ToL1Pubdata array")
```
[201](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L201) | [214](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L214) | [245](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L245) | [269](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L269) | [279](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L279) | [298](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L298) | [315](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L315)

```solidity
File: code/system-contracts/contracts/L2BaseToken.sol

33: require(
            msg.sender == MSG_VALUE_SYSTEM_CONTRACT ||
                msg.sender == address(DEPLOYER_SYSTEM_CONTRACT) ||
                msg.sender == BOOTLOADER_FORMAL_ADDRESS,
            "Only system contracts with special access can call this method"
        )
41: require(fromBalance >= _amount, "Transfer amount exceeds balance")
```
[33](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L2BaseToken.sol#L33) | [41](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L2BaseToken.sol#L41)

```solidity
File: code/system-contracts/contracts/MsgValueSimulator.sol

60: require(to != address(this), "MsgValueSimulator calls itself")
```
[60](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/MsgValueSimulator.sol#L60)

```solidity
File: code/system-contracts/contracts/NonceHolder.sol

66: require(_value <= MAXIMAL_MIN_NONCE_INCREMENT, "The value for incrementing the nonce is too high")
85: require(_value != 0, "Nonce value cannot be set to 0")
89: require(isNonceUsed(msg.sender, _key - 1), "Previous nonce has not been used")
115: require(oldMinNonce == _expectedNonce, "Incorrect nonce")
136: require(
            msg.sender == address(DEPLOYER_SYSTEM_CONTRACT),
            "Only the contract deployer can increment the deployment nonce"
        )
```
[66](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L66) | [85](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L85) | [89](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L89) | [115](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L115) | [136](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L136)

```solidity
File: code/system-contracts/contracts/PubdataChunkPublisher.sol

22: require(_pubdata.length <= BLOB_SIZE_BYTES * MAX_NUMBER_OF_BLOBS, "pubdata should fit in 2 blobs")
```
[22](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/PubdataChunkPublisher.sol#L22)

```solidity
File: code/system-contracts/contracts/SystemContext.sol

242: require(_isFirstInBatch, "Upgrade transaction must be first")
245: require(_l2BlockNumber > 0, "L2 block number is never expected to be zero")
249: require(correctPrevBlockHash == _expectedPrevL2BlockHash, "The previous L2 block hash is incorrect")
287: require(_maxVirtualBlocksToCreate > 0, "Can't initialize the first virtual block")
351: require(
                _l2BlockTimestamp >= currentBatchTimestamp,
                "The timestamp of the L2 block must be greater than or equal to the timestamp of the current batch"
            )
355: require(_maxVirtualBlocksToCreate > 0, "There must be a virtual block created at the start of the batch")
367: require(!_isFirstInBatch, "Can not reuse L2 block number from the previous batch")
368: require(currentL2BlockTimestamp == _l2BlockTimestamp, "The timestamp of the same L2 block must be same")
369: require(
                _expectedPrevL2BlockHash == _getLatest257L2blockHash(_l2BlockNumber - 1),
                "The previous hash of the same L2 block must be same"
            )
373: require(_maxVirtualBlocksToCreate == 0, "Can not create virtual blocks in the middle of the miniblock")
385: require(_expectedPrevL2BlockHash == pendingL2BlockHash, "The current L2 block hash is incorrect")
386: require(
                _l2BlockTimestamp > currentL2BlockTimestamp,
                "The timestamp of the new L2 block must be greater than the timestamp of the previous L2 block"
            )
413: require(currentBatchNumber > 0, "The current batch number must be greater than 0")
429: require(
            _newTimestamp > currentBlockTimestamp,
            "The timestamp of the batch must be greater than the timestamp of the previous block"
        )
451: require(_newTimestamp > previousBatchTimestamp, "Timestamps should be incremental")
452: require(previousBatchNumber + 1 == _expectedNewNumber, "The provided block number is not correct")
```
[242](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L242) | [245](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L245) | [249](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L249) | [287](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L287) | [351](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L351) | [355](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L355) | [367](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L367) | [368](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L368) | [369](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L369) | [373](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L373) | [385](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L385) | [386](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L386) | [413](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L413) | [429](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L429) | [451](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L451) | [452](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L452)

```solidity
File: code/system-contracts/contracts/GasBoundCaller.sol

46: require(_maxTotalGas >= gasleft(), "Gas limit is too low")
76: require(pubdataAllowance + gasleft() >= pubdataCost + CALL_RETURN_OVERHEAD, "Not enough gas for pubdata")
```
[46](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/GasBoundCaller.sol#L46) | [76](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/GasBoundCaller.sol#L76)

```solidity
File: code/system-contracts/contracts/libraries/EfficientCall.sol

38: require(returnData.length == 32, "keccak256 returned invalid data")
47: require(returnData.length == 32, "sha returned invalid data")
```
[38](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L38) | [47](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L47)

```solidity
File: code/system-contracts/contracts/libraries/RLPEncoder.sol

50: assert(_len != 1)
```
[50](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/RLPEncoder.sol#L50)

```solidity
File: code/system-contracts/contracts/libraries/SystemContractHelper.sol

319: require(index < 10, "There are only 10 accessible registers")
350: require(precompileCallSuccess, "Failed to charge gas")
```
[319](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L319) | [350](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L350)

```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

363: require(_transaction.paymasterInput.length >= 4, "The standard paymaster input must be at least 4 bytes long")
367: require(
                _transaction.paymasterInput.length >= 68,
                "The approvalBased paymaster input must be at least 68 bytes long"
            )
```
[363](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L363) | [367](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L367)

```solidity
File: code/system-contracts/contracts/libraries/Utils.sol

21: require(_x <= type(uint128).max, "Overflow")
27: require(_x <= type(uint32).max, "Overflow")
33: require(_x <= type(uint24).max, "Overflow")
84: require(_bytecode.length % 32 == 0, "po")
87: require(lengthInWords < 2 ** 16, "pp")
88: require(lengthInWords % 2 == 1, "pr")
```
[21](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L21) | [27](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L27) | [33](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L33) | [84](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L84) | [87](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L87) | [88](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L88)

```solidity
File: code/system-contracts/contracts/interfaces/ISystemContract.sol

21: require(
            SystemContractHelper.isSystemCall() || SystemContractHelper.isSystemContract(msg.sender),
            "This method require system call flag"
        )
31: require(
            SystemContractHelper.isSystemContract(msg.sender),
            "This method require the caller to be system contract"
        )
41: require(msg.sender == caller, "Inappropriate caller")
48: require(msg.sender == BOOTLOADER_FORMAL_ADDRESS, "Callable only by the bootloader")
55: require(msg.sender == FORCE_DEPLOYER)
```
[21](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/ISystemContract.sol#L21) | [31](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/ISystemContract.sol#L31) | [41](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/ISystemContract.sol#L41) | [48](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/ISystemContract.sol#L48) | [55](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/ISystemContract.sol#L55)

```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

55: require(_l1Bridge != address(0), "bf")
56: require(_l2TokenProxyBytecodeHash != bytes32(0), "df")
57: require(_aliasedOwner != address(0), "sf")
58: require(_l2TokenProxyBytecodeHash != bytes32(0), "df")
68: require(_l1LegecyBridge != address(0), "bf2")
87: require(
            AddressAliasHelper.undoL1ToL2Alias(msg.sender) == l1Bridge ||
                AddressAliasHelper.undoL1ToL2Alias(msg.sender) == l1LegacyBridge,
            "mq"
        )
92: require(msg.value == 0, "Value should be 0 for ERC20 bridge")
98: require(deployedToken == expectedL2Token, "mt")
101: require(currentL1Token == _l1Token, "gg")
124: require(_amount > 0, "Amount cannot be zero")
129: require(l1Token != address(0), "yh")
176: require(success, "mk")
```
[55](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L55) | [56](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L56) | [57](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L57) | [58](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L58) | [68](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L68) | [87](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L87) | [92](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L92) | [98](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L98) | [101](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L101) | [124](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L124) | [129](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L129) | [176](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L176)

```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

51: require(_l1Address != address(0), "in6")
120: require(msg.sender == UpgradeableBeacon(beaconAddress).owner(), "tt")
130: require(msg.sender == l2Bridge, "xnt")
137: require(_version == _getInitializedVersion() + 1, "v")
```
[51](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L51) | [120](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L120) | [130](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L130) | [137](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L137)

```solidity
File: code/contracts/zksync/contracts/SystemContractsCaller.sol

28: require(_x <= type(uint32).max, "Overflow")
```
[28](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/SystemContractsCaller.sol#L28)
</details>

### [N-07] Missing Event Emission After Critical Initialize() Function

Emitting an initialization event offers clear, on-chain evidence of the contract's initialization state, enhancing transparency and auditability.
This practice aids users and developers in accurately tracking the contract's lifecycle, pinpointing the precise moment of its initialization.
Moreover, it aligns with best practices for event logging in smart contracts, ensuring that significant state changes are both observable and verifiable through emitted events.

<details>
<summary><i>8 issue instances in 7 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

60: function initialize() external reentrancyGuardInitializer
```
[60](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L60)

```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

60: function initialize() external reentrancyGuardInitializer
```
[60](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L60)

```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

104: function initialize(
        address _owner,
        uint256 _eraFirstPostUpgradeBatch
    ) external reentrancyGuardInitializer initializer
142: function initializeChainGovernance(uint256 _chainId, address _l2BridgeAddress) external onlyOwner
```
[104](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L104) | [142](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L142)

```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

41: function initialize(address _owner) external reentrancyGuardInitializer
```
[41](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L41)

```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

79: function initialize(
        StateTransitionManagerInitializeData calldata _initializeData
    ) external reentrancyGuardInitializer
```
[79](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L79)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol

24: function initialize(InitializeData calldata _initializeData) external reentrancyGuardInitializer returns (bytes32)
```
[24](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol#L24)

```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

49: function initialize(
        address _l1Bridge,
        address _l1LegecyBridge,
        bytes32 _l2TokenProxyBytecodeHash,
        address _aliasedOwner
    ) external reinitializer(2)
```
[49](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L49)
</details>

### [N-08] Mixed usage of `int/uint` with `int256/uint256`

In Solidity, int256 and uint256 are the preferred type names, especially since they are used for function signatures. Using int or uint instead can lead to confusion and inconsistency.
Suggest replacing them with int256 or uint256 respectively, for better clarity and uniformity in your codebase. 
Improving this aspect of your code can contribute to its readability, understandability, and thus maintainability in the long term.

<details>
<summary><i>1 issue instances in 1 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

580: for (uint i = 0; i < MAX_NUMBER_OF_BLOBS; i++) {
```
[580](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L580)
</details>

### [N-09] Avoid Hard-Coded Addresses

It's often better to declare these addresses as immutable and assign them via constructor arguments.
This approach allows the code to remain consistent across deployments on different networks and avoids recompilation when addresses change.

Refactoring your code in this manner can improve its maintainability and flexibility.

<details>
<summary><i>2 issue instances in 2 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol

22: uint160 constant offset = uint160(0x1111000000000000000000000000000000001111);
```
[22](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol#L22)

```solidity
File: code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol

22: uint160 constant offset = uint160(0x1111000000000000000000000000000000001111);
```
[22](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol#L22)
</details>

### [N-10] Variables need not be initialized to zero

By default, `int/uint` variables in Solidity are initialized to `zero`.
Explicitly setting variables to zero during their declaration is redundant and might cause confusion.
Removing the explicit zero initialization can improve code readability and understanding.

<details>
<summary><i>39 issue instances in 15 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

225: for (uint256 i = 0; i < _calls.length; ++i) {
```
[225](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L225)

```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

116: for (uint256 i = 0; i < _newBatchesData.length; ++i) {
135: for (uint256 i = 0; i < _newBatchesData.length; ++i) {
185: for (uint256 i = 0; i < _newBatchesData.length; ++i) {
209: for (uint256 i = 0; i < _newBatchesData.length; ++i) {
```
[116](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L116) | [135](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L135) | [185](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L185) | [209](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L209)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

142: for (uint256 i = 0; i < emittedL2Logs.length; i = i.uncheckedAdd(L2_TO_L1_LOG_SERIALIZE_SIZE)) {
257: for (uint256 i = 0; i < _newBatchesData.length; i = i.uncheckedInc()) {
289: for (uint256 i = 0; i < _newBatchesData.length; i = i.uncheckedInc()) {
311: for (uint256 i = 0; i < _nPriorityOps; i = i.uncheckedInc()) {
351: for (uint256 i = 0; i < nBatches; i = i.uncheckedInc()) {
405: for (uint256 i = 0; i < committedBatchesLength; i = i.uncheckedInc()) {
580: for (uint i = 0; i < MAX_NUMBER_OF_BLOBS; i++) {
629: uint256 versionedHashIndex = 0;
636: for (uint256 i = 0; i < _pubdataCommitments.length; i += PUBDATA_COMMITMENT_SIZE) {
667: for (uint256 i = 0; i < MAX_NUMBER_OF_BLOBS; i++) {
```
[142](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L142) | [257](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L257) | [289](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L289) | [311](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L311) | [351](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L351) | [405](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L405) | [580](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L580) | [629](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L629) | [636](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L636) | [667](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L667)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol

208: for (uint256 i = 0; i < facetsLen; i = i.uncheckedInc()) {
```
[208](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L208)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

356: for (uint256 i = 0; i < factoryDepsLen; i = i.uncheckedInc()) {
```
[356](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L356)

```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol

226: for (uint256 i = 0; i < _factoryDeps.length; ++i) {
```
[226](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L226)

```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol

101: for (uint256 i = 0; i < facetCutsLength; i = i.uncheckedInc()) {
138: for (uint256 i = 0; i < selectorsLength; i = i.uncheckedInc()) {
158: for (uint256 i = 0; i < selectorsLength; i = i.uncheckedInc()) {
178: for (uint256 i = 0; i < selectorsLength; i = i.uncheckedInc()) {
```
[101](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L101) | [138](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L138) | [158](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L158) | [178](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L178)

```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol

92: uint256 costForPubdata = 0;
```
[92](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L92)

```solidity
File: code/contracts/ethereum/contracts/common/Config.sol

37: uint256 constant PRIORITY_EXPIRATION = 0 days;
```
[37](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L37)

```solidity
File: code/system-contracts/contracts/Compressor.sol

61: for (uint256 encodedDataPointer = 0; encodedDataPointer < encodedData.length; encodedDataPointer += 2) {
124: uint256 numInitialWritesProcessed = 0;
127: for (uint256 i = 0; i < _numberOfStateDiffs * STATE_DIFF_ENTRY_SIZE; i += STATE_DIFF_ENTRY_SIZE) {
159: for (uint256 i = 0; i < _numberOfStateDiffs * STATE_DIFF_ENTRY_SIZE; i += STATE_DIFF_ENTRY_SIZE) {
```
[61](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L61) | [124](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L124) | [127](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L127) | [159](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L159)

```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

247: uint256 sumOfValues = 0;
248: for (uint256 i = 0; i < deploymentsLength; ++i) {
253: for (uint256 i = 0; i < deploymentsLength; ++i) {
```
[247](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L247) | [248](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L248) | [253](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L253)

```solidity
File: code/system-contracts/contracts/ImmutableSimulator.sol

38: for (uint256 i = 0; i < immutablesLength; ++i) {
```
[38](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ImmutableSimulator.sol#L38)

```solidity
File: code/system-contracts/contracts/KnownCodesStorage.sol

30: for (uint256 i = 0; i < hashesLen; ++i) {
```
[30](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/KnownCodesStorage.sol#L30)

```solidity
File: code/system-contracts/contracts/L1Messenger.sol

197: uint256 calldataPtr = 0;
206: for (uint256 i = 0; i < numberOfL2ToL1Logs; ++i) {
224: for (uint256 i = 0; i < nodesOnCurrentLevel; ++i) {
236: for (uint256 i = 0; i < numberOfMessages; ++i) {
254: for (uint256 i = 0; i < numberOfBytecodes; ++i) {
```
[197](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L197) | [206](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L206) | [224](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L224) | [236](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L236) | [254](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L254)

```solidity
File: code/system-contracts/contracts/PubdataChunkPublisher.sol

36: for (uint256 i = 0; i < MAX_NUMBER_OF_BLOBS; i++) {
```
[36](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/PubdataChunkPublisher.sol#L36)
</details>

### [N-11] Multiple Interfaces in Single File

Declaring multiple Interfaces within a single file can make code more difficult to understand and maintain. 
It is recommended to declare each interfaces in its own file.

<details>
<summary><i>3 issue instances in 1 files:</i></summary>

```solidity
File: code/contracts/zksync/contracts/L2ContractHelper.sol

18: interface IL2Messenger
30: interface IContractDeployer
61: interface IBaseToken
```
[18](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/L2ContractHelper.sol#L18) | [30](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/L2ContractHelper.sol#L30) | [61](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/L2ContractHelper.sol#L61)
</details>

### [N-12] Multiple Libraries in One File

Declaring multiple Libraries within a single file can make code more difficult to understand and maintain. 
It is recommended to declare each library in its own file.

<details>
<summary><i>2 issue instances in 1 files:</i></summary>

```solidity
File: code/contracts/zksync/contracts/SystemContractsCaller.sol

26: library Utils
36: library SystemContractsCaller
```
[26](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/SystemContractsCaller.sol#L26) | [36](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/SystemContractsCaller.sol#L36)
</details>

### [N-13] `require()/revert()` statements without reason strings

In Solidity, require() and revert() functions can include an optional 'reason' string that describes what caused the function to fail. This string can be incredibly helpful during testing and debugging, as it provides more context for what went wrong.

Some `require()/revert()` statements do not have these descriptive reason strings. For better error handling and debugging, it is strongly recommended to add descriptive reason strings to all `require()/revert()` statements.

<details>
<summary><i>5 issue instances in 3 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

51: require(_newBatch.pubdataCommitments.length == 1)
```
[51](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L51)

```solidity
File: code/system-contracts/contracts/interfaces/ISystemContract.sol

55: require(msg.sender == FORCE_DEPLOYER)
```
[55](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/ISystemContract.sol#L55)

```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

161: revert()
167: revert()
173: revert()
```
[161](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L161) | [167](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L167) | [173](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L173)
</details>

### [N-14] Multiple `address`/ID mappings can be combined into a single `mapping` of an `address`/ID to a `struct`, for readability

Combining multiple address/ID mappings into a single mapping to a struct can enhance code clarity and maintainability. 
Consider refactoring multiple mappings into a single mapping with a struct for cleaner code structure.
This arrangement also promotes a more organized contract structure, making it easier for developers to navigate and understand.

<details>
<summary><i>23 issue instances in 7 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

32: mapping(address account => mapping(address l1Token => mapping(bytes32 depositL2TxHash => uint256 amount)))
        public depositAmount
45: mapping(address => uint256) private __DEPRECATED_lastWithdrawalLimitReset
48: mapping(address => uint256) private __DEPRECATED_withdrawnAmountInWindow
51: mapping(address => mapping(address => uint256)) private __DEPRECATED_totalDepositedAmountPerUser
```
[32](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L32) | [45](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L45) | [48](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L48) | [51](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L51)

```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

32: mapping(address account => mapping(address l1Token => mapping(bytes32 depositL2TxHash => uint256 amount)))
        public depositAmount
45: mapping(address => uint256) private __DEPRECATED_lastWithdrawalLimitReset
48: mapping(address => uint256) private __DEPRECATED_withdrawnAmountInWindow
51: mapping(address => mapping(address => uint256)) private __DEPRECATED_totalDepositedAmountPerUser
```
[32](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L32) | [45](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L45) | [48](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L48) | [51](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L51)

```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

48: mapping(uint256 chainId => address l2Bridge) public override l2BridgeAddress
52: mapping(uint256 chainId => mapping(bytes32 l2DepositTxHash => bytes32 depositDataHash))
        public
        override depositHappened
57: mapping(uint256 chainId => mapping(uint256 l2BatchNumber => mapping(uint256 l2ToL1MessageNumber => bool isFinalized)))
        public isWithdrawalFinalized
61: mapping(uint256 chainId => bool enabled) internal hyperbridgingEnabled
65: mapping(uint256 chainId => mapping(address l1Token => uint256 balance)) internal chainBalance
```
[48](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L48) | [52](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L52) | [57](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L57) | [61](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L61) | [65](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L65)

```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

21: mapping(address _stateTransitionManager => bool) public stateTransitionManagerIsRegistered
23: mapping(address _token => bool) public tokenIsRegistered
26: mapping(uint256 _chainId => address) public stateTransitionManager
29: mapping(uint256 _chainId => address) public baseToken
```
[21](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L21) | [23](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L23) | [26](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L26) | [29](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L29)

```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

30: mapping(uint256 => address) public stateTransition
48: mapping(uint256 => bytes32) public upgradeCutHash
```
[30](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L30) | [48](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L48)

```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

47: mapping(uint256 => LibMap.Uint32Map) internal committedBatchTimestamp
50: mapping(uint256 _chainId => mapping(address _validator => bool)) public validators
```
[47](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L47) | [50](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L50)

```solidity
File: code/system-contracts/contracts/NonceHolder.sol

36: mapping(uint256 account => uint256 packedMinAndDeploymentNonce) internal rawNonces
41: mapping(uint256 account => mapping(uint256 nonceKey => uint256 value)) internal nonceValues
```
[36](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L36) | [41](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L41)
</details>

### [N-15] Consider returning a `struct` rather than having multiple `return` values

Functions that return many variables can become difficult to read and maintain.
Using a struct to encapsulate these return values can improve code readability, increase reusability, and reduce the likelihood of errors.
Consider refactoring functions that return more than three variables to use a struct instead.

<details>
<summary><i>5 issue instances in 2 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

409: function _finalizeWithdrawal(
        uint256 _chainId,
        uint256 _l2BatchNumber,
        uint256 _l2MessageIndex,
        uint16 _l2TxNumberInBatch,
        bytes calldata _message,
        bytes32[] calldata _merkleProof
    ) internal nonReentrant returns (address l1Receiver, address l1Token, uint256 amount)
458: function _checkWithdrawal(
        uint256 _chainId,
        MessageParams memory _messageParams,
        bytes calldata _message,
        bytes32[] calldata _merkleProof
    ) internal view returns (address l1Receiver, address l1Token, uint256 amount)
487: function _parseL2WithdrawalMessage(
        uint256 _chainId,
        bytes memory _l2ToL1message
    ) internal view returns (address l1Receiver, address l1Token, uint256 amount)
615: function finalizeWithdrawalLegacyErc20Bridge(
        uint256 _l2BatchNumber,
        uint256 _l2MessageIndex,
        uint16 _l2TxNumberInBatch,
        bytes calldata _message,
        bytes32[] calldata _merkleProof
    ) external override onlyLegacyBridge returns (address l1Receiver, address l1Token, uint256 amount)
```
[409](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L409) | [458](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L458) | [487](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L487) | [615](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L615)

```solidity
File: code/system-contracts/contracts/MsgValueSimulator.sol

25: function _getAbiParams() internal view returns (uint256 value, bool isSystemCall, address to)
```
[25](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/MsgValueSimulator.sol#L25)
</details>

### [N-16] Consider using a `struct` rather than having many function input parameters

Functions with many parameters can become difficult to read and maintain. 
Using a struct to encapsulate these parameters can improve code readability, increase reusability, and reduce the likelihood of errors.
Consider refactoring functions that take more than three parameters to use a struct instead.

<details>
<summary><i>35 issue instances in 13 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

98: function deposit(
        address _l2Receiver,
        address _l1Token,
        uint256 _amount,
        uint256 _l2TxGasLimit,
        uint256 _l2TxGasPerPubdataByte
    ) external payable returns (bytes32 l2TxHash)
133: function deposit(
        address _l2Receiver,
        address _l1Token,
        uint256 _amount,
        uint256 _l2TxGasLimit,
        uint256 _l2TxGasPerPubdataByte,
        address _refundRecipient
    ) public payable nonReentrant returns (bytes32 l2TxHash)
176: function claimFailedDeposit(
        address _depositSender,
        address _l1Token,
        bytes32 _l2TxHash,
        uint256 _l2BatchNumber,
        uint256 _l2MessageIndex,
        uint16 _l2TxNumberInBatch,
        bytes32[] calldata _merkleProof
    ) external nonReentrant
208: function finalizeWithdrawal(
        uint256 _l2BatchNumber,
        uint256 _l2MessageIndex,
        uint16 _l2TxNumberInBatch,
        bytes calldata _message,
        bytes32[] calldata _merkleProof
    ) external nonReentrant
```
[98](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L98) | [133](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L133) | [176](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L176) | [208](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L208)

```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

98: function deposit(
        address _l2Receiver,
        address _l1Token,
        uint256 _amount,
        uint256 _l2TxGasLimit,
        uint256 _l2TxGasPerPubdataByte
    ) external payable returns (bytes32 l2TxHash)
133: function deposit(
        address _l2Receiver,
        address _l1Token,
        uint256 _amount,
        uint256 _l2TxGasLimit,
        uint256 _l2TxGasPerPubdataByte,
        address _refundRecipient
    ) public payable nonReentrant returns (bytes32 l2TxHash)
176: function claimFailedDeposit(
        address _depositSender,
        address _l1Token,
        bytes32 _l2TxHash,
        uint256 _l2BatchNumber,
        uint256 _l2MessageIndex,
        uint16 _l2TxNumberInBatch,
        bytes32[] calldata _merkleProof
    ) external nonReentrant
208: function finalizeWithdrawal(
        uint256 _l2BatchNumber,
        uint256 _l2MessageIndex,
        uint16 _l2TxNumberInBatch,
        bytes calldata _message,
        bytes32[] calldata _merkleProof
    ) external nonReentrant
```
[98](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L98) | [133](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L133) | [176](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L176) | [208](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L208)

```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

277: function claimFailedDeposit(
        uint256 _chainId,
        address _depositSender,
        address _l1Token,
        uint256 _amount,
        bytes32 _l2TxHash,
        uint256 _l2BatchNumber,
        uint256 _l2MessageIndex,
        uint16 _l2TxNumberInBatch,
        bytes32[] calldata _merkleProof
    ) external override
303: function _claimFailedDeposit(
        bool _checkedInLegacyBridge,
        uint256 _chainId,
        address _depositSender,
        address _l1Token,
        uint256 _amount,
        bytes32 _l2TxHash,
        uint256 _l2BatchNumber,
        uint256 _l2MessageIndex,
        uint16 _l2TxNumberInBatch,
        bytes32[] calldata _merkleProof
    ) internal nonReentrant
385: function finalizeWithdrawal(
        uint256 _chainId,
        uint256 _l2BatchNumber,
        uint256 _l2MessageIndex,
        uint16 _l2TxNumberInBatch,
        bytes calldata _message,
        bytes32[] calldata _merkleProof
    ) external override
409: function _finalizeWithdrawal(
        uint256 _chainId,
        uint256 _l2BatchNumber,
        uint256 _l2MessageIndex,
        uint16 _l2TxNumberInBatch,
        bytes calldata _message,
        bytes32[] calldata _merkleProof
    ) internal nonReentrant returns (address l1Receiver, address l1Token, uint256 amount)
554: function depositLegacyErc20Bridge(
        address _prevMsgSender,
        address _l2Receiver,
        address _l1Token,
        uint256 _amount,
        uint256 _l2TxGasLimit,
        uint256 _l2TxGasPerPubdataByte,
        address _refundRecipient
    ) external payable override onlyLegacyBridge nonReentrant returns (bytes32 l2TxHash)
615: function finalizeWithdrawalLegacyErc20Bridge(
        uint256 _l2BatchNumber,
        uint256 _l2MessageIndex,
        uint16 _l2TxNumberInBatch,
        bytes calldata _message,
        bytes32[] calldata _merkleProof
    ) external override onlyLegacyBridge returns (address l1Receiver, address l1Token, uint256 amount)
644: function claimFailedDepositLegacyErc20Bridge(
        address _depositSender,
        address _l1Token,
        uint256 _amount,
        bytes32 _l2TxHash,
        uint256 _l2BatchNumber,
        uint256 _l2MessageIndex,
        uint16 _l2TxNumberInBatch,
        bytes32[] calldata _merkleProof
    ) external override onlyLegacyBridge
```
[277](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L277) | [303](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L303) | [385](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L385) | [409](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L409) | [554](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L554) | [615](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L615) | [644](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L644)

```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

114: function createNewChain(
        uint256 _chainId,
        address _stateTransitionManager,
        address _baseToken,
        uint256, //_salt
        address _admin,
        bytes calldata _initData
    ) external onlyOwnerOrAdmin nonReentrant returns (uint256 chainId)
152: function proveL2MessageInclusion(
        uint256 _chainId,
        uint256 _batchNumber,
        uint256 _index,
        L2Message calldata _message,
        bytes32[] calldata _proof
    ) external view override returns (bool)
164: function proveL2LogInclusion(
        uint256 _chainId,
        uint256 _batchNumber,
        uint256 _index,
        L2Log memory _log,
        bytes32[] calldata _proof
    ) external view override returns (bool)
176: function proveL1ToL2TransactionStatus(
        uint256 _chainId,
        bytes32 _l2TxHash,
        uint256 _l2BatchNumber,
        uint256 _l2MessageIndex,
        uint16 _l2TxNumberInBatch,
        bytes32[] calldata _merkleProof,
        TxStatus _status
    ) external view override returns (bool)
```
[114](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L114) | [152](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L152) | [164](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L164) | [176](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L176)

```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

239: function createNewChain(
        uint256 _chainId,
        address _baseToken,
        address _sharedBridge,
        address _admin,
        bytes calldata _diamondCut
    ) external onlyBridgehub
```
[239](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L239)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

74: function proveL1ToL2TransactionStatus(
        bytes32 _l2TxHash,
        uint256 _l2BatchNumber,
        uint256 _l2MessageIndex,
        uint16 _l2TxNumberInBatch,
        bytes32[] calldata _merkleProof,
        TxStatus _status
    ) public view returns (bool)
178: function finalizeEthWithdrawal(
        uint256 _l2BatchNumber,
        uint256 _l2MessageIndex,
        uint16 _l2TxNumberInBatch,
        bytes calldata _message,
        bytes32[] calldata _merkleProof
    ) external nonReentrant
197: function requestL2Transaction(
        address _contractL2,
        uint256 _l2Value,
        bytes calldata _calldata,
        uint256 _l2GasLimit,
        uint256 _l2GasPerPubdataByteLimit,
        bytes[] calldata _factoryDeps,
        address _refundRecipient
    ) external payable returns (bytes32 canonicalTxHash)
```
[74](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L74) | [178](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L178) | [197](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L197)

```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

321: function _constructContract(
        address _sender,
        address _newAddress,
        bytes32 _bytecodeHash,
        bytes calldata _input,
        bool _isSystem,
        bool _callConstructor
    ) internal
```
[321](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L321)

```solidity
File: code/system-contracts/contracts/SystemContext.sol

341: function setL2Block(
        uint128 _l2BlockNumber,
        uint128 _l2BlockTimestamp,
        bytes32 _expectedPrevL2BlockHash,
        bool _isFirstInBatch,
        uint128 _maxVirtualBlocksToCreate
    ) external onlyCallFromBootloader
```
[341](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L341)

```solidity
File: code/system-contracts/contracts/libraries/EfficientCall.sol

58: function call(
        uint256 _gas,
        address _address,
        uint256 _value,
        bytes calldata _data,
        bool _isSystem
    ) internal returns (bytes memory returnData)
105: function mimicCall(
        uint256 _gas,
        address _address,
        bytes calldata _data,
        address _whoToMimic,
        bool _isConstructor,
        bool _isSystem
    ) internal returns (bytes memory returnData)
124: function rawCall(
        uint256 _gas,
        address _address,
        uint256 _value,
        bytes calldata _data,
        bool _isSystem
    ) internal returns (bool success)
191: function rawMimicCall(
        uint256 _gas,
        address _address,
        bytes calldata _data,
        address _whoToMimic,
        bool _isConstructor,
        bool _isSystem
    ) internal returns (bool success)
```
[58](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L58) | [105](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L105) | [124](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L124) | [191](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L191)

```solidity
File: code/system-contracts/contracts/libraries/SystemContractHelper.sol

124: function packPrecompileParams(
        uint32 _inputMemoryOffset,
        uint32 _inputMemoryLength,
        uint32 _outputMemoryOffset,
        uint32 _outputMemoryLength,
        uint64 _perPrecompileInterpreted
    ) internal pure returns (uint256 rawParams)
```
[124](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L124)

```solidity
File: code/system-contracts/contracts/libraries/SystemContractsCaller.sol

214: function getFarCallABI(
        uint32 dataOffset,
        uint32 memoryPage,
        uint32 dataStart,
        uint32 dataLength,
        uint32 gasPassed,
        uint8 shardId,
        CalldataForwardingMode forwardingMode,
        bool isConstructorCall,
        bool isSystemCall
    ) internal pure returns (uint256 farCallAbi)
250: function getFarCallABIWithEmptyFatPointer(
        uint32 gasPassed,
        uint8 shardId,
        CalldataForwardingMode forwardingMode,
        bool isConstructorCall,
        bool isSystemCall
    ) internal pure returns (uint256 farCallAbiWithEmptyFatPtr)
```
[214](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L214) | [250](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L250)

```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

79: function finalizeDeposit(
        address _l1Sender,
        address _l2Receiver,
        address _l1Token,
        uint256 _amount,
        bytes calldata _data
    ) external payable override
```
[79](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L79)

```solidity
File: code/contracts/zksync/contracts/SystemContractsCaller.sol

95: function getFarCallABI(
        uint32 dataOffset,
        uint32 memoryPage,
        uint32 dataStart,
        uint32 dataLength,
        uint32 gasPassed,
        uint8 shardId,
        CalldataForwardingMode forwardingMode,
        bool isConstructorCall,
        bool isSystemCall
    ) internal pure returns (uint256 farCallAbi)
121: function getFarCallABIWithEmptyFatPointer(
        uint32 gasPassed,
        uint8 shardId,
        CalldataForwardingMode forwardingMode,
        bool isConstructorCall,
        bool isSystemCall
    ) internal pure returns (uint256 farCallAbiWithEmptyFatPtr)
```
[95](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/SystemContractsCaller.sol#L95) | [121](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/SystemContractsCaller.sol#L121)
</details>

### [N-17] Prefer Custom Errors Over Unnamed `revert()`

Using custom error types with `revert()` in Solidity provides clearer, more informative error handling compared to unnamed `revert()` calls.
Custom errors, introduced in Solidity 0.8.4, allow you to define specific error conditions with descriptive names and optionally include additional data about the error.

<details>
<summary><i>14 issue instances in 9 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

522: revert("ShB Incorrect message function selector")
```
[522](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L522)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

184: revert("ul")
```
[184](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L184)

```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol

116: revert("C")
287: revert("I")
```
[116](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L116) | [287](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L287)

```solidity
File: code/system-contracts/contracts/BootloaderUtilities.sol

37: revert("Unsupported tx type")
```
[37](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L37)

```solidity
File: code/system-contracts/contracts/Compressor.sol

242: revert("unsupported operation")
```
[242](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L242)

```solidity
File: code/system-contracts/contracts/NonceHolder.sol

170: revert("Reusing the same nonce twice")
172: revert("The nonce was not set as used")
```
[170](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L170) | [172](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L172)

```solidity
File: code/system-contracts/contracts/SystemContext.sol

394: revert("Invalid new L2 block number")
```
[394](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L394)

```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

112: revert("Encoding unsupported tx")
388: revert("Unsupported paymaster flow")
```
[112](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L112) | [388](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L388)

```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

161: revert()
167: revert()
173: revert()
```
[161](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L161) | [167](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L167) | [173](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L173)
</details>

### [N-18] Simplify complex require statements

Simplifying complex require statements with local variables and if(or revert) statements can improve readability, make debugging easier, and promote modularity and reusability in the code.

<details>
<summary><i>3 issue instances in 3 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

75: require(
            msg.sender == address(bridgehub) || (_chainId == ERA_CHAIN_ID && msg.sender == ERA_DIAMOND_PROXY),
            "L1SharedBridge: not bridgehub or era chain"
        )
```
[75](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L75)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

668: require(
                (_blobHashes[i] == bytes32(0) && blobCommitments[i] == bytes32(0)) ||
                    (_blobHashes[i] != bytes32(0) && blobCommitments[i] != bytes32(0)),
                "bh"
            )
```
[668](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L668)

```solidity
File: code/system-contracts/contracts/L2BaseToken.sol

33: require(
            msg.sender == MSG_VALUE_SYSTEM_CONTRACT ||
                msg.sender == address(DEPLOYER_SYSTEM_CONTRACT) ||
                msg.sender == BOOTLOADER_FORMAL_ADDRESS,
            "Only system contracts with special access can call this method"
        )
```
[33](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L2BaseToken.sol#L33)
</details>

### [N-19] Consider using descriptive `constant`s when passing zero as a function argument

In instances where utilizing a zero parameter is essential, it is recommended to employ descriptive constants or an enum instead of directly integrating zero within function calls.
This strategy aids in clearly articulating the caller's intention and minimizes the risk of errors.
Emitting zero also not recomended, as it is not clear what the intention is.

<details>
<summary><i>20 issue instances in 14 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

223: bytes[](0)
503: UnsafeBytes.readUint32(_l2ToL1message, 0)
592: bytes[](0)
```
[223](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L223) | [503](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L503) | [592](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L592)

```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

50: ChangeMinDelay(0, _minDelay)
```
[50](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L50)

```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

90: IExecutor.StoredBatchInfo(
            0,
            _initializeData.genesisBatchHash,
            _initializeData.genesisIndexRepeatedStorageChanges,
            0,
            EMPTY_STRING_KECCAK,
            DEFAULT_L2_LOGS_TREE_ROOT_HASH,
            0,
            _initializeData.genesisBatchCommitment
        )
```
[90](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L90)

```solidity
File: code/system-contracts/contracts/BootloaderUtilities.sol

176: RLPEncoder.encodeListLen(0)
271: RLPEncoder.encodeListLen(0)
```
[176](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L176) | [271](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L271)

```solidity
File: code/system-contracts/contracts/Compressor.sol

121: _compressedStateDiffs.readUint16(0)
202: _rawCompressedData.readUint16(0)
```
[121](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L121) | [202](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L202)

```solidity
File: code/system-contracts/contracts/DefaultAccount.sol

83: SystemContractsCaller.systemCallWithPropagatedRevert(
            uint32(gasleft()),
            address(NONCE_HOLDER_SYSTEM_CONTRACT),
            0,
            abi.encodeCall(INonceHolder.incrementMinNonceIfEquals, (_transaction.nonce))
        )
```
[83](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L83)

```solidity
File: code/system-contracts/contracts/L1Messenger.sol

90: SystemContractHelper.burnGas(Utils.safeCastToU32(gasToPay), 0)
```
[90](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L90)

```solidity
File: code/system-contracts/contracts/MsgValueSimulator.sol

26: SystemContractHelper.getExtraAbiData(0)
```
[26](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/MsgValueSimulator.sol#L26)

```solidity
File: code/system-contracts/contracts/libraries/EfficientCall.sol

265: SystemContractsCaller.getFarCallABIWithEmptyFatPointer(
            gas,
            // Only rollup is supported for now
            0,
            CalldataForwardingMode.ForwardFatPointer,
            _isConstructor,
            _isSystem
        )
```
[265](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L265)

```solidity
File: code/system-contracts/contracts/libraries/SystemContractHelper.sol

345: unsafePrecompileCall(
            0, // The precompile parameters are formal ones. We only need the precompile call to burn gas.
            _gasToPay,
            _pubdataToSpend
        )
```
[345](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L345)

```solidity
File: code/system-contracts/contracts/libraries/SystemContractsCaller.sol

85: SystemContractsCaller.getFarCallABI(
            0,
            0,
            dataStart,
            dataLength,
            gasLimit,
            // Only rollup is supported for now
            0,
            CalldataForwardingMode.UseHeap,
            false,
            true
        )
```
[85](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L85)

```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

261: RLPEncoder.encodeListLen(0)
333: RLPEncoder.encodeListLen(0)
382: IERC20(token).safeApprove(paymaster, 0)
```
[261](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L261) | [333](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L333) | [382](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L382)

```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

165: SystemContractsCaller.systemCallWithReturndata(
            uint32(gasleft()),
            DEPLOYER_SYSTEM_CONTRACT,
            0,
            abi.encodeCall(
                IContractDeployer.create2,
                (salt, l2TokenProxyBytecodeHash, abi.encode(address(l2TokenBeacon), ""))
            )
        )
```
[165](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L165)

```solidity
File: code/contracts/zksync/contracts/SystemContractsCaller.sol

46: getFarCallABI(
            0,
            0,
            dataStart,
            dataLength,
            gasLimit,
            // Only rollup is supported for now
            0,
            CalldataForwardingMode.UseHeap,
            false,
            true
        )
```
[46](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/SystemContractsCaller.sol#L46)
</details>

### [N-20] Avoid Empty Blocks in Code

Empty blocks in code can lead to confusion and the introduction of errors when the code is later modified.
They should be removed, or the block should do something useful, such as emitting an event or reverting. 

For contracts meant to be extended, the contract should be abstract and the function signatures added without any default implementation. 

<details>
<summary><i>8 issue instances in 6 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

60: function initialize() external reentrancyGuardInitializer {}
```
[60](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L60)

```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

60: function initialize() external reentrancyGuardInitializer {}
```
[60](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L60)

```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

262: receive() external payable {}
```
[262](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L262)

```solidity
File: code/system-contracts/contracts/DefaultAccount.sol

125: function executeTransactionFromOutside(Transaction calldata _transaction) external payable override {
        // Behave the same as for fallback/receive, just execute nothing, returns nothing
    }
227: receive() external payable {
        // If the contract is called directly, behave like an EOA
    }
```
[125](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L125) | [227](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L227)

```solidity
File: code/system-contracts/contracts/EmptyContract.sol

11: fallback() external payable {}
13: receive() external payable {}
```
[11](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/EmptyContract.sol#L11) | [13](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/EmptyContract.sol#L13)

```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

385: if (paymasterInputSelector == IPaymasterFlow.general.selector) {
            // Do nothing. general(bytes) paymaster flow means that the paymaster must interpret these bytes on his own.
        }
```
[385](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L385)
</details>

### [N-21] File with Library declaration Shoulde contain only Library

Libraries should be declared in a separate file and not in the same file where other contract/interfases declared.
This helps in maintaining a clean and organized codebase.

<details>
<summary><i>4 issue instances in 1 files:</i></summary>

```solidity
File: code/contracts/zksync/contracts/L2ContractHelper.sol

83: library L2ContractHelper
18: interface IL2Messenger
30: interface IContractDeployer
61: interface IBaseToken
```
[83](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/L2ContractHelper.sol#L83) | [18](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/L2ContractHelper.sol#L18) | [30](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/L2ContractHelper.sol#L30) | [61](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/L2ContractHelper.sol#L61)
</details>

### [N-22] Consider Using Parameters in Events

Events serve as the main logging mechanism for smart contracts and should ideally provide comprehensive details about a state change.
It's beneficial to use parameters in events to convey more granular information.
For instance, instead of having separate `Paused()` and `Unpaused()` events, a more descriptive single event like `PauseState(address indexed whoChangedIt, bool wasPaused, bool isNowPaused)` would be clearer and more informative.

<details>
<summary><i>2 issue instances in 1 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol

94: event Freeze()
97: event Unfreeze()
```
[94](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L94) | [97](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L97)
</details>

### [N-23] Consider using OpenZeppelin's SafeCast for any casting

OpenZeppelin's has `SafeCast` library that provides functions to safely cast. Recommended to use it instead of casting directly in any case.

<details>
<summary><i>255 issue instances in 34 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

77: uint256(uint160(_l1Token))
77: uint160(_l1Token)
```
[77](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L77) | [77](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L77)

```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

77: uint256(uint160(_l1Token))
77: uint160(_l1Token)
```
[77](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L77) | [77](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L77)

```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

258: uint8(18)
```
[258](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L258)

```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

184: uint256(uint160(L2_FORCE_DEPLOYER_ADDR))
184: uint160(L2_FORCE_DEPLOYER_ADDR)
185: uint256(uint160(L2_SYSTEM_CONTEXT_SYSTEM_CONTRACT_ADDR))
185: uint160(L2_SYSTEM_CONTEXT_SYSTEM_CONTRACT_ADDR)
188: uint256(0)
189: uint256(0)
190: uint256(0)
194: uint256(0)
264: uint256(uint160(bridgehub))
264: uint160(bridgehub)
265: uint256(uint160(address(this)))
265: uint160(address(this))
266: uint256(protocolVersion)
267: uint256(uint160(_admin))
267: uint160(_admin)
268: uint256(uint160(validatorTimelock))
268: uint160(validatorTimelock)
269: uint256(uint160(_baseToken))
269: uint160(_baseToken)
270: uint256(uint160(_sharedBridge))
270: uint160(_sharedBridge)
```
[184](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L184) | [184](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L184) | [185](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L185) | [185](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L185) | [188](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L188) | [189](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L189) | [190](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L190) | [194](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L194) | [264](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L264) | [264](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L264) | [265](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L265) | [265](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L265) | [266](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L266) | [267](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L267) | [267](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L267) | [268](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L268) | [268](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L268) | [269](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L269) | [269](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L269) | [270](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L270) | [270](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L270)

```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

115: uint32(block.timestamp)
134: uint32(block.timestamp)
```
[115](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L115) | [134](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L134)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

39: uint8(bytes1(_newBatch.pubdataCommitments[0]))
40: uint8(PubdataSource.Calldata)
40: uint8(PubdataSource.Blob)
52: uint8(PubdataSource.Blob)
59: uint8(PubdataSource.Calldata)
149: uint8(logKey)
150: uint8(logKey)
153: uint256(SystemLogKey.L2_TO_L1_LOGS_TREE_ROOT_KEY)
156: uint256(SystemLogKey.TOTAL_L2_TO_L1_PUBDATA_KEY)
159: uint256(SystemLogKey.STATE_DIFF_HASH_KEY)
162: uint256(SystemLogKey.PACKED_BATCH_AND_L2_BLOCK_TIMESTAMP_KEY)
164: uint256(logValue)
165: uint256(SystemLogKey.PREV_BATCH_HASH_KEY)
168: uint256(SystemLogKey.CHAINED_PRIORITY_TXN_HASH_KEY)
171: uint256(SystemLogKey.NUMBER_OF_LAYER_1_TXS_KEY)
173: uint256(logValue)
174: uint256(SystemLogKey.BLOB_ONE_HASH_KEY)
177: uint256(SystemLogKey.BLOB_TWO_HASH_KEY)
180: uint256(SystemLogKey.EXPECTED_SYSTEM_CONTRACT_UPGRADE_TX_HASH_KEY)
459: uint256(
                keccak256(
                    abi.encodePacked(
                        _prevBatchCommitment,
                        _currentBatchCommitment,
                        _verifierParams.recursionNodeLevelVkHash,
                        _verifierParams.recursionLeafLevelVkHash
                    )
                )
            )
520: uint64(0)
644: uint256(uint128(bytes16(_pubdataCommitments[i:i + PUBDATA_COMMITMENT_CLAIMED_VALUE_OFFSET])))
644: uint128(bytes16(_pubdataCommitments[i:i + PUBDATA_COMMITMENT_CLAIMED_VALUE_OFFSET]))
```
[39](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L39) | [40](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L40) | [40](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L40) | [52](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L52) | [59](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L59) | [149](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L149) | [150](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L150) | [153](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L153) | [156](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L156) | [159](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L159) | [162](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L162) | [164](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L164) | [165](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L165) | [168](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L168) | [171](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L171) | [173](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L173) | [174](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L174) | [177](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L177) | [180](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L180) | [459](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L459) | [520](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L520) | [644](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L644) | [644](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L644)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

98: uint256(_status)
137: uint256(uint160(_message.sender))
137: uint160(_message.sender)
166: uint256(feeParams.batchOverheadL1Gas)
169: uint256(feeParams.maxPubdataPerBatch)
171: uint256(feeParams.maxL2GasPerBatch)
283: uint64(block.timestamp + PRIORITY_EXPIRATION)
296: uint256(uint160(_priorityOpParams.sender))
296: uint160(_priorityOpParams.sender)
297: uint256(uint160(_priorityOpParams.contractAddressL2))
297: uint160(_priorityOpParams.contractAddressL2)
300: uint256(_priorityOpParams.l2GasPrice)
301: uint256(0)
302: uint256(0)
304: uint256(_priorityOpParams.txId)
306: uint256(uint160(_priorityOpParams.refundRecipient))
306: uint160(_priorityOpParams.refundRecipient)
338: uint192(0)
```
[98](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L98) | [137](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L137) | [137](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L137) | [166](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L166) | [169](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L169) | [171](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L171) | [283](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L283) | [296](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L296) | [296](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L296) | [297](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L297) | [297](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L297) | [300](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L300) | [301](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L301) | [302](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L302) | [304](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L304) | [306](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L306) | [306](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L306) | [338](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L338)

```solidity
File: code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol

30: uint256(1 << 248)
40: uint8(_bytecodeHash[0])
50: uint256(uint8(_bytecodeHash[2]))
50: uint8(_bytecodeHash[2])
50: uint256(uint8(_bytecodeHash[3]))
50: uint8(_bytecodeHash[3])
66: uint256(uint160(_sender))
66: uint160(_sender)
71: uint160(uint256(data))
71: uint256(data)
```
[30](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L30) | [40](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L40) | [50](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L50) | [50](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L50) | [50](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L50) | [50](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L50) | [66](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L66) | [66](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L66) | [71](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L71) | [71](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L71)

```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/LibMap.sol

30: uint32(mapValue >> bitOffset)
54: uint32(mapValue >> bitOffset)
57: uint256(oldValue ^ _value)
```
[30](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/LibMap.sol#L30) | [54](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/LibMap.sol#L54) | [57](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/LibMap.sol#L57)

```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol

46: uint256(_queue.tail - _queue.head)
```
[46](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L46)

```solidity
File: code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol

30: uint160(l1Address)
40: uint160(l2Address)
```
[30](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol#L30) | [40](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol#L40)

```solidity
File: code/system-contracts/contracts/AccountCodeStorage.sol

69: uint256(uint160(_address))
69: uint160(_address)
79: uint256(uint160(_address))
79: uint160(_address)
92: uint160(_input)
93: uint160(account)
120: uint160(_input)
132: uint160(account)
```
[69](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/AccountCodeStorage.sol#L69) | [69](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/AccountCodeStorage.sol#L69) | [79](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/AccountCodeStorage.sol#L79) | [79](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/AccountCodeStorage.sol#L79) | [92](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/AccountCodeStorage.sol#L92) | [93](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/AccountCodeStorage.sol#L93) | [120](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/AccountCodeStorage.sol#L120) | [132](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/AccountCodeStorage.sol#L132)

```solidity
File: code/system-contracts/contracts/BootloaderUtilities.sol

61: uint160(_transaction.to)
68: uint64(_transaction.data.length)
81: uint256(bytes32(_transaction.signature[0:32]))
86: uint256(bytes32(_transaction.signature[32:64]))
91: uint256(uint8(_transaction.signature[64]))
91: uint8(_transaction.signature[64])
116: uint64(listLength)
147: uint160(_transaction.to)
164: uint64(_transaction.data.length)
180: uint256(bytes32(_transaction.signature[0:32]))
185: uint256(bytes32(_transaction.signature[32:64]))
190: uint256(uint8(_transaction.signature[64]))
190: uint8(_transaction.signature[64])
207: uint64(listLength)
241: uint160(_transaction.to)
259: uint64(_transaction.data.length)
275: uint256(bytes32(_transaction.signature[0:32]))
280: uint256(bytes32(_transaction.signature[32:64]))
285: uint256(uint8(_transaction.signature[64]))
285: uint8(_transaction.signature[64])
302: uint64(listLength)
```
[61](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L61) | [68](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L68) | [81](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L81) | [86](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L86) | [91](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L91) | [91](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L91) | [116](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L116) | [147](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L147) | [164](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L164) | [180](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L180) | [185](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L185) | [190](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L190) | [190](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L190) | [207](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L207) | [241](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L241) | [259](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L259) | [275](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L275) | [280](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L280) | [285](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L285) | [285](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L285) | [302](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L302)

```solidity
File: code/system-contracts/contracts/Compressor.sol

62: uint256(encodedData.readUint16(encodedDataPointer))
121: uint256(_compressedStateDiffs.readUint16(0))
143: uint8(bytes1(_compressedStateDiffs[stateDiffPtr]))
174: uint8(bytes1(_compressedStateDiffs[stateDiffPtr]))
202: uint256(_rawCompressedData.readUint16(0))
252: uint256(bytes32(_calldataSlice))
```
[62](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L62) | [121](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L121) | [143](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L143) | [174](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L174) | [202](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L202) | [252](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L252)

```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

106: uint256(uint160(_sender))
106: uint160(_sender)
109: uint160(uint256(hash))
109: uint256(hash)
122: uint256(uint160(_sender))
122: uint160(_sender)
125: uint160(uint256(hash))
125: uint256(hash)
265: uint160(_newAddress)
269: uint256(uint160(_newAddress))
269: uint160(_newAddress)
341: uint128(value)
```
[106](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L106) | [106](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L106) | [109](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L109) | [109](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L109) | [122](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L122) | [122](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L122) | [125](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L125) | [125](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L125) | [265](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L265) | [269](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L269) | [269](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L269) | [341](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L341)

```solidity
File: code/system-contracts/contracts/DefaultAccount.sol

84: uint32(gasleft())
132: uint160(_transaction.to)
184: uint256(s)
```
[84](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L84) | [132](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L132) | [184](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L184)

```solidity
File: code/system-contracts/contracts/ImmutableSimulator.sol

28: uint256(uint160(_dest))
28: uint160(_dest)
41: uint256(uint160(_dest))
41: uint160(_dest)
```
[28](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ImmutableSimulator.sol#L28) | [28](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ImmutableSimulator.sol#L28) | [41](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ImmutableSimulator.sol#L41) | [41](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ImmutableSimulator.sol#L41)

```solidity
File: code/system-contracts/contracts/KnownCodesStorage.sol

75: uint8(_bytecodeHash[0])
```
[75](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/KnownCodesStorage.sol#L75)

```solidity
File: code/system-contracts/contracts/L1Messenger.sol

130: uint256(uint160(msg.sender))
130: uint160(msg.sender)
154: uint32(pubdataLen)
179: uint32(pubdataLen)
200: uint32(bytes4(_totalL2ToL1PubdataAndStateDiffs[calldataPtr:calldataPtr + 4]))
233: uint32(bytes4(_totalL2ToL1PubdataAndStateDiffs[calldataPtr:calldataPtr + 4]))
237: uint32(bytes4(_totalL2ToL1PubdataAndStateDiffs[calldataPtr:calldataPtr + 4]))
251: uint32(bytes4(_totalL2ToL1PubdataAndStateDiffs[calldataPtr:calldataPtr + 4]))
255: uint32(
                bytes4(_totalL2ToL1PubdataAndStateDiffs[calldataPtr:calldataPtr + 4])
            )
280: uint256(uint8(bytes1(_totalL2ToL1PubdataAndStateDiffs[calldataPtr])))
280: uint8(bytes1(_totalL2ToL1PubdataAndStateDiffs[calldataPtr]))
286: uint24(bytes3(_totalL2ToL1PubdataAndStateDiffs[calldataPtr:calldataPtr + 3]))
289: uint8(bytes1(_totalL2ToL1PubdataAndStateDiffs[calldataPtr]))
300: uint32(bytes4(_totalL2ToL1PubdataAndStateDiffs[calldataPtr:calldataPtr + 4]))
320: uint256(SystemLogKey.L2_TO_L1_LOGS_TREE_ROOT_KEY)
323: uint256(SystemLogKey.TOTAL_L2_TO_L1_PUBDATA_KEY)
326: uint256(SystemLogKey.STATE_DIFF_HASH_KEY)
```
[130](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L130) | [130](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L130) | [154](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L154) | [179](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L179) | [200](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L200) | [233](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L233) | [237](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L237) | [251](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L251) | [255](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L255) | [280](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L280) | [280](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L280) | [286](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L286) | [289](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L289) | [300](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L300) | [320](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L320) | [323](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L323) | [326](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L326)

```solidity
File: code/system-contracts/contracts/L2BaseToken.sol

57: uint160(_account)
```
[57](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L2BaseToken.sol#L57)

```solidity
File: code/system-contracts/contracts/MsgValueSimulator.sol

32: uint160(addressAsUint)
```
[32](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/MsgValueSimulator.sol#L32)

```solidity
File: code/system-contracts/contracts/NonceHolder.sol

47: uint256(uint160(_address))
47: uint160(_address)
58: uint256(uint160(_address))
58: uint160(_address)
68: uint256(uint160(msg.sender))
68: uint160(msg.sender)
92: uint256(uint160(msg.sender))
92: uint160(msg.sender)
103: uint256(uint160(msg.sender))
103: uint160(msg.sender)
111: uint256(uint160(msg.sender))
111: uint160(msg.sender)
126: uint256(uint160(_address))
126: uint160(_address)
140: uint256(uint160(_address))
140: uint160(_address)
155: uint256(uint160(_address))
155: uint160(_address)
```
[47](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L47) | [47](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L47) | [58](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L58) | [58](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L58) | [68](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L68) | [68](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L68) | [92](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L92) | [92](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L92) | [103](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L103) | [103](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L103) | [111](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L111) | [111](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L111) | [126](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L126) | [126](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L126) | [140](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L140) | [140](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L140) | [155](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L155) | [155](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L155)

```solidity
File: code/system-contracts/contracts/PubdataChunkPublisher.sol

55: uint256(SystemLogKey.BLOB_ONE_HASH_KEY)
56: uint256(SystemLogKey.BLOB_TWO_HASH_KEY)
```
[55](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/PubdataChunkPublisher.sol#L55) | [56](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/PubdataChunkPublisher.sol#L56)

```solidity
File: code/system-contracts/contracts/SystemContext.sol

234: uint32(_blockNumber)
416: uint256(currentBatchTimestamp)
420: uint256(SystemLogKey.PACKED_BATCH_AND_L2_BLOCK_TIMESTAMP_KEY)
466: uint256(SystemLogKey.PREV_BATCH_HASH_KEY)
476: uint128(_number)
476: uint128(_newTimestamp)
498: uint256(blockNumber)
498: uint256(blockTimestamp)
```
[234](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L234) | [416](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L416) | [420](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L420) | [466](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L466) | [476](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L476) | [476](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L476) | [498](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L498) | [498](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L498)

```solidity
File: code/system-contracts/contracts/libraries/EfficientCall.sol

259: uint32(dataOffset)
261: uint32(msg.data.length - (_data.length + dataOffset))
```
[259](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L259) | [261](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L261)

```solidity
File: code/system-contracts/contracts/libraries/RLPEncoder.sol

29: uint8(128)
29: uint8(_val)
34: uint8(hbs + 0x81)
64: uint8(_len + _offset)
66: uint256(_len)
69: uint8(_offset + hbs + 56)
72: uint256(_len)
```
[29](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/RLPEncoder.sol#L29) | [29](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/RLPEncoder.sol#L29) | [34](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/RLPEncoder.sol#L34) | [64](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/RLPEncoder.sol#L64) | [66](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/RLPEncoder.sol#L66) | [69](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/RLPEncoder.sol#L69) | [72](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/RLPEncoder.sol#L72)

```solidity
File: code/system-contracts/contracts/libraries/SystemContractHelper.sol

132: uint256(_inputMemoryLength)
133: uint256(_outputMemoryOffset)
134: uint256(_outputMemoryLength)
135: uint256(_perPrecompileInterpreted)
155: uint256(_gasToBurn)
155: uint256(_pubdataToSpend)
228: uint32(extractNumberFromMeta(meta, META_GAS_PER_PUBDATA_BYTE_OFFSET, 32))
238: uint32(extractNumberFromMeta(meta, META_HEAP_SIZE_OFFSET, 32))
247: uint32(extractNumberFromMeta(meta, META_AUX_HEAP_SIZE_OFFSET, 32))
255: uint8(extractNumberFromMeta(meta, META_SHARD_ID_OFFSET, 8))
264: uint8(extractNumberFromMeta(meta, META_CALLER_SHARD_ID_OFFSET, 8))
273: uint8(extractNumberFromMeta(meta, META_CODE_SHARD_ID_OFFSET, 8))
339: uint160(_address)
339: uint160(MAX_SYSTEM_CONTRACT_ADDRESS)
```
[132](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L132) | [133](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L133) | [134](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L134) | [135](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L135) | [155](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L155) | [155](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L155) | [228](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L228) | [238](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L238) | [247](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L247) | [255](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L255) | [264](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L264) | [273](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L273) | [339](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L339) | [339](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L339)

```solidity
File: code/system-contracts/contracts/libraries/SystemContractsCaller.sol

83: uint32(Utils.safeCastToU32(data.length))
235: uint256(memoryPage)
236: uint256(dataStart)
237: uint256(dataLength)
257: uint256(gasPassed)
258: uint256(forwardingMode)
259: uint256(shardId)
```
[83](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L83) | [235](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L235) | [236](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L236) | [237](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L237) | [257](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L257) | [258](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L258) | [259](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L259)

```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

95: uint256(uint160(address(BASE_TOKEN_SYSTEM_CONTRACT)))
95: uint160(address(BASE_TOKEN_SYSTEM_CONTRACT))
164: uint160(_transaction.to)
171: uint64(_transaction.data.length)
199: uint64(listLength)
232: uint160(_transaction.to)
249: uint64(_transaction.data.length)
271: uint64(listLength)
303: uint160(_transaction.to)
321: uint64(_transaction.data.length)
343: uint64(listLength)
375: uint160(_transaction.paymaster)
406: uint160(_transaction.paymaster)
```
[95](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L95) | [95](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L95) | [164](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L164) | [171](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L171) | [199](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L199) | [232](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L232) | [249](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L249) | [271](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L271) | [303](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L303) | [321](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L321) | [343](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L343) | [375](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L375) | [406](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L406)

```solidity
File: code/system-contracts/contracts/libraries/Utils.sol

23: uint128(_x)
29: uint32(_x)
35: uint24(_x)
46: uint256(uint8(_bytecodeHash[2]))
46: uint8(_bytecodeHash[2])
46: uint256(uint8(_bytecodeHash[3]))
46: uint8(_bytecodeHash[3])
93: uint256(1 << 248)
```
[23](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L23) | [29](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L29) | [35](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L35) | [46](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L46) | [46](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L46) | [46](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L46) | [46](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L46) | [93](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L93)

```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

158: uint256(uint160(_l1Token))
158: uint160(_l1Token)
166: uint32(gasleft())
```
[158](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L158) | [158](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L158) | [166](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L166)

```solidity
File: code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol

30: uint160(l1Address)
40: uint160(l2Address)
```
[30](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol#L30) | [40](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol#L40)

```solidity
File: code/contracts/zksync/contracts/L2ContractHelper.sol

107: uint256(uint160(_sender))
107: uint160(_sender)
112: uint160(uint256(data))
112: uint256(data)
```
[107](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/L2ContractHelper.sol#L107) | [107](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/L2ContractHelper.sol#L107) | [112](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/L2ContractHelper.sol#L112) | [112](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/L2ContractHelper.sol#L112)

```solidity
File: code/contracts/zksync/contracts/SystemContractsCaller.sol

30: uint32(_x)
44: uint32(Utils.safeCastToU32(data.length))
116: uint256(memoryPage)
117: uint256(dataStart)
118: uint256(dataLength)
128: uint256(gasPassed)
129: uint256(forwardingMode)
130: uint256(shardId)
```
[30](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/SystemContractsCaller.sol#L30) | [44](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/SystemContractsCaller.sol#L44) | [116](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/SystemContractsCaller.sol#L116) | [117](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/SystemContractsCaller.sol#L117) | [118](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/SystemContractsCaller.sol#L118) | [128](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/SystemContractsCaller.sol#L128) | [129](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/SystemContractsCaller.sol#L129) | [130](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/SystemContractsCaller.sol#L130)
</details>

### [N-24] `uint/int` variables should have the bit size defined explicitly

In Solidity, int256 and uint256 are the preferred type names, especially since they are used for function signatures.
Using int or uint instead can lead to confusion and inconsistency.

<details>
<summary><i>1 issue instances in 1 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

580: for (uint i = 0; i < MAX_NUMBER_OF_BLOBS; i++) {
```
[580](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L580)
</details>

### [N-25] Consider using `delete` rather than assigning `false` to clear values

The use of the delete keyword is recommended over simply assigning values to false when you intend to reset the state of a variable.
The delete keyword more closely aligns with the semantic intent of clearing or resetting a variable.
This practice also makes the code more readable and highlights the change in state, which may encourage a more thorough audit of the surrounding logic.

<details>
<summary><i>3 issue instances in 3 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

97: stateTransitionManagerIsRegistered[_stateTransitionManager] = false
```
[97](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L97)

```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

91: validators[_chainId][_validator] = false
```
[91](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L91)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol

147: diamondStorage.isFrozen = false
```
[147](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L147)
</details>

### [N-26] Consider using `delete` rather than assigning `zero` to clear values

Rather than merely setting a variable to zero, you can use the `delete` keyword to reset it to its default value.
This action is especially relevant for complex data types like arrays or mappings where the default is not necessarily zero.
Using `delete` not only provides explicit clarity that you intend to reset a variable, but it can also result in more concise and intuitive code.

<details>
<summary><i>3 issue instances in 3 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

276: baseTokenMsgValue = 0
```
[276](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L276)

```solidity
File: code/system-contracts/contracts/L1Messenger.sol

330: numberOfLogsToProcess = 0
```
[330](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L330)

```solidity
File: code/system-contracts/contracts/SystemContext.sol

487: txNumberInBlock = 0
```
[487](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L487)
</details>

### [N-27] Avoid external calls in modifiers

It is unusual to have external calls in modifiers, and doing so will make reviewers more likely to miss important external interactions.
Consider moving the external call to an internal function, and calling that function from the modifier.

<details>
<summary><i>5 issue instances in 3 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

/// @audit - getChainAdmin()
62: require(msg.sender == stateTransitionManager.getChainAdmin(_chainId), "ValidatorTimelock: only chain admin");
```
[62](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L62)

```solidity
File: code/system-contracts/contracts/DefaultAccount.sol

/// @audit - getCodeAddress()
46: address codeAddress = SystemContractHelper.getCodeAddress();
```
[46](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L46)

```solidity
File: code/system-contracts/contracts/interfaces/ISystemContract.sol

/// @audit - isSystemCall()
22: SystemContractHelper.isSystemCall() || SystemContractHelper.isSystemContract(msg.sender),
/// @audit - isSystemContract()
22: SystemContractHelper.isSystemCall() || SystemContractHelper.isSystemContract(msg.sender),
/// @audit - isSystemContract()
32: SystemContractHelper.isSystemContract(msg.sender),
```
[22](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/ISystemContract.sol#L22) | [22](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/ISystemContract.sol#L22) | [32](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/ISystemContract.sol#L32)
</details>

### [N-28] Consider emitting an event at the end of the constructor

This will allow users to easily exactly pinpoint when and by whom a contract was constructed.

<details>
<summary><i>10 issue instances in 10 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

55: constructor(IL1SharedBridge _sharedBridge) reentrancyGuardInitializer
```
[55](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L55)

```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

55: constructor(IL1SharedBridge _sharedBridge) reentrancyGuardInitializer
```
[55](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L55)

```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

90: constructor(
        address _l1WethAddress,
        IBridgehub _bridgehub,
        IL1ERC20Bridge _legacyBridge
    ) reentrancyGuardInitializer
```
[90](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L90)

```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

38: constructor() reentrancyGuardInitializer
```
[38](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L38)

```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

58: constructor(address _bridgehub) reentrancyGuardInitializer
```
[58](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L58)

```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

55: constructor(address _initialOwner, uint32 _executionDelay)
```
[55](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L55)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol

19: constructor() reentrancyGuardInitializer
```
[19](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol#L19)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol

11: constructor(uint256 _chainId, Diamond.DiamondCutData memory _diamondCut)
```
[11](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol#L11)

```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

41: constructor()
```
[41](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L41)

```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

40: constructor()
```
[40](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L40)
</details>

### [N-29] Consider moving duplicated strings to constants

Reusing string literals in this manner can lead to inconsistencies and makes the code harder to maintain.
It's recommended to define such strings as constants, which promotes easier updates and ensures uniformity across the codebase.

<details>
<summary><i>14 issue instances in 5 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

195: "5c"
217: "5c"
```
[195](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L195) | [217](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L217)

```solidity
File: code/system-contracts/contracts/AccountCodeStorage.sol

37: "Code hash is not for a contract on constructor"
57: "Code hash is not for a contract on constructor"
```
[37](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/AccountCodeStorage.sol#L37) | [57](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/AccountCodeStorage.sol#L57)

```solidity
File: code/system-contracts/contracts/BootloaderUtilities.sol

92: "Invalid v value"
191: "Invalid v value"
286: "Invalid v value"
```
[92](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L92) | [191](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L191) | [286](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L286)

```solidity
File: code/system-contracts/contracts/libraries/Utils.sol

21: "Overflow"
27: "Overflow"
33: "Overflow"
```
[21](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L21) | [27](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L27) | [33](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L33)

```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

150: ""
171: ""
56: "df"
58: "df"
```
[150](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L150) | [171](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L171) | [56](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L56) | [58](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L58)
</details>

### [N-30] Consider using named returns

Using named returns makes the code more self-documenting, makes it easier to fill out NatSpec, and in some cases can save gas.
The cases below are where there currently is at most one return statement, which is ideal for named returns.

<details>
<summary><i>147 issue instances in 39 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

75: function l2TokenAddress(address _l1Token) external view returns (address)
160: function _depositFundsToSharedBridge(address _from, IERC20 _token, uint256 _amount) internal returns (uint256)
```
[75](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L75) | [160](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L160)

```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

75: function l2TokenAddress(address _l1Token) external view returns (address)
160: function _depositFundsToSharedBridge(address _from, IERC20 _token, uint256 _amount) internal returns (uint256)
```
[75](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L75) | [160](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L160)

```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

173: function _depositFunds(address _from, IERC20 _token, uint256 _amount) internal returns (uint256)
243: function _getDepositL2Calldata(
        address _l1Sender,
        address _l2Receiver,
        address _l1Token,
        uint256 _amount
    ) internal view returns (bytes memory)
254: function _getERC20Getters(address _token) internal view returns (bytes memory)
374: function _isEraLegacyWithdrawal(uint256 _chainId, uint256 _l2BatchNumber) internal view returns (bool)
```
[173](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L173) | [243](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L243) | [254](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L254) | [374](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L374)

```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

75: function getStateTransition(uint256 _chainId) public view returns (address)
152: function proveL2MessageInclusion(
        uint256 _chainId,
        uint256 _batchNumber,
        uint256 _index,
        L2Message calldata _message,
        bytes32[] calldata _proof
    ) external view override returns (bool)
164: function proveL2LogInclusion(
        uint256 _chainId,
        uint256 _batchNumber,
        uint256 _index,
        L2Log memory _log,
        bytes32[] calldata _proof
    ) external view override returns (bool)
176: function proveL1ToL2TransactionStatus(
        uint256 _chainId,
        bytes32 _l2TxHash,
        uint256 _l2BatchNumber,
        uint256 _l2MessageIndex,
        uint16 _l2TxNumberInBatch,
        bytes32[] calldata _merkleProof,
        TxStatus _status
    ) external view override returns (bool)
198: function l2TransactionBaseCost(
        uint256 _chainId,
        uint256 _gasPrice,
        uint256 _l2GasLimit,
        uint256 _l2GasPerPubdataByteLimit
    ) external view returns (uint256)
```
[75](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L75) | [152](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L152) | [164](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L164) | [176](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L176) | [198](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L198)

```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

84: function isOperation(bytes32 _id) public view returns (bool)
89: function isOperationPending(bytes32 _id) public view returns (bool)
95: function isOperationReady(bytes32 _id) public view returns (bool)
100: function isOperationDone(bytes32 _id) public view returns (bool)
105: function getOperationState(bytes32 _id) public view returns (OperationState)
204: function hashOperation(Operation calldata _operation) public pure returns (bytes32)
```
[84](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L84) | [89](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L89) | [95](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L95) | [100](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L100) | [105](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L105) | [204](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L204)

```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

74: function getChainAdmin(uint256 _chainId) external view override returns (address)
```
[74](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L74)

```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

102: function getCommittedBatchTimestamp(uint256 _chainId, uint256 _l2BatchNumber) external view returns (uint256)
```
[102](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L102)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol

24: function initialize(InitializeData calldata _initializeData) external reentrancyGuardInitializer returns (bytes32)
```
[24](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol#L24)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

32: function _commitOneBatch(
        StoredBatchInfo memory _previousBatch,
        CommitBatchInfo calldata _newBatch,
        bytes32 _expectedSystemContractUpgradeTxHash
    ) internal view returns (StoredBatchInfo memory)
453: function _getBatchProofPublicInput(
        bytes32 _prevBatchCommitment,
        bytes32 _currentBatchCommitment,
        VerifierParams memory _verifierParams
    ) internal pure returns (uint256)
500: function _createBatchCommitment(
        CommitBatchInfo calldata _newBatchData,
        bytes32 _stateDiffHash,
        bytes32[] memory _blobCommitments,
        bytes32[] memory _blobHashes
    ) internal view returns (bytes32)
515: function _batchPassThroughData(CommitBatchInfo calldata _batch) internal pure returns (bytes memory)
525: function _batchMetaParameters() internal view returns (bytes memory)
537: function _batchAuxiliaryOutput(
        CommitBatchInfo calldata _batch,
        bytes32 _stateDiffHash,
        bytes32[] memory _blobCommitments,
        bytes32[] memory _blobHashes
    ) internal pure returns (bytes memory)
587: function _hashStoredBatchInfo(StoredBatchInfo memory _storedBatchInfo) internal pure returns (bytes32)
592: function _checkBit(uint256 _bitMap, uint8 _index) internal pure returns (bool)
597: function _setBit(uint256 _bitMap, uint8 _index) internal pure returns (uint256)
```
[32](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L32) | [453](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L453) | [500](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L500) | [515](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L515) | [525](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L525) | [537](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L537) | [587](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L587) | [592](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L592) | [597](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L597)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol

32: function getVerifier() external view returns (address)
37: function getAdmin() external view returns (address)
42: function getPendingAdmin() external view returns (address)
47: function getBridgehub() external view returns (address)
52: function getStateTransitionManager() external view returns (address)
57: function getBaseToken() external view returns (address)
62: function getBaseTokenBridge() external view returns (address)
67: function baseTokenGasPriceMultiplierNominator() external view returns (uint128)
72: function baseTokenGasPriceMultiplierDenominator() external view returns (uint128)
77: function getTotalBatchesCommitted() external view returns (uint256)
82: function getTotalBatchesVerified() external view returns (uint256)
87: function getTotalBatchesExecuted() external view returns (uint256)
92: function getTotalPriorityTxs() external view returns (uint256)
97: function getFirstUnprocessedPriorityTx() external view returns (uint256)
102: function getPriorityQueueSize() external view returns (uint256)
107: function priorityQueueFrontOperation() external view returns (PriorityOperation memory)
112: function isValidator(address _address) external view returns (bool)
117: function l2LogsRootHash(uint256 _batchNumber) external view returns (bytes32)
122: function storedBatchHash(uint256 _batchNumber) external view returns (bytes32)
127: function getL2BootloaderBytecodeHash() external view returns (bytes32)
132: function getL2DefaultAccountBytecodeHash() external view returns (bytes32)
137: function getVerifierParams() external view returns (VerifierParams memory)
142: function getProtocolVersion() external view returns (uint256)
147: function getL2SystemContractsUpgradeTxHash() external view returns (bytes32)
152: function getL2SystemContractsUpgradeBatchNumber() external view returns (uint256)
157: function isDiamondStorageFrozen() external view returns (bool)
176: function getPriorityTxMaxGasLimit() external view returns (uint256)
181: function isFunctionFreezable(bytes4 _selector) external view returns (bool)
188: function isEthWithdrawalFinalized(uint256 _l2BatchNumber, uint256 _l2MessageIndex) external view returns (bool)
193: function getPubdataPricingMode() external view returns (PubdataPricingMode)
217: function facetFunctionSelectors(address _facet) external view returns (bytes4[] memory)
223: function facetAddresses() external view returns (address[] memory)
229: function facetAddress(bytes4 _selector) external view returns (address)
239: function getTotalBlocksCommitted() external view returns (uint256)
244: function getTotalBlocksVerified() external view returns (uint256)
249: function getTotalBlocksExecuted() external view returns (uint256)
254: function storedBlockHash(uint256 _batchNumber) external view returns (bytes32)
259: function getL2SystemContractsUpgradeBlockNumber() external view returns (uint256)
```
[32](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L32) | [37](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L37) | [42](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L42) | [47](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L47) | [52](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L52) | [57](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L57) | [62](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L62) | [67](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L67) | [72](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L72) | [77](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L77) | [82](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L82) | [87](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L87) | [92](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L92) | [97](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L97) | [102](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L102) | [107](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L107) | [112](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L112) | [117](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L117) | [122](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L122) | [127](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L127) | [132](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L132) | [137](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L137) | [142](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L142) | [147](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L147) | [152](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L152) | [157](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L157) | [176](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L176) | [181](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L181) | [188](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L188) | [193](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L193) | [217](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L217) | [223](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L223) | [229](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L229) | [239](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L239) | [244](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L244) | [249](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L249) | [254](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L254) | [259](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L259)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

54: function proveL2MessageInclusion(
        uint256 _batchNumber,
        uint256 _index,
        L2Message memory _message,
        bytes32[] calldata _proof
    ) public view returns (bool)
64: function proveL2LogInclusion(
        uint256 _batchNumber,
        uint256 _index,
        L2Log memory _log,
        bytes32[] calldata _proof
    ) external view returns (bool)
74: function proveL1ToL2TransactionStatus(
        bytes32 _l2TxHash,
        uint256 _l2BatchNumber,
        uint256 _l2MessageIndex,
        uint16 _l2TxNumberInBatch,
        bytes32[] calldata _merkleProof,
        TxStatus _status
    ) public view returns (bool)
104: function _proveL2LogInclusion(
        uint256 _batchNumber,
        uint256 _index,
        L2Log memory _log,
        bytes32[] calldata _proof
    ) internal view returns (bool)
130: function _L2MessageToLog(L2Message memory _message) internal pure returns (L2Log memory)
143: function l2TransactionBaseCost(
        uint256 _gasPrice,
        uint256 _l2GasLimit,
        uint256 _l2GasPerPubdataByteLimit
    ) public view returns (uint256)
156: function _deriveL2GasPrice(uint256 _l1GasPrice, uint256 _gasPerPubdata) internal view returns (uint256)
```
[54](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L54) | [64](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L64) | [74](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L74) | [104](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L104) | [130](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L130) | [143](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L143) | [156](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L156)

```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol

180: function _setL2SystemContractUpgrade(
        L2CanonicalTransaction calldata _l2ProtocolUpgradeTx,
        bytes[] calldata _factoryDeps,
        uint256 _newProtocolVersion
    ) internal returns (bytes32)
```
[180](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L180)

```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol

47: function upgrade(ProposedUpgrade calldata _proposedUpgrade) public virtual override returns (bytes32)
```
[47](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L47)

```solidity
File: code/contracts/ethereum/contracts/upgrades/DefaultUpgrade.sol

13: function upgrade(ProposedUpgrade calldata _proposedUpgrade) public override returns (bytes32)
```
[13](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/DefaultUpgrade.sol#L13)

```solidity
File: code/contracts/ethereum/contracts/upgrades/GenesisUpgrade.sol

14: function upgrade(ProposedUpgrade calldata _proposedUpgrade) public override returns (bytes32)
```
[14](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/GenesisUpgrade.sol#L14)

```solidity
File: code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol

60: function computeCreate2Address(
        address _sender,
        bytes32 _salt,
        bytes32 _bytecodeHash,
        bytes32 _constructorInputHash
    ) internal pure returns (address)
```
[60](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L60)

```solidity
File: code/contracts/ethereum/contracts/common/libraries/UncheckedMath.sol

11: function uncheckedInc(uint256 _number) internal pure returns (uint256)
17: function uncheckedAdd(uint256 _lhs, uint256 _rhs) internal pure returns (uint256)
```
[11](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/UncheckedMath.sol#L11) | [17](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/UncheckedMath.sol#L17)

```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol

18: function calculateRoot(
        bytes32[] calldata _path,
        uint256 _index,
        bytes32 _itemHash
    ) internal pure returns (bytes32)
```
[18](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol#L18)

```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol

35: function getFirstUnprocessedPriorityTx(Queue storage _queue) internal view returns (uint256)
40: function getTotalPriorityTxs(Queue storage _queue) internal view returns (uint256)
45: function getSize(Queue storage _queue) internal view returns (uint256)
50: function isEmpty(Queue storage _queue) internal view returns (bool)
64: function front(Queue storage _queue) internal view returns (PriorityOperation memory)
```
[35](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L35) | [40](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L40) | [45](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L45) | [50](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L50) | [64](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L64)

```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol

69: function getMinimalPriorityTransactionGasLimit(
        uint256 _encodingLength,
        uint256 _numberOfFactoryDependencies,
        uint256 _l2GasPricePerPubdata
    ) internal pure returns (uint256)
```
[69](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L69)

```solidity
File: code/system-contracts/contracts/AccountCodeStorage.sol

89: function getCodeHash(uint256 _input) external view override returns (bytes32)
```
[89](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/AccountCodeStorage.sol#L89)

```solidity
File: code/system-contracts/contracts/BootloaderUtilities.sol

139: function encodeEIP2930TransactionHash(Transaction calldata _transaction) internal view returns (bytes32)
229: function encodeEIP1559TransactionHash(Transaction calldata _transaction) internal view returns (bytes32)
```
[139](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L139) | [229](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L229)

```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

40: function extendedAccountVersion(address _address) public view returns (AccountAbstractionVersion)
132: function create2(
        bytes32 _salt,
        bytes32 _bytecodeHash,
        bytes calldata _input
    ) external payable override returns (address)
147: function create(
        bytes32 _salt,
        bytes32 _bytecodeHash,
        bytes calldata _input
    ) external payable override returns (address)
162: function create2Account(
        bytes32 _salt,
        bytes32 _bytecodeHash,
        bytes calldata _input,
        AccountAbstractionVersion _aaVersion
    ) public payable override onlySystemCall returns (address)
182: function createAccount(
        bytes32, // salt
        bytes32 _bytecodeHash,
        bytes calldata _input,
        AccountAbstractionVersion _aaVersion
    ) public payable override onlySystemCall returns (address)
```
[40](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L40) | [132](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L132) | [147](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L147) | [162](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L162) | [182](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L182)

```solidity
File: code/system-contracts/contracts/DefaultAccount.sol

159: function _isValidSignature(bytes32 _hash, bytes memory _signature) internal view returns (bool)
```
[159](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L159)

```solidity
File: code/system-contracts/contracts/ImmutableSimulator.sol

27: function getImmutable(address _dest, uint256 _index) external view override returns (bytes32)
```
[27](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ImmutableSimulator.sol#L27)

```solidity
File: code/system-contracts/contracts/L1Messenger.sol

50: function keccakGasCost(uint256 _length) internal pure returns (uint256)
61: function sha256GasCost(uint256 _length) internal pure returns (uint256)
```
[50](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L50) | [61](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L61)

```solidity
File: code/system-contracts/contracts/L2BaseToken.sol

56: function balanceOf(uint256 _account) external view override returns (uint256)
112: function _getL1WithdrawMessage(address _to, uint256 _amount) internal pure returns (bytes memory)
117: function _getExtendedWithdrawMessage(
        address _to,
        uint256 _amount,
        address _sender,
        bytes memory _additionalData
    ) internal pure returns (bytes memory)
128: function name() external pure override returns (string memory)
134: function symbol() external pure override returns (string memory)
140: function decimals() external pure override returns (uint8)
```
[56](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L2BaseToken.sol#L56) | [112](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L2BaseToken.sol#L112) | [117](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L2BaseToken.sol#L117) | [128](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L2BaseToken.sol#L128) | [134](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L2BaseToken.sol#L134) | [140](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L2BaseToken.sol#L140)

```solidity
File: code/system-contracts/contracts/MsgValueSimulator.sol

47: fallback(bytes calldata _data) external onlySystemCall returns (bytes memory)
```
[47](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/MsgValueSimulator.sol#L47)

```solidity
File: code/system-contracts/contracts/NonceHolder.sol

46: function getMinNonce(address _address) public view returns (uint256)
57: function getRawNonce(address _address) public view returns (uint256)
102: function getValueUnderNonce(uint256 _key) public view returns (uint256)
154: function isNonceUsed(address _address, uint256 _nonce) public view returns (bool)
```
[46](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L46) | [57](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L57) | [102](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L102) | [154](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L154)

```solidity
File: code/system-contracts/contracts/SystemContext.sol

117: function getCurrentPubdataSpent() public view returns (uint256)
122: function getCurrentPubdataCost() external view returns (uint256)
190: function getBlockNumber() public view returns (uint128)
198: function getBlockTimestamp() public view returns (uint128)
205: function _getLatest257L2blockHash(uint256 _block) internal view returns (bytes32)
221: function _calculateL2BlockHash(
        uint128 _blockNumber,
        uint128 _blockTimestamp,
        bytes32 _prevL2BlockHash,
        bytes32 _blockTxsRollingHash
    ) internal pure returns (bytes32)
233: function _calculateLegacyL2BlockHash(uint128 _blockNumber) internal pure returns (bytes32)
```
[117](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L117) | [122](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L122) | [190](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L190) | [198](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L198) | [205](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L205) | [221](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L221) | [233](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L233)

```solidity
File: code/system-contracts/contracts/libraries/EfficientCall.sol

36: function keccak(bytes calldata _data) internal view returns (bytes32)
45: function sha(bytes calldata _data) internal view returns (bytes32)
```
[36](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L36) | [45](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L45)

```solidity
File: code/system-contracts/contracts/libraries/RLPEncoder.sol

49: function encodeNonSingleBytesLen(uint64 _len) internal pure returns (bytes memory)
56: function encodeListLen(uint64 _len) internal pure returns (bytes memory)
```
[49](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/RLPEncoder.sol#L49) | [56](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/RLPEncoder.sol#L56)

```solidity
File: code/system-contracts/contracts/libraries/SystemContractHelper.sol

329: function isSystemCall() internal view returns (bool)
338: function isSystemContract(address _address) internal pure returns (bool)
```
[329](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L329) | [338](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L338)

```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

94: function isEthToken(uint256 _addr) internal pure returns (bool)
118: function _encodeHashEIP712Transaction(Transaction calldata _transaction) private view returns (bytes32)
147: function _encodeHashLegacyTransaction(Transaction calldata _transaction) private view returns (bytes32)
219: function _encodeHashEIP2930Transaction(Transaction calldata _transaction) private view returns (bytes32)
289: function _encodeHashEIP1559Transaction(Transaction calldata _transaction) private view returns (bytes32)
```
[94](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L94) | [118](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L118) | [147](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L147) | [219](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L219) | [289](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L289)

```solidity
File: code/system-contracts/contracts/libraries/Utils.sol

20: function safeCastToU128(uint256 _x) internal pure returns (uint128)
26: function safeCastToU32(uint256 _x) internal pure returns (uint32)
32: function safeCastToU24(uint256 _x) internal pure returns (uint24)
51: function isContractConstructed(bytes32 _bytecodeHash) internal pure returns (bool)
56: function isContractConstructing(bytes32 _bytecodeHash) internal pure returns (bool)
63: function constructingBytecodeHash(bytes32 _bytecodeHash) internal pure returns (bytes32)
71: function constructedBytecodeHash(bytes32 _bytecodeHash) internal pure returns (bytes32)
```
[20](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L20) | [26](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L26) | [32](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L32) | [51](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L51) | [56](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L56) | [63](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L63) | [71](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L71)

```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

109: function _deployL2Token(address _l1Token, bytes calldata _data) internal returns (address)
138: function _getL1WithdrawMessage(
        address _to,
        address _l1Token,
        uint256 _amount
    ) internal pure returns (bytes memory)
149: function l2TokenAddress(address _l1Token) public view override returns (address)
```
[109](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L109) | [138](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L138) | [149](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L149)

```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

159: function name() public view override returns (string memory)
165: function symbol() public view override returns (string memory)
171: function decimals() public view override returns (uint8)
```
[159](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L159) | [165](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L165) | [171](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L171)

```solidity
File: code/contracts/zksync/contracts/L2ContractHelper.sol

90: function sendMessageToL1(bytes memory _message) internal returns (bytes32)
101: function computeCreate2Address(
        address _sender,
        bytes32 _salt,
        bytes32 _bytecodeHash,
        bytes32 _constructorInputHash
    ) internal pure returns (address)
```
[90](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/L2ContractHelper.sol#L90) | [101](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/L2ContractHelper.sol#L101)

```solidity
File: code/contracts/zksync/contracts/SystemContractsCaller.sol

27: function safeCastToU32(uint256 _x) internal pure returns (uint32)
```
[27](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/SystemContractsCaller.sol#L27)
</details>

### [N-31] Style guide: Initialisms should be capitalized

According to the Solidity [style guide](https://docs.soliditylang.org/en/latest/style-guide.html#naming-styles) initialisms such as "NFT", "ERC", etc should be capitalized.

<details>
<summary><i>144 issue instances in 24 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

102: uint256 _l2TxGasLimit
103: uint256 _l2TxGasPerPubdataByte
137: uint256 _l2TxGasLimit
138: uint256 _l2TxGasPerPubdataByte
181: uint256 _l2MessageIndex
210: uint256 _l2MessageIndex
```
[102](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L102) | [103](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L103) | [137](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L137) | [138](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L138) | [181](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L181) | [210](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L210)

```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

102: uint256 _l2TxGasLimit
103: uint256 _l2TxGasPerPubdataByte
137: uint256 _l2TxGasLimit
138: uint256 _l2TxGasPerPubdataByte
181: uint256 _l2MessageIndex
210: uint256 _l2MessageIndex
```
[102](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L102) | [103](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L103) | [137](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L137) | [138](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L138) | [181](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L181) | [210](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L210)

```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

34: address public immutable override l1WethAddress
91: address _l1WethAddress
137: function receiveEth(uint256 _chainId) external payable
150: address _prevMsgSender
184: address _prevMsgSender
284: uint256 _l2MessageIndex
311: uint256 _l2MessageIndex
388: uint256 _l2MessageIndex
412: uint256 _l2MessageIndex
554: function depositLegacyErc20Bridge(
        address _prevMsgSender,
        address _l2Receiver,
        address _l1Token,
        uint256 _amount,
        uint256 _l2TxGasLimit,
        uint256 _l2TxGasPerPubdataByte,
        address _refundRecipient
    ) external payable override onlyLegacyBridge nonReentrant returns (bytes32 l2TxHash)
555: address _prevMsgSender
559: uint256 _l2TxGasLimit
560: uint256 _l2TxGasPerPubdataByte
615: function finalizeWithdrawalLegacyErc20Bridge(
        uint256 _l2BatchNumber,
        uint256 _l2MessageIndex,
        uint16 _l2TxNumberInBatch,
        bytes calldata _message,
        bytes32[] calldata _merkleProof
    ) external override onlyLegacyBridge returns (address l1Receiver, address l1Token, uint256 amount)
617: uint256 _l2MessageIndex
644: function claimFailedDepositLegacyErc20Bridge(
        address _depositSender,
        address _l1Token,
        uint256 _amount,
        bytes32 _l2TxHash,
        uint256 _l2BatchNumber,
        uint256 _l2MessageIndex,
        uint16 _l2TxNumberInBatch,
        bytes32[] calldata _merkleProof
    ) external override onlyLegacyBridge
650: uint256 _l2MessageIndex
```
[34](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L34) | [91](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L91) | [137](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L137) | [150](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L150) | [184](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L184) | [284](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L284) | [311](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L311) | [388](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L388) | [412](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L412) | [554](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L554) | [555](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L555) | [559](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L559) | [560](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L560) | [615](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L615) | [617](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L617) | [644](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L644) | [650](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L650)

```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

155: uint256 _index
167: uint256 _index
180: uint256 _l2MessageIndex
200: uint256 _gasPrice
201: uint256 _l2GasLimit
202: uint256 _l2GasPerPubdataByteLimit
```
[155](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L155) | [167](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L167) | [180](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L180) | [200](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L200) | [201](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L201) | [202](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L202)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol

58: function setPriorityTxMaxGasLimit(uint256 _newPriorityTxMaxGasLimit) external onlyStateTransitionManager
58: uint256 _newPriorityTxMaxGasLimit
61: uint256 oldPriorityTxMaxGasLimit = s.priorityTxMaxGasLimit
```
[58](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L58) | [58](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L58) | [61](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L61)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

592: uint8 _index
597: uint8 _index
679: uint256 _index
629: uint256 versionedHashIndex = 0
```
[592](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L592) | [597](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L597) | [679](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L679) | [629](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L629)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol

67: function baseTokenGasPriceMultiplierNominator() external view returns (uint128)
72: function baseTokenGasPriceMultiplierDenominator() external view returns (uint128)
176: function getPriorityTxMaxGasLimit() external view returns (uint256)
188: function isEthWithdrawalFinalized(uint256 _l2BatchNumber, uint256 _l2MessageIndex) external view returns (bool)
188: uint256 _l2MessageIndex
```
[67](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L67) | [72](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L72) | [176](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L176) | [188](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L188) | [188](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L188)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

38: function transferEthToSharedBridge() external onlyBaseTokenBridge
56: uint256 _index
66: uint256 _index
77: uint256 _l2MessageIndex
106: uint256 _index
144: uint256 _gasPrice
145: uint256 _l2GasLimit
146: uint256 _l2GasPerPubdataByteLimit
156: function _deriveL2GasPrice(uint256 _l1GasPrice, uint256 _gasPerPubdata) internal view returns (uint256)
156: uint256 _l1GasPrice
156: uint256 _gasPerPubdata
178: function finalizeEthWithdrawal(
        uint256 _l2BatchNumber,
        uint256 _l2MessageIndex,
        uint16 _l2TxNumberInBatch,
        bytes calldata _message,
        bytes32[] calldata _merkleProof
    ) external nonReentrant
180: uint256 _l2MessageIndex
201: uint256 _l2GasLimit
202: uint256 _l2GasPerPubdataByteLimit
148: uint256 l2GasPrice = _deriveL2GasPrice(_gasPrice, _l2GasPerPubdataByteLimit)
159: uint256 l1GasPriceConverted = (_l1GasPrice * s.baseTokenGasPriceMultiplierNominator) /
            s.baseTokenGasPriceMultiplierDenominator
171: uint256 l2GasPrice = feeParams.minimalL2GasPrice + batchOverheadBaseToken / uint256(feeParams.maxL2GasPerBatch)
172: uint256 minL2GasPriceBaseToken = (fullPubdataPriceBaseToken + _gasPerPubdata - 1) / _gasPerPubdata
```
[38](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L38) | [56](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L56) | [66](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L66) | [77](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L77) | [106](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L106) | [144](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L144) | [145](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L145) | [146](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L146) | [156](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L156) | [156](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L156) | [156](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L156) | [178](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L178) | [180](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L180) | [201](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L201) | [202](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L202) | [148](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L148) | [159](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L159) | [171](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L171) | [172](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L172)

```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/LibMap.sol

18: uint256 _index
38: uint256 _index
43: uint256 mapIndex = _index / 8
```
[18](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/LibMap.sol#L18) | [38](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/LibMap.sol#L38) | [43](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/LibMap.sol#L43)

```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol

20: uint256 _index
```
[20](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol#L20)

```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol

22: uint256 _priorityTxMaxGasLimit
69: function getMinimalPriorityTransactionGasLimit(
        uint256 _encodingLength,
        uint256 _numberOfFactoryDependencies,
        uint256 _l2GasPricePerPubdata
    ) internal pure returns (uint256)
72: uint256 _l2GasPricePerPubdata
109: function getTransactionBodyGasLimit(
        uint256 _totalGasLimit,
        uint256 _encodingLength
    ) internal pure returns (uint256 txBodyGasLimit)
110: uint256 _totalGasLimit
112: uint256 txBodyGasLimit
25: uint256 l2GasForTxBody = getTransactionBodyGasLimit(_transaction.gasLimit, _encoded.length)
```
[22](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L22) | [69](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L69) | [72](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L72) | [109](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L109) | [110](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L110) | [112](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L112) | [25](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L25)

```solidity
File: code/system-contracts/contracts/BootloaderUtilities.sol

54: bytes memory encodedGasParam
56: bytes memory encodedGasPrice = RLPEncoder.encodeUint256(_transaction.maxFeePerGas)
57: bytes memory encodedGasLimit = RLPEncoder.encodeUint256(_transaction.gasLimit)
145: bytes memory encodedGasPrice = RLPEncoder.encodeUint256(_transaction.maxFeePerGas)
146: bytes memory encodedGasLimit = RLPEncoder.encodeUint256(_transaction.gasLimit)
238: bytes memory encodedMaxPriorityFeePerGas = RLPEncoder.encodeUint256(_transaction.maxPriorityFeePerGas)
239: bytes memory encodedMaxFeePerGas = RLPEncoder.encodeUint256(_transaction.maxFeePerGas)
240: bytes memory encodedGasLimit = RLPEncoder.encodeUint256(_transaction.gasLimit)
```
[54](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L54) | [56](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L56) | [57](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L57) | [145](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L145) | [146](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L146) | [238](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L238) | [239](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L239) | [240](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L240)

```solidity
File: code/system-contracts/contracts/Compressor.sol

112: uint256 _enumerationIndexSize
62: uint256 indexOfEncodedChunk = uint256(encodedData.readUint16(encodedDataPointer)) * 8
129: uint64 enumIndex = stateDiff.readUint64(84)
161: uint64 enumIndex = stateDiff.readUint64(84)
168: uint256 compressedEnumIndex = _sliceToUint256(
                _compressedStateDiffs[stateDiffPtr:stateDiffPtr + _enumerationIndexSize]
            )
```
[112](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L112) | [62](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L62) | [129](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L129) | [161](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L161) | [168](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L168)

```solidity
File: code/system-contracts/contracts/DefaultAccount.sol

135: uint32 gas = Utils.safeCastToU32(gasleft())
```
[135](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L135)

```solidity
File: code/system-contracts/contracts/ImmutableSimulator.sol

27: uint256 _index
39: uint256 index = _immutables[i].index
```
[27](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ImmutableSimulator.sol#L27) | [39](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ImmutableSimulator.sol#L39)

```solidity
File: code/system-contracts/contracts/L1Messenger.sol

50: function keccakGasCost(uint256 _length) internal pure returns (uint256)
61: function sha256GasCost(uint256 _length) internal pure returns (uint256)
89: uint256 gasToPay = keccakGasCost(L2_TO_L1_LOG_SERIALIZE_SIZE) + 2 * keccakGasCost(64)
117: uint256 gasBeforeMessageHashing = gasleft()
119: uint256 gasSpentOnMessageHashing = gasBeforeMessageHashing - gasleft()
148: uint256 gasToPay = keccakGasCost(L2_TO_L1_LOG_SERIALIZE_SIZE) +
            3 *
            keccakGasCost(64) +
            gasSpentOnMessageHashing +
            COMPUTATIONAL_PRICE_FOR_PUBDATA *
            pubdataLen
175: uint256 gasToPay = sha256GasCost(bytecodeLen) +
            keccakGasCost(64) +
            COMPUTATIONAL_PRICE_FOR_PUBDATA *
            pubdataLen
289: uint8 enumerationIndexSize = uint8(bytes1(_totalL2ToL1PubdataAndStateDiffs[calldataPtr]))
```
[50](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L50) | [61](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L61) | [89](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L89) | [117](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L117) | [119](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L119) | [148](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L148) | [175](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L175) | [289](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L289)

```solidity
File: code/system-contracts/contracts/MsgValueSimulator.sol

50: uint256 gasInContext = gasleft()
53: uint256 userGas = gasInContext > MSG_VALUE_SIMULATOR_STIPEND_GAS
            ? gasInContext - MSG_VALUE_SIMULATOR_STIPEND_GAS
            : 0
```
[50](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/MsgValueSimulator.sol#L50) | [53](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/MsgValueSimulator.sol#L53)

```solidity
File: code/system-contracts/contracts/SystemContext.sol

34: uint256 public gasPrice
37: uint256 public blockGasLimit = type(uint32).max
92: uint256 public gasPerPubdataByte
105: function setGasPrice(uint256 _gasPrice) external onlyCallFromBootloader
105: uint256 _gasPrice
112: uint256 _gasPerPubdataByte
```
[34](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L34) | [37](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L37) | [92](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L92) | [105](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L105) | [105](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L105) | [112](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L112)

```solidity
File: code/system-contracts/contracts/GasBoundCaller.sol

35: function gasBoundCall(address _to, uint256 _maxTotalGas, bytes calldata _data) external payable
35: uint256 _maxTotalGas
```
[35](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/GasBoundCaller.sol#L35) | [35](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/GasBoundCaller.sol#L35)

```solidity
File: code/system-contracts/contracts/libraries/EfficientCall.sol

59: uint256 _gas
75: uint256 _gas
89: uint256 _gas
106: uint256 _gas
125: uint256 _gas
159: uint256 _gas
173: uint256 _gas
192: uint256 _gas
246: uint256 _gas
264: uint32 gas = Utils.safeCastToU32(_gas)
```
[59](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L59) | [75](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L75) | [89](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L89) | [106](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L106) | [125](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L125) | [159](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L159) | [173](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L173) | [192](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L192) | [246](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L246) | [264](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L264)

```solidity
File: code/system-contracts/contracts/libraries/SystemContractHelper.sol

150: uint32 _gasToBurn
237: function getHeapSizeFromMeta(uint256 meta) internal pure returns (uint32 heapSize)
318: uint256 index
344: function burnGas(uint32 _gasToPay, uint32 _pubdataToSpend) internal view
344: uint32 _gasToPay
```
[150](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L150) | [237](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L237) | [318](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L318) | [344](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L344) | [344](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L344)

```solidity
File: code/system-contracts/contracts/libraries/SystemContractsCaller.sol

76: uint32 gasLimit
124: uint32 gasLimit
151: uint32 gasLimit
219: uint32 gasPassed
251: uint32 gasPassed
```
[76](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L76) | [124](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L124) | [151](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L151) | [219](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L219) | [251](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L251)

```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

94: function isEthToken(uint256 _addr) internal pure returns (bool)
157: bytes memory encodedGasParam
159: bytes memory encodedGasPrice = RLPEncoder.encodeUint256(_transaction.maxFeePerGas)
160: bytes memory encodedGasLimit = RLPEncoder.encodeUint256(_transaction.gasLimit)
230: bytes memory encodedGasPrice = RLPEncoder.encodeUint256(_transaction.maxFeePerGas)
231: bytes memory encodedGasLimit = RLPEncoder.encodeUint256(_transaction.gasLimit)
300: bytes memory encodedMaxPriorityFeePerGas = RLPEncoder.encodeUint256(_transaction.maxPriorityFeePerGas)
301: bytes memory encodedMaxFeePerGas = RLPEncoder.encodeUint256(_transaction.maxFeePerGas)
302: bytes memory encodedGasLimit = RLPEncoder.encodeUint256(_transaction.gasLimit)
```
[94](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L94) | [157](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L157) | [159](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L159) | [160](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L160) | [230](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L230) | [231](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L231) | [300](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L300) | [301](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L301) | [302](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L302)

```solidity
File: code/contracts/zksync/contracts/SystemContractsCaller.sol

37: uint32 gasLimit
77: uint32 gasLimit
100: uint32 gasPassed
122: uint32 gasPassed
```
[37](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/SystemContractsCaller.sol#L37) | [77](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/SystemContractsCaller.sol#L77) | [100](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/SystemContractsCaller.sol#L100) | [122](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/SystemContractsCaller.sol#L122)
</details>

### [N-32] Expressions for constant values should use `immutable` rather than `constant`

While it does not save gas for some simple binary expressions because the compiler knows that developers often make this mistake, it's still best to use the right tool for the task at hand. There is a difference between `constant` variables and immutable variables, and they should each be used in their appropriate contexts.
`constant`s should be used for literal values written into the code, and immutable variables should be used for expressions, or values calculated in, or passed into the constructor.

<details>
<summary><i>108 issue instances in 16 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

22: uint256 internal constant EXECUTED_PROPOSAL_TIMESTAMP = uint256(1)
```
[22](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L22)

```solidity
File: code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol

12: bytes32 private constant CREATE2_PREFIX = keccak256("zksyncCreate2")
```
[12](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L12)

```solidity
File: code/contracts/ethereum/contracts/common/Config.sol

14: uint256 constant MAX_L2_TO_L1_LOGS_COMMITMENT_BYTES = 4 + L2_TO_L1_LOG_SERIALIZE_SIZE * 512
22: bytes32 constant DEFAULT_L2_LOGS_TREE_ROOT_HASH = bytes32(0)
50: uint256 constant MAX_GAS_PER_TRANSACTION = $(MAX_GAS_PER_TRANSACTION)
54: uint256 constant L1_GAS_PER_PUBDATA_BYTE = $(L1_GAS_PER_PUBDATA_BYTE)
57: uint256 constant L1_TX_INTRINSIC_L2_GAS = $(L1_TX_INTRINSIC_L2_GAS)
60: uint256 constant L1_TX_INTRINSIC_PUBDATA = $(L1_TX_INTRINSIC_PUBDATA)
63: uint256 constant L1_TX_MIN_L2_GAS_BASE = $(L1_TX_MIN_L2_GAS_BASE)
66: uint256 constant L1_TX_DELTA_544_ENCODING_BYTES = $(L1_TX_DELTA_544_ENCODING_BYTES)
69: uint256 constant L1_TX_DELTA_FACTORY_DEPS_L2_GAS = $(L1_TX_DELTA_FACTORY_DEPS_L2_GAS)
72: uint256 constant L1_TX_DELTA_FACTORY_DEPS_PUBDATA = $(L1_TX_DELTA_FACTORY_DEPS_PUBDATA)
75: uint256 constant MAX_NEW_FACTORY_DEPS = $(MAX_NEW_FACTORY_DEPS)
78: uint256 constant REQUIRED_L2_GAS_PRICE_PER_PUBDATA = $(REQUIRED_L2_GAS_PRICE_PER_PUBDATA)
85: address constant POINT_EVALUATION_PRECOMPILE_ADDR = address(0x0A)
101: address constant ETH_TOKEN_ADDRESS = address(1)
104: uint256 constant ERA_CHAIN_ID = $(ERA_CHAIN_ID)
107: address constant ERA_ERC20_BRIDGE_ADDRESS = $(ERA_ERC20_BRIDGE_ADDRESS)
110: address constant ERA_DIAMOND_PROXY = $(ERA_DIAMOND_PROXY)
112: bytes32 constant TWO_BRIDGES_MAGIC_VALUE = bytes32(uint256(keccak256("TWO_BRIDGES_MAGIC_VALUE")) - 1)
115: address constant BRIDGEHUB_MIN_SECOND_BRIDGE_ADDRESS = address(uint160(type(uint16).max))
```
[14](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L14) | [22](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L22) | [50](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L50) | [54](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L54) | [57](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L57) | [60](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L60) | [63](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L63) | [66](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L66) | [69](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L69) | [72](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L72) | [75](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L75) | [78](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L78) | [85](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L85) | [101](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L101) | [104](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L104) | [107](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L107) | [110](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L110) | [112](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L112) | [115](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L115)

```solidity
File: code/contracts/ethereum/contracts/common/L2ContractAddresses.sol

6: address constant L2_BOOTLOADER_ADDRESS = address(0x8001)
9: address constant L2_KNOWN_CODE_STORAGE_SYSTEM_CONTRACT_ADDR = address(0x8004)
12: address constant L2_DEPLOYER_SYSTEM_CONTRACT_ADDR = address(0x8006)
21: address constant L2_FORCE_DEPLOYER_ADDR = address(0x8007)
24: address constant L2_TO_L1_MESSENGER_SYSTEM_CONTRACT_ADDR = address(0x8008)
27: address constant L2_BASE_TOKEN_SYSTEM_CONTRACT_ADDR = address(0x800a)
30: address constant L2_SYSTEM_CONTEXT_SYSTEM_CONTRACT_ADDR = address(0x800b)
33: address constant L2_PUBDATA_CHUNK_PUBLISHER_ADDR = address(0x8011)
```
[6](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/L2ContractAddresses.sol#L6) | [9](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/L2ContractAddresses.sol#L9) | [12](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/L2ContractAddresses.sol#L12) | [21](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/L2ContractAddresses.sol#L21) | [24](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/L2ContractAddresses.sol#L24) | [27](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/L2ContractAddresses.sol#L27) | [30](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/L2ContractAddresses.sol#L30) | [33](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/L2ContractAddresses.sol#L33)

```solidity
File: code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol

22: uint160 constant offset = uint160(0x1111000000000000000000000000000000001111)
```
[22](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol#L22)

```solidity
File: code/system-contracts/contracts/Constants.sol

31: address constant ECRECOVER_SYSTEM_CONTRACT = address(0x01)
32: address constant SHA256_SYSTEM_CONTRACT = address(0x02)
33: address constant ECADD_SYSTEM_CONTRACT = address(0x06)
34: address constant ECMUL_SYSTEM_CONTRACT = address(0x07)
48: address payable constant BOOTLOADER_FORMAL_ADDRESS = payable(address(SYSTEM_CONTRACTS_OFFSET + 0x01))
49: IAccountCodeStorage constant ACCOUNT_CODE_STORAGE_SYSTEM_CONTRACT = IAccountCodeStorage(
    address(SYSTEM_CONTRACTS_OFFSET + 0x02)
)
52: INonceHolder constant NONCE_HOLDER_SYSTEM_CONTRACT = INonceHolder(address(SYSTEM_CONTRACTS_OFFSET + 0x03))
53: IKnownCodesStorage constant KNOWN_CODE_STORAGE_CONTRACT = IKnownCodesStorage(address(SYSTEM_CONTRACTS_OFFSET + 0x04))
54: IImmutableSimulator constant IMMUTABLE_SIMULATOR_SYSTEM_CONTRACT = IImmutableSimulator(
    address(SYSTEM_CONTRACTS_OFFSET + 0x05)
)
57: IContractDeployer constant DEPLOYER_SYSTEM_CONTRACT = IContractDeployer(address(SYSTEM_CONTRACTS_OFFSET + 0x06))
61: address constant FORCE_DEPLOYER = address(SYSTEM_CONTRACTS_OFFSET + 0x07)
62: IL1Messenger constant L1_MESSENGER_CONTRACT = IL1Messenger(address(SYSTEM_CONTRACTS_OFFSET + 0x08))
63: address constant MSG_VALUE_SYSTEM_CONTRACT = address(SYSTEM_CONTRACTS_OFFSET + 0x09)
65: IBaseToken constant BASE_TOKEN_SYSTEM_CONTRACT = IBaseToken(address(SYSTEM_CONTRACTS_OFFSET + 0x0a))
66: IBaseToken constant REAL_BASE_TOKEN_SYSTEM_CONTRACT = IBaseToken(address(REAL_SYSTEM_CONTRACTS_OFFSET + 0x0a))
71: address constant KECCAK256_SYSTEM_CONTRACT = address(0x8010)
73: ISystemContext constant SYSTEM_CONTEXT_CONTRACT = ISystemContext(payable(address(SYSTEM_CONTRACTS_OFFSET + 0x0b)))
74: ISystemContext constant REAL_SYSTEM_CONTEXT_CONTRACT = ISystemContext(payable(address(REAL_SYSTEM_CONTRACTS_OFFSET + 0x0b)))
76: IBootloaderUtilities constant BOOTLOADER_UTILITIES = IBootloaderUtilities(address(SYSTEM_CONTRACTS_OFFSET + 0x0c))
79: address constant EVENT_WRITER_CONTRACT = address(SYSTEM_CONTRACTS_OFFSET + 0x0d)
81: ICompressor constant COMPRESSOR_CONTRACT = ICompressor(address(SYSTEM_CONTRACTS_OFFSET + 0x0e))
83: IComplexUpgrader constant COMPLEX_UPGRADER_CONTRACT = IComplexUpgrader(address(SYSTEM_CONTRACTS_OFFSET + 0x0f))
85: IPubdataChunkPublisher constant PUBDATA_CHUNK_PUBLISHER = IPubdataChunkPublisher(
    address(SYSTEM_CONTRACTS_OFFSET + 0x11)
)
94: uint256 constant MAX_MSG_VALUE = 2 ** 128 - 1
135: uint256 constant COMPRESSED_INITIAL_WRITE_SIZE = DERIVED_KEY_LENGTH + VALUE_LENGTH
137: uint256 constant COMPRESSED_REPEATED_WRITE_SIZE = ENUM_INDEX_LENGTH + VALUE_LENGTH
```
[31](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L31) | [32](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L32) | [33](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L33) | [34](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L34) | [48](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L48) | [49](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L49) | [52](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L52) | [53](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L53) | [54](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L54) | [57](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L57) | [61](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L61) | [62](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L62) | [63](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L63) | [65](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L65) | [66](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L66) | [71](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L71) | [73](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L73) | [74](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L74) | [76](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L76) | [79](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L79) | [81](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L81) | [83](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L83) | [85](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L85) | [94](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L94) | [135](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L135) | [137](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L137)

```solidity
File: code/system-contracts/contracts/NonceHolder.sol

28: uint256 private constant DEPLOY_NONCE_MULTIPLIER = 2 ** 128
31: uint256 private constant MAXIMAL_MIN_NONCE_INCREMENT = 2 ** 32
```
[28](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L28) | [31](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L31)

```solidity
File: code/system-contracts/contracts/libraries/SystemContractHelper.sol

9: uint256 constant UINT32_MASK = type(uint32).max
10: uint256 constant UINT64_MASK = type(uint64).max
11: uint256 constant UINT128_MASK = type(uint128).max
12: uint256 constant ADDRESS_MASK = type(uint160).max
```
[9](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L9) | [10](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L10) | [11](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L11) | [12](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L12)

```solidity
File: code/system-contracts/contracts/libraries/SystemContractsCaller.sol

12: address constant TO_L1_CALL_ADDRESS = address((1 << 16) - 1)
13: address constant CODE_ADDRESS_CALL_ADDRESS = address((1 << 16) - 2)
14: address constant PRECOMPILE_CALL_ADDRESS = address((1 << 16) - 3)
15: address constant META_CALL_ADDRESS = address((1 << 16) - 4)
16: address constant MIMIC_CALL_CALL_ADDRESS = address((1 << 16) - 5)
17: address constant SYSTEM_MIMIC_CALL_CALL_ADDRESS = address((1 << 16) - 6)
18: address constant MIMIC_CALL_BY_REF_CALL_ADDRESS = address((1 << 16) - 7)
19: address constant SYSTEM_MIMIC_CALL_BY_REF_CALL_ADDRESS = address((1 << 16) - 8)
20: address constant RAW_FAR_CALL_CALL_ADDRESS = address((1 << 16) - 9)
21: address constant RAW_FAR_CALL_BY_REF_CALL_ADDRESS = address((1 << 16) - 10)
22: address constant SYSTEM_CALL_CALL_ADDRESS = address((1 << 16) - 11)
23: address constant SYSTEM_CALL_BY_REF_CALL_ADDRESS = address((1 << 16) - 12)
24: address constant SET_CONTEXT_VALUE_CALL_ADDRESS = address((1 << 16) - 13)
25: address constant SET_PUBDATA_PRICE_CALL_ADDRESS = address((1 << 16) - 14)
26: address constant INCREMENT_TX_COUNTER_CALL_ADDRESS = address((1 << 16) - 15)
27: address constant PTR_CALLDATA_CALL_ADDRESS = address((1 << 16) - 16)
28: address constant CALLFLAGS_CALL_ADDRESS = address((1 << 16) - 17)
29: address constant PTR_RETURNDATA_CALL_ADDRESS = address((1 << 16) - 18)
30: address constant EVENT_INITIALIZE_ADDRESS = address((1 << 16) - 19)
31: address constant EVENT_WRITE_ADDRESS = address((1 << 16) - 20)
32: address constant LOAD_CALLDATA_INTO_ACTIVE_PTR_CALL_ADDRESS = address((1 << 16) - 21)
33: address constant LOAD_LATEST_RETURNDATA_INTO_ACTIVE_PTR_CALL_ADDRESS = address((1 << 16) - 22)
34: address constant PTR_ADD_INTO_ACTIVE_CALL_ADDRESS = address((1 << 16) - 23)
35: address constant PTR_SHRINK_INTO_ACTIVE_CALL_ADDRESS = address((1 << 16) - 24)
36: address constant PTR_PACK_INTO_ACTIVE_CALL_ADDRESS = address((1 << 16) - 25)
37: address constant MULTIPLICATION_HIGH_ADDRESS = address((1 << 16) - 26)
38: address constant GET_EXTRA_ABI_DATA_ADDRESS = address((1 << 16) - 27)
41: uint256 constant META_GAS_PER_PUBDATA_BYTE_OFFSET = 0 * 8
42: uint256 constant META_HEAP_SIZE_OFFSET = 8 * 8
43: uint256 constant META_AUX_HEAP_SIZE_OFFSET = 12 * 8
44: uint256 constant META_SHARD_ID_OFFSET = 28 * 8
45: uint256 constant META_CALLER_SHARD_ID_OFFSET = 29 * 8
46: uint256 constant META_CODE_SHARD_ID_OFFSET = 30 * 8
```
[12](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L12) | [13](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L13) | [14](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L14) | [15](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L15) | [16](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L16) | [17](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L17) | [18](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L18) | [19](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L19) | [20](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L20) | [21](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L21) | [22](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L22) | [23](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L23) | [24](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L24) | [25](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L25) | [26](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L26) | [27](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L27) | [28](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L28) | [29](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L29) | [30](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L30) | [31](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L31) | [32](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L32) | [33](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L33) | [34](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L34) | [35](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L35) | [36](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L36) | [37](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L37) | [38](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L38) | [41](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L41) | [42](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L42) | [43](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L43) | [44](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L44) | [45](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L45) | [46](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L46)

```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

82: bytes32 constant EIP712_DOMAIN_TYPEHASH = keccak256("EIP712Domain(string name,string version,uint256 chainId)")
84: bytes32 constant EIP712_TRANSACTION_TYPE_HASH =
        keccak256(
            "Transaction(uint256 txType,uint256 from,uint256 to,uint256 gasLimit,uint256 gasPerPubdataByteLimit,uint256 maxFeePerGas,uint256 maxPriorityFeePerGas,uint256 paymaster,uint256 nonce,uint256 value,bytes data,bytes32[] factoryDeps,bytes paymasterInput)"
        )
```
[82](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L82) | [84](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L84)

```solidity
File: code/system-contracts/contracts/interfaces/IAccount.sol

7: bytes4 constant ACCOUNT_VALIDATION_SUCCESS_MAGIC = IAccount.validateTransaction.selector
```
[7](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IAccount.sol#L7)

```solidity
File: code/system-contracts/contracts/interfaces/IPaymaster.sol

12: bytes4 constant PAYMASTER_VALIDATION_SUCCESS_MAGIC = IPaymaster.validateAndPayForPaymasterTransaction.selector
```
[12](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IPaymaster.sol#L12)

```solidity
File: code/contracts/zksync/contracts/interfaces/IPaymaster.sol

12: bytes4 constant PAYMASTER_VALIDATION_SUCCESS_MAGIC = IPaymaster.validateAndPayForPaymasterTransaction.selector
```
[12](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/interfaces/IPaymaster.sol#L12)

```solidity
File: code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol

22: uint160 constant offset = uint160(0x1111000000000000000000000000000000001111)
```
[22](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol#L22)

```solidity
File: code/contracts/zksync/contracts/L2ContractHelper.sol

70: address constant BOOTLOADER_ADDRESS = address(SYSTEM_CONTRACTS_OFFSET + 0x01)
71: address constant MSG_VALUE_SYSTEM_CONTRACT = address(SYSTEM_CONTRACTS_OFFSET + 0x09)
72: address constant DEPLOYER_SYSTEM_CONTRACT = address(SYSTEM_CONTRACTS_OFFSET + 0x06)
74: IL2Messenger constant L2_MESSENGER = IL2Messenger(address(SYSTEM_CONTRACTS_OFFSET + 0x08))
76: IBaseToken constant L2_BASE_TOKEN_ADDRESS = IBaseToken(address(SYSTEM_CONTRACTS_OFFSET + 0x0a))
85: bytes32 private constant CREATE2_PREFIX = keccak256("zksyncCreate2")
```
[70](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/L2ContractHelper.sol#L70) | [71](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/L2ContractHelper.sol#L71) | [72](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/L2ContractHelper.sol#L72) | [74](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/L2ContractHelper.sol#L74) | [76](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/L2ContractHelper.sol#L76) | [85](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/L2ContractHelper.sol#L85)

```solidity
File: code/contracts/zksync/contracts/SystemContractsCaller.sol

7: address constant SYSTEM_CALL_CALL_ADDRESS = address((1 << 16) - 11)
```
[7](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/SystemContractsCaller.sol#L7)
</details>

### [N-33] Consider using named function arguments

When calling functions in external contracts with multiple arguments, consider using named function parameters, rather than positional ones.

<details>
<summary><i>87 issue instances in 24 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

67: IERC20(_token).safeTransfer(address(sharedBridge), amount)
79: L2ContractHelper.computeCreate2Address(l2Bridge, salt, l2TokenProxyBytecodeHash, constructorInputHash)
162: _token.safeTransferFrom(_from, address(sharedBridge), _amount)
189: sharedBridge.claimFailedDepositLegacyErc20Bridge(
            _depositSender,
            _l1Token,
            amount,
            _l2TxHash,
            _l2BatchNumber,
            _l2MessageIndex,
            _l2TxNumberInBatch,
            _merkleProof
        )
218: sharedBridge.finalizeWithdrawalLegacyErc20Bridge(
            _l2BatchNumber,
            _l2MessageIndex,
            _l2TxNumberInBatch,
            _message,
            _merkleProof
        )
```
[67](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L67) | [79](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L79) | [162](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L162) | [189](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L189) | [218](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L218)

```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

67: IERC20(_token).safeTransfer(address(sharedBridge), amount)
79: L2ContractHelper.computeCreate2Address(l2Bridge, salt, l2TokenProxyBytecodeHash, constructorInputHash)
162: _token.safeTransferFrom(_from, address(sharedBridge), _amount)
189: sharedBridge.claimFailedDepositLegacyErc20Bridge(
            _depositSender,
            _l1Token,
            amount,
            _l2TxHash,
            _l2BatchNumber,
            _l2MessageIndex,
            _l2TxNumberInBatch,
            _merkleProof
        )
218: sharedBridge.finalizeWithdrawalLegacyErc20Bridge(
            _l2BatchNumber,
            _l2MessageIndex,
            _l2TxNumberInBatch,
            _message,
            _merkleProof
        )
```
[67](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L67) | [79](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L79) | [162](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L162) | [189](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L189) | [218](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L218)

```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

130: IL1ERC20Bridge(_target).tranferTokenToSharedBridge(_token, amount)
175: _token.safeTransferFrom(_from, address(this), _amount)
316: bridgehub.proveL1ToL2TransactionStatus(
                _chainId,
                _l2TxHash,
                _l2BatchNumber,
                _l2MessageIndex,
                _l2TxNumberInBatch,
                _merkleProof,
                TxStatus.Failure
            )
362: IERC20(_l1Token).safeTransfer(_depositSender, _amount)
396: legacyBridge.isWithdrawalFinalized(_l2BatchNumber, _l2MessageIndex)
423: IGetters(ERA_DIAMOND_PROXY).isEthWithdrawalFinalized(
                _l2BatchNumber,
                _l2MessageIndex
            )
452: IERC20(l1Token).safeTransfer(l1Receiver, amount)
477: bridgehub.proveL2MessageInclusion(
            _chainId,
            _messageParams.l2BatchNumber,
            _messageParams.l2MessageIndex,
            l2ToL1Message,
            _merkleProof
        )
503: UnsafeBytes.readUint32(_l2ToL1message, 0)
506: UnsafeBytes.readAddress(_l2ToL1message, offset)
507: UnsafeBytes.readUint256(_l2ToL1message, offset)
518: UnsafeBytes.readAddress(_l2ToL1message, offset)
519: UnsafeBytes.readAddress(_l2ToL1message, offset)
520: UnsafeBytes.readUint256(_l2ToL1message, offset)
```
[130](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L130) | [175](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L175) | [316](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L316) | [362](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L362) | [396](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L396) | [423](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L423) | [452](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L452) | [477](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L477) | [503](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L503) | [506](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L506) | [507](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L507) | [518](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L518) | [519](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L519) | [520](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L520)

```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

137: IStateTransitionManager(_stateTransitionManager).createNewChain(
            _chainId,
            _baseToken,
            address(sharedBridge),
            _admin,
            _initData
        )
160: IZkSyncStateTransition(stateTransition).proveL2MessageInclusion(_batchNumber, _index, _message, _proof)
172: IZkSyncStateTransition(stateTransition).proveL2LogInclusion(_batchNumber, _index, _log, _proof)
187: IZkSyncStateTransition(stateTransition).proveL1ToL2TransactionStatus(
                _l2TxHash,
                _l2BatchNumber,
                _l2MessageIndex,
                _l2TxNumberInBatch,
                _merkleProof,
                _status
            )
206: IZkSyncStateTransition(stateTransition).l2TransactionBaseCost(
                _gasPrice,
                _l2GasLimit,
                _l2GasPerPubdataByteLimit
            )
318: IL1SharedBridge(_request.secondBridgeAddress).bridgehubConfirmL2Transaction(
            _request.chainId,
            outputRequest.txDataHash,
            canonicalTxHash
        )
```
[137](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L137) | [160](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L160) | [172](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L172) | [187](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L187) | [206](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L206) | [318](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L318)

```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

90: IExecutor.StoredBatchInfo(
            0,
            _initializeData.genesisBatchHash,
            _initializeData.genesisIndexRepeatedStorageChanges,
            0,
            EMPTY_STRING_KECCAK,
            DEFAULT_L2_LOGS_TREE_ROOT_HASH,
            0,
            _initializeData.genesisBatchCommitment
        )
261: bytes.concat(
            IDiamondInit.initialize.selector,
            bytes32(_chainId),
            bytes32(uint256(uint160(bridgehub))),
            bytes32(uint256(uint160(address(this)))),
            bytes32(uint256(protocolVersion)),
            bytes32(uint256(uint160(_admin))),
            bytes32(uint256(uint160(validatorTimelock))),
            bytes32(uint256(uint160(_baseToken))),
            bytes32(uint256(uint160(_sharedBridge))),
            bytes32(storedBatchZero),
            diamondCut.initCalldata
        )
```
[90](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L90) | [261](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L261)

```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

117: committedBatchTimestamp[ERA_CHAIN_ID].set(_newBatchesData[i].batchNumber, timestamp)
136: committedBatchTimestamp[_chainId].set(_newBatchesData[i].batchNumber, timestamp)
```
[117](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L117) | [136](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L136)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

144: UnsafeBytes.readAddress(emittedL2Logs, i + L2_LOG_ADDRESS_OFFSET)
145: UnsafeBytes.readUint256(emittedL2Logs, i + L2_LOG_KEY_OFFSET)
146: UnsafeBytes.readBytes32(emittedL2Logs, i + L2_LOG_VALUE_OFFSET)
444: s.verifier.verify(
            proofPublicInput,
            _proof.serializedProof,
            _proof.recursiveAggregationInput
        )
```
[144](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L144) | [145](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L145) | [146](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L146) | [444](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L444)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

123: Merkle.calculateRoot(_proof, _index, hashedLog)
186: IL1SharedBridge(s.baseTokenBridge).finalizeWithdrawal(
            ERA_CHAIN_ID,
            _l2BatchNumber,
            _l2MessageIndex,
            _l2TxNumberInBatch,
            _message,
            _merkleProof
        )
325: TransactionValidator.validateL1ToL2Transaction(
            transaction,
            transactionEncoding,
            s.priorityTxMaxGasLimit,
            s.feeParams.priorityTxMaxPubdata
        )
```
[123](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L123) | [186](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L186) | [325](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L325)

```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol

194: TransactionValidator.validateL1ToL2Transaction(
            _l2ProtocolUpgradeTx,
            encodedTransaction,
            s.priorityTxMaxGasLimit,
            s.feeParams.priorityTxMaxPubdata
        )
```
[194](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L194)

```solidity
File: code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol

68: bytes.concat(CREATE2_PREFIX, senderBytes, _salt, _bytecodeHash, _constructorInputHash)
```
[68](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L68)

```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol

83: Math.ceilDiv(_encodingLength * L1_TX_DELTA_544_ENCODING_BYTES, 544)
```
[83](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L83)

```solidity
File: code/system-contracts/contracts/BootloaderUtilities.sol

29: bytes.concat(signedTxHash, EfficientCall.keccak(_transaction.signature))
58: bytes.concat(encodedGasPrice, encodedGasLimit)
121: bytes.concat(
                    encodedListLength,
                    encodedNonce,
                    encodedGasParam,
                    encodedTo,
                    encodedValue,
                    encodedDataLength,
                    _transaction.data,
                    vEncoded,
                    rEncoded,
                    sEncoded
                )
149: bytes.concat(
                encodedChainId,
                encodedNonce,
                encodedGasPrice,
                encodedGasLimit,
                encodedTo,
                encodedValue
            )
212: bytes.concat(
                    "\x01",
                    encodedListLength,
                    encodedFixedLengthParams,
                    encodedDataLength,
                    _transaction.data,
                    encodedAccessListLength,
                    vEncoded,
                    rEncoded,
                    sEncoded
                )
243: bytes.concat(
                encodedChainId,
                encodedNonce,
                encodedMaxPriorityFeePerGas,
                encodedMaxFeePerGas,
                encodedGasLimit,
                encodedTo,
                encodedValue
            )
307: bytes.concat(
                    "\x02",
                    encodedListLength,
                    encodedFixedLengthParams,
                    encodedDataLength,
                    _transaction.data,
                    encodedAccessListLength,
                    vEncoded,
                    rEncoded,
                    sEncoded
                )
```
[29](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L29) | [58](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L58) | [121](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L121) | [149](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L149) | [212](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L212) | [243](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L243) | [307](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L307)

```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

106: bytes.concat(CREATE2_PREFIX, bytes32(uint256(uint160(_sender))), _salt, _bytecodeHash, constructorInputHash)
122: bytes.concat(CREATE_PREFIX, bytes32(uint256(uint160(_sender))), bytes32(_senderNonce))
312: ACCOUNT_CODE_STORAGE_SYSTEM_CONTRACT.storeAccountConstructingCodeHash(_newAddress, constructingBytecodeHash)
343: EfficientCall.mimicCall(gasleft(), _newAddress, _input, _sender, true, _isSystem)
348: IMMUTABLE_SIMULATOR_SYSTEM_CONTRACT.setImmutables(_newAddress, immutables)
352: ACCOUNT_CODE_STORAGE_SYSTEM_CONTRACT.storeAccountConstructedCodeHash(_newAddress, _bytecodeHash)
```
[106](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L106) | [122](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L122) | [312](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L312) | [343](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L343) | [348](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L348) | [352](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L352)

```solidity
File: code/system-contracts/contracts/DefaultAccount.sol

83: SystemContractsCaller.systemCallWithPropagatedRevert(
            uint32(gasleft()),
            address(NONCE_HOLDER_SYSTEM_CONTRACT),
            0,
            abi.encodeCall(INonceHolder.incrementMinNonceIfEquals, (_transaction.nonce))
        )
149: EfficientCall.rawCall(gas, to, value, data, isSystemCall)
```
[83](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L83) | [149](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L149)

```solidity
File: code/system-contracts/contracts/L1Messenger.sol

307: COMPRESSOR_CONTRACT.verifyCompressedStateDiffs(
            numberOfStateDiffs,
            enumerationIndexSize,
            stateDiffs,
            compressedStateDiffs
        )
320: SystemContractHelper.toL1(true, bytes32(uint256(SystemLogKey.L2_TO_L1_LOGS_TREE_ROOT_KEY)), l2ToL1LogsTreeRoot)
321: SystemContractHelper.toL1(
            true,
            bytes32(uint256(SystemLogKey.TOTAL_L2_TO_L1_PUBDATA_KEY)),
            EfficientCall.keccak(totalL2ToL1Pubdata)
        )
326: SystemContractHelper.toL1(true, bytes32(uint256(SystemLogKey.STATE_DIFF_HASH_KEY)), stateDiffHash)
```
[307](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L307) | [320](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L320) | [321](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L321) | [326](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L326)

```solidity
File: code/system-contracts/contracts/MsgValueSimulator.sol

81: EfficientCall.mimicCall(userGas, to, _data, msg.sender, false, isSystemCall)
```
[81](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/MsgValueSimulator.sol#L81)

```solidity
File: code/system-contracts/contracts/PubdataChunkPublisher.sol

55: SystemContractHelper.toL1(true, bytes32(uint256(SystemLogKey.BLOB_ONE_HASH_KEY)), blobHashes[0])
56: SystemContractHelper.toL1(true, bytes32(uint256(SystemLogKey.BLOB_TWO_HASH_KEY)), blobHashes[1])
```
[55](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/PubdataChunkPublisher.sol#L55) | [56](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/PubdataChunkPublisher.sol#L56)

```solidity
File: code/system-contracts/contracts/SystemContext.sol

418: SystemContractHelper.toL1(
            false,
            bytes32(uint256(SystemLogKey.PACKED_BATCH_AND_L2_BLOCK_TIMESTAMP_KEY)),
            bytes32(packedTimestamps)
        )
466: SystemContractHelper.toL1(false, bytes32(uint256(SystemLogKey.PREV_BATCH_HASH_KEY)), _prevBatchHash)
```
[418](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L418) | [466](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L466)

```solidity
File: code/system-contracts/contracts/GasBoundCaller.sol

57: EfficientCall.call(gasleft(), _to, msg.value, _data, false)
```
[57](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/GasBoundCaller.sol#L57)

```solidity
File: code/system-contracts/contracts/libraries/EfficientCall.sol

265: SystemContractsCaller.getFarCallABIWithEmptyFatPointer(
            gas,
            // Only rollup is supported for now
            0,
            CalldataForwardingMode.ForwardFatPointer,
            _isConstructor,
            _isSystem
        )
```
[265](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L265)

```solidity
File: code/system-contracts/contracts/libraries/SystemContractsCaller.sol

85: SystemContractsCaller.getFarCallABI(
            0,
            0,
            dataStart,
            dataLength,
            gasLimit,
            // Only rollup is supported for now
            0,
            CalldataForwardingMode.UseHeap,
            false,
            true
        )
```
[85](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L85)

```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

161: bytes.concat(encodedGasPrice, encodedGasLimit)
185: bytes.concat(RLPEncoder.encodeUint256(block.chainid), hex"80_80")
204: bytes.concat(
                    encodedListLength,
                    encodedNonce,
                    encodedGasParam,
                    encodedTo,
                    encodedValue,
                    encodedDataLength,
                    _transaction.data,
                    encodedChainId
                )
234: bytes.concat(
                encodedChainId,
                encodedNonce,
                encodedGasPrice,
                encodedGasLimit,
                encodedTo,
                encodedValue
            )
276: bytes.concat(
                    "\x01",
                    encodedListLength,
                    encodedFixedLengthParams,
                    encodedDataLength,
                    _transaction.data,
                    encodedAccessListLength
                )
305: bytes.concat(
                encodedChainId,
                encodedNonce,
                encodedMaxPriorityFeePerGas,
                encodedMaxFeePerGas,
                encodedGasLimit,
                encodedTo,
                encodedValue
            )
348: bytes.concat(
                    "\x02",
                    encodedListLength,
                    encodedFixedLengthParams,
                    encodedDataLength,
                    _transaction.data,
                    encodedAccessListLength
                )
377: IERC20(token).allowance(address(this), paymaster)
382: IERC20(token).safeApprove(paymaster, 0)
383: IERC20(token).safeApprove(paymaster, minAllowance)
```
[161](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L161) | [185](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L185) | [204](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L204) | [234](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L234) | [276](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L276) | [305](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L305) | [348](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L348) | [377](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L377) | [382](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L382) | [383](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L383)

```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

104: IL2StandardToken(expectedL2Token).bridgeMint(_l2Receiver, _amount)
113: L2StandardERC20(address(l2Token)).bridgeInitialize(_l1Token, _data)
126: IL2StandardToken(_l2Token).bridgeBurn(msg.sender, _amount)
153: L2ContractHelper.computeCreate2Address(address(this), salt, l2TokenProxyBytecodeHash, constructorInputHash)
165: SystemContractsCaller.systemCallWithReturndata(
            uint32(gasleft()),
            DEPLOYER_SYSTEM_CONTRACT,
            0,
            abi.encodeCall(
                IContractDeployer.create2,
                (salt, l2TokenProxyBytecodeHash, abi.encode(address(l2TokenBeacon), ""))
            )
        )
```
[104](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L104) | [113](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L113) | [126](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L126) | [153](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L153) | [165](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L165)

```solidity
File: code/contracts/zksync/contracts/L2ContractHelper.sol

109: bytes.concat(CREATE2_PREFIX, senderBytes, _salt, _bytecodeHash, _constructorInputHash)
```
[109](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/L2ContractHelper.sol#L109)
</details>

### [N-34] Assembly block creates dirty bits

Writing data to the free memory pointer without later updating the free memory pointer will cause dirty bits at that memory location.
This makes it harder for the optimizer to determine whether the memory needs to be cleaned before use, leading to suboptimal optimizations.
It is recommended to update the free memory pointer and annotate the assembly block with `memory-safe` to avoid this issue.

<details>
<summary><i>5 issue instances in 3 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

/// @audit - Assembly block has `mstore` without `memory-safe` annotation
360: assembly {
```
[360](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L360)

```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol

/// @audit - Assembly block has `mstore` without `memory-safe` annotation
41: assembly {
```
[41](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol#L41)

```solidity
File: code/system-contracts/contracts/libraries/RLPEncoder.sol

/// @audit - Assembly block has `mstore` without `memory-safe` annotation
16: assembly {
/// @audit - Assembly block has `mstore` without `memory-safe` annotation
38: assembly {
/// @audit - Assembly block has `mstore` without `memory-safe` annotation
73: assembly {
```
[16](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/RLPEncoder.sol#L16) | [38](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/RLPEncoder.sol#L38) | [73](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/RLPEncoder.sol#L73)
</details>

### [N-35] Contract/Library Names Not in `CapWords` Style (CamelCase)

Contracts and libraries should be named using the `CapWords` style for better readability and consistency with Solidity style guidelines.
Examples of good practice include: SimpleToken, SmartBank, CertificateHashRepository, Player, Congress, Owned.
[More information in Documentation](https://docs.soliditylang.org/en/v0.8.20/style-guide.html#contract-and-library-names)

<details>
<summary><i>5 issue instances in 4 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

19: contract L1ERC20Bridge is IL1ERC20Bridge, ReentrancyGuard {
19: contract L1ERC20Bridge is IL1ERC20Bridge, ReentrancyGuard {
```
[19](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L19) | [19](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L19)

```solidity
File: code/system-contracts/contracts/libraries/RLPEncoder.sol

10: library RLPEncoder {
```
[10](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/RLPEncoder.sol#L10)

```solidity
File: code/system-contracts/contracts/interfaces/ISystemContract.sol

17: abstract contract ISystemContract {
```
[17](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/ISystemContract.sol#L17)

```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

15: contract L2StandardERC20 is ERC20PermitUpgradeable, IL2StandardToken, ERC1967Upgrade {
```
[15](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L15)
</details>

### [N-36] Events are missing sender information

Events should include the sender information when emitted in `public` or `external` functions for better traceability.

<details>
<summary><i>50 issue instances in 13 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

/// @audit external function `claimFailedDeposit()` emits an event without sender information
199: emit ClaimedFailedDeposit(_depositSender, _l1Token, amount);
/// @audit external function `finalizeWithdrawal()` emits an event without sender information
225: emit WithdrawalFinalized(l1Receiver, l1Token, amount);
/// @audit external function `claimFailedDeposit()` emits an event without sender information
199: emit ClaimedFailedDeposit(_depositSender, _l1Token, amount);
/// @audit external function `finalizeWithdrawal()` emits an event without sender information
225: emit WithdrawalFinalized(l1Receiver, l1Token, amount);
```
[199](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L199) | [225](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L225) | [199](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L199) | [225](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L225)

```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

/// @audit external function `bridgehubDepositBaseToken()` emits an event without sender information
168: emit BridgehubDepositBaseTokenInitiated(_chainId, _prevMsgSender, _l1Token, _amount);
/// @audit external function `bridgehubDeposit()` emits an event without sender information
227: emit BridgehubDepositInitiated(_chainId, txDataHash, _prevMsgSender, _l2Receiver, _l1Token, amount);
/// @audit external function `bridgehubConfirmL2Transaction()` emits an event without sender information
239: emit BridgehubDepositFinalized(_chainId, _txDataHash, _txHash);
/// @audit external function `depositLegacyErc20Bridge()` emits an event without sender information
601: emit LegacyDepositInitiated(ERA_CHAIN_ID, l2TxHash, _prevMsgSender, _l2Receiver, _l1Token, _amount);
```
[168](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L168) | [227](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L227) | [239](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L239) | [601](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L601)

```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

/// @audit external function `setPendingAdmin()` emits an event without sender information
56: emit NewPendingAdmin(oldPendingAdmin, _newPendingAdmin);
/// @audit external function `acceptAdmin()` emits an event without sender information
67: emit NewPendingAdmin(currentPendingAdmin, address(0));
/// @audit external function `acceptAdmin()` emits an event without sender information
69: emit NewAdmin(previousAdmin, pendingAdmin);
/// @audit external function `createNewChain()` emits an event without sender information
144: emit NewChain(_chainId, _stateTransitionManager, _admin);
```
[56](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L56) | [67](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L67) | [69](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L69) | [144](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L144)

```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

/// @audit external function `scheduleTransparent()` emits an event without sender information
132: emit TransparentOperationScheduled(id, _delay, _operation);
/// @audit external function `scheduleShadow()` emits an event without sender information
144: emit ShadowOperationScheduled(_id, _delay);
/// @audit external function `cancel()` emits an event without sender information
157: emit OperationCancelled(_id);
/// @audit external function `execute()` emits an event without sender information
180: emit OperationExecuted(id);
/// @audit external function `executeInstant()` emits an event without sender information
199: emit OperationExecuted(id);
/// @audit external function `updateDelay()` emits an event without sender information
250: emit ChangeMinDelay(minDelay, _newDelay);
/// @audit external function `updateSecurityCouncil()` emits an event without sender information
257: emit ChangeSecurityCouncil(securityCouncil, _newSecurityCouncil);
```
[132](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L132) | [144](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L144) | [157](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L157) | [180](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L180) | [199](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L199) | [250](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L250) | [257](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L257)

```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

/// @audit external function `setPendingAdmin()` emits an event without sender information
115: emit NewPendingAdmin(oldPendingAdmin, _newPendingAdmin);
/// @audit external function `acceptAdmin()` emits an event without sender information
126: emit NewPendingAdmin(currentPendingAdmin, address(0));
/// @audit external function `acceptAdmin()` emits an event without sender information
128: emit NewAdmin(previousAdmin, pendingAdmin);
/// @audit external function `registerAlreadyDeployedStateTransition()` emits an event without sender information
235: emit StateTransitionNewChain(_chainId, _stateTransitionContract);
/// @audit external function `createNewChain()` emits an event without sender information
286: emit StateTransitionNewChain(_chainId, stateTransitionAddress);
```
[115](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L115) | [126](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L126) | [128](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L128) | [235](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L235) | [286](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L286)

```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

/// @audit external function `addValidator()` emits an event without sender information
83: emit ValidatorAdded(_chainId, _newValidator);
/// @audit external function `removeValidator()` emits an event without sender information
92: emit ValidatorRemoved(_chainId, _validator);
/// @audit external function `setExecutionDelay()` emits an event without sender information
98: emit NewExecutionDelay(_executionDelay);
```
[83](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L83) | [92](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L92) | [98](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L98)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol

/// @audit external function `setPendingAdmin()` emits an event without sender information
28: emit NewPendingAdmin(oldPendingAdmin, _newPendingAdmin);
/// @audit external function `acceptAdmin()` emits an event without sender information
39: emit NewPendingAdmin(pendingAdmin, address(0));
/// @audit external function `acceptAdmin()` emits an event without sender information
41: emit NewAdmin(previousAdmin, pendingAdmin);
/// @audit external function `setValidator()` emits an event without sender information
47: emit ValidatorStatusUpdate(_validator, _active);
/// @audit external function `setPorterAvailability()` emits an event without sender information
54: emit IsPorterAvailableStatusUpdate(_zkPorterIsAvailable);
/// @audit external function `setPriorityTxMaxGasLimit()` emits an event without sender information
63: emit NewPriorityTxMaxGasLimit(oldPriorityTxMaxGasLimit, _newPriorityTxMaxGasLimit);
/// @audit external function `changeFeeParams()` emits an event without sender information
74: emit NewFeeParams(oldFeeParams, _newFeeParams);
/// @audit external function `setTokenMultiplier()` emits an event without sender information
85: emit NewBaseTokenMultiplier(oldNominator, oldDenominator, _nominator, _denominator);
/// @audit external function `setValidiumMode()` emits an event without sender information
92: emit ValidiumModeStatusUpdate(_validiumMode);
/// @audit external function `upgradeChainFromVersion()` emits an event without sender information
115: emit ExecuteUpgrade(_diamondCut);
/// @audit external function `executeUpgrade()` emits an event without sender information
125: emit ExecuteUpgrade(_diamondCut);
/// @audit external function `freezeDiamond()` emits an event without sender information
138: emit Freeze();
/// @audit external function `unfreezeDiamond()` emits an event without sender information
148: emit Unfreeze();
```
[28](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L28) | [39](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L39) | [41](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L41) | [47](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L47) | [54](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L54) | [63](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L63) | [74](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L74) | [85](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L85) | [92](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L92) | [115](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L115) | [125](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L125) | [138](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L138) | [148](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L148)

```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol

/// @audit public function `upgrade()` emits an event without sender information
86: emit UpgradeComplete(_proposedUpgrade.newProtocolVersion, txHash, _proposedUpgrade);
```
[86](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L86)

```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol

/// @audit public function `upgrade()` emits an event without sender information
66: emit UpgradeComplete(_proposedUpgrade.newProtocolVersion, txHash, _proposedUpgrade);
```
[66](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L66)

```solidity
File: code/system-contracts/contracts/L1Messenger.sol

/// @audit external function `requestBytecodeL1Publication()` emits an event without sender information
180: emit BytecodeL1PublicationRequested(_bytecodeHash);
```
[180](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L180)

```solidity
File: code/system-contracts/contracts/L2BaseToken.sol

/// @audit external function `transferFromTo()` emits an event without sender information
48: emit Transfer(_from, _to, _amount);
/// @audit external function `mint()` emits an event without sender information
67: emit Mint(_account, _amount);
```
[48](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L2BaseToken.sol#L48) | [67](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L2BaseToken.sol#L67)

```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

/// @audit external function `finalizeDeposit()` emits an event without sender information
105: emit FinalizeDeposit(_l1Sender, _l2Receiver, expectedL2Token, _amount);
```
[105](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L105)

```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

/// @audit external function `bridgeInitialize()` emits an event without sender information
101: emit BridgeInitialize(_l1Address, decodedName, decodedSymbol, decimals_);
/// @audit external function `reinitializeToken()` emits an event without sender information
125: emit BridgeInitialize(l1Address, _newName, _newSymbol, decimals_);
/// @audit external function `bridgeMint()` emits an event without sender information
147: emit BridgeMint(_to, _amount);
/// @audit external function `bridgeBurn()` emits an event without sender information
156: emit BridgeBurn(_from, _amount);
```
[101](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L101) | [125](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L125) | [147](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L147) | [156](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L156)
</details>

### [N-37] Leverage Recent Solidity Features with `0.8.23`

The recent updates in Solidity provide several features and optimizations that, when leveraged appropriately, can significantly improve your contract's code clarity and maintainability.
Key enhancements include the use of push0 for placing 0 on the stack for EVM versions starting from "Shanghai", making your code simpler and more straightforward.
Moreover, Solidity has extended NatSpec documentation support to enum and struct definitions, facilitating more comprehensive and insightful code documentation.

Additionally, the re-implementation of the UnusedAssignEliminator and UnusedStoreEliminator in the Solidity optimizer provides the ability to remove unused assignments in deeply nested loops.
This results in a cleaner, more efficient contract code, reducing clutter and potential points of confusion during code review or debugging.
It's recommended to make full use of these features and optimizations to enhance the robustness and readability of your smart contracts.

<details>
<summary><i>106 issue instances in 105 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

3: pragma solidity 0.8.20;
3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L3) | [3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L3)

```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L3)

```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L3)

```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L3)

```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L3)

```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L3)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol#L3)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol#L3)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L3)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L3)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L3)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L3)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L3)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L3)

```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L3)

```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L3)

```solidity
File: code/contracts/ethereum/contracts/upgrades/DefaultUpgrade.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/DefaultUpgrade.sol#L3)

```solidity
File: code/contracts/ethereum/contracts/upgrades/GenesisUpgrade.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/GenesisUpgrade.sol#L3)

```solidity
File: code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L3)

```solidity
File: code/contracts/ethereum/contracts/common/libraries/UncheckedMath.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/UncheckedMath.sol#L3)

```solidity
File: code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol#L3)

```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L3)

```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/LibMap.sol

2: pragma solidity 0.8.20;
```
[2](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/LibMap.sol#L2)

```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol#L3)

```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L3)

```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L3)

```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L3)

```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L3)

```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL2Bridge.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL2Bridge.sol#L3)

```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IWETH9.sol

2: pragma solidity 0.8.20;
```
[2](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IWETH9.sol#L2)

```solidity
File: code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L3)

```solidity
File: code/contracts/ethereum/contracts/common/interfaces/IL2ContractDeployer.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/interfaces/IL2ContractDeployer.sol#L3)

```solidity
File: code/contracts/ethereum/contracts/governance/IGovernance.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/IGovernance.sol#L3)

```solidity
File: code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L3)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L3)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol#L3)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L3)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L3)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/ILegacyGetters.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/ILegacyGetters.sol#L3)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L3)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IVerifier.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IVerifier.sol#L3)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol#L3)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransitionBase.sol

2: pragma solidity 0.8.20;
```
[2](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransitionBase.sol#L2)

```solidity
File: code/contracts/ethereum/contracts/state-transition/l2-deps/ISystemContext.sol

2: pragma solidity ^0.8.0;
```
[2](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/l2-deps/ISystemContext.sol#L2)

```solidity
File: code/contracts/ethereum/contracts/upgrades/IDefaultUpgrade.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/IDefaultUpgrade.sol#L3)

```solidity
File: code/contracts/ethereum/contracts/common/Config.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L3)

```solidity
File: code/contracts/ethereum/contracts/common/L2ContractAddresses.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/L2ContractAddresses.sol#L3)

```solidity
File: code/contracts/ethereum/contracts/common/Messaging.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Messaging.sol#L3)

```solidity
File: code/contracts/ethereum/contracts/common/ReentrancyGuard.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/ReentrancyGuard.sol#L3)

```solidity
File: code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol

19: pragma solidity 0.8.20;
```
[19](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol#L19)

```solidity
File: code/system-contracts/contracts/AccountCodeStorage.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/AccountCodeStorage.sol#L3)

```solidity
File: code/system-contracts/contracts/BootloaderUtilities.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L3)

```solidity
File: code/system-contracts/contracts/ComplexUpgrader.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ComplexUpgrader.sol#L3)

```solidity
File: code/system-contracts/contracts/Compressor.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L3)

```solidity
File: code/system-contracts/contracts/Constants.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L3)

```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L3)

```solidity
File: code/system-contracts/contracts/DefaultAccount.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L3)

```solidity
File: code/system-contracts/contracts/EmptyContract.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/EmptyContract.sol#L3)

```solidity
File: code/system-contracts/contracts/ImmutableSimulator.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ImmutableSimulator.sol#L3)

```solidity
File: code/system-contracts/contracts/KnownCodesStorage.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/KnownCodesStorage.sol#L3)

```solidity
File: code/system-contracts/contracts/L1Messenger.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L3)

```solidity
File: code/system-contracts/contracts/L2BaseToken.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L2BaseToken.sol#L3)

```solidity
File: code/system-contracts/contracts/MsgValueSimulator.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/MsgValueSimulator.sol#L3)

```solidity
File: code/system-contracts/contracts/NonceHolder.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L3)

```solidity
File: code/system-contracts/contracts/PubdataChunkPublisher.sol

2: pragma solidity 0.8.20;
```
[2](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/PubdataChunkPublisher.sol#L2)

```solidity
File: code/system-contracts/contracts/SystemContext.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L3)

```solidity
File: code/system-contracts/contracts/GasBoundCaller.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/GasBoundCaller.sol#L3)

```solidity
File: code/system-contracts/contracts/libraries/EfficientCall.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L3)

```solidity
File: code/system-contracts/contracts/libraries/RLPEncoder.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/RLPEncoder.sol#L3)

```solidity
File: code/system-contracts/contracts/libraries/SystemContractHelper.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L3)

```solidity
File: code/system-contracts/contracts/libraries/SystemContractsCaller.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L3)

```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L3)

```solidity
File: code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol#L3)

```solidity
File: code/system-contracts/contracts/libraries/Utils.sol

2: pragma solidity 0.8.20;
```
[2](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L2)

```solidity
File: code/system-contracts/contracts/interfaces/IAccount.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IAccount.sol#L3)

```solidity
File: code/system-contracts/contracts/interfaces/IAccountCodeStorage.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IAccountCodeStorage.sol#L3)

```solidity
File: code/system-contracts/contracts/interfaces/IBaseToken.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IBaseToken.sol#L3)

```solidity
File: code/system-contracts/contracts/interfaces/IBootloaderUtilities.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IBootloaderUtilities.sol#L3)

```solidity
File: code/system-contracts/contracts/interfaces/IComplexUpgrader.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IComplexUpgrader.sol#L3)

```solidity
File: code/system-contracts/contracts/interfaces/ICompressor.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/ICompressor.sol#L3)

```solidity
File: code/system-contracts/contracts/interfaces/IContractDeployer.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L3)

```solidity
File: code/system-contracts/contracts/interfaces/IImmutableSimulator.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IImmutableSimulator.sol#L3)

```solidity
File: code/system-contracts/contracts/interfaces/IKnownCodesStorage.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IKnownCodesStorage.sol#L3)

```solidity
File: code/system-contracts/contracts/interfaces/IL1Messenger.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IL1Messenger.sol#L3)

```solidity
File: code/system-contracts/contracts/interfaces/IL2StandardToken.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IL2StandardToken.sol#L3)

```solidity
File: code/system-contracts/contracts/interfaces/IMailbox.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IMailbox.sol#L3)

```solidity
File: code/system-contracts/contracts/interfaces/INonceHolder.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/INonceHolder.sol#L3)

```solidity
File: code/system-contracts/contracts/interfaces/IPaymaster.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IPaymaster.sol#L3)

```solidity
File: code/system-contracts/contracts/interfaces/IPaymasterFlow.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IPaymasterFlow.sol#L3)

```solidity
File: code/system-contracts/contracts/interfaces/IPubdataChunkPublisher.sol

2: pragma solidity 0.8.20;
```
[2](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IPubdataChunkPublisher.sol#L2)

```solidity
File: code/system-contracts/contracts/interfaces/ISystemContext.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/ISystemContext.sol#L3)

```solidity
File: code/system-contracts/contracts/interfaces/ISystemContextDeprecated.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/ISystemContextDeprecated.sol#L3)

```solidity
File: code/system-contracts/contracts/interfaces/ISystemContract.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/ISystemContract.sol#L3)

```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L3)

```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L3)

```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL1ERC20Bridge.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L3)

```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL1SharedBridge.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/interfaces/IL1SharedBridge.sol#L3)

```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol#L3)

```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol#L3)

```solidity
File: code/contracts/zksync/contracts/interfaces/IPaymaster.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/interfaces/IPaymaster.sol#L3)

```solidity
File: code/contracts/zksync/contracts/interfaces/IPaymasterFlow.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/interfaces/IPaymasterFlow.sol#L3)

```solidity
File: code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol

19: pragma solidity 0.8.20;
```
[19](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol#L19)

```solidity
File: code/contracts/zksync/contracts/ForceDeployUpgrader.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/ForceDeployUpgrader.sol#L3)

```solidity
File: code/contracts/zksync/contracts/L2ContractHelper.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/L2ContractHelper.sol#L3)

```solidity
File: code/contracts/zksync/contracts/SystemContractsCaller.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/SystemContractsCaller.sol#L3)
</details>

### [N-38] NatSpec: Function `@param` tag is missing

Natural Specification (NatSpec) comments are crucial for understanding the role of function arguments in your Solidity code.
Including `@param` tags will not only improve your code's readability but also its maintainability by clearly defining each argument's purpose.

[More information in Documentation](https://docs.soliditylang.org/en/develop/natspec-format.html)

<details>
<summary><i>195 issue instances in 33 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

/// @audit Missed @param `_sharedBridge`
55: constructor(IL1SharedBridge _sharedBridge) reentrancyGuardInitializer {
/// @audit Missed @param `_token, _amount`
63: function tranferTokenToSharedBridge(address _token, uint256 _amount) external {
/// @audit Missed @param `_l1Token`
75: function l2TokenAddress(address _l1Token) external view returns (address) {
/// @audit Missed @param `_from, _token, _amount`
160: function _depositFundsToSharedBridge(address _from, IERC20 _token, uint256 _amount) internal returns (uint256) {
/// @audit Missed @param `_sharedBridge`
55: constructor(IL1SharedBridge _sharedBridge) reentrancyGuardInitializer {
/// @audit Missed @param `_token, _amount`
63: function tranferTokenToSharedBridge(address _token, uint256 _amount) external {
/// @audit Missed @param `_l1Token`
75: function l2TokenAddress(address _l1Token) external view returns (address) {
/// @audit Missed @param `_from, _token, _amount`
160: function _depositFundsToSharedBridge(address _from, IERC20 _token, uint256 _amount) internal returns (uint256) {
```
[55](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L55) | [63](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L63) | [75](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L75) | [160](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L160) | [55](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L55) | [63](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L63) | [75](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L75) | [160](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L160)

```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

/// @audit Missed @param `_l1WethAddress, _bridgehub, _legacyBridge`
90: constructor(
        address _l1WethAddress,
        IBridgehub _bridgehub,
        IL1ERC20Bridge _legacyBridge
    ) reentrancyGuardInitializer {
/// @audit Missed @param `_eraFirstPostUpgradeBatch`
104: function initialize(
        address _owner,
        uint256 _eraFirstPostUpgradeBatch
    ) external reentrancyGuardInitializer initializer {
/// @audit Missed @param `_token, _target, _targetChainId`
116: function transferFundsFromLegacy(address _token, address _target, uint256 _targetChainId) external onlyOwner {
/// @audit Missed @param `_chainId`
137: function receiveEth(uint256 _chainId) external payable {
/// @audit Missed @param `_chainId, _l2BridgeAddress`
142: function initializeChainGovernance(uint256 _chainId, address _l2BridgeAddress) external onlyOwner {
/// @audit Missed @param `_chainId, _prevMsgSender, _l1Token, _amount`
148: function bridgehubDepositBaseToken(
        uint256 _chainId,
        address _prevMsgSender,
        address _l1Token,
        uint256 _amount
    ) external payable virtual onlyBridgehubOrEra(_chainId) {
/// @audit Missed @param `_from, _token, _amount`
173: function _depositFunds(address _from, IERC20 _token, uint256 _amount) internal returns (uint256) {
/// @audit Missed @param `_chainId, _prevMsgSender, uint256, l2Value, _data`
182: function bridgehubDeposit(
        uint256 _chainId,
        address _prevMsgSender,
        uint256, // l2Value, needed for Weth deposits in the future
        bytes calldata _data
    ) external payable override onlyBridgehub returns (L2TransactionRequestTwoBridgesInner memory request) {
/// @audit Missed @param `_chainId, _txDataHash, _txHash`
232: function bridgehubConfirmL2Transaction(
        uint256 _chainId,
        bytes32 _txDataHash,
        bytes32 _txHash
    ) external override onlyBridgehub {
/// @audit Missed @param `_l1Sender, _l2Receiver, _l1Token, _amount`
243: function _getDepositL2Calldata(
        address _l1Sender,
        address _l2Receiver,
        address _l1Token,
        uint256 _amount
    ) internal view returns (bytes memory) {
/// @audit Missed @param `_token`
254: function _getERC20Getters(address _token) internal view returns (bytes memory) {
/// @audit Missed @param `_chainId`
277: function claimFailedDeposit(
        uint256 _chainId,
        address _depositSender,
        address _l1Token,
        uint256 _amount,
        bytes32 _l2TxHash,
        uint256 _l2BatchNumber,
        uint256 _l2MessageIndex,
        uint16 _l2TxNumberInBatch,
        bytes32[] calldata _merkleProof
    ) external override {
/// @audit Missed @param `_checkedInLegacyBridge, _chainId, _depositSender, _l1Token, _amount, _l2TxHash, _l2BatchNumber, _l2MessageIndex, _l2TxNumberInBatch, _merkleProof`
303: function _claimFailedDeposit(
        bool _checkedInLegacyBridge,
        uint256 _chainId,
        address _depositSender,
        address _l1Token,
        uint256 _amount,
        bytes32 _l2TxHash,
        uint256 _l2BatchNumber,
        uint256 _l2MessageIndex,
        uint16 _l2TxNumberInBatch,
        bytes32[] calldata _merkleProof
    ) internal nonReentrant {
/// @audit Missed @param `_chainId, _l2BatchNumber, _l2MessageIndex, _l2TxNumberInBatch, _message, _merkleProof`
409: function _finalizeWithdrawal(
        uint256 _chainId,
        uint256 _l2BatchNumber,
        uint256 _l2MessageIndex,
        uint16 _l2TxNumberInBatch,
        bytes calldata _message,
        bytes32[] calldata _merkleProof
    ) internal nonReentrant returns (address l1Receiver, address l1Token, uint256 amount) {
/// @audit Missed @param `_chainId, _messageParams, _message, _merkleProof`
458: function _checkWithdrawal(
        uint256 _chainId,
        MessageParams memory _messageParams,
        bytes calldata _message,
        bytes32[] calldata _merkleProof
    ) internal view returns (address l1Receiver, address l1Token, uint256 amount) {
/// @audit Missed @param `_chainId, _l2ToL1message`
487: function _parseL2WithdrawalMessage(
        uint256 _chainId,
        bytes memory _l2ToL1message
    ) internal view returns (address l1Receiver, address l1Token, uint256 amount) {
/// @audit Missed @param `_prevMsgSender`
554: function depositLegacyErc20Bridge(
        address _prevMsgSender,
        address _l2Receiver,
        address _l1Token,
        uint256 _amount,
        uint256 _l2TxGasLimit,
        uint256 _l2TxGasPerPubdataByte,
        address _refundRecipient
    ) external payable override onlyLegacyBridge nonReentrant returns (bytes32 l2TxHash) {
```
[90](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L90) | [104](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L104) | [116](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L116) | [137](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L137) | [142](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L142) | [148](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L148) | [173](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L173) | [182](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L182) | [232](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L232) | [243](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L243) | [254](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L254) | [277](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L277) | [303](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L303) | [409](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L409) | [458](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L458) | [487](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L487) | [554](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L554)

```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

/// @audit Missed @param `_owner`
41: function initialize(address _owner) external reentrancyGuardInitializer {
/// @audit Missed @param `_chainId`
75: function getStateTransition(uint256 _chainId) public view returns (address) {
/// @audit Missed @param `_stateTransitionManager`
82: function addStateTransitionManager(address _stateTransitionManager) external onlyOwner {
/// @audit Missed @param `_stateTransitionManager`
92: function removeStateTransitionManager(address _stateTransitionManager) external onlyOwner {
/// @audit Missed @param `_token`
101: function addToken(address _token) external onlyOwner {
/// @audit Missed @param `_sharedBridge`
108: function setSharedBridge(address _sharedBridge) external onlyOwner {
/// @audit Missed @param `_chainId, _stateTransitionManager, _baseToken, uint256, _admin, _initData`
114: function createNewChain(
        uint256 _chainId,
        address _stateTransitionManager,
        address _baseToken,
        uint256, //_salt
        address _admin,
        bytes calldata _initData
    ) external onlyOwnerOrAdmin nonReentrant returns (uint256 chainId) {
/// @audit Missed @param `_chainId, _batchNumber, _index, _message, _proof`
152: function proveL2MessageInclusion(
        uint256 _chainId,
        uint256 _batchNumber,
        uint256 _index,
        L2Message calldata _message,
        bytes32[] calldata _proof
    ) external view override returns (bool) {
/// @audit Missed @param `_chainId, _batchNumber, _index, _log, _proof`
164: function proveL2LogInclusion(
        uint256 _chainId,
        uint256 _batchNumber,
        uint256 _index,
        L2Log memory _log,
        bytes32[] calldata _proof
    ) external view override returns (bool) {
/// @audit Missed @param `_chainId, _l2TxHash, _l2BatchNumber, _l2MessageIndex, _l2TxNumberInBatch, _merkleProof, _status`
176: function proveL1ToL2TransactionStatus(
        uint256 _chainId,
        bytes32 _l2TxHash,
        uint256 _l2BatchNumber,
        uint256 _l2MessageIndex,
        uint16 _l2TxNumberInBatch,
        bytes32[] calldata _merkleProof,
        TxStatus _status
    ) external view override returns (bool) {
/// @audit Missed @param `_chainId, _gasPrice, _l2GasLimit, _l2GasPerPubdataByteLimit`
198: function l2TransactionBaseCost(
        uint256 _chainId,
        uint256 _gasPrice,
        uint256 _l2GasLimit,
        uint256 _l2GasPerPubdataByteLimit
    ) external view returns (uint256) {
/// @audit Missed @param `_request`
217: function requestL2TransactionDirect(
        L2TransactionRequestDirect calldata _request
    ) external payable override nonReentrant returns (bytes32 canonicalTxHash) {
/// @audit Missed @param `_request`
262: function requestL2TransactionTwoBridges(
        L2TransactionRequestTwoBridgesOuter calldata _request
    ) external payable override nonReentrant returns (bytes32 canonicalTxHash) {
/// @audit Missed @param `_refundRecipient`
325: function _actualRefundRecipient(address _refundRecipient) internal view returns (address _recipient) {
```
[41](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L41) | [75](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L75) | [82](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L82) | [92](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L92) | [101](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L101) | [108](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L108) | [114](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L114) | [152](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L152) | [164](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L164) | [176](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L176) | [198](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L198) | [217](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L217) | [262](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L262) | [325](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L325)

```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

/// @audit Missed @param `_id`
84: function isOperation(bytes32 _id) public view returns (bool) {
/// @audit Missed @param `_id`
89: function isOperationPending(bytes32 _id) public view returns (bool) {
/// @audit Missed @param `_id`
95: function isOperationReady(bytes32 _id) public view returns (bool) {
/// @audit Missed @param `_id`
100: function isOperationDone(bytes32 _id) public view returns (bool) {
/// @audit Missed @param `_id`
105: function getOperationState(bytes32 _id) public view returns (OperationState) {
```
[84](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L84) | [89](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L89) | [95](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L95) | [100](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L100) | [105](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L105)

```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

/// @audit Missed @param `_bridgehub`
58: constructor(address _bridgehub) reentrancyGuardInitializer {
/// @audit Missed @param `_chainId`
74: function getChainAdmin(uint256 _chainId) external view override returns (address) {
/// @audit Missed @param `_initializeData`
79: function initialize(
        StateTransitionManagerInitializeData calldata _initializeData
    ) external reentrancyGuardInitializer {
/// @audit Missed @param `_validatorTimelock`
132: function setValidatorTimelock(address _validatorTimelock) external onlyOwnerOrAdmin {
/// @audit Missed @param `_diamondCut`
137: function setInitialCutHash(Diamond.DiamondCutData calldata _diamondCut) external onlyOwner {
/// @audit Missed @param `_cutData, _oldProtocolVersion, _newProtocolVersion`
142: function setNewVersionUpgrade(
        Diamond.DiamondCutData calldata _cutData,
        uint256 _oldProtocolVersion,
        uint256 _newProtocolVersion
    ) external onlyOwner {
/// @audit Missed @param `_cutData, _oldProtocolVersion`
152: function setUpgradeDiamondCut(
        Diamond.DiamondCutData calldata _cutData,
        uint256 _oldProtocolVersion
    ) external onlyOwner {
/// @audit Missed @param `_chainId`
160: function freezeChain(uint256 _chainId) external onlyOwner {
/// @audit Missed @param `_chainId`
165: function unfreezeChain(uint256 _chainId) external onlyOwner {
/// @audit Missed @param `_chainId, _newLastBatch`
170: function revertBatches(uint256 _chainId, uint256 _newLastBatch) external onlyOwnerOrAdmin {
/// @audit Missed @param `_chainId, _chainContract`
177: function _setChainIdUpgrade(uint256 _chainId, address _chainContract) internal {
/// @audit Missed @param `_chainId, _stateTransitionContract`
230: function registerAlreadyDeployedStateTransition(
        uint256 _chainId,
        address _stateTransitionContract
    ) external onlyOwner {
/// @audit Missed @param `_chainId, _baseToken, _sharedBridge, _admin, _diamondCut`
239: function createNewChain(
        uint256 _chainId,
        address _baseToken,
        address _sharedBridge,
        address _admin,
        bytes calldata _diamondCut
    ) external onlyBridgehub {
```
[58](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L58) | [74](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L74) | [79](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L79) | [132](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L132) | [137](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L137) | [142](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L142) | [152](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L152) | [160](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L160) | [165](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L165) | [170](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L170) | [177](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L177) | [230](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L230) | [239](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L239)

```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

/// @audit Missed @param `_initialOwner, _executionDelay`
55: constructor(address _initialOwner, uint32 _executionDelay) {
/// @audit Missed @param `_stateTransitionManager`
73: function setStateTransitionManager(IStateTransitionManager _stateTransitionManager) external onlyOwner {
/// @audit Missed @param `_chainId, _newValidator`
78: function addValidator(uint256 _chainId, address _newValidator) external onlyChainAdmin(_chainId) {
/// @audit Missed @param `_chainId, _validator`
87: function removeValidator(uint256 _chainId, address _validator) external onlyChainAdmin(_chainId) {
/// @audit Missed @param `_executionDelay`
96: function setExecutionDelay(uint32 _executionDelay) external onlyOwner {
/// @audit Missed @param `_chainId, _l2BatchNumber`
102: function getCommittedBatchTimestamp(uint256 _chainId, uint256 _l2BatchNumber) external view returns (uint256) {
/// @audit Missed @param `StoredBatchInfo, _newBatchesData`
108: function commitBatches(
        StoredBatchInfo calldata,
        CommitBatchInfo[] calldata _newBatchesData
    ) external onlyValidator(ERA_CHAIN_ID) {
/// @audit Missed @param `_chainId, StoredBatchInfo, _newBatchesData`
126: function commitBatchesSharedBridge(
        uint256 _chainId,
        StoredBatchInfo calldata,
        CommitBatchInfo[] calldata _newBatchesData
    ) external onlyValidator(_chainId) {
/// @audit Missed @param `uint256`
146: function revertBatches(uint256) external onlyValidator(ERA_CHAIN_ID) {
/// @audit Missed @param `_chainId, uint256`
153: function revertBatchesSharedBridge(uint256 _chainId, uint256) external onlyValidator(_chainId) {
/// @audit Missed @param `StoredBatchInfo, StoredBatchInfo[], ProofInput`
160: function proveBatches(
        StoredBatchInfo calldata,
        StoredBatchInfo[] calldata,
        ProofInput calldata
    ) external onlyValidator(ERA_CHAIN_ID) {
/// @audit Missed @param `_chainId, StoredBatchInfo, StoredBatchInfo[], ProofInput`
171: function proveBatchesSharedBridge(
        uint256 _chainId,
        StoredBatchInfo calldata,
        StoredBatchInfo[] calldata,
        ProofInput calldata
    ) external onlyValidator(_chainId) {
/// @audit Missed @param `_newBatchesData`
182: function executeBatches(StoredBatchInfo[] calldata _newBatchesData) external onlyValidator(ERA_CHAIN_ID) {
/// @audit Missed @param `_chainId, _newBatchesData`
203: function executeBatchesSharedBridge(
        uint256 _chainId,
        StoredBatchInfo[] calldata _newBatchesData
    ) external onlyValidator(_chainId) {
/// @audit Missed @param `_chainId`
225: function _propagateToZkSyncStateTransition(uint256 _chainId) internal {
```
[55](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L55) | [73](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L73) | [78](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L78) | [87](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L87) | [96](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L96) | [102](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L102) | [108](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L108) | [126](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L126) | [146](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L146) | [153](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L153) | [160](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L160) | [171](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L171) | [182](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L182) | [203](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L203) | [225](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L225)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol

/// @audit Missed @param `_initializeData`
24: function initialize(InitializeData calldata _initializeData) external reentrancyGuardInitializer returns (bytes32) {
```
[24](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol#L24)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol

/// @audit Missed @param `_chainId, _diamondCut`
11: constructor(uint256 _chainId, Diamond.DiamondCutData memory _diamondCut) {
```
[11](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol#L11)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol

/// @audit Missed @param `_validiumMode`
89: function setValidiumMode(PubdataPricingMode _validiumMode) external onlyAdmin {
/// @audit Missed @param `_oldProtocolVersion, _diamondCut`
100: function upgradeChainFromVersion(
        uint256 _oldProtocolVersion,
        Diamond.DiamondCutData calldata _diamondCut
    ) external onlyAdminOrStateTransitionManager {
```
[89](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L89) | [100](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L100)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

/// @audit Missed @param `_previousBatch, _newBatch, _expectedSystemContractUpgradeTxHash`
32: function _commitOneBatch(
        StoredBatchInfo memory _previousBatch,
        CommitBatchInfo calldata _newBatch,
        bytes32 _expectedSystemContractUpgradeTxHash
    ) internal view returns (StoredBatchInfo memory) {
/// @audit Missed @param `_newBatch, _expectedSystemContractUpgradeTxHash`
130: function _processL2Logs(
        CommitBatchInfo calldata _newBatch,
        bytes32 _expectedSystemContractUpgradeTxHash
    ) internal pure returns (LogProcessingOutput memory logOutput) {
/// @audit Missed @param `_lastCommittedBatchData, _newBatchesData`
215: function _commitBatches(
        StoredBatchInfo memory _lastCommittedBatchData,
        CommitBatchInfo[] calldata _newBatchesData
    ) internal {
/// @audit Missed @param `_nPriorityOps`
308: function _collectOperationsFromPriorityQueue(uint256 _nPriorityOps) internal returns (bytes32 concatHash) {
/// @audit Missed @param `_storedBatch, _executedBatchIdx`
321: function _executeOneBatch(StoredBatchInfo memory _storedBatch, uint256 _executedBatchIdx) internal {
/// @audit Missed @param `_batchesData`
349: function _executeBatches(StoredBatchInfo[] calldata _batchesData) internal {
/// @audit Missed @param `_prevBatch, _committedBatches, _proof`
386: function _proveBatches(
        StoredBatchInfo calldata _prevBatch,
        StoredBatchInfo[] calldata _committedBatches,
        ProofInput calldata _proof
    ) internal {
/// @audit Missed @param `proofPublicInput, _proof`
440: function _verifyProof(uint256[] memory proofPublicInput, ProofInput calldata _proof) internal view {
/// @audit Missed @param `_prevBatchCommitment, _currentBatchCommitment, _verifierParams`
453: function _getBatchProofPublicInput(
        bytes32 _prevBatchCommitment,
        bytes32 _currentBatchCommitment,
        VerifierParams memory _verifierParams
    ) internal pure returns (uint256) {
/// @audit Missed @param `_newLastBatch`
481: function _revertBatches(uint256 _newLastBatch) internal {
/// @audit Missed @param `_newBatchData, _stateDiffHash, _blobCommitments, _blobHashes`
500: function _createBatchCommitment(
        CommitBatchInfo calldata _newBatchData,
        bytes32 _stateDiffHash,
        bytes32[] memory _blobCommitments,
        bytes32[] memory _blobHashes
    ) internal view returns (bytes32) {
/// @audit Missed @param `_batch`
515: function _batchPassThroughData(CommitBatchInfo calldata _batch) internal pure returns (bytes memory) {
/// @audit Missed @param `_batch, _stateDiffHash, _blobCommitments, _blobHashes`
537: function _batchAuxiliaryOutput(
        CommitBatchInfo calldata _batch,
        bytes32 _stateDiffHash,
        bytes32[] memory _blobCommitments,
        bytes32[] memory _blobHashes
    ) internal pure returns (bytes memory) {
/// @audit Missed @param `_storedBatchInfo`
587: function _hashStoredBatchInfo(StoredBatchInfo memory _storedBatchInfo) internal pure returns (bytes32) {
/// @audit Missed @param `_bitMap, _index`
592: function _checkBit(uint256 _bitMap, uint8 _index) internal pure returns (bool) {
/// @audit Missed @param `_bitMap, _index`
597: function _setBit(uint256 _bitMap, uint8 _index) internal pure returns (uint256) {
/// @audit Missed @param `_versionedHash, _openingPoint, _openingValueCommitmentProof`
605: function _pointEvaluationPrecompile(
        bytes32 _versionedHash,
        bytes32 _openingPoint,
        bytes calldata _openingValueCommitmentProof
    ) internal view {
/// @audit Missed @param `_pubdataCommitments, _blobHashes`
625: function _verifyBlobInformation(
        bytes calldata _pubdataCommitments,
        bytes32[] memory _blobHashes
    ) internal view returns (bytes32[] memory blobCommitments) {
/// @audit Missed @param `_index`
679: function _getBlobVersionedHash(uint256 _index) internal view returns (bytes32 versionedHash) {
```
[32](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L32) | [130](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L130) | [215](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L215) | [308](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L308) | [321](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L321) | [349](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L349) | [386](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L386) | [440](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L440) | [453](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L453) | [481](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L481) | [500](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L500) | [515](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L515) | [537](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L537) | [587](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L587) | [592](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L592) | [597](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L597) | [605](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L605) | [625](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L625) | [679](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L679)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

/// @audit Missed @param `_request`
47: function bridgehubRequestL2Transaction(
        BridgehubL2TransactionRequest memory _request
    ) external payable onlyBridgehub returns (bytes32 canonicalTxHash) {
/// @audit Missed @param `_batchNumber, _index, _log, _proof`
104: function _proveL2LogInclusion(
        uint256 _batchNumber,
        uint256 _index,
        L2Log memory _log,
        bytes32[] calldata _proof
    ) internal view returns (bool) {
/// @audit Missed @param `_message`
130: function _L2MessageToLog(L2Message memory _message) internal pure returns (L2Log memory) {
/// @audit Missed @param `_request`
228: function _requestL2TransactionSender(
        BridgehubL2TransactionRequest memory _request
    ) internal nonReentrant returns (bytes32 canonicalTxHash) {
/// @audit Missed @param `_mintValue, _params, _calldata, _factoryDeps`
258: function _requestL2Transaction(
        uint256 _mintValue,
        WritePriorityOpParams memory _params,
        bytes memory _calldata,
        bytes[] memory _factoryDeps
    ) internal returns (bytes32 canonicalTxHash) {
/// @audit Missed @param `_priorityOpParams, _calldata, _factoryDeps`
289: function _serializeL2Transaction(
        WritePriorityOpParams memory _priorityOpParams,
        bytes memory _calldata,
        bytes[] memory _factoryDeps
    ) internal pure returns (L2CanonicalTransaction memory transaction) {
/// @audit Missed @param `_priorityOpParams, _calldata, _factoryDeps`
316: function _writePriorityOp(
        WritePriorityOpParams memory _priorityOpParams,
        bytes memory _calldata,
        bytes[] memory _factoryDeps
    ) internal returns (bytes32 canonicalTxHash) {
/// @audit Missed @param `_factoryDeps`
353: function _hashFactoryDeps(bytes[] memory _factoryDeps) internal pure returns (uint256[] memory hashedFactoryDeps) {
```
[47](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L47) | [104](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L104) | [130](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L130) | [228](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L228) | [258](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L258) | [289](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L289) | [316](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L316) | [353](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L353)

```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol

/// @audit Missed @param `_factoryDeps, _newProtocolVersion`
180: function _setL2SystemContractUpgrade(
        L2CanonicalTransaction calldata _l2ProtocolUpgradeTx,
        bytes[] calldata _factoryDeps,
        uint256 _newProtocolVersion
    ) internal returns (bytes32) {
```
[180](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L180)

```solidity
File: code/contracts/ethereum/contracts/common/libraries/UncheckedMath.sol

/// @audit Missed @param `_number`
11: function uncheckedInc(uint256 _number) internal pure returns (uint256) {
/// @audit Missed @param `_lhs, _rhs`
17: function uncheckedAdd(uint256 _lhs, uint256 _rhs) internal pure returns (uint256) {
```
[11](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/UncheckedMath.sol#L11) | [17](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/UncheckedMath.sol#L17)

```solidity
File: code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol

/// @audit Missed @param `_bytes, _start`
19: function readUint32(bytes memory _bytes, uint256 _start) internal pure returns (uint32 result, uint256 offset) {
/// @audit Missed @param `_bytes, _start`
26: function readAddress(bytes memory _bytes, uint256 _start) internal pure returns (address result, uint256 offset) {
/// @audit Missed @param `_bytes, _start`
33: function readUint256(bytes memory _bytes, uint256 _start) internal pure returns (uint256 result, uint256 offset) {
/// @audit Missed @param `_bytes, _start`
40: function readBytes32(bytes memory _bytes, uint256 _start) internal pure returns (bytes32 result, uint256 offset) {
```
[19](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol#L19) | [26](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol#L26) | [33](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol#L33) | [40](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol#L40)

```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol

/// @audit Missed @param `_facet, _selectors, _isFacetFreezable`
126: function _addFunctions(address _facet, bytes4[] memory _selectors, bool _isFacetFreezable) private {
/// @audit Missed @param `_facet, _selectors, _isFacetFreezable`
149: function _replaceFunctions(address _facet, bytes4[] memory _selectors, bool _isFacetFreezable) private {
/// @audit Missed @param `_facet, _selectors`
172: function _removeFunctions(address _facet, bytes4[] memory _selectors) private {
/// @audit Missed @param `_facet`
189: function _saveFacetIfNew(address _facet) private {
/// @audit Missed @param `_facet, _selector, _isSelectorFreezable`
205: function _addOneFunction(address _facet, bytes4 _selector, bool _isSelectorFreezable) private {
/// @audit Missed @param `_facet, _selector`
228: function _removeOneFunction(address _facet, bytes4 _selector) private {
/// @audit Missed @param `_facet`
257: function _removeFacet(address _facet) private {
/// @audit Missed @param `_init, _calldata`
278: function _initializeDiamondCut(address _init, bytes memory _calldata) private {
```
[126](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L126) | [149](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L149) | [172](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L172) | [189](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L189) | [205](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L205) | [228](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L228) | [257](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L257) | [278](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L278)

```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol

/// @audit Missed @param `_lhs, _rhs`
40: function _efficientHash(bytes32 _lhs, bytes32 _rhs) private pure returns (bytes32 result) {
```
[40](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol#L40)

```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol

/// @audit Missed @param `_queue`
35: function getFirstUnprocessedPriorityTx(Queue storage _queue) internal view returns (uint256) {
/// @audit Missed @param `_queue`
40: function getTotalPriorityTxs(Queue storage _queue) internal view returns (uint256) {
/// @audit Missed @param `_queue`
45: function getSize(Queue storage _queue) internal view returns (uint256) {
/// @audit Missed @param `_queue`
50: function isEmpty(Queue storage _queue) internal view returns (bool) {
/// @audit Missed @param `_queue, _operation`
55: function pushBack(Queue storage _queue, PriorityOperation memory _operation) internal {
/// @audit Missed @param `_queue`
64: function front(Queue storage _queue) internal view returns (PriorityOperation memory) {
/// @audit Missed @param `_queue`
72: function popFront(Queue storage _queue) internal returns (PriorityOperation memory priorityOperation) {
```
[35](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L35) | [40](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L40) | [45](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L45) | [50](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L50) | [55](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L55) | [64](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L64) | [72](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L72)

```solidity
File: code/system-contracts/contracts/Compressor.sol

/// @audit Missed @param `_numberOfStateDiffs, _enumerationIndexSize, _stateDiffs, _compressedStateDiffs`
110: function verifyCompressedStateDiffs(
        uint256 _numberOfStateDiffs,
        uint256 _enumerationIndexSize,
        bytes calldata _stateDiffs,
        bytes calldata _compressedStateDiffs
    ) external payable onlyCallFrom(address(L1_MESSENGER_CONTRACT)) returns (bytes32 stateDiffHash) {
```
[110](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L110)

```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

/// @audit Missed @param `_address`
34: function getAccountInfo(address _address) external view returns (AccountInfo memory info) {
/// @audit Missed @param `_address`
40: function extendedAccountVersion(address _address) public view returns (AccountAbstractionVersion) {
/// @audit Missed @param `_address, _newInfo`
58: function _storeAccountInfo(address _address, AccountInfo memory _newInfo) internal {
/// @audit Missed @param `_salt`
147: function create(
        bytes32 _salt,
        bytes32 _bytecodeHash,
        bytes calldata _input
    ) external payable override returns (address) {
/// @audit Missed @param `bytes32`
182: function createAccount(
        bytes32, // salt
        bytes32 _bytecodeHash,
        bytes calldata _input,
        AccountAbstractionVersion _aaVersion
    ) public payable override onlySystemCall returns (address) {
/// @audit Missed @param `_deployments`
238: function forceDeployOnAddresses(ForceDeployment[] calldata _deployments) external payable {
/// @audit Missed @param `_bytecodeHash, _newAddress, _aaVersion, _input`
258: function _nonSystemDeployOnAddress(
        bytes32 _bytecodeHash,
        address _newAddress,
        AccountAbstractionVersion _aaVersion,
        bytes calldata _input
    ) internal {
/// @audit Missed @param `_bytecodeHash`
301: function _ensureBytecodeIsKnown(bytes32 _bytecodeHash) internal view {
/// @audit Missed @param `_bytecodeHash, _callConstructor`
321: function _constructContract(
        address _sender,
        address _newAddress,
        bytes32 _bytecodeHash,
        bytes calldata _input,
        bool _isSystem,
        bool _callConstructor
    ) internal {
```
[34](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L34) | [40](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L40) | [58](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L58) | [147](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L147) | [182](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L182) | [238](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L238) | [258](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L258) | [301](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L301) | [321](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L321)

```solidity
File: code/system-contracts/contracts/DefaultAccount.sol

/// @audit Missed @param `bytes32`
67: function validateTransaction(
        bytes32, // _txHash
        bytes32 _suggestedSignedHash,
        Transaction calldata _transaction
    ) external payable override ignoreNonBootloader ignoreInDelegateCall returns (bytes4 magic) {
/// @audit Missed @param `bytes32, bytes32`
112: function executeTransaction(
        bytes32, // _txHash
        bytes32, // _suggestedSignedHash
        Transaction calldata _transaction
    ) external payable override ignoreNonBootloader ignoreInDelegateCall {
/// @audit Missed @param `bytes32, bytes32`
196: function payForTransaction(
        bytes32, // _txHash
        bytes32, // _suggestedSignedHash
        Transaction calldata _transaction
    ) external payable ignoreNonBootloader ignoreInDelegateCall {
/// @audit Missed @param `bytes32, bytes32`
212: function prepareForPaymaster(
        bytes32, // _txHash
        bytes32, // _suggestedSignedHash
        Transaction calldata _transaction
    ) external payable ignoreNonBootloader ignoreInDelegateCall {
```
[67](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L67) | [112](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L112) | [196](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L196) | [212](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L212)

```solidity
File: code/system-contracts/contracts/KnownCodesStorage.sol

/// @audit Missed @param `_hash`
65: function getMarker(bytes32 _hash) public view override returns (uint256 marker) {
/// @audit Missed @param `_bytecodeHash`
74: function _validateBytecode(bytes32 _bytecodeHash) internal pure {
```
[65](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/KnownCodesStorage.sol#L65) | [74](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/KnownCodesStorage.sol#L74)

```solidity
File: code/system-contracts/contracts/L1Messenger.sol

/// @audit Missed @param `_length`
50: function keccakGasCost(uint256 _length) internal pure returns (uint256) {
/// @audit Missed @param `_length`
61: function sha256GasCost(uint256 _length) internal pure returns (uint256) {
/// @audit Missed @param `_l2ToL1Log`
94: function _processL2ToL1Log(L2ToL1Log memory _l2ToL1Log) internal returns (uint256 logIdInMerkleTree) {
```
[50](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L50) | [61](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L61) | [94](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L94)

```solidity
File: code/system-contracts/contracts/L2BaseToken.sol

/// @audit Missed @param `_to, _amount`
112: function _getL1WithdrawMessage(address _to, uint256 _amount) internal pure returns (bytes memory) {
/// @audit Missed @param `_to, _amount, _sender, _additionalData`
117: function _getExtendedWithdrawMessage(
        address _to,
        uint256 _amount,
        address _sender,
        bytes memory _additionalData
    ) internal pure returns (bytes memory) {
```
[112](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L2BaseToken.sol#L112) | [117](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L2BaseToken.sol#L117)

```solidity
File: code/system-contracts/contracts/SystemContext.sol

/// @audit Missed @param `_gasPerPubdataByte, _basePubdataSpent`
112: function setPubdataInfo(uint256 _gasPerPubdataByte, uint256 _basePubdataSpent) external onlyCallFromBootloader {
/// @audit Missed @param `_block`
132: function getBlockHashEVM(uint256 _block) external view returns (bytes32 hash) {
/// @audit Missed @param `_newTimestamp, _number, _baseFee`
471: function unsafeOverrideBatch(
        uint256 _newTimestamp,
        uint256 _number,
        uint256 _baseFee
    ) external onlyCallFromBootloader {
/// @audit Missed @param `_blockNumber`
509: function blockHash(uint256 _blockNumber) external view returns (bytes32 hash) {
```
[112](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L112) | [132](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L132) | [471](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L471) | [509](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L509)

```solidity
File: code/system-contracts/contracts/libraries/RLPEncoder.sol

/// @audit Missed @param `_val`
11: function encodeAddress(address _val) internal pure returns (bytes memory encoded) {
/// @audit Missed @param `_val`
24: function encodeUint256(uint256 _val) internal pure returns (bytes memory encoded) {
/// @audit Missed @param `_len, _offset`
60: function _encodeLength(uint64 _len, uint256 _offset) private pure returns (bytes memory encoded) {
/// @audit Missed @param `_number`
84: function _highestByteSet(uint256 _number) private pure returns (uint256 hbs) {
```
[11](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/RLPEncoder.sol#L11) | [24](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/RLPEncoder.sol#L24) | [60](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/RLPEncoder.sol#L60) | [84](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/RLPEncoder.sol#L84)

```solidity
File: code/system-contracts/contracts/libraries/SystemContractHelper.sol

/// @audit Missed @param `_farCallAbi`
85: function ptrPackIntoActivePtr(uint256 _farCallAbi) internal view {
/// @audit Missed @param `_value`
94: function ptrAddIntoActive(uint32 _value) internal view {
/// @audit Missed @param `_shrink`
106: function ptrShrinkIntoActive(uint32 _shrink) internal view {
/// @audit Missed @param `_pubdataToSpend`
148: function unsafePrecompileCall(
        uint256 _rawParams,
        uint32 _gasToBurn,
        uint32 _pubdataToSpend
    ) internal view returns (bool success) {
/// @audit Missed @param `index`
318: function getExtraAbiData(uint256 index) internal view returns (uint256 extraAbiData) {
/// @audit Missed @param `_pubdataToSpend`
344: function burnGas(uint32 _gasToPay, uint32 _pubdataToSpend) internal view {
```
[85](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L85) | [94](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L94) | [106](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L106) | [148](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L148) | [318](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L318) | [344](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L344)

```solidity
File: code/system-contracts/contracts/libraries/SystemContractsCaller.sol

/// @audit Missed @param `dataOffset, uint32Page, dataStart, dataLength, gasPassed, shardId, forwardingMode, isConstructorCall, isSystemCall`
214: function getFarCallABI(
        uint32 dataOffset,
        uint32 memoryPage,
        uint32 dataStart,
        uint32 dataLength,
        uint32 gasPassed,
        uint8 shardId,
        CalldataForwardingMode forwardingMode,
        bool isConstructorCall,
        bool isSystemCall
    ) internal pure returns (uint256 farCallAbi) {
```
[214](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L214)

```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

/// @audit Missed @param `_transaction`
100: function encodeHash(Transaction calldata _transaction) internal view returns (bytes32 resultHash) {
/// @audit Missed @param `_transaction`
118: function _encodeHashEIP712Transaction(Transaction calldata _transaction) private view returns (bytes32) {
/// @audit Missed @param `_transaction`
147: function _encodeHashLegacyTransaction(Transaction calldata _transaction) private view returns (bytes32) {
/// @audit Missed @param `_transaction`
219: function _encodeHashEIP2930Transaction(Transaction calldata _transaction) private view returns (bytes32) {
/// @audit Missed @param `_transaction`
289: function _encodeHashEIP1559Transaction(Transaction calldata _transaction) private view returns (bytes32) {
/// @audit Missed @param `_transaction`
362: function processPaymasterInput(Transaction calldata _transaction) internal {
/// @audit Missed @param `_transaction`
395: function payToTheBootloader(Transaction calldata _transaction) internal returns (bool success) {
/// @audit Missed @param `_transaction`
405: function totalRequiredBalance(Transaction calldata _transaction) internal pure returns (uint256 requiredBalance) {
```
[100](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L100) | [118](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L118) | [147](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L147) | [219](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L219) | [289](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L289) | [362](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L362) | [395](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L395) | [405](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L405)

```solidity
File: code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol

/// @audit Missed @param `_bytes, _start`
19: function readUint16(bytes calldata _bytes, uint256 _start) internal pure returns (uint16 result) {
/// @audit Missed @param `_bytes, _start`
26: function readUint32(bytes calldata _bytes, uint256 _start) internal pure returns (uint32 result) {
/// @audit Missed @param `_bytes, _start`
33: function readUint64(bytes calldata _bytes, uint256 _start) internal pure returns (uint64 result) {
/// @audit Missed @param `_bytes, _start`
40: function readBytes32(bytes calldata _bytes, uint256 _start) internal pure returns (bytes32 result) {
/// @audit Missed @param `_bytes, _start`
46: function readUint256(bytes calldata _bytes, uint256 _start) internal pure returns (uint256 result) {
```
[19](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol#L19) | [26](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol#L26) | [33](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol#L33) | [40](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol#L40) | [46](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol#L46)

```solidity
File: code/system-contracts/contracts/libraries/Utils.sol

/// @audit Missed @param `_x`
20: function safeCastToU128(uint256 _x) internal pure returns (uint128) {
/// @audit Missed @param `_x`
26: function safeCastToU32(uint256 _x) internal pure returns (uint32) {
/// @audit Missed @param `_x`
32: function safeCastToU24(uint256 _x) internal pure returns (uint24) {
/// @audit Missed @param `_bytecodeHash`
39: function bytecodeLenInBytes(bytes32 _bytecodeHash) internal pure returns (uint256 codeLength) {
/// @audit Missed @param `_bytecodeHash`
44: function bytecodeLenInWords(bytes32 _bytecodeHash) internal pure returns (uint256 codeLengthInWords) {
/// @audit Missed @param `_bytecodeHash`
51: function isContractConstructed(bytes32 _bytecodeHash) internal pure returns (bool) {
/// @audit Missed @param `_bytecodeHash`
56: function isContractConstructing(bytes32 _bytecodeHash) internal pure returns (bool) {
```
[20](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L20) | [26](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L26) | [32](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L32) | [39](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L39) | [44](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L44) | [51](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L51) | [56](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L56)

```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

/// @audit Missed @param `_l1LegecyBridge`
49: function initialize(
        address _l1Bridge,
        address _l1LegecyBridge,
        bytes32 _l2TokenProxyBytecodeHash,
        address _aliasedOwner
    ) external reinitializer(2) {
/// @audit Missed @param `_l1Token, _data`
109: function _deployL2Token(address _l1Token, bytes calldata _data) internal returns (address) {
/// @audit Missed @param `_to, _l1Token, _amount`
138: function _getL1WithdrawMessage(
        address _to,
        address _l1Token,
        uint256 _amount
    ) internal pure returns (bytes memory) {
/// @audit Missed @param `_l1Token`
149: function l2TokenAddress(address _l1Token) public view override returns (address) {
/// @audit Missed @param `_l1Token`
157: function _getCreate2Salt(address _l1Token) internal pure returns (bytes32 salt) {
/// @audit Missed @param `salt`
164: function _deployBeaconProxy(bytes32 salt) internal returns (BeaconProxy proxy) {
```
[49](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L49) | [109](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L109) | [138](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L138) | [149](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L149) | [157](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L157) | [164](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L164)

```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

/// @audit Missed @param `_input`
178: function decodeString(bytes memory _input) external pure returns (string memory result) {
/// @audit Missed @param `_input`
183: function decodeUint8(bytes memory _input) external pure returns (uint8 result) {
```
[178](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L178) | [183](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L183)

```solidity
File: code/contracts/zksync/contracts/SystemContractsCaller.sol

/// @audit Missed @param `_x`
27: function safeCastToU32(uint256 _x) internal pure returns (uint32) {
/// @audit Missed @param `gasLimit, to, value, data`
37: function systemCall(uint32 gasLimit, address to, uint256 value, bytes memory data) internal returns (bool success) {
/// @audit Missed @param `gasLimit, to, value, data`
76: function systemCallWithReturndata(
        uint32 gasLimit,
        address to,
        uint128 value,
        bytes memory data
    ) internal returns (bool success, bytes memory returnData) {
/// @audit Missed @param `dataOffset, uint32Page, dataStart, dataLength, gasPassed, shardId, forwardingMode, isConstructorCall, isSystemCall`
95: function getFarCallABI(
        uint32 dataOffset,
        uint32 memoryPage,
        uint32 dataStart,
        uint32 dataLength,
        uint32 gasPassed,
        uint8 shardId,
        CalldataForwardingMode forwardingMode,
        bool isConstructorCall,
        bool isSystemCall
    ) internal pure returns (uint256 farCallAbi) {
/// @audit Missed @param `gasPassed, shardId, forwardingMode, isConstructorCall, isSystemCall`
121: function getFarCallABIWithEmptyFatPointer(
        uint32 gasPassed,
        uint8 shardId,
        CalldataForwardingMode forwardingMode,
        bool isConstructorCall,
        bool isSystemCall
    ) internal pure returns (uint256 farCallAbiWithEmptyFatPtr) {
```
[27](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/SystemContractsCaller.sol#L27) | [37](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/SystemContractsCaller.sol#L37) | [76](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/SystemContractsCaller.sol#L76) | [95](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/SystemContractsCaller.sol#L95) | [121](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/SystemContractsCaller.sol#L121)
</details>

### [N-39] Consider Using OpenZeppelin's ReentrancyGuard Instead of Custom Implementation

OpenZeppelin's ReentrancyGuard and ReentrancyGuardUpgradeable contracts have been thoroughly tested and gas-optimized. Consider using them instead of writing your own reentrancy guard logic.

Using a proven and optimized library not only ensures security but can also save gas, contributing to overall efficiency and safety.

<details>
<summary><i>1 issue instances in 1 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/common/ReentrancyGuard.sol

68: modifier nonReentrant() {
```
[68](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/ReentrancyGuard.sol#L68)
</details>

### [N-40] High cyclomatic complexity

Functions with high cyclomatic complexity are harder to understand, test, and maintain.
Consider breaking down these blocks into more manageable units, by splitting things into utility functions,
by reducing nesting, and by using early returns.

[Learn More About Cyclomatic Complexity](https://en.wikipedia.org/wiki/Cyclomatic_complexity)

<details>
<summary><i>2 issue instances in 2 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

/// @audit function `_processL2Logs` has a cyclomatic complexity of 14
130: function _processL2Logs(
        CommitBatchInfo calldata _newBatch,
        bytes32 _expectedSystemContractUpgradeTxHash
    ) internal pure returns (LogProcessingOutput memory logOutput) {
```
[130](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L130)

```solidity
File: code/system-contracts/contracts/L1Messenger.sol

/// @audit function `publishPubdataAndClearState` has a cyclomatic complexity of 6
194: function publishPubdataAndClearState(
        bytes calldata _totalL2ToL1PubdataAndStateDiffs
    ) external onlyCallFromBootloader {
```
[194](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L194)
</details>

### [N-41] NatSpec: Function declarations should have descriptions

The Ethereum Natural Specification Format (NatSpec) is an integral part of the Solidity language, serving as a rich, machine-readable, language-agnostic metadata tool.

Documenting all functions, irrespective of their visibility, significantly enhances code readability and auditability.
This is especially vital in complex projects, where clear comprehension of functions, their arguments, and returns is paramount.

Specifically, the `@notice` tag should be used for explanations that anyone should understand, making it a key element in providing a clear understanding of a function's intention.
[More information in Documentation](https://docs.soliditylang.org/en/develop/natspec-format.html)

<details>
<summary><i>209 issue instances in 44 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

75: function l2TokenAddress(address _l1Token) external view returns (address) {
75: function l2TokenAddress(address _l1Token) external view returns (address) {
```
[75](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L75) | [75](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L75)

```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

137: function receiveEth(uint256 _chainId) external payable {
```
[137](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L137)

```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

74: function getChainAdmin(uint256 _chainId) external view override returns (address) {
230: function registerAlreadyDeployedStateTransition(
        uint256 _chainId,
        address _stateTransitionContract
    ) external onlyOwner {
```
[74](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L74) | [230](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L230)

```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

55: constructor(address _initialOwner, uint32 _executionDelay) {
```
[55](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L55)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol

11: constructor(uint256 _chainId, Diamond.DiamondCutData memory _diamondCut) {
```
[11](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol#L11)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol

89: function setValidiumMode(PubdataPricingMode _validiumMode) external onlyAdmin {
100: function upgradeChainFromVersion(
        uint256 _oldProtocolVersion,
        Diamond.DiamondCutData calldata _diamondCut
    ) external onlyAdminOrStateTransitionManager {
```
[89](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L89) | [100](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L100)

```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol

24: function isWithdrawalFinalized(uint256 _l2BatchNumber, uint256 _l2MessageIndex) external view returns (bool);
26: function deposit(
        address _l2Receiver,
        address _l1Token,
        uint256 _amount,
        uint256 _l2TxGasLimit,
        uint256 _l2TxGasPerPubdataByte,
        address _refundRecipient
    ) external payable returns (bytes32 txHash);
35: function deposit(
        address _l2Receiver,
        address _l1Token,
        uint256 _amount,
        uint256 _l2TxGasLimit,
        uint256 _l2TxGasPerPubdataByte
    ) external payable returns (bytes32 txHash);
43: function claimFailedDeposit(
        address _depositSender,
        address _l1Token,
        bytes32 _l2TxHash,
        uint256 _l2BatchNumber,
        uint256 _l2MessageIndex,
        uint16 _l2TxNumberInBatch,
        bytes32[] calldata _merkleProof
    ) external;
53: function finalizeWithdrawal(
        uint256 _l2BatchNumber,
        uint256 _l2MessageIndex,
        uint16 _l2TxNumberInBatch,
        bytes calldata _message,
        bytes32[] calldata _merkleProof
    ) external;
61: function l2TokenAddress(address _l1Token) external view returns (address);
63: function sharedBridge() external view returns (IL1SharedBridge);
65: function l2TokenBeacon() external view returns (address);
67: function l2Bridge() external view returns (address);
69: function depositAmount(
        address _account,
        address _l1Token,
        bytes32 _depositL2TxHash
    ) external returns (uint256 amount);
75: function tranferTokenToSharedBridge(address _token, uint256 _amount) external;
```
[24](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L24) | [26](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L26) | [35](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L35) | [43](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L43) | [53](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L53) | [61](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L61) | [63](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L63) | [65](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L65) | [67](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L67) | [69](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L69) | [75](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L75)

```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol

58: function isWithdrawalFinalized(
        uint256 _chainId,
        uint256 _l2BatchNumber,
        uint256 _l2MessageIndex
    ) external view returns (bool);
64: function depositLegacyErc20Bridge(
        address _msgSender,
        address _l2Receiver,
        address _l1Token,
        uint256 _amount,
        uint256 _l2TxGasLimit,
        uint256 _l2TxGasPerPubdataByte,
        address _refundRecipient
    ) external payable returns (bytes32 txHash);
74: function claimFailedDepositLegacyErc20Bridge(
        address _depositSender,
        address _l1Token,
        uint256 _amount,
        bytes32 _l2TxHash,
        uint256 _l2BatchNumber,
        uint256 _l2MessageIndex,
        uint16 _l2TxNumberInBatch,
        bytes32[] calldata _merkleProof
    ) external;
85: function claimFailedDeposit(
        uint256 _chainId,
        address _depositSender,
        address _l1Token,
        uint256 _amount,
        bytes32 _l2TxHash,
        uint256 _l2BatchNumber,
        uint256 _l2MessageIndex,
        uint16 _l2TxNumberInBatch,
        bytes32[] calldata _merkleProof
    ) external;
97: function finalizeWithdrawalLegacyErc20Bridge(
        uint256 _l2BatchNumber,
        uint256 _l2MessageIndex,
        uint16 _l2TxNumberInBatch,
        bytes calldata _message,
        bytes32[] calldata _merkleProof
    ) external returns (address l1Receiver, address l1Token, uint256 amount);
105: function finalizeWithdrawal(
        uint256 _chainId,
        uint256 _l2BatchNumber,
        uint256 _l2MessageIndex,
        uint16 _l2TxNumberInBatch,
        bytes calldata _message,
        bytes32[] calldata _merkleProof
    ) external;
114: function l1WethAddress() external view returns (address);
116: function bridgehub() external view returns (IBridgehub);
118: function legacyBridge() external view returns (IL1ERC20Bridge);
120: function l2BridgeAddress(uint256 _chainId) external view returns (address);
122: function depositHappened(uint256 _chainId, bytes32 _l2TxHash) external view returns (bytes32);
128: function bridgehubDeposit(
        uint256 _chainId,
        address _prevMsgSender,
        uint256 _l2Value,
        bytes calldata _data
    ) external payable returns (L2TransactionRequestTwoBridgesInner memory request);
135: function bridgehubDepositBaseToken(
        uint256 _chainId,
        address _prevMsgSender,
        address _l1Token,
        uint256 _amount
    ) external payable;
142: function bridgehubConfirmL2Transaction(uint256 _chainId, bytes32 _txDataHash, bytes32 _txHash) external;
144: function receiveEth(uint256 _chainId) external payable;
```
[58](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L58) | [64](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L64) | [74](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L74) | [85](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L85) | [97](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L97) | [105](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L105) | [114](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L114) | [116](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L116) | [118](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L118) | [120](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L120) | [122](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L122) | [128](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L128) | [135](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L135) | [142](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L142) | [144](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L144)

```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL2Bridge.sol

7: function finalizeDeposit(
        address _l1Sender,
        address _l2Receiver,
        address _l1Token,
        uint256 _amount,
        bytes calldata _data
    ) external payable;
15: function withdraw(address _l1Receiver, address _l2Token, uint256 _amount) external;
17: function l1TokenAddress(address _l2Token) external view returns (address);
19: function l2TokenAddress(address _l1Token) external view returns (address);
21: function l1Bridge() external view returns (address);
```
[7](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL2Bridge.sol#L7) | [15](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL2Bridge.sol#L15) | [17](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL2Bridge.sol#L17) | [19](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL2Bridge.sol#L19) | [21](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL2Bridge.sol#L21)

```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IWETH9.sol

5: function deposit() external payable;
7: function withdraw(uint256 wad) external;
```
[5](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IWETH9.sol#L5) | [7](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IWETH9.sol#L7)

```solidity
File: code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol

59: function stateTransitionManagerIsRegistered(address _stateTransitionManager) external view returns (bool);
61: function stateTransitionManager(uint256 _chainId) external view returns (address);
63: function tokenIsRegistered(address _baseToken) external view returns (bool);
65: function baseToken(uint256 _chainId) external view returns (address);
67: function sharedBridge() external view returns (IL1SharedBridge);
69: function getStateTransition(uint256 _chainId) external view returns (address);
73: function proveL2MessageInclusion(
        uint256 _chainId,
        uint256 _batchNumber,
        uint256 _index,
        L2Message calldata _message,
        bytes32[] calldata _proof
    ) external view returns (bool);
81: function proveL2LogInclusion(
        uint256 _chainId,
        uint256 _batchNumber,
        uint256 _index,
        L2Log memory _log,
        bytes32[] calldata _proof
    ) external view returns (bool);
89: function proveL1ToL2TransactionStatus(
        uint256 _chainId,
        bytes32 _l2TxHash,
        uint256 _l2BatchNumber,
        uint256 _l2MessageIndex,
        uint16 _l2TxNumberInBatch,
        bytes32[] calldata _merkleProof,
        TxStatus _status
    ) external view returns (bool);
99: function requestL2TransactionDirect(
        L2TransactionRequestDirect calldata _request
    ) external payable returns (bytes32 canonicalTxHash);
103: function requestL2TransactionTwoBridges(
        L2TransactionRequestTwoBridgesOuter calldata _request
    ) external payable returns (bytes32 canonicalTxHash);
107: function l2TransactionBaseCost(
        uint256 _chainId,
        uint256 _gasPrice,
        uint256 _l2GasLimit,
        uint256 _l2GasPerPubdataByteLimit
    ) external view returns (uint256);
116: function createNewChain(
        uint256 _chainId,
        address _stateTransitionManager,
        address _baseToken,
        uint256 _salt,
        address _admin,
        bytes calldata _initData
    ) external returns (uint256 chainId);
125: function addStateTransitionManager(address _stateTransitionManager) external;
127: function removeStateTransitionManager(address _stateTransitionManager) external;
129: function addToken(address _token) external;
131: function setSharedBridge(address _sharedBridge) external;
```
[59](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L59) | [61](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L61) | [63](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L63) | [65](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L65) | [67](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L67) | [69](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L69) | [73](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L73) | [81](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L81) | [89](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L89) | [99](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L99) | [103](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L103) | [107](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L107) | [116](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L116) | [125](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L125) | [127](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L127) | [129](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L129) | [131](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L131)

```solidity
File: code/contracts/ethereum/contracts/governance/IGovernance.sol

41: function isOperation(bytes32 _id) external view returns (bool);
43: function isOperationPending(bytes32 _id) external view returns (bool);
45: function isOperationReady(bytes32 _id) external view returns (bool);
47: function isOperationDone(bytes32 _id) external view returns (bool);
49: function getOperationState(bytes32 _id) external view returns (OperationState);
51: function scheduleTransparent(Operation calldata _operation, uint256 _delay) external;
53: function scheduleShadow(bytes32 _id, uint256 _delay) external;
55: function cancel(bytes32 _id) external;
57: function execute(Operation calldata _operation) external payable;
59: function executeInstant(Operation calldata _operation) external payable;
61: function hashOperation(Operation calldata _operation) external pure returns (bytes32);
63: function updateDelay(uint256 _newDelay) external;
65: function updateSecurityCouncil(address _newSecurityCouncil) external;
```
[41](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/IGovernance.sol#L41) | [43](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/IGovernance.sol#L43) | [45](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/IGovernance.sol#L45) | [47](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/IGovernance.sol#L47) | [49](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/IGovernance.sol#L49) | [51](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/IGovernance.sol#L51) | [53](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/IGovernance.sol#L53) | [55](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/IGovernance.sol#L55) | [57](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/IGovernance.sol#L57) | [59](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/IGovernance.sol#L59) | [61](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/IGovernance.sol#L61) | [63](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/IGovernance.sol#L63) | [65](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/IGovernance.sol#L65)

```solidity
File: code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol

43: function bridgehub() external view returns (address);
53: function stateTransition(uint256 _chainId) external view returns (address);
55: function storedBatchZero() external view returns (bytes32);
57: function initialCutHash() external view returns (bytes32);
59: function genesisUpgrade() external view returns (address);
61: function upgradeCutHash(uint256 _protocolVersion) external view returns (bytes32);
63: function protocolVersion() external view returns (uint256);
65: function initialize(StateTransitionManagerInitializeData calldata _initalizeData) external;
67: function setInitialCutHash(Diamond.DiamondCutData calldata _diamondCut) external;
69: function setValidatorTimelock(address _validatorTimelock) external;
71: function getChainAdmin(uint256 _chainId) external view returns (address);
82: function registerAlreadyDeployedStateTransition(uint256 _chainId, address _stateTransitionContract) external;
84: function setNewVersionUpgrade(
        Diamond.DiamondCutData calldata _cutData,
        uint256 _oldProtocolVersion,
        uint256 _newProtocolVersion
    ) external;
90: function setUpgradeDiamondCut(Diamond.DiamondCutData calldata _cutData, uint256 _oldProtocolVersion) external;
92: function freezeChain(uint256 _chainId) external;
94: function unfreezeChain(uint256 _chainId) external;
```
[43](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L43) | [53](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L53) | [55](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L55) | [57](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L57) | [59](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L59) | [61](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L61) | [63](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L63) | [65](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L65) | [67](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L67) | [69](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L69) | [71](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L71) | [82](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L82) | [84](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L84) | [90](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L90) | [92](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L92) | [94](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L94)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol

45: function upgradeChainFromVersion(uint256 _protocolVersion, Diamond.DiamondCutData calldata _cutData) external;
```
[45](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L45)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol

62: function initialize(InitializeData calldata _initData) external returns (bytes32);
```
[62](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol#L62)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol

19: function getVerifier() external view returns (address);
22: function getAdmin() external view returns (address);
25: function getPendingAdmin() external view returns (address);
28: function getBridgehub() external view returns (address);
31: function getStateTransitionManager() external view returns (address);
34: function getBaseToken() external view returns (address);
37: function getBaseTokenBridge() external view returns (address);
40: function getTotalBatchesCommitted() external view returns (uint256);
43: function getTotalBatchesVerified() external view returns (uint256);
46: function getTotalBatchesExecuted() external view returns (uint256);
49: function getTotalPriorityTxs() external view returns (uint256);
59: function getPriorityQueueSize() external view returns (uint256);
62: function priorityQueueFrontOperation() external view returns (PriorityOperation memory);
65: function isValidator(address _address) external view returns (bool);
68: function l2LogsRootHash(uint256 _batchNumber) external view returns (bytes32 merkleRoot);
76: function getL2BootloaderBytecodeHash() external view returns (bytes32);
79: function getL2DefaultAccountBytecodeHash() external view returns (bytes32);
82: function getVerifierParams() external view returns (VerifierParams memory);
85: function isDiamondStorageFrozen() external view returns (bool);
88: function getProtocolVersion() external view returns (uint256);
91: function getL2SystemContractsUpgradeTxHash() external view returns (bytes32);
101: function getPriorityTxMaxGasLimit() external view returns (uint256);
106: function isEthWithdrawalFinalized(uint256 _l2BatchNumber, uint256 _l2MessageIndex) external view returns (bool);
109: function getPubdataPricingMode() external view returns (PubdataPricingMode);
112: function baseTokenGasPriceMultiplierNominator() external view returns (uint128);
115: function baseTokenGasPriceMultiplierDenominator() external view returns (uint128);
130: function facets() external view returns (Facet[] memory);
133: function facetFunctionSelectors(address _facet) external view returns (bytes4[] memory);
136: function facetAddresses() external view returns (address[] memory facets);
139: function facetAddress(bytes4 _selector) external view returns (address facet);
142: function isFunctionFreezable(bytes4 _selector) external view returns (bool);
145: function isFacetFreezable(address _facet) external view returns (bool isFreezable);
```
[19](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L19) | [22](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L22) | [25](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L25) | [28](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L28) | [31](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L31) | [34](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L34) | [37](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L37) | [40](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L40) | [43](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L43) | [46](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L46) | [49](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L49) | [59](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L59) | [62](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L62) | [65](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L65) | [68](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L68) | [76](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L76) | [79](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L79) | [82](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L82) | [85](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L85) | [88](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L88) | [91](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L91) | [101](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L101) | [106](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L106) | [109](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L109) | [112](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L112) | [115](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L115) | [130](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L130) | [133](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L133) | [136](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L136) | [139](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L139) | [142](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L142) | [145](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L145)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol

98: function bridgehubRequestL2Transaction(
        BridgehubL2TransactionRequest calldata _request
    ) external payable returns (bytes32 canonicalTxHash);
```
[98](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L98)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransitionBase.sol

9: function getName() external view returns (string memory);
```
[9](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransitionBase.sol#L9)

```solidity
File: code/contracts/ethereum/contracts/state-transition/l2-deps/ISystemContext.sol

5: function setChainId(uint256 _newChainId) external;
```
[5](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/l2-deps/ISystemContext.sol#L5)

```solidity
File: code/contracts/ethereum/contracts/upgrades/IDefaultUpgrade.sol

8: function upgrade(ProposedUpgrade calldata _upgrade) external returns (bytes32);
```
[8](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/IDefaultUpgrade.sol#L8)

```solidity
File: code/system-contracts/contracts/Compressor.sol

110: function verifyCompressedStateDiffs(
        uint256 _numberOfStateDiffs,
        uint256 _enumerationIndexSize,
        bytes calldata _stateDiffs,
        bytes calldata _compressedStateDiffs
    ) external payable onlyCallFrom(address(L1_MESSENGER_CONTRACT)) returns (bytes32 stateDiffHash) {
```
[110](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L110)

```solidity
File: code/system-contracts/contracts/SystemContext.sol

117: function getCurrentPubdataSpent() public view returns (uint256) {
122: function getCurrentPubdataCost() external view returns (uint256) {
482: function incrementTxNumberInBatch() external onlyCallFromBootloader {
486: function resetTxNumberInBatch() external onlyCallFromBootloader {
```
[117](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L117) | [122](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L122) | [482](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L482) | [486](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L486)

```solidity
File: code/system-contracts/contracts/interfaces/IAccount.sol

26: function executeTransaction(
        bytes32 _txHash,
        bytes32 _suggestedSignedHash,
        Transaction calldata _transaction
    ) external payable;
34: function executeTransactionFromOutside(Transaction calldata _transaction) external payable;
36: function payForTransaction(
        bytes32 _txHash,
        bytes32 _suggestedSignedHash,
        Transaction calldata _transaction
    ) external payable;
42: function prepareForPaymaster(
        bytes32 _txHash,
        bytes32 _possibleSignedHash,
        Transaction calldata _transaction
    ) external payable;
```
[26](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IAccount.sol#L26) | [34](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IAccount.sol#L34) | [36](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IAccount.sol#L36) | [42](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IAccount.sol#L42)

```solidity
File: code/system-contracts/contracts/interfaces/IAccountCodeStorage.sol

6: function storeAccountConstructingCodeHash(address _address, bytes32 _hash) external;
8: function storeAccountConstructedCodeHash(address _address, bytes32 _hash) external;
10: function markAccountCodeHashAsConstructed(address _address) external;
12: function getRawCodeHash(address _address) external view returns (bytes32 codeHash);
14: function getCodeHash(uint256 _input) external view returns (bytes32 codeHash);
16: function getCodeSize(uint256 _input) external view returns (uint256 codeSize);
```
[6](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IAccountCodeStorage.sol#L6) | [8](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IAccountCodeStorage.sol#L8) | [10](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IAccountCodeStorage.sol#L10) | [12](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IAccountCodeStorage.sol#L12) | [14](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IAccountCodeStorage.sol#L14) | [16](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IAccountCodeStorage.sol#L16)

```solidity
File: code/system-contracts/contracts/interfaces/IBaseToken.sol

6: function balanceOf(uint256) external view returns (uint256);
8: function transferFromTo(address _from, address _to, uint256 _amount) external;
10: function totalSupply() external view returns (uint256);
12: function name() external pure returns (string memory);
14: function symbol() external pure returns (string memory);
16: function decimals() external pure returns (uint8);
18: function mint(address _account, uint256 _amount) external;
20: function withdraw(address _l1Receiver) external payable;
22: function withdrawWithMessage(address _l1Receiver, bytes calldata _additionalData) external payable;
```
[6](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IBaseToken.sol#L6) | [8](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IBaseToken.sol#L8) | [10](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IBaseToken.sol#L10) | [12](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IBaseToken.sol#L12) | [14](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IBaseToken.sol#L14) | [16](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IBaseToken.sol#L16) | [18](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IBaseToken.sol#L18) | [20](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IBaseToken.sol#L20) | [22](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IBaseToken.sol#L22)

```solidity
File: code/system-contracts/contracts/interfaces/IBootloaderUtilities.sol

8: function getTransactionHashes(
        Transaction calldata _transaction
    ) external view returns (bytes32 txHash, bytes32 signedTxHash);
```
[8](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IBootloaderUtilities.sol#L8)

```solidity
File: code/system-contracts/contracts/interfaces/IComplexUpgrader.sol

11: function upgrade(address _delegateTo, bytes calldata _calldata) external payable;
```
[11](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IComplexUpgrader.sol#L11)

```solidity
File: code/system-contracts/contracts/interfaces/ICompressor.sol

19: function publishCompressedBytecode(
        bytes calldata _bytecode,
        bytes calldata _rawCompressedData
    ) external payable returns (bytes32 bytecodeHash);
24: function verifyCompressedStateDiffs(
        uint256 _numberOfStateDiffs,
        uint256 _enumerationIndexSize,
        bytes calldata _stateDiffs,
        bytes calldata _compressedStateDiffs
    ) external payable returns (bytes32 stateDiffHash);
```
[19](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/ICompressor.sol#L19) | [24](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/ICompressor.sol#L24)

```solidity
File: code/system-contracts/contracts/interfaces/IContractDeployer.sol

43: function getNewAddressCreate2(
        address _sender,
        bytes32 _bytecodeHash,
        bytes32 _salt,
        bytes calldata _input
    ) external view returns (address newAddress);
50: function getNewAddressCreate(address _sender, uint256 _senderNonce) external pure returns (address newAddress);
52: function create2(
        bytes32 _salt,
        bytes32 _bytecodeHash,
        bytes calldata _input
    ) external payable returns (address newAddress);
58: function create2Account(
        bytes32 _salt,
        bytes32 _bytecodeHash,
        bytes calldata _input,
        AccountAbstractionVersion _aaVersion
    ) external payable returns (address newAddress);
```
[43](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L43) | [50](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L50) | [52](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L52) | [58](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L58)

```solidity
File: code/system-contracts/contracts/interfaces/IImmutableSimulator.sol

11: function getImmutable(address _dest, uint256 _index) external view returns (bytes32);
13: function setImmutables(address _dest, ImmutableData[] calldata _immutables) external;
```
[11](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IImmutableSimulator.sol#L11) | [13](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IImmutableSimulator.sol#L13)

```solidity
File: code/system-contracts/contracts/interfaces/IKnownCodesStorage.sol

14: function markFactoryDeps(bool _shouldSendToL1, bytes32[] calldata _hashes) external;
16: function markBytecodeAsPublished(bytes32 _bytecodeHash) external;
18: function getMarker(bytes32 _hash) external view returns (uint256);
```
[14](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IKnownCodesStorage.sol#L14) | [16](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IKnownCodesStorage.sol#L16) | [18](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IKnownCodesStorage.sol#L18)

```solidity
File: code/system-contracts/contracts/interfaces/IL1Messenger.sol

49: function sendToL1(bytes memory _message) external returns (bytes32);
51: function sendL2ToL1Log(bool _isService, bytes32 _key, bytes32 _value) external returns (uint256 logIdInMerkleTree);
54: function requestBytecodeL1Publication(bytes32 _bytecodeHash) external;
```
[49](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IL1Messenger.sol#L49) | [51](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IL1Messenger.sol#L51) | [54](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IL1Messenger.sol#L54)

```solidity
File: code/system-contracts/contracts/interfaces/IL2StandardToken.sol

10: function bridgeMint(address _account, uint256 _amount) external;
12: function bridgeBurn(address _account, uint256 _amount) external;
14: function l1Address() external view returns (address);
16: function l2Bridge() external view returns (address);
```
[10](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IL2StandardToken.sol#L10) | [12](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IL2StandardToken.sol#L12) | [14](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IL2StandardToken.sol#L14) | [16](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IL2StandardToken.sol#L16)

```solidity
File: code/system-contracts/contracts/interfaces/IMailbox.sol

6: function finalizeEthWithdrawal(
        uint256 _l2BatchNumber,
        uint256 _l2MessageIndex,
        uint16 _l2TxNumberInBlock,
        bytes calldata _message,
        bytes32[] calldata _merkleProof
    ) external;
```
[6](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IMailbox.sol#L6)

```solidity
File: code/system-contracts/contracts/interfaces/IPaymasterFlow.sol

13: function general(bytes calldata input) external;
15: function approvalBased(address _token, uint256 _minAllowance, bytes calldata _innerInput) external;
```
[13](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IPaymasterFlow.sol#L13) | [15](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IPaymasterFlow.sol#L15)

```solidity
File: code/system-contracts/contracts/interfaces/ISystemContext.sol

30: function chainId() external view returns (uint256);
32: function origin() external view returns (address);
34: function gasPrice() external view returns (uint256);
36: function blockGasLimit() external view returns (uint256);
38: function coinbase() external view returns (address);
40: function difficulty() external view returns (uint256);
42: function baseFee() external view returns (uint256);
44: function txNumberInBlock() external view returns (uint16);
46: function getBlockHashEVM(uint256 _block) external view returns (bytes32);
48: function getBatchHash(uint256 _batchNumber) external view returns (bytes32 hash);
50: function getBlockNumber() external view returns (uint128);
52: function getBlockTimestamp() external view returns (uint128);
54: function getBatchNumberAndTimestamp() external view returns (uint128 blockNumber, uint128 blockTimestamp);
56: function getL2BlockNumberAndTimestamp() external view returns (uint128 blockNumber, uint128 blockTimestamp);
58: function gasPerPubdataByte() external view returns (uint256 gasPerPubdataByte);
60: function getCurrentPubdataSpent() external view returns (uint256 currentPubdataSpent);
```
[30](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/ISystemContext.sol#L30) | [32](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/ISystemContext.sol#L32) | [34](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/ISystemContext.sol#L34) | [36](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/ISystemContext.sol#L36) | [38](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/ISystemContext.sol#L38) | [40](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/ISystemContext.sol#L40) | [42](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/ISystemContext.sol#L42) | [44](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/ISystemContext.sol#L44) | [46](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/ISystemContext.sol#L46) | [48](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/ISystemContext.sol#L48) | [50](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/ISystemContext.sol#L50) | [52](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/ISystemContext.sol#L52) | [54](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/ISystemContext.sol#L54) | [56](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/ISystemContext.sol#L56) | [58](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/ISystemContext.sol#L58) | [60](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/ISystemContext.sol#L60)

```solidity
File: code/system-contracts/contracts/interfaces/ISystemContextDeprecated.sol

11: function currentBlockInfo() external view returns (uint256);
13: function getBlockNumberAndTimestamp() external view returns (uint256 blockNumber, uint256 blockTimestamp);
15: function blockHash(uint256 _blockNumber) external view returns (bytes32 hash);
```
[11](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/ISystemContextDeprecated.sol#L11) | [13](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/ISystemContextDeprecated.sol#L13) | [15](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/ISystemContextDeprecated.sol#L15)

```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

149: function l2TokenAddress(address _l1Token) public view override returns (address) {
```
[149](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L149)

```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

159: function name() public view override returns (string memory) {
165: function symbol() public view override returns (string memory) {
171: function decimals() public view override returns (uint8) {
```
[159](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L159) | [165](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L165) | [171](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L171)

```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL1ERC20Bridge.sol

9: function finalizeWithdrawal(
        uint256 _l2BatchNumber,
        uint256 _l2MessageIndex,
        uint16 _l2TxNumberInBatch,
        bytes calldata _message,
        bytes32[] calldata _merkleProof
    ) external;
```
[9](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L9)

```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL1SharedBridge.sol

9: function finalizeWithdrawal(
        uint256 _chainId,
        uint256 _l2BatchNumber,
        uint256 _l2MessageIndex,
        uint16 _l2TxNumberInBatch,
        bytes calldata _message,
        bytes32[] calldata _merkleProof
    ) external;
```
[9](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/interfaces/IL1SharedBridge.sol#L9)

```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol

24: function finalizeDeposit(
        address _l1Sender,
        address _l2Receiver,
        address _l1Token,
        uint256 _amount,
        bytes calldata _data
    ) external payable;
32: function withdraw(address _l1Receiver, address _l2Token, uint256 _amount) external;
34: function l1TokenAddress(address _l2Token) external view returns (address);
36: function l2TokenAddress(address _l1Token) external view returns (address);
38: function l1Bridge() external view returns (address);
```
[24](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol#L24) | [32](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol#L32) | [34](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol#L34) | [36](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol#L36) | [38](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol#L38)

```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol

12: function bridgeMint(address _account, uint256 _amount) external;
14: function bridgeBurn(address _account, uint256 _amount) external;
16: function l1Address() external view returns (address);
18: function l2Bridge() external view returns (address);
```
[12](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol#L12) | [14](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol#L14) | [16](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol#L16) | [18](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol#L18)

```solidity
File: code/contracts/zksync/contracts/interfaces/IPaymasterFlow.sol

14: function general(bytes calldata input) external;
16: function approvalBased(address _token, uint256 _minAllowance, bytes calldata _innerInput) external;
```
[14](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/interfaces/IPaymasterFlow.sol#L14) | [16](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/interfaces/IPaymasterFlow.sol#L16)
</details>

### [N-42] Contract uses both `require()`/`revert()` as well as custom errors

The contract uses both `require()/revert()` and `custom errors` for error handling.

It's recommended to use a consistent approach for error handling in a single file.

<details>
<summary><i>1 issue instances in 1 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

22: contract ValidatorTimelock is IExecutor, Ownable2Step {
```
[22](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L22)
</details>

### [N-43] Modifiers Missing NatSpec `@param` Tag

Function modifiers should include NatSpec comments with `@param` tags describing each input parameter.
This promotes better code readability and documentation.

<details>
<summary><i>5 issue instances in 4 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

/// @audit Missed @param `_chainId`
74: modifier onlyBridgehubOrEra(uint256 _chainId) {
```
[74](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L74)

```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

/// @audit Missed @param `_chainId`
61: modifier onlyChainAdmin(uint256 _chainId) {
/// @audit Missed @param `_chainId`
67: modifier onlyValidator(uint256 _chainId) {
```
[61](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L61) | [67](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L67)

```solidity
File: code/system-contracts/contracts/interfaces/ISystemContract.sol

/// @audit Missed @param `caller`
40: modifier onlyCallFrom(address caller) {
```
[40](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/ISystemContract.sol#L40)

```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

/// @audit Missed @param `_version`
134: modifier onlyNextVersion(uint8 _version) {
```
[134](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L134)
</details>

### [N-44] Inconsistent spacing in comments

Some lines use // x and some use //x. The instances below point out the usages that don't follow the majority, within each file:

<details>
<summary><i>2590 issue instances in 84 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

14: /// @author Matter Labs
15: /// @custom:security-contact security@matterlabs.dev
16: /// @notice Smart contract that allows depositing ERC20 tokens from Ethereum to hyperchains
17: /// @dev It is a legacy bridge from zkSync Era, that was deprecated in favour of shared bridge.
18: /// It is needed for backward compatibility with already integrated projects.
22: /// @dev The shared bridge that is now used for all bridging, replacing the legacy contract.
25: /// @dev A mapping L2 batch number => message number => flag.
26: /// @dev Used to indicate that L2 -> L1 message was already processed for zkSync Era withdrawals.
30: /// @dev A mapping account => L1 token address => L2 deposit transaction hash => amount.
31: /// @dev Used for saving the number of deposited funds, to claim them in case the deposit transaction will fail in zkSync Era.
35: /// @dev The address that is used as a L2 bridge counterpart in zkSync Era.
38: /// @dev The address that is used as a beacon for L2 tokens in zkSync Era.
41: /// @dev Stores the hash of the L2 token proxy contract's bytecode on zkSync Era.
44: /// @dev Deprecated storage variable related to withdrawal limitations.
47: /// @dev Deprecated storage variable related to withdrawal limitations.
50: /// @dev Deprecated storage variable related to deposit limitations.
53: /// @dev Contract is expected to be used as proxy implementation.
54: /// @dev Initialize the implementation to prevent Parity hack.
59: /// @dev Initializes the reentrancy guard. Expected to be used in the proxy.
62: /// @dev transfer token to shared bridge as part of upgrade
70: /*//////////////////////////////////////////////////////////////
72: //////////////////////////////////////////////////////////////*/
74: /// @return The L2 token address that would be minted for deposit of the given L1 token on zkSync Era.
82: /*//////////////////////////////////////////////////////////////
84: //////////////////////////////////////////////////////////////*/
86: /// @notice Legacy deposit method with refunding the fee to the caller, use another `deposit` method instead.
87: /// @dev Initiates a deposit by locking funds on the contract and sending the request
88: /// of processing an L2 transaction where tokens would be minted.
89: /// @dev If the token is bridged for the first time, the L2 token contract will be deployed. Note however, that the
90: /// newly-deployed token does not support any custom logic, i.e. rebase tokens' functionality is not supported.
91: /// @param _l2Receiver The account address that should receive funds on L2
92: /// @param _l1Token The L1 token address which is deposited
93: /// @param _amount The total amount of tokens to be bridged
94: /// @param _l2TxGasLimit The L2 gas limit to be used in the corresponding L2 transaction
95: /// @param _l2TxGasPerPubdataByte The gasPerPubdataByteLimit to be used in the corresponding L2 transaction
96: /// @return l2TxHash The L2 transaction hash of deposit finalization
97: /// NOTE: the function doesn't use `nonreentrant` modifier, because the inner method does.
108: /// @notice Initiates a deposit by locking funds on the contract and sending the request
109: /// @dev Initiates a deposit by locking funds on the contract and sending the request
110: /// of processing an L2 transaction where tokens would be minted
111: /// @dev If the token is bridged for the first time, the L2 token contract will be deployed. Note however, that the
112: /// newly-deployed token does not support any custom logic, i.e. rebase tokens' functionality is not supported.
113: /// @param _l2Receiver The account address that should receive funds on L2
114: /// @param _l1Token The L1 token address which is deposited
115: /// @param _amount The total amount of tokens to be bridged
116: /// @param _l2TxGasLimit The L2 gas limit to be used in the corresponding L2 transaction
117: /// @param _l2TxGasPerPubdataByte The gasPerPubdataByteLimit to be used in the corresponding L2 transaction
118: /// @param _refundRecipient The address on L2 that will receive the refund for the transaction.
119: /// @dev If the L2 deposit finalization transaction fails, the `_refundRecipient` will receive the `_l2Value`.
120: /// Please note, the contract may change the refund recipient's address to eliminate sending funds to addresses
121: /// out of control.
122: /// - If `_refundRecipient` is a contract on L1, the refund will be sent to the aliased `_refundRecipient`.
123: /// - If `_refundRecipient` is set to `address(0)` and the sender has NO deployed bytecode on L1, the refund will
124: /// be sent to the `msg.sender` address.
125: /// - If `_refundRecipient` is set to `address(0)` and the sender has deployed bytecode on L1, the refund will be
126: /// sent to the aliased `msg.sender` address.
127: /// @dev The address aliasing of L1 contracts as refund recipient on L2 is necessary to guarantee that the funds
128: /// are controllable through the Mailbox, since the Mailbox applies address aliasing to the from address for the
129: /// L2 tx if the L1 msg.sender is a contract. Without address aliasing for L1 contracts as refund recipients they
130: /// would not be able to make proper L2 tx requests through the Mailbox to use or withdraw the funds from L2, and
131: /// the funds would be lost.
132: /// @return l2TxHash The L2 transaction hash of deposit finalization
158: /// @dev Transfers tokens from the depositor address to the shared bridge address.
159: /// @return The difference between the contract balance before and after the transferring of funds.
168: /// @dev Withdraw funds from the initiated deposit, that failed when finalizing on L2.
169: /// @param _depositSender The address of the deposit initiator
170: /// @param _l1Token The address of the deposited L1 ERC20 token
171: /// @param _l2TxHash The L2 transaction hash of the failed deposit finalization
172: /// @param _l2BatchNumber The L2 batch number where the deposit finalization was processed
173: /// @param _l2MessageIndex The position in the L2 logs Merkle tree of the l2Log that was sent with the message
174: /// @param _l2TxNumberInBatch The L2 transaction number in a batch, in which the log was sent
175: /// @param _merkleProof The Merkle proof of the processing L1 -> L2 transaction with deposit finalization
202: /// @notice Finalize the withdrawal and release funds
203: /// @param _l2BatchNumber The L2 batch number where the withdrawal was processed
204: /// @param _l2MessageIndex The position in the L2 logs Merkle tree of the l2Log that was sent with the message
205: /// @param _l2TxNumberInBatch The L2 transaction number in the batch, in which the log was sent
206: /// @param _message The L2 withdraw data, stored in an L2 -> L1 message
207: /// @param _merkleProof The Merkle proof of the inclusion L2 -> L1 message about withdrawal initialization
14: /// @author Matter Labs
15: /// @custom:security-contact security@matterlabs.dev
16: /// @notice Smart contract that allows depositing ERC20 tokens from Ethereum to hyperchains
17: /// @dev It is a legacy bridge from zkSync Era, that was deprecated in favour of shared bridge.
18: /// It is needed for backward compatibility with already integrated projects.
22: /// @dev The shared bridge that is now used for all bridging, replacing the legacy contract.
25: /// @dev A mapping L2 batch number => message number => flag.
26: /// @dev Used to indicate that L2 -> L1 message was already processed for zkSync Era withdrawals.
30: /// @dev A mapping account => L1 token address => L2 deposit transaction hash => amount.
31: /// @dev Used for saving the number of deposited funds, to claim them in case the deposit transaction will fail in zkSync Era.
35: /// @dev The address that is used as a L2 bridge counterpart in zkSync Era.
38: /// @dev The address that is used as a beacon for L2 tokens in zkSync Era.
41: /// @dev Stores the hash of the L2 token proxy contract's bytecode on zkSync Era.
44: /// @dev Deprecated storage variable related to withdrawal limitations.
47: /// @dev Deprecated storage variable related to withdrawal limitations.
50: /// @dev Deprecated storage variable related to deposit limitations.
53: /// @dev Contract is expected to be used as proxy implementation.
54: /// @dev Initialize the implementation to prevent Parity hack.
59: /// @dev Initializes the reentrancy guard. Expected to be used in the proxy.
62: /// @dev transfer token to shared bridge as part of upgrade
70: /*//////////////////////////////////////////////////////////////
72: //////////////////////////////////////////////////////////////*/
74: /// @return The L2 token address that would be minted for deposit of the given L1 token on zkSync Era.
82: /*//////////////////////////////////////////////////////////////
84: //////////////////////////////////////////////////////////////*/
86: /// @notice Legacy deposit method with refunding the fee to the caller, use another `deposit` method instead.
87: /// @dev Initiates a deposit by locking funds on the contract and sending the request
88: /// of processing an L2 transaction where tokens would be minted.
89: /// @dev If the token is bridged for the first time, the L2 token contract will be deployed. Note however, that the
90: /// newly-deployed token does not support any custom logic, i.e. rebase tokens' functionality is not supported.
91: /// @param _l2Receiver The account address that should receive funds on L2
92: /// @param _l1Token The L1 token address which is deposited
93: /// @param _amount The total amount of tokens to be bridged
94: /// @param _l2TxGasLimit The L2 gas limit to be used in the corresponding L2 transaction
95: /// @param _l2TxGasPerPubdataByte The gasPerPubdataByteLimit to be used in the corresponding L2 transaction
96: /// @return l2TxHash The L2 transaction hash of deposit finalization
97: /// NOTE: the function doesn't use `nonreentrant` modifier, because the inner method does.
108: /// @notice Initiates a deposit by locking funds on the contract and sending the request
109: /// @dev Initiates a deposit by locking funds on the contract and sending the request
110: /// of processing an L2 transaction where tokens would be minted
111: /// @dev If the token is bridged for the first time, the L2 token contract will be deployed. Note however, that the
112: /// newly-deployed token does not support any custom logic, i.e. rebase tokens' functionality is not supported.
113: /// @param _l2Receiver The account address that should receive funds on L2
114: /// @param _l1Token The L1 token address which is deposited
115: /// @param _amount The total amount of tokens to be bridged
116: /// @param _l2TxGasLimit The L2 gas limit to be used in the corresponding L2 transaction
117: /// @param _l2TxGasPerPubdataByte The gasPerPubdataByteLimit to be used in the corresponding L2 transaction
118: /// @param _refundRecipient The address on L2 that will receive the refund for the transaction.
119: /// @dev If the L2 deposit finalization transaction fails, the `_refundRecipient` will receive the `_l2Value`.
120: /// Please note, the contract may change the refund recipient's address to eliminate sending funds to addresses
121: /// out of control.
122: /// - If `_refundRecipient` is a contract on L1, the refund will be sent to the aliased `_refundRecipient`.
123: /// - If `_refundRecipient` is set to `address(0)` and the sender has NO deployed bytecode on L1, the refund will
124: /// be sent to the `msg.sender` address.
125: /// - If `_refundRecipient` is set to `address(0)` and the sender has deployed bytecode on L1, the refund will be
126: /// sent to the aliased `msg.sender` address.
127: /// @dev The address aliasing of L1 contracts as refund recipient on L2 is necessary to guarantee that the funds
128: /// are controllable through the Mailbox, since the Mailbox applies address aliasing to the from address for the
129: /// L2 tx if the L1 msg.sender is a contract. Without address aliasing for L1 contracts as refund recipients they
130: /// would not be able to make proper L2 tx requests through the Mailbox to use or withdraw the funds from L2, and
131: /// the funds would be lost.
132: /// @return l2TxHash The L2 transaction hash of deposit finalization
158: /// @dev Transfers tokens from the depositor address to the shared bridge address.
159: /// @return The difference between the contract balance before and after the transferring of funds.
168: /// @dev Withdraw funds from the initiated deposit, that failed when finalizing on L2.
169: /// @param _depositSender The address of the deposit initiator
170: /// @param _l1Token The address of the deposited L1 ERC20 token
171: /// @param _l2TxHash The L2 transaction hash of the failed deposit finalization
172: /// @param _l2BatchNumber The L2 batch number where the deposit finalization was processed
173: /// @param _l2MessageIndex The position in the L2 logs Merkle tree of the l2Log that was sent with the message
174: /// @param _l2TxNumberInBatch The L2 transaction number in a batch, in which the log was sent
175: /// @param _merkleProof The Merkle proof of the processing L1 -> L2 transaction with deposit finalization
202: /// @notice Finalize the withdrawal and release funds
203: /// @param _l2BatchNumber The L2 batch number where the withdrawal was processed
204: /// @param _l2MessageIndex The position in the L2 logs Merkle tree of the l2Log that was sent with the message
205: /// @param _l2TxNumberInBatch The L2 transaction number in the batch, in which the log was sent
206: /// @param _message The L2 withdraw data, stored in an L2 -> L1 message
207: /// @param _merkleProof The Merkle proof of the inclusion L2 -> L1 message about withdrawal initialization
```
[14](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L14) | [15](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L15) | [16](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L16) | [17](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L17) | [18](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L18) | [22](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L22) | [25](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L25) | [26](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L26) | [30](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L30) | [31](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L31) | [35](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L35) | [38](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L38) | [41](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L41) | [44](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L44) | [47](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L47) | [50](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L50) | [53](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L53) | [54](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L54) | [59](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L59) | [62](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L62) | [70](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L70) | [72](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L72) | [74](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L74) | [82](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L82) | [84](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L84) | [86](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L86) | [87](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L87) | [88](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L88) | [89](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L89) | [90](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L90) | [91](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L91) | [92](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L92) | [93](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L93) | [94](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L94) | [95](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L95) | [96](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L96) | [97](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L97) | [108](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L108) | [109](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L109) | [110](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L110) | [111](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L111) | [112](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L112) | [113](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L113) | [114](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L114) | [115](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L115) | [116](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L116) | [117](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L117) | [118](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L118) | [119](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L119) | [120](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L120) | [121](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L121) | [122](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L122) | [123](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L123) | [124](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L124) | [125](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L125) | [126](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L126) | [127](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L127) | [128](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L128) | [129](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L129) | [130](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L130) | [131](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L131) | [132](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L132) | [158](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L158) | [159](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L159) | [168](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L168) | [169](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L169) | [170](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L170) | [171](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L171) | [172](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L172) | [173](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L173) | [174](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L174) | [175](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L175) | [202](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L202) | [203](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L203) | [204](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L204) | [205](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L205) | [206](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L206) | [207](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L207) | [14](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L14) | [15](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L15) | [16](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L16) | [17](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L17) | [18](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L18) | [22](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L22) | [25](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L25) | [26](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L26) | [30](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L30) | [31](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L31) | [35](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L35) | [38](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L38) | [41](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L41) | [44](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L44) | [47](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L47) | [50](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L50) | [53](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L53) | [54](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L54) | [59](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L59) | [62](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L62) | [70](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L70) | [72](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L72) | [74](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L74) | [82](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L82) | [84](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L84) | [86](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L86) | [87](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L87) | [88](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L88) | [89](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L89) | [90](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L90) | [91](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L91) | [92](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L92) | [93](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L93) | [94](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L94) | [95](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L95) | [96](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L96) | [97](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L97) | [108](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L108) | [109](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L109) | [110](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L110) | [111](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L111) | [112](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L112) | [113](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L113) | [114](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L114) | [115](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L115) | [116](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L116) | [117](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L117) | [118](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L118) | [119](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L119) | [120](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L120) | [121](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L121) | [122](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L122) | [123](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L123) | [124](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L124) | [125](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L125) | [126](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L126) | [127](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L127) | [128](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L128) | [129](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L129) | [130](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L130) | [131](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L131) | [132](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L132) | [158](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L158) | [159](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L159) | [168](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L168) | [169](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L169) | [170](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L170) | [171](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L171) | [172](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L172) | [173](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L173) | [174](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L174) | [175](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L175) | [202](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L202) | [203](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L203) | [204](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L204) | [205](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L205) | [206](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L206) | [207](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L207)

```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

26: /// @author Matter Labs
27: /// @custom:security-contact security@matterlabs.dev
28: /// @dev Bridges assets between L1 and hyperchains, supporting both ETH and ERC20 tokens.
29: /// @dev Designed for use with a proxy for upgradability.
33: /// @dev The address of the WETH token on L1.
36: /// @dev Bridgehub smart contract that is used to operate with L2 via asynchronous L2 <-> L1 communication.
39: /// @dev Legacy bridge smart contract that used to hold ERC20 tokens.
42: /// @dev Stores the first batch number on the zkSync Era Diamond Proxy that was settled after Shared Bridge upgrade.
43: /// This variable is used to differentiate between pre-upgrade and post-upgrade withdrawals. Withdrawals from batches older
44: /// than this value are considered to have been finalized prior to the upgrade and handled separately.
47: /// @dev A mapping chainId => bridgeProxy. Used to store the bridge proxy's address, and to see if it has been deployed yet.
50: /// @dev A mapping chainId => L2 deposit transaction hash => keccak256(abi.encode(account, tokenAddress, amount))
51: /// @dev Tracks deposit transactions from L2 to enable users to claim their funds if a deposit fails.
56: /// @dev Tracks the processing status of L2 to L1 messages, indicating whether a message has already been finalized.
60: /// @dev Indicates whether the hyperbridging is enabled for a given chain.
63: /// @dev Maps token balances for each chain to prevent unauthorized spending across hyperchains.
64: /// This serves as a security measure until hyperbridging is implemented.
67: /// @notice Checks that the message sender is the bridgehub.
73: /// @notice Checks that the message sender is the bridgehub or zkSync Era Diamond Proxy.
82: /// @notice Checks that the message sender is the legacy bridge.
88: /// @dev Contract is expected to be used as proxy implementation.
89: /// @dev Initialize the implementation to prevent Parity hack.
101: /// @dev Initializes a contract bridge for later use. Expected to be used in the proxy
102: /// @param _owner Address which can change L2 token implementation and upgrade the bridge
103: /// implementation. The owner is the Governor and separate from the ProxyAdmin from now on, so that the Governor can call the bridge.
115: /// @dev tranfer tokens from legacy erc20 bridge or mailbox and set chainBalance as part of migration process
141: /// @dev Initializes the l2Bridge address by governance for a specific chain.
146: /// @notice Allows bridgehub to acquire mintValue for L1->L2 transactions.
147: /// @dev If the corresponding L2 transaction fails, refunds are issued to a refund recipient on L2.
171: /// @dev Transfers tokens from the depositor address to the smart contract address.
172: /// @return The difference between the contract balance before and after the transferring of funds.
181: /// @notice Initiates a deposit transaction within Bridgehub, used by `requestL2TransactionTwoBridges`.
230: /// @notice Confirms the acceptance of a transaction by the Mailbox, as part of the L2 transaction process within Bridgehub.
231: /// This function is utilized by `requestL2TransactionTwoBridges` to validate the execution of a transaction.
242: /// @dev Generate a calldata for calling the deposit finalization on the L2 bridge contract
253: /// @dev Receives and parses (name, symbol, decimals) from the token contract
268: /// @dev Withdraw funds from the initiated deposit, that failed when finalizing on L2
269: /// @param _depositSender The address of the deposit initiator
270: /// @param _l1Token The address of the deposited L1 ERC20 token
271: /// @param _amount The amount of the deposit that failed.
272: /// @param _l2TxHash The L2 transaction hash of the failed deposit finalization
273: /// @param _l2BatchNumber The L2 batch number where the deposit finalization was processed
274: /// @param _l2MessageIndex The position in the L2 logs Merkle tree of the l2Log that was sent with the message
275: /// @param _l2TxNumberInBatch The L2 transaction number in a batch, in which the log was sent
276: /// @param _merkleProof The Merkle proof of the processing L1 -> L2 transaction with deposit finalization
302: /// @dev Processes claims of failed deposit, whether they originated from the legacy bridge or the current system.
370: /// @dev Determines if a withdrawal was initiated on zkSync Era before the upgrade to the Shared Bridge.
371: /// @param _chainId The chain ID of the transaction to check.
372: /// @param _l2BatchNumber The L2 batch number for the withdrawal.
373: /// @return Whether withdrawal was initiated on zkSync Era before Shared Bridge upgrade.
378: /// @notice Finalize the withdrawal and release funds
379: /// @param _chainId The chain ID of the transaction to check
380: /// @param _l2BatchNumber The L2 batch number where the withdrawal was processed
381: /// @param _l2MessageIndex The position in the L2 logs Merkle tree of the l2Log that was sent with the message
382: /// @param _l2TxNumberInBatch The L2 transaction number in the batch, in which the log was sent
383: /// @param _message The L2 withdraw data, stored in an L2 -> L1 message
384: /// @param _merkleProof The Merkle proof of the inclusion L2 -> L1 message about withdrawal initialization
407: /// @dev Internal function that handles the logic for finalizing withdrawals,
408: /// serving both the current bridge system and the legacy ERC20 bridge.
457: /// @dev Verifies the validity of a withdrawal message from L2 and returns details of the withdrawal.
526: /*//////////////////////////////////////////////////////////////
528: //////////////////////////////////////////////////////////////*/
530: /// @notice Initiates a deposit by locking funds on the contract and sending the request
531: /// of processing an L2 transaction where tokens would be minted.
532: /// @dev If the token is bridged for the first time, the L2 token contract will be deployed. Note however, that the
533: /// newly-deployed token does not support any custom logic, i.e. rebase tokens' functionality is not supported.
534: /// @param _l2Receiver The account address that should receive funds on L2
535: /// @param _l1Token The L1 token address which is deposited
536: /// @param _amount The total amount of tokens to be bridged
537: /// @param _l2TxGasLimit The L2 gas limit to be used in the corresponding L2 transaction
538: /// @param _l2TxGasPerPubdataByte The gasPerPubdataByteLimit to be used in the corresponding L2 transaction
539: /// @param _refundRecipient The address on L2 that will receive the refund for the transaction.
540: /// @dev If the L2 deposit finalization transaction fails, the `_refundRecipient` will receive the `_l2Value`.
541: /// Please note, the contract may change the refund recipient's address to eliminate sending funds to addresses
542: /// out of control.
543: /// - If `_refundRecipient` is a contract on L1, the refund will be sent to the aliased `_refundRecipient`.
544: /// - If `_refundRecipient` is set to `address(0)` and the sender has NO deployed bytecode on L1, the refund will
545: /// be sent to the `msg.sender` address.
546: /// - If `_refundRecipient` is set to `address(0)` and the sender has deployed bytecode on L1, the refund will be
547: /// sent to the aliased `msg.sender` address.
548: /// @dev The address aliasing of L1 contracts as refund recipient on L2 is necessary to guarantee that the funds
549: /// are controllable through the Mailbox, since the Mailbox applies address aliasing to the from address for the
550: /// L2 tx if the L1 msg.sender is a contract. Without address aliasing for L1 contracts as refund recipients they
551: /// would not be able to make proper L2 tx requests through the Mailbox to use or withdraw the funds from L2, and
552: /// the funds would be lost.
553: /// @return l2TxHash The L2 transaction hash of deposit finalization.
605: /// @notice Finalizes the withdrawal for transactions initiated via the legacy ERC20 bridge.
606: /// @param _l2BatchNumber The L2 batch number where the withdrawal was processed
607: /// @param _l2MessageIndex The position in the L2 logs Merkle tree of the l2Log that was sent with the message
608: /// @param _l2TxNumberInBatch The L2 transaction number in the batch, in which the log was sent
609: /// @param _message The L2 withdraw data, stored in an L2 -> L1 message
610: /// @param _merkleProof The Merkle proof of the inclusion L2 -> L1 message about withdrawal initialization
611: ///
612: /// @return l1Receiver The address on L1 that will receive the withdrawn funds
613: /// @return l1Token The address of the L1 token being withdrawn
614: /// @return amount The amount of the token being withdrawns
632: /// @notice Withdraw funds from the initiated deposit, that failed when finalizing on zkSync Era chain.
633: /// This function is specifically designed for maintaining backward-compatibility with legacy `claimFailedDeposit`
634: /// method in `L1ERC20Bridge`.
635: ///
636: /// @param _depositSender The address of the deposit initiator
637: /// @param _l1Token The address of the deposited L1 ERC20 token
638: /// @param _amount The amount of the deposit that failed.
639: /// @param _l2TxHash The L2 transaction hash of the failed deposit finalization
640: /// @param _l2BatchNumber The L2 batch number where the deposit finalization was processed
641: /// @param _l2MessageIndex The position in the L2 logs Merkle tree of the l2Log that was sent with the message
642: /// @param _l2TxNumberInBatch The L2 transaction number in a batch, in which the log was sent
643: /// @param _merkleProof The Merkle proof of the processing L1 -> L2 transaction with deposit finalization
```
[26](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L26) | [27](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L27) | [28](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L28) | [29](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L29) | [33](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L33) | [36](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L36) | [39](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L39) | [42](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L42) | [43](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L43) | [44](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L44) | [47](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L47) | [50](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L50) | [51](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L51) | [56](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L56) | [60](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L60) | [63](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L63) | [64](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L64) | [67](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L67) | [73](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L73) | [82](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L82) | [88](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L88) | [89](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L89) | [101](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L101) | [102](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L102) | [103](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L103) | [115](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L115) | [141](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L141) | [146](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L146) | [147](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L147) | [171](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L171) | [172](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L172) | [181](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L181) | [230](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L230) | [231](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L231) | [242](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L242) | [253](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L253) | [268](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L268) | [269](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L269) | [270](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L270) | [271](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L271) | [272](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L272) | [273](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L273) | [274](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L274) | [275](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L275) | [276](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L276) | [302](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L302) | [370](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L370) | [371](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L371) | [372](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L372) | [373](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L373) | [378](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L378) | [379](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L379) | [380](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L380) | [381](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L381) | [382](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L382) | [383](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L383) | [384](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L384) | [407](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L407) | [408](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L408) | [457](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L457) | [526](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L526) | [528](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L528) | [530](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L530) | [531](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L531) | [532](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L532) | [533](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L533) | [534](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L534) | [535](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L535) | [536](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L536) | [537](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L537) | [538](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L538) | [539](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L539) | [540](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L540) | [541](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L541) | [542](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L542) | [543](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L543) | [544](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L544) | [545](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L545) | [546](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L546) | [547](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L547) | [548](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L548) | [549](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L549) | [550](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L550) | [551](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L551) | [552](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L552) | [553](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L553) | [605](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L605) | [606](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L606) | [607](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L607) | [608](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L608) | [609](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L609) | [610](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L610) | [611](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L611) | [612](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L612) | [613](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L613) | [614](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L614) | [632](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L632) | [633](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L633) | [634](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L634) | [635](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L635) | [636](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L636) | [637](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L637) | [638](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L638) | [639](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L639) | [640](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L640) | [641](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L641) | [642](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L642) | [643](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L643)

```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

17: /// @notice all the ether is held by the weth bridge
20: /// @notice we store registered stateTransitionManagers
22: /// @notice we store registered tokens (for arbitrary base token)
25: /// @notice chainID => StateTransitionManager contract address, storing StateTransitionManager
28: /// @notice chainID => baseToken contract address, storing baseToken
31: /// @dev used to manage non critical updates
34: /// @dev used to accept the admin role
37: /// @notice to avoid parity hack
40: /// @notice used to initialize the contract
50: /// @inheritdoc IBridgehub
59: /// @inheritdoc IBridgehub
72: ///// Getters
74: /// @notice return the state transition chain contract for a chainId
79: //// Registry
81: /// @notice State Transition can be any contract with the appropriate interface/functionality
90: /// @notice State Transition can be any contract with the appropriate interface/functionality
91: /// @notice this stops new Chains from using the STF, old chains are not affected
100: /// @notice token can be any contract with the appropriate interface/functionality
106: /// @notice To set shared bridge, only Owner. Not done in initialize, as
107: /// the order of deployment is Bridgehub, Shared bridge, and then we call this
112: /// @notice register new chain
113: /// @notice for Eth the baseToken address is 1
118: uint256, //_salt
149: //// Mailbox forwarder
151: /// @notice forwards function call to Mailbox based on ChainId
163: /// @notice forwards function call to Mailbox based on ChainId
175: /// @notice forwards function call to Mailbox based on ChainId
197: /// @notice forwards function call to Mailbox based on ChainId
213: /// @notice the mailbox is called directly after the sharedBridge received the deposit
214: /// this assumes that either ether is the base token or
215: /// the msg.sender has approved mintValue allowance for the sharedBridge.
216: /// This means this is not ideal for contract calls, as the contract would have to handle token allowance of the base Token
253: /// @notice After depositing funds to the sharedBridge, the secondBridge is called
254: ///  to return the actual L2 message which is sent to the Mailbox.
255: ///  This assumes that either ether is the base token or
256: ///  the msg.sender has approved the sharedBridge with the mintValue,
257: ///  and also the necessary approvals are given for the second bridge.
258: /// @notice The logic of this bridge is to allow easy depositing for bridges.
259: /// Each contract that handles the users ERC20 tokens needs approvals from the user, this contract allows
260: /// the user to approve for each token only its respective bridge
261: /// @notice This function is great for contract calls to L2, the secondBridge can be any contract.
```
[17](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L17) | [20](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L20) | [22](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L22) | [25](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L25) | [28](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L28) | [31](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L31) | [34](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L34) | [37](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L37) | [40](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L40) | [50](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L50) | [59](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L59) | [72](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L72) | [74](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L74) | [79](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L79) | [81](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L81) | [90](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L90) | [91](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L91) | [100](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L100) | [106](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L106) | [107](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L107) | [112](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L112) | [113](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L113) | [118](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L118) | [149](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L149) | [151](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L151) | [163](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L163) | [175](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L175) | [197](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L197) | [213](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L213) | [214](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L214) | [215](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L215) | [216](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L216) | [253](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L253) | [254](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L254) | [255](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L255) | [256](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L256) | [257](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L257) | [258](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L258) | [259](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L259) | [260](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L260) | [261](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L261)

```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

8: /// @author Matter Labs
9: /// @custom:security-contact security@matterlabs.dev
10: /// @dev Contract design is inspired by OpenZeppelin TimelockController and in-house Diamond Proxy upgrade mechanism.
11: /// @notice This contract manages operations (calls with preconditions) for governance tasks.
12: /// The contract allows for operations to be scheduled, executed, and canceled with
13: /// appropriate permissions and delays. It is used for managing and coordinating upgrades
14: /// and changes in all zkSync hyperchain governed contracts.
15: ///
16: /// Operations can be proposed as either fully transparent upgrades with on-chain data,
17: /// or "shadow" upgrades where upgrade data is not published on-chain before execution. Proposed operations
18: /// are subject to a delay before they can be executed, but they can be executed instantly
19: /// with the security council’s permission.
21: /// @notice A constant representing the timestamp for completed operations.
24: /// @notice The address of the security council.
25: /// @dev It is supposed to be multisig contract.
28: /// @notice A mapping to store timestamps when each operation will be ready for execution.
29: /// @dev - 0 means the operation is not created.
30: /// @dev - 1 (EXECUTED_PROPOSAL_TIMESTAMP) means the operation is already executed.
31: /// @dev - any other value means timestamp in seconds when the operation will be ready for execution.
34: /// @notice The minimum delay in seconds for operations to be ready for execution.
37: /// @notice Initializes the contract with the admin address, security council address, and minimum delay.
38: /// @param _admin The address to be assigned as the admin of the contract.
39: /// @param _securityCouncil The address to be assigned as the security council of the contract.
40: /// @param _minDelay The initial minimum delay (in seconds) to be set for operations.
53: /*//////////////////////////////////////////////////////////////
55: //////////////////////////////////////////////////////////////*/
57: /// @notice Checks that the message sender is contract itself.
63: /// @notice Checks that the message sender is an active security council.
69: /// @notice Checks that the message sender is an active owner or an active security council.
78: /*//////////////////////////////////////////////////////////////
80: //////////////////////////////////////////////////////////////*/
82: /// @dev Returns whether an id corresponds to a registered operation. This
83: /// includes Waiting, Ready, and Done operations.
88: /// @dev Returns whether an operation is pending or not. Note that a "pending" operation may also be "ready".
94: /// @dev Returns whether an operation is ready for execution. Note that a "ready" operation is also "pending".
99: /// @dev Returns whether an operation is done or not.
104: /// @dev Returns operation state.
118: /*//////////////////////////////////////////////////////////////
120: //////////////////////////////////////////////////////////////*/
122: /// @notice Propose a fully transparent upgrade, providing upgrade data on-chain.
123: /// @notice The owner will be able to execute the proposal either:
124: /// - With a `delay` timelock on its own.
125: /// - With security council instantly.
126: /// @dev Only the current owner can propose an upgrade.
127: /// @param _operation The operation parameters will be executed with the upgrade.
128: /// @param _delay The delay time (in seconds) after which the proposed upgrade can be executed by the owner.
135: /// @notice Propose "shadow" upgrade, upgrade data is not publishing on-chain.
136: /// @notice The owner will be able to execute the proposal either:
137: /// - With a `delay` timelock on its own.
138: /// - With security council instantly.
139: /// @dev Only the current owner can propose an upgrade.
140: /// @param _id The operation hash (see `hashOperation` function)
141: /// @param _delay The delay time (in seconds) after which the proposed upgrade may be executed by the owner.
147: /*//////////////////////////////////////////////////////////////
149: //////////////////////////////////////////////////////////////*/
151: /// @dev Cancel the scheduled operation.
152: /// @dev Only owner can call this function.
153: /// @param _id Proposal id value (see `hashOperation`)
160: /*//////////////////////////////////////////////////////////////
162: //////////////////////////////////////////////////////////////*/
164: /// @notice Executes the scheduled operation after the delay passed.
165: /// @dev Both the owner and security council may execute delayed operations.
166: /// @param _operation The operation parameters will be executed with the upgrade.
183: /// @notice Executes the scheduled operation with the security council instantly.
184: /// @dev Only the security council may execute an operation instantly.
185: /// @param _operation The operation parameters will be executed with the upgrade.
202: /// @dev Returns the identifier of an operation.
203: /// @param _operation The operation object to compute the identifier for.
208: /*//////////////////////////////////////////////////////////////
210: //////////////////////////////////////////////////////////////*/
212: /// @dev Schedule an operation that is to become valid after a given delay.
213: /// @param _id The operation hash (see `hashOperation` function)
214: /// @param _delay The delay time (in seconds) after which the proposed upgrade can be executed by the owner.
222: /// @dev Execute an operation's calls.
223: /// @param _calls The array of calls to be executed.
236: /// @notice Verifies if the predecessor operation is completed.
237: /// @param _predecessorId The hash of the operation that should be completed.
238: /// @dev Doesn't check the operation to be complete if the input is zero.
243: /*//////////////////////////////////////////////////////////////
245: //////////////////////////////////////////////////////////////*/
247: /// @dev Changes the minimum timelock duration for future operations.
248: /// @param _newDelay The new minimum delay time (in seconds) for future operations.
254: /// @dev Updates the address of the security council.
255: /// @param _newSecurityCouncil The address of the new security council.
261: /// @dev Contract might receive/hold ETH as part of the maintenance process.
```
[8](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L8) | [9](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L9) | [10](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L10) | [11](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L11) | [12](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L12) | [13](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L13) | [14](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L14) | [15](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L15) | [16](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L16) | [17](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L17) | [18](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L18) | [19](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L19) | [21](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L21) | [24](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L24) | [25](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L25) | [28](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L28) | [29](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L29) | [30](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L30) | [31](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L31) | [34](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L34) | [37](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L37) | [38](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L38) | [39](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L39) | [40](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L40) | [53](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L53) | [55](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L55) | [57](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L57) | [63](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L63) | [69](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L69) | [78](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L78) | [80](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L80) | [82](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L82) | [83](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L83) | [88](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L88) | [94](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L94) | [99](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L99) | [104](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L104) | [118](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L118) | [120](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L120) | [122](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L122) | [123](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L123) | [124](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L124) | [125](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L125) | [126](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L126) | [127](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L127) | [128](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L128) | [135](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L135) | [136](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L136) | [137](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L137) | [138](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L138) | [139](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L139) | [140](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L140) | [141](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L141) | [147](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L147) | [149](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L149) | [151](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L151) | [152](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L152) | [153](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L153) | [160](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L160) | [162](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L162) | [164](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L164) | [165](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L165) | [166](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L166) | [183](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L183) | [184](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L184) | [185](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L185) | [202](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L202) | [203](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L203) | [208](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L208) | [210](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L210) | [212](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L212) | [213](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L213) | [214](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L214) | [222](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L222) | [223](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L223) | [236](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L236) | [237](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L237) | [238](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L238) | [243](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L243) | [245](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L245) | [247](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L247) | [248](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L248) | [254](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L254) | [255](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L255) | [261](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L261)

```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

22: /// @title StateTransition contract
23: /// @author Matter Labs
24: /// @custom:security-contact security@matterlabs.dev
26: /// @notice Address of the bridgehub
29: /// @notice chainId => chainContract
32: /// @dev Batch hash zero, calculated at initialization
35: /// @dev Stored cutData for diamond cut
38: /// @dev genesisUpgrade contract address, used to setChainId
41: /// @dev current protocolVersion
44: /// @dev validatorTimelock contract address, used to setChainId
47: /// @dev Stored cutData for upgrade diamond cut. protocolVersion => cutHash
50: /// @dev used to manage non critical updates
53: /// @dev used to accept the admin role
56: /// @dev Contract is expected to be used as proxy implementation.
57: /// @dev Initialize the implementation to prevent Parity hack.
62: /// @notice only the bridgehub can call
68: /// @notice the admin can call, for non-critical updates
78: /// @dev initialize
109: /// @inheritdoc IStateTransitionManager
118: /// @inheritdoc IStateTransitionManager
131: /// @dev set validatorTimelock. Cannot do it an initialization, as validatorTimelock is deployed after STM
136: /// @dev set initial cutHash
141: /// @dev set New Version with upgrade from old version
151: /// @dev set upgrade for some protocolVersion
159: /// @dev freezes the specified chain
164: /// @dev freezes the specified chain
169: /// @dev reverts batches on the specified chain
174: /// registration
176: /// @dev we have to set the chainId at genesis, as blockhashzero is the same for all chains with the same chainId
238: /// @notice called by Bridgehub when a chain registers
260: /// all together 4+9*32=292 bytes
```
[22](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L22) | [23](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L23) | [24](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L24) | [26](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L26) | [29](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L29) | [32](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L32) | [35](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L35) | [38](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L38) | [41](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L41) | [44](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L44) | [47](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L47) | [50](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L50) | [53](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L53) | [56](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L56) | [57](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L57) | [62](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L62) | [68](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L68) | [78](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L78) | [109](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L109) | [118](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L118) | [131](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L131) | [136](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L136) | [141](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L141) | [151](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L151) | [159](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L159) | [164](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L164) | [169](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L169) | [174](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L174) | [176](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L176) | [238](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L238) | [260](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L260)

```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

11: /// @author Matter Labs
12: /// @custom:security-contact security@matterlabs.dev
13: /// @notice Intermediate smart contract between the validator EOA account and the hyperchains state transition diamond smart contract.
14: /// @dev The primary purpose of this contract is to provide a trustless means of delaying batch execution without
15: /// modifying the main hyperchain diamond contract. As such, even if this contract is compromised, it will not impact the main
16: /// contract.
17: /// @dev zkSync actively monitors the chain activity and reacts to any suspicious activity by freezing the chain.
18: /// This allows time for investigation and mitigation before resuming normal operations.
19: /// @dev The contract overloads all of the 4 methods, that are used in state transition. When the batch is committed,
20: /// the timestamp is stored for it. Later, when the owner calls the batch execution, the contract checks that batch
21: /// was committed not earlier than X time ago.
25: /// @dev Part of the IBase interface. Not used in this contract.
28: /// @notice The delay between committing and executing batches is changed.
31: /// @notice A new validator has been added.
34: /// @notice A validator has been removed.
37: /// @notice Error for when an address is already a validator.
40: /// @notice Error for when an address is not a validator.
43: /// @dev The stateTransitionManager smart contract.
46: /// @dev The mapping of L2 chainId => batch number => timestamp when it was committed.
49: /// @dev The address that can commit/revert/validate/execute batches.
52: /// @dev The delay between committing and executing batches.
60: /// @notice Checks if the caller is the admin of the chain.
66: /// @notice Checks if the caller is a validator.
72: /// @dev Set new validator address.
77: /// @dev Sets an address as a validator.
86: /// @dev Removes an address as a validator.
95: /// @dev Set the delay between committing and executing batches.
101: /// @dev Returns the timestamp when `_l2BatchNumber` was committed.
106: /// @dev Records the timestamp for all provided committed batches and make
107: /// a call to the hyperchain diamond contract with the same calldata.
124: /// @dev Records the timestamp for all provided committed batches and make
125: /// a call to the hyperchain diamond contract with the same calldata.
143: /// @dev Make a call to the hyperchain diamond contract with the same calldata.
144: /// Note: If the batch is reverted, it needs to be committed first before the execution.
145: /// So it's safe to not override the committed batches.
150: /// @dev Make a call to the hyperchain diamond contract with the same calldata.
151: /// Note: If the batch is reverted, it needs to be committed first before the execution.
152: /// So it's safe to not override the committed batches.
157: /// @dev Make a call to the hyperchain diamond contract with the same calldata.
158: /// Note: We don't track the time when batches are proven, since all information about
159: /// the batch is known on the commit stage and the proved is not finalized (may be reverted).
168: /// @dev Make a call to the hyperchain diamond contract with the same calldata.
169: /// Note: We don't track the time when batches are proven, since all information about
170: /// the batch is known on the commit stage and the proved is not finalized (may be reverted).
180: /// @dev Check that batches were committed at least X time ago and
181: /// make a call to the hyperchain diamond contract with the same calldata.
201: /// @dev Check that batches were committed at least X time ago and
202: /// make a call to the hyperchain diamond contract with the same calldata.
223: /// @dev Call the hyperchain diamond contract with the same calldata as this contract was called.
224: /// Note: it is called the hyperchain diamond contract, not delegatecalled!
```
[11](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L11) | [12](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L12) | [13](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L13) | [14](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L14) | [15](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L15) | [16](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L16) | [17](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L17) | [18](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L18) | [19](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L19) | [20](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L20) | [21](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L21) | [25](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L25) | [28](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L28) | [31](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L31) | [34](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L34) | [37](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L37) | [40](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L40) | [43](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L43) | [46](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L46) | [49](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L49) | [52](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L52) | [60](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L60) | [66](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L66) | [72](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L72) | [77](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L77) | [86](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L86) | [95](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L95) | [101](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L101) | [106](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L106) | [107](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L107) | [124](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L124) | [125](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L125) | [143](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L143) | [144](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L144) | [145](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L145) | [150](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L150) | [151](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L151) | [152](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L152) | [157](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L157) | [158](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L158) | [159](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L159) | [168](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L168) | [169](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L169) | [170](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L170) | [180](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L180) | [181](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L181) | [201](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L201) | [202](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L202) | [223](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L223) | [224](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L224)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol

14: /// @author Matter Labs
15: /// @dev The contract is used only once to initialize the diamond proxy.
16: /// @dev The deployment process takes care of this contract's initialization.
18: /// @dev Initialize the implementation to prevent any possibility of a Parity hack.
21: /// @notice hyperchain diamond contract initialization
22: /// @return Magic 32 bytes, which indicates that the contract logic is expected to be used as a diamond proxy
23: /// initializer
```
[14](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol#L14) | [15](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol#L15) | [16](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol#L16) | [18](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol#L18) | [21](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol#L21) | [22](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol#L22) | [23](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol#L23)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol

7: /// @title Diamond Proxy Contract (EIP-2535)
8: /// @author Matter Labs
9: /// @custom:security-contact security@matterlabs.dev
18: /// @dev 1. Find the facet for the function that is called.
19: /// @dev 2. Delegate the execution to the found facet via `delegatecall`.
```
[7](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol#L7) | [8](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol#L8) | [9](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol#L9) | [18](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol#L18) | [19](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol#L19)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol

8: /// @notice Indicates whether an upgrade is initiated and if yes what type
9: /// @param None Upgrade is NOT initiated
10: /// @param Transparent Fully transparent upgrade is initiated, upgrade data is publicly known
11: /// @param Shadow Shadow upgrade is initiated, upgrade data is hidden
18: /// @dev Logically separated part of the storage structure, which is responsible for everything related to proxy
19: /// upgrades and diamond cuts
20: /// @param proposedUpgradeHash The hash of the current upgrade proposal, zero if there is no active proposal
21: /// @param state Indicates whether an upgrade is initiated and if yes what type
22: /// @param securityCouncil Address which has the permission to approve instant upgrades (expected to be a Gnosis
23: /// multisig)
24: /// @param approvedBySecurityCouncil Indicates whether the security council has approved the upgrade
25: /// @param proposedUpgradeTimestamp The timestamp when the upgrade was proposed, zero if there are no active proposals
26: /// @param currentProposalId The serial number of proposed upgrades, increments when proposing a new one
36: /// @notice The struct that describes whether users will be charged for pubdata for L1->L2 transactions.
37: /// @param Rollup The users are charged for pubdata & it is priced based on the gas price on Ethereum.
38: /// @param Validium The pubdata is considered free with regard to the L1 gas price.
44: /// @notice The fee params for L1->L2 transactions for the network.
45: /// @param pubdataPricingMode How the users will charged for pubdata in L1->L2 transactions.
46: /// @param batchOverheadL1Gas The amount of L1 gas required to process the batch (except for the calldata).
47: /// @param maxPubdataPerBatch The maximal number of pubdata that can be emitted per batch.
48: /// @param priorityTxMaxPubdata The maximal amount of pubdata a priority transaction is allowed to publish.
49: /// It can be slightly less than maxPubdataPerBatch in order to have some margin for the bootloader execution.
50: /// @param minimalL2GasPrice The minimal L2 gas price to be used by L1->L2 transactions. It should represent
51: /// the price that a single unit of compute costs.
61: /// @dev storing all storage variables for hyperchain diamond facets
62: /// NOTE: It is used in a proxy, so it is possible to add new variables to the end
63: /// but NOT to modify already existing variables or change their order.
64: /// NOTE: variables prefixed with '__DEPRECATED_' are deprecated and shouldn't be used.
65: /// Their presence is maintained for compatibility and to prevent storage collision.
67: /// @dev Storage of variables needed for deprecated diamond cut facet
69: /// @notice Address which will exercise critical changes to the Diamond Proxy (upgrades, freezing & unfreezing). Replaced by STM
71: /// @notice Address that the governor proposed as one that will replace it
73: /// @notice List of permitted validators
75: /// @dev Verifier contract. Used to verify aggregated proof for batches
77: /// @notice Total number of executed batches i.e. batches[totalBatchesExecuted] points at the latest executed batch
78: /// (batch 0 is genesis)
80: /// @notice Total number of proved batches i.e. batches[totalBatchesProved] points at the latest proved batch
82: /// @notice Total number of committed batches i.e. batches[totalBatchesCommitted] points at the latest committed
83: /// batch
85: /// @dev Stored hashed StoredBatch for batch number
87: /// @dev Stored root hashes of L2 -> L1 logs
89: /// @dev Container that stores transactions requested from L1
91: /// @dev The smart contract that manages the list with permission to call contract functions
93: /// @notice Part of the configuration parameters of ZKP circuits. Used as an input for the verifier smart contract
95: /// @notice Bytecode hash of bootloader program.
96: /// @dev Used as an input to zkp-circuit.
98: /// @notice Bytecode hash of default account (bytecode for EOA).
99: /// @dev Used as an input to zkp-circuit.
101: /// @dev Indicates that the porter may be touched on L2 transactions.
102: /// @dev Used as an input to zkp-circuit.
104: /// @dev The maximum number of the L2 gas that a user can request for L1 -> L2 transactions
105: /// @dev This is the maximum number of L2 gas that is available for the "body" of the transaction, i.e.
106: /// without overhead for proving the batch.
108: /// @dev Storage of variables needed for upgrade facet
110: /// @dev A mapping L2 batch number => message number => flag.
111: /// @dev The L2 -> L1 log is sent for every withdrawal, so this mapping is serving as
112: /// a flag to indicate that the message was already processed.
113: /// @dev Used to indicate that eth withdrawal was already processed
115: /// @dev The most recent withdrawal time and amount reset
117: /// @dev The accumulated withdrawn amount during the withdrawal limit window
119: /// @dev A mapping user address => the total deposited amount by the user
121: /// @dev Stores the protocol version. Note, that the protocol version may not only encompass changes to the
122: /// smart contracts, but also to the node behavior.
124: /// @dev Hash of the system contract upgrade transaction. If 0, then no upgrade transaction needs to be done.
126: /// @dev Batch number where the upgrade transaction has happened. If 0, then no upgrade transaction has happened
127: /// yet.
129: /// @dev Address which will exercise non-critical changes to the Diamond Proxy (changing validator set & unfreezing)
131: /// @notice Address that the admin proposed as one that will replace admin role
133: /// @dev Fee params used to derive gasPrice for the L1->L2 transactions. For L2 transactions,
134: /// the bootloader gives enough freedom to the operator.
136: /// @dev Address of the blob versioned hash getter smart contract used for EIP-4844 versioned hashes.
138: /// new fields
139: /// @dev The chainId of the chain
141: /// @dev The address of the bridgehub
143: /// @dev The address of the StateTransitionManager
145: /// @dev The address of the baseToken contract. Eth is address(1)
147: /// @dev The address of the baseTokenbridge. Eth also uses the shared bridge
149: /// @notice gasPriceMultiplier for each baseToken, so that each L1->L2 transaction pays for its transaction on the destination
150: /// we multiply by the nominator, and divide by the denominator
```
[8](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L8) | [9](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L9) | [10](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L10) | [11](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L11) | [18](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L18) | [19](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L19) | [20](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L20) | [21](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L21) | [22](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L22) | [23](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L23) | [24](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L24) | [25](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L25) | [26](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L26) | [36](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L36) | [37](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L37) | [38](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L38) | [44](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L44) | [45](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L45) | [46](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L46) | [47](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L47) | [48](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L48) | [49](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L49) | [50](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L50) | [51](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L51) | [61](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L61) | [62](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L62) | [63](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L63) | [64](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L64) | [65](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L65) | [67](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L67) | [69](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L69) | [71](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L71) | [73](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L73) | [75](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L75) | [77](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L77) | [78](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L78) | [80](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L80) | [82](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L82) | [83](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L83) | [85](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L85) | [87](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L87) | [89](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L89) | [91](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L91) | [93](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L93) | [95](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L95) | [96](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L96) | [98](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L98) | [99](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L99) | [101](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L101) | [102](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L102) | [104](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L104) | [105](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L105) | [106](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L106) | [108](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L108) | [110](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L110) | [111](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L111) | [112](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L112) | [113](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L113) | [115](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L115) | [117](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L117) | [119](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L119) | [121](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L121) | [122](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L122) | [124](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L124) | [126](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L126) | [127](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L127) | [129](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L129) | [131](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L131) | [133](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L133) | [134](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L134) | [136](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L136) | [138](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L138) | [139](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L139) | [141](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L141) | [143](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L143) | [145](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L145) | [147](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L147) | [149](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L149) | [150](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L150)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol

15: /// @title Admin Contract controls access rights for contract management.
16: /// @author Matter Labs
17: /// @custom:security-contact security@matterlabs.dev
19: /// @inheritdoc IZkSyncStateTransitionBase
22: /// @inheritdoc IAdmin
31: /// @inheritdoc IAdmin
44: /// @inheritdoc IAdmin
50: /// @inheritdoc IAdmin
57: /// @inheritdoc IAdmin
66: /// @inheritdoc IAdmin
78: /// @inheritdoc IAdmin
95: /*//////////////////////////////////////////////////////////////
97: //////////////////////////////////////////////////////////////*/
99: /// upgrade a specific chain
122: /// @inheritdoc IAdmin
128: /*//////////////////////////////////////////////////////////////
130: //////////////////////////////////////////////////////////////*/
132: /// @inheritdoc IAdmin
142: /// @inheritdoc IAdmin
```
[15](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L15) | [16](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L16) | [17](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L17) | [19](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L19) | [22](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L22) | [31](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L31) | [44](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L44) | [50](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L50) | [57](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L57) | [66](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L66) | [78](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L78) | [95](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L95) | [97](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L97) | [99](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L99) | [122](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L122) | [128](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L128) | [130](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L130) | [132](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L132) | [142](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L142)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

19: /// @title zkSync hyperchain Executor contract capable of processing events emitted in the zkSync hyperchain protocol.
20: /// @author Matter Labs
21: /// @custom:security-contact security@matterlabs.dev
26: /// @inheritdoc IZkSyncStateTransitionBase
29: /// @dev Process one batch commit using the previous batch StoredBatchInfo
30: /// @dev returns new batch StoredBatchInfo
31: /// @notice Does not change storage
99: /// @notice checks that the timestamps of both the new batch and the new L2 block are correct.
100: /// @param _packedBatchAndL2BlockTimestamp - packed batch and L2 block timestamp in a format of batchTimestamp * 2**128 + l2BatchTimestamp
101: /// @param _expectedBatchTimestamp - expected batch timestamp
102: /// @param _previousBatchTimestamp - the timestamp of the previous batch
126: /// @dev Check that L2 logs are proper and batch contain all meta information for them
127: /// @dev The logs processed here should line up such that only one log for each key from the
128: ///      SystemLogKey enum in Constants.sol is processed per new batch.
129: /// @dev Data returned from here will be used to form the batch commitment.
198: /// @inheritdoc IExecutor
206: /// @inheritdoc IExecutor
250: /// @dev Commits new batches without any system contracts upgrade.
251: /// @param _lastCommittedBatchData The data of the last committed batch.
252: /// @param _newBatchesData An array of batch data that needs to be committed.
269: /// @dev Commits new batches with a system contracts upgrade transaction.
270: /// @param _lastCommittedBatchData The data of the last committed batch.
271: /// @param _newBatchesData An array of batch data that needs to be committed.
272: /// @param _systemContractUpgradeTxHash The transaction hash of the system contract upgrade.
307: /// @dev Pops the priority operations from the priority queue and returns a rolling hash of operations
317: /// @dev Executes one batch
318: /// @dev 1. Processes all pending operations (Complete priority requests)
319: /// @dev 2. Finalizes batch on Ethereum
320: /// @dev _executedBatchIdx is an index in the array of the batches that we want to execute together
336: /// @inheritdoc IExecutor
344: /// @inheritdoc IExecutor
367: /// @inheritdoc IExecutor
376: /// @inheritdoc IExecutor
452: /// @dev Gets zk proof public input
471: /// @inheritdoc IExecutor
476: /// @inheritdoc IExecutor
499: /// @dev Creates batch commitment from its data
557: /// @dev Encodes the commitment to blobs to be used in the auxiliary output of the batch commitment
558: /// @param _blobCommitments - the commitments to the blobs
559: /// @param _blobHashes - the hashes of the blobs
560: /// @param blobAuxOutputWords - The circuit commitment to the blobs split into 32-byte words
586: /// @notice Returns the keccak hash of the ABI-encoded StoredBatchInfo
591: /// @notice Returns true if the bit at index {_index} is 1
596: /// @notice Sets the given bit in {_num} at index {_index} to 1.
601: /// @notice Calls the point evaluation precompile and verifies the output
602: /// Verify p(z) = y given commitment that corresponds to the polynomial p(x) and a KZG proof.
603: /// Also verify that the provided commitment matches the provided versioned_hash.
604: ///
621: /// @dev Verifies that the blobs contain the correct data by calling the point evaluation precompile. For the precompile we need:
622: /// versioned hash || opening point || opening value || commitment || proof
623: /// the _pubdataCommitments will contain the last 4 values, the versioned hash is pulled from the BLOBHASH opcode
624: /// pubdataCommitments is a list of: opening point (16 bytes) || claimed value (32 bytes) || commitment (48 bytes) || proof (48 bytes)) = 144 bytes
676: /// @dev Since we don't have access to the new BLOBHASH opecode we need to leverage a static call to a yul contract
677: /// that calls the opcode via a verbatim call. This should be swapped out once there is solidity support for the
678: /// new opcode.
```
[19](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L19) | [20](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L20) | [21](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L21) | [26](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L26) | [29](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L29) | [30](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L30) | [31](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L31) | [99](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L99) | [100](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L100) | [101](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L101) | [102](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L102) | [126](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L126) | [127](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L127) | [128](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L128) | [129](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L129) | [198](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L198) | [206](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L206) | [250](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L250) | [251](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L251) | [252](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L252) | [269](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L269) | [270](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L270) | [271](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L271) | [272](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L272) | [307](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L307) | [317](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L317) | [318](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L318) | [319](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L319) | [320](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L320) | [336](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L336) | [344](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L344) | [367](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L367) | [376](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L376) | [452](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L452) | [471](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L471) | [476](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L476) | [499](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L499) | [557](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L557) | [558](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L558) | [559](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L559) | [560](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L560) | [586](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L586) | [591](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L591) | [596](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L596) | [601](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L601) | [602](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L602) | [603](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L603) | [604](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L604) | [621](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L621) | [622](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L622) | [623](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L623) | [624](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L624) | [676](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L676) | [677](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L677) | [678](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L678)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol

17: /// @title Getters Contract implements functions for getting contract state from outside the blockchain.
18: /// @author Matter Labs
19: /// @custom:security-contact security@matterlabs.dev
24: /// @inheritdoc IZkSyncStateTransitionBase
27: /*//////////////////////////////////////////////////////////////
29: //////////////////////////////////////////////////////////////*/
31: /// @inheritdoc IGetters
36: /// @inheritdoc IGetters
41: /// @inheritdoc IGetters
46: /// @inheritdoc IGetters
51: /// @inheritdoc IGetters
56: /// @inheritdoc IGetters
61: /// @inheritdoc IGetters
66: /// @inheritdoc IGetters
71: /// @inheritdoc IGetters
76: /// @inheritdoc IGetters
81: /// @inheritdoc IGetters
86: /// @inheritdoc IGetters
91: /// @inheritdoc IGetters
96: /// @inheritdoc IGetters
101: /// @inheritdoc IGetters
106: /// @inheritdoc IGetters
111: /// @inheritdoc IGetters
116: /// @inheritdoc IGetters
121: /// @inheritdoc IGetters
126: /// @inheritdoc IGetters
131: /// @inheritdoc IGetters
136: /// @inheritdoc IGetters
141: /// @inheritdoc IGetters
146: /// @inheritdoc IGetters
151: /// @inheritdoc IGetters
156: /// @inheritdoc IGetters
162: /// @inheritdoc IGetters
175: /// @inheritdoc IGetters
180: /// @inheritdoc IGetters
187: /// @inheritdoc IGetters
192: /// @inheritdoc IGetters
197: /*//////////////////////////////////////////////////////////////
199: //////////////////////////////////////////////////////////////*/
201: /// @inheritdoc IGetters
216: /// @inheritdoc IGetters
222: /// @inheritdoc IGetters
228: /// @inheritdoc IGetters
234: /*//////////////////////////////////////////////////////////////
236: //////////////////////////////////////////////////////////////*/
238: /// @inheritdoc ILegacyGetters
243: /// @inheritdoc ILegacyGetters
248: /// @inheritdoc ILegacyGetters
253: /// @inheritdoc ILegacyGetters
258: /// @inheritdoc ILegacyGetters
```
[17](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L17) | [18](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L18) | [19](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L19) | [24](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L24) | [27](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L27) | [29](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L29) | [31](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L31) | [36](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L36) | [41](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L41) | [46](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L46) | [51](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L51) | [56](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L56) | [61](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L61) | [66](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L66) | [71](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L71) | [76](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L76) | [81](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L81) | [86](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L86) | [91](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L91) | [96](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L96) | [101](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L101) | [106](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L106) | [111](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L111) | [116](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L116) | [121](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L121) | [126](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L126) | [131](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L131) | [136](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L136) | [141](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L141) | [146](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L146) | [151](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L151) | [156](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L156) | [162](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L162) | [175](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L175) | [180](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L180) | [187](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L187) | [192](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L192) | [197](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L197) | [199](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L199) | [201](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L201) | [216](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L216) | [222](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L222) | [228](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L228) | [234](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L234) | [236](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L236) | [238](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L238) | [243](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L243) | [248](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L248) | [253](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L253) | [258](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L258)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

27: /// @title zkSync Mailbox contract providing interfaces for L1 <-> L2 interaction.
28: /// @author Matter Labs
29: /// @custom:security-contact security@matterlabs.dev
34: /// @inheritdoc IZkSyncStateTransitionBase
37: /// @inheritdoc IMailbox
46: /// @notice when requesting transactions through the bridgehub
53: /// @inheritdoc IMailbox
63: /// @inheritdoc IMailbox
73: /// @inheritdoc IMailbox
103: /// @dev Prove that a specific L2 log was sent in a specific L2 batch number
129: /// @dev Convert arbitrary-length message to the raw l2 log
142: /// @inheritdoc IMailbox
152: /// @notice Derives the price for L2 gas in ETH to be paid.
153: /// @param _l1GasPrice The gas price on L1
154: /// @param _gasPerPubdata The price for each pubdata byte in L2 gas
155: /// @return The price of L2 gas in ETH
177: /// @inheritdoc IMailbox
196: ///  @inheritdoc IMailbox
315: /// @notice Stores a transaction record in storage & send event about that
352: /// @notice Hashes the L2 bytecodes and returns them in the format in which they are processed by the bootloader
```
[27](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L27) | [28](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L28) | [29](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L29) | [34](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L34) | [37](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L37) | [46](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L46) | [53](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L53) | [63](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L63) | [73](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L73) | [103](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L103) | [129](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L129) | [142](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L142) | [152](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L152) | [153](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L153) | [154](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L154) | [155](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L155) | [177](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L177) | [196](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L196) | [315](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L315) | [352](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L352)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol

8: /// @title Base contract containing functions accessible to the other facets.
9: /// @author Matter Labs
10: /// @custom:security-contact security@matterlabs.dev
14: /// @notice Checks that the message sender is an active admin
20: /// @notice Checks if validator is active
```
[8](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L8) | [9](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L9) | [10](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L10) | [14](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L14) | [20](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L20)

```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol

14: /// @notice The struct that represents the upgrade proposal.
15: /// @param l2ProtocolUpgradeTx The system upgrade transaction.
16: /// @param factoryDeps The list of factory deps for the l2ProtocolUpgradeTx.
17: /// @param bootloaderHash The hash of the new bootloader bytecode. If zero, it will not be updated.
18: /// @param defaultAccountHash The hash of the new default account bytecode. If zero, it will not be updated.
19: /// @param verifier The address of the new verifier. If zero, the verifier will not be updated.
20: /// @param verifierParams The new verifier params. If all of its fields are 0, the params will not be updated.
21: /// @param l1ContractsUpgradeCalldata Custom calldata for L1 contracts upgrade, it may be interpreted differently
22: /// in each upgrade. Usually empty.
23: /// @param postUpgradeCalldata Custom calldata for post upgrade hook, it may be interpreted differently in each
24: /// upgrade. Usually empty.
25: /// @param upgradeTimestamp The timestamp after which the upgrade can be executed.
26: /// @param newProtocolVersion The new version number for the protocol after this upgrade. Should be greater than
27: /// the previous protocol version.
41: /// @author Matter Labs
42: /// @custom:security-contact security@matterlabs.dev
43: /// @notice Interface to which all the upgrade implementations should adhere
45: /// @notice Changes the protocol version
48: /// @notice Сhanges to the bytecode that is used in L2 as a bootloader (start program)
51: /// @notice Сhanges to the bytecode that is used in L2 as a default account
54: /// @notice Verifier address changed
57: /// @notice Verifier parameters changed
60: /// @notice Notifies about complete upgrade
63: /// @notice The main function that will be provided by the upgrade proxy
64: /// @dev This is a virtual function and should be overridden by custom upgrade implementations.
65: /// @param _proposedUpgrade The upgrade to be executed.
66: /// @return txHash The hash of the L2 system contract upgrade transaction.
90: /// @notice Change default account bytecode hash, that is used on L2
91: /// @param _l2DefaultAccountBytecodeHash The hash of default account L2 bytecode
107: /// @notice Change bootloader bytecode hash, that is used on L2
108: /// @param _l2BootloaderBytecodeHash The hash of bootloader L2 bytecode
124: /// @notice Change the address of the verifier smart contract
125: /// @param _newVerifier Verifier smart contract address
140: /// @notice Change the verifier parameters
141: /// @param _newVerifierParams New parameters for the verifier
160: /// @notice Updates the verifier and the verifier params
161: /// @param _newVerifier The address of the new verifier. If 0, the verifier will not be updated.
162: /// @param _verifierParams The new verifier params. If all of the fields are 0, the params will not be updated.
168: /// @notice Updates the bootloader hash and the hash of the default account
169: /// @param _bootloaderHash The hash of the new bootloader bytecode. If zero, it will not be updated.
170: /// @param _defaultAccountHash The hash of the new default account bytecode. If zero, it will not be updated.
176: /// @notice Sets the hash of the L2 system contract upgrade transaction for the next batch to be committed
177: /// @dev If the transaction is noop (i.e. its type is 0) it does nothing and returns 0.
178: /// @param _l2ProtocolUpgradeTx The L2 system contract upgrade transaction.
179: /// @return System contracts upgrade transaction hash. Zero if no upgrade transaction is set.
219: /// @notice Verifies that the factory deps correspond to the proper hashes
220: /// @param _factoryDeps The list of factory deps
221: /// @param _expectedHashes The list of expected bytecode hashes
234: /// @notice Changes the protocol version
235: /// @param _newProtocolVersion The new protocol version
259: /// @notice Placeholder function for custom logic for upgrading L1 contract.
260: /// Typically this function will never be used.
261: /// @param _customCallDataForUpgrade Custom data for an upgrade, which may be interpreted differently for each
262: /// upgrade.
265: /// @notice placeholder function for custom logic for post-upgrade logic.
266: /// Typically this function will never be used.
267: /// @param _customCallDataForUpgrade Custom data for an upgrade, which may be interpreted differently for each
268: /// upgrade.
```
[14](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L14) | [15](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L15) | [16](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L16) | [17](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L17) | [18](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L18) | [19](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L19) | [20](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L20) | [21](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L21) | [22](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L22) | [23](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L23) | [24](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L24) | [25](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L25) | [26](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L26) | [27](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L27) | [41](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L41) | [42](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L42) | [43](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L43) | [45](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L45) | [48](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L48) | [51](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L51) | [54](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L54) | [57](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L57) | [60](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L60) | [63](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L63) | [64](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L64) | [65](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L65) | [66](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L66) | [90](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L90) | [91](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L91) | [107](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L107) | [108](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L108) | [124](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L124) | [125](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L125) | [140](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L140) | [141](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L141) | [160](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L160) | [161](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L161) | [162](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L162) | [168](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L168) | [169](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L169) | [170](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L170) | [176](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L176) | [177](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L177) | [178](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L178) | [179](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L179) | [219](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L219) | [220](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L220) | [221](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L221) | [234](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L234) | [235](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L235) | [259](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L259) | [260](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L260) | [261](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L261) | [262](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L262) | [265](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L265) | [266](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L266) | [267](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L267) | [268](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L268)

```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol

14: /// @author Matter Labs
15: /// @custom:security-contact security@matterlabs.dev
16: /// @notice Interface to which all the upgrade implementations should adhere
18: /// @notice Changes the protocol version
19: /// @param _newProtocolVersion The new protocol version
43: /// @notice The main function that will be provided by the upgrade proxy
44: /// @dev This is a virtual function and should be overridden by custom upgrade implementations.
45: /// @param _proposedUpgrade The upgrade to be executed.
46: /// @return The hash of the L2 system contract upgrade transaction.
```
[14](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L14) | [15](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L15) | [16](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L16) | [18](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L18) | [19](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L19) | [43](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L43) | [44](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L44) | [45](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L45) | [46](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L46)

```solidity
File: code/contracts/ethereum/contracts/upgrades/DefaultUpgrade.sol

8: /// @author Matter Labs
9: /// @custom:security-contact security@matterlabs.dev
11: /// @notice The main function that will be called by the upgrade proxy.
12: /// @param _proposedUpgrade The upgrade to be executed.
```
[8](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/DefaultUpgrade.sol#L8) | [9](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/DefaultUpgrade.sol#L9) | [11](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/DefaultUpgrade.sol#L11) | [12](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/DefaultUpgrade.sol#L12)

```solidity
File: code/contracts/ethereum/contracts/upgrades/GenesisUpgrade.sol

9: /// @author Matter Labs
10: /// @custom:security-contact security@matterlabs.dev
12: /// @notice The main function that will be called by the upgrade proxy.
13: /// @param _proposedUpgrade The upgrade to be executed.
```
[9](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/GenesisUpgrade.sol#L9) | [10](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/GenesisUpgrade.sol#L10) | [12](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/GenesisUpgrade.sol#L12) | [13](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/GenesisUpgrade.sol#L13)

```solidity
File: code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol

11: /// @dev The prefix used to create CREATE2 addresses.
14: /// @notice Validate the bytecode format and calculate its hash.
15: /// @param _bytecode The bytecode to hash.
16: /// @return hashedBytecode The 32-byte hash of the bytecode.
17: /// Note: The function reverts the execution if the bytecode has non expected format:
18: /// - Bytecode bytes length is not a multiple of 32
19: /// - Bytecode bytes length is not less than 2^21 bytes (2^16 words)
20: /// - Bytecode words length is not odd
35: /// @notice Validates the format of the given bytecode hash.
36: /// @dev Due to the specification of the L2 bytecode hash, not every 32 bytes could be a legit bytecode hash.
37: /// @dev The function reverts on invalid bytecode hash formam.
38: /// @param _bytecodeHash The hash of the bytecode to validate.
46: /// @notice Returns the length of the bytecode associated with the given hash.
47: /// @param _bytecodeHash The hash of the bytecode.
48: /// @return codeLengthInWords The length of the bytecode in words.
53: /// @notice Computes the create2 address for a Layer 2 contract.
54: /// @param _sender The address of the sender.
55: /// @param _salt The salt value to use in the create2 address computation.
56: /// @param _bytecodeHash The contract bytecode hash.
57: /// @param _constructorInputHash The hash of the constructor input data.
58: /// @return The create2 address of the contract.
59: /// NOTE: L2 create2 derivation is different from L1 derivation!
```
[11](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L11) | [14](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L14) | [15](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L15) | [16](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L16) | [17](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L17) | [18](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L18) | [19](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L19) | [20](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L20) | [35](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L35) | [36](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L36) | [37](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L37) | [38](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L38) | [46](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L46) | [47](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L47) | [48](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L48) | [53](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L53) | [54](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L54) | [55](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L55) | [56](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L56) | [57](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L57) | [58](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L58) | [59](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L59)

```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol

8: /// @author Matter Labs
9: /// @custom:security-contact security@matterlabs.dev
10: /// @notice The helper library for managing the EIP-2535 diamond proxy.
15: /// @dev Magic value that should be returned by diamond cut initialize contracts.
16: /// @dev Used to distinguish calls to contracts that were supposed to be used as diamond initializer from other contracts.
20: /// @dev Storage position of `DiamondStorage` structure.
26: /// @dev Utility struct that contains associated facet & meta information of selector
27: /// @param facetAddress address of the facet which is connected with selector
28: /// @param selectorPosition index in `FacetToSelectors.selectors` array, where is selector stored
29: /// @param isFreezable denotes whether the selector can be frozen.
36: /// @dev Utility struct that contains associated selectors & meta information of facet
37: /// @param selectors list of all selectors that belong to the facet
38: /// @param facetPosition index in `DiamondStorage.facets` array, where is facet stored
44: /// @notice The structure that holds all diamond proxy associated parameters
45: /// @dev According to the EIP-2535 should be stored on a special storage key - `DIAMOND_STORAGE_POSITION`
46: /// @param selectorToFacet A mapping from the selector to the facet address and its meta information
47: /// @param facetToSelectors A mapping from facet address to its selectors with meta information
48: /// @param facets The array of all unique facet addresses that belong to the diamond proxy
49: /// @param isFrozen Denotes whether the diamond proxy is frozen and all freezable facets are not accessible
57: /// @dev Parameters for diamond changes that touch one of the facets
58: /// @param facet The address of facet that's affected by the cut
59: /// @param action The action that is made on the facet
60: /// @param isFreezable Denotes whether the facet & all their selectors can be frozen
61: /// @param selectors An array of unique selectors that belongs to the facet address
69: /// @dev Structure of the diamond proxy changes
70: /// @param facetCuts The set of changes (adding/removing/replacement) of implementation contracts
71: /// @param initAddress The address that's delegate called after setting up new facet changes
72: /// @param initCalldata Calldata for the delegate call to `initAddress`
79: /// @dev Type of change over diamond: add/replace/remove facets
86: /// @return diamondStorage The pointer to the storage where all specific diamond proxy parameters stored
94: /// @dev Add/replace/remove any number of selectors and optionally execute a function with delegatecall
95: /// @param _diamondCut Diamond's facet changes and the parameters to optional initialization delegatecall
124: /// @dev Add new functions to the diamond proxy
125: /// NOTE: expect but NOT enforce that `_selectors` is NON-EMPTY array
147: /// @dev Change associated facets to already known function selectors
148: /// NOTE: expect but NOT enforce that `_selectors` is NON-EMPTY array
170: /// @dev Remove association with function and facet
171: /// NOTE: expect but NOT enforce that `_selectors` is NON-EMPTY array
187: /// @dev Add address to the list of known facets if it is not on the list yet
188: /// NOTE: should be called ONLY before adding a new selector associated with the address
200: /// @dev Add one function to the already known facet
201: /// NOTE: It is expected but NOT enforced that:
202: /// - `_facet` is NON-ZERO address
203: /// - `_facet` is already stored address in `DiamondStorage.facets`
204: /// - `_selector` is NOT associated by another facet
226: /// @dev Remove one associated function with facet
227: /// NOTE: It is expected but NOT enforced that `_facet` is NON-ZERO address
255: /// @dev remove facet from the list of known facets
256: /// NOTE: It is expected but NOT enforced that there are no selectors associated with `_facet`
276: /// @dev Delegates call to the initialization address with provided calldata
277: /// @dev Used as a final step of diamond cut to execute the logic of the initialization for changed facets
```
[8](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L8) | [9](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L9) | [10](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L10) | [15](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L15) | [16](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L16) | [20](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L20) | [26](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L26) | [27](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L27) | [28](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L28) | [29](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L29) | [36](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L36) | [37](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L37) | [38](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L38) | [44](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L44) | [45](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L45) | [46](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L46) | [47](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L47) | [48](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L48) | [49](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L49) | [57](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L57) | [58](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L58) | [59](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L59) | [60](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L60) | [61](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L61) | [69](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L69) | [70](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L70) | [71](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L71) | [72](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L72) | [79](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L79) | [86](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L86) | [94](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L94) | [95](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L95) | [124](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L124) | [125](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L125) | [147](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L147) | [148](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L148) | [170](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L170) | [171](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L171) | [187](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L187) | [188](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L188) | [200](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L200) | [201](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L201) | [202](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L202) | [203](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L203) | [204](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L204) | [226](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L226) | [227](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L227) | [255](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L255) | [256](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L256) | [276](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L276) | [277](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L277)

```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/LibMap.sol

4: /// @notice Library for storage of packed unsigned integers.
5: /// @author Matter Labs
6: /// @dev This library is an adaptation of the corresponding Solady library (https://github.com/vectorized/solady/blob/main/src/utils/LibMap.sol)
7: /// @custom:security-contact security@matterlabs.dev
9: /// @dev A uint32 map in storage.
14: /// @dev Retrieves the uint32 value at a specific index from the Uint32Map.
15: /// @param _map The Uint32Map instance containing the packed uint32 values.
16: /// @param _index The index of the uint32 value to retrieve.
17: /// @return result The uint32 value at the specified index.
34: /// @dev Updates the uint32 value at `_index` in `map`.
35: /// @param _map The Uint32Map instance containing the packed uint32 values.
36: /// @param _index The index of the uint32 value to set.
37: /// @param _value The new value at the specified index.
```
[4](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/LibMap.sol#L4) | [5](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/LibMap.sol#L5) | [6](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/LibMap.sol#L6) | [7](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/LibMap.sol#L7) | [9](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/LibMap.sol#L9) | [14](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/LibMap.sol#L14) | [15](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/LibMap.sol#L15) | [16](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/LibMap.sol#L16) | [17](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/LibMap.sol#L17) | [34](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/LibMap.sol#L34) | [35](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/LibMap.sol#L35) | [36](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/LibMap.sol#L36) | [37](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/LibMap.sol#L37)

```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol

7: /// @author Matter Labs
8: /// @custom:security-contact security@matterlabs.dev
12: /// @dev Calculate Merkle root by the provided Merkle proof.
13: /// NOTE: When using this function, check that the _path length is equal to the tree height to prevent shorter/longer paths attack
14: /// @param _path Merkle path from the leaf to the root
15: /// @param _index Leaf index in the tree
16: /// @param _itemHash Hash of leaf content
17: /// @return The Merkle root
39: /// @dev Keccak hash of the concatenation of two 32-byte words
```
[7](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol#L7) | [8](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol#L8) | [12](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol#L12) | [13](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol#L13) | [14](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol#L14) | [15](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol#L15) | [16](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol#L16) | [17](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol#L17) | [39](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol#L39)

```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol

5: /// @notice The structure that contains meta information of the L2 transaction that was requested from L1
6: /// @dev The weird size of fields was selected specifically to minimize the structure storage size
7: /// @param canonicalTxHash Hashed L2 transaction data that is needed to process it
8: /// @param expirationTimestamp Expiration timestamp for this request (must be satisfied before)
9: /// @param layer2Tip Additional payment to the validator as an incentive to perform the operation
16: /// @author Matter Labs
17: /// @custom:security-contact security@matterlabs.dev
18: /// @dev The library provides the API to interact with the priority queue container
19: /// @dev Order of processing operations from queue - FIFO (Fist in - first out)
23: /// @notice Container that stores priority operations
24: /// @param data The inner mapping that saves priority operation by its index
25: /// @param head The pointer to the first unprocessed priority operation, equal to the tail if the queue is empty
26: /// @param tail The pointer to the free slot
33: /// @notice Returns zero if and only if no operations were processed from the queue
34: /// @return Index of the oldest priority operation that wasn't processed yet
39: /// @return The total number of priority operations that were added to the priority queue, including all processed ones
44: /// @return The total number of unprocessed priority operations in a priority queue
49: /// @return Whether the priority queue contains no operations
54: /// @notice Add the priority operation to the end of the priority queue
63: /// @return The first unprocessed priority operation from the queue
70: /// @notice Remove the first unprocessed priority operation from the queue
71: /// @return priorityOperation that was popped from the priority queue
```
[5](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L5) | [6](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L6) | [7](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L7) | [8](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L8) | [9](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L9) | [16](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L16) | [17](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L17) | [18](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L18) | [19](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L19) | [23](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L23) | [24](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L24) | [25](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L25) | [26](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L26) | [33](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L33) | [34](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L34) | [39](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L39) | [44](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L44) | [49](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L49) | [54](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L54) | [63](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L63) | [70](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L70) | [71](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L71)

```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol

10: /// @title zkSync Library for validating L1 -> L2 transactions
11: /// @author Matter Labs
12: /// @custom:security-contact security@matterlabs.dev
14: /// @dev Used to validate key properties of an L1->L2 transaction
15: /// @param _transaction The transaction to validate
16: /// @param _encoded The abi encoded bytes of the transaction
17: /// @param _priorityTxMaxGasLimit The max gas limit, generally provided from Storage.sol
18: /// @param _priorityTxMaxPubdata The maximal amount of pubdata that a single L1->L2 transaction can emit
44: /// @dev Used to validate upgrade transactions
45: /// @param _transaction The transaction to validate
63: /// @dev Calculates the approximate minimum gas limit required for executing a priority transaction.
64: /// @param _encodingLength The length of the priority transaction encoding in bytes.
65: /// @param _numberOfFactoryDependencies The number of new factory dependencies that will be added.
66: /// @param _l2GasPricePerPubdata The L2 gas price for publishing the priority transaction on L2.
67: /// @return The minimum gas limit required to execute the priority transaction.
68: /// Note: The calculation includes the main cost of the priority transaction, however, in reality, the operator can spend a little more gas on overheads.
104: /// @notice Based on the full L2 gas limit (that includes the batch overhead) and other
105: /// properties of the transaction, returns the l2GasLimit for the body of the transaction (the actual execution).
106: /// @param _totalGasLimit The L2 gas limit that includes both the overhead for processing the batch
107: /// and the L2 gas needed to process the transaction itself (i.e. the actual l2GasLimit that will be used for the transaction).
108: /// @param _encodingLength The length of the ABI-encoding of the transaction.
122: /// @notice Based on the total L2 gas limit and several other parameters of the transaction
123: /// returns the part of the L2 gas that will be spent on the batch's overhead.
124: /// @dev The details of how this function works can be checked in the documentation
125: /// of the fee model of zkSync. The appropriate comments are also present
126: /// in the Rust implementation description of function `get_maximal_allowed_overhead`.
127: /// @param _encodingLength The length of the binary encoding of the transaction in bytes
```
[10](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L10) | [11](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L11) | [12](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L12) | [14](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L14) | [15](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L15) | [16](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L16) | [17](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L17) | [18](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L18) | [44](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L44) | [45](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L45) | [63](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L63) | [64](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L64) | [65](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L65) | [66](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L66) | [67](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L67) | [68](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L68) | [104](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L104) | [105](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L105) | [106](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L106) | [107](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L107) | [108](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L108) | [122](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L122) | [123](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L123) | [124](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L124) | [125](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L125) | [126](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L126) | [127](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L127)

```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol

7: /// @title L1 Bridge contract legacy interface
8: /// @author Matter Labs
9: /// @custom:security-contact security@matterlabs.dev
10: /// @notice Legacy Bridge interface before hyperchain migration, used for backward compatibility with zkSync Era
```
[7](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L7) | [8](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L8) | [9](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L9) | [10](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L10)

```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol

9: /// @title L1 Bridge contract interface
10: /// @author Matter Labs
11: /// @custom:security-contact security@matterlabs.dev
124: /// data is abi encoded :
125: /// address _l1Token,
126: /// uint256 _amount,
127: /// address _l2Receiver
```
[9](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L9) | [10](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L10) | [11](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L11) | [124](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L124) | [125](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L125) | [126](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L126) | [127](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L127)

```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL2Bridge.sol

5: /// @author Matter Labs
```
[5](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL2Bridge.sol#L5)

```solidity
File: code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol

43: /// @notice pendingAdmin is changed
44: /// @dev Also emitted when new admin is accepted and in this case, `newPendingAdmin` would be zero address
47: /// @notice Admin changed
50: /// @notice Starts the transfer of admin rights. Only the current admin can propose a new pending one.
51: /// @notice New admin can accept admin rights by calling `acceptAdmin` function.
52: /// @param _newPendingAdmin Address of the new admin
55: /// @notice Accepts transfer of admin rights. Only pending admin can accept the role.
58: /// Getters
71: /// Mailbox forwarder
114: //// Registry
```
[43](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L43) | [44](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L44) | [47](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L47) | [50](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L50) | [51](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L51) | [52](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L52) | [55](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L55) | [58](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L58) | [71](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L71) | [114](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L114)

```solidity
File: code/contracts/ethereum/contracts/common/interfaces/IL2ContractDeployer.sol

10: /// @notice A struct that describes a forced deployment on an address.
11: /// @param bytecodeHash The bytecode hash to put on an address.
12: /// @param newAddress The address on which to deploy the bytecodehash to.
13: /// @param callConstructor Whether to run the constructor on the force deployment.
14: /// @param value The `msg.value` with which to initialize a contract.
15: /// @param input The constructor calldata.
24: /// @notice This method is to be used only during an upgrade to set bytecodes on specific addresses.
27: /// @notice Deploys a contract with similar address derivation rules to the EVM's `CREATE2` opcode.
28: /// @param _salt The create2 salt.
29: /// @param _bytecodeHash The correctly formatted hash of the bytecode.
30: /// @param _input The constructor calldata.
```
[10](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/interfaces/IL2ContractDeployer.sol#L10) | [11](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/interfaces/IL2ContractDeployer.sol#L11) | [12](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/interfaces/IL2ContractDeployer.sol#L12) | [13](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/interfaces/IL2ContractDeployer.sol#L13) | [14](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/interfaces/IL2ContractDeployer.sol#L14) | [15](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/interfaces/IL2ContractDeployer.sol#L15) | [24](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/interfaces/IL2ContractDeployer.sol#L24) | [27](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/interfaces/IL2ContractDeployer.sol#L27) | [28](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/interfaces/IL2ContractDeployer.sol#L28) | [29](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/interfaces/IL2ContractDeployer.sol#L29) | [30](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/interfaces/IL2ContractDeployer.sol#L30)

```solidity
File: code/contracts/ethereum/contracts/governance/IGovernance.sol

5: /// @title Governance contract interface
6: /// @author Matter Labs
7: /// @custom:security-contact security@matterlabs.dev
9: /// @dev This enumeration includes the following states:
10: /// @param Unset Default state, indicating the operation has not been set.
11: /// @param Waiting The operation is scheduled but not yet ready to be executed.
12: /// @param Ready The operation is ready to be executed.
13: /// @param Done The operation has been successfully executed.
21: /// @dev Represents a call to be made during an operation.
22: /// @param target The address to which the call will be made.
23: /// @param value The amount of Ether (in wei) to be sent along with the call.
24: /// @param data The calldata to be executed on the `target` address.
31: /// @dev Defines the structure of an operation that Governance executes.
32: /// @param calls An array of `Call` structs, each representing a call to be made during the operation.
33: /// @param predecessor The hash of the predecessor operation, that should be executed before this operation.
34: /// @param salt A bytes32 value used for creating unique operation hashes.
67: /// @notice Emitted when transparent operation is scheduled.
70: /// @notice Emitted when shadow operation is scheduled.
73: /// @notice Emitted when the operation is executed with delay or instantly.
76: /// @notice Emitted when the security council address is changed.
79: /// @notice Emitted when the minimum delay for future operations is modified.
82: /// @notice Emitted when the operation with specified id is cancelled.
```
[5](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/IGovernance.sol#L5) | [6](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/IGovernance.sol#L6) | [7](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/IGovernance.sol#L7) | [9](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/IGovernance.sol#L9) | [10](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/IGovernance.sol#L10) | [11](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/IGovernance.sol#L11) | [12](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/IGovernance.sol#L12) | [13](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/IGovernance.sol#L13) | [21](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/IGovernance.sol#L21) | [22](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/IGovernance.sol#L22) | [23](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/IGovernance.sol#L23) | [24](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/IGovernance.sol#L24) | [31](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/IGovernance.sol#L31) | [32](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/IGovernance.sol#L32) | [33](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/IGovernance.sol#L33) | [34](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/IGovernance.sol#L34) | [67](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/IGovernance.sol#L67) | [70](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/IGovernance.sol#L70) | [73](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/IGovernance.sol#L73) | [76](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/IGovernance.sol#L76) | [79](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/IGovernance.sol#L79) | [82](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/IGovernance.sol#L82)

```solidity
File: code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol

8: /// @notice Struct that holds all data needed for initializing STM Proxy.
9: /// @dev We use struct instead of raw parameters in `initialize` function to prevent "Stack too deep" error
10: /// @param _governor address who can manage non-critical updates in the contract
11: /// @param _validatorTimelock address that serves as consensus, i.e. can submit blocks to be processed
12: /// @param _genesisBatchHash Batch hash of the genesis (initial) batch
13: /// @param _genesisIndexRepeatedStorageChanges The serial number of the shortcut storage key for genesis batch
14: /// @param _genesisBatchCommitment The zk-proof commitment for the genesis batch
36: /// @notice pendingAdmin is changed
37: /// @dev Also emitted when new admin is accepted and in this case, `newPendingAdmin` would be zero address
40: /// @notice Admin changed
45: /// @notice Starts the transfer of admin rights. Only the current admin can propose a new pending one.
46: /// @notice New admin can accept admin rights by calling `acceptAdmin` function.
47: /// @param _newPendingAdmin Address of the new admin
50: /// @notice Accepts transfer of admin rights. Only pending admin can accept the role.
73: /// @notice
```
[8](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L8) | [9](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L9) | [10](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L10) | [11](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L11) | [12](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L12) | [13](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L13) | [14](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L14) | [36](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L36) | [37](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L37) | [40](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L40) | [45](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L45) | [46](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L46) | [47](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L47) | [50](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L50) | [73](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L73)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol

10: /// @title The interface of the Admin Contract that controls access rights for contract management.
11: /// @author Matter Labs
12: /// @custom:security-contact security@matterlabs.dev
14: /// @notice Starts the transfer of admin rights. Only the current admin can propose a new pending one.
15: /// @notice New admin can accept admin rights by calling `acceptAdmin` function.
16: /// @param _newPendingAdmin Address of the new admin
19: /// @notice Accepts transfer of admin rights. Only pending admin can accept the role.
22: /// @notice Change validator status (active or not active)
23: /// @param _validator Validator address
24: /// @param _active Active flag
27: /// @notice Change zk porter availability
28: /// @param _zkPorterIsAvailable The availability of zk porter shard
31: /// @notice Change the max L2 gas limit for L1 -> L2 transactions
32: /// @param _newPriorityTxMaxGasLimit The maximum number of L2 gas that a user can request for L1 -> L2 transactions
35: /// @notice Change the fee params for L1->L2 transactions
36: /// @param _newFeeParams The new fee params
39: /// @notice Change the token multiplier for L1->L2 transactions
42: /// @notice Used to set to validium directly after genesis
47: /// @notice Executes a proposed governor upgrade
48: /// @dev Only the current admin can execute the upgrade
49: /// @param _diamondCut The diamond cut parameters to be executed
52: /// @notice Instantly pause the functionality of all freezable facets & their selectors
53: /// @dev Only the governance mechanism may freeze Diamond Proxy
56: /// @notice Unpause the functionality of all freezable facets & their selectors
57: /// @dev Both the admin and the STM can unfreeze Diamond Proxy
60: /// @notice Porter availability status changes
63: /// @notice Validator's status changed
66: /// @notice pendingAdmin is changed
67: /// @dev Also emitted when new admin is accepted and in this case, `newPendingAdmin` would be zero address
70: /// @notice Admin changed
73: /// @notice Priority transaction max L2 gas limit changed
76: /// @notice Fee params for L1->L2 transactions changed
79: /// @notice Validium mode status changed
82: /// @notice BaseToken multiplier for L1->L2 transactions changed
90: /// @notice Emitted when an upgrade is executed.
93: /// @notice Emitted when the contract is frozen.
96: /// @notice Emitted when the contract is unfrozen.
```
[10](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L10) | [11](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L11) | [12](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L12) | [14](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L14) | [15](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L15) | [16](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L16) | [19](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L19) | [22](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L22) | [23](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L23) | [24](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L24) | [27](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L27) | [28](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L28) | [31](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L31) | [32](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L32) | [35](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L35) | [36](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L36) | [39](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L39) | [42](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L42) | [47](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L47) | [48](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L48) | [49](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L49) | [52](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L52) | [53](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L53) | [56](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L56) | [57](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L57) | [60](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L60) | [63](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L63) | [66](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L66) | [67](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L67) | [70](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L70) | [73](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L73) | [76](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L76) | [79](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L79) | [82](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L82) | [90](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L90) | [93](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L93) | [96](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L96)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol

9: /// @param chainId the id of the chain
10: /// @param bridgehub the address of the bridgehub contract
11: /// @param stateTransitionManager contract's address
12: /// @param protocolVersion initial protocol version
13: /// @param validatorTimelock address of the validator timelock that delays execution
14: /// @param admin address who can manage the contract
15: /// @param baseToken address of the base token of the chain
16: /// @param baseTokenBridge address of the L1 shared bridge contract
17: /// @param storedBatchZero hash of the initial genesis batch
18: /// @param verifier address of Verifier contract
19: /// @param verifierParams Verifier config parameters that describes the circuit to be verified
20: /// @param l2BootloaderBytecodeHash The hash of bootloader L2 bytecode
21: /// @param l2DefaultAccountBytecodeHash The hash of default account L2 bytecode
22: /// @param priorityTxMaxGasLimit maximum number of the L2 gas that a user can request for L1 -> L2 transactions
23: /// @param feeParams Fee parameters to be used for L1->L2 transactions
24: /// @param blobVersionedHashRetriever Address of contract used to pull the blob versioned hash for a transaction.
44: /// @param verifier address of Verifier contract
45: /// @param verifierParams Verifier config parameters that describes the circuit to be verified
46: /// @param l2BootloaderBytecodeHash The hash of bootloader L2 bytecode
47: /// @param l2DefaultAccountBytecodeHash The hash of default account L2 bytecode
48: /// @param priorityTxMaxGasLimit maximum number of the L2 gas that a user can request for L1 -> L2 transactions
49: /// @param feeParams Fee parameters to be used for L1->L2 transactions
50: /// @param blobVersionedHashRetriever Address of contract used to pull the blob versioned hash for a transaction.
```
[9](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol#L9) | [10](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol#L10) | [11](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol#L11) | [12](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol#L12) | [13](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol#L13) | [14](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol#L14) | [15](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol#L15) | [16](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol#L16) | [17](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol#L17) | [18](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol#L18) | [19](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol#L19) | [20](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol#L20) | [21](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol#L21) | [22](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol#L22) | [23](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol#L23) | [24](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol#L24) | [44](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol#L44) | [45](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol#L45) | [46](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol#L46) | [47](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol#L47) | [48](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol#L48) | [49](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol#L49) | [50](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol#L50)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol

7: /// @dev Enum used by L2 System Contracts to differentiate logs.
21: /// @dev Enum used to determine the source of pubdata. At first we will support calldata and blobs but this can be extended.
39: /// @dev Offset used to pull Address From Log. Equal to 4 (bytes for isService)
42: /// @dev Offset used to pull Key From Log. Equal to 4 (bytes for isService) + 20 (bytes for address)
45: /// @dev Offset used to pull Value From Log. Equal to 4 (bytes for isService) + 20 (bytes for address) + 32 (bytes for key)
48: /// @dev BLS Modulus value defined in EIP-4844 and the magic value returned from a successful call to the
49: /// point evaluation precompile
52: /// @dev Packed pubdata commitments.
53: /// @dev Format: list of: opening point (16 bytes) || claimed value (32 bytes) || commitment (48 bytes) || proof (48 bytes)) = 144 bytes
56: /// @dev Offset in pubdata commitment of blobs for claimed value
59: /// @dev Offset in pubdata commitment of blobs for kzg commitment
62: /// @dev Max number of blobs currently supported
65: /// @dev The number of blobs that must be present in the commitment to a batch.
66: /// It represents the maximal number of blobs that circuits can support and can be larger
67: /// than the maximal number of blobs supported by the contract (`MAX_NUMBER_OF_BLOBS`).
70: /// @title The interface of the zkSync Executor contract capable of processing events emitted in the zkSync protocol.
71: /// @author Matter Labs
72: /// @custom:security-contact security@matterlabs.dev
74: /// @notice Rollup batch stored data
75: /// @param batchNumber Rollup batch number
76: /// @param batchHash Hash of L2 batch
77: /// @param indexRepeatedStorageChanges The serial number of the shortcut index that's used as a unique identifier for storage keys that were used twice or more
78: /// @param numberOfLayer1Txs Number of priority operations to be processed
79: /// @param priorityOperationsHash Hash of all priority operations from this batch
80: /// @param l2LogsTreeRoot Root hash of tree that contains L2 -> L1 messages from this batch
81: /// @param timestamp Rollup batch timestamp, have the same format as Ethereum batch constant
82: /// @param commitment Verified input for the zkSync circuit
94: /// @notice Data needed to commit new batch
95: /// @param batchNumber Number of the committed batch
96: /// @param timestamp Unix timestamp denoting the start of the batch execution
97: /// @param indexRepeatedStorageChanges The serial number of the shortcut index that's used as a unique identifier for storage keys that were used twice or more
98: /// @param newStateRoot The state root of the full state tree
99: /// @param numberOfLayer1Txs Number of priority operations to be processed
100: /// @param priorityOperationsHash Hash of all priority operations from this batch
101: /// @param bootloaderHeapInitialContentsHash Hash of the initial contents of the bootloader heap. In practice it serves as the commitment to the transactions in the batch.
102: /// @param eventsQueueStateHash Hash of the events queue state. In practice it serves as the commitment to the events in the batch.
103: /// @param systemLogs concatenation of all L2 -> L1 system logs in the batch
104: /// @param pubdataCommitments Packed pubdata commitments/data.
105: /// @dev pubdataCommitments format: This will always start with a 1 byte pubdataSource flag. Current allowed values are 0 (calldata) or 1 (blobs)
106: ///                             kzg: list of: opening point (16 bytes) || claimed value (32 bytes) || commitment (48 bytes) || proof (48 bytes) = 144 bytes
107: ///                             calldata: pubdataCommitments.length - 1 - 32 bytes of pubdata
108: ///                                       and 32 bytes appended to serve as the blob commitment part for the aux output part of the batch commitment
109: /// @dev For 2 blobs we will be sending 288 bytes of calldata instead of the full amount for pubdata.
110: /// @dev When using calldata, we only need to send one blob commitment since the max number of bytes in calldata fits in a single blob and we can pull the
111: ///     linear hash from the system logs
125: /// @notice Recursive proof input data (individual commitments are constructed onchain)
131: /// @notice Function called by the operator to commit new batches. It is responsible for:
132: /// - Verifying the correctness of their timestamps.
133: /// - Processing their L2->L1 logs.
134: /// - Storing batch commitments.
135: /// @param _lastCommittedBatchData Stored data of the last committed batch.
136: /// @param _newBatchesData Data of the new batches to be committed.
142: /// @notice same as `commitBatches` but with the chainId so ValidatorTimelock can sort the inputs.
149: /// @notice Batches commitment verification.
150: /// @dev Only verifies batch commitments without any other processing.
151: /// @param _prevBatch Stored data of the last committed batch.
152: /// @param _committedBatches Stored data of the committed batches.
153: /// @param _proof The zero knowledge proof.
160: /// @notice same as `proveBatches` but with the chainId so ValidatorTimelock can sort the inputs.
168: /// @notice The function called by the operator to finalize (execute) batches. It is responsible for:
169: /// - Processing all pending operations (commpleting priority requests).
170: /// - Finalizing this batch (i.e. allowing to withdraw funds from the system)
171: /// @param _batchesData Data of the batches to be executed.
174: /// @notice same as `executeBatches` but with the chainId so ValidatorTimelock can sort the inputs.
177: /// @notice Reverts unexecuted batches
178: /// @param _newLastBatch batch number after which batches should be reverted
179: /// NOTE: Doesn't delete the stored data about batches, but only decreases
180: /// counters that are responsible for the number of batches
183: /// @notice same as `revertBatches` but with the chainId so ValidatorTimelock can sort the inputs.
186: /// @notice Event emitted when a batch is committed
187: /// @param batchNumber Number of the batch committed
188: /// @param batchHash Hash of the L2 batch
189: /// @param commitment Calculated input for the zkSync circuit
190: /// @dev It has the name "BlockCommit" and not "BatchCommit" due to backward compatibility considerations
193: /// @notice Event emitted when batches are verified
194: /// @param previousLastVerifiedBatch Batch number of the previous last verified batch
195: /// @param currentLastVerifiedBatch Batch number of the current last verified batch
196: /// @dev It has the name "BlocksVerification" and not "BatchesVerification" due to backward compatibility considerations
199: /// @notice Event emitted when a batch is executed
200: /// @param batchNumber Number of the batch executed
201: /// @param batchHash Hash of the L2 batch
202: /// @param commitment Verified input for the zkSync circuit
203: /// @dev It has the name "BlockExecution" and not "BatchExecution" due to backward compatibility considerations
206: /// @notice Event emitted when batches are reverted
207: /// @param totalBatchesCommitted Total number of committed batches after the revert
208: /// @param totalBatchesVerified Total number of verified batches after the revert
209: /// @param totalBatchesExecuted Total number of executed batches
210: /// @dev It has the name "BlocksRevert" and not "BatchesRevert" due to backward compatibility considerations
```
[7](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L7) | [21](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L21) | [39](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L39) | [42](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L42) | [45](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L45) | [48](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L48) | [49](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L49) | [52](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L52) | [53](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L53) | [56](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L56) | [59](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L59) | [62](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L62) | [65](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L65) | [66](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L66) | [67](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L67) | [70](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L70) | [71](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L71) | [72](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L72) | [74](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L74) | [75](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L75) | [76](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L76) | [77](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L77) | [78](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L78) | [79](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L79) | [80](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L80) | [81](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L81) | [82](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L82) | [94](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L94) | [95](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L95) | [96](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L96) | [97](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L97) | [98](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L98) | [99](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L99) | [100](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L100) | [101](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L101) | [102](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L102) | [103](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L103) | [104](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L104) | [105](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L105) | [106](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L106) | [107](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L107) | [108](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L108) | [109](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L109) | [110](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L110) | [111](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L111) | [125](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L125) | [131](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L131) | [132](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L132) | [133](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L133) | [134](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L134) | [135](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L135) | [136](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L136) | [142](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L142) | [149](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L149) | [150](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L150) | [151](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L151) | [152](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L152) | [153](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L153) | [160](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L160) | [168](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L168) | [169](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L169) | [170](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L170) | [171](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L171) | [174](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L174) | [177](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L177) | [178](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L178) | [179](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L179) | [180](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L180) | [183](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L183) | [186](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L186) | [187](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L187) | [188](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L188) | [189](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L189) | [190](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L190) | [193](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L193) | [194](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L194) | [195](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L195) | [196](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L196) | [199](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L199) | [200](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L200) | [201](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L201) | [202](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L202) | [203](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L203) | [206](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L206) | [207](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L207) | [208](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L208) | [209](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L209) | [210](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L210)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol

10: /// @title The interface of the Getters Contract that implements functions for getting contract state from outside the blockchain.
11: /// @author Matter Labs
12: /// @custom:security-contact security@matterlabs.dev
14: /*//////////////////////////////////////////////////////////////
16: //////////////////////////////////////////////////////////////*/
18: /// @return The address of the verifier smart contract
21: /// @return The address of the current admin
24: /// @return The address of the pending admin
27: /// @return The address of the bridgehub
30: /// @return The address of the state transition
33: /// @return The address of the base token
36: /// @return The address of the base token bridge
39: /// @return The total number of batches that were committed
42: /// @return The total number of batches that were committed & verified
45: /// @return The total number of batches that were committed & verified & executed
48: /// @return The total number of priority operations that were added to the priority queue, including all processed ones
51: /// @notice The function that returns the first unprocessed priority transaction.
52: /// @dev Returns zero if and only if no operations were processed from the queue.
53: /// @dev If all the transactions were processed, it will return the last processed index, so
54: /// in case exactly *unprocessed* transactions are needed, one should check that getPriorityQueueSize() is greater than 0.
55: /// @return Index of the oldest priority operation that wasn't processed yet
58: /// @return The number of priority operations currently in the queue
61: /// @return The first unprocessed priority operation from the queue
64: /// @return Whether the address has a validator access
67: /// @return merkleRoot Merkle root of the tree with L2 logs for the selected batch
70: /// @notice For unfinalized (non executed) batches may change
71: /// @dev returns zero for non-committed batches
72: /// @return The hash of committed L2 batch.
75: /// @return Bytecode hash of bootloader program.
78: /// @return Bytecode hash of default account (bytecode for EOA).
81: /// @return Verifier parameters.
84: /// @return Whether the diamond is frozen or not
87: /// @return The current protocol version
90: /// @return The upgrade system contract transaction hash, 0 if the upgrade is not initialized
93: /// @return The L2 batch number in which the upgrade transaction was processed.
94: /// @dev It is equal to 0 in the following two cases:
95: /// - No upgrade transaction has ever been processed.
96: /// - The upgrade transaction has been processed and the batch with such transaction has been
97: /// executed (i.e. finalized).
100: /// @return The maximum number of L2 gas that a user can request for L1 -> L2 transactions
103: /// @return Whether a withdrawal has been finalized.
104: /// @param _l2BatchNumber The L2 batch number within which the withdrawal happened.
105: /// @param _l2MessageIndex The index of the L2->L1 message denoting the withdrawal.
108: /// @return The pubdata pricing mode.
111: /// @return the baseTokenGasPriceMultiplierNominator, used to compare the baseTokenPrice to ether for L1->L2 transactions
114: /// @return the baseTokenGasPriceMultiplierDenominator, used to compare the baseTokenPrice to ether for L1->L2 transactions
117: /*//////////////////////////////////////////////////////////////
119: //////////////////////////////////////////////////////////////*/
121: /// @notice Faсet structure compatible with the EIP-2535 diamond loupe
122: /// @param addr The address of the facet contract
123: /// @param selectors The NON-sorted array with selectors associated with facet
129: /// @return result All facet addresses and their function selectors
132: /// @return NON-sorted array with function selectors supported by a specific facet
135: /// @return facets NON-sorted array of facet addresses supported on diamond
138: /// @return facet The facet address associated with a selector. Zero if the selector is not added to the diamond
141: /// @return Whether the selector can be frozen by the admin or always accessible
144: /// @return isFreezable Whether the facet can be frozen by the admin or always accessible
```
[10](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L10) | [11](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L11) | [12](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L12) | [14](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L14) | [16](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L16) | [18](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L18) | [21](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L21) | [24](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L24) | [27](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L27) | [30](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L30) | [33](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L33) | [36](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L36) | [39](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L39) | [42](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L42) | [45](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L45) | [48](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L48) | [51](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L51) | [52](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L52) | [53](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L53) | [54](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L54) | [55](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L55) | [58](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L58) | [61](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L61) | [64](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L64) | [67](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L67) | [70](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L70) | [71](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L71) | [72](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L72) | [75](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L75) | [78](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L78) | [81](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L81) | [84](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L84) | [87](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L87) | [90](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L90) | [93](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L93) | [94](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L94) | [95](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L95) | [96](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L96) | [97](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L97) | [100](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L100) | [103](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L103) | [104](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L104) | [105](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L105) | [108](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L108) | [111](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L111) | [114](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L114) | [117](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L117) | [119](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L119) | [121](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L121) | [122](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L122) | [123](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L123) | [129](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L129) | [132](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L132) | [135](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L135) | [138](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L138) | [141](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L141) | [144](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L144)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/ILegacyGetters.sol

7: /// @author Matter Labs
8: /// @dev This interface contains getters for the zkSync contract that should not be used,
9: /// but still are kept for backward compatibility.
10: /// @custom:security-contact security@matterlabs.dev
12: /// @return The total number of batches that were committed
13: /// @dev It is a *deprecated* method, please use `getTotalBatchesCommitted` instead
16: /// @return The total number of batches that were committed & verified
17: /// @dev It is a *deprecated* method, please use `getTotalBatchesVerified` instead.
20: /// @return The total number of batches that were committed & verified & executed
21: /// @dev It is a *deprecated* method, please use `getTotalBatchesExecuted` instead.
24: /// @notice For unfinalized (non executed) batches may change
25: /// @dev It is a *deprecated* method, please use `storedBatchHash` instead.
26: /// @dev returns zero for non-committed batches
27: /// @return The hash of committed L2 batch.
30: /// @return The L2 batch number in which the upgrade transaction was processed.
31: /// @dev It is a *deprecated* method, please use `getL2SystemContractsUpgradeBatchNumber` instead.
32: /// @dev It is equal to 0 in the following two cases:
33: /// - No upgrade transaction has ever been processed.
34: /// - The upgrade transaction has been processed and the batch with such transaction has been
35: /// executed (i.e. finalized).
```
[7](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/ILegacyGetters.sol#L7) | [8](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/ILegacyGetters.sol#L8) | [9](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/ILegacyGetters.sol#L9) | [10](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/ILegacyGetters.sol#L10) | [12](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/ILegacyGetters.sol#L12) | [13](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/ILegacyGetters.sol#L13) | [16](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/ILegacyGetters.sol#L16) | [17](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/ILegacyGetters.sol#L17) | [20](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/ILegacyGetters.sol#L20) | [21](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/ILegacyGetters.sol#L21) | [24](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/ILegacyGetters.sol#L24) | [25](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/ILegacyGetters.sol#L25) | [26](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/ILegacyGetters.sol#L26) | [27](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/ILegacyGetters.sol#L27) | [30](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/ILegacyGetters.sol#L30) | [31](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/ILegacyGetters.sol#L31) | [32](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/ILegacyGetters.sol#L32) | [33](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/ILegacyGetters.sol#L33) | [34](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/ILegacyGetters.sol#L34) | [35](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/ILegacyGetters.sol#L35)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol

8: /// @title The interface of the zkSync Mailbox contract that provides interfaces for L1 <-> L2 interaction.
9: /// @author Matter Labs
10: /// @custom:security-contact security@matterlabs.dev
12: /// @notice Prove that a specific arbitrary-length message was sent in a specific L2 batch number
13: /// @param _batchNumber The executed L2 batch number in which the message appeared
14: /// @param _index The position in the L2 logs Merkle tree of the l2Log that was sent with the message
15: /// @param _message Information about the sent message: sender address, the message itself, tx index in the L2 batch where the message was sent
16: /// @param _proof Merkle proof for inclusion of L2 log that was sent with the message
17: /// @return Whether the proof is valid
25: /// @notice Prove that a specific L2 log was sent in a specific L2 batch
26: /// @param _batchNumber The executed L2 batch number in which the log appeared
27: /// @param _index The position of the l2log in the L2 logs Merkle tree
28: /// @param _log Information about the sent log
29: /// @param _proof Merkle proof for inclusion of the L2 log
30: /// @return Whether the proof is correct and L2 log is included in batch
38: /// @notice Prove that the L1 -> L2 transaction was processed with the specified status.
39: /// @param _l2TxHash The L2 canonical transaction hash
40: /// @param _l2BatchNumber The L2 batch number where the transaction was processed
41: /// @param _l2MessageIndex The position in the L2 logs Merkle tree of the l2Log that was sent with the message
42: /// @param _l2TxNumberInBatch The L2 transaction number in the batch, in which the log was sent
43: /// @param _merkleProof The Merkle proof of the processing L1 -> L2 transaction
44: /// @param _status The execution status of the L1 -> L2 transaction (true - success & 0 - fail)
45: /// @return Whether the proof is correct and the transaction was actually executed with provided status
46: /// NOTE: It may return `false` for incorrect proof, but it doesn't mean that the L1 -> L2 transaction has an opposite status!
56: /// @notice Finalize the withdrawal and release funds
57: /// @param _l2BatchNumber The L2 batch number where the withdrawal was processed
58: /// @param _l2MessageIndex The position in the L2 logs Merkle tree of the l2Log that was sent with the message
59: /// @param _l2TxNumberInBatch The L2 transaction number in a batch, in which the log was sent
60: /// @param _message The L2 withdraw data, stored in an L2 -> L1 message
61: /// @param _merkleProof The Merkle proof of the inclusion L2 -> L1 message about withdrawal initialization
70: /// @notice Request execution of L2 transaction from L1.
71: /// @param _contractL2 The L2 receiver address
72: /// @param _l2Value `msg.value` of L2 transaction
73: /// @param _calldata The input of the L2 transaction
74: /// @param _l2GasLimit Maximum amount of L2 gas that transaction can consume during execution on L2
75: /// @param _l2GasPerPubdataByteLimit The maximum amount L2 gas that the operator may charge the user for single byte of pubdata.
76: /// @param _factoryDeps An array of L2 bytecodes that will be marked as known on L2
77: /// @param _refundRecipient The address on L2 that will receive the refund for the transaction.
78: /// @dev If the L2 deposit finalization transaction fails, the `_refundRecipient` will receive the `_l2Value`.
79: /// Please note, the contract may change the refund recipient's address to eliminate sending funds to addresses out of control.
80: /// - If `_refundRecipient` is a contract on L1, the refund will be sent to the aliased `_refundRecipient`.
81: /// - If `_refundRecipient` is set to `address(0)` and the sender has NO deployed bytecode on L1, the refund will be sent to the `msg.sender` address.
82: /// - If `_refundRecipient` is set to `address(0)` and the sender has deployed bytecode on L1, the refund will be sent to the aliased `msg.sender` address.
83: /// @dev The address aliasing of L1 contracts as refund recipient on L2 is necessary to guarantee that the funds are controllable,
84: /// since address aliasing to the from address for the L2 tx will be applied if the L1 `msg.sender` is a contract.
85: /// Without address aliasing for L1 contracts as refund recipients they would not be able to make proper L2 tx requests
86: /// through the Mailbox to use or withdraw the funds from L2, and the funds would be lost.
87: /// @return canonicalTxHash The hash of the requested L2 transaction. This hash can be used to follow the transaction status
102: /// @notice Estimates the cost in Ether of requesting execution of an L2 transaction from L1
103: /// @param _gasPrice expected L1 gas price at which the user requests the transaction execution
104: /// @param _l2GasLimit Maximum amount of L2 gas that transaction can consume during execution on L2
105: /// @param _l2GasPerPubdataByteLimit The maximum amount of L2 gas that the operator may charge the user for a single byte of pubdata.
106: /// @return The estimated ETH spent on L2 gas for the transaction
113: /// @notice tranfer Eth to shared bridge as part of migration process
116: /// @notice New priority request event. Emitted when a request is placed into the priority queue
117: /// @param txId Serial number of the priority operation
118: /// @param txHash keccak256 hash of encoded transaction representation
119: /// @param expirationTimestamp Timestamp up to which priority request should be processed
120: /// @param transaction The whole transaction structure that is requested to be executed on L2
121: /// @param factoryDeps An array of bytecodes that were shown in the L1 public data.
122: /// Will be marked as known bytecodes in L2
131: /// @notice Emitted when the withdrawal is finalized on L1 and funds are released.
132: /// @param to The address to which the funds were sent
133: /// @param amount The amount of funds that were sent
```
[8](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L8) | [9](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L9) | [10](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L10) | [12](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L12) | [13](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L13) | [14](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L14) | [15](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L15) | [16](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L16) | [17](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L17) | [25](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L25) | [26](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L26) | [27](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L27) | [28](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L28) | [29](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L29) | [30](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L30) | [38](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L38) | [39](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L39) | [40](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L40) | [41](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L41) | [42](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L42) | [43](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L43) | [44](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L44) | [45](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L45) | [46](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L46) | [56](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L56) | [57](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L57) | [58](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L58) | [59](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L59) | [60](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L60) | [61](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L61) | [70](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L70) | [71](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L71) | [72](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L72) | [73](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L73) | [74](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L74) | [75](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L75) | [76](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L76) | [77](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L77) | [78](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L78) | [79](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L79) | [80](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L80) | [81](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L81) | [82](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L82) | [83](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L83) | [84](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L84) | [85](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L85) | [86](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L86) | [87](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L87) | [102](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L102) | [103](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L103) | [104](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L104) | [105](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L105) | [106](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L106) | [113](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L113) | [116](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L116) | [117](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L117) | [118](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L118) | [119](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L119) | [120](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L120) | [121](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L121) | [122](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L122) | [131](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L131) | [132](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L132) | [133](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L133)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IVerifier.sol

5: /// @notice Part of the configuration parameters of ZKP circuits
12: /// @title The interface of the Verifier contract, responsible for the zero knowledge proof verification.
13: /// @author Matter Labs
14: /// @custom:security-contact security@matterlabs.dev
16: /// @dev Verifies a zk-SNARK proof.
17: /// @return A boolean value indicating whether the zk-SNARK proof is valid.
18: /// Note: The function may revert execution instead of returning false in some cases.
25: /// @notice Calculates a keccak256 hash of the runtime loaded verification keys.
26: /// @return vkHash The keccak256 hash of the loaded verification keys.
```
[5](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IVerifier.sol#L5) | [12](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IVerifier.sol#L12) | [13](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IVerifier.sol#L13) | [14](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IVerifier.sol#L14) | [16](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IVerifier.sol#L16) | [17](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IVerifier.sol#L17) | [18](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IVerifier.sol#L18) | [25](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IVerifier.sol#L25) | [26](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IVerifier.sol#L26)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransitionBase.sol

4: /// @title The interface of the zkSync contract, responsible for the main zkSync logic.
5: /// @author Matter Labs
6: /// @custom:security-contact security@matterlabs.dev
8: /// @return Returns facet name.
```
[4](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransitionBase.sol#L4) | [5](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransitionBase.sol#L5) | [6](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransitionBase.sol#L6) | [8](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransitionBase.sol#L8)

```solidity
File: code/contracts/ethereum/contracts/common/Config.sol

5: /// @dev `keccak256("")`
8: /// @dev Bytes in raw L2 log
9: /// @dev Equal to the bytes size of the tuple - (uint8 ShardId, bool isService, uint16 txNumberInBatch, address sender,
10: /// bytes32 key, bytes32 value)
13: /// @dev The maximum length of the bytes array with L2 -> L1 logs
16: /// @dev The value of default leaf hash for L2 -> L1 logs Merkle tree
17: /// @dev An incomplete fixed-size tree is filled with this value to be a full binary tree
18: /// @dev Actually equal to the `keccak256(new bytes(L2_TO_L1_LOG_SERIALIZE_SIZE))`
24: /// @dev Denotes the type of the zkSync transaction that came from L1.
27: /// @dev Denotes the type of the zkSync transaction that is used for system upgrades.
30: /// @dev The maximal allowed difference between protocol versions in an upgrade. The 100 gap is needed
31: /// in case a protocol version has been tested on testnet, but then not launched on mainnet, e.g.
32: /// due to a bug found.
35: /// @dev The amount of time in seconds the validator has to process the priority transaction
36: /// NOTE: The constant is set to zero for the Alpha release period
39: /// @dev Timestamp - seconds since unix epoch.
42: /// @dev Maximum available error between real commit batch timestamp and analog used in the verifier (in seconds)
43: /// @dev Must be used cause miner's `block.timestamp` value can differ on some small value (as we know - 12 seconds)
46: /// @dev Shift to apply to verify public input before verifying.
49: /// @dev The maximum number of L2 gas that a user can request for an L2 transaction
52: /// @dev Even though the price for 1 byte of pubdata is 16 L1 gas, we have a slightly increased
53: /// value.
56: /// @dev The intrinsic cost of the L1->l2 transaction in computational L2 gas
59: /// @dev The intrinsic cost of the L1->l2 transaction in pubdata
62: /// @dev The minimal base price for L1 transaction
65: /// @dev The number of L2 gas the transaction starts costing more with each 544 bytes of encoding
68: /// @dev The number of L2 gas an L1->L2 transaction gains with each new factory dependency
71: /// @dev The number of L2 gas an L1->L2 transaction gains with each new factory dependency
74: /// @dev The number of pubdata an L1->L2 transaction requires with each new factory dependency
77: /// @dev The L2 gasPricePerPubdata required to be used in bridges.
80: /// @dev The mask which should be applied to the packed batch and L2 block timestamp in order
81: /// to obtain the L2 block timestamp. Applying this mask is equivalent to calculating modulo 2**128
84: /// @dev Address of the point evaluation precompile used for EIP-4844 blob verification.
87: /// @dev The overhead for a transaction slot in L2 gas.
88: /// It is roughly equal to 80kk/MAX_TRANSACTIONS_IN_BATCH, i.e. how many gas would an L1->L2 transaction
89: /// need to pay to compensate for the batch being closed.
90: /// @dev It is expected that the L1 contracts will enforce that the L2 gas price will be high enough to compensate
91: /// the operator in case the batch is closed because of tx slots filling up.
94: /// @dev The overhead for each byte of the bootloader memory that the encoding of the transaction.
95: /// It is roughly equal to 80kk/BOOTLOADER_MEMORY_FOR_TXS, i.e. how many gas would an L1->L2 transaction
96: /// need to pay to compensate for the batch being closed.
97: /// @dev It is expected that the L1 contracts will enforce that the L2 gas price will be high enough to compensate
98: /// the operator in case the batch is closed because of the memory for transactions being filled up.
103: /// @dev Era's chainID
106: /// @dev The address of legacy L1 ERC20 bridge.
109: /// @dev The address of zkSync Era diamond proxy contract.
114: /// @dev https://eips.ethereum.org/EIPS/eip-1352
```
[5](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L5) | [8](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L8) | [9](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L9) | [10](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L10) | [13](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L13) | [16](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L16) | [17](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L17) | [18](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L18) | [24](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L24) | [27](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L27) | [30](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L30) | [31](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L31) | [32](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L32) | [35](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L35) | [36](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L36) | [39](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L39) | [42](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L42) | [43](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L43) | [46](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L46) | [49](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L49) | [52](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L52) | [53](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L53) | [56](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L56) | [59](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L59) | [62](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L62) | [65](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L65) | [68](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L68) | [71](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L71) | [74](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L74) | [77](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L77) | [80](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L80) | [81](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L81) | [84](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L84) | [87](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L87) | [88](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L88) | [89](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L89) | [90](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L90) | [91](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L91) | [94](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L94) | [95](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L95) | [96](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L96) | [97](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L97) | [98](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L98) | [103](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L103) | [106](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L106) | [109](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L109) | [114](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L114)

```solidity
File: code/contracts/ethereum/contracts/common/L2ContractAddresses.sol

5: /// @dev The formal address of the initial program of the system: the bootloader
8: /// @dev The address of the known code storage system contract
11: /// @dev The address of the L2 deployer system contract.
14: /// @dev The special reserved L2 address. It is located in the system contracts space but doesn't have deployed
15: /// bytecode.
16: /// @dev The L2 deployer system contract allows changing bytecodes on any address if the `msg.sender` is this address.
17: /// @dev So, whenever the governor wants to redeploy system contracts, it just initiates the L1 upgrade call deployer
18: /// system contract
19: /// via the L1 -> L2 transaction with `sender == L2_FORCE_DEPLOYER_ADDR`. For more details see the
20: /// `diamond-initializers` contracts.
23: /// @dev The address of the special smart contract that can send arbitrary length message as an L2 log
26: /// @dev The address of the eth token system contract
29: /// @dev The address of the context system contract
32: /// @dev The address of the pubdata chunk publisher contract
```
[5](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/L2ContractAddresses.sol#L5) | [8](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/L2ContractAddresses.sol#L8) | [11](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/L2ContractAddresses.sol#L11) | [14](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/L2ContractAddresses.sol#L14) | [15](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/L2ContractAddresses.sol#L15) | [16](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/L2ContractAddresses.sol#L16) | [17](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/L2ContractAddresses.sol#L17) | [18](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/L2ContractAddresses.sol#L18) | [19](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/L2ContractAddresses.sol#L19) | [20](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/L2ContractAddresses.sol#L20) | [23](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/L2ContractAddresses.sol#L23) | [26](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/L2ContractAddresses.sol#L26) | [29](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/L2ContractAddresses.sol#L29) | [32](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/L2ContractAddresses.sol#L32)

```solidity
File: code/contracts/ethereum/contracts/common/Messaging.sol

5: /// @dev The enum that represents the transaction execution status
6: /// @param Failure The transaction execution failed
7: /// @param Success The transaction execution succeeded
13: /// @dev The log passed from L2
14: /// @param l2ShardId The shard identifier, 0 - rollup, 1 - porter
15: /// All other values are not used but are reserved for the future
16: /// @param isService A boolean flag that is part of the log along with `key`, `value`, and `sender` address.
17: /// This field is required formally but does not have any special meaning
18: /// @param txNumberInBatch The L2 transaction number in a Batch, in which the log was sent
19: /// @param sender The L2 address which sent the log
20: /// @param key The 32 bytes of information that was sent in the log
21: /// @param value The 32 bytes of information that was sent in the log
32: /// @dev An arbitrary length message passed from L2
33: /// @notice Under the hood it is `L2Log` sent from the special system L2 contract
34: /// @param txNumberInBatch The L2 transaction number in a Batch, in which the message was sent
35: /// @param sender The address of the L2 account from which the message was passed
36: /// @param data An arbitrary length message
43: /// @dev Internal structure that contains the parameters for the writePriorityOp
44: /// internal function.
45: /// @param sender The sender's address.
46: /// @param txId The id of the priority transaction.
47: /// @param l2Value The msg.value of the L2 transaction.
48: /// @param contractAddressL2 The address of the contract on L2 to call.
49: /// @param expirationTimestamp The timestamp by which the priority operation must be processed by the operator.
50: /// @param l2GasLimit The limit of the L2 gas for the L2 transaction
51: /// @param l2GasPricePerPubdata The price for a single pubdata byte in L2 gas.
52: /// @param valueToMint The amount of ether that should be minted on L2 as the result of this transaction.
53: /// @param refundRecipient The recipient of the refund for the transaction on L2. If the transaction fails, then
54: /// this address will receive the `l2Value`.
68: /// @dev Structure that includes all fields of the L2 transaction
69: /// @dev The hash of this structure is the "canonical L2 transaction hash" and can
70: /// be used as a unique identifier of a tx
71: /// @param txType The tx type number, depending on which the L2 transaction can be
72: /// interpreted differently
73: /// @param from The sender's address. `uint256` type for possible address format changes
74: /// and maintaining backward compatibility
75: /// @param to The recipient's address. `uint256` type for possible address format changes
76: /// and maintaining backward compatibility
77: /// @param gasLimit The L2 gas limit for L2 transaction. Analog to the `gasLimit` on an
78: /// L1 transactions
79: /// @param gasPerPubdataByteLimit Maximum number of L2 gas that will cost one byte of pubdata
80: /// (every piece of data that will be stored on L1 as calldata)
81: /// @param maxFeePerGas The absolute maximum sender willing to pay per unit of L2 gas to get
82: /// the transaction included in a Batch. Analog to the EIP-1559 `maxFeePerGas` on an L1 transactions
83: /// @param maxPriorityFeePerGas The additional fee that is paid directly to the validator
84: /// to incentivize them to include the transaction in a Batch. Analog to the EIP-1559
85: /// `maxPriorityFeePerGas` on an L1 transactions
86: /// @param paymaster The address of the EIP-4337 paymaster, that will pay fees for the
87: /// transaction. `uint256` type for possible address format changes and maintaining backward compatibility
88: /// @param nonce The nonce of the transaction. For L1->L2 transactions it is the priority
89: /// operation Id
90: /// @param value The value to pass with the transaction
91: /// @param reserved The fixed-length fields for usage in a future extension of transaction
92: /// formats
93: /// @param data The calldata that is transmitted for the transaction call
94: /// @param signature An abstract set of bytes that are used for transaction authorization
95: /// @param factoryDeps The set of L2 bytecode hashes whose preimages were shown on L1
96: /// @param paymasterInput The arbitrary-length data that is used as a calldata to the paymaster pre-call
97: /// @param reservedDynamic The arbitrary-length field for usage in a future extension of transaction formats
```
[5](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Messaging.sol#L5) | [6](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Messaging.sol#L6) | [7](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Messaging.sol#L7) | [13](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Messaging.sol#L13) | [14](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Messaging.sol#L14) | [15](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Messaging.sol#L15) | [16](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Messaging.sol#L16) | [17](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Messaging.sol#L17) | [18](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Messaging.sol#L18) | [19](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Messaging.sol#L19) | [20](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Messaging.sol#L20) | [21](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Messaging.sol#L21) | [32](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Messaging.sol#L32) | [33](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Messaging.sol#L33) | [34](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Messaging.sol#L34) | [35](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Messaging.sol#L35) | [36](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Messaging.sol#L36) | [43](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Messaging.sol#L43) | [44](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Messaging.sol#L44) | [45](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Messaging.sol#L45) | [46](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Messaging.sol#L46) | [47](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Messaging.sol#L47) | [48](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Messaging.sol#L48) | [49](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Messaging.sol#L49) | [50](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Messaging.sol#L50) | [51](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Messaging.sol#L51) | [52](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Messaging.sol#L52) | [53](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Messaging.sol#L53) | [54](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Messaging.sol#L54) | [68](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Messaging.sol#L68) | [69](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Messaging.sol#L69) | [70](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Messaging.sol#L70) | [71](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Messaging.sol#L71) | [72](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Messaging.sol#L72) | [73](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Messaging.sol#L73) | [74](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Messaging.sol#L74) | [75](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Messaging.sol#L75) | [76](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Messaging.sol#L76) | [77](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Messaging.sol#L77) | [78](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Messaging.sol#L78) | [79](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Messaging.sol#L79) | [80](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Messaging.sol#L80) | [81](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Messaging.sol#L81) | [82](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Messaging.sol#L82) | [83](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Messaging.sol#L83) | [84](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Messaging.sol#L84) | [85](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Messaging.sol#L85) | [86](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Messaging.sol#L86) | [87](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Messaging.sol#L87) | [88](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Messaging.sol#L88) | [89](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Messaging.sol#L89) | [90](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Messaging.sol#L90) | [91](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Messaging.sol#L91) | [92](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Messaging.sol#L92) | [93](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Messaging.sol#L93) | [94](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Messaging.sol#L94) | [95](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Messaging.sol#L95) | [96](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Messaging.sol#L96) | [97](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Messaging.sol#L97)

```solidity
File: code/contracts/ethereum/contracts/common/ReentrancyGuard.sol

26: /// @dev Address of lock flag variable.
27: /// @dev Flag is placed at random memory location to not interfere with Storage contract.
```
[26](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/ReentrancyGuard.sol#L26) | [27](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/ReentrancyGuard.sol#L27)

```solidity
File: code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol

24: /// @notice Utility function converts the address that submitted a tx
25: /// to the inbox on L1 to the msg.sender viewed on L2
26: /// @param l1Address the address in the L1 that triggered the tx to L2
27: /// @return l2Address L2 address as viewed in msg.sender
34: /// @notice Utility function that converts the msg.sender viewed on L2 to the
35: /// address that submitted a tx to the inbox on L1
36: /// @param l2Address L2 address as viewed in msg.sender
37: /// @return l1Address the address in the L1 that triggered the tx to L2
```
[24](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol#L24) | [25](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol#L25) | [26](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol#L26) | [27](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol#L27) | [34](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol#L34) | [35](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol#L35) | [36](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol#L36) | [37](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol#L37)

```solidity
File: code/system-contracts/contracts/AccountCodeStorage.sol

30: /// @notice Stores the bytecodeHash of constructing contract.
31: /// @param _address The address of the account to set the codehash to.
32: /// @param _hash The new bytecode hash of the constructing account.
33: /// @dev This method trusts the ContractDeployer to make sure that the bytecode is known and well-formed,
34: /// but checks whether the bytecode hash corresponds to the constructing smart contract.
41: /// @notice Stores the bytecodeHash of constructed contract.
42: /// @param _address The address of the account to set the codehash to.
43: /// @param _hash The new bytecode hash of the constructed account.
44: /// @dev This method trusts the ContractDeployer to make sure that the bytecode is known and well-formed,
45: /// but checks whether the bytecode hash corresponds to the constructed smart contract.
52: /// @notice Marks the account bytecodeHash as constructed.
53: /// @param _address The address of the account to mark as constructed
65: /// @dev Store the codehash of the account without any checks.
66: /// @param _address The address of the account to set the codehash to.
67: /// @param _hash The new account bytecode hash.
75: /// @notice Get the codehash stored for an address.
76: /// @param _address The address of the account of which the codehash to return
77: /// @return codeHash The codehash stored for this account.
86: /// @notice Simulate the behavior of the `extcodehash` EVM opcode.
87: /// @param _input The 256-bit account address.
88: /// @return codeHash - hash of the bytecode according to the EIP-1052 specification.
114: /// @notice Simulate the behavior of the `extcodesize` EVM opcode.
115: /// @param _input The 256-bit account address.
116: /// @return codeSize - the size of the deployed smart contract in bytes.
```
[30](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/AccountCodeStorage.sol#L30) | [31](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/AccountCodeStorage.sol#L31) | [32](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/AccountCodeStorage.sol#L32) | [33](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/AccountCodeStorage.sol#L33) | [34](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/AccountCodeStorage.sol#L34) | [41](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/AccountCodeStorage.sol#L41) | [42](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/AccountCodeStorage.sol#L42) | [43](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/AccountCodeStorage.sol#L43) | [44](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/AccountCodeStorage.sol#L44) | [45](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/AccountCodeStorage.sol#L45) | [52](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/AccountCodeStorage.sol#L52) | [53](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/AccountCodeStorage.sol#L53) | [65](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/AccountCodeStorage.sol#L65) | [66](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/AccountCodeStorage.sol#L66) | [67](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/AccountCodeStorage.sol#L67) | [75](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/AccountCodeStorage.sol#L75) | [76](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/AccountCodeStorage.sol#L76) | [77](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/AccountCodeStorage.sol#L77) | [86](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/AccountCodeStorage.sol#L86) | [87](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/AccountCodeStorage.sol#L87) | [88](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/AccountCodeStorage.sol#L88) | [114](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/AccountCodeStorage.sol#L114) | [115](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/AccountCodeStorage.sol#L115) | [116](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/AccountCodeStorage.sol#L116)

```solidity
File: code/system-contracts/contracts/BootloaderUtilities.sol

19: /// @notice Calculates the canonical transaction hash and the recommended transaction hash.
20: /// @param _transaction The transaction.
21: /// @return txHash and signedTxHash of the transaction, i.e. the transaction hash to be used in the explorer and commits to all
22: /// the fields of the transaction and the recommended hash to be signed for this transaction.
23: /// @dev txHash must be unique for all transactions.
41: /// @notice Calculates the hash for a legacy transaction.
42: /// @param _transaction The legacy transaction.
43: /// @return txHash The hash of the transaction.
136: /// @notice Calculates the hash for an EIP2930 transaction.
137: /// @param _transaction The EIP2930 transaction.
138: /// @return txHash The hash of the transaction.
226: /// @notice Calculates the hash for an EIP1559 transaction.
227: /// @param _transaction The legacy transaction.
228: /// @return txHash The hash of the transaction.
```
[19](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L19) | [20](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L20) | [21](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L21) | [22](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L22) | [23](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L23) | [41](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L41) | [42](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L42) | [43](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L43) | [136](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L136) | [137](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L137) | [138](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L138) | [226](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L226) | [227](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L227) | [228](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L228)

```solidity
File: code/system-contracts/contracts/ComplexUpgrader.sol

15: /// @notice Executes an upgrade process by delegating calls to another contract.
16: /// @dev This function allows only the `FORCE_DEPLOYER` to initiate the upgrade.
17: /// If the delegate call fails, the function will revert the transaction, returning the error message
18: /// provided by the delegated contract.
19: /// @param _delegateTo the address of the contract to which the calls will be delegated
20: /// @param _calldata the calldata to be delegate called in the `_delegateTo` contract
```
[15](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ComplexUpgrader.sol#L15) | [16](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ComplexUpgrader.sol#L16) | [17](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ComplexUpgrader.sol#L17) | [18](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ComplexUpgrader.sol#L18) | [19](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ComplexUpgrader.sol#L19) | [20](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ComplexUpgrader.sol#L20)

```solidity
File: code/system-contracts/contracts/Compressor.sol

25: /// @notice Verify the compressed bytecode and publish it on the L1.
26: /// @param _bytecode The original bytecode to be verified against.
27: /// @param _rawCompressedData The compressed bytecode in a format of:
28: ///    - 2 bytes: the length of the dictionary
29: ///    - N bytes: the dictionary
30: ///    - M bytes: the encoded data
31: /// @return bytecodeHash The hash of the original bytecode.
32: /// @dev The dictionary is a sequence of 8-byte chunks, each of them has the associated index.
33: /// @dev The encoded data is a sequence of 2-byte chunks, each of them is an index of the dictionary.
34: /// @dev The compression algorithm works as follows:
35: ///     1. The original bytecode is split into 8-byte chunks.
36: ///     Since the bytecode size is always a multiple of 32, this is always possible.
37: ///     2. For each 8-byte chunk in the original bytecode:
38: ///         * If the chunk is not already in the dictionary, it is added to the dictionary array.
39: ///         * If the dictionary becomes overcrowded (2^16 + 1 elements), the compression process will fail.
40: ///         * The 2-byte index of the chunk in the dictionary is added to the encoded data.
41: /// @dev Currently, the method may be called only from the bootloader because the server is not ready to publish bytecodes
42: /// in internal transactions. However, in the future, we will allow everyone to publish compressed bytecodes.
43: /// @dev Read more about the compression: https://github.com/matter-labs/zksync-era/blob/main/docs/guides/advanced/compression.md
77: /// @notice Verifies that the compression of state diffs has been done correctly for the {_stateDiffs} param.
78: /// @param _numberOfStateDiffs The number of state diffs being checked.
79: /// @param _enumerationIndexSize Number of bytes used to represent an enumeration index for repeated writes.
80: /// @param _stateDiffs Encoded full state diff structs. See the first dev comment below for encoding.
81: /// @param _compressedStateDiffs The compressed state diffs
82: /// @dev We don't verify that the size of {_stateDiffs} is equivalent to {_numberOfStateDiffs} * STATE_DIFF_ENTRY_SIZE since that check is
83: ///      done within the L1Messenger calling contract.
84: /// @return stateDiffHash Hash of the encoded (uncompressed) state diffs to be committed to via system log.
85: /// @dev This check assumes that the ordering of state diffs are sorted by (address, key) for the encoded state diffs and
86: ///      then the compressed are sorted the same but with all the initial writes coming before the repeated writes.
87: /// @dev state diff:   [20bytes address][32bytes key][32bytes derived key][8bytes enum index][32bytes initial value][32bytes final value]
88: /// @dev The compression format:
89: ///     - 2 bytes: number of initial writes
90: ///     - N bytes initial writes
91: ///         - 32 bytes derived key
92: ///         - 1 byte metadata:
93: ///             - first 5 bits: length in bytes of compressed value
94: ///             - last 3 bits: operation
95: ///                 - 0 -> Nothing (32 bytes)
96: ///                 - 1 -> Add
97: ///                 - 2 -> Subtract
98: ///                 - 3 -> Transform (< 32 bytes)
99: ///         - Len Bytes: Compressed Value
100: ///     - M bytes repeated writes
101: ///         - {_enumerationIndexSize} bytes for enumeration index
102: ///         - 1 byte metadata:
103: ///             - first 5 bits: length in bytes of compressed value
104: ///             - last 3 bits: operation
105: ///                 - 0 -> Nothing (32 bytes)
106: ///                 - 1 -> Add
107: ///                 - 2 -> Subtract
108: ///                 - 3 -> Transform (< 32 bytes)
109: ///         - Len Bytes: Compressed Value
192: /// @notice Decode the raw compressed data into the dictionary and the encoded data.
193: /// @param _rawCompressedData The compressed bytecode in a format of:
194: ///    - 2 bytes: the bytes length of the dictionary
195: ///    - N bytes: the dictionary
196: ///    - M bytes: the encoded data
208: /// @notice Verify value compression was done correct given initial value, final value, operation, and compressed value
209: /// @param _initialValue Previous value of key/enumeration index.
210: /// @param _finalValue Updated value of key/enumeration index.
211: /// @param _operation The operation that was performed on value.
212: /// @param _compressedValue The slice of calldata with compressed value either representing the final
213: /// value or difference between initial and final value. It should be of arbitrary length less than or equal to 32 bytes.
214: /// @dev It is the responsibility of the caller of this function to ensure that the `_compressedValue` has length no longer than 32 bytes.
215: /// @dev Operation id mapping:
216: /// 0 -> Nothing (32 bytes)
217: /// 1 -> Add
218: /// 2 -> Subtract
219: /// 3 -> Transform (< 32 bytes)
247: /// @notice Converts a calldata slice into uint256. It is the responsibility of the caller to ensure that
248: /// the _calldataSlice has length no longer than 32 bytes
249: /// @param _calldataSlice The calldata slice to convert to uint256
250: /// @return number The uint256 representation of the calldata slice
```
[25](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L25) | [26](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L26) | [27](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L27) | [28](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L28) | [29](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L29) | [30](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L30) | [31](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L31) | [32](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L32) | [33](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L33) | [34](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L34) | [35](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L35) | [36](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L36) | [37](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L37) | [38](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L38) | [39](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L39) | [40](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L40) | [41](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L41) | [42](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L42) | [43](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L43) | [77](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L77) | [78](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L78) | [79](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L79) | [80](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L80) | [81](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L81) | [82](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L82) | [83](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L83) | [84](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L84) | [85](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L85) | [86](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L86) | [87](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L87) | [88](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L88) | [89](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L89) | [90](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L90) | [91](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L91) | [92](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L92) | [93](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L93) | [94](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L94) | [95](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L95) | [96](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L96) | [97](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L97) | [98](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L98) | [99](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L99) | [100](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L100) | [101](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L101) | [102](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L102) | [103](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L103) | [104](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L104) | [105](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L105) | [106](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L106) | [107](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L107) | [108](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L108) | [109](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L109) | [192](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L192) | [193](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L193) | [194](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L194) | [195](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L195) | [196](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L196) | [208](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L208) | [209](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L209) | [210](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L210) | [211](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L211) | [212](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L212) | [213](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L213) | [214](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L214) | [215](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L215) | [216](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L216) | [217](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L217) | [218](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L218) | [219](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L219) | [247](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L247) | [248](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L248) | [249](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L249) | [250](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L250)

```solidity
File: code/system-contracts/contracts/Constants.sol

18: /// @dev All the system contracts introduced by zkSync have their addresses
19: /// started from 2^15 in order to avoid collision with Ethereum precompiles.
22: /// @dev Unlike the value above, it is not overridden for the purpose of testing and
23: /// is identical to the constant value actually used as the system contracts offset on
24: /// mainnet.
27: /// @dev All the system contracts must be located in the kernel space,
28: /// i.e. their addresses must be below 2^16.
37: /// @dev The number of ergs that need to be spent for a single byte of pubdata regardless of the pubdata price.
38: /// This variable is used to ensure the following:
39: /// - That the long-term storage of the operator is compensated properly.
40: /// - That it is not possible that the pubdata counter grows too high without spending proportional amount of computation.
43: /// @dev The maximal possible address of an L1-like precompie. These precompiles maintain the following properties:
44: /// - Their extcodehash is EMPTY_STRING_KECCAK
45: /// - Their extcodesize is 0 despite having a bytecode formally deployed there.
89: /// @dev If the bitwise AND of the extraAbi[2] param when calling the MSG_VALUE_SIMULATOR
90: /// is non-zero, the call will be assumed to be a system one.
93: /// @dev The maximal msg.value that context can have
96: /// @dev Prefix used during derivation of account addresses using CREATE2
97: /// @dev keccak256("zksyncCreate2")
99: /// @dev Prefix used during derivation of account addresses using CREATE
100: /// @dev keccak256("zksyncCreate")
103: /// @dev Each state diff consists of 156 bytes of actual data and 116 bytes of unused padding, needed for circuit efficiency.
106: /// @dev While the "real" amount of pubdata that can be sent rarely exceeds the BLOB_SIZE_BYTES * MAX_NUMBER_OF_BLOBS, it is better to
107: /// allow the operator to provide any reasonably large value in order to avoid unneeded constraints on the operator.
123: /// @dev The number of leaves in the L2->L1 log Merkle tree.
124: /// While formally a tree of any length is acceptable, the node supports only a constant length of 4096 leaves.
127: /// @dev The length of the derived key in bytes inside compressed state diffs.
129: /// @dev The length of the enum index in bytes inside compressed state diffs.
131: /// @dev The length of value in bytes inside compressed state diffs.
134: /// @dev The length of the compressed initial storage write in bytes.
136: /// @dev The length of the compressed repeated storage write in bytes.
139: /// @dev The position from which the initial writes start in the compressed state diffs.
142: /// @dev Each storage diffs consists of the following elements:
143: /// [20bytes address][32bytes key][32bytes derived key][8bytes enum index][32bytes initial value][32bytes final value]
144: /// @dev The offset of the deriived key in a storage diff.
146: /// @dev The offset of the enum index in a storage diff.
148: /// @dev The offset of the final value in a storage diff.
151: /// @dev Total number of bytes in a blob. Blob = 4096 field elements * 31 bytes per field element
152: /// @dev EIP-4844 defines it as 131_072 but we use 4096 * 31 within our circuits to always fit within a field element
153: /// @dev Our circuits will prove that a EIP-4844 blob and our internal blob are the same.
156: /// @dev Max number of blobs currently supported
```
[18](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L18) | [19](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L19) | [22](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L22) | [23](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L23) | [24](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L24) | [27](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L27) | [28](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L28) | [37](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L37) | [38](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L38) | [39](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L39) | [40](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L40) | [43](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L43) | [44](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L44) | [45](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L45) | [89](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L89) | [90](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L90) | [93](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L93) | [96](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L96) | [97](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L97) | [99](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L99) | [100](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L100) | [103](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L103) | [106](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L106) | [107](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L107) | [123](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L123) | [124](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L124) | [127](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L127) | [129](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L129) | [131](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L131) | [134](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L134) | [136](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L136) | [139](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L139) | [142](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L142) | [143](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L143) | [144](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L144) | [146](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L146) | [148](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L148) | [151](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L151) | [152](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L152) | [153](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L153) | [156](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L156)

```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

24: /// @notice Information about an account contract.
25: /// @dev For EOA and simple contracts (i.e. not accounts) this value is 0.
33: /// @notice Returns information about a certain account.
38: /// @notice Returns the account abstraction version if `_address` is a deployed contract.
39: /// Returns the latest supported account abstraction version if `_address` is an EOA.
57: /// @notice Stores the new account information
62: /// @notice Update the used version of the account.
63: /// @param _version The new version of the AA protocol to use.
64: /// @dev Note that it allows changes from account to non-account and vice versa.
71: /// @notice Updates the nonce ordering of the account. Currently,
72: /// it only allows changes from sequential to arbitrary ordering.
73: /// @param _nonceOrdering The new nonce ordering to use.
89: /// @notice Calculates the address of a deployed contract via create2
90: /// @param _sender The account that deploys the contract.
91: /// @param _bytecodeHash The correctly formatted hash of the bytecode.
92: /// @param _salt The create2 salt.
93: /// @param _input The constructor data.
94: /// @return newAddress The derived address of the account.
112: /// @notice Calculates the address of a deployed contract via create
113: /// @param _sender The account that deploys the contract.
114: /// @param _senderNonce The deploy nonce of the sender's account.
128: /// @notice Deploys a contract with similar address derivation rules to the EVM's `CREATE2` opcode.
129: /// @param _salt The CREATE2 salt
130: /// @param _bytecodeHash The correctly formatted hash of the bytecode.
131: /// @param _input The constructor calldata
140: /// @notice Deploys a contract with similar address derivation rules to the EVM's `CREATE` opcode.
141: /// @param _bytecodeHash The correctly formatted hash of the bytecode.
142: /// @param _input The constructor calldata
143: /// @dev This method also accepts nonce as one of its parameters.
144: /// It is not used anywhere and it needed simply for the consistency for the compiler
145: /// Note: this method may be callable only in system mode,
146: /// that is checked in the `createAccount` by `onlySystemCall` modifier.
155: /// @notice Deploys a contract account with similar address derivation rules to the EVM's `CREATE2` opcode.
156: /// @param _salt The CREATE2 salt
157: /// @param _bytecodeHash The correctly formatted hash of the bytecode.
158: /// @param _input The constructor calldata.
159: /// @param _aaVersion The account abstraction version to use.
160: /// Note: this method may be callable only in system mode,
161: /// that is checked in the `createAccount` by `onlySystemCall` modifier.
176: /// @notice Deploys a contract account with similar address derivation rules to the EVM's `CREATE` opcode.
177: /// @param _bytecodeHash The correctly formatted hash of the bytecode.
178: /// @param _input The constructor calldata.
179: /// @param _aaVersion The account abstraction version to use.
180: /// @dev This method also accepts salt as one of its parameters.
181: /// It is not used anywhere and it needed simply for the consistency for the compiler
196: /// @notice A struct that describes a forced deployment on an address
210: /// @notice The method that can be used to forcefully deploy a contract.
211: /// @param _deployment Information about the forced deployment.
212: /// @param _sender The `msg.sender` inside the constructor call.
235: /// @notice This method is to be used only during an upgrade to set bytecodes on specific addresses.
236: /// @dev We do not require `onlySystemCall` here, since the method is accessible only
237: /// by `FORCE_DEPLOYER`.
278: /// @notice Deploy a certain bytecode on the address.
279: /// @param _bytecodeHash The correctly formatted hash of the bytecode.
280: /// @param _newAddress The address of the contract to be deployed.
281: /// @param _aaVersion The version of the account abstraction protocol to use.
282: /// @param _input The constructor calldata.
300: /// @notice Check that bytecode hash is marked as known on the `KnownCodeStorage` system contracts
306: /// @notice Ensures that the _newAddress and assigns a new contract hash to it
307: /// @param _newAddress The address of the deployed contract
308: /// @param _bytecodeHash The correctly formatted hash of the bytecode.
315: /// @notice Transfers the `msg.value` ETH to the deployed account & invokes its constructor.
316: /// This function must revert in case the deployment fails.
317: /// @param _sender The msg.sender to be used in the constructor
318: /// @param _newAddress The address of the deployed contract
319: /// @param _input The constructor calldata
320: /// @param _isSystem Whether the call should be a system call (could be possibly required in the future).
```
[24](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L24) | [25](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L25) | [33](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L33) | [38](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L38) | [39](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L39) | [57](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L57) | [62](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L62) | [63](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L63) | [64](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L64) | [71](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L71) | [72](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L72) | [73](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L73) | [89](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L89) | [90](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L90) | [91](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L91) | [92](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L92) | [93](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L93) | [94](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L94) | [112](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L112) | [113](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L113) | [114](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L114) | [128](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L128) | [129](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L129) | [130](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L130) | [131](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L131) | [140](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L140) | [141](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L141) | [142](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L142) | [143](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L143) | [144](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L144) | [145](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L145) | [146](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L146) | [155](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L155) | [156](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L156) | [157](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L157) | [158](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L158) | [159](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L159) | [160](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L160) | [161](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L161) | [176](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L176) | [177](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L177) | [178](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L178) | [179](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L179) | [180](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L180) | [181](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L181) | [196](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L196) | [210](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L210) | [211](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L211) | [212](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L212) | [235](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L235) | [236](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L236) | [237](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L237) | [278](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L278) | [279](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L279) | [280](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L280) | [281](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L281) | [282](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L282) | [300](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L300) | [306](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L306) | [307](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L307) | [308](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L308) | [315](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L315) | [316](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L316) | [317](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L317) | [318](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L318) | [319](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L319) | [320](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L320)

```solidity
File: code/system-contracts/contracts/DefaultAccount.sol

58: /// @notice Validates the transaction & increments nonce.
59: /// @dev The transaction is considered accepted by the account if
60: /// the call to this function by the bootloader does not revert
61: /// and the nonce has been set as used.
62: /// @param _suggestedSignedHash The suggested hash of the transaction to be signed by the user.
63: /// This is the hash that is signed by the EOA by default.
64: /// @param _transaction The transaction structure itself.
65: /// @dev Besides the params above, it also accepts unused first paramter "_txHash", which
66: /// is the unique (canonical) hash of the transaction.
75: /// @notice Inner method for validating transaction and increasing the nonce
76: /// @param _suggestedSignedHash The hash of the transaction signed by the EOA
77: /// @param _transaction The transaction.
107: /// @notice Method called by the bootloader to execute the transaction.
108: /// @param _transaction The transaction to execute.
109: /// @dev It also accepts unused _txHash and _suggestedSignedHash parameters:
110: /// the unique (canonical) hash of the transaction and the suggested signed
111: /// hash of the transaction.
120: /// @notice Method that should be used to initiate a transaction from this account by an external call.
121: /// @dev The custom account is supposed to implement this method to initiate a transaction on behalf
122: /// of the account via L1 -> L2 communication. However, the default account can initiate a transaction
123: /// from L1, so we formally implement the interface method, but it doesn't execute any logic.
124: /// @param _transaction The transaction to execute.
129: /// @notice Inner method for executing a transaction.
130: /// @param _transaction The transaction to execute.
155: /// @notice Validation that the ECDSA signature of the transaction is correct.
156: /// @param _hash The hash of the transaction to be signed.
157: /// @param _signature The signature of the transaction.
158: /// @return EIP1271_SUCCESS_RETURN_VALUE if the signaure is correct. It reverts otherwise.
191: /// @notice Method for paying the bootloader for the transaction.
192: /// @param _transaction The transaction for which the fee is paid.
193: /// @dev It also accepts unused _txHash and _suggestedSignedHash parameters:
194: /// the unique (canonical) hash of the transaction and the suggested signed
195: /// hash of the transaction.
205: /// @notice Method, where the user should prepare for the transaction to be
206: /// paid for by a paymaster.
207: /// @dev Here, the account should set the allowance for the smart contracts
208: /// @param _transaction The transaction.
209: /// @dev It also accepts unused _txHash and _suggestedSignedHash parameters:
210: /// the unique (canonical) hash of the transaction and the suggested signed
211: /// hash of the transaction.
```
[58](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L58) | [59](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L59) | [60](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L60) | [61](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L61) | [62](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L62) | [63](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L63) | [64](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L64) | [65](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L65) | [66](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L66) | [75](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L75) | [76](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L76) | [77](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L77) | [107](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L107) | [108](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L108) | [109](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L109) | [110](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L110) | [111](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L111) | [120](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L120) | [121](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L121) | [122](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L122) | [123](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L123) | [124](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L124) | [129](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L129) | [130](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L130) | [155](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L155) | [156](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L156) | [157](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L157) | [158](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L158) | [191](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L191) | [192](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L192) | [193](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L193) | [194](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L194) | [195](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L195) | [205](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L205) | [206](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L206) | [207](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L207) | [208](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L208) | [209](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L209) | [210](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L210) | [211](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L211)

```solidity
File: code/system-contracts/contracts/ImmutableSimulator.sol

19: /// @dev mapping (contract address) => (index of immutable variable) => value
20: /// @notice that address uses `uint256` type to leave the option to introduce 32-byte address space in future.
23: /// @notice Method that returns the immutable with a certain index for a user.
24: /// @param _dest The address which the immutable belongs to.
25: /// @param _index The index of the immutable.
26: /// @return The value of the immutables.
31: /// @notice Method used by the contract deployer to store the immutables for an account
32: /// @param _dest The address which to store the immutables for.
33: /// @param _immutables The list of the immutables.
```
[19](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ImmutableSimulator.sol#L19) | [20](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ImmutableSimulator.sol#L20) | [23](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ImmutableSimulator.sol#L23) | [24](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ImmutableSimulator.sol#L24) | [25](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ImmutableSimulator.sol#L25) | [26](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ImmutableSimulator.sol#L26) | [31](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ImmutableSimulator.sol#L31) | [32](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ImmutableSimulator.sol#L32) | [33](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ImmutableSimulator.sol#L33)

```solidity
File: code/system-contracts/contracts/KnownCodesStorage.sol

24: /// @notice The method that is used by the bootloader to mark several bytecode hashes as known.
25: /// @param _shouldSendToL1 Whether the bytecode should be sent on L1.
26: /// @param _hashes Hashes of the bytecodes to be marked as known.
36: /// @notice The method used to mark a single bytecode hash as known.
37: /// @dev Only trusted contacts can call this method, currently only the bytecode compressor.
38: /// @param _bytecodeHash The hash of the bytecode that is marked as known.
43: /// @notice The method used to mark a single bytecode hash as known
44: /// @param _bytecodeHash The hash of the bytecode that is marked as known
45: /// @param _shouldSendToL1 Whether the bytecode should be sent on L1
63: /// @notice Returns the marker stored for a bytecode hash. 1 means that the bytecode hash is known
64: /// and can be used for deploying contracts. 0 otherwise.
71: /// @notice Validates the format of bytecodehash
72: /// @dev zk-circuit accepts & handles only valid format of bytecode hash, other input has undefined behavior
73: /// That's why we need to validate it
```
[24](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/KnownCodesStorage.sol#L24) | [25](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/KnownCodesStorage.sol#L25) | [26](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/KnownCodesStorage.sol#L26) | [36](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/KnownCodesStorage.sol#L36) | [37](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/KnownCodesStorage.sol#L37) | [38](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/KnownCodesStorage.sol#L38) | [43](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/KnownCodesStorage.sol#L43) | [44](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/KnownCodesStorage.sol#L44) | [45](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/KnownCodesStorage.sol#L45) | [63](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/KnownCodesStorage.sol#L63) | [64](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/KnownCodesStorage.sol#L64) | [71](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/KnownCodesStorage.sol#L71) | [72](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/KnownCodesStorage.sol#L72) | [73](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/KnownCodesStorage.sol#L73)

```solidity
File: code/system-contracts/contracts/L1Messenger.sol

26: /// @notice Sequential hash of logs sent in the current block.
27: /// @dev Will be reset at the end of the block to zero value.
30: /// @notice Number of logs sent in the current block.
31: /// @dev Will be reset at the end of the block to zero value.
34: /// @notice Sequential hash of hashes of the messages sent in the current block.
35: /// @dev Will be reset at the end of the block to zero value.
38: /// @notice Sequential hash of bytecode hashes that needs to published
39: /// according to the current block execution invariant.
40: /// @dev Will be reset at the end of the block to zero value.
43: /// The gas cost of processing one keccak256 round.
46: /// The number of bytes processed in one keccak256 round.
49: /// The gas cost of calculation of keccak256 of bytes array of such length.
54: /// The gas cost of processing one sha256 round.
57: /// The number of bytes processed in one sha256 round.
60: /// The gas cost of calculation of sha256 of bytes array of such length.
65: /// @notice Sends L2ToL1Log.
66: /// @param _isService The `isService` flag.
67: /// @param _key The `key` part of the L2Log.
68: /// @param _value The `value` part of the L2Log.
69: /// @dev Can be called only by a system contract.
93: /// @notice Internal function to send L2ToL1Log.
114: /// @notice Public functionality to send messages to L1.
115: /// @param _message The message intended to be sent to L1.
121: /// Store message record
124: /// Store log record
159: /// @dev Can be called only by KnownCodesStorage system contract.
160: /// @param _bytecodeHash Hash of bytecode being published to L1.
184: /// @notice Verifies that the {_totalL2ToL1PubdataAndStateDiffs} reflects what occurred within the L1Batch and that
185: ///         the compressed statediffs are equivalent to the full state diffs.
186: /// @param _totalL2ToL1PubdataAndStateDiffs The total pubdata and uncompressed state diffs of transactions that were
187: ///        processed in the current L1 Batch. Pubdata consists of L2 to L1 Logs, messages, deployed bytecode, and state diffs.
188: /// @dev Function that should be called exactly once per L1 Batch by the bootloader.
189: /// @dev Checks that totalL2ToL1Pubdata is strictly packed data that should to be published to L1.
190: /// @dev The data passed in also contains the encoded state diffs to be checked again, however this is aux data that is not
191: ///      part of the committed pubdata.
192: /// @dev Performs calculation of L2ToL1Logs merkle tree root, "sends" such root and keccak256(totalL2ToL1Pubdata)
193: /// to L1 using low-level (VM) L2Log.
199: /// Check logs
232: /// Check messages
250: /// Check bytecodes
274: /// Check State Diffs
275: /// encoding is as follows:
276: /// header (1 byte version, 3 bytes total len of compressed, 1 byte enumeration index size)
277: /// body (`compressedStateDiffSize` bytes, 4 bytes number of state diffs, `numberOfStateDiffs` * `STATE_DIFF_ENTRY_SIZE` bytes for the uncompressed state diffs)
278: /// encoded state diffs: [20bytes address][32bytes key][32bytes derived key][8bytes enum index][32bytes initial value][32bytes final value]
314: /// Check for calldata strict format
319: /// Native (VM) L2 to L1 log
328: /// Clear logs state
```
[26](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L26) | [27](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L27) | [30](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L30) | [31](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L31) | [34](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L34) | [35](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L35) | [38](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L38) | [39](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L39) | [40](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L40) | [43](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L43) | [46](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L46) | [49](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L49) | [54](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L54) | [57](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L57) | [60](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L60) | [65](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L65) | [66](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L66) | [67](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L67) | [68](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L68) | [69](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L69) | [93](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L93) | [114](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L114) | [115](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L115) | [121](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L121) | [124](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L124) | [159](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L159) | [160](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L160) | [184](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L184) | [185](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L185) | [186](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L186) | [187](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L187) | [188](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L188) | [189](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L189) | [190](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L190) | [191](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L191) | [192](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L192) | [193](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L193) | [199](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L199) | [232](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L232) | [250](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L250) | [274](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L274) | [275](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L275) | [276](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L276) | [277](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L277) | [278](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L278) | [314](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L314) | [319](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L319) | [328](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L328)

```solidity
File: code/system-contracts/contracts/L2BaseToken.sol

19: /// @notice The balances of the users.
22: /// @notice The total amount of tokens that have been minted.
25: /// @notice Transfer tokens from one address to another.
26: /// @param _from The address to transfer the ETH from.
27: /// @param _to The address to transfer the ETH to.
28: /// @param _amount The amount of ETH in wei being transferred.
29: /// @dev This function can be called only by trusted system contracts.
30: /// @dev This function also emits "Transfer" event, which might be removed
31: /// later on.
52: /// @notice Returns ETH balance of an account
53: /// @dev It takes `uint256` as an argument to be able to properly simulate the behaviour of the
54: /// Ethereum's `BALANCE` opcode that accepts uint256 as an argument and truncates any upper bits
55: /// @param _account The address of the account to return the balance of.
60: /// @notice Increase the total supply of tokens and balance of the receiver.
61: /// @dev This method is only callable by the bootloader.
62: /// @param _account The address which to mint the funds to.
63: /// @param _amount The amount of ETH in wei to be minted.
70: /// @notice Initiate the ETH withdrawal, funds will be available to claim on L1 `finalizeEthWithdrawal` method.
71: /// @param _l1Receiver The address on L1 to receive the funds.
82: /// @notice Initiate the ETH withdrawal, with the sent message. The funds will be available to claim on L1 `finalizeEthWithdrawal` method.
83: /// @param _l1Receiver The address on L1 to receive the funds.
84: /// @param _additionalData Additional data to be sent to L1 with the withdrawal.
95: /// @dev The function burn the sent `msg.value`.
96: /// NOTE: Since this contract holds the mapping of all ether balances of the system,
97: /// the sent `msg.value` is added to the `this` balance before the call.
98: /// So the balance of `address(this)` is always bigger or equal to the `msg.value`!
111: /// @dev Get the message to be sent to L1 to initiate a withdrawal.
116: /// @dev Get the message to be sent to L1 to initiate a withdrawal.
126: /// @dev This method has not been stabilized and might be
127: /// removed later on.
132: /// @dev This method has not been stabilized and might be
133: /// removed later on.
138: /// @dev This method has not been stabilized and might be
139: /// removed later on.
```
[19](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L2BaseToken.sol#L19) | [22](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L2BaseToken.sol#L22) | [25](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L2BaseToken.sol#L25) | [26](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L2BaseToken.sol#L26) | [27](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L2BaseToken.sol#L27) | [28](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L2BaseToken.sol#L28) | [29](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L2BaseToken.sol#L29) | [30](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L2BaseToken.sol#L30) | [31](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L2BaseToken.sol#L31) | [52](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L2BaseToken.sol#L52) | [53](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L2BaseToken.sol#L53) | [54](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L2BaseToken.sol#L54) | [55](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L2BaseToken.sol#L55) | [60](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L2BaseToken.sol#L60) | [61](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L2BaseToken.sol#L61) | [62](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L2BaseToken.sol#L62) | [63](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L2BaseToken.sol#L63) | [70](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L2BaseToken.sol#L70) | [71](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L2BaseToken.sol#L71) | [82](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L2BaseToken.sol#L82) | [83](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L2BaseToken.sol#L83) | [84](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L2BaseToken.sol#L84) | [95](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L2BaseToken.sol#L95) | [96](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L2BaseToken.sol#L96) | [97](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L2BaseToken.sol#L97) | [98](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L2BaseToken.sol#L98) | [111](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L2BaseToken.sol#L111) | [116](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L2BaseToken.sol#L116) | [126](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L2BaseToken.sol#L126) | [127](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L2BaseToken.sol#L127) | [132](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L2BaseToken.sol#L132) | [133](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L2BaseToken.sol#L133) | [138](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L2BaseToken.sol#L138) | [139](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L2BaseToken.sol#L139)

```solidity
File: code/system-contracts/contracts/MsgValueSimulator.sol

20: /// @notice Extract value, isSystemCall and to from the extraAbi params.
21: /// @dev The contract accepts value, the callee and whether the call should be a system one via its ABI params.
22: /// @dev The first ABI param contains the value in the [0..127] bits. The 128th contains
23: /// the flag whether or not the call should be a system one.
24: /// The second ABI params contains the callee.
35: /// @notice The maximal number of gas out of the stipend that should be passed to the callee.
38: /// @notice The amount of gas that is passed to the MsgValueSimulator as a stipend.
39: /// This number servers to pay for the ETH transfer as well as to provide gas for the `GAS_TO_PASS` gas.
40: /// It is equal to the following constant: https://github.com/matter-labs/era-zkevm_opcode_defs/blob/7bf8016f5bb13a73289f321ad6ea8f614540ece9/src/system_params.rs#L96.
43: /// @notice The fallback function that is the main entry point for the MsgValueSimulator.
44: /// @dev The contract accepts value, the callee and whether the call should be a system one via its ABI params.
45: /// @param _data The calldata to be passed to the callee.
46: /// @return The return data from the callee.
```
[20](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/MsgValueSimulator.sol#L20) | [21](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/MsgValueSimulator.sol#L21) | [22](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/MsgValueSimulator.sol#L22) | [23](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/MsgValueSimulator.sol#L23) | [24](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/MsgValueSimulator.sol#L24) | [35](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/MsgValueSimulator.sol#L35) | [38](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/MsgValueSimulator.sol#L38) | [39](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/MsgValueSimulator.sol#L39) | [40](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/MsgValueSimulator.sol#L40) | [43](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/MsgValueSimulator.sol#L43) | [44](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/MsgValueSimulator.sol#L44) | [45](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/MsgValueSimulator.sol#L45) | [46](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/MsgValueSimulator.sol#L46)

```solidity
File: code/system-contracts/contracts/NonceHolder.sol

29: /// The minNonce can be increased by 2^32 at a time to prevent it from
30: /// overflowing beyond 2**128.
33: /// RawNonces for accounts are stored in format
34: /// minNonce + 2^128 * deploymentNonce, where deploymentNonce
35: /// is the nonce used for deploying smart contracts.
38: /// Mapping of values under nonces for accounts.
39: /// The main key of the mapping is the 256-bit address of the account, while the
40: /// inner mapping is a mapping from a nonce to the value stored there.
43: /// @notice Returns the current minimal nonce for account.
44: /// @param _address The account to return the minimal nonce for
45: /// @return The current minimal nonce for this account.
53: /// @notice Returns the raw version of the current minimal nonce
54: /// @dev It is equal to minNonce + 2^128 * deployment nonce.
55: /// @param _address The account to return the raw nonce for
56: /// @return The raw nonce for this account.
62: /// @notice Increases the minimal nonce for the msg.sender and returns the previous one.
63: /// @param _value The number by which to increase the minimal nonce for msg.sender.
64: /// @return oldMinNonce The value of the minimal nonce for msg.sender before the increase.
78: /// @notice Sets the nonce value `key` for the msg.sender as used.
79: /// @param _key The nonce key under which the value will be set.
80: /// @param _value The value to store under the _key.
81: /// @dev The value must be non-zero.
99: /// @notice Gets the value stored under a custom nonce for msg.sender.
100: /// @param _key The key under which to get the stored value.
101: /// @return The value stored under the `_key` for the msg.sender.
107: /// @notice A convenience method to increment the minimal nonce if it is equal
108: /// to the `_expectedNonce`.
109: /// @param _expectedNonce The expected minimal nonce for the account.
122: /// @notice Returns the deployment nonce for the accounts used for CREATE opcode.
123: /// @param _address The address to return the deploy nonce of.
124: /// @return deploymentNonce The deployment nonce of the account.
132: /// @notice Increments the deployment nonce for the account and returns the previous one.
133: /// @param _address The address of the account which to return the deploy nonce for.
134: /// @return prevDeploymentNonce The deployment nonce at the time this function is called.
150: /// @notice A method that checks whether the nonce has been used before.
151: /// @param _address The address the nonce of which is being checked.
152: /// @param _nonce The nonce value which is checked.
153: /// @return `true` if the nonce has been used, `false` otherwise.
159: /// @notice Checks and reverts based on whether the nonce is used (not used).
160: /// @param _address The address the nonce of which is being checked.
161: /// @param _key The nonce value which is tested.
162: /// @param _shouldBeUsed The flag for the method. If `true`, the method checks that whether this nonce
163: /// is marked as used and reverts if this is not the case. If `false`, this method will check that the nonce
164: /// has *not* been used yet, and revert otherwise.
165: /// @dev This method should be used by the bootloader.
176: /// @notice Splits the raw nonce value into the deployment nonce and the minimal nonce.
177: /// @param _rawMinNonce The value of the raw minimal nonce (equal to minNonce + deploymentNonce* 2**128).
178: /// @return deploymentNonce and minNonce.
```
[29](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L29) | [30](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L30) | [33](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L33) | [34](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L34) | [35](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L35) | [38](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L38) | [39](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L39) | [40](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L40) | [43](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L43) | [44](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L44) | [45](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L45) | [53](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L53) | [54](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L54) | [55](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L55) | [56](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L56) | [62](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L62) | [63](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L63) | [64](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L64) | [78](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L78) | [79](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L79) | [80](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L80) | [81](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L81) | [99](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L99) | [100](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L100) | [101](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L101) | [107](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L107) | [108](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L108) | [109](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L109) | [122](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L122) | [123](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L123) | [124](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L124) | [132](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L132) | [133](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L133) | [134](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L134) | [150](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L150) | [151](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L151) | [152](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L152) | [153](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L153) | [159](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L159) | [160](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L160) | [161](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L161) | [162](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L162) | [163](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L163) | [164](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L164) | [165](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L165) | [176](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L176) | [177](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L177) | [178](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L178)

```solidity
File: code/system-contracts/contracts/PubdataChunkPublisher.sol

17: /// @notice Chunks pubdata into pieces that can fit into blobs.
18: /// @param _pubdata The total l2 to l1 pubdata that will be sent via L1 blobs.
19: /// @dev Note: This is an early implementation, in the future we plan to support up to 16 blobs per l1 batch.
20: /// @dev We always publish 2 system logs even if our pubdata fits into a single blob. This makes processing logs on L1 easier.
```
[17](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/PubdataChunkPublisher.sol#L17) | [18](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/PubdataChunkPublisher.sol#L18) | [19](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/PubdataChunkPublisher.sol#L19) | [20](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/PubdataChunkPublisher.sol#L20)

```solidity
File: code/system-contracts/contracts/SystemContext.sol

18: /// @notice The number of latest L2 blocks to store.
19: /// @dev EVM requires us to be able to query the hashes of previous 256 blocks.
20: /// We could either:
21: /// - Store the latest 256 hashes (and strictly rely that we do not accidentally override the hash of the block 256 blocks ago)
22: /// - Store the latest 257 blocks' hashes.
25: /// @notice The chainId of the network. It is set at the genesis.
28: /// @notice The `tx.origin` in the current transaction.
29: /// @dev It is updated before each transaction by the bootloader
32: /// @notice The `tx.gasPrice` in the current transaction.
33: /// @dev It is updated before each transaction by the bootloader
36: /// @notice The current block's gasLimit.
39: /// @notice The `block.coinbase` in the current transaction.
40: /// @dev For the support of coinbase, we will use the bootloader formal address for now
43: /// @notice Formal `block.difficulty` parameter.
46: /// @notice The `block.basefee`.
47: /// @dev It is currently a constant.
50: /// @notice The number and the timestamp of the current L1 batch stored packed.
53: /// @notice The hashes of batches.
54: /// @dev It stores batch hashes for all previous batches.
57: /// @notice The number and the timestamp of the current L2 block.
60: /// @notice The rolling hash of the transactions in the current L2 block.
63: /// @notice The hashes of L2 blocks.
64: /// @dev It stores block hashes for previous L2 blocks. Note, in order to make publishing the hashes
65: /// of the miniblocks cheaper, we only store the previous MINIBLOCK_HASHES_TO_STORE ones. Since whenever we need to publish a state
66: /// diff, a pair of <key, value> is published and for cached keys only 8-byte id is used instead of 32 bytes.
67: /// By having this data in a cyclic array of MINIBLOCK_HASHES_TO_STORE blocks, we bring the costs down by 40% (i.e. 40 bytes per miniblock instead of 64 bytes).
68: /// @dev The hash of a miniblock with number N would be stored under slot N%MINIBLOCK_HASHES_TO_STORE.
69: /// @dev Hashes of the blocks older than the ones which are stored here can be calculated as _calculateLegacyL2BlockHash(blockNumber).
72: /// @notice To make migration to L2 blocks smoother, we introduce a temporary concept of virtual L2 blocks, the data
73: /// about which will be returned by the EVM-like methods: block.number/block.timestamp/blockhash.
74: /// - Their number will start from being equal to the number of the batch and it will increase until it reaches the L2 block number.
75: /// - Their timestamp is updated each time a new virtual block is created.
76: /// - Their hash is calculated as `keccak256(uint256(number))`
79: /// @notice The information about the virtual blocks upgrade, which tracks when the migration to the L2 blocks has started and finished.
82: /// @notice Set the chainId origin.
83: /// @param _newChainId The chainId
88: /// @notice Number of current transaction in block.
91: /// @notice The current gas per pubdata byte
94: /// @notice The number of pubdata spent as of the start of the transaction
97: /// @notice Set the current tx origin.
98: /// @param _newOrigin The new tx origin.
103: /// @notice Set the the current gas price.
104: /// @param _gasPrice The new tx gasPrice.
109: /// @notice Sets the number of L2 gas that is needed to pay a single byte of pubdata.
110: /// @dev This value does not have any impact on the execution and purely serves as a way for users
111: /// to access the current gas price for the pubdata.
126: /// @notice The method that emulates `blockhash` opcode in EVM.
127: /// @dev Just like the blockhash in the EVM, it returns bytes32(0),
128: /// when queried about hashes that are older than 256 blocks ago.
129: /// @dev Since zksolc compiler calls this method to emulate `blockhash`,
130: /// its signature can not be changed to `getL2BlockHashEVM`.
131: /// @return hash The blockhash of the block with the given number.
163: /// @notice Returns the hash of the given batch.
164: /// @param _batchNumber The number of the batch.
165: /// @return hash The hash of the batch.
170: /// @notice Returns the current batch's number and timestamp.
171: /// @return batchNumber and batchTimestamp tuple of the current batch's number and the current batch's timestamp
178: /// @notice Returns the current block's number and timestamp.
179: /// @return blockNumber and blockTimestamp tuple of the current L2 block's number and the current block's timestamp
186: /// @notice Returns the current L2 block's number.
187: /// @dev Since zksolc compiler calls this method to emulate `block.number`,
188: /// its signature can not be changed to `getL2BlockNumber`.
189: /// @return blockNumber The current L2 block's number.
194: /// @notice Returns the current L2 block's timestamp.
195: /// @dev Since zksolc compiler calls this method to emulate `block.timestamp`,
196: /// its signature can not be changed to `getL2BlockTimestamp`.
197: /// @return timestamp The current L2 block's timestamp.
202: /// @notice Assuming that block is one of the last MINIBLOCK_HASHES_TO_STORE ones, returns its hash.
203: /// @param _block The number of the block.
204: /// @return hash The hash of the block.
209: /// @notice Assuming that the block is one of the last MINIBLOCK_HASHES_TO_STORE ones, sets its hash.
210: /// @param _block The number of the block.
211: /// @param _hash The hash of the block.
216: /// @notice Calculates the hash of an L2 block.
217: /// @param _blockNumber The number of the L2 block.
218: /// @param _blockTimestamp The timestamp of the L2 block.
219: /// @param _prevL2BlockHash The hash of the previous L2 block.
220: /// @param _blockTxsRollingHash The rolling hash of the transactions in the L2 block.
230: /// @notice Calculates the legacy block hash of L2 block, which were used before the upgrade where
231: /// the advanced block hashes were introduced.
232: /// @param _blockNumber The number of the L2 block.
237: /// @notice Performs the upgrade where we transition to the L2 blocks.
238: /// @param _l2BlockNumber The number of the new L2 block.
239: /// @param _expectedPrevL2BlockHash The expected hash of the previous L2 block.
240: /// @param _isFirstInBatch Whether this method is called for the first time in the batch.
259: /// @notice Creates new virtual blocks, while ensuring they don't exceed the L2 block number.
260: /// @param _l2BlockNumber The number of the new L2 block.
261: /// @param _maxVirtualBlocksToCreate The maximum number of virtual blocks to create with this L2 block.
262: /// @param _newTimestamp The timestamp of the new L2 block, which is also the timestamp of the new virtual block.
310: /// @notice Sets the current block number and timestamp of the L2 block.
311: /// @param _l2BlockNumber The number of the new L2 block.
312: /// @param _l2BlockTimestamp The timestamp of the new L2 block.
313: /// @param _prevL2BlockHash The hash of the previous L2 block.
325: /// @notice Sets the current block number and timestamp of the L2 block.
326: /// @dev Called by the bootloader before each transaction. This is needed to ensure
327: /// that the data about the block is consistent with the sequencer.
328: /// @dev If the new block number is the same as the current one, we ensure that the block's data is
329: /// consistent with the one in the current block.
330: /// @dev If the new block number is greater than the current one by 1,
331: /// then we ensure that timestamp has increased.
332: /// @dev If the currently stored number is 0, we assume that it is the first upgrade transaction
333: /// and so we will fill up the old data.
334: /// @param _l2BlockNumber The number of the new L2 block.
335: /// @param _l2BlockTimestamp The timestamp of the new L2 block.
336: /// @param _expectedPrevL2BlockHash The expected hash of the previous L2 block.
337: /// @param _isFirstInBatch Whether this method is called for the first time in the batch.
338: /// @param _maxVirtualBlocksToCreate The maximum number of virtual block to create with this L2 block.
339: /// @dev It is a strict requirement that a new virtual block is created at the start of the batch.
340: /// @dev It is also enforced that the number of the current virtual L2 block can not exceed the number of the L2 block.
400: /// @notice Appends the transaction hash to the rolling hash of the current L2 block.
401: /// @param _txHash The hash of the transaction.
406: /// @notice Publishes L2->L1 logs needed to verify the validity of this batch on L1.
407: /// @dev Should be called at the end of the current batch.
425: /// @notice Ensures that the timestamp of the batch is greater than the timestamp of the last L2 block.
426: /// @param _newTimestamp The timestamp of the new batch.
435: /// @notice Increments the current batch number and sets the new timestamp
436: /// @dev Called by the bootloader at the start of the batch.
437: /// @param _prevBatchHash The hash of the previous batch.
438: /// @param _newTimestamp The timestamp of the new batch.
439: /// @param _expectedNewNumber The new batch's number.
440: /// @param _baseFee The new batch's base fee
441: /// @dev While _expectedNewNumber can be derived as prevBatchNumber + 1, we still
442: /// manually supply it here for consistency checks.
443: /// @dev The correctness of the _prevBatchHash and _newTimestamp should be enforced on L1.
469: /// @notice A testing method that manually sets the current blocks' number and timestamp.
470: /// @dev Should be used only for testing / ethCalls and should never be used in production.
490: /*//////////////////////////////////////////////////////////////
492: //////////////////////////////////////////////////////////////*/
494: /// @notice Returns the current batch's number and timestamp.
495: /// @dev Deprecated in favor of getBatchNumberAndTimestamp.
501: /// @notice Returns the current batch's number and timestamp.
502: /// @dev Deprecated in favor of getBatchNumberAndTimestamp.
507: /// @notice Returns the hash of the given batch.
508: /// @dev Deprecated in favor of getBatchHash.
```
[18](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L18) | [19](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L19) | [20](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L20) | [21](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L21) | [22](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L22) | [25](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L25) | [28](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L28) | [29](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L29) | [32](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L32) | [33](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L33) | [36](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L36) | [39](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L39) | [40](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L40) | [43](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L43) | [46](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L46) | [47](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L47) | [50](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L50) | [53](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L53) | [54](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L54) | [57](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L57) | [60](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L60) | [63](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L63) | [64](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L64) | [65](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L65) | [66](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L66) | [67](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L67) | [68](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L68) | [69](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L69) | [72](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L72) | [73](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L73) | [74](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L74) | [75](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L75) | [76](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L76) | [79](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L79) | [82](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L82) | [83](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L83) | [88](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L88) | [91](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L91) | [94](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L94) | [97](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L97) | [98](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L98) | [103](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L103) | [104](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L104) | [109](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L109) | [110](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L110) | [111](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L111) | [126](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L126) | [127](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L127) | [128](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L128) | [129](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L129) | [130](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L130) | [131](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L131) | [163](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L163) | [164](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L164) | [165](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L165) | [170](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L170) | [171](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L171) | [178](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L178) | [179](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L179) | [186](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L186) | [187](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L187) | [188](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L188) | [189](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L189) | [194](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L194) | [195](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L195) | [196](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L196) | [197](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L197) | [202](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L202) | [203](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L203) | [204](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L204) | [209](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L209) | [210](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L210) | [211](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L211) | [216](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L216) | [217](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L217) | [218](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L218) | [219](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L219) | [220](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L220) | [230](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L230) | [231](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L231) | [232](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L232) | [237](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L237) | [238](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L238) | [239](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L239) | [240](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L240) | [259](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L259) | [260](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L260) | [261](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L261) | [262](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L262) | [310](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L310) | [311](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L311) | [312](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L312) | [313](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L313) | [325](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L325) | [326](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L326) | [327](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L327) | [328](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L328) | [329](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L329) | [330](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L330) | [331](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L331) | [332](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L332) | [333](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L333) | [334](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L334) | [335](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L335) | [336](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L336) | [337](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L337) | [338](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L338) | [339](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L339) | [340](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L340) | [400](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L400) | [401](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L401) | [406](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L406) | [407](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L407) | [425](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L425) | [426](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L426) | [435](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L435) | [436](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L436) | [437](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L437) | [438](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L438) | [439](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L439) | [440](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L440) | [441](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L441) | [442](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L442) | [443](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L443) | [469](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L469) | [470](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L470) | [490](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L490) | [492](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L492) | [494](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L494) | [495](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L495) | [501](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L501) | [502](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L502) | [507](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L507) | [508](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L508)

```solidity
File: code/system-contracts/contracts/GasBoundCaller.sol

16: /// @notice We assume that no more than `CALL_ENTRY_OVERHEAD` ergs are used for the O(1) operations at the start
17: /// of execution of the contract, such as abi decoding the parameters, jumping to the correct function, etc.
19: /// @notice We assume that no more than `CALL_RETURN_OVERHEAD` ergs are used for the O(1) operations at the end of the execution,
20: /// as such relaying the return.
23: /// @notice The function that implements limiting of the total gas expenditure of the call.
24: /// @dev On Era, the gas for pubdata is charged at the end of the execution of the entire transaction, meaning
25: /// that if a subcall is not trusted, it can consume lots of pubdata in the process. This function ensures that
26: /// no more than  `_maxTotalGas` will be allowed to be spent by the call. To be sure, this function uses some margin
27: /// (`BOUND_CALL_OVERHEAD`) to ensure that the call will not exceed the limit, so it may actually spend a bit less than
28: /// `_maxTotalGas` in the end.
29: /// @dev The entire `gas` passed to this function could be used, regardless
30: /// of the `_maxTotalGas` parameter. In other words, `max(gas(), _maxTotalGas)` is the maximum amount of gas that can be spent by this function.
31: /// @dev The function relays the `returndata` returned by the callee. In case the `callee` reverts, it reverts with the same error.
32: /// @param _to The address of the contract to call.
33: /// @param _maxTotalGas The maximum amount of gas that can be spent by the call.
34: /// @param _data The calldata for the call.
```
[16](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/GasBoundCaller.sol#L16) | [17](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/GasBoundCaller.sol#L17) | [19](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/GasBoundCaller.sol#L19) | [20](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/GasBoundCaller.sol#L20) | [23](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/GasBoundCaller.sol#L23) | [24](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/GasBoundCaller.sol#L24) | [25](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/GasBoundCaller.sol#L25) | [26](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/GasBoundCaller.sol#L26) | [27](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/GasBoundCaller.sol#L27) | [28](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/GasBoundCaller.sol#L28) | [29](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/GasBoundCaller.sol#L29) | [30](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/GasBoundCaller.sol#L30) | [31](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/GasBoundCaller.sol#L31) | [32](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/GasBoundCaller.sol#L32) | [33](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/GasBoundCaller.sol#L33) | [34](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/GasBoundCaller.sol#L34)

```solidity
File: code/system-contracts/contracts/libraries/EfficientCall.sol

33: /// @notice Call the `keccak256` without copying calldata to memory.
34: /// @param _data The preimage data.
35: /// @return The `keccak256` hash.
42: /// @notice Call the `sha256` precompile without copying calldata to memory.
43: /// @param _data The preimage data.
44: /// @return The `sha256` hash.
51: /// @notice Perform a `call` without copying calldata to memory.
52: /// @param _gas The gas to use for the call.
53: /// @param _address The address to call.
54: /// @param _value The `msg.value` to send.
55: /// @param _data The calldata to use for the call.
56: /// @param _isSystem Whether the call should contain the `isSystem` flag.
57: /// @return returnData The copied to memory return data.
69: /// @notice Perform a `staticCall` without copying calldata to memory.
70: /// @param _gas The gas to use for the call.
71: /// @param _address The address to call.
72: /// @param _data The calldata to use for the call.
73: /// @return returnData The copied to memory return data.
83: /// @notice Perform a `delegateCall` without copying calldata to memory.
84: /// @param _gas The gas to use for the call.
85: /// @param _address The address to call.
86: /// @param _data The calldata to use for the call.
87: /// @return returnData The copied to memory return data.
97: /// @notice Perform a `mimicCall` (a call with custom msg.sender) without copying calldata to memory.
98: /// @param _gas The gas to use for the call.
99: /// @param _address The address to call.
100: /// @param _data The calldata to use for the call.
101: /// @param _whoToMimic The `msg.sender` for the next call.
102: /// @param _isConstructor Whether the call should contain the `isConstructor` flag.
103: /// @param _isSystem Whether the call should contain the `isSystem` flag.
104: /// @return returnData The copied to memory return data.
117: /// @notice Perform a `call` without copying calldata to memory.
118: /// @param _gas The gas to use for the call.
119: /// @param _address The address to call.
120: /// @param _value The `msg.value` to send.
121: /// @param _data The calldata to use for the call.
122: /// @param _isSystem Whether the call should contain the `isSystem` flag.
123: /// @return success whether the call was successful.
154: /// @notice Perform a `staticCall` without copying calldata to memory.
155: /// @param _gas The gas to use for the call.
156: /// @param _address The address to call.
157: /// @param _data The calldata to use for the call.
158: /// @return success whether the call was successful.
168: /// @notice Perform a `delegatecall` without copying calldata to memory.
169: /// @param _gas The gas to use for the call.
170: /// @param _address The address to call.
171: /// @param _data The calldata to use for the call.
172: /// @return success whether the call was successful.
182: /// @notice Perform a `mimicCall` (call with custom msg.sender) without copying calldata to memory.
183: /// @param _gas The gas to use for the call.
184: /// @param _address The address to call.
185: /// @param _data The calldata to use for the call.
186: /// @param _whoToMimic The `msg.sender` for the next call.
187: /// @param _isConstructor Whether the call should contain the `isConstructor` flag.
188: /// @param _isSystem Whether the call should contain the `isSystem` flag.
189: /// @return success whether the call was successful.
190: /// @dev If called not in kernel mode, it will result in a revert (enforced by the VM)
212: /// @dev Verify that a low-level call was successful, and revert if it wasn't, by bubbling the revert reason.
213: /// @param _success Whether the call was successful.
214: /// @return returnData The copied to memory return data.
231: /// @dev Propagate the revert reason from the current call to the caller.
240: /// @dev Load the far call ABI into active ptr, that will be used for the next call by reference.
241: /// @param _gas The gas to be passed to the call.
242: /// @param _data The calldata to be passed to the call.
243: /// @param _isConstructor Whether the call is a constructor call.
244: /// @param _isSystem Whether the call is a system call.
```
[33](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L33) | [34](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L34) | [35](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L35) | [42](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L42) | [43](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L43) | [44](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L44) | [51](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L51) | [52](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L52) | [53](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L53) | [54](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L54) | [55](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L55) | [56](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L56) | [57](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L57) | [69](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L69) | [70](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L70) | [71](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L71) | [72](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L72) | [73](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L73) | [83](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L83) | [84](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L84) | [85](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L85) | [86](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L86) | [87](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L87) | [97](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L97) | [98](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L98) | [99](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L99) | [100](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L100) | [101](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L101) | [102](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L102) | [103](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L103) | [104](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L104) | [117](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L117) | [118](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L118) | [119](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L119) | [120](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L120) | [121](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L121) | [122](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L122) | [123](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L123) | [154](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L154) | [155](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L155) | [156](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L156) | [157](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L157) | [158](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L158) | [168](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L168) | [169](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L169) | [170](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L170) | [171](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L171) | [172](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L172) | [182](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L182) | [183](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L183) | [184](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L184) | [185](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L185) | [186](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L186) | [187](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L187) | [188](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L188) | [189](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L189) | [190](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L190) | [212](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L212) | [213](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L213) | [214](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L214) | [231](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L231) | [240](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L240) | [241](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L241) | [242](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L242) | [243](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L243) | [244](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L244)

```solidity
File: code/system-contracts/contracts/libraries/RLPEncoder.sol

46: /// @notice Encodes the size of bytes in RLP format.
47: /// @param _len The length of the bytes to encode. It has a `uint64` type since as larger values are not supported.
48: /// NOTE: panics if the length is 1 since the length encoding is ambiguous in this case.
54: /// @notice Encodes the size of list items in RLP format.
55: /// @param _len The length of the bytes to encode. It has a `uint64` type since as larger values are not supported.
81: /// @notice Computes the index of the highest byte set in number.
82: /// @notice Uses little endian ordering (The least significant byte has index `0`).
83: /// NOTE: returns `0` for `0`
```
[46](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/RLPEncoder.sol#L46) | [47](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/RLPEncoder.sol#L47) | [48](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/RLPEncoder.sol#L48) | [54](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/RLPEncoder.sol#L54) | [55](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/RLPEncoder.sol#L55) | [81](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/RLPEncoder.sol#L81) | [82](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/RLPEncoder.sol#L82) | [83](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/RLPEncoder.sol#L83)

```solidity
File: code/system-contracts/contracts/libraries/SystemContractHelper.sol

14: /// @notice NOTE: The `getZkSyncMeta` that is used to obtain this struct will experience a breaking change in 2024.
42: /// @notice Send an L2Log to L1.
43: /// @param _isService The `isService` flag.
44: /// @param _key The `key` part of the L2Log.
45: /// @param _value The `value` part of the L2Log.
46: /// @dev The meaning of all these parameters is context-dependent, but they
47: /// have no intrinsic meaning per se.
59: /// @notice Get address of the currently executed code.
60: /// @dev This allows differentiating between `call` and `delegatecall`.
61: /// During the former `this` and `codeAddress` are the same, while
62: /// during the latter they are not.
70: /// @notice Provide a compiler hint, by placing calldata fat pointer into virtual `ACTIVE_PTR`,
71: /// that can be manipulated by `ptr.add`/`ptr.sub`/`ptr.pack`/`ptr.shrink` later.
72: /// @dev This allows making a call by forwarding calldata pointer to the child call.
73: /// It is a much more efficient way to forward calldata, than standard EVM bytes copying.
81: /// @notice Compiler simulation of the `ptr.pack` opcode for the virtual `ACTIVE_PTR` pointer.
82: /// @dev Do the concatenation between lowest part of `ACTIVE_PTR` and highest part of `_farCallAbi`
83: /// forming packed fat pointer for a far call or ret ABI when necessary.
84: /// Note: Panics if the lowest 128 bits of `_farCallAbi` are not zeroes.
92: /// @notice Compiler simulation of the `ptr.add` opcode for the virtual `ACTIVE_PTR` pointer.
93: /// @dev Transforms `ACTIVE_PTR.offset` into `ACTIVE_PTR.offset + u32(_value)`. If overflow happens then it panics.
104: /// @notice Compiler simulation of the `ptr.shrink` opcode for the virtual `ACTIVE_PTR` pointer.
105: /// @dev Transforms `ACTIVE_PTR.length` into `ACTIVE_PTR.length - u32(_shrink)`. If underflow happens then it panics.
116: /// @notice packs precompile parameters into one word
117: /// @param _inputMemoryOffset The memory offset in 32-byte words for the input data for calling the precompile.
118: /// @param _inputMemoryLength The length of the input data in words.
119: /// @param _outputMemoryOffset The memory offset in 32-byte words for the output data.
120: /// @param _outputMemoryLength The length of the output data in words.
121: /// @param _perPrecompileInterpreted The constant, the meaning of which is defined separately for
122: /// each precompile. For information, please read the documentation of the precompilecall log in
123: /// the VM.
138: /// @notice Call precompile with given parameters.
139: /// @param _rawParams The packed precompile params. They can be retrieved by
140: /// the `packPrecompileParams` method.
141: /// @param _gasToBurn The number of gas to burn during this call.
142: /// @return success Whether the call was successful.
143: /// @dev The list of currently available precompiles sha256, keccak256, ecrecover.
144: /// NOTE: The precompile type depends on `this` which calls precompile, which means that only
145: /// system contracts corresponding to the list of precompiles above can do `precompileCall`.
146: /// @dev If used not in the `sha256`, `keccak256` or `ecrecover` contracts, it will just burn the gas provided.
147: /// @dev This method is `unsafe` because it does not check whether there is enough gas to burn.
165: /// @notice Set `msg.value` to next far call.
166: /// @param _value The msg.value that will be used for the *next* call.
167: /// @dev If called not in kernel mode, it will result in a revert (enforced by the VM)
178: /// @notice Initialize a new event.
179: /// @param initializer The event initializing value.
180: /// @param value1 The first topic or data chunk.
188: /// @notice Continue writing the previously initialized event.
189: /// @param value1 The first topic or data chunk.
190: /// @param value2 The second topic or data chunk.
198: /// @notice Get the packed representation of the `ZkSyncMeta` from the current context.
199: /// @notice NOTE: The behavior of this function will experience a breaking change in 2024.
200: /// @return meta The packed representation of the ZkSyncMeta.
201: /// @dev The fields in ZkSyncMeta are NOT tightly packed, i.e. there is a special rule on how
202: /// they are packed. For more information, please read the documentation on ZkSyncMeta.
210: /// @notice Returns the bits [offset..offset+size-1] of the meta.
211: /// @param meta Packed representation of the ZkSyncMeta.
212: /// @param offset The offset of the bits.
213: /// @param size The size of the extracted number in bits.
214: /// @return result The extracted number.
222: /// @notice Given the packed representation of `ZkSyncMeta`, retrieves the number of gas
223: /// that a single byte sent to L1 as pubdata costs.
224: /// @notice NOTE: The behavior of this function will experience a breaking change in 2024.
225: /// @param meta Packed representation of the ZkSyncMeta.
226: /// @return pubdataPublished The current price in gas per pubdata byte.
231: /// @notice Given the packed representation of `ZkSyncMeta`, retrieves the number of the current size
232: /// of the heap in bytes.
233: /// @param meta Packed representation of the ZkSyncMeta.
234: /// @return heapSize The size of the memory in bytes byte.
235: /// @dev The following expression: getHeapSizeFromMeta(getZkSyncMetaBytes()) is
236: /// equivalent to the MSIZE in Solidity.
241: /// @notice Given the packed representation of `ZkSyncMeta`, retrieves the number of the current size
242: /// of the auxilary heap in bytes.
243: /// @param meta Packed representation of the ZkSyncMeta.
244: /// @return auxHeapSize The size of the auxilary memory in bytes byte.
245: /// @dev You can read more on auxilary memory in the VM1.2 documentation.
250: /// @notice Given the packed representation of `ZkSyncMeta`, retrieves the shardId of `this`.
251: /// @param meta Packed representation of the ZkSyncMeta.
252: /// @return shardId The shardId of `this`.
253: /// @dev Currently only shard 0 (zkRollup) is supported.
258: /// @notice Given the packed representation of `ZkSyncMeta`, retrieves the shardId of
259: /// the msg.sender.
260: /// @param meta Packed representation of the ZkSyncMeta.
261: /// @return callerShardId The shardId of the msg.sender.
262: /// @dev Currently only shard 0 (zkRollup) is supported.
267: /// @notice Given the packed representation of `ZkSyncMeta`, retrieves the shardId of
268: /// the currently executed code.
269: /// @param meta Packed representation of the ZkSyncMeta.
270: /// @return codeShardId The shardId of the currently executed code.
271: /// @dev Currently only shard 0 (zkRollup) is supported.
276: /// @notice Retrieves the ZkSyncMeta structure.
277: /// @notice NOTE: The behavior of this function will experience a breaking change in 2024.
278: /// @return meta The ZkSyncMeta execution context parameters.
289: /// @notice Returns the call flags for the current call.
290: /// @return callFlags The bitmask of the callflags.
291: /// @dev Call flags is the value of the first register
292: /// at the start of the call.
293: /// @dev The zero bit of the callFlags indicates whether the call is
294: /// a constructor call. The first bit of the callFlags indicates whether
295: /// the call is a system one.
303: /// @notice Returns the current calldata pointer.
304: /// @return ptr The current calldata pointer.
305: /// @dev NOTE: This file is just an integer and it cannot be used
306: /// to forward the calldata to the next calls in any way.
314: /// @notice Returns the N-th extraAbiParam for the current call.
315: /// @return extraAbiData The value of the N-th extraAbiParam for this call.
316: /// @dev It is equal to the value of the (N+2)-th register
317: /// at the start of the call.
327: /// @notice Retuns whether the current call is a system call.
328: /// @return `true` or `false` based on whether the current call is a system call.
335: /// @notice Returns whether the address is a system contract.
336: /// @param _address The address to test
337: /// @return `true` or `false` based on whether the `_address` is a system contract.
342: /// @notice Method used for burning a certain amount of gas.
343: /// @param _gasToPay The number of gas to burn.
```
[14](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L14) | [42](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L42) | [43](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L43) | [44](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L44) | [45](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L45) | [46](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L46) | [47](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L47) | [59](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L59) | [60](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L60) | [61](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L61) | [62](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L62) | [70](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L70) | [71](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L71) | [72](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L72) | [73](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L73) | [81](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L81) | [82](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L82) | [83](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L83) | [84](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L84) | [92](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L92) | [93](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L93) | [104](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L104) | [105](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L105) | [116](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L116) | [117](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L117) | [118](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L118) | [119](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L119) | [120](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L120) | [121](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L121) | [122](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L122) | [123](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L123) | [138](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L138) | [139](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L139) | [140](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L140) | [141](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L141) | [142](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L142) | [143](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L143) | [144](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L144) | [145](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L145) | [146](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L146) | [147](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L147) | [165](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L165) | [166](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L166) | [167](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L167) | [178](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L178) | [179](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L179) | [180](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L180) | [188](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L188) | [189](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L189) | [190](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L190) | [198](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L198) | [199](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L199) | [200](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L200) | [201](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L201) | [202](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L202) | [210](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L210) | [211](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L211) | [212](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L212) | [213](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L213) | [214](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L214) | [222](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L222) | [223](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L223) | [224](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L224) | [225](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L225) | [226](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L226) | [231](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L231) | [232](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L232) | [233](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L233) | [234](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L234) | [235](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L235) | [236](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L236) | [241](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L241) | [242](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L242) | [243](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L243) | [244](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L244) | [245](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L245) | [250](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L250) | [251](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L251) | [252](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L252) | [253](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L253) | [258](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L258) | [259](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L259) | [260](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L260) | [261](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L261) | [262](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L262) | [267](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L267) | [268](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L268) | [269](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L269) | [270](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L270) | [271](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L271) | [276](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L276) | [277](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L277) | [278](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L278) | [289](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L289) | [290](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L290) | [291](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L291) | [292](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L292) | [293](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L293) | [294](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L294) | [295](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L295) | [303](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L303) | [304](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L304) | [305](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L305) | [306](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L306) | [314](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L314) | [315](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L315) | [316](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L316) | [317](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L317) | [327](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L327) | [328](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L328) | [335](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L335) | [336](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L336) | [337](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L337) | [342](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L342) | [343](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L343)

```solidity
File: code/system-contracts/contracts/libraries/SystemContractsCaller.sol

48: /// @notice The way to forward the calldata:
49: /// - Use the current heap (i.e. the same as on EVM).
50: /// - Use the auxiliary heap.
51: /// - Forward via a pointer
52: /// @dev Note, that currently, users do not have access to the auxiliary
53: /// heap and so the only type of forwarding that will be used by the users
54: /// are UseHeap and ForwardFatPointer for forwarding a slice of the current calldata
55: /// to the next call.
69: /// @notice Makes a call with the `isSystem` flag.
70: /// @param gasLimit The gas limit for the call.
71: /// @param to The address to call.
72: /// @param value The value to pass with the transaction.
73: /// @param data The calldata.
74: /// @return success Whether the transaction has been successful.
75: /// @dev Note, that the `isSystem` flag can only be set when calling system contracts.
115: /// @notice Makes a call with the `isSystem` flag.
116: /// @param gasLimit The gas limit for the call.
117: /// @param to The address to call.
118: /// @param value The value to pass with the transaction.
119: /// @param data The calldata.
120: /// @return success Whether the transaction has been successful.
121: /// @return returnData The returndata of the transaction (revert reason in case the transaction has failed).
122: /// @dev Note, that the `isSystem` flag can only be set when calling system contracts.
142: /// @notice Makes a call with the `isSystem` flag.
143: /// @param gasLimit The gas limit for the call.
144: /// @param to The address to call.
145: /// @param value The value to pass with the transaction.
146: /// @param data The calldata.
147: /// @return returnData The returndata of the transaction. In case the transaction reverts, the error
148: /// bubbles up to the parent frame.
149: /// @dev Note, that the `isSystem` flag can only be set when calling system contracts.
167: /// @notice Calculates the packed representation of the FarCallABI.
168: /// @param dataOffset Calldata offset in memory. Provide 0 unless using custom pointer.
169: /// @param memoryPage Memory page to use. Provide 0 unless using custom pointer.
170: /// @param dataStart The start of the calldata slice. Provide the offset in memory
171: /// if not using custom pointer.
172: /// @param dataLength The calldata length. Provide the length of the calldata in bytes
173: /// unless using custom pointer.
174: /// @param gasPassed The gas to pass with the call.
175: /// @param shardId Of the account to call. Currently only 0 is supported.
176: /// @param forwardingMode The forwarding mode to use:
177: /// - provide CalldataForwardingMode.UseHeap when using your current memory
178: /// - provide CalldataForwardingMode.ForwardFatPointer when using custom pointer.
179: /// @param isConstructorCall Whether the call will be a call to the constructor
180: /// (ignored when the caller is not a system contract).
181: /// @param isSystemCall Whether the call will have the `isSystem` flag.
182: /// @return farCallAbi The far call ABI.
183: /// @dev The `FarCallABI` has the following structure:
184: /// pub struct FarCallABI {
185: ///     pub memory_quasi_fat_pointer: FatPointer,
186: ///     pub gas_passed: u32,
187: ///     pub shard_id: u8,
188: ///     pub forwarding_mode: FarCallForwardPageType,
189: ///     pub constructor_call: bool,
190: ///     pub to_system: bool,
191: /// }
192: ///
193: /// The FatPointer struct:
194: ///
195: /// pub struct FatPointer {
196: ///     pub offset: u32, // offset relative to `start`
197: ///     pub memory_page: u32, // memory page where slice is located
198: ///     pub start: u32, // absolute start of the slice
199: ///     pub length: u32, // length of the slice
200: /// }
201: ///
202: /// @dev Note, that the actual layout is the following:
203: ///
204: /// [0..32) bits -- the calldata offset
205: /// [32..64) bits -- the memory page to use. Can be left blank in most of the cases.
206: /// [64..96) bits -- the absolute start of the slice
207: /// [96..128) bits -- the length of the slice.
208: /// [128..192) bits -- empty bits.
209: /// [192..224) bits -- gasPassed.
210: /// [224..232) bits -- forwarding_mode
211: /// [232..240) bits -- shard id.
212: /// [240..248) bits -- constructor call flag
213: /// [248..256] bits -- system call flag
240: /// @notice Calculates the packed representation of the FarCallABI with zero fat pointer fields.
241: /// @param gasPassed The gas to pass with the call.
242: /// @param shardId Of the account to call. Currently only 0 is supported.
243: /// @param forwardingMode The forwarding mode to use:
244: /// - provide CalldataForwardingMode.UseHeap when using your current memory
245: /// - provide CalldataForwardingMode.ForwardFatPointer when using custom pointer.
246: /// @param isConstructorCall Whether the call will be a call to the constructor
247: /// (ignored when the caller is not a system contract).
248: /// @param isSystemCall Whether the call will have the `isSystem` flag.
249: /// @return farCallAbiWithEmptyFatPtr The far call ABI with zero fat pointer fields.
```
[48](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L48) | [49](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L49) | [50](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L50) | [51](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L51) | [52](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L52) | [53](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L53) | [54](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L54) | [55](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L55) | [69](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L69) | [70](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L70) | [71](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L71) | [72](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L72) | [73](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L73) | [74](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L74) | [75](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L75) | [115](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L115) | [116](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L116) | [117](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L117) | [118](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L118) | [119](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L119) | [120](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L120) | [121](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L121) | [122](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L122) | [142](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L142) | [143](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L143) | [144](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L144) | [145](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L145) | [146](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L146) | [147](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L147) | [148](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L148) | [149](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L149) | [167](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L167) | [168](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L168) | [169](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L169) | [170](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L170) | [171](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L171) | [172](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L172) | [173](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L173) | [174](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L174) | [175](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L175) | [176](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L176) | [177](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L177) | [178](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L178) | [179](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L179) | [180](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L180) | [181](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L181) | [182](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L182) | [183](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L183) | [184](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L184) | [185](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L185) | [186](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L186) | [187](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L187) | [188](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L188) | [189](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L189) | [190](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L190) | [191](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L191) | [192](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L192) | [193](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L193) | [194](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L194) | [195](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L195) | [196](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L196) | [197](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L197) | [198](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L198) | [199](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L199) | [200](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L200) | [201](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L201) | [202](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L202) | [203](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L203) | [204](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L204) | [205](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L205) | [206](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L206) | [207](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L207) | [208](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L208) | [209](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L209) | [210](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L210) | [211](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L211) | [212](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L212) | [213](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L213) | [240](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L240) | [241](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L241) | [242](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L242) | [243](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L243) | [244](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L244) | [245](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L245) | [246](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L246) | [247](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L247) | [248](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L248) | [249](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L249)

```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

14: /// @dev The type id of zkSync's EIP-712-signed transaction.
17: /// @dev The type id of legacy transactions.
19: /// @dev The type id of legacy transactions.
21: /// @dev The type id of EIP1559 transactions.
24: /// @notice Structure used to represent a zkSync transaction.
81: /// @notice The EIP-712 typehash for the contract's domain
89: /// @notice Whether the token is Ethereum.
90: /// @param _addr The address of the token
91: /// @return `true` or `false` based on whether the token is Ether.
92: /// @dev This method assumes that address is Ether either if the address is 0 (for convenience)
93: /// or if the address is the address of the L2BaseToken system contract.
98: /// @notice Calculate the suggested signed hash of the transaction,
99: /// i.e. the hash that is signed by EOAs and is recommended to be signed by other accounts.
116: /// @notice Encode hash of the zkSync native transaction type.
117: /// @return keccak256 hash of the EIP-712 encoded representation of transaction
145: /// @notice Encode hash of the legacy transaction type.
146: /// @return keccak256 of the serialized RLP encoded representation of transaction
217: /// @notice Encode hash of the EIP2930 transaction type.
218: /// @return keccak256 of the serialized RLP encoded representation of transaction
287: /// @notice Encode hash of the EIP1559 transaction type.
288: /// @return keccak256 of the serialized RLP encoded representation of transaction
359: /// @notice Processes the common paymaster flows, e.g. setting proper allowance
360: /// for tokens, etc. For more information on the expected behavior, check out
361: /// the "Paymaster flows" section in the documentation.
392: /// @notice Pays the required fee for the transaction to the bootloader.
393: /// @dev Currently it pays the maximum amount "_transaction.maxFeePerGas * _transaction.gasLimit",
394: /// it will change in the future.
```
[14](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L14) | [17](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L17) | [19](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L19) | [21](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L21) | [24](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L24) | [81](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L81) | [89](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L89) | [90](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L90) | [91](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L91) | [92](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L92) | [93](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L93) | [98](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L98) | [99](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L99) | [116](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L116) | [117](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L117) | [145](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L145) | [146](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L146) | [217](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L217) | [218](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L218) | [287](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L287) | [288](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L288) | [359](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L359) | [360](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L360) | [361](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L361) | [392](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L392) | [393](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L393) | [394](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L394)

```solidity
File: code/system-contracts/contracts/libraries/Utils.sol

12: /// @dev Bit mask of bytecode hash "isConstructor" marker
16: /// @dev Bit mask to set the "isConstructor" marker in the bytecode hash
38: /// @return codeLength The bytecode length in bytes
43: /// @return codeLengthInWords The bytecode length in machine words
50: /// @notice Denotes whether bytecode hash corresponds to a contract that already constructed
55: /// @notice Denotes whether bytecode hash corresponds to a contract that is on constructor or has already been constructed
60: /// @notice Sets "isConstructor" flag to TRUE for the bytecode hash
61: /// @param _bytecodeHash The bytecode hash for which it is needed to set the constructing flag
62: /// @return The bytecode hash with "isConstructor" flag set to TRUE
68: /// @notice Sets "isConstructor" flag to FALSE for the bytecode hash
69: /// @param _bytecodeHash The bytecode hash for which it is needed to set the constructing flag
70: /// @return The bytecode hash with "isConstructor" flag set to FALSE
75: /// @notice Validate the bytecode format and calculate its hash.
76: /// @param _bytecode The bytecode to hash.
77: /// @return hashedBytecode The 32-byte hash of the bytecode.
78: /// Note: The function reverts the execution if the bytecode has non expected format:
79: /// - Bytecode bytes length is not a multiple of 32
80: /// - Bytecode bytes length is not less than 2^21 bytes (2^16 words)
81: /// - Bytecode words length is not odd
```
[12](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L12) | [16](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L16) | [38](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L38) | [43](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L43) | [50](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L50) | [55](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L55) | [60](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L60) | [61](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L61) | [62](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L62) | [68](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L68) | [69](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L69) | [70](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L70) | [75](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L75) | [76](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L76) | [77](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L77) | [78](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L78) | [79](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L79) | [80](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L80) | [81](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L81)

```solidity
File: code/system-contracts/contracts/interfaces/IAccount.sol

10: /// @notice Called by the bootloader to validate that an account agrees to process the transaction
11: /// (and potentially pay for it).
12: /// @param _txHash The hash of the transaction to be used in the explorer
13: /// @param _suggestedSignedHash The hash of the transaction is signed by EOAs
14: /// @param _transaction The transaction itself
15: /// @return magic The magic value that should be equal to the signature of this function
16: /// if the user agrees to proceed with the transaction.
17: /// @dev The developer should strive to preserve as many steps as possible both for valid
18: /// and invalid transactions as this very method is also used during the gas fee estimation
19: /// (without some of the necessary data, e.g. signature).
```
[10](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IAccount.sol#L10) | [11](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IAccount.sol#L11) | [12](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IAccount.sol#L12) | [13](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IAccount.sol#L13) | [14](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IAccount.sol#L14) | [15](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IAccount.sol#L15) | [16](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IAccount.sol#L16) | [17](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IAccount.sol#L17) | [18](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IAccount.sol#L18) | [19](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IAccount.sol#L19)

```solidity
File: code/system-contracts/contracts/interfaces/IContractDeployer.sol

6: /// @notice Defines the version of the account abstraction protocol
7: /// that a contract claims to follow.
8: /// - `None` means that the account is just a contract and it should never be interacted
9: /// with as a custom account
10: /// - `Version1` means that the account follows the first version of the account abstraction protocol
16: /// @notice Defines the nonce ordering used by the account
17: /// - `Sequential` means that it is expected that the nonces are monotonic and increment by 1
18: /// at a time (the same as EOAs).
19: /// - `Arbitrary` means that the nonces for the accounts can be arbitrary. The operator
20: /// should serve the transactions from such an account on a first-come-first-serve basis.
21: /// @dev This ordering is more of a suggestion to the operator on how the AA expects its transactions
22: /// to be processed and is not considered as a system invariant.
65: /// @dev While the `_salt` parameter is not used anywhere here,
66: /// it is still needed for consistency between `create` and
67: /// `create2` functions (required by the compiler).
74: /// @dev While `_salt` is never used here, we leave it here as a parameter
75: /// for the consistency with the `create` function.
83: /// @notice Returns the information about a certain AA.
86: /// @notice Can be called by an account to update its account version
89: /// @notice Can be called by an account to update its nonce ordering
```
[6](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L6) | [7](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L7) | [8](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L8) | [9](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L9) | [10](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L10) | [16](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L16) | [17](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L17) | [18](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L18) | [19](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L19) | [20](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L20) | [21](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L21) | [22](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L22) | [65](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L65) | [66](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L66) | [67](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L67) | [74](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L74) | [75](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L75) | [83](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L83) | [86](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L86) | [89](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L89)

```solidity
File: code/system-contracts/contracts/interfaces/IL1Messenger.sol

5: /// @dev The log passed from L2
6: /// @param l2ShardId The shard identifier, 0 - rollup, 1 - porter. All other values are not used but are reserved for the future
7: /// @param isService A boolean flag that is part of the log along with `key`, `value`, and `sender` address.
8: /// This field is required formally but does not have any special meaning.
9: /// @param txNumberInBlock The L2 transaction number in a block, in which the log was sent
10: /// @param sender The L2 address which sent the log
11: /// @param key The 32 bytes of information that was sent in the log
12: /// @param value The 32 bytes of information that was sent in the log
23: /// @dev Bytes in raw L2 to L1 log
24: /// @dev Equal to the bytes size of the tuple - (uint8 ShardId, bool isService, uint16 txNumberInBlock, address sender, bytes32 key, bytes32 value)
27: /// @dev The value of default leaf hash for L2 to L1 logs Merkle tree
28: /// @dev An incomplete fixed-size tree is filled with this value to be a full binary tree
29: /// @dev Actually equal to the `keccak256(new bytes(L2_TO_L1_LOG_SERIALIZE_SIZE))`
32: /// @dev The current version of state diff compression being used.
```
[5](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IL1Messenger.sol#L5) | [6](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IL1Messenger.sol#L6) | [7](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IL1Messenger.sol#L7) | [8](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IL1Messenger.sol#L8) | [9](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IL1Messenger.sol#L9) | [10](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IL1Messenger.sol#L10) | [11](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IL1Messenger.sol#L11) | [12](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IL1Messenger.sol#L12) | [23](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IL1Messenger.sol#L23) | [24](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IL1Messenger.sol#L24) | [27](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IL1Messenger.sol#L27) | [28](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IL1Messenger.sol#L28) | [29](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IL1Messenger.sol#L29) | [32](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IL1Messenger.sol#L32)

```solidity
File: code/system-contracts/contracts/interfaces/INonceHolder.sol

16: /// @dev Returns the current minimal nonce for account.
19: /// @dev Returns the raw version of the current minimal nonce
20: /// (equal to minNonce + 2^128 * deployment nonce).
23: /// @dev Increases the minimal nonce for the msg.sender.
26: /// @dev Sets the nonce value `key` as used.
29: /// @dev Gets the value stored inside a custom nonce.
32: /// @dev A convenience method to increment the minimal nonce if it is equal
33: /// to the `_expectedNonce`.
36: /// @dev Returns the deployment nonce for the accounts used for CREATE opcode.
39: /// @dev Increments the deployment nonce for the account and returns the previous one.
42: /// @dev Determines whether a certain nonce has been already used for an account.
45: /// @dev Returns whether a nonce has been used for an account.
```
[16](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/INonceHolder.sol#L16) | [19](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/INonceHolder.sol#L19) | [20](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/INonceHolder.sol#L20) | [23](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/INonceHolder.sol#L23) | [26](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/INonceHolder.sol#L26) | [29](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/INonceHolder.sol#L29) | [32](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/INonceHolder.sol#L32) | [33](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/INonceHolder.sol#L33) | [36](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/INonceHolder.sol#L36) | [39](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/INonceHolder.sol#L39) | [42](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/INonceHolder.sol#L42) | [45](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/INonceHolder.sol#L45)

```solidity
File: code/system-contracts/contracts/interfaces/IPaymaster.sol

15: /// @dev Called by the bootloader to verify that the paymaster agrees to pay for the
16: /// fee for the transaction. This transaction should also send the necessary amount of funds onto the bootloader
17: /// address.
18: /// @param _txHash The hash of the transaction
19: /// @param _suggestedSignedHash The hash of the transaction that is signed by an EOA
20: /// @param _transaction The transaction itself.
21: /// @return magic The value that should be equal to the signature of the validateAndPayForPaymasterTransaction
22: /// if the paymaster agrees to pay for the transaction.
23: /// @return context The "context" of the transaction: an array of bytes of length at most 1024 bytes, which will be
24: /// passed to the `postTransaction` method of the account.
25: /// @dev The developer should strive to preserve as many steps as possible both for valid
26: /// and invalid transactions as this very method is also used during the gas fee estimation
27: /// (without some of the necessary data, e.g. signature).
34: /// @dev Called by the bootloader after the execution of the transaction. Please note that
35: /// there is no guarantee that this method will be called at all. Unlike the original EIP4337,
36: /// this method won't be called if the transaction execution results in out-of-gas.
37: /// @param _context, the context of the execution, returned by the "validateAndPayForPaymasterTransaction" method.
38: /// @param  _transaction, the users' transaction.
39: /// @param _txResult, the result of the transaction execution (success or failure).
40: /// @param _maxRefundedGas, the upper bound on the amout of gas that could be refunded to the paymaster.
41: /// @dev The exact amount refunded depends on the gas spent by the "postOp" itself and so the developers should
42: /// take that into account.
```
[15](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IPaymaster.sol#L15) | [16](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IPaymaster.sol#L16) | [17](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IPaymaster.sol#L17) | [18](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IPaymaster.sol#L18) | [19](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IPaymaster.sol#L19) | [20](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IPaymaster.sol#L20) | [21](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IPaymaster.sol#L21) | [22](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IPaymaster.sol#L22) | [23](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IPaymaster.sol#L23) | [24](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IPaymaster.sol#L24) | [25](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IPaymaster.sol#L25) | [26](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IPaymaster.sol#L26) | [27](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IPaymaster.sol#L27) | [34](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IPaymaster.sol#L34) | [35](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IPaymaster.sol#L35) | [36](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IPaymaster.sol#L36) | [37](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IPaymaster.sol#L37) | [38](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IPaymaster.sol#L38) | [39](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IPaymaster.sol#L39) | [40](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IPaymaster.sol#L40) | [41](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IPaymaster.sol#L41) | [42](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IPaymaster.sol#L42)

```solidity
File: code/system-contracts/contracts/interfaces/IPubdataChunkPublisher.sol

10: /// @notice Chunks pubdata into pieces that can fit into blobs.
11: /// @param _pubdata The total l2 to l1 pubdata that will be sent via L1 blobs.
```
[10](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IPubdataChunkPublisher.sol#L10) | [11](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IPubdataChunkPublisher.sol#L11)

```solidity
File: code/system-contracts/contracts/interfaces/ISystemContext.sol

17: /// @notice A structure representing the timeline for the upgrade from the batch numbers to the L2 block numbers.
18: /// @dev It will used for the L1 batch -> L2 block migration in Q3 2023 only.
20: /// @notice In order to maintain consistent results for `blockhash` requests, we'll
21: /// have to remember the number of the batch when the upgrade to the virtual blocks has been done.
22: /// The hashes for virtual blocks before the upgrade are identical to the hashes of the corresponding batches.
24: /// @notice L2 block when the virtual blocks have caught up with the L2 blocks. Starting from this block,
25: /// all the information returned to users for block.timestamp/number, etc should be the information about the L2 blocks and
26: /// not virtual blocks.
```
[17](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/ISystemContext.sol#L17) | [18](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/ISystemContext.sol#L18) | [20](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/ISystemContext.sol#L20) | [21](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/ISystemContext.sol#L21) | [22](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/ISystemContext.sol#L22) | [24](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/ISystemContext.sol#L24) | [25](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/ISystemContext.sol#L25) | [26](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/ISystemContext.sol#L26)

```solidity
File: code/system-contracts/contracts/interfaces/ISystemContract.sol

18: /// @notice Modifier that makes sure that the method
19: /// can only be called via a system call.
28: /// @notice Modifier that makes sure that the method
29: /// can only be called from a system contract.
38: /// @notice Modifier that makes sure that the method
39: /// can only be called from a special given address.
45: /// @notice Modifier that makes sure that the method
46: /// can only be called from the bootloader.
52: /// @notice Modifier that makes sure that the method
53: /// can only be called from the L1 force deployer.
```
[18](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/ISystemContract.sol#L18) | [19](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/ISystemContract.sol#L19) | [28](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/ISystemContract.sol#L28) | [29](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/ISystemContract.sol#L29) | [38](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/ISystemContract.sol#L38) | [39](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/ISystemContract.sol#L39) | [45](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/ISystemContract.sol#L45) | [46](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/ISystemContract.sol#L46) | [52](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/ISystemContract.sol#L52) | [53](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/ISystemContract.sol#L53)

```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

19: /// @author Matter Labs
20: /// @custom:security-contact security@matterlabs.dev
21: /// @notice The "default" bridge implementation for the ERC20 tokens. Note, that it does not
22: /// support any custom token logic, i.e. rebase tokens' functionality is not supported.
24: /// @dev The address of the L1 bridge counterpart.
27: /// @dev Contract that stores the implementation address for token.
28: /// @dev For more details see https://docs.openzeppelin.com/contracts/3.x/api/proxy#UpgradeableBeacon.
31: /// @dev Bytecode hash of the proxy for tokens deployed by the bridge.
34: /// @dev A mapping l2 token address => l1 token address
39: /// @dev Contract is expected to be used as proxy implementation.
40: /// @dev Disable the initialization to prevent Parity hack.
45: /// @notice Initializes the bridge contract for later use. Expected to be used in the proxy.
46: /// @param _l1Bridge The address of the L1 Bridge contract.
47: /// @param _l2TokenProxyBytecodeHash The bytecode hash of the proxy for tokens deployed by the bridge.
48: /// @param _aliasedOwner The address of the governor contract.
73: /// @notice Finalize the deposit and mint funds
74: /// @param _l1Sender The account address that initiated the deposit on L1
75: /// @param _l2Receiver The account address that would receive minted ether
76: /// @param _l1Token The address of the token that was locked on the L1
77: /// @param _amount Total amount of tokens deposited from L1
78: /// @param _data The additional data that user can pass with the deposit
108: /// @dev Deploy and initialize the L2 token for the L1 counterpart
118: /// @notice Initiates a withdrawal by burning funds on the contract and sending the message to L1
119: /// where tokens would be unlocked
120: /// @param _l1Receiver The account address that should receive funds on L1
121: /// @param _l2Token The L2 token address which is withdrawn
122: /// @param _amount The total amount of tokens to be withdrawn
137: /// @dev Encode the message for l2ToL1log sent with withdraw initialization
148: /// @return Address of an L2 token counterpart
156: /// @dev Convert the L1 token address to the create2 salt of deployed L2 token
161: /// @dev Deploy the beacon proxy for the L2 token, while using ContractDeployer system contract.
162: /// @dev This function uses raw call to ContractDeployer to make sure that exactly `l2TokenProxyBytecodeHash` is used
163: /// for the code of the proxy.
```
[19](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L19) | [20](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L20) | [21](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L21) | [22](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L22) | [24](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L24) | [27](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L27) | [28](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L28) | [31](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L31) | [34](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L34) | [39](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L39) | [40](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L40) | [45](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L45) | [46](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L46) | [47](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L47) | [48](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L48) | [73](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L73) | [74](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L74) | [75](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L75) | [76](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L76) | [77](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L77) | [78](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L78) | [108](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L108) | [118](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L118) | [119](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L119) | [120](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L120) | [121](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L121) | [122](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L122) | [137](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L137) | [148](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L148) | [156](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L156) | [161](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L161) | [162](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L162) | [163](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L163)

```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

11: /// @author Matter Labs
12: /// @custom:security-contact security@matterlabs.dev
13: /// @notice The ERC20 token implementation, that is used in the "default" ERC20 bridge. Note, that it does not
14: /// support any custom token logic, i.e. rebase tokens' functionality is not supported.
16: /// @dev Describes whether there is a specific getter in the token.
17: /// @notice Used to explicitly separate which getters the token has and which it does not.
18: /// @notice Different tokens in L1 can implement or not implement getter function as `name`/`symbol`/`decimals`,
19: /// @notice Our goal is to store all the getters that L1 token implements, and for others, we keep it as an unimplemented method.
28: /// @dev The decimals of the token, that are used as a value for `decimals` getter function.
29: /// @notice A private variable is used only for decimals, but not for `name` and `symbol`, because standard
30: /// @notice OpenZeppelin token represents `name` and `symbol` as storage variables and `decimals` as constant.
33: /// @dev Address of the L2 bridge that is used as trustee who can mint/burn tokens
36: /// @dev Address of the L1 token that can be deposited to mint this L2 token
39: /// @dev Contract is expected to be used as proxy implementation.
45: /// @notice Initializes a contract token for later use. Expected to be used in the proxy.
46: /// @dev Stores the L1 address of the bridge and set `name`/`symbol`/`decimals` getters that L1 token has.
47: /// @param _l1Address Address of the L1 token that can be deposited to mint this L2 token
48: /// @param _data The additional data that the L1 bridge provide for initialization.
49: /// In this case, it is packed `name`/`symbol`/`decimals` of the L1 token.
104: /// @notice A method to be called by the governor to update the token's metadata.
105: /// @param _availableGetters The getters that the token has.
106: /// @param _newName The new name of the token.
107: /// @param _newSymbol The new symbol of the token.
108: /// @param _version The version of the token that will be initialized.
109: /// @dev The _version must be exactly the version higher by 1 than the current version. This is needed
110: /// to ensure that the governor can not accidentally disable future reinitialization of the token.
141: /// @dev Mint tokens to a given account.
142: /// @param _to The account that will receive the created tokens.
143: /// @param _amount The amount that will be created.
144: /// @notice Should be called by bridge after depositing tokens from L1.
150: /// @dev Burn tokens from a given account.
151: /// @param _from The account from which tokens will be burned.
152: /// @param _amount The amount that will be burned.
153: /// @notice Should be called by bridge before withdrawing tokens to L1.
177: /// @dev External function to decode a string from bytes.
182: /// @dev External function to decode a uint8 from bytes.
```
[11](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L11) | [12](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L12) | [13](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L13) | [14](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L14) | [16](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L16) | [17](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L17) | [18](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L18) | [19](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L19) | [28](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L28) | [29](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L29) | [30](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L30) | [33](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L33) | [36](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L36) | [39](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L39) | [45](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L45) | [46](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L46) | [47](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L47) | [48](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L48) | [49](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L49) | [104](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L104) | [105](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L105) | [106](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L106) | [107](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L107) | [108](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L108) | [109](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L109) | [110](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L110) | [141](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L141) | [142](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L142) | [143](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L143) | [144](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L144) | [150](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L150) | [151](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L151) | [152](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L152) | [153](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L153) | [177](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L177) | [182](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L182)

```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL1ERC20Bridge.sol

5: /// @author Matter Labs
```
[5](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L5)

```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL1SharedBridge.sol

5: /// @title L1 Bridge contract interface
6: /// @author Matter Labs
7: /// @custom:security-contact security@matterlabs.dev
```
[5](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/interfaces/IL1SharedBridge.sol#L5) | [6](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/interfaces/IL1SharedBridge.sol#L6) | [7](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/interfaces/IL1SharedBridge.sol#L7)

```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol

5: /// @author Matter Labs
21: /// @dev Event emitted when baseToken is received by the contract.
```
[5](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol#L5) | [21](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol#L21)

```solidity
File: code/contracts/zksync/contracts/interfaces/IPaymaster.sol

15: /// @dev Called by the bootloader to verify that the paymaster agrees to pay for the
16: /// fee for the transaction. This transaction should also send the necessary amount of funds onto the bootloader
17: /// address.
18: /// @param _txHash The hash of the transaction
19: /// @param _suggestedSignedHash The hash of the transaction that is signed by an EOA
20: /// @param _transaction The transaction itself.
21: /// @return magic The value that should be equal to the signature of the validateAndPayForPaymasterTransaction
22: /// if the paymaster agrees to pay for the transaction.
23: /// @return context The "context" of the transaction: an array of bytes of length at most 1024 bytes, which will be
24: /// passed to the `postTransaction` method of the account.
25: /// @dev The developer should strive to preserve as many steps as possible both for valid
26: /// and invalid transactions as this very method is also used during the gas fee estimation
27: /// (without some of the necessary data, e.g. signature).
34: /// @dev Called by the bootloader after the execution of the transaction. Please note that
35: /// there is no guarantee that this method will be called at all. Unlike the original EIP4337,
36: /// this method won't be called if the transaction execution results in out-of-gas.
37: /// @param _context, the context of the execution, returned by the "validateAndPayForPaymasterTransaction" method.
38: /// @param  _transaction, the users' transaction.
39: /// @param _txResult, the result of the transaction execution (success or failure).
40: /// @param _maxRefundedGas, the upper bound on the amout of gas that could be refunded to the paymaster.
41: /// @dev The exact amount refunded depends on the gas spent by the "postOp" itself and so the developers should
42: /// take that into account.
```
[15](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/interfaces/IPaymaster.sol#L15) | [16](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/interfaces/IPaymaster.sol#L16) | [17](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/interfaces/IPaymaster.sol#L17) | [18](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/interfaces/IPaymaster.sol#L18) | [19](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/interfaces/IPaymaster.sol#L19) | [20](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/interfaces/IPaymaster.sol#L20) | [21](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/interfaces/IPaymaster.sol#L21) | [22](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/interfaces/IPaymaster.sol#L22) | [23](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/interfaces/IPaymaster.sol#L23) | [24](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/interfaces/IPaymaster.sol#L24) | [25](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/interfaces/IPaymaster.sol#L25) | [26](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/interfaces/IPaymaster.sol#L26) | [27](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/interfaces/IPaymaster.sol#L27) | [34](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/interfaces/IPaymaster.sol#L34) | [35](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/interfaces/IPaymaster.sol#L35) | [36](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/interfaces/IPaymaster.sol#L36) | [37](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/interfaces/IPaymaster.sol#L37) | [38](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/interfaces/IPaymaster.sol#L38) | [39](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/interfaces/IPaymaster.sol#L39) | [40](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/interfaces/IPaymaster.sol#L40) | [41](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/interfaces/IPaymaster.sol#L41) | [42](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/interfaces/IPaymaster.sol#L42)

```solidity
File: code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol

24: /// @notice Utility function converts the address that submitted a tx
25: /// to the inbox on L1 to the msg.sender viewed on L2
26: /// @param l1Address the address in the L1 that triggered the tx to L2
27: /// @return l2Address L2 address as viewed in msg.sender
34: /// @notice Utility function that converts the msg.sender viewed on L2 to the
35: /// address that submitted a tx to the inbox on L1
36: /// @param l2Address L2 address as viewed in msg.sender
37: /// @return l1Address the address in the L1 that triggered the tx to L2
```
[24](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol#L24) | [25](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol#L25) | [26](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol#L26) | [27](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol#L27) | [34](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol#L34) | [35](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol#L35) | [36](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol#L36) | [37](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol#L37)

```solidity
File: code/contracts/zksync/contracts/ForceDeployUpgrader.sol

7: /// @custom:security-contact security@matterlabs.dev
8: /// @notice The contract that calls force deployment during the L2 system contract upgrade.
9: /// @notice It is supposed to be used as an implementation of the ComplexUpgrader.
11: /// @notice A function that performs force deploy
12: /// @param _forceDeployments The force deployments to perform.
```
[7](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/ForceDeployUpgrader.sol#L7) | [8](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/ForceDeployUpgrader.sol#L8) | [9](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/ForceDeployUpgrader.sol#L9) | [11](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/ForceDeployUpgrader.sol#L11) | [12](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/ForceDeployUpgrader.sol#L12)

```solidity
File: code/contracts/zksync/contracts/L2ContractHelper.sol

19: /// @notice Sends an arbitrary length message to L1.
20: /// @param _message The variable length message to be sent to L1.
21: /// @return Returns the keccak256 hashed value of the message.
31: /// @notice A struct that describes a forced deployment on an address.
32: /// @param bytecodeHash The bytecode hash to put on an address.
33: /// @param newAddress The address on which to deploy the bytecodehash to.
34: /// @param callConstructor Whether to run the constructor on the force deployment.
35: /// @param value The `msg.value` with which to initialize a contract.
36: /// @param input The constructor calldata.
45: /// @notice This method is to be used only during an upgrade to set bytecodes on specific addresses.
46: /// @param _deployParams A set of parameters describing force deployment.
49: /// @notice Creates a new contract at a determined address using the `CREATE2` salt on L2
50: /// @param _salt a unique value to create the deterministic address of the new contract
51: /// @param _bytecodeHash the bytecodehash of the new contract to be deployed
52: /// @param _input the calldata to be sent to the constructor of the new contract
62: /// @notice Allows the withdrawal of ETH to a given L1 receiver along with an additional message.
63: /// @param _l1Receiver The address on L1 to receive the withdrawn ETH.
64: /// @param _additionalData Additional message or data to be sent alongside the withdrawal.
84: /// @dev The prefix used to create CREATE2 addresses.
87: /// @notice Sends L2 -> L1 arbitrary-long message through the system contract messenger.
88: /// @param _message Data to be sent to L1.
89: /// @return keccak256 hash of the sent message.
94: /// @notice Computes the create2 address for a Layer 2 contract.
95: /// @param _sender The address of the contract creator.
96: /// @param _salt The salt value to use in the create2 address computation.
97: /// @param _bytecodeHash The contract bytecode hash.
98: /// @param _constructorInputHash The keccak256 hash of the constructor input data.
99: /// @return The create2 address of the contract.
100: /// NOTE: L2 create2 derivation is different from L1 derivation!
116: /// @notice Structure used to represent a zkSync transaction.
```
[19](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/L2ContractHelper.sol#L19) | [20](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/L2ContractHelper.sol#L20) | [21](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/L2ContractHelper.sol#L21) | [31](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/L2ContractHelper.sol#L31) | [32](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/L2ContractHelper.sol#L32) | [33](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/L2ContractHelper.sol#L33) | [34](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/L2ContractHelper.sol#L34) | [35](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/L2ContractHelper.sol#L35) | [36](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/L2ContractHelper.sol#L36) | [45](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/L2ContractHelper.sol#L45) | [46](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/L2ContractHelper.sol#L46) | [49](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/L2ContractHelper.sol#L49) | [50](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/L2ContractHelper.sol#L50) | [51](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/L2ContractHelper.sol#L51) | [52](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/L2ContractHelper.sol#L52) | [62](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/L2ContractHelper.sol#L62) | [63](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/L2ContractHelper.sol#L63) | [64](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/L2ContractHelper.sol#L64) | [84](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/L2ContractHelper.sol#L84) | [87](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/L2ContractHelper.sol#L87) | [88](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/L2ContractHelper.sol#L88) | [89](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/L2ContractHelper.sol#L89) | [94](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/L2ContractHelper.sol#L94) | [95](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/L2ContractHelper.sol#L95) | [96](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/L2ContractHelper.sol#L96) | [97](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/L2ContractHelper.sol#L97) | [98](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/L2ContractHelper.sol#L98) | [99](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/L2ContractHelper.sol#L99) | [100](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/L2ContractHelper.sol#L100) | [116](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/L2ContractHelper.sol#L116)

```solidity
File: code/contracts/zksync/contracts/SystemContractsCaller.sol

8: /// @dev If the bitwise AND of the extraAbi[2] param when calling the MSG_VALUE_SIMULATOR
9: /// is non-zero, the call will be assumed to be a system one.
12: /// @notice The way to forward the calldata:
13: /// - Use the current heap (i.e. the same as on EVM).
14: /// - Use the auxiliary heap.
15: /// - Forward via a pointer
16: /// @dev Note, that currently, users do not have access to the auxiliary
17: /// heap and so the only type of forwarding that will be used by the users
18: /// are UseHeap and ForwardFatPointer for forwarding a slice of the current calldata
19: /// to the next call.
34: /// @notice The library contains the functions to make system calls.
35: /// @dev A more detailed description of the library and its methods can be found in the `system-contracts` repo.
```
[8](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/SystemContractsCaller.sol#L8) | [9](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/SystemContractsCaller.sol#L9) | [12](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/SystemContractsCaller.sol#L12) | [13](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/SystemContractsCaller.sol#L13) | [14](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/SystemContractsCaller.sol#L14) | [15](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/SystemContractsCaller.sol#L15) | [16](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/SystemContractsCaller.sol#L16) | [17](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/SystemContractsCaller.sol#L17) | [18](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/SystemContractsCaller.sol#L18) | [19](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/SystemContractsCaller.sol#L19) | [34](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/SystemContractsCaller.sol#L34) | [35](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/SystemContractsCaller.sol#L35)
</details>

### [N-45] Critical system parameter changes should be behind a timelock

It is a good practice to give time for users to react and adjust to critical changes. A timelock provides more guarantees and reduces the level of trust required, thus decreasing risk for users. It also indicates that the project is legitimate (less risk of a malicious owner making a sandwich attack on a user).

<details>
<summary><i>29 issue instances in 10 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

51: function setPendingAdmin(address _newPendingAdmin) external onlyOwnerOrAdmin {
108: function setSharedBridge(address _sharedBridge) external onlyOwner {
```
[51](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L51) | [108](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L108)

```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

249: function updateDelay(uint256 _newDelay) external onlySelf {
256: function updateSecurityCouncil(address _newSecurityCouncil) external onlySelf {
```
[249](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L249) | [256](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L256)

```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

110: function setPendingAdmin(address _newPendingAdmin) external onlyOwnerOrAdmin {
132: function setValidatorTimelock(address _validatorTimelock) external onlyOwnerOrAdmin {
137: function setInitialCutHash(Diamond.DiamondCutData calldata _diamondCut) external onlyOwner {
142: function setNewVersionUpgrade(
        Diamond.DiamondCutData calldata _cutData,
        uint256 _oldProtocolVersion,
        uint256 _newProtocolVersion
    ) external onlyOwner {
152: function setUpgradeDiamondCut(
        Diamond.DiamondCutData calldata _cutData,
        uint256 _oldProtocolVersion
    ) external onlyOwner {
```
[110](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L110) | [132](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L132) | [137](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L137) | [142](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L142) | [152](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L152)

```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

73: function setStateTransitionManager(IStateTransitionManager _stateTransitionManager) external onlyOwner {
96: function setExecutionDelay(uint32 _executionDelay) external onlyOwner {
```
[73](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L73) | [96](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L96)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol

23: function setPendingAdmin(address _newPendingAdmin) external onlyAdmin {
45: function setValidator(address _validator, bool _active) external onlyStateTransitionManager {
51: function setPorterAvailability(bool _zkPorterIsAvailable) external onlyStateTransitionManager {
58: function setPriorityTxMaxGasLimit(uint256 _newPriorityTxMaxGasLimit) external onlyStateTransitionManager {
67: function changeFeeParams(FeeParams calldata _newFeeParams) external onlyAdminOrStateTransitionManager {
79: function setTokenMultiplier(uint128 _nominator, uint128 _denominator) external onlyAdminOrStateTransitionManager {
88: function setValidiumMode(PubdataPricingMode _validiumMode) external onlyAdmin {
```
[23](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L23) | [45](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L45) | [51](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L51) | [58](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L58) | [67](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L67) | [79](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L79) | [88](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L88)

```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

65: function updateAccountVersion(AccountAbstractionVersion _version) external onlySystemCall {
74: function updateNonceOrdering(AccountNonceOrdering _nonceOrdering) external onlySystemCall {
```
[65](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L65) | [74](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L74)

```solidity
File: code/system-contracts/contracts/ImmutableSimulator.sol

34: function setImmutables(address _dest, ImmutableData[] calldata _immutables) external override {
```
[34](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ImmutableSimulator.sol#L34)

```solidity
File: code/system-contracts/contracts/NonceHolder.sol

82: function setValueUnderNonce(uint256 _key, uint256 _value) public onlySystemCall {
```
[82](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L82)

```solidity
File: code/system-contracts/contracts/SystemContext.sol

84: function setChainId(uint256 _newChainId) external onlyCallFromForceDeployer {
99: function setTxOrigin(address _newOrigin) external onlyCallFromBootloader {
105: function setGasPrice(uint256 _gasPrice) external onlyCallFromBootloader {
112: function setPubdataInfo(uint256 _gasPerPubdataByte, uint256 _basePubdataSpent) external onlyCallFromBootloader {
341: function setL2Block(
        uint128 _l2BlockNumber,
        uint128 _l2BlockTimestamp,
        bytes32 _expectedPrevL2BlockHash,
        bool _isFirstInBatch,
        uint128 _maxVirtualBlocksToCreate
    ) external onlyCallFromBootloader {
444: function setNewBatch(
        bytes32 _prevBatchHash,
        uint128 _newTimestamp,
        uint128 _expectedNewNumber,
        uint256 _baseFee
    ) external onlyCallFromBootloader {
```
[84](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L84) | [99](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L99) | [105](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L105) | [112](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L112) | [341](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L341) | [444](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L444)

```solidity
File: code/system-contracts/contracts/libraries/SystemContractHelper.sol

168: function setValueForNextFarCall(uint128 _value) internal returns (bool success) {
```
[168](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L168)
</details>

### [N-46] Outdated Solidity Version

The current Solidity version used in the contract is outdated.
Consider using a more recent version for improved features and security.

0.8.4: bytes.concat() instead of abi.encodePacked(,)

0.8.12: string.concat() instead of abi.encodePacked(,)

0.8.13: Ability to use using for with a list of free functions

0.8.14:
    ABI Encoder: When ABI-encoding values from calldata that contain nested arrays, correctly validate the nested array length against calldatasize() in all cases. Override Checker: Allow changing data location for parameters only when overriding external functions.

0.8.15:
    Code Generation: Avoid writing dirty bytes to storage when copying bytes arrays. Yul Optimizer: Keep all memory side-effects of inline assembly blocks.

0.8.16:
    Code Generation: Fix data corruption that affected ABI-encoding of calldata values represented by tuples: structs at any nesting level; argument lists of external functions, events and errors; return value lists of external functions. The 32 leading bytes of the first dynamically-encoded value in the tuple would get zeroed when the last component contained a statically-encoded array.

0.8.17:
    Yul Optimizer: Prevent the incorrect removal of storage writes before calls to Yul functions that conditionally terminate the external EVM call.

<details>
<summary><i>106 issue instances in 105 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

3: pragma solidity 0.8.20;
3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L3) | [3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L3)

```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L3)

```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L3)

```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L3)

```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L3)

```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L3)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol#L3)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol#L3)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L3)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L3)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L3)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L3)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L3)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L3)

```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L3)

```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L3)

```solidity
File: code/contracts/ethereum/contracts/upgrades/DefaultUpgrade.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/DefaultUpgrade.sol#L3)

```solidity
File: code/contracts/ethereum/contracts/upgrades/GenesisUpgrade.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/GenesisUpgrade.sol#L3)

```solidity
File: code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L3)

```solidity
File: code/contracts/ethereum/contracts/common/libraries/UncheckedMath.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/UncheckedMath.sol#L3)

```solidity
File: code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol#L3)

```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L3)

```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/LibMap.sol

2: pragma solidity 0.8.20;
```
[2](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/LibMap.sol#L2)

```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol#L3)

```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L3)

```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L3)

```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L3)

```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L3)

```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL2Bridge.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL2Bridge.sol#L3)

```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IWETH9.sol

2: pragma solidity 0.8.20;
```
[2](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IWETH9.sol#L2)

```solidity
File: code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L3)

```solidity
File: code/contracts/ethereum/contracts/common/interfaces/IL2ContractDeployer.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/interfaces/IL2ContractDeployer.sol#L3)

```solidity
File: code/contracts/ethereum/contracts/governance/IGovernance.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/IGovernance.sol#L3)

```solidity
File: code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L3)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L3)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol#L3)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L3)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L3)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/ILegacyGetters.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/ILegacyGetters.sol#L3)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L3)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IVerifier.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IVerifier.sol#L3)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol#L3)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransitionBase.sol

2: pragma solidity 0.8.20;
```
[2](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransitionBase.sol#L2)

```solidity
File: code/contracts/ethereum/contracts/state-transition/l2-deps/ISystemContext.sol

2: pragma solidity ^0.8.0;
```
[2](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/l2-deps/ISystemContext.sol#L2)

```solidity
File: code/contracts/ethereum/contracts/upgrades/IDefaultUpgrade.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/IDefaultUpgrade.sol#L3)

```solidity
File: code/contracts/ethereum/contracts/common/Config.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L3)

```solidity
File: code/contracts/ethereum/contracts/common/L2ContractAddresses.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/L2ContractAddresses.sol#L3)

```solidity
File: code/contracts/ethereum/contracts/common/Messaging.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Messaging.sol#L3)

```solidity
File: code/contracts/ethereum/contracts/common/ReentrancyGuard.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/ReentrancyGuard.sol#L3)

```solidity
File: code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol

19: pragma solidity 0.8.20;
```
[19](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol#L19)

```solidity
File: code/system-contracts/contracts/AccountCodeStorage.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/AccountCodeStorage.sol#L3)

```solidity
File: code/system-contracts/contracts/BootloaderUtilities.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L3)

```solidity
File: code/system-contracts/contracts/ComplexUpgrader.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ComplexUpgrader.sol#L3)

```solidity
File: code/system-contracts/contracts/Compressor.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L3)

```solidity
File: code/system-contracts/contracts/Constants.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L3)

```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L3)

```solidity
File: code/system-contracts/contracts/DefaultAccount.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L3)

```solidity
File: code/system-contracts/contracts/EmptyContract.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/EmptyContract.sol#L3)

```solidity
File: code/system-contracts/contracts/ImmutableSimulator.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ImmutableSimulator.sol#L3)

```solidity
File: code/system-contracts/contracts/KnownCodesStorage.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/KnownCodesStorage.sol#L3)

```solidity
File: code/system-contracts/contracts/L1Messenger.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L3)

```solidity
File: code/system-contracts/contracts/L2BaseToken.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L2BaseToken.sol#L3)

```solidity
File: code/system-contracts/contracts/MsgValueSimulator.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/MsgValueSimulator.sol#L3)

```solidity
File: code/system-contracts/contracts/NonceHolder.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L3)

```solidity
File: code/system-contracts/contracts/PubdataChunkPublisher.sol

2: pragma solidity 0.8.20;
```
[2](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/PubdataChunkPublisher.sol#L2)

```solidity
File: code/system-contracts/contracts/SystemContext.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L3)

```solidity
File: code/system-contracts/contracts/GasBoundCaller.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/GasBoundCaller.sol#L3)

```solidity
File: code/system-contracts/contracts/libraries/EfficientCall.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L3)

```solidity
File: code/system-contracts/contracts/libraries/RLPEncoder.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/RLPEncoder.sol#L3)

```solidity
File: code/system-contracts/contracts/libraries/SystemContractHelper.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L3)

```solidity
File: code/system-contracts/contracts/libraries/SystemContractsCaller.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L3)

```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L3)

```solidity
File: code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol#L3)

```solidity
File: code/system-contracts/contracts/libraries/Utils.sol

2: pragma solidity 0.8.20;
```
[2](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L2)

```solidity
File: code/system-contracts/contracts/interfaces/IAccount.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IAccount.sol#L3)

```solidity
File: code/system-contracts/contracts/interfaces/IAccountCodeStorage.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IAccountCodeStorage.sol#L3)

```solidity
File: code/system-contracts/contracts/interfaces/IBaseToken.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IBaseToken.sol#L3)

```solidity
File: code/system-contracts/contracts/interfaces/IBootloaderUtilities.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IBootloaderUtilities.sol#L3)

```solidity
File: code/system-contracts/contracts/interfaces/IComplexUpgrader.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IComplexUpgrader.sol#L3)

```solidity
File: code/system-contracts/contracts/interfaces/ICompressor.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/ICompressor.sol#L3)

```solidity
File: code/system-contracts/contracts/interfaces/IContractDeployer.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L3)

```solidity
File: code/system-contracts/contracts/interfaces/IImmutableSimulator.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IImmutableSimulator.sol#L3)

```solidity
File: code/system-contracts/contracts/interfaces/IKnownCodesStorage.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IKnownCodesStorage.sol#L3)

```solidity
File: code/system-contracts/contracts/interfaces/IL1Messenger.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IL1Messenger.sol#L3)

```solidity
File: code/system-contracts/contracts/interfaces/IL2StandardToken.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IL2StandardToken.sol#L3)

```solidity
File: code/system-contracts/contracts/interfaces/IMailbox.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IMailbox.sol#L3)

```solidity
File: code/system-contracts/contracts/interfaces/INonceHolder.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/INonceHolder.sol#L3)

```solidity
File: code/system-contracts/contracts/interfaces/IPaymaster.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IPaymaster.sol#L3)

```solidity
File: code/system-contracts/contracts/interfaces/IPaymasterFlow.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IPaymasterFlow.sol#L3)

```solidity
File: code/system-contracts/contracts/interfaces/IPubdataChunkPublisher.sol

2: pragma solidity 0.8.20;
```
[2](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IPubdataChunkPublisher.sol#L2)

```solidity
File: code/system-contracts/contracts/interfaces/ISystemContext.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/ISystemContext.sol#L3)

```solidity
File: code/system-contracts/contracts/interfaces/ISystemContextDeprecated.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/ISystemContextDeprecated.sol#L3)

```solidity
File: code/system-contracts/contracts/interfaces/ISystemContract.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/ISystemContract.sol#L3)

```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L3)

```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L3)

```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL1ERC20Bridge.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L3)

```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL1SharedBridge.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/interfaces/IL1SharedBridge.sol#L3)

```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol#L3)

```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol#L3)

```solidity
File: code/contracts/zksync/contracts/interfaces/IPaymaster.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/interfaces/IPaymaster.sol#L3)

```solidity
File: code/contracts/zksync/contracts/interfaces/IPaymasterFlow.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/interfaces/IPaymasterFlow.sol#L3)

```solidity
File: code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol

19: pragma solidity 0.8.20;
```
[19](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol#L19)

```solidity
File: code/contracts/zksync/contracts/ForceDeployUpgrader.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/ForceDeployUpgrader.sol#L3)

```solidity
File: code/contracts/zksync/contracts/L2ContractHelper.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/L2ContractHelper.sol#L3)

```solidity
File: code/contracts/zksync/contracts/SystemContractsCaller.sol

3: pragma solidity 0.8.20;
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/SystemContractsCaller.sol#L3)
</details>

### [N-47] Library Should be in a Separate File

Libraries should be declared in a separate file, variables/structs/errors/enums/constants etc should not be declared in the same file as library.
If they used in library, they should be declared in library scope.

<details>
<summary><i>7 issue instances in 6 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol

20: library PriorityQueue {
```
[20](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L20)

```solidity
File: code/system-contracts/contracts/libraries/SystemContractHelper.sol

41: library SystemContractHelper {
```
[41](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L41)

```solidity
File: code/system-contracts/contracts/libraries/SystemContractsCaller.sol

68: library SystemContractsCaller {
```
[68](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L68)

```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

78: library TransactionHelper {
```
[78](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L78)

```solidity
File: code/contracts/zksync/contracts/L2ContractHelper.sol

83: library L2ContractHelper {
```
[83](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/L2ContractHelper.sol#L83)

```solidity
File: code/contracts/zksync/contracts/SystemContractsCaller.sol

25: library Utils {
36: library SystemContractsCaller {
```
[25](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/SystemContractsCaller.sol#L25) | [36](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/SystemContractsCaller.sol#L36)
</details>

### [N-48] Ensure Non-Empty Check for Bytes in Function Parameters

To avoid mistakenly accepting empty bytes as valid parameters, it is advisable to implement checks for non-empty bytes within functions.
This ensures that empty bytes are not treated as valid inputs, preventing potential issues.

<details>
<summary><i>159 issue instances in 46 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

176: function claimFailedDeposit(
        address _depositSender,
        address _l1Token,
        bytes32 _l2TxHash,
        uint256 _l2BatchNumber,
        uint256 _l2MessageIndex,
        uint16 _l2TxNumberInBatch,
        bytes32[] calldata _merkleProof
    ) external nonReentrant {
208: function finalizeWithdrawal(
        uint256 _l2BatchNumber,
        uint256 _l2MessageIndex,
        uint16 _l2TxNumberInBatch,
        bytes calldata _message,
        bytes32[] calldata _merkleProof
    ) external nonReentrant {
176: function claimFailedDeposit(
        address _depositSender,
        address _l1Token,
        bytes32 _l2TxHash,
        uint256 _l2BatchNumber,
        uint256 _l2MessageIndex,
        uint16 _l2TxNumberInBatch,
        bytes32[] calldata _merkleProof
    ) external nonReentrant {
208: function finalizeWithdrawal(
        uint256 _l2BatchNumber,
        uint256 _l2MessageIndex,
        uint16 _l2TxNumberInBatch,
        bytes calldata _message,
        bytes32[] calldata _merkleProof
    ) external nonReentrant {
```
[176](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L176) | [208](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L208) | [176](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L176) | [208](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L208)

```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

182: function bridgehubDeposit(
        uint256 _chainId,
        address _prevMsgSender,
        uint256, // l2Value, needed for Weth deposits in the future
        bytes calldata _data
    ) external payable override onlyBridgehub returns (L2TransactionRequestTwoBridgesInner memory request) {
232: function bridgehubConfirmL2Transaction(
        uint256 _chainId,
        bytes32 _txDataHash,
        bytes32 _txHash
    ) external override onlyBridgehub {
232: function bridgehubConfirmL2Transaction(
        uint256 _chainId,
        bytes32 _txDataHash,
        bytes32 _txHash
    ) external override onlyBridgehub {
277: function claimFailedDeposit(
        uint256 _chainId,
        address _depositSender,
        address _l1Token,
        uint256 _amount,
        bytes32 _l2TxHash,
        uint256 _l2BatchNumber,
        uint256 _l2MessageIndex,
        uint16 _l2TxNumberInBatch,
        bytes32[] calldata _merkleProof
    ) external override {
385: function finalizeWithdrawal(
        uint256 _chainId,
        uint256 _l2BatchNumber,
        uint256 _l2MessageIndex,
        uint16 _l2TxNumberInBatch,
        bytes calldata _message,
        bytes32[] calldata _merkleProof
    ) external override {
615: function finalizeWithdrawalLegacyErc20Bridge(
        uint256 _l2BatchNumber,
        uint256 _l2MessageIndex,
        uint16 _l2TxNumberInBatch,
        bytes calldata _message,
        bytes32[] calldata _merkleProof
    ) external override onlyLegacyBridge returns (address l1Receiver, address l1Token, uint256 amount) {
644: function claimFailedDepositLegacyErc20Bridge(
        address _depositSender,
        address _l1Token,
        uint256 _amount,
        bytes32 _l2TxHash,
        uint256 _l2BatchNumber,
        uint256 _l2MessageIndex,
        uint16 _l2TxNumberInBatch,
        bytes32[] calldata _merkleProof
    ) external override onlyLegacyBridge {
```
[182](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L182) | [232](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L232) | [232](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L232) | [277](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L277) | [385](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L385) | [615](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L615) | [644](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L644)

```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

114: function createNewChain(
        uint256 _chainId,
        address _stateTransitionManager,
        address _baseToken,
        uint256, //_salt
        address _admin,
        bytes calldata _initData
    ) external onlyOwnerOrAdmin nonReentrant returns (uint256 chainId) {
176: function proveL1ToL2TransactionStatus(
        uint256 _chainId,
        bytes32 _l2TxHash,
        uint256 _l2BatchNumber,
        uint256 _l2MessageIndex,
        uint16 _l2TxNumberInBatch,
        bytes32[] calldata _merkleProof,
        TxStatus _status
    ) external view override returns (bool) {
```
[114](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L114) | [176](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L176)

```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

84: function isOperation(bytes32 _id) public view returns (bool) {
89: function isOperationPending(bytes32 _id) public view returns (bool) {
95: function isOperationReady(bytes32 _id) public view returns (bool) {
100: function isOperationDone(bytes32 _id) public view returns (bool) {
105: function getOperationState(bytes32 _id) public view returns (OperationState) {
142: function scheduleShadow(bytes32 _id, uint256 _delay) external onlyOwner {
154: function cancel(bytes32 _id) external onlyOwner {
```
[84](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L84) | [89](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L89) | [95](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L95) | [100](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L100) | [105](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L105) | [142](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L142) | [154](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L154)

```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

239: function createNewChain(
        uint256 _chainId,
        address _baseToken,
        address _sharedBridge,
        address _admin,
        bytes calldata _diamondCut
    ) external onlyBridgehub {
```
[239](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L239)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol

181: function isFunctionFreezable(bytes4 _selector) external view returns (bool) {
229: function facetAddress(bytes4 _selector) external view returns (address) {
```
[181](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L181) | [229](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L229)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

74: function proveL1ToL2TransactionStatus(
        bytes32 _l2TxHash,
        uint256 _l2BatchNumber,
        uint256 _l2MessageIndex,
        uint16 _l2TxNumberInBatch,
        bytes32[] calldata _merkleProof,
        TxStatus _status
    ) public view returns (bool) {
178: function finalizeEthWithdrawal(
        uint256 _l2BatchNumber,
        uint256 _l2MessageIndex,
        uint16 _l2TxNumberInBatch,
        bytes calldata _message,
        bytes32[] calldata _merkleProof
    ) external nonReentrant {
197: function requestL2Transaction(
        address _contractL2,
        uint256 _l2Value,
        bytes calldata _calldata,
        uint256 _l2GasLimit,
        uint256 _l2GasPerPubdataByteLimit,
        bytes[] calldata _factoryDeps,
        address _refundRecipient
    ) external payable returns (bytes32 canonicalTxHash) {
```
[74](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L74) | [178](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L178) | [197](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L197)

```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol

42: function claimFailedDeposit(
        address _depositSender,
        address _l1Token,
        bytes32 _l2TxHash,
        uint256 _l2BatchNumber,
        uint256 _l2MessageIndex,
        uint16 _l2TxNumberInBatch,
        bytes32[] calldata _merkleProof
    ) external;
52: function finalizeWithdrawal(
        uint256 _l2BatchNumber,
        uint256 _l2MessageIndex,
        uint16 _l2TxNumberInBatch,
        bytes calldata _message,
        bytes32[] calldata _merkleProof
    ) external;
68: function depositAmount(
        address _account,
        address _l1Token,
        bytes32 _depositL2TxHash
    ) external returns (uint256 amount);
```
[42](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L42) | [52](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L52) | [68](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L68)

```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol

73: function claimFailedDepositLegacyErc20Bridge(
        address _depositSender,
        address _l1Token,
        uint256 _amount,
        bytes32 _l2TxHash,
        uint256 _l2BatchNumber,
        uint256 _l2MessageIndex,
        uint16 _l2TxNumberInBatch,
        bytes32[] calldata _merkleProof
    ) external;
84: function claimFailedDeposit(
        uint256 _chainId,
        address _depositSender,
        address _l1Token,
        uint256 _amount,
        bytes32 _l2TxHash,
        uint256 _l2BatchNumber,
        uint256 _l2MessageIndex,
        uint16 _l2TxNumberInBatch,
        bytes32[] calldata _merkleProof
    ) external;
96: function finalizeWithdrawalLegacyErc20Bridge(
        uint256 _l2BatchNumber,
        uint256 _l2MessageIndex,
        uint16 _l2TxNumberInBatch,
        bytes calldata _message,
        bytes32[] calldata _merkleProof
    ) external returns (address l1Receiver, address l1Token, uint256 amount);
104: function finalizeWithdrawal(
        uint256 _chainId,
        uint256 _l2BatchNumber,
        uint256 _l2MessageIndex,
        uint16 _l2TxNumberInBatch,
        bytes calldata _message,
        bytes32[] calldata _merkleProof
    ) external;
121: function depositHappened(uint256 _chainId, bytes32 _l2TxHash) external view returns (bytes32);
128: function bridgehubDeposit(
        uint256 _chainId,
        address _prevMsgSender,
        uint256 _l2Value,
        bytes calldata _data
    ) external payable returns (L2TransactionRequestTwoBridgesInner memory request);
141: function bridgehubConfirmL2Transaction(uint256 _chainId, bytes32 _txDataHash, bytes32 _txHash) external;
141: function bridgehubConfirmL2Transaction(uint256 _chainId, bytes32 _txDataHash, bytes32 _txHash) external;
```
[73](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L73) | [84](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L84) | [96](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L96) | [104](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L104) | [121](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L121) | [128](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L128) | [141](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L141) | [141](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L141)

```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL2Bridge.sol

7: function finalizeDeposit(
        address _l1Sender,
        address _l2Receiver,
        address _l1Token,
        uint256 _amount,
        bytes calldata _data
    ) external payable;
```
[7](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL2Bridge.sol#L7)

```solidity
File: code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol

88: function proveL1ToL2TransactionStatus(
        uint256 _chainId,
        bytes32 _l2TxHash,
        uint256 _l2BatchNumber,
        uint256 _l2MessageIndex,
        uint16 _l2TxNumberInBatch,
        bytes32[] calldata _merkleProof,
        TxStatus _status
    ) external view returns (bool);
115: function createNewChain(
        uint256 _chainId,
        address _stateTransitionManager,
        address _baseToken,
        uint256 _salt,
        address _admin,
        bytes calldata _initData
    ) external returns (uint256 chainId);
```
[88](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L88) | [115](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L115)

```solidity
File: code/contracts/ethereum/contracts/common/interfaces/IL2ContractDeployer.sol

31: function create2(bytes32 _salt, bytes32 _bytecodeHash, bytes calldata _input) external;
31: function create2(bytes32 _salt, bytes32 _bytecodeHash, bytes calldata _input) external;
31: function create2(bytes32 _salt, bytes32 _bytecodeHash, bytes calldata _input) external;
```
[31](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/interfaces/IL2ContractDeployer.sol#L31) | [31](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/interfaces/IL2ContractDeployer.sol#L31) | [31](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/interfaces/IL2ContractDeployer.sol#L31)

```solidity
File: code/contracts/ethereum/contracts/governance/IGovernance.sol

40: function isOperation(bytes32 _id) external view returns (bool);
42: function isOperationPending(bytes32 _id) external view returns (bool);
44: function isOperationReady(bytes32 _id) external view returns (bool);
46: function isOperationDone(bytes32 _id) external view returns (bool);
48: function getOperationState(bytes32 _id) external view returns (OperationState);
52: function scheduleShadow(bytes32 _id, uint256 _delay) external;
54: function cancel(bytes32 _id) external;
```
[40](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/IGovernance.sol#L40) | [42](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/IGovernance.sol#L42) | [44](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/IGovernance.sol#L44) | [46](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/IGovernance.sol#L46) | [48](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/IGovernance.sol#L48) | [52](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/IGovernance.sol#L52) | [54](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/IGovernance.sol#L54)

```solidity
File: code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol

74: function createNewChain(
        uint256 _chainId,
        address _baseToken,
        address _sharedBridge,
        address _admin,
        bytes calldata _diamondCut
    ) external;
```
[74](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L74)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol

139: function facetAddress(bytes4 _selector) external view returns (address facet);
142: function isFunctionFreezable(bytes4 _selector) external view returns (bool);
```
[139](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L139) | [142](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L142)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol

47: function proveL1ToL2TransactionStatus(
        bytes32 _l2TxHash,
        uint256 _l2BatchNumber,
        uint256 _l2MessageIndex,
        uint16 _l2TxNumberInBatch,
        bytes32[] calldata _merkleProof,
        TxStatus _status
    ) external view returns (bool);
62: function finalizeEthWithdrawal(
        uint256 _l2BatchNumber,
        uint256 _l2MessageIndex,
        uint16 _l2TxNumberInBatch,
        bytes calldata _message,
        bytes32[] calldata _merkleProof
    ) external;
88: function requestL2Transaction(
        address _contractL2,
        uint256 _l2Value,
        bytes calldata _calldata,
        uint256 _l2GasLimit,
        uint256 _l2GasPerPubdataByteLimit,
        bytes[] calldata _factoryDeps,
        address _refundRecipient
    ) external payable returns (bytes32 canonicalTxHash);
```
[47](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L47) | [62](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L62) | [88](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L88)

```solidity
File: code/system-contracts/contracts/AccountCodeStorage.sol

35: function storeAccountConstructingCodeHash(address _address, bytes32 _hash) external override onlyDeployer {
46: function storeAccountConstructedCodeHash(address _address, bytes32 _hash) external override onlyDeployer {
```
[35](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/AccountCodeStorage.sol#L35) | [46](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/AccountCodeStorage.sol#L46)

```solidity
File: code/system-contracts/contracts/Compressor.sol

44: function publishCompressedBytecode(
        bytes calldata _bytecode,
        bytes calldata _rawCompressedData
    ) external payable onlyCallFromBootloader returns (bytes32 bytecodeHash) {
44: function publishCompressedBytecode(
        bytes calldata _bytecode,
        bytes calldata _rawCompressedData
    ) external payable onlyCallFromBootloader returns (bytes32 bytecodeHash) {
110: function verifyCompressedStateDiffs(
        uint256 _numberOfStateDiffs,
        uint256 _enumerationIndexSize,
        bytes calldata _stateDiffs,
        bytes calldata _compressedStateDiffs
    ) external payable onlyCallFrom(address(L1_MESSENGER_CONTRACT)) returns (bytes32 stateDiffHash) {
110: function verifyCompressedStateDiffs(
        uint256 _numberOfStateDiffs,
        uint256 _enumerationIndexSize,
        bytes calldata _stateDiffs,
        bytes calldata _compressedStateDiffs
    ) external payable onlyCallFrom(address(L1_MESSENGER_CONTRACT)) returns (bytes32 stateDiffHash) {
```
[44](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L44) | [44](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L44) | [110](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L110) | [110](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L110)

```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

95: function getNewAddressCreate2(
        address _sender,
        bytes32 _bytecodeHash,
        bytes32 _salt,
        bytes calldata _input
    ) public view override returns (address newAddress) {
95: function getNewAddressCreate2(
        address _sender,
        bytes32 _bytecodeHash,
        bytes32 _salt,
        bytes calldata _input
    ) public view override returns (address newAddress) {
95: function getNewAddressCreate2(
        address _sender,
        bytes32 _bytecodeHash,
        bytes32 _salt,
        bytes calldata _input
    ) public view override returns (address newAddress) {
132: function create2(
        bytes32 _salt,
        bytes32 _bytecodeHash,
        bytes calldata _input
    ) external payable override returns (address) {
132: function create2(
        bytes32 _salt,
        bytes32 _bytecodeHash,
        bytes calldata _input
    ) external payable override returns (address) {
132: function create2(
        bytes32 _salt,
        bytes32 _bytecodeHash,
        bytes calldata _input
    ) external payable override returns (address) {
147: function create(
        bytes32 _salt,
        bytes32 _bytecodeHash,
        bytes calldata _input
    ) external payable override returns (address) {
147: function create(
        bytes32 _salt,
        bytes32 _bytecodeHash,
        bytes calldata _input
    ) external payable override returns (address) {
147: function create(
        bytes32 _salt,
        bytes32 _bytecodeHash,
        bytes calldata _input
    ) external payable override returns (address) {
162: function create2Account(
        bytes32 _salt,
        bytes32 _bytecodeHash,
        bytes calldata _input,
        AccountAbstractionVersion _aaVersion
    ) public payable override onlySystemCall returns (address) {
162: function create2Account(
        bytes32 _salt,
        bytes32 _bytecodeHash,
        bytes calldata _input,
        AccountAbstractionVersion _aaVersion
    ) public payable override onlySystemCall returns (address) {
162: function create2Account(
        bytes32 _salt,
        bytes32 _bytecodeHash,
        bytes calldata _input,
        AccountAbstractionVersion _aaVersion
    ) public payable override onlySystemCall returns (address) {
182: function createAccount(
        bytes32, // salt
        bytes32 _bytecodeHash,
        bytes calldata _input,
        AccountAbstractionVersion _aaVersion
    ) public payable override onlySystemCall returns (address) {
182: function createAccount(
        bytes32, // salt
        bytes32 _bytecodeHash,
        bytes calldata _input,
        AccountAbstractionVersion _aaVersion
    ) public payable override onlySystemCall returns (address) {
```
[95](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L95) | [95](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L95) | [95](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L95) | [132](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L132) | [132](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L132) | [132](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L132) | [147](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L147) | [147](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L147) | [147](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L147) | [162](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L162) | [162](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L162) | [162](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L162) | [182](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L182) | [182](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L182)

```solidity
File: code/system-contracts/contracts/DefaultAccount.sol

67: function validateTransaction(
        bytes32, // _txHash
        bytes32 _suggestedSignedHash,
        Transaction calldata _transaction
    ) external payable override ignoreNonBootloader ignoreInDelegateCall returns (bytes4 magic) {
112: function executeTransaction(
        bytes32, // _txHash
        bytes32, // _suggestedSignedHash
        Transaction calldata _transaction
    ) external payable override ignoreNonBootloader ignoreInDelegateCall {
196: function payForTransaction(
        bytes32, // _txHash
        bytes32, // _suggestedSignedHash
        Transaction calldata _transaction
    ) external payable ignoreNonBootloader ignoreInDelegateCall {
212: function prepareForPaymaster(
        bytes32, // _txHash
        bytes32, // _suggestedSignedHash
        Transaction calldata _transaction
    ) external payable ignoreNonBootloader ignoreInDelegateCall {
```
[67](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L67) | [112](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L112) | [196](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L196) | [212](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L212)

```solidity
File: code/system-contracts/contracts/KnownCodesStorage.sol

39: function markBytecodeAsPublished(bytes32 _bytecodeHash) external onlyCompressor {
65: function getMarker(bytes32 _hash) public view override returns (uint256 marker) {
```
[39](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/KnownCodesStorage.sol#L39) | [65](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/KnownCodesStorage.sol#L65)

```solidity
File: code/system-contracts/contracts/L1Messenger.sol

70: function sendL2ToL1Log(
        bool _isService,
        bytes32 _key,
        bytes32 _value
    ) external onlyCallFromSystemContract returns (uint256 logIdInMerkleTree) {
70: function sendL2ToL1Log(
        bool _isService,
        bytes32 _key,
        bytes32 _value
    ) external onlyCallFromSystemContract returns (uint256 logIdInMerkleTree) {
116: function sendToL1(bytes calldata _message) external override returns (bytes32 hash) {
161: function requestBytecodeL1Publication(
        bytes32 _bytecodeHash
    ) external override onlyCallFrom(address(KNOWN_CODE_STORAGE_CONTRACT)) {
194: function publishPubdataAndClearState(
        bytes calldata _totalL2ToL1PubdataAndStateDiffs
    ) external onlyCallFromBootloader {
```
[70](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L70) | [70](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L70) | [116](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L116) | [161](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L161) | [194](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L194)

```solidity
File: code/system-contracts/contracts/L2BaseToken.sol

85: function withdrawWithMessage(address _l1Receiver, bytes memory _additionalData) external payable override {
```
[85](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L2BaseToken.sol#L85)

```solidity
File: code/system-contracts/contracts/PubdataChunkPublisher.sol

21: function chunkAndPublishPubdata(bytes calldata _pubdata) external onlyCallFrom(address(L1_MESSENGER_CONTRACT)) {
```
[21](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/PubdataChunkPublisher.sol#L21)

```solidity
File: code/system-contracts/contracts/SystemContext.sol

341: function setL2Block(
        uint128 _l2BlockNumber,
        uint128 _l2BlockTimestamp,
        bytes32 _expectedPrevL2BlockHash,
        bool _isFirstInBatch,
        uint128 _maxVirtualBlocksToCreate
    ) external onlyCallFromBootloader {
402: function appendTransactionToCurrentL2Block(bytes32 _txHash) external onlyCallFromBootloader {
444: function setNewBatch(
        bytes32 _prevBatchHash,
        uint128 _newTimestamp,
        uint128 _expectedNewNumber,
        uint256 _baseFee
    ) external onlyCallFromBootloader {
```
[341](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L341) | [402](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L402) | [444](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L444)

```solidity
File: code/system-contracts/contracts/GasBoundCaller.sol

35: function gasBoundCall(address _to, uint256 _maxTotalGas, bytes calldata _data) external payable {
```
[35](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/GasBoundCaller.sol#L35)

```solidity
File: code/system-contracts/contracts/interfaces/IAccount.sol

20: function validateTransaction(
        bytes32 _txHash,
        bytes32 _suggestedSignedHash,
        Transaction calldata _transaction
    ) external payable returns (bytes4 magic);
20: function validateTransaction(
        bytes32 _txHash,
        bytes32 _suggestedSignedHash,
        Transaction calldata _transaction
    ) external payable returns (bytes4 magic);
25: function executeTransaction(
        bytes32 _txHash,
        bytes32 _suggestedSignedHash,
        Transaction calldata _transaction
    ) external payable;
25: function executeTransaction(
        bytes32 _txHash,
        bytes32 _suggestedSignedHash,
        Transaction calldata _transaction
    ) external payable;
35: function payForTransaction(
        bytes32 _txHash,
        bytes32 _suggestedSignedHash,
        Transaction calldata _transaction
    ) external payable;
35: function payForTransaction(
        bytes32 _txHash,
        bytes32 _suggestedSignedHash,
        Transaction calldata _transaction
    ) external payable;
41: function prepareForPaymaster(
        bytes32 _txHash,
        bytes32 _possibleSignedHash,
        Transaction calldata _transaction
    ) external payable;
41: function prepareForPaymaster(
        bytes32 _txHash,
        bytes32 _possibleSignedHash,
        Transaction calldata _transaction
    ) external payable;
```
[20](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IAccount.sol#L20) | [20](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IAccount.sol#L20) | [25](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IAccount.sol#L25) | [25](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IAccount.sol#L25) | [35](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IAccount.sol#L35) | [35](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IAccount.sol#L35) | [41](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IAccount.sol#L41) | [41](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IAccount.sol#L41)

```solidity
File: code/system-contracts/contracts/interfaces/IAccountCodeStorage.sol

6: function storeAccountConstructingCodeHash(address _address, bytes32 _hash) external;
7: function storeAccountConstructedCodeHash(address _address, bytes32 _hash) external;
```
[6](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IAccountCodeStorage.sol#L6) | [7](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IAccountCodeStorage.sol#L7)

```solidity
File: code/system-contracts/contracts/interfaces/IBaseToken.sol

21: function withdrawWithMessage(address _l1Receiver, bytes calldata _additionalData) external payable;
```
[21](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IBaseToken.sol#L21)

```solidity
File: code/system-contracts/contracts/interfaces/IComplexUpgrader.sol

11: function upgrade(address _delegateTo, bytes calldata _calldata) external payable;
```
[11](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IComplexUpgrader.sol#L11)

```solidity
File: code/system-contracts/contracts/interfaces/ICompressor.sol

19: function publishCompressedBytecode(
        bytes calldata _bytecode,
        bytes calldata _rawCompressedData
    ) external payable returns (bytes32 bytecodeHash);
19: function publishCompressedBytecode(
        bytes calldata _bytecode,
        bytes calldata _rawCompressedData
    ) external payable returns (bytes32 bytecodeHash);
23: function verifyCompressedStateDiffs(
        uint256 _numberOfStateDiffs,
        uint256 _enumerationIndexSize,
        bytes calldata _stateDiffs,
        bytes calldata _compressedStateDiffs
    ) external payable returns (bytes32 stateDiffHash);
23: function verifyCompressedStateDiffs(
        uint256 _numberOfStateDiffs,
        uint256 _enumerationIndexSize,
        bytes calldata _stateDiffs,
        bytes calldata _compressedStateDiffs
    ) external payable returns (bytes32 stateDiffHash);
```
[19](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/ICompressor.sol#L19) | [19](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/ICompressor.sol#L19) | [23](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/ICompressor.sol#L23) | [23](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/ICompressor.sol#L23)

```solidity
File: code/system-contracts/contracts/interfaces/IContractDeployer.sol

42: function getNewAddressCreate2(
        address _sender,
        bytes32 _bytecodeHash,
        bytes32 _salt,
        bytes calldata _input
    ) external view returns (address newAddress);
42: function getNewAddressCreate2(
        address _sender,
        bytes32 _bytecodeHash,
        bytes32 _salt,
        bytes calldata _input
    ) external view returns (address newAddress);
42: function getNewAddressCreate2(
        address _sender,
        bytes32 _bytecodeHash,
        bytes32 _salt,
        bytes calldata _input
    ) external view returns (address newAddress);
51: function create2(
        bytes32 _salt,
        bytes32 _bytecodeHash,
        bytes calldata _input
    ) external payable returns (address newAddress);
51: function create2(
        bytes32 _salt,
        bytes32 _bytecodeHash,
        bytes calldata _input
    ) external payable returns (address newAddress);
51: function create2(
        bytes32 _salt,
        bytes32 _bytecodeHash,
        bytes calldata _input
    ) external payable returns (address newAddress);
57: function create2Account(
        bytes32 _salt,
        bytes32 _bytecodeHash,
        bytes calldata _input,
        AccountAbstractionVersion _aaVersion
    ) external payable returns (address newAddress);
57: function create2Account(
        bytes32 _salt,
        bytes32 _bytecodeHash,
        bytes calldata _input,
        AccountAbstractionVersion _aaVersion
    ) external payable returns (address newAddress);
57: function create2Account(
        bytes32 _salt,
        bytes32 _bytecodeHash,
        bytes calldata _input,
        AccountAbstractionVersion _aaVersion
    ) external payable returns (address newAddress);
68: function create(
        bytes32 _salt,
        bytes32 _bytecodeHash,
        bytes calldata _input
    ) external payable returns (address newAddress);
68: function create(
        bytes32 _salt,
        bytes32 _bytecodeHash,
        bytes calldata _input
    ) external payable returns (address newAddress);
68: function create(
        bytes32 _salt,
        bytes32 _bytecodeHash,
        bytes calldata _input
    ) external payable returns (address newAddress);
76: function createAccount(
        bytes32 _salt,
        bytes32 _bytecodeHash,
        bytes calldata _input,
        AccountAbstractionVersion _aaVersion
    ) external payable returns (address newAddress);
76: function createAccount(
        bytes32 _salt,
        bytes32 _bytecodeHash,
        bytes calldata _input,
        AccountAbstractionVersion _aaVersion
    ) external payable returns (address newAddress);
76: function createAccount(
        bytes32 _salt,
        bytes32 _bytecodeHash,
        bytes calldata _input,
        AccountAbstractionVersion _aaVersion
    ) external payable returns (address newAddress);
```
[42](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L42) | [42](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L42) | [42](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L42) | [51](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L51) | [51](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L51) | [51](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L51) | [57](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L57) | [57](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L57) | [57](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L57) | [68](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L68) | [68](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L68) | [68](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L68) | [76](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L76) | [76](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L76) | [76](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L76)

```solidity
File: code/system-contracts/contracts/interfaces/IKnownCodesStorage.sol

15: function markBytecodeAsPublished(bytes32 _bytecodeHash) external;
17: function getMarker(bytes32 _hash) external view returns (uint256);
```
[15](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IKnownCodesStorage.sol#L15) | [17](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IKnownCodesStorage.sol#L17)

```solidity
File: code/system-contracts/contracts/interfaces/IL1Messenger.sol

48: function sendToL1(bytes memory _message) external returns (bytes32);
50: function sendL2ToL1Log(bool _isService, bytes32 _key, bytes32 _value) external returns (uint256 logIdInMerkleTree);
50: function sendL2ToL1Log(bool _isService, bytes32 _key, bytes32 _value) external returns (uint256 logIdInMerkleTree);
54: function requestBytecodeL1Publication(bytes32 _bytecodeHash) external;
```
[48](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IL1Messenger.sol#L48) | [50](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IL1Messenger.sol#L50) | [50](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IL1Messenger.sol#L50) | [54](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IL1Messenger.sol#L54)

```solidity
File: code/system-contracts/contracts/interfaces/IMailbox.sol

6: function finalizeEthWithdrawal(
        uint256 _l2BatchNumber,
        uint256 _l2MessageIndex,
        uint16 _l2TxNumberInBlock,
        bytes calldata _message,
        bytes32[] calldata _merkleProof
    ) external;
```
[6](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IMailbox.sol#L6)

```solidity
File: code/system-contracts/contracts/interfaces/IPaymaster.sol

28: function validateAndPayForPaymasterTransaction(
        bytes32 _txHash,
        bytes32 _suggestedSignedHash,
        Transaction calldata _transaction
    ) external payable returns (bytes4 magic, bytes memory context);
28: function validateAndPayForPaymasterTransaction(
        bytes32 _txHash,
        bytes32 _suggestedSignedHash,
        Transaction calldata _transaction
    ) external payable returns (bytes4 magic, bytes memory context);
43: function postTransaction(
        bytes calldata _context,
        Transaction calldata _transaction,
        bytes32 _txHash,
        bytes32 _suggestedSignedHash,
        ExecutionResult _txResult,
        uint256 _maxRefundedGas
    ) external payable;
43: function postTransaction(
        bytes calldata _context,
        Transaction calldata _transaction,
        bytes32 _txHash,
        bytes32 _suggestedSignedHash,
        ExecutionResult _txResult,
        uint256 _maxRefundedGas
    ) external payable;
43: function postTransaction(
        bytes calldata _context,
        Transaction calldata _transaction,
        bytes32 _txHash,
        bytes32 _suggestedSignedHash,
        ExecutionResult _txResult,
        uint256 _maxRefundedGas
    ) external payable;
```
[28](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IPaymaster.sol#L28) | [28](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IPaymaster.sol#L28) | [43](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IPaymaster.sol#L43) | [43](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IPaymaster.sol#L43) | [43](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IPaymaster.sol#L43)

```solidity
File: code/system-contracts/contracts/interfaces/IPaymasterFlow.sol

13: function general(bytes calldata input) external;
14: function approvalBased(address _token, uint256 _minAllowance, bytes calldata _innerInput) external;
```
[13](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IPaymasterFlow.sol#L13) | [14](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IPaymasterFlow.sol#L14)

```solidity
File: code/system-contracts/contracts/interfaces/IPubdataChunkPublisher.sol

12: function chunkAndPublishPubdata(bytes calldata _pubdata) external;
```
[12](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IPubdataChunkPublisher.sol#L12)

```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

49: function initialize(
        address _l1Bridge,
        address _l1LegecyBridge,
        bytes32 _l2TokenProxyBytecodeHash,
        address _aliasedOwner
    ) external reinitializer(2) {
79: function finalizeDeposit(
        address _l1Sender,
        address _l2Receiver,
        address _l1Token,
        uint256 _amount,
        bytes calldata _data
    ) external payable override {
```
[49](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L49) | [79](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L79)

```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

50: function bridgeInitialize(address _l1Address, bytes memory _data) external initializer {
178: function decodeString(bytes memory _input) external pure returns (string memory result) {
183: function decodeUint8(bytes memory _input) external pure returns (uint8 result) {
```
[50](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L50) | [178](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L178) | [183](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L183)

```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL1ERC20Bridge.sol

9: function finalizeWithdrawal(
        uint256 _l2BatchNumber,
        uint256 _l2MessageIndex,
        uint16 _l2TxNumberInBatch,
        bytes calldata _message,
        bytes32[] calldata _merkleProof
    ) external;
```
[9](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L9)

```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL1SharedBridge.sol

9: function finalizeWithdrawal(
        uint256 _chainId,
        uint256 _l2BatchNumber,
        uint256 _l2MessageIndex,
        uint16 _l2TxNumberInBatch,
        bytes calldata _message,
        bytes32[] calldata _merkleProof
    ) external;
```
[9](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/interfaces/IL1SharedBridge.sol#L9)

```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol

23: function finalizeDeposit(
        address _l1Sender,
        address _l2Receiver,
        address _l1Token,
        uint256 _amount,
        bytes calldata _data
    ) external payable;
```
[23](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol#L23)

```solidity
File: code/contracts/zksync/contracts/interfaces/IPaymaster.sol

28: function validateAndPayForPaymasterTransaction(
        bytes32 _txHash,
        bytes32 _suggestedSignedHash,
        Transaction calldata _transaction
    ) external payable returns (bytes4 magic, bytes memory context);
28: function validateAndPayForPaymasterTransaction(
        bytes32 _txHash,
        bytes32 _suggestedSignedHash,
        Transaction calldata _transaction
    ) external payable returns (bytes4 magic, bytes memory context);
43: function postTransaction(
        bytes calldata _context,
        Transaction calldata _transaction,
        bytes32 _txHash,
        bytes32 _suggestedSignedHash,
        ExecutionResult _txResult,
        uint256 _maxRefundedGas
    ) external payable;
43: function postTransaction(
        bytes calldata _context,
        Transaction calldata _transaction,
        bytes32 _txHash,
        bytes32 _suggestedSignedHash,
        ExecutionResult _txResult,
        uint256 _maxRefundedGas
    ) external payable;
43: function postTransaction(
        bytes calldata _context,
        Transaction calldata _transaction,
        bytes32 _txHash,
        bytes32 _suggestedSignedHash,
        ExecutionResult _txResult,
        uint256 _maxRefundedGas
    ) external payable;
```
[28](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/interfaces/IPaymaster.sol#L28) | [28](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/interfaces/IPaymaster.sol#L28) | [43](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/interfaces/IPaymaster.sol#L43) | [43](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/interfaces/IPaymaster.sol#L43) | [43](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/interfaces/IPaymaster.sol#L43)

```solidity
File: code/contracts/zksync/contracts/interfaces/IPaymasterFlow.sol

14: function general(bytes calldata input) external;
15: function approvalBased(address _token, uint256 _minAllowance, bytes calldata _innerInput) external;
```
[14](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/interfaces/IPaymasterFlow.sol#L14) | [15](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/interfaces/IPaymasterFlow.sol#L15)

```solidity
File: code/contracts/zksync/contracts/L2ContractHelper.sol

22: function sendToL1(bytes memory _message) external returns (bytes32);
53: function create2(bytes32 _salt, bytes32 _bytecodeHash, bytes calldata _input) external returns (address);
53: function create2(bytes32 _salt, bytes32 _bytecodeHash, bytes calldata _input) external returns (address);
53: function create2(bytes32 _salt, bytes32 _bytecodeHash, bytes calldata _input) external returns (address);
65: function withdrawWithMessage(address _l1Receiver, bytes memory _additionalData) external payable;
```
[22](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/L2ContractHelper.sol#L22) | [53](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/L2ContractHelper.sol#L53) | [53](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/L2ContractHelper.sol#L53) | [53](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/L2ContractHelper.sol#L53) | [65](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/L2ContractHelper.sol#L65)
</details>

### [N-49] Adding a `return` statement when the function defines a named return variable, is redundant

Functions in Solidity can use named return variables which can enhance readability and reduce the complexity of the code. When using named return variables, a return statement without any parameters is implicitly added to the end of the function.
This means that explicitly writing return in a function that uses named return variables is redundant.
This redundancy could lead to confusion and misinterpretation of the function's behavior, particularly for developers who are new to the Solidity language or to the codebase.

Moreover, explicitly stating the return statement with the named variables might give the impression that the function could have different exit points or that it might return different values, which is not the case here.
Therefore, removing these redundant return statements can lead to cleaner, more maintainable code with reduced cognitive load for developers.
This helps in understanding the flow and the logic of the function at a quick glance and aids in faster debugging and fewer mistakes.

<details>
<summary><i>1 issue instances in 1 files:</i></summary>

```solidity
File: code/system-contracts/contracts/NonceHolder.sol

/// @audit - Redundant `return deploymentNonce;` when function has named return variables
125: function getDeploymentNonce(address _address) external view returns (uint256 deploymentNonce) {
```
[125](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L125)
</details>

### [N-50] Assembly blocks should have extensive comments

Large assembly blocks require extensive comments to aid understanding and code auditing. Assembly code takes more time to audit than normal Solidity code and often contains intricate details that aren't as apparent as in higher-level languages.

The identified assembly blocks in your contract appear to lack sufficient comments. Consider adding more comments explaining what each step of the assembly code does.

<details>
<summary><i>69 issue instances in 22 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

357: assembly {
                callSuccess := call(gas(), _depositSender, _amount, 0, 0, 0, 0)
            }
446: assembly {
                callSuccess := call(gas(), l1Receiver, amount, 0, 0, 0, 0)
            }
```
[357](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L357) | [446](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L446)

```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

229: assembly {
                    revert(add(returnData, 0x20), mload(returnData))
                }
```
[229](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L229)

```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

227: assembly {
            // Copy function signature and arguments from calldata at zero position into memory at pointer position
            calldatacopy(0, 0, calldatasize())
            // Call method of the hyperchain diamond contract returns 0 on error
            let result := call(gas(), contractAddress, 0, 0, calldatasize(), 0, 0)
            // Get the size of the last return data
            let size := returndatasize()
            // Copy the size length of bytes from return data at zero position to pointer position
            returndatacopy(0, 0, size)
            // Depending on the result value
            switch result
            case 0 {
                // End execution and revert state changes
                revert(0, size)
            }
```
[227](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L227)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol

32: assembly {
            // The pointer to the free memory slot
            let ptr := mload(0x40)
            // Copy function signature and arguments from calldata at zero position into memory at pointer position
            calldatacopy(ptr, 0, calldatasize())
            // Delegatecall method of the implementation contract returns 0 on error
            let result := delegatecall(gas(), facetAddress, ptr, calldatasize(), 0, 0)
            // Get the size of the last return data
            let size := returndatasize()
            // Copy the size length of bytes from return data at zero position to pointer position
            returndatacopy(ptr, 0, size)
            // Depending on the result value
            switch result
            case 0 {
                // End execution and revert state changes
                revert(ptr, size)
            }
```
[32](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol#L32)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

360: assembly {
                mstore(add(hashedFactoryDeps, mul(add(i, 1), 32)), hashedBytecode)
            }
```
[360](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L360)

```solidity
File: code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol

20: assembly {
            offset := add(_start, 4)
            result := mload(add(_bytes, offset))
        }
27: assembly {
            offset := add(_start, 20)
            result := mload(add(_bytes, offset))
        }
34: assembly {
            offset := add(_start, 32)
            result := mload(add(_bytes, offset))
        }
41: assembly {
            offset := add(_start, 32)
            result := mload(add(_bytes, offset))
        }
```
[20](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol#L20) | [27](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol#L27) | [34](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol#L34) | [41](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol#L41)

```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol

89: assembly {
            diamondStorage.slot := position
        }
289: assembly {
                    revert(add(data, 0x20), mload(data))
                }
```
[89](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L89) | [289](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L289)

```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol

41: assembly {
            mstore(0x00, _lhs)
            mstore(0x20, _rhs)
            result := keccak256(0x00, 0x40)
        }
```
[41](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol#L41)

```solidity
File: code/contracts/ethereum/contracts/common/ReentrancyGuard.sol

52: assembly {
            lockSlotOldValue := sload(LOCK_FLAG_ADDRESS)
            sstore(LOCK_FLAG_ADDRESS, _NOT_ENTERED)
        }
70: assembly {
            _status := sload(LOCK_FLAG_ADDRESS)
        }
78: assembly {
            sstore(LOCK_FLAG_ADDRESS, _ENTERED)
        }
86: assembly {
            sstore(LOCK_FLAG_ADDRESS, _NOT_ENTERED)
        }
```
[52](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/ReentrancyGuard.sol#L52) | [70](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/ReentrancyGuard.sol#L70) | [78](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/ReentrancyGuard.sol#L78) | [86](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/ReentrancyGuard.sol#L86)

```solidity
File: code/system-contracts/contracts/AccountCodeStorage.sol

70: assembly {
            sstore(addressAsKey, _hash)
        }
80: assembly {
            codeHash := sload(addressAsKey)
        }
```
[70](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/AccountCodeStorage.sol#L70) | [80](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/AccountCodeStorage.sol#L80)

```solidity
File: code/system-contracts/contracts/ComplexUpgrader.sol

26: assembly {
            if iszero(success) {
                revert(add(returnData, 0x20), mload(returnData))
            }
```
[26](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ComplexUpgrader.sol#L26)

```solidity
File: code/system-contracts/contracts/DefaultAccount.sol

31: assembly {
                return(0, 0)
            }
49: assembly {
                return(0, 0)
            }
168: assembly {
            r := mload(add(_signature, 0x20))
            s := mload(add(_signature, 0x40))
            v := and(mload(add(_signature, 0x41)), 0xff)
        }
```
[31](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L31) | [49](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L49) | [168](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L168)

```solidity
File: code/system-contracts/contracts/KnownCodesStorage.sol

55: assembly {
                sstore(_bytecodeHash, 1)
            }
66: assembly {
            marker := sload(_hash)
        }
```
[55](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/KnownCodesStorage.sol#L55) | [66](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/KnownCodesStorage.sol#L66)

```solidity
File: code/system-contracts/contracts/MsgValueSimulator.sol

69: assembly {
                    revert(0, 0)
                }
```
[69](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/MsgValueSimulator.sol#L69)

```solidity
File: code/system-contracts/contracts/PubdataChunkPublisher.sol

29: assembly {
            // The pointer to the allocated memory above. We skip 32 bytes to avoid overwriting the length.
            let ptr := add(totalBlobs, 0x20)
            calldatacopy(ptr, _pubdata.offset, _pubdata.length)
        }
46: assembly {
                // The pointer to the allocated memory above skipping the length.
                let ptr := add(totalBlobs, 0x20)
                blobHash := keccak256(add(ptr, start), BLOB_SIZE_BYTES)
            }
```
[29](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/PubdataChunkPublisher.sol#L29) | [46](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/PubdataChunkPublisher.sol#L46)

```solidity
File: code/system-contracts/contracts/libraries/EfficientCall.sol

135: assembly {
                success := call(_address, callAddr, 0, 0, 0xFFFF, 0, 0)
            }
147: assembly {
                success := call(msgValueSimulator, callAddr, _value, _address, 0xFFFF, forwardMask, 0)
            }
163: assembly {
            success := staticcall(_address, callAddr, 0, 0xFFFF, 0, 0)
        }
177: assembly {
            success := delegatecall(_address, callAddr, 0, 0xFFFF, 0, 0)
        }
203: assembly {
            // Clearing values before usage in assembly, since Solidity
            // doesn't do it by default
            _whoToMimic := and(_whoToMimic, cleanupMask)

            success := call(_address, callAddr, 0, 0, _whoToMimic, 0, 0)
        }
218: assembly {
                size := returndatasize()
            }
223: assembly {
                returndatacopy(add(returnData, 0x20), 0, size)
            }
233: assembly {
            let size := returndatasize()
            returndatacopy(0, 0, size)
            revert(0, size)
        }
254: assembly {
            dataOffset := _data.offset
        }
```
[135](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L135) | [147](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L147) | [163](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L163) | [177](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L177) | [203](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L203) | [218](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L218) | [223](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L223) | [233](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L233) | [254](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L254)

```solidity
File: code/system-contracts/contracts/libraries/RLPEncoder.sol

38: assembly {
                    mstore(add(encoded, 0x21), shiftedVal)
                }
73: assembly {
                    mstore(add(encoded, 0x21), shiftedVal)
                }
```
[38](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/RLPEncoder.sol#L38) | [73](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/RLPEncoder.sol#L73)

```solidity
File: code/system-contracts/contracts/libraries/SystemContractHelper.sol

65: assembly {
            addr := staticcall(0, callAddr, 0, 0xFFFF, 0, 0)
        }
76: assembly {
            pop(staticcall(0, callAddr, 0, 0xFFFF, 0, 0))
        }
87: assembly {
            pop(staticcall(_farCallAbi, callAddr, 0, 0xFFFF, 0, 0))
        }
97: assembly {
            // Clearing input params as they are not cleaned by Solidity by default
            _value := and(_value, cleanupMask)
            pop(staticcall(_value, callAddr, 0, 0xFFFF, 0, 0))
        }
109: assembly {
            // Clearing input params as they are not cleaned by Solidity by default
            _shrink := and(_shrink, cleanupMask)
            pop(staticcall(_shrink, callAddr, 0, 0xFFFF, 0, 0))
        }
158: assembly {
            // Clearing input params as they are not cleaned by Solidity by default
            params := and(params, cleanupMask)
            success := staticcall(_rawParams, callAddr, params, 0xFFFF, 0, 0)
        }
171: assembly {
            // Clearing input params as they are not cleaned by Solidity by default
            _value := and(_value, cleanupMask)
            success := call(0, callAddr, _value, 0, 0xFFFF, 0, 0)
        }
183: assembly {
            pop(call(initializer, callAddr, value1, 0, 0xFFFF, 0, 0))
        }
193: assembly {
            pop(call(value1, callAddr, value2, 0, 0xFFFF, 0, 0))
        }
205: assembly {
            meta := staticcall(0, callAddr, 0, 0xFFFF, 0, 0)
        }
298: assembly {
            callFlags := staticcall(0, callAddr, 0, 0xFFFF, 0, 0)
        }
309: assembly {
            ptr := staticcall(0, callAddr, 0, 0xFFFF, 0, 0)
        }
322: assembly {
            extraAbiData := staticcall(index, callAddr, 0, 0xFFFF, 0, 0)
        }
```
[65](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L65) | [76](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L76) | [87](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L87) | [97](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L97) | [109](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L109) | [158](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L158) | [171](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L171) | [183](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L183) | [193](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L193) | [205](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L205) | [298](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L298) | [309](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L309) | [322](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L322)

```solidity
File: code/system-contracts/contracts/libraries/SystemContractsCaller.sol

80: assembly {
            dataStart := add(data, 0x20)
        }
100: assembly {
                success := call(to, callAddr, 0, 0, farCallAbi, 0, 0)
            }
108: assembly {
                success := call(msgValueSimulator, callAddr, value, to, farCallAbi, forwardMask, 0)
            }
132: assembly {
            size := returndatasize()
        }
137: assembly {
            returndatacopy(add(returnData, 0x20), 0, size)
        }
160: assembly {
                let size := mload(returnData)
                revert(add(returnData, 0x20), size)
            }
```
[80](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L80) | [100](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L100) | [108](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L108) | [132](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L132) | [137](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L137) | [160](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L160)

```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

398: assembly {
            success := call(gas(), bootloaderAddr, amount, 0, 0, 0, 0)
        }
```
[398](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L398)

```solidity
File: code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol

20: assembly {
            let offset := sub(_bytes.offset, 30)
            result := calldataload(add(offset, _start))
        }
27: assembly {
            let offset := sub(_bytes.offset, 28)
            result := calldataload(add(offset, _start))
        }
34: assembly {
            let offset := sub(_bytes.offset, 24)
            result := calldataload(add(offset, _start))
        }
41: assembly {
            result := calldataload(add(_bytes.offset, _start))
        }
47: assembly {
            result := calldataload(add(_bytes.offset, _start))
        }
```
[20](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol#L20) | [27](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol#L27) | [34](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol#L34) | [41](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol#L41) | [47](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol#L47)

```solidity
File: code/contracts/zksync/contracts/SystemContractsCaller.sol

41: assembly {
            dataStart := add(data, 0x20)
        }
61: assembly {
                success := call(to, callAddr, 0, 0, farCallAbi, 0, 0)
            }
69: assembly {
                success := call(msgValueSimulator, callAddr, value, to, farCallAbi, forwardMask, 0)
            }
85: assembly {
            size := returndatasize()
        }
90: assembly {
            returndatacopy(add(returnData, 0x20), 0, size)
        }
```
[41](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/SystemContractsCaller.sol#L41) | [61](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/SystemContractsCaller.sol#L61) | [69](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/SystemContractsCaller.sol#L69) | [85](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/SystemContractsCaller.sol#L85) | [90](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/SystemContractsCaller.sol#L90)
</details>

### [N-51] Use `bytes.concat()` instead of `abi.encodePacked()`

Solidity version 0.8.4 introduces `bytes.concat()` for concatenating byte arrays, which is more efficient than using `abi.encodePacked()`.
It is recommended to use `bytes.concat()` instead of `abi.encodePacked()` and upgrade to at least Solidity version 0.8.4 if required.

<details>
<summary><i>16 issue instances in 7 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

461: abi.encodePacked(
517: abi.encodePacked(
528: abi.encodePacked(
548: abi.encodePacked(
610: bytes memory precompileInput = abi.encodePacked(_versionedHash, _openingPoint, _openingValueCommitmentProof);
655: abi.encodePacked(blobVersionedHash, _pubdataCommitments[i:i + PUBDATA_COMMITMENT_COMMITMENT_OFFSET])
```
[461](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L461) | [517](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L517) | [528](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L528) | [548](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L548) | [610](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L610) | [655](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L655)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

113: abi.encodePacked(_log.l2ShardId, _log.isService, _log.txNumberInBatch, _log.sender, _log.key, _log.value)
```
[113](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L113)

```solidity
File: code/system-contracts/contracts/L1Messenger.sol

96: abi.encodePacked(
```
[96](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L96)

```solidity
File: code/system-contracts/contracts/L2BaseToken.sol

113: return abi.encodePacked(IMailbox.finalizeEthWithdrawal.selector, _to, _amount);
123: return abi.encodePacked(IMailbox.finalizeEthWithdrawal.selector, _to, _amount, _sender, _additionalData);
```
[113](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L2BaseToken.sol#L113) | [123](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L2BaseToken.sol#L123)

```solidity
File: code/system-contracts/contracts/SystemContext.sol

157: // that's why the legacy L2 blocks' hashes are keccak256(abi.encodePacked(uint32(_block))), while these are equivalent to
158: // keccak256(abi.encodePacked(_block))
234: return keccak256(abi.encodePacked(uint32(_blockNumber)));
```
[157](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L157) | [158](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L158) | [234](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L234)

```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

133: keccak256(abi.encodePacked(_transaction.factoryDeps)),
142: return keccak256(abi.encodePacked("\x19\x01", domainSeparator, structHash));
```
[133](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L133) | [142](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L142)

```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

145: return abi.encodePacked(IL1ERC20Bridge.finalizeWithdrawal.selector, _to, _l1Token, _amount);
```
[145](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L145)
</details>

### [N-52] Function/Constructor Argument Names Not in mixedCase

Underscore before of after function argument names is a common convention in Solidity NOT a documentation requirement.

Function arguments should use mixedCase for better readability and consistency with Solidity style guidelines. 
Examples of good practice include: initialSupply, account, recipientAddress, senderAddress, newOwner. 
[More information in Documentation](https://docs.soliditylang.org/en/v0.8.20/style-guide.html#function-argument-names)

Rule exceptions
- Allow constant variable name/symbol/decimals to be lowercase (ERC20).
- Allow `_` at the beginning of the mixedCase match for `private variables` and `unused parameters`.

<details>
<summary><i>374 issue instances in 49 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

63: function tranferTokenToSharedBridge(address _token, uint256 _amount) external {
75: function l2TokenAddress(address _l1Token) external view returns (address) {
98: function deposit(
        address _l2Receiver,
        address _l1Token,
        uint256 _amount,
        uint256 _l2TxGasLimit,
        uint256 _l2TxGasPerPubdataByte
    ) external payable returns (bytes32 l2TxHash) {
133: function deposit(
        address _l2Receiver,
        address _l1Token,
        uint256 _amount,
        uint256 _l2TxGasLimit,
        uint256 _l2TxGasPerPubdataByte,
        address _refundRecipient
    ) public payable nonReentrant returns (bytes32 l2TxHash) {
160: function _depositFundsToSharedBridge(address _from, IERC20 _token, uint256 _amount) internal returns (uint256) {
176: function claimFailedDeposit(
        address _depositSender,
        address _l1Token,
        bytes32 _l2TxHash,
        uint256 _l2BatchNumber,
        uint256 _l2MessageIndex,
        uint16 _l2TxNumberInBatch,
        bytes32[] calldata _merkleProof
    ) external nonReentrant {
208: function finalizeWithdrawal(
        uint256 _l2BatchNumber,
        uint256 _l2MessageIndex,
        uint16 _l2TxNumberInBatch,
        bytes calldata _message,
        bytes32[] calldata _merkleProof
    ) external nonReentrant {
55: constructor(IL1SharedBridge _sharedBridge) reentrancyGuardInitializer {
63: function tranferTokenToSharedBridge(address _token, uint256 _amount) external {
75: function l2TokenAddress(address _l1Token) external view returns (address) {
98: function deposit(
        address _l2Receiver,
        address _l1Token,
        uint256 _amount,
        uint256 _l2TxGasLimit,
        uint256 _l2TxGasPerPubdataByte
    ) external payable returns (bytes32 l2TxHash) {
133: function deposit(
        address _l2Receiver,
        address _l1Token,
        uint256 _amount,
        uint256 _l2TxGasLimit,
        uint256 _l2TxGasPerPubdataByte,
        address _refundRecipient
    ) public payable nonReentrant returns (bytes32 l2TxHash) {
160: function _depositFundsToSharedBridge(address _from, IERC20 _token, uint256 _amount) internal returns (uint256) {
176: function claimFailedDeposit(
        address _depositSender,
        address _l1Token,
        bytes32 _l2TxHash,
        uint256 _l2BatchNumber,
        uint256 _l2MessageIndex,
        uint16 _l2TxNumberInBatch,
        bytes32[] calldata _merkleProof
    ) external nonReentrant {
208: function finalizeWithdrawal(
        uint256 _l2BatchNumber,
        uint256 _l2MessageIndex,
        uint16 _l2TxNumberInBatch,
        bytes calldata _message,
        bytes32[] calldata _merkleProof
    ) external nonReentrant {
55: constructor(IL1SharedBridge _sharedBridge) reentrancyGuardInitializer {
```
[63](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L63) | [75](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L75) | [98](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L98) | [133](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L133) | [160](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L160) | [176](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L176) | [208](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L208) | [55](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L55) | [63](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L63) | [75](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L75) | [98](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L98) | [133](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L133) | [160](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L160) | [176](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L176) | [208](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L208) | [55](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L55)

```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

104: function initialize(
        address _owner,
        uint256 _eraFirstPostUpgradeBatch
    ) external reentrancyGuardInitializer initializer {
116: function transferFundsFromLegacy(address _token, address _target, uint256 _targetChainId) external onlyOwner {
136: function receiveEth(uint256 _chainId) external payable {
142: function initializeChainGovernance(uint256 _chainId, address _l2BridgeAddress) external onlyOwner {
148: function bridgehubDepositBaseToken(
        uint256 _chainId,
        address _prevMsgSender,
        address _l1Token,
        uint256 _amount
    ) external payable virtual onlyBridgehubOrEra(_chainId) {
173: function _depositFunds(address _from, IERC20 _token, uint256 _amount) internal returns (uint256) {
182: function bridgehubDeposit(
        uint256 _chainId,
        address _prevMsgSender,
        uint256, // l2Value, needed for Weth deposits in the future
        bytes calldata _data
    ) external payable override onlyBridgehub returns (L2TransactionRequestTwoBridgesInner memory request) {
232: function bridgehubConfirmL2Transaction(
        uint256 _chainId,
        bytes32 _txDataHash,
        bytes32 _txHash
    ) external override onlyBridgehub {
243: function _getDepositL2Calldata(
        address _l1Sender,
        address _l2Receiver,
        address _l1Token,
        uint256 _amount
    ) internal view returns (bytes memory) {
254: function _getERC20Getters(address _token) internal view returns (bytes memory) {
277: function claimFailedDeposit(
        uint256 _chainId,
        address _depositSender,
        address _l1Token,
        uint256 _amount,
        bytes32 _l2TxHash,
        uint256 _l2BatchNumber,
        uint256 _l2MessageIndex,
        uint16 _l2TxNumberInBatch,
        bytes32[] calldata _merkleProof
    ) external override {
303: function _claimFailedDeposit(
        bool _checkedInLegacyBridge,
        uint256 _chainId,
        address _depositSender,
        address _l1Token,
        uint256 _amount,
        bytes32 _l2TxHash,
        uint256 _l2BatchNumber,
        uint256 _l2MessageIndex,
        uint16 _l2TxNumberInBatch,
        bytes32[] calldata _merkleProof
    ) internal nonReentrant {
374: function _isEraLegacyWithdrawal(uint256 _chainId, uint256 _l2BatchNumber) internal view returns (bool) {
385: function finalizeWithdrawal(
        uint256 _chainId,
        uint256 _l2BatchNumber,
        uint256 _l2MessageIndex,
        uint16 _l2TxNumberInBatch,
        bytes calldata _message,
        bytes32[] calldata _merkleProof
    ) external override {
409: function _finalizeWithdrawal(
        uint256 _chainId,
        uint256 _l2BatchNumber,
        uint256 _l2MessageIndex,
        uint16 _l2TxNumberInBatch,
        bytes calldata _message,
        bytes32[] calldata _merkleProof
    ) internal nonReentrant returns (address l1Receiver, address l1Token, uint256 amount) {
458: function _checkWithdrawal(
        uint256 _chainId,
        MessageParams memory _messageParams,
        bytes calldata _message,
        bytes32[] calldata _merkleProof
    ) internal view returns (address l1Receiver, address l1Token, uint256 amount) {
486: function _parseL2WithdrawalMessage(
        uint256 _chainId,
        bytes memory _l2ToL1message
    ) internal view returns (address l1Receiver, address l1Token, uint256 amount) {
554: function depositLegacyErc20Bridge(
        address _prevMsgSender,
        address _l2Receiver,
        address _l1Token,
        uint256 _amount,
        uint256 _l2TxGasLimit,
        uint256 _l2TxGasPerPubdataByte,
        address _refundRecipient
    ) external payable override onlyLegacyBridge nonReentrant returns (bytes32 l2TxHash) {
615: function finalizeWithdrawalLegacyErc20Bridge(
        uint256 _l2BatchNumber,
        uint256 _l2MessageIndex,
        uint16 _l2TxNumberInBatch,
        bytes calldata _message,
        bytes32[] calldata _merkleProof
    ) external override onlyLegacyBridge returns (address l1Receiver, address l1Token, uint256 amount) {
644: function claimFailedDepositLegacyErc20Bridge(
        address _depositSender,
        address _l1Token,
        uint256 _amount,
        bytes32 _l2TxHash,
        uint256 _l2BatchNumber,
        uint256 _l2MessageIndex,
        uint16 _l2TxNumberInBatch,
        bytes32[] calldata _merkleProof
    ) external override onlyLegacyBridge {
90: constructor(
        address _l1WethAddress,
        IBridgehub _bridgehub,
        IL1ERC20Bridge _legacyBridge
    ) reentrancyGuardInitializer {
```
[104](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L104) | [116](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L116) | [136](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L136) | [142](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L142) | [148](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L148) | [173](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L173) | [182](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L182) | [232](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L232) | [243](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L243) | [254](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L254) | [277](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L277) | [303](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L303) | [374](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L374) | [385](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L385) | [409](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L409) | [458](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L458) | [486](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L486) | [554](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L554) | [615](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L615) | [644](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L644) | [90](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L90)

```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

41: function initialize(address _owner) external reentrancyGuardInitializer {
51: function setPendingAdmin(address _newPendingAdmin) external onlyOwnerOrAdmin {
75: function getStateTransition(uint256 _chainId) public view returns (address) {
82: function addStateTransitionManager(address _stateTransitionManager) external onlyOwner {
92: function removeStateTransitionManager(address _stateTransitionManager) external onlyOwner {
101: function addToken(address _token) external onlyOwner {
108: function setSharedBridge(address _sharedBridge) external onlyOwner {
114: function createNewChain(
        uint256 _chainId,
        address _stateTransitionManager,
        address _baseToken,
        uint256, //_salt
        address _admin,
        bytes calldata _initData
    ) external onlyOwnerOrAdmin nonReentrant returns (uint256 chainId) {
152: function proveL2MessageInclusion(
        uint256 _chainId,
        uint256 _batchNumber,
        uint256 _index,
        L2Message calldata _message,
        bytes32[] calldata _proof
    ) external view override returns (bool) {
164: function proveL2LogInclusion(
        uint256 _chainId,
        uint256 _batchNumber,
        uint256 _index,
        L2Log memory _log,
        bytes32[] calldata _proof
    ) external view override returns (bool) {
176: function proveL1ToL2TransactionStatus(
        uint256 _chainId,
        bytes32 _l2TxHash,
        uint256 _l2BatchNumber,
        uint256 _l2MessageIndex,
        uint16 _l2TxNumberInBatch,
        bytes32[] calldata _merkleProof,
        TxStatus _status
    ) external view override returns (bool) {
198: function l2TransactionBaseCost(
        uint256 _chainId,
        uint256 _gasPrice,
        uint256 _l2GasLimit,
        uint256 _l2GasPerPubdataByteLimit
    ) external view returns (uint256) {
217: function requestL2TransactionDirect(
        L2TransactionRequestDirect calldata _request
    ) external payable override nonReentrant returns (bytes32 canonicalTxHash) {
262: function requestL2TransactionTwoBridges(
        L2TransactionRequestTwoBridgesOuter calldata _request
    ) external payable override nonReentrant returns (bytes32 canonicalTxHash) {
324: function _actualRefundRecipient(address _refundRecipient) internal view returns (address _recipient) {
```
[41](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L41) | [51](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L51) | [75](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L75) | [82](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L82) | [92](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L92) | [101](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L101) | [108](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L108) | [114](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L114) | [152](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L152) | [164](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L164) | [176](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L176) | [198](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L198) | [217](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L217) | [262](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L262) | [324](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L324)

```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

84: function isOperation(bytes32 _id) public view returns (bool) {
89: function isOperationPending(bytes32 _id) public view returns (bool) {
95: function isOperationReady(bytes32 _id) public view returns (bool) {
100: function isOperationDone(bytes32 _id) public view returns (bool) {
105: function getOperationState(bytes32 _id) public view returns (OperationState) {
129: function scheduleTransparent(Operation calldata _operation, uint256 _delay) external onlyOwner {
142: function scheduleShadow(bytes32 _id, uint256 _delay) external onlyOwner {
154: function cancel(bytes32 _id) external onlyOwner {
167: function execute(Operation calldata _operation) external payable onlyOwnerOrSecurityCouncil {
186: function executeInstant(Operation calldata _operation) external payable onlySecurityCouncil {
204: function hashOperation(Operation calldata _operation) public pure returns (bytes32) {
215: function _schedule(bytes32 _id, uint256 _delay) internal {
224: function _execute(Call[] calldata _calls) internal {
239: function _checkPredecessorDone(bytes32 _predecessorId) internal view {
249: function updateDelay(uint256 _newDelay) external onlySelf {
256: function updateSecurityCouncil(address _newSecurityCouncil) external onlySelf {
41: constructor(address _admin, address _securityCouncil, uint256 _minDelay) {
```
[84](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L84) | [89](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L89) | [95](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L95) | [100](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L100) | [105](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L105) | [129](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L129) | [142](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L142) | [154](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L154) | [167](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L167) | [186](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L186) | [204](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L204) | [215](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L215) | [224](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L224) | [239](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L239) | [249](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L249) | [256](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L256) | [41](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L41)

```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

73: function getChainAdmin(uint256 _chainId) external view override returns (address) {
79: function initialize(
        StateTransitionManagerInitializeData calldata _initializeData
    ) external reentrancyGuardInitializer {
110: function setPendingAdmin(address _newPendingAdmin) external onlyOwnerOrAdmin {
132: function setValidatorTimelock(address _validatorTimelock) external onlyOwnerOrAdmin {
137: function setInitialCutHash(Diamond.DiamondCutData calldata _diamondCut) external onlyOwner {
142: function setNewVersionUpgrade(
        Diamond.DiamondCutData calldata _cutData,
        uint256 _oldProtocolVersion,
        uint256 _newProtocolVersion
    ) external onlyOwner {
152: function setUpgradeDiamondCut(
        Diamond.DiamondCutData calldata _cutData,
        uint256 _oldProtocolVersion
    ) external onlyOwner {
160: function freezeChain(uint256 _chainId) external onlyOwner {
165: function unfreezeChain(uint256 _chainId) external onlyOwner {
170: function revertBatches(uint256 _chainId, uint256 _newLastBatch) external onlyOwnerOrAdmin {
177: function _setChainIdUpgrade(uint256 _chainId, address _chainContract) internal {
229: function registerAlreadyDeployedStateTransition(
        uint256 _chainId,
        address _stateTransitionContract
    ) external onlyOwner {
239: function createNewChain(
        uint256 _chainId,
        address _baseToken,
        address _sharedBridge,
        address _admin,
        bytes calldata _diamondCut
    ) external onlyBridgehub {
58: constructor(address _bridgehub) reentrancyGuardInitializer {
```
[73](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L73) | [79](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L79) | [110](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L110) | [132](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L132) | [137](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L137) | [142](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L142) | [152](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L152) | [160](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L160) | [165](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L165) | [170](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L170) | [177](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L177) | [229](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L229) | [239](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L239) | [58](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L58)

```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

73: function setStateTransitionManager(IStateTransitionManager _stateTransitionManager) external onlyOwner {
78: function addValidator(uint256 _chainId, address _newValidator) external onlyChainAdmin(_chainId) {
87: function removeValidator(uint256 _chainId, address _validator) external onlyChainAdmin(_chainId) {
96: function setExecutionDelay(uint32 _executionDelay) external onlyOwner {
102: function getCommittedBatchTimestamp(uint256 _chainId, uint256 _l2BatchNumber) external view returns (uint256) {
108: function commitBatches(
        StoredBatchInfo calldata,
        CommitBatchInfo[] calldata _newBatchesData
    ) external onlyValidator(ERA_CHAIN_ID) {
126: function commitBatchesSharedBridge(
        uint256 _chainId,
        StoredBatchInfo calldata,
        CommitBatchInfo[] calldata _newBatchesData
    ) external onlyValidator(_chainId) {
153: function revertBatchesSharedBridge(uint256 _chainId, uint256) external onlyValidator(_chainId) {
171: function proveBatchesSharedBridge(
        uint256 _chainId,
        StoredBatchInfo calldata,
        StoredBatchInfo[] calldata,
        ProofInput calldata
    ) external onlyValidator(_chainId) {
182: function executeBatches(StoredBatchInfo[] calldata _newBatchesData) external onlyValidator(ERA_CHAIN_ID) {
203: function executeBatchesSharedBridge(
        uint256 _chainId,
        StoredBatchInfo[] calldata _newBatchesData
    ) external onlyValidator(_chainId) {
225: function _propagateToZkSyncStateTransition(uint256 _chainId) internal {
54: constructor(address _initialOwner, uint32 _executionDelay) {
```
[73](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L73) | [78](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L78) | [87](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L87) | [96](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L96) | [102](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L102) | [108](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L108) | [126](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L126) | [153](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L153) | [171](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L171) | [182](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L182) | [203](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L203) | [225](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L225) | [54](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L54)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol

24: function initialize(InitializeData calldata _initializeData) external reentrancyGuardInitializer returns (bytes32) {
```
[24](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol#L24)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol

11: constructor(uint256 _chainId, Diamond.DiamondCutData memory _diamondCut) {
```
[11](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol#L11)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol

23: function setPendingAdmin(address _newPendingAdmin) external onlyAdmin {
45: function setValidator(address _validator, bool _active) external onlyStateTransitionManager {
51: function setPorterAvailability(bool _zkPorterIsAvailable) external onlyStateTransitionManager {
58: function setPriorityTxMaxGasLimit(uint256 _newPriorityTxMaxGasLimit) external onlyStateTransitionManager {
67: function changeFeeParams(FeeParams calldata _newFeeParams) external onlyAdminOrStateTransitionManager {
79: function setTokenMultiplier(uint128 _nominator, uint128 _denominator) external onlyAdminOrStateTransitionManager {
88: function setValidiumMode(PubdataPricingMode _validiumMode) external onlyAdmin {
100: function upgradeChainFromVersion(
        uint256 _oldProtocolVersion,
        Diamond.DiamondCutData calldata _diamondCut
    ) external onlyAdminOrStateTransitionManager {
123: function executeUpgrade(Diamond.DiamondCutData calldata _diamondCut) external onlyStateTransitionManager {
```
[23](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L23) | [45](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L45) | [51](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L51) | [58](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L58) | [67](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L67) | [79](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L79) | [88](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L88) | [100](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L100) | [123](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L123)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

32: function _commitOneBatch(
        StoredBatchInfo memory _previousBatch,
        CommitBatchInfo calldata _newBatch,
        bytes32 _expectedSystemContractUpgradeTxHash
    ) internal view returns (StoredBatchInfo memory) {
103: function _verifyBatchTimestamp(
        uint256 _packedBatchAndL2BlockTimestamp,
        uint256 _expectedBatchTimestamp,
        uint256 _previousBatchTimestamp
    ) internal view {
130: function _processL2Logs(
        CommitBatchInfo calldata _newBatch,
        bytes32 _expectedSystemContractUpgradeTxHash
    ) internal pure returns (LogProcessingOutput memory logOutput) {
199: function commitBatches(
        StoredBatchInfo memory _lastCommittedBatchData,
        CommitBatchInfo[] calldata _newBatchesData
    ) external nonReentrant onlyValidator {
207: function commitBatchesSharedBridge(
        uint256, // _chainId
        StoredBatchInfo memory _lastCommittedBatchData,
        CommitBatchInfo[] calldata _newBatchesData
    ) external nonReentrant onlyValidator {
214: function _commitBatches(
        StoredBatchInfo memory _lastCommittedBatchData,
        CommitBatchInfo[] calldata _newBatchesData
    ) internal {
253: function _commitBatchesWithoutSystemContractsUpgrade(
        StoredBatchInfo memory _lastCommittedBatchData,
        CommitBatchInfo[] calldata _newBatchesData
    ) internal {
273: function _commitBatchesWithSystemContractsUpgrade(
        StoredBatchInfo memory _lastCommittedBatchData,
        CommitBatchInfo[] calldata _newBatchesData,
        bytes32 _systemContractUpgradeTxHash
    ) internal {
308: function _collectOperationsFromPriorityQueue(uint256 _nPriorityOps) internal returns (bytes32 concatHash) {
321: function _executeOneBatch(StoredBatchInfo memory _storedBatch, uint256 _executedBatchIdx) internal {
337: function executeBatchesSharedBridge(
        uint256,
        StoredBatchInfo[] calldata _batchesData
    ) external nonReentrant onlyValidator {
345: function executeBatches(StoredBatchInfo[] calldata _batchesData) external nonReentrant onlyValidator {
348: function _executeBatches(StoredBatchInfo[] calldata _batchesData) internal {
368: function proveBatches(
        StoredBatchInfo calldata _prevBatch,
        StoredBatchInfo[] calldata _committedBatches,
        ProofInput calldata _proof
    ) external nonReentrant onlyValidator {
377: function proveBatchesSharedBridge(
        uint256, // _chainId
        StoredBatchInfo calldata _prevBatch,
        StoredBatchInfo[] calldata _committedBatches,
        ProofInput calldata _proof
    ) external nonReentrant onlyValidator {
385: function _proveBatches(
        StoredBatchInfo calldata _prevBatch,
        StoredBatchInfo[] calldata _committedBatches,
        ProofInput calldata _proof
    ) internal {
439: function _verifyProof(uint256[] memory proofPublicInput, ProofInput calldata _proof) internal view {
453: function _getBatchProofPublicInput(
        bytes32 _prevBatchCommitment,
        bytes32 _currentBatchCommitment,
        VerifierParams memory _verifierParams
    ) internal pure returns (uint256) {
472: function revertBatches(uint256 _newLastBatch) external nonReentrant onlyValidatorOrStateTransitionManager {
477: function revertBatchesSharedBridge(uint256, uint256 _newLastBatch) external nonReentrant onlyValidator {
480: function _revertBatches(uint256 _newLastBatch) internal {
500: function _createBatchCommitment(
        CommitBatchInfo calldata _newBatchData,
        bytes32 _stateDiffHash,
        bytes32[] memory _blobCommitments,
        bytes32[] memory _blobHashes
    ) internal view returns (bytes32) {
514: function _batchPassThroughData(CommitBatchInfo calldata _batch) internal pure returns (bytes memory) {
536: function _batchAuxiliaryOutput(
        CommitBatchInfo calldata _batch,
        bytes32 _stateDiffHash,
        bytes32[] memory _blobCommitments,
        bytes32[] memory _blobHashes
    ) internal pure returns (bytes memory) {
561: function _encodeBlobAuxilaryOutput(
        bytes32[] memory _blobCommitments,
        bytes32[] memory _blobHashes
    ) internal pure returns (bytes32[] memory blobAuxOutputWords) {
587: function _hashStoredBatchInfo(StoredBatchInfo memory _storedBatchInfo) internal pure returns (bytes32) {
592: function _checkBit(uint256 _bitMap, uint8 _index) internal pure returns (bool) {
597: function _setBit(uint256 _bitMap, uint8 _index) internal pure returns (uint256) {
605: function _pointEvaluationPrecompile(
        bytes32 _versionedHash,
        bytes32 _openingPoint,
        bytes calldata _openingValueCommitmentProof
    ) internal view {
625: function _verifyBlobInformation(
        bytes calldata _pubdataCommitments,
        bytes32[] memory _blobHashes
    ) internal view returns (bytes32[] memory blobCommitments) {
679: function _getBlobVersionedHash(uint256 _index) internal view returns (bytes32 versionedHash) {
```
[32](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L32) | [103](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L103) | [130](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L130) | [199](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L199) | [207](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L207) | [214](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L214) | [253](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L253) | [273](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L273) | [308](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L308) | [321](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L321) | [337](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L337) | [345](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L345) | [348](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L348) | [368](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L368) | [377](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L377) | [385](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L385) | [439](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L439) | [453](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L453) | [472](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L472) | [477](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L477) | [480](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L480) | [500](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L500) | [514](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L514) | [536](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L536) | [561](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L561) | [587](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L587) | [592](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L592) | [597](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L597) | [605](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L605) | [625](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L625) | [679](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L679)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol

112: function isValidator(address _address) external view returns (bool) {
117: function l2LogsRootHash(uint256 _batchNumber) external view returns (bytes32) {
122: function storedBatchHash(uint256 _batchNumber) external view returns (bytes32) {
163: function isFacetFreezable(address _facet) external view returns (bool isFreezable) {
181: function isFunctionFreezable(bytes4 _selector) external view returns (bool) {
188: function isEthWithdrawalFinalized(uint256 _l2BatchNumber, uint256 _l2MessageIndex) external view returns (bool) {
217: function facetFunctionSelectors(address _facet) external view returns (bytes4[] memory) {
229: function facetAddress(bytes4 _selector) external view returns (address) {
254: function storedBlockHash(uint256 _batchNumber) external view returns (bytes32) {
```
[112](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L112) | [117](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L117) | [122](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L122) | [163](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L163) | [181](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L181) | [188](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L188) | [217](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L217) | [229](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L229) | [254](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L254)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

47: function bridgehubRequestL2Transaction(
        BridgehubL2TransactionRequest memory _request
    ) external payable onlyBridgehub returns (bytes32 canonicalTxHash) {
54: function proveL2MessageInclusion(
        uint256 _batchNumber,
        uint256 _index,
        L2Message memory _message,
        bytes32[] calldata _proof
    ) public view returns (bool) {
64: function proveL2LogInclusion(
        uint256 _batchNumber,
        uint256 _index,
        L2Log memory _log,
        bytes32[] calldata _proof
    ) external view returns (bool) {
74: function proveL1ToL2TransactionStatus(
        bytes32 _l2TxHash,
        uint256 _l2BatchNumber,
        uint256 _l2MessageIndex,
        uint16 _l2TxNumberInBatch,
        bytes32[] calldata _merkleProof,
        TxStatus _status
    ) public view returns (bool) {
104: function _proveL2LogInclusion(
        uint256 _batchNumber,
        uint256 _index,
        L2Log memory _log,
        bytes32[] calldata _proof
    ) internal view returns (bool) {
130: function _L2MessageToLog(L2Message memory _message) internal pure returns (L2Log memory) {
143: function l2TransactionBaseCost(
        uint256 _gasPrice,
        uint256 _l2GasLimit,
        uint256 _l2GasPerPubdataByteLimit
    ) public view returns (uint256) {
156: function _deriveL2GasPrice(uint256 _l1GasPrice, uint256 _gasPerPubdata) internal view returns (uint256) {
178: function finalizeEthWithdrawal(
        uint256 _l2BatchNumber,
        uint256 _l2MessageIndex,
        uint16 _l2TxNumberInBatch,
        bytes calldata _message,
        bytes32[] calldata _merkleProof
    ) external nonReentrant {
197: function requestL2Transaction(
        address _contractL2,
        uint256 _l2Value,
        bytes calldata _calldata,
        uint256 _l2GasLimit,
        uint256 _l2GasPerPubdataByteLimit,
        bytes[] calldata _factoryDeps,
        address _refundRecipient
    ) external payable returns (bytes32 canonicalTxHash) {
227: function _requestL2TransactionSender(
        BridgehubL2TransactionRequest memory _request
    ) internal nonReentrant returns (bytes32 canonicalTxHash) {
257: function _requestL2Transaction(
        uint256 _mintValue,
        WritePriorityOpParams memory _params,
        bytes memory _calldata,
        bytes[] memory _factoryDeps
    ) internal returns (bytes32 canonicalTxHash) {
288: function _serializeL2Transaction(
        WritePriorityOpParams memory _priorityOpParams,
        bytes memory _calldata,
        bytes[] memory _factoryDeps
    ) internal pure returns (L2CanonicalTransaction memory transaction) {
316: function _writePriorityOp(
        WritePriorityOpParams memory _priorityOpParams,
        bytes memory _calldata,
        bytes[] memory _factoryDeps
    ) internal returns (bytes32 canonicalTxHash) {
353: function _hashFactoryDeps(bytes[] memory _factoryDeps) internal pure returns (uint256[] memory hashedFactoryDeps) {
```
[47](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L47) | [54](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L54) | [64](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L64) | [74](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L74) | [104](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L104) | [130](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L130) | [143](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L143) | [156](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L156) | [178](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L178) | [197](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L197) | [227](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L227) | [257](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L257) | [288](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L288) | [316](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L316) | [353](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L353)

```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol

67: function upgrade(ProposedUpgrade calldata _proposedUpgrade) public virtual returns (bytes32 txHash) {
92: function _setL2DefaultAccountBytecodeHash(bytes32 _l2DefaultAccountBytecodeHash) private {
109: function _setL2BootloaderBytecodeHash(bytes32 _l2BootloaderBytecodeHash) private {
126: function _setVerifier(IVerifier _newVerifier) private {
142: function _setVerifierParams(VerifierParams calldata _newVerifierParams) private {
163: function _upgradeVerifier(address _newVerifier, VerifierParams calldata _verifierParams) internal {
171: function _setBaseSystemContracts(bytes32 _bootloaderHash, bytes32 _defaultAccountHash) internal {
180: function _setL2SystemContractUpgrade(
        L2CanonicalTransaction calldata _l2ProtocolUpgradeTx,
        bytes[] calldata _factoryDeps,
        uint256 _newProtocolVersion
    ) internal returns (bytes32) {
222: function _verifyFactoryDeps(bytes[] calldata _factoryDeps, uint256[] calldata _expectedHashes) private pure {
236: function _setNewProtocolVersion(uint256 _newProtocolVersion) internal virtual {
```
[67](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L67) | [92](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L92) | [109](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L109) | [126](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L126) | [142](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L142) | [163](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L163) | [171](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L171) | [180](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L180) | [222](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L222) | [236](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L236)

```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol

20: function _setNewProtocolVersion(uint256 _newProtocolVersion) internal override {
47: function upgrade(ProposedUpgrade calldata _proposedUpgrade) public virtual override returns (bytes32) {
```
[20](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L20) | [47](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L47)

```solidity
File: code/contracts/ethereum/contracts/upgrades/DefaultUpgrade.sol

13: function upgrade(ProposedUpgrade calldata _proposedUpgrade) public override returns (bytes32) {
```
[13](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/DefaultUpgrade.sol#L13)

```solidity
File: code/contracts/ethereum/contracts/upgrades/GenesisUpgrade.sol

14: function upgrade(ProposedUpgrade calldata _proposedUpgrade) public override returns (bytes32) {
```
[14](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/GenesisUpgrade.sol#L14)

```solidity
File: code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol

21: function hashL2Bytecode(bytes memory _bytecode) internal pure returns (bytes32 hashedBytecode) {
39: function validateBytecodeHash(bytes32 _bytecodeHash) internal pure {
49: function bytecodeLen(bytes32 _bytecodeHash) internal pure returns (uint256 codeLengthInWords) {
60: function computeCreate2Address(
        address _sender,
        bytes32 _salt,
        bytes32 _bytecodeHash,
        bytes32 _constructorInputHash
    ) internal pure returns (address) {
```
[21](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L21) | [39](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L39) | [49](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L49) | [60](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L60)

```solidity
File: code/contracts/ethereum/contracts/common/libraries/UncheckedMath.sol

11: function uncheckedInc(uint256 _number) internal pure returns (uint256) {
16: function uncheckedAdd(uint256 _lhs, uint256 _rhs) internal pure returns (uint256) {
```
[11](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/UncheckedMath.sol#L11) | [16](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/UncheckedMath.sol#L16)

```solidity
File: code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol

19: function readUint32(bytes memory _bytes, uint256 _start) internal pure returns (uint32 result, uint256 offset) {
25: function readAddress(bytes memory _bytes, uint256 _start) internal pure returns (address result, uint256 offset) {
32: function readUint256(bytes memory _bytes, uint256 _start) internal pure returns (uint256 result, uint256 offset) {
39: function readBytes32(bytes memory _bytes, uint256 _start) internal pure returns (bytes32 result, uint256 offset) {
```
[19](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol#L19) | [25](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol#L25) | [32](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol#L32) | [39](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol#L39)

```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol

96: function diamondCut(DiamondCutData memory _diamondCut) internal {
126: function _addFunctions(address _facet, bytes4[] memory _selectors, bool _isFacetFreezable) private {
149: function _replaceFunctions(address _facet, bytes4[] memory _selectors, bool _isFacetFreezable) private {
172: function _removeFunctions(address _facet, bytes4[] memory _selectors) private {
189: function _saveFacetIfNew(address _facet) private {
205: function _addOneFunction(address _facet, bytes4 _selector, bool _isSelectorFreezable) private {
228: function _removeOneFunction(address _facet, bytes4 _selector) private {
257: function _removeFacet(address _facet) private {
278: function _initializeDiamondCut(address _init, bytes memory _calldata) private {
```
[96](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L96) | [126](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L126) | [149](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L149) | [172](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L172) | [189](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L189) | [205](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L205) | [228](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L228) | [257](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L257) | [278](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L278)

```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/LibMap.sol

18: function get(Uint32Map storage _map, uint256 _index) internal view returns (uint32 result) {
38: function set(Uint32Map storage _map, uint256 _index, uint32 _value) internal {
```
[18](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/LibMap.sol#L18) | [38](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/LibMap.sol#L38)

```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol

18: function calculateRoot(
        bytes32[] calldata _path,
        uint256 _index,
        bytes32 _itemHash
    ) internal pure returns (bytes32) {
40: function _efficientHash(bytes32 _lhs, bytes32 _rhs) private pure returns (bytes32 result) {
```
[18](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol#L18) | [40](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol#L40)

```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol

35: function getFirstUnprocessedPriorityTx(Queue storage _queue) internal view returns (uint256) {
40: function getTotalPriorityTxs(Queue storage _queue) internal view returns (uint256) {
45: function getSize(Queue storage _queue) internal view returns (uint256) {
50: function isEmpty(Queue storage _queue) internal view returns (bool) {
55: function pushBack(Queue storage _queue, PriorityOperation memory _operation) internal {
64: function front(Queue storage _queue) internal view returns (PriorityOperation memory) {
72: function popFront(Queue storage _queue) internal returns (PriorityOperation memory priorityOperation) {
```
[35](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L35) | [40](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L40) | [45](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L45) | [50](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L50) | [55](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L55) | [64](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L64) | [72](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L72)

```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol

19: function validateL1ToL2Transaction(
        L2CanonicalTransaction memory _transaction,
        bytes memory _encoded,
        uint256 _priorityTxMaxGasLimit,
        uint256 _priorityTxMaxPubdata
    ) internal pure {
46: function validateUpgradeTransaction(L2CanonicalTransaction memory _transaction) internal pure {
69: function getMinimalPriorityTransactionGasLimit(
        uint256 _encodingLength,
        uint256 _numberOfFactoryDependencies,
        uint256 _l2GasPricePerPubdata
    ) internal pure returns (uint256) {
109: function getTransactionBodyGasLimit(
        uint256 _totalGasLimit,
        uint256 _encodingLength
    ) internal pure returns (uint256 txBodyGasLimit) {
128: function getOverheadForTransaction(
        uint256 _encodingLength
    ) internal pure returns (uint256 batchOverheadForTransaction) {
```
[19](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L19) | [46](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L46) | [69](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L69) | [109](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L109) | [128](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L128)

```solidity
File: code/system-contracts/contracts/AccountCodeStorage.sol

35: function storeAccountConstructingCodeHash(address _address, bytes32 _hash) external override onlyDeployer {
46: function storeAccountConstructedCodeHash(address _address, bytes32 _hash) external override onlyDeployer {
54: function markAccountCodeHashAsConstructed(address _address) external override onlyDeployer {
68: function _storeCodeHash(address _address, bytes32 _hash) internal {
78: function getRawCodeHash(address _address) public view override returns (bytes32 codeHash) {
89: function getCodeHash(uint256 _input) external view override returns (bytes32) {
117: function getCodeSize(uint256 _input) external view override returns (uint256 codeSize) {
```
[35](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/AccountCodeStorage.sol#L35) | [46](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/AccountCodeStorage.sol#L46) | [54](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/AccountCodeStorage.sol#L54) | [68](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/AccountCodeStorage.sol#L68) | [78](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/AccountCodeStorage.sol#L78) | [89](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/AccountCodeStorage.sol#L89) | [117](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/AccountCodeStorage.sol#L117)

```solidity
File: code/system-contracts/contracts/BootloaderUtilities.sol

24: function getTransactionHashes(
        Transaction calldata _transaction
    ) external view override returns (bytes32 txHash, bytes32 signedTxHash) {
44: function encodeLegacyTransactionHash(Transaction calldata _transaction) internal view returns (bytes32 txHash) {
139: function encodeEIP2930TransactionHash(Transaction calldata _transaction) internal view returns (bytes32) {
229: function encodeEIP1559TransactionHash(Transaction calldata _transaction) internal view returns (bytes32) {
```
[24](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L24) | [44](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L44) | [139](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L139) | [229](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L229)

```solidity
File: code/system-contracts/contracts/ComplexUpgrader.sol

21: function upgrade(address _delegateTo, bytes calldata _calldata) external payable {
```
[21](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ComplexUpgrader.sol#L21)

```solidity
File: code/system-contracts/contracts/Compressor.sol

44: function publishCompressedBytecode(
        bytes calldata _bytecode,
        bytes calldata _rawCompressedData
    ) external payable onlyCallFromBootloader returns (bytes32 bytecodeHash) {
110: function verifyCompressedStateDiffs(
        uint256 _numberOfStateDiffs,
        uint256 _enumerationIndexSize,
        bytes calldata _stateDiffs,
        bytes calldata _compressedStateDiffs
    ) external payable onlyCallFrom(address(L1_MESSENGER_CONTRACT)) returns (bytes32 stateDiffHash) {
197: function _decodeRawBytecode(
        bytes calldata _rawCompressedData
    ) internal pure returns (bytes calldata dictionary, bytes calldata encodedData) {
220: function _verifyValueCompression(
        uint256 _initialValue,
        uint256 _finalValue,
        uint256 _operation,
        bytes calldata _compressedValue
    ) internal pure {
251: function _sliceToUint256(bytes calldata _calldataSlice) internal pure returns (uint256 number) {
```
[44](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L44) | [110](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L110) | [197](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L197) | [220](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L220) | [251](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L251)

```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

34: function getAccountInfo(address _address) external view returns (AccountInfo memory info) {
40: function extendedAccountVersion(address _address) public view returns (AccountAbstractionVersion) {
58: function _storeAccountInfo(address _address, AccountInfo memory _newInfo) internal {
65: function updateAccountVersion(AccountAbstractionVersion _version) external onlySystemCall {
74: function updateNonceOrdering(AccountNonceOrdering _nonceOrdering) external onlySystemCall {
95: function getNewAddressCreate2(
        address _sender,
        bytes32 _bytecodeHash,
        bytes32 _salt,
        bytes calldata _input
    ) public view override returns (address newAddress) {
115: function getNewAddressCreate(
        address _sender,
        uint256 _senderNonce
    ) public pure override returns (address newAddress) {
132: function create2(
        bytes32 _salt,
        bytes32 _bytecodeHash,
        bytes calldata _input
    ) external payable override returns (address) {
147: function create(
        bytes32 _salt,
        bytes32 _bytecodeHash,
        bytes calldata _input
    ) external payable override returns (address) {
162: function create2Account(
        bytes32 _salt,
        bytes32 _bytecodeHash,
        bytes calldata _input,
        AccountAbstractionVersion _aaVersion
    ) public payable override onlySystemCall returns (address) {
182: function createAccount(
        bytes32, // salt
        bytes32 _bytecodeHash,
        bytes calldata _input,
        AccountAbstractionVersion _aaVersion
    ) public payable override onlySystemCall returns (address) {
213: function forceDeployOnAddress(ForceDeployment calldata _deployment, address _sender) external payable onlySelf {
238: function forceDeployOnAddresses(ForceDeployment[] calldata _deployments) external payable {
257: function _nonSystemDeployOnAddress(
        bytes32 _bytecodeHash,
        address _newAddress,
        AccountAbstractionVersion _aaVersion,
        bytes calldata _input
    ) internal {
283: function _performDeployOnAddress(
        bytes32 _bytecodeHash,
        address _newAddress,
        AccountAbstractionVersion _aaVersion,
        bytes calldata _input
    ) internal {
301: function _ensureBytecodeIsKnown(bytes32 _bytecodeHash) internal view {
309: function _storeConstructingByteCodeHashOnAddress(address _newAddress, bytes32 _bytecodeHash) internal {
321: function _constructContract(
        address _sender,
        address _newAddress,
        bytes32 _bytecodeHash,
        bytes calldata _input,
        bool _isSystem,
        bool _callConstructor
    ) internal {
```
[34](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L34) | [40](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L40) | [58](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L58) | [65](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L65) | [74](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L74) | [95](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L95) | [115](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L115) | [132](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L132) | [147](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L147) | [162](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L162) | [182](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L182) | [213](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L213) | [238](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L238) | [257](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L257) | [283](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L283) | [301](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L301) | [309](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L309) | [321](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L321)

```solidity
File: code/system-contracts/contracts/DefaultAccount.sol

67: function validateTransaction(
        bytes32, // _txHash
        bytes32 _suggestedSignedHash,
        Transaction calldata _transaction
    ) external payable override ignoreNonBootloader ignoreInDelegateCall returns (bytes4 magic) {
78: function _validateTransaction(
        bytes32 _suggestedSignedHash,
        Transaction calldata _transaction
    ) internal returns (bytes4 magic) {
112: function executeTransaction(
        bytes32, // _txHash
        bytes32, // _suggestedSignedHash
        Transaction calldata _transaction
    ) external payable override ignoreNonBootloader ignoreInDelegateCall {
131: function _execute(Transaction calldata _transaction) internal {
159: function _isValidSignature(bytes32 _hash, bytes memory _signature) internal view returns (bool) {
196: function payForTransaction(
        bytes32, // _txHash
        bytes32, // _suggestedSignedHash
        Transaction calldata _transaction
    ) external payable ignoreNonBootloader ignoreInDelegateCall {
212: function prepareForPaymaster(
        bytes32, // _txHash
        bytes32, // _suggestedSignedHash
        Transaction calldata _transaction
    ) external payable ignoreNonBootloader ignoreInDelegateCall {
```
[67](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L67) | [78](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L78) | [112](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L112) | [131](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L131) | [159](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L159) | [196](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L196) | [212](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L212)

```solidity
File: code/system-contracts/contracts/ImmutableSimulator.sol

27: function getImmutable(address _dest, uint256 _index) external view override returns (bytes32) {
34: function setImmutables(address _dest, ImmutableData[] calldata _immutables) external override {
```
[27](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ImmutableSimulator.sol#L27) | [34](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ImmutableSimulator.sol#L34)

```solidity
File: code/system-contracts/contracts/KnownCodesStorage.sol

27: function markFactoryDeps(bool _shouldSendToL1, bytes32[] calldata _hashes) external onlyCallFromBootloader {
39: function markBytecodeAsPublished(bytes32 _bytecodeHash) external onlyCompressor {
46: function _markBytecodeAsPublished(bytes32 _bytecodeHash, bool _shouldSendToL1) internal {
65: function getMarker(bytes32 _hash) public view override returns (uint256 marker) {
74: function _validateBytecode(bytes32 _bytecodeHash) internal pure {
```
[27](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/KnownCodesStorage.sol#L27) | [39](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/KnownCodesStorage.sol#L39) | [46](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/KnownCodesStorage.sol#L46) | [65](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/KnownCodesStorage.sol#L65) | [74](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/KnownCodesStorage.sol#L74)

```solidity
File: code/system-contracts/contracts/L1Messenger.sol

50: function keccakGasCost(uint256 _length) internal pure returns (uint256) {
61: function sha256GasCost(uint256 _length) internal pure returns (uint256) {
70: function sendL2ToL1Log(
        bool _isService,
        bytes32 _key,
        bytes32 _value
    ) external onlyCallFromSystemContract returns (uint256 logIdInMerkleTree) {
94: function _processL2ToL1Log(L2ToL1Log memory _l2ToL1Log) internal returns (uint256 logIdInMerkleTree) {
116: function sendToL1(bytes calldata _message) external override returns (bytes32 hash) {
161: function requestBytecodeL1Publication(
        bytes32 _bytecodeHash
    ) external override onlyCallFrom(address(KNOWN_CODE_STORAGE_CONTRACT)) {
194: function publishPubdataAndClearState(
        bytes calldata _totalL2ToL1PubdataAndStateDiffs
    ) external onlyCallFromBootloader {
```
[50](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L50) | [61](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L61) | [70](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L70) | [94](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L94) | [116](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L116) | [161](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L161) | [194](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L194)

```solidity
File: code/system-contracts/contracts/L2BaseToken.sol

32: function transferFromTo(address _from, address _to, uint256 _amount) external override {
56: function balanceOf(uint256 _account) external view override returns (uint256) {
64: function mint(address _account, uint256 _amount) external override onlyCallFromBootloader {
72: function withdraw(address _l1Receiver) external payable override {
85: function withdrawWithMessage(address _l1Receiver, bytes memory _additionalData) external payable override {
112: function _getL1WithdrawMessage(address _to, uint256 _amount) internal pure returns (bytes memory) {
117: function _getExtendedWithdrawMessage(
        address _to,
        uint256 _amount,
        address _sender,
        bytes memory _additionalData
    ) internal pure returns (bytes memory) {
```
[32](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L2BaseToken.sol#L32) | [56](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L2BaseToken.sol#L56) | [64](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L2BaseToken.sol#L64) | [72](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L2BaseToken.sol#L72) | [85](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L2BaseToken.sol#L85) | [112](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L2BaseToken.sol#L112) | [117](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L2BaseToken.sol#L117)

```solidity
File: code/system-contracts/contracts/NonceHolder.sol

46: function getMinNonce(address _address) public view returns (uint256) {
57: function getRawNonce(address _address) public view returns (uint256) {
65: function increaseMinNonce(uint256 _value) public onlySystemCall returns (uint256 oldMinNonce) {
82: function setValueUnderNonce(uint256 _key, uint256 _value) public onlySystemCall {
102: function getValueUnderNonce(uint256 _key) public view returns (uint256) {
110: function incrementMinNonceIfEquals(uint256 _expectedNonce) external onlySystemCall {
125: function getDeploymentNonce(address _address) external view returns (uint256 deploymentNonce) {
135: function incrementDeploymentNonce(address _address) external returns (uint256 prevDeploymentNonce) {
154: function isNonceUsed(address _address, uint256 _nonce) public view returns (bool) {
166: function validateNonceUsage(address _address, uint256 _key, bool _shouldBeUsed) external view {
179: function _splitRawNonce(uint256 _rawMinNonce) internal pure returns (uint256 deploymentNonce, uint256 minNonce) {
```
[46](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L46) | [57](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L57) | [65](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L65) | [82](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L82) | [102](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L102) | [110](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L110) | [125](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L125) | [135](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L135) | [154](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L154) | [166](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L166) | [179](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L179)

```solidity
File: code/system-contracts/contracts/PubdataChunkPublisher.sol

21: function chunkAndPublishPubdata(bytes calldata _pubdata) external onlyCallFrom(address(L1_MESSENGER_CONTRACT)) {
```
[21](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/PubdataChunkPublisher.sol#L21)

```solidity
File: code/system-contracts/contracts/SystemContext.sol

84: function setChainId(uint256 _newChainId) external onlyCallFromForceDeployer {
99: function setTxOrigin(address _newOrigin) external onlyCallFromBootloader {
105: function setGasPrice(uint256 _gasPrice) external onlyCallFromBootloader {
112: function setPubdataInfo(uint256 _gasPerPubdataByte, uint256 _basePubdataSpent) external onlyCallFromBootloader {
132: function getBlockHashEVM(uint256 _block) external view returns (bytes32 hash) {
166: function getBatchHash(uint256 _batchNumber) external view returns (bytes32 hash) {
205: function _getLatest257L2blockHash(uint256 _block) internal view returns (bytes32) {
212: function _setL2BlockHash(uint256 _block, bytes32 _hash) internal {
221: function _calculateL2BlockHash(
        uint128 _blockNumber,
        uint128 _blockTimestamp,
        bytes32 _prevL2BlockHash,
        bytes32 _blockTxsRollingHash
    ) internal pure returns (bytes32) {
233: function _calculateLegacyL2BlockHash(uint128 _blockNumber) internal pure returns (bytes32) {
241: function _upgradeL2Blocks(uint128 _l2BlockNumber, bytes32 _expectedPrevL2BlockHash, bool _isFirstInBatch) internal {
263: function _setVirtualBlock(
        uint128 _l2BlockNumber,
        uint128 _maxVirtualBlocksToCreate,
        uint128 _newTimestamp
    ) internal {
314: function _setNewL2BlockData(uint128 _l2BlockNumber, uint128 _l2BlockTimestamp, bytes32 _prevL2BlockHash) internal {
341: function setL2Block(
        uint128 _l2BlockNumber,
        uint128 _l2BlockTimestamp,
        bytes32 _expectedPrevL2BlockHash,
        bool _isFirstInBatch,
        uint128 _maxVirtualBlocksToCreate
    ) external onlyCallFromBootloader {
402: function appendTransactionToCurrentL2Block(bytes32 _txHash) external onlyCallFromBootloader {
427: function _ensureBatchConsistentWithL2Block(uint128 _newTimestamp) internal view {
444: function setNewBatch(
        bytes32 _prevBatchHash,
        uint128 _newTimestamp,
        uint128 _expectedNewNumber,
        uint256 _baseFee
    ) external onlyCallFromBootloader {
471: function unsafeOverrideBatch(
        uint256 _newTimestamp,
        uint256 _number,
        uint256 _baseFee
    ) external onlyCallFromBootloader {
509: function blockHash(uint256 _blockNumber) external view returns (bytes32 hash) {
```
[84](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L84) | [99](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L99) | [105](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L105) | [112](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L112) | [132](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L132) | [166](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L166) | [205](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L205) | [212](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L212) | [221](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L221) | [233](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L233) | [241](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L241) | [263](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L263) | [314](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L314) | [341](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L341) | [402](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L402) | [427](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L427) | [444](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L444) | [471](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L471) | [509](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L509)

```solidity
File: code/system-contracts/contracts/GasBoundCaller.sol

35: function gasBoundCall(address _to, uint256 _maxTotalGas, bytes calldata _data) external payable {
```
[35](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/GasBoundCaller.sol#L35)

```solidity
File: code/system-contracts/contracts/libraries/EfficientCall.sol

36: function keccak(bytes calldata _data) internal view returns (bytes32) {
45: function sha(bytes calldata _data) internal view returns (bytes32) {
58: function call(
        uint256 _gas,
        address _address,
        uint256 _value,
        bytes calldata _data,
        bool _isSystem
    ) internal returns (bytes memory returnData) {
74: function staticCall(
        uint256 _gas,
        address _address,
        bytes calldata _data
    ) internal view returns (bytes memory returnData) {
88: function delegateCall(
        uint256 _gas,
        address _address,
        bytes calldata _data
    ) internal returns (bytes memory returnData) {
105: function mimicCall(
        uint256 _gas,
        address _address,
        bytes calldata _data,
        address _whoToMimic,
        bool _isConstructor,
        bool _isSystem
    ) internal returns (bytes memory returnData) {
124: function rawCall(
        uint256 _gas,
        address _address,
        uint256 _value,
        bytes calldata _data,
        bool _isSystem
    ) internal returns (bool success) {
159: function rawStaticCall(uint256 _gas, address _address, bytes calldata _data) internal view returns (bool success) {
173: function rawDelegateCall(uint256 _gas, address _address, bytes calldata _data) internal returns (bool success) {
191: function rawMimicCall(
        uint256 _gas,
        address _address,
        bytes calldata _data,
        address _whoToMimic,
        bool _isConstructor,
        bool _isSystem
    ) internal returns (bool success) {
215: function _verifyCallResult(bool _success) private pure returns (bytes memory returnData) {
245: function _loadFarCallABIIntoActivePtr(
        uint256 _gas,
        bytes calldata _data,
        bool _isConstructor,
        bool _isSystem
    ) private view {
```
[36](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L36) | [45](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L45) | [58](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L58) | [74](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L74) | [88](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L88) | [105](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L105) | [124](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L124) | [159](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L159) | [173](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L173) | [191](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L191) | [215](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L215) | [245](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L245)

```solidity
File: code/system-contracts/contracts/libraries/RLPEncoder.sol

11: function encodeAddress(address _val) internal pure returns (bytes memory encoded) {
23: function encodeUint256(uint256 _val) internal pure returns (bytes memory encoded) {
49: function encodeNonSingleBytesLen(uint64 _len) internal pure returns (bytes memory) {
56: function encodeListLen(uint64 _len) internal pure returns (bytes memory) {
59: function _encodeLength(uint64 _len, uint256 _offset) private pure returns (bytes memory encoded) {
84: function _highestByteSet(uint256 _number) private pure returns (uint256 hbs) {
```
[11](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/RLPEncoder.sol#L11) | [23](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/RLPEncoder.sol#L23) | [49](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/RLPEncoder.sol#L49) | [56](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/RLPEncoder.sol#L56) | [59](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/RLPEncoder.sol#L59) | [84](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/RLPEncoder.sol#L84)

```solidity
File: code/system-contracts/contracts/libraries/SystemContractHelper.sol

48: function toL1(bool _isService, bytes32 _key, bytes32 _value) internal {
85: function ptrPackIntoActivePtr(uint256 _farCallAbi) internal view {
94: function ptrAddIntoActive(uint32 _value) internal view {
106: function ptrShrinkIntoActive(uint32 _shrink) internal view {
124: function packPrecompileParams(
        uint32 _inputMemoryOffset,
        uint32 _inputMemoryLength,
        uint32 _outputMemoryOffset,
        uint32 _outputMemoryLength,
        uint64 _perPrecompileInterpreted
    ) internal pure returns (uint256 rawParams) {
148: function unsafePrecompileCall(
        uint256 _rawParams,
        uint32 _gasToBurn,
        uint32 _pubdataToSpend
    ) internal view returns (bool success) {
168: function setValueForNextFarCall(uint128 _value) internal returns (bool success) {
338: function isSystemContract(address _address) internal pure returns (bool) {
344: function burnGas(uint32 _gasToPay, uint32 _pubdataToSpend) internal view {
```
[48](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L48) | [85](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L85) | [94](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L94) | [106](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L106) | [124](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L124) | [148](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L148) | [168](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L168) | [338](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L338) | [344](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L344)

```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

94: function isEthToken(uint256 _addr) internal pure returns (bool) {
100: function encodeHash(Transaction calldata _transaction) internal view returns (bytes32 resultHash) {
118: function _encodeHashEIP712Transaction(Transaction calldata _transaction) private view returns (bytes32) {
147: function _encodeHashLegacyTransaction(Transaction calldata _transaction) private view returns (bytes32) {
219: function _encodeHashEIP2930Transaction(Transaction calldata _transaction) private view returns (bytes32) {
289: function _encodeHashEIP1559Transaction(Transaction calldata _transaction) private view returns (bytes32) {
362: function processPaymasterInput(Transaction calldata _transaction) internal {
395: function payToTheBootloader(Transaction calldata _transaction) internal returns (bool success) {
405: function totalRequiredBalance(Transaction calldata _transaction) internal pure returns (uint256 requiredBalance) {
```
[94](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L94) | [100](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L100) | [118](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L118) | [147](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L147) | [219](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L219) | [289](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L289) | [362](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L362) | [395](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L395) | [405](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L405)

```solidity
File: code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol

19: function readUint16(bytes calldata _bytes, uint256 _start) internal pure returns (uint16 result) {
25: function readUint32(bytes calldata _bytes, uint256 _start) internal pure returns (uint32 result) {
32: function readUint64(bytes calldata _bytes, uint256 _start) internal pure returns (uint64 result) {
39: function readBytes32(bytes calldata _bytes, uint256 _start) internal pure returns (bytes32 result) {
45: function readUint256(bytes calldata _bytes, uint256 _start) internal pure returns (uint256 result) {
```
[19](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol#L19) | [25](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol#L25) | [32](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol#L32) | [39](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol#L39) | [45](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol#L45)

```solidity
File: code/system-contracts/contracts/libraries/Utils.sol

19: function safeCastToU128(uint256 _x) internal pure returns (uint128) {
25: function safeCastToU32(uint256 _x) internal pure returns (uint32) {
31: function safeCastToU24(uint256 _x) internal pure returns (uint24) {
39: function bytecodeLenInBytes(bytes32 _bytecodeHash) internal pure returns (uint256 codeLength) {
44: function bytecodeLenInWords(bytes32 _bytecodeHash) internal pure returns (uint256 codeLengthInWords) {
51: function isContractConstructed(bytes32 _bytecodeHash) internal pure returns (bool) {
56: function isContractConstructing(bytes32 _bytecodeHash) internal pure returns (bool) {
63: function constructingBytecodeHash(bytes32 _bytecodeHash) internal pure returns (bytes32) {
71: function constructedBytecodeHash(bytes32 _bytecodeHash) internal pure returns (bytes32) {
82: function hashL2Bytecode(bytes calldata _bytecode) internal view returns (bytes32 hashedBytecode) {
```
[19](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L19) | [25](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L25) | [31](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L31) | [39](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L39) | [44](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L44) | [51](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L51) | [56](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L56) | [63](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L63) | [71](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L71) | [82](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L82)

```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

49: function initialize(
        address _l1Bridge,
        address _l1LegecyBridge,
        bytes32 _l2TokenProxyBytecodeHash,
        address _aliasedOwner
    ) external reinitializer(2) {
79: function finalizeDeposit(
        address _l1Sender,
        address _l2Receiver,
        address _l1Token,
        uint256 _amount,
        bytes calldata _data
    ) external payable override {
109: function _deployL2Token(address _l1Token, bytes calldata _data) internal returns (address) {
123: function withdraw(address _l1Receiver, address _l2Token, uint256 _amount) external override {
138: function _getL1WithdrawMessage(
        address _to,
        address _l1Token,
        uint256 _amount
    ) internal pure returns (bytes memory) {
149: function l2TokenAddress(address _l1Token) public view override returns (address) {
157: function _getCreate2Salt(address _l1Token) internal pure returns (bytes32 salt) {
```
[49](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L49) | [79](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L79) | [109](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L109) | [123](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L123) | [138](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L138) | [149](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L149) | [157](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L157)

```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

50: function bridgeInitialize(address _l1Address, bytes memory _data) external initializer {
111: function reinitializeToken(
        ERC20Getters calldata _availableGetters,
        string memory _newName,
        string memory _newSymbol,
        uint8 _version
    ) external onlyNextVersion(_version) reinitializer(_version) {
145: function bridgeMint(address _to, uint256 _amount) external override onlyBridge {
154: function bridgeBurn(address _from, uint256 _amount) external override onlyBridge {
178: function decodeString(bytes memory _input) external pure returns (string memory result) {
183: function decodeUint8(bytes memory _input) external pure returns (uint8 result) {
```
[50](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L50) | [111](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L111) | [145](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L145) | [154](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L154) | [178](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L178) | [183](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L183)

```solidity
File: code/contracts/zksync/contracts/ForceDeployUpgrader.sol

13: function forceDeploy(IContractDeployer.ForceDeployment[] calldata _forceDeployments) external payable {
```
[13](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/ForceDeployUpgrader.sol#L13)

```solidity
File: code/contracts/zksync/contracts/L2ContractHelper.sol

90: function sendMessageToL1(bytes memory _message) internal returns (bytes32) {
101: function computeCreate2Address(
        address _sender,
        bytes32 _salt,
        bytes32 _bytecodeHash,
        bytes32 _constructorInputHash
    ) internal pure returns (address) {
```
[90](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/L2ContractHelper.sol#L90) | [101](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/L2ContractHelper.sol#L101)

```solidity
File: code/contracts/zksync/contracts/SystemContractsCaller.sol

27: function safeCastToU32(uint256 _x) internal pure returns (uint32) {
```
[27](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/SystemContractsCaller.sol#L27)
</details>

### [N-53] NatSpec: Function `@return` tag is missing

Natural Specification (NatSpec) comments are crucial for understanding the role of function arguments in your Solidity code.
Including `@return` tag will not only improve your code's readability but also its maintainability by clearly defining each argument's purpose.

[More information in Documentation](https://docs.soliditylang.org/en/develop/natspec-format.html)

<details>
<summary><i>129 issue instances in 32 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

/// @audit Missed @return `request`
182: function bridgehubDeposit(
        uint256 _chainId,
        address _prevMsgSender,
        uint256, // l2Value, needed for Weth deposits in the future
        bytes calldata _data
    ) external payable override onlyBridgehub returns (L2TransactionRequestTwoBridgesInner memory request) {
/// @audit Missed @return ``
243: function _getDepositL2Calldata(
        address _l1Sender,
        address _l2Receiver,
        address _l1Token,
        uint256 _amount
    ) internal view returns (bytes memory) {
/// @audit Missed @return ``
254: function _getERC20Getters(address _token) internal view returns (bytes memory) {
/// @audit Missed @return `l1Receiver, l1Token, amount`
409: function _finalizeWithdrawal(
        uint256 _chainId,
        uint256 _l2BatchNumber,
        uint256 _l2MessageIndex,
        uint16 _l2TxNumberInBatch,
        bytes calldata _message,
        bytes32[] calldata _merkleProof
    ) internal nonReentrant returns (address l1Receiver, address l1Token, uint256 amount) {
/// @audit Missed @return `l1Receiver, l1Token, amount`
458: function _checkWithdrawal(
        uint256 _chainId,
        MessageParams memory _messageParams,
        bytes calldata _message,
        bytes32[] calldata _merkleProof
    ) internal view returns (address l1Receiver, address l1Token, uint256 amount) {
/// @audit Missed @return `l1Receiver, l1Token, amount`
487: function _parseL2WithdrawalMessage(
        uint256 _chainId,
        bytes memory _l2ToL1message
    ) internal view returns (address l1Receiver, address l1Token, uint256 amount) {
```
[182](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L182) | [243](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L243) | [254](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L254) | [409](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L409) | [458](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L458) | [487](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L487)

```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

/// @audit Missed @return ``
75: function getStateTransition(uint256 _chainId) public view returns (address) {
/// @audit Missed @return `chainId`
114: function createNewChain(
        uint256 _chainId,
        address _stateTransitionManager,
        address _baseToken,
        uint256, //_salt
        address _admin,
        bytes calldata _initData
    ) external onlyOwnerOrAdmin nonReentrant returns (uint256 chainId) {
/// @audit Missed @return ``
152: function proveL2MessageInclusion(
        uint256 _chainId,
        uint256 _batchNumber,
        uint256 _index,
        L2Message calldata _message,
        bytes32[] calldata _proof
    ) external view override returns (bool) {
/// @audit Missed @return ``
164: function proveL2LogInclusion(
        uint256 _chainId,
        uint256 _batchNumber,
        uint256 _index,
        L2Log memory _log,
        bytes32[] calldata _proof
    ) external view override returns (bool) {
/// @audit Missed @return ``
176: function proveL1ToL2TransactionStatus(
        uint256 _chainId,
        bytes32 _l2TxHash,
        uint256 _l2BatchNumber,
        uint256 _l2MessageIndex,
        uint16 _l2TxNumberInBatch,
        bytes32[] calldata _merkleProof,
        TxStatus _status
    ) external view override returns (bool) {
/// @audit Missed @return ``
198: function l2TransactionBaseCost(
        uint256 _chainId,
        uint256 _gasPrice,
        uint256 _l2GasLimit,
        uint256 _l2GasPerPubdataByteLimit
    ) external view returns (uint256) {
/// @audit Missed @return `canonicalTxHash`
217: function requestL2TransactionDirect(
        L2TransactionRequestDirect calldata _request
    ) external payable override nonReentrant returns (bytes32 canonicalTxHash) {
/// @audit Missed @return `canonicalTxHash`
262: function requestL2TransactionTwoBridges(
        L2TransactionRequestTwoBridgesOuter calldata _request
    ) external payable override nonReentrant returns (bytes32 canonicalTxHash) {
/// @audit Missed @return `_recipient`
325: function _actualRefundRecipient(address _refundRecipient) internal view returns (address _recipient) {
```
[75](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L75) | [114](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L114) | [152](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L152) | [164](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L164) | [176](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L176) | [198](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L198) | [217](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L217) | [262](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L262) | [325](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L325)

```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

/// @audit Missed @return ``
84: function isOperation(bytes32 _id) public view returns (bool) {
/// @audit Missed @return ``
89: function isOperationPending(bytes32 _id) public view returns (bool) {
/// @audit Missed @return ``
95: function isOperationReady(bytes32 _id) public view returns (bool) {
/// @audit Missed @return ``
100: function isOperationDone(bytes32 _id) public view returns (bool) {
/// @audit Missed @return ``
105: function getOperationState(bytes32 _id) public view returns (OperationState) {
/// @audit Missed @return ``
204: function hashOperation(Operation calldata _operation) public pure returns (bytes32) {
```
[84](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L84) | [89](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L89) | [95](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L95) | [100](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L100) | [105](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L105) | [204](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L204)

```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

/// @audit Missed @return ``
74: function getChainAdmin(uint256 _chainId) external view override returns (address) {
```
[74](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L74)

```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

/// @audit Missed @return ``
102: function getCommittedBatchTimestamp(uint256 _chainId, uint256 _l2BatchNumber) external view returns (uint256) {
```
[102](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L102)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

/// @audit Missed @return ``
32: function _commitOneBatch(
        StoredBatchInfo memory _previousBatch,
        CommitBatchInfo calldata _newBatch,
        bytes32 _expectedSystemContractUpgradeTxHash
    ) internal view returns (StoredBatchInfo memory) {
/// @audit Missed @return `logOutput`
130: function _processL2Logs(
        CommitBatchInfo calldata _newBatch,
        bytes32 _expectedSystemContractUpgradeTxHash
    ) internal pure returns (LogProcessingOutput memory logOutput) {
/// @audit Missed @return `concatHash`
308: function _collectOperationsFromPriorityQueue(uint256 _nPriorityOps) internal returns (bytes32 concatHash) {
/// @audit Missed @return ``
453: function _getBatchProofPublicInput(
        bytes32 _prevBatchCommitment,
        bytes32 _currentBatchCommitment,
        VerifierParams memory _verifierParams
    ) internal pure returns (uint256) {
/// @audit Missed @return ``
500: function _createBatchCommitment(
        CommitBatchInfo calldata _newBatchData,
        bytes32 _stateDiffHash,
        bytes32[] memory _blobCommitments,
        bytes32[] memory _blobHashes
    ) internal view returns (bytes32) {
/// @audit Missed @return ``
515: function _batchPassThroughData(CommitBatchInfo calldata _batch) internal pure returns (bytes memory) {
/// @audit Missed @return ``
525: function _batchMetaParameters() internal view returns (bytes memory) {
/// @audit Missed @return ``
537: function _batchAuxiliaryOutput(
        CommitBatchInfo calldata _batch,
        bytes32 _stateDiffHash,
        bytes32[] memory _blobCommitments,
        bytes32[] memory _blobHashes
    ) internal pure returns (bytes memory) {
/// @audit Missed @return `blobAuxOutputWords`
561: function _encodeBlobAuxilaryOutput(
        bytes32[] memory _blobCommitments,
        bytes32[] memory _blobHashes
    ) internal pure returns (bytes32[] memory blobAuxOutputWords) {
/// @audit Missed @return ``
587: function _hashStoredBatchInfo(StoredBatchInfo memory _storedBatchInfo) internal pure returns (bytes32) {
/// @audit Missed @return ``
592: function _checkBit(uint256 _bitMap, uint8 _index) internal pure returns (bool) {
/// @audit Missed @return ``
597: function _setBit(uint256 _bitMap, uint8 _index) internal pure returns (uint256) {
/// @audit Missed @return `blobCommitments`
625: function _verifyBlobInformation(
        bytes calldata _pubdataCommitments,
        bytes32[] memory _blobHashes
    ) internal view returns (bytes32[] memory blobCommitments) {
/// @audit Missed @return `versionedHash`
679: function _getBlobVersionedHash(uint256 _index) internal view returns (bytes32 versionedHash) {
```
[32](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L32) | [130](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L130) | [308](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L308) | [453](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L453) | [500](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L500) | [515](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L515) | [525](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L525) | [537](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L537) | [561](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L561) | [587](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L587) | [592](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L592) | [597](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L597) | [625](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L625) | [679](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L679)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

/// @audit Missed @return `canonicalTxHash`
47: function bridgehubRequestL2Transaction(
        BridgehubL2TransactionRequest memory _request
    ) external payable onlyBridgehub returns (bytes32 canonicalTxHash) {
/// @audit Missed @return ``
104: function _proveL2LogInclusion(
        uint256 _batchNumber,
        uint256 _index,
        L2Log memory _log,
        bytes32[] calldata _proof
    ) internal view returns (bool) {
/// @audit Missed @return ``
130: function _L2MessageToLog(L2Message memory _message) internal pure returns (L2Log memory) {
/// @audit Missed @return `canonicalTxHash`
228: function _requestL2TransactionSender(
        BridgehubL2TransactionRequest memory _request
    ) internal nonReentrant returns (bytes32 canonicalTxHash) {
/// @audit Missed @return `canonicalTxHash`
258: function _requestL2Transaction(
        uint256 _mintValue,
        WritePriorityOpParams memory _params,
        bytes memory _calldata,
        bytes[] memory _factoryDeps
    ) internal returns (bytes32 canonicalTxHash) {
/// @audit Missed @return `transaction`
289: function _serializeL2Transaction(
        WritePriorityOpParams memory _priorityOpParams,
        bytes memory _calldata,
        bytes[] memory _factoryDeps
    ) internal pure returns (L2CanonicalTransaction memory transaction) {
/// @audit Missed @return `canonicalTxHash`
316: function _writePriorityOp(
        WritePriorityOpParams memory _priorityOpParams,
        bytes memory _calldata,
        bytes[] memory _factoryDeps
    ) internal returns (bytes32 canonicalTxHash) {
/// @audit Missed @return `hashedFactoryDeps`
353: function _hashFactoryDeps(bytes[] memory _factoryDeps) internal pure returns (uint256[] memory hashedFactoryDeps) {
```
[47](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L47) | [104](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L104) | [130](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L130) | [228](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L228) | [258](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L258) | [289](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L289) | [316](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L316) | [353](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L353)

```solidity
File: code/contracts/ethereum/contracts/upgrades/DefaultUpgrade.sol

/// @audit Missed @return ``
13: function upgrade(ProposedUpgrade calldata _proposedUpgrade) public override returns (bytes32) {
```
[13](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/DefaultUpgrade.sol#L13)

```solidity
File: code/contracts/ethereum/contracts/upgrades/GenesisUpgrade.sol

/// @audit Missed @return ``
14: function upgrade(ProposedUpgrade calldata _proposedUpgrade) public override returns (bytes32) {
```
[14](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/GenesisUpgrade.sol#L14)

```solidity
File: code/contracts/ethereum/contracts/common/libraries/UncheckedMath.sol

/// @audit Missed @return ``
11: function uncheckedInc(uint256 _number) internal pure returns (uint256) {
/// @audit Missed @return ``
17: function uncheckedAdd(uint256 _lhs, uint256 _rhs) internal pure returns (uint256) {
```
[11](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/UncheckedMath.sol#L11) | [17](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/UncheckedMath.sol#L17)

```solidity
File: code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol

/// @audit Missed @return `result, offset`
19: function readUint32(bytes memory _bytes, uint256 _start) internal pure returns (uint32 result, uint256 offset) {
/// @audit Missed @return `result, offset`
26: function readAddress(bytes memory _bytes, uint256 _start) internal pure returns (address result, uint256 offset) {
/// @audit Missed @return `result, offset`
33: function readUint256(bytes memory _bytes, uint256 _start) internal pure returns (uint256 result, uint256 offset) {
/// @audit Missed @return `result, offset`
40: function readBytes32(bytes memory _bytes, uint256 _start) internal pure returns (bytes32 result, uint256 offset) {
```
[19](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol#L19) | [26](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol#L26) | [33](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol#L33) | [40](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol#L40)

```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol

/// @audit Missed @return `result`
40: function _efficientHash(bytes32 _lhs, bytes32 _rhs) private pure returns (bytes32 result) {
```
[40](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol#L40)

```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol

/// @audit Missed @return `txBodyGasLimit`
109: function getTransactionBodyGasLimit(
        uint256 _totalGasLimit,
        uint256 _encodingLength
    ) internal pure returns (uint256 txBodyGasLimit) {
/// @audit Missed @return `batchOverheadForTransaction`
128: function getOverheadForTransaction(
        uint256 _encodingLength
    ) internal pure returns (uint256 batchOverheadForTransaction) {
```
[109](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L109) | [128](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L128)

```solidity
File: code/system-contracts/contracts/BootloaderUtilities.sol

/// @audit Missed @return `signedTxHash`
24: function getTransactionHashes(
        Transaction calldata _transaction
    ) external view override returns (bytes32 txHash, bytes32 signedTxHash) {
```
[24](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L24)

```solidity
File: code/system-contracts/contracts/Compressor.sol

/// @audit Missed @return `stateDiffHash`
110: function verifyCompressedStateDiffs(
        uint256 _numberOfStateDiffs,
        uint256 _enumerationIndexSize,
        bytes calldata _stateDiffs,
        bytes calldata _compressedStateDiffs
    ) external payable onlyCallFrom(address(L1_MESSENGER_CONTRACT)) returns (bytes32 stateDiffHash) {
/// @audit Missed @return `dictionary, encodedData`
197: function _decodeRawBytecode(
        bytes calldata _rawCompressedData
    ) internal pure returns (bytes calldata dictionary, bytes calldata encodedData) {
```
[110](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L110) | [197](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L197)

```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

/// @audit Missed @return `info`
34: function getAccountInfo(address _address) external view returns (AccountInfo memory info) {
/// @audit Missed @return ``
40: function extendedAccountVersion(address _address) public view returns (AccountAbstractionVersion) {
/// @audit Missed @return `newAddress`
115: function getNewAddressCreate(
        address _sender,
        uint256 _senderNonce
    ) public pure override returns (address newAddress) {
/// @audit Missed @return ``
132: function create2(
        bytes32 _salt,
        bytes32 _bytecodeHash,
        bytes calldata _input
    ) external payable override returns (address) {
/// @audit Missed @return ``
147: function create(
        bytes32 _salt,
        bytes32 _bytecodeHash,
        bytes calldata _input
    ) external payable override returns (address) {
/// @audit Missed @return ``
162: function create2Account(
        bytes32 _salt,
        bytes32 _bytecodeHash,
        bytes calldata _input,
        AccountAbstractionVersion _aaVersion
    ) public payable override onlySystemCall returns (address) {
/// @audit Missed @return ``
182: function createAccount(
        bytes32, // salt
        bytes32 _bytecodeHash,
        bytes calldata _input,
        AccountAbstractionVersion _aaVersion
    ) public payable override onlySystemCall returns (address) {
```
[34](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L34) | [40](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L40) | [115](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L115) | [132](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L132) | [147](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L147) | [162](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L162) | [182](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L182)

```solidity
File: code/system-contracts/contracts/DefaultAccount.sol

/// @audit Missed @return `magic`
67: function validateTransaction(
        bytes32, // _txHash
        bytes32 _suggestedSignedHash,
        Transaction calldata _transaction
    ) external payable override ignoreNonBootloader ignoreInDelegateCall returns (bytes4 magic) {
/// @audit Missed @return `magic`
78: function _validateTransaction(
        bytes32 _suggestedSignedHash,
        Transaction calldata _transaction
    ) internal returns (bytes4 magic) {
```
[67](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L67) | [78](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L78)

```solidity
File: code/system-contracts/contracts/KnownCodesStorage.sol

/// @audit Missed @return `marker`
65: function getMarker(bytes32 _hash) public view override returns (uint256 marker) {
```
[65](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/KnownCodesStorage.sol#L65)

```solidity
File: code/system-contracts/contracts/L1Messenger.sol

/// @audit Missed @return ``
50: function keccakGasCost(uint256 _length) internal pure returns (uint256) {
/// @audit Missed @return ``
61: function sha256GasCost(uint256 _length) internal pure returns (uint256) {
/// @audit Missed @return `logIdInMerkleTree`
70: function sendL2ToL1Log(
        bool _isService,
        bytes32 _key,
        bytes32 _value
    ) external onlyCallFromSystemContract returns (uint256 logIdInMerkleTree) {
/// @audit Missed @return `logIdInMerkleTree`
94: function _processL2ToL1Log(L2ToL1Log memory _l2ToL1Log) internal returns (uint256 logIdInMerkleTree) {
/// @audit Missed @return `hash`
116: function sendToL1(bytes calldata _message) external override returns (bytes32 hash) {
```
[50](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L50) | [61](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L61) | [70](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L70) | [94](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L94) | [116](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L116)

```solidity
File: code/system-contracts/contracts/L2BaseToken.sol

/// @audit Missed @return ``
56: function balanceOf(uint256 _account) external view override returns (uint256) {
/// @audit Missed @return `amount`
99: function _burnMsgValue() internal returns (uint256 amount) {
/// @audit Missed @return ``
112: function _getL1WithdrawMessage(address _to, uint256 _amount) internal pure returns (bytes memory) {
/// @audit Missed @return ``
117: function _getExtendedWithdrawMessage(
        address _to,
        uint256 _amount,
        address _sender,
        bytes memory _additionalData
    ) internal pure returns (bytes memory) {
/// @audit Missed @return ``
128: function name() external pure override returns (string memory) {
/// @audit Missed @return ``
134: function symbol() external pure override returns (string memory) {
/// @audit Missed @return ``
140: function decimals() external pure override returns (uint8) {
```
[56](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L2BaseToken.sol#L56) | [99](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L2BaseToken.sol#L99) | [112](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L2BaseToken.sol#L112) | [117](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L2BaseToken.sol#L117) | [128](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L2BaseToken.sol#L128) | [134](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L2BaseToken.sol#L134) | [140](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L2BaseToken.sol#L140)

```solidity
File: code/system-contracts/contracts/MsgValueSimulator.sol

/// @audit Missed @return `value, isSystemCall, to`
25: function _getAbiParams() internal view returns (uint256 value, bool isSystemCall, address to) {
```
[25](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/MsgValueSimulator.sol#L25)

```solidity
File: code/system-contracts/contracts/NonceHolder.sol

/// @audit Missed @return `minNonce`
179: function _splitRawNonce(uint256 _rawMinNonce) internal pure returns (uint256 deploymentNonce, uint256 minNonce) {
```
[179](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L179)

```solidity
File: code/system-contracts/contracts/SystemContext.sol

/// @audit Missed @return ``
117: function getCurrentPubdataSpent() public view returns (uint256) {
/// @audit Missed @return ``
122: function getCurrentPubdataCost() external view returns (uint256) {
/// @audit Missed @return `batchTimestamp`
172: function getBatchNumberAndTimestamp() public view returns (uint128 batchNumber, uint128 batchTimestamp) {
/// @audit Missed @return `blockTimestamp`
180: function getL2BlockNumberAndTimestamp() public view returns (uint128 blockNumber, uint128 blockTimestamp) {
/// @audit Missed @return ``
221: function _calculateL2BlockHash(
        uint128 _blockNumber,
        uint128 _blockTimestamp,
        bytes32 _prevL2BlockHash,
        bytes32 _blockTxsRollingHash
    ) internal pure returns (bytes32) {
/// @audit Missed @return ``
233: function _calculateLegacyL2BlockHash(uint128 _blockNumber) internal pure returns (bytes32) {
/// @audit Missed @return `blockInfo`
496: function currentBlockInfo() external view returns (uint256 blockInfo) {
/// @audit Missed @return `blockNumber, blockTimestamp`
503: function getBlockNumberAndTimestamp() external view returns (uint256 blockNumber, uint256 blockTimestamp) {
/// @audit Missed @return `hash`
509: function blockHash(uint256 _blockNumber) external view returns (bytes32 hash) {
```
[117](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L117) | [122](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L122) | [172](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L172) | [180](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L180) | [221](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L221) | [233](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L233) | [496](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L496) | [503](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L503) | [509](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L509)

```solidity
File: code/system-contracts/contracts/libraries/RLPEncoder.sol

/// @audit Missed @return `encoded`
11: function encodeAddress(address _val) internal pure returns (bytes memory encoded) {
/// @audit Missed @return `encoded`
24: function encodeUint256(uint256 _val) internal pure returns (bytes memory encoded) {
/// @audit Missed @return ``
49: function encodeNonSingleBytesLen(uint64 _len) internal pure returns (bytes memory) {
/// @audit Missed @return ``
56: function encodeListLen(uint64 _len) internal pure returns (bytes memory) {
/// @audit Missed @return `encoded`
60: function _encodeLength(uint64 _len, uint256 _offset) private pure returns (bytes memory encoded) {
/// @audit Missed @return `hbs`
84: function _highestByteSet(uint256 _number) private pure returns (uint256 hbs) {
```
[11](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/RLPEncoder.sol#L11) | [24](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/RLPEncoder.sol#L24) | [49](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/RLPEncoder.sol#L49) | [56](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/RLPEncoder.sol#L56) | [60](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/RLPEncoder.sol#L60) | [84](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/RLPEncoder.sol#L84)

```solidity
File: code/system-contracts/contracts/libraries/SystemContractHelper.sol

/// @audit Missed @return `addr`
63: function getCodeAddress() internal view returns (address addr) {
/// @audit Missed @return `rawParams`
124: function packPrecompileParams(
        uint32 _inputMemoryOffset,
        uint32 _inputMemoryLength,
        uint32 _outputMemoryOffset,
        uint32 _outputMemoryLength,
        uint64 _perPrecompileInterpreted
    ) internal pure returns (uint256 rawParams) {
/// @audit Missed @return `success`
168: function setValueForNextFarCall(uint128 _value) internal returns (bool success) {
```
[63](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L63) | [124](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L124) | [168](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L168)

```solidity
File: code/system-contracts/contracts/libraries/SystemContractsCaller.sol

/// @audit Missed @return `farCallAbi`
214: function getFarCallABI(
        uint32 dataOffset,
        uint32 memoryPage,
        uint32 dataStart,
        uint32 dataLength,
        uint32 gasPassed,
        uint8 shardId,
        CalldataForwardingMode forwardingMode,
        bool isConstructorCall,
        bool isSystemCall
    ) internal pure returns (uint256 farCallAbi) {
```
[214](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L214)

```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

/// @audit Missed @return `resultHash`
100: function encodeHash(Transaction calldata _transaction) internal view returns (bytes32 resultHash) {
/// @audit Missed @return `success`
395: function payToTheBootloader(Transaction calldata _transaction) internal returns (bool success) {
/// @audit Missed @return `requiredBalance`
405: function totalRequiredBalance(Transaction calldata _transaction) internal pure returns (uint256 requiredBalance) {
```
[100](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L100) | [395](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L395) | [405](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L405)

```solidity
File: code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol

/// @audit Missed @return `result`
19: function readUint16(bytes calldata _bytes, uint256 _start) internal pure returns (uint16 result) {
/// @audit Missed @return `result`
26: function readUint32(bytes calldata _bytes, uint256 _start) internal pure returns (uint32 result) {
/// @audit Missed @return `result`
33: function readUint64(bytes calldata _bytes, uint256 _start) internal pure returns (uint64 result) {
/// @audit Missed @return `result`
40: function readBytes32(bytes calldata _bytes, uint256 _start) internal pure returns (bytes32 result) {
/// @audit Missed @return `result`
46: function readUint256(bytes calldata _bytes, uint256 _start) internal pure returns (uint256 result) {
```
[19](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol#L19) | [26](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol#L26) | [33](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol#L33) | [40](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol#L40) | [46](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol#L46)

```solidity
File: code/system-contracts/contracts/libraries/Utils.sol

/// @audit Missed @return ``
20: function safeCastToU128(uint256 _x) internal pure returns (uint128) {
/// @audit Missed @return ``
26: function safeCastToU32(uint256 _x) internal pure returns (uint32) {
/// @audit Missed @return ``
32: function safeCastToU24(uint256 _x) internal pure returns (uint24) {
/// @audit Missed @return ``
51: function isContractConstructed(bytes32 _bytecodeHash) internal pure returns (bool) {
/// @audit Missed @return ``
56: function isContractConstructing(bytes32 _bytecodeHash) internal pure returns (bool) {
```
[20](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L20) | [26](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L26) | [32](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L32) | [51](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L51) | [56](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L56)

```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

/// @audit Missed @return ``
109: function _deployL2Token(address _l1Token, bytes calldata _data) internal returns (address) {
/// @audit Missed @return ``
138: function _getL1WithdrawMessage(
        address _to,
        address _l1Token,
        uint256 _amount
    ) internal pure returns (bytes memory) {
/// @audit Missed @return `salt`
157: function _getCreate2Salt(address _l1Token) internal pure returns (bytes32 salt) {
/// @audit Missed @return `proxy`
164: function _deployBeaconProxy(bytes32 salt) internal returns (BeaconProxy proxy) {
```
[109](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L109) | [138](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L138) | [157](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L157) | [164](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L164)

```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

/// @audit Missed @return ``
159: function name() public view override returns (string memory) {
/// @audit Missed @return ``
165: function symbol() public view override returns (string memory) {
/// @audit Missed @return ``
171: function decimals() public view override returns (uint8) {
/// @audit Missed @return `result`
178: function decodeString(bytes memory _input) external pure returns (string memory result) {
/// @audit Missed @return `result`
183: function decodeUint8(bytes memory _input) external pure returns (uint8 result) {
```
[159](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L159) | [165](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L165) | [171](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L171) | [178](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L178) | [183](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L183)

```solidity
File: code/contracts/zksync/contracts/SystemContractsCaller.sol

/// @audit Missed @return ``
27: function safeCastToU32(uint256 _x) internal pure returns (uint32) {
/// @audit Missed @return `success`
37: function systemCall(uint32 gasLimit, address to, uint256 value, bytes memory data) internal returns (bool success) {
/// @audit Missed @return `success, returnData`
76: function systemCallWithReturndata(
        uint32 gasLimit,
        address to,
        uint128 value,
        bytes memory data
    ) internal returns (bool success, bytes memory returnData) {
/// @audit Missed @return `farCallAbi`
95: function getFarCallABI(
        uint32 dataOffset,
        uint32 memoryPage,
        uint32 dataStart,
        uint32 dataLength,
        uint32 gasPassed,
        uint8 shardId,
        CalldataForwardingMode forwardingMode,
        bool isConstructorCall,
        bool isSystemCall
    ) internal pure returns (uint256 farCallAbi) {
/// @audit Missed @return `farCallAbiWithEmptyFatPtr`
121: function getFarCallABIWithEmptyFatPointer(
        uint32 gasPassed,
        uint8 shardId,
        CalldataForwardingMode forwardingMode,
        bool isConstructorCall,
        bool isSystemCall
    ) internal pure returns (uint256 farCallAbiWithEmptyFatPtr) {
```
[27](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/SystemContractsCaller.sol#L27) | [37](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/SystemContractsCaller.sol#L37) | [76](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/SystemContractsCaller.sol#L76) | [95](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/SystemContractsCaller.sol#L95) | [121](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/SystemContractsCaller.sol#L121)
</details>

### [N-54] State-Altering Functions Should Emit Events

Functions that alter state should emit events to inform users of the state change.
This is crucial for functions that modify the state and don't return a value.
The absence of events in such scenarios could lead to lack of transparency and traceability, undermining the contract's reliability.

<details>
<summary><i>21 issue instances in 8 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

111: eraFirstPostUpgradeBatch = _eraFirstPostUpgradeBatch;
```
[111](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L111)

```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

109: sharedBridge = IL1SharedBridge(_sharedBridge);
```
[109](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L109)

```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

85: genesisUpgrade = _initializeData.genesisUpgrade;
133: validatorTimelock = _validatorTimelock;
138: initialCutHash = keccak256(abi.encode(_diamondCut));
148: protocolVersion = _newProtocolVersion;
```
[85](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L85) | [133](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L133) | [138](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L138) | [148](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L148)

```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

74: stateTransitionManager = _stateTransitionManager;
```
[74](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L74)

```solidity
File: code/system-contracts/contracts/L1Messenger.sol

329: chainedLogsHash = bytes32(0);
```
[329](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L329)

```solidity
File: code/system-contracts/contracts/L2BaseToken.sol

107: totalSupply -= amount;
```
[107](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L2BaseToken.sol#L107)

```solidity
File: code/system-contracts/contracts/SystemContext.sol

85: chainId = _newChainId;
100: origin = _newOrigin;
106: gasPrice = _gasPrice;
113: basePubdataSpent = _basePubdataSpent;
271: currentVirtualL2BlockInfo = currentL2BlockInfo;
316: currentL2BlockInfo = BlockInfo({number: _l2BlockNumber, timestamp: _l2BlockTimestamp});
403: currentL2BlockTxsRollingHash = keccak256(abi.encode(currentL2BlockTxsRollingHash, _txHash));
461: currentBatchInfo = newBlockInfo;
477: currentBatchInfo = newBlockInfo;
483: txNumberInBlock += 1;
487: txNumberInBlock = 0;
```
[85](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L85) | [100](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L100) | [106](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L106) | [113](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L113) | [271](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L271) | [316](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L316) | [403](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L403) | [461](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L461) | [477](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L477) | [483](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L483) | [487](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L487)

```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

60: l1Bridge = _l1Bridge;
```
[60](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L60)
</details>

### [N-55] Upgrade `openzeppelin` to the Latest Version - 5.0.0

These contracts import contracts from @openzeppelin/contracts but they are not using the latest version.
For more information, please visit: [OpenZeppelin GitHub Releases](https://github.com/OpenZeppelin/openzeppelin-contracts/releases)
It is recommended to always use the latest version to take advantage of updates and security fixes.

<details>
<summary><i>22 issue instances in 12 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

5: import {IERC20} from "@openzeppelin/contracts/token/ERC20/IERC20.sol";
6: import {SafeERC20} from "@openzeppelin/contracts/token/ERC20/utils/SafeERC20.sol";
```
[5](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L5) | [6](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L6)

```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

5: import {Initializable} from "@openzeppelin/contracts/proxy/utils/Initializable.sol";
6: import {Ownable2Step} from "@openzeppelin/contracts/access/Ownable2Step.sol";
8: import {IERC20Metadata} from "@openzeppelin/contracts/token/ERC20/extensions/IERC20Metadata.sol";
9: import {IERC20} from "@openzeppelin/contracts/token/ERC20/IERC20.sol";
10: import {SafeERC20} from "@openzeppelin/contracts/token/ERC20/utils/SafeERC20.sol";
```
[5](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L5) | [6](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L6) | [8](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L8) | [9](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L9) | [10](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L10)

```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

5: import {Ownable2Step} from "@openzeppelin/contracts/access/Ownable2Step.sol";
```
[5](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L5)

```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

5: import {Ownable2Step} from "@openzeppelin/contracts/access/Ownable2Step.sol";
```
[5](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L5)

```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

16: import {Ownable2Step} from "@openzeppelin/contracts/access/Ownable2Step.sol";
```
[16](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L16)

```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

5: import {Ownable2Step} from "@openzeppelin/contracts/access/Ownable2Step.sol";
```
[5](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L5)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

5: import {Math} from "@openzeppelin/contracts/utils/math/Math.sol";
```
[5](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L5)

```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol

5: import {SafeCast} from "@openzeppelin/contracts/utils/math/SafeCast.sol";
```
[5](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L5)

```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol

5: import {Math} from "@openzeppelin/contracts/utils/math/Math.sol";
```
[5](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L5)

```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

5: import "../openzeppelin/token/ERC20/IERC20.sol";
6: import "../openzeppelin/token/ERC20/utils/SafeERC20.sol";
```
[5](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L5) | [6](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L6)

```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

5: import {Initializable} from "@openzeppelin/contracts/proxy/utils/Initializable.sol";
6: import {BeaconProxy} from "@openzeppelin/contracts/proxy/beacon/BeaconProxy.sol";
7: import {UpgradeableBeacon} from "@openzeppelin/contracts/proxy/beacon/UpgradeableBeacon.sol";
```
[5](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L5) | [6](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L6) | [7](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L7)

```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

5: import {ERC20PermitUpgradeable} from "@openzeppelin/contracts-upgradeable/token/ERC20/extensions/draft-ERC20PermitUpgradeable.sol";
6: import {UpgradeableBeacon} from "@openzeppelin/contracts/proxy/beacon/UpgradeableBeacon.sol";
7: import {ERC1967Upgrade} from "@openzeppelin/contracts/proxy/ERC1967/ERC1967Upgrade.sol";
```
[5](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L5) | [6](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L6) | [7](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L7)
</details>

### [N-56] Interface Names Should Begin with a Capital `I`

It is a common practice in Solidity programming to prefix the names of interfaces with a capital 'I'.
This helps to clearly distinguish interfaces from other types of contracts, such as ordinary contracts or libraries, enhancing the readability and maintainability of the code.

<details>
<summary><i>1 issue instances in 1 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

206: require(s.chainId == ERA_CHAIN_ID, "legacy interface only available for era token");
```
[206](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L206)
</details>

### [N-57] Duplicated `require()`/`revert()` checks should be refactored to a modifier or function

Duplicated require() or revert() checks should be refactored to a modifier or function.
This helps in maintaining a clean and organized codebase and saves deployment costs.

<details>
<summary><i>7 issue instances in 3 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

195: require(block.timestamp >= commitBatchTimestamp + delay, "5c"); // The delay is not passed
217: require(block.timestamp >= commitBatchTimestamp + delay, "5c"); // The delay is not passed
```
[195](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L195) | [217](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L217)

```solidity
File: code/system-contracts/contracts/BootloaderUtilities.sol

92: require(vInt == 27 || vInt == 28, "Invalid v value");
191: require(vInt == 27 || vInt == 28, "Invalid v value");
286: require(vInt == 27 || vInt == 28, "Invalid v value");
```
[92](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L92) | [191](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L191) | [286](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L286)

```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

56: require(_l2TokenProxyBytecodeHash != bytes32(0), "df");
58: require(_l2TokenProxyBytecodeHash != bytes32(0), "df");
```
[56](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L56) | [58](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L58)
</details>

### [N-58] Non-specific Imports

The current form of relative path import is not recommended for use because it can unpredictably pollute the namespace.
Instead, the Solidity docs recommend specifying imported symbols explicitly.
https://docs.soliditylang.org/en/v0.8.15/layout-of-source-files.html#importing-other-source-files

Example:
import {OwnableUpgradeable} from "openzeppelin-contracts-upgradeable/contracts/access/OwnableUpgradeable.sol";
import {SafeTransferLib} from "solmate/utils/SafeTransferLib.sol";

<details>
<summary><i>41 issue instances in 17 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

7: import "./IBridgehub.sol";
8: import "../bridge/interfaces/IL1SharedBridge.sol";
9: import "../state-transition/IStateTransitionManager.sol";
10: import "../common/ReentrancyGuard.sol";
11: import "../state-transition/chain-interfaces/IZkSyncStateTransition.sol";
14: import "../vendor/AddressAliasHelper.sol";
```
[7](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L7) | [8](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L8) | [9](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L9) | [10](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L10) | [11](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L11) | [14](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L14)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol

12: import "../l2-deps/ISystemContext.sol";
```
[12](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol#L12)

```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol

5: import "../state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol";
6: import "../state-transition/chain-interfaces/IMailbox.sol";
7: import "../state-transition/chain-interfaces/IVerifier.sol";
8: import "../common/libraries/L2ContractHelper.sol";
9: import "../common/Messaging.sol";
10: import "../state-transition/libraries/TransactionValidator.sol";
```
[5](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L5) | [6](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L6) | [7](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L7) | [8](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L8) | [9](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L9) | [10](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L10)

```solidity
File: code/contracts/ethereum/contracts/upgrades/GenesisUpgrade.sol

5: import "../state-transition/libraries/Diamond.sol";
6: import "./BaseZkSyncUpgradeGenesis.sol";
7: import "./IDefaultUpgrade.sol";
```
[5](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/GenesisUpgrade.sol#L5) | [6](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/GenesisUpgrade.sol#L6) | [7](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/GenesisUpgrade.sol#L7)

```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol

5: import "./IL1SharedBridge.sol";
```
[5](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L5)

```solidity
File: code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol

6: import "../common/Messaging.sol";
7: import "../state-transition/IStateTransitionManager.sol";
8: import "../state-transition/libraries/Diamond.sol";
```
[6](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L6) | [7](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L7) | [8](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L8)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol

13: import "../libraries/Diamond.sol";
```
[13](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol#L13)

```solidity
File: code/system-contracts/contracts/AccountCodeStorage.sol

5: import "./interfaces/IAccountCodeStorage.sol";
6: import "./libraries/Utils.sol";
```
[5](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/AccountCodeStorage.sol#L5) | [6](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/AccountCodeStorage.sol#L6)

```solidity
File: code/system-contracts/contracts/DefaultAccount.sol

5: import "./interfaces/IAccount.sol";
6: import "./libraries/TransactionHelper.sol";
7: import "./libraries/SystemContractHelper.sol";
8: import "./libraries/EfficientCall.sol";
```
[5](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L5) | [6](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L6) | [7](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L7) | [8](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L8)

```solidity
File: code/system-contracts/contracts/libraries/EfficientCall.sol

5: import "./SystemContractHelper.sol";
6: import "./Utils.sol";
```
[5](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L5) | [6](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L6)

```solidity
File: code/system-contracts/contracts/libraries/SystemContractsCaller.sol

6: import "./Utils.sol";
```
[6](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L6)

```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

5: import "../openzeppelin/token/ERC20/IERC20.sol";
6: import "../openzeppelin/token/ERC20/utils/SafeERC20.sol";
8: import "../interfaces/IPaymasterFlow.sol";
9: import "../interfaces/IContractDeployer.sol";
11: import "./RLPEncoder.sol";
12: import "./EfficientCall.sol";
```
[5](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L5) | [6](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L6) | [8](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L8) | [9](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L9) | [11](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L11) | [12](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L12)

```solidity
File: code/system-contracts/contracts/libraries/Utils.sol

4: import "./EfficientCall.sol";
```
[4](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L4)

```solidity
File: code/system-contracts/contracts/interfaces/IAccount.sol

5: import "../libraries/TransactionHelper.sol";
```
[5](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IAccount.sol#L5)

```solidity
File: code/system-contracts/contracts/interfaces/IBootloaderUtilities.sol

5: import "../libraries/TransactionHelper.sol";
```
[5](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IBootloaderUtilities.sol#L5)

```solidity
File: code/system-contracts/contracts/interfaces/IPaymaster.sol

5: import "../libraries/TransactionHelper.sol";
```
[5](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IPaymaster.sol#L5)

```solidity
File: code/contracts/zksync/contracts/interfaces/IPaymaster.sol

5: import "../L2ContractHelper.sol";
```
[5](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/interfaces/IPaymaster.sol#L5)
</details>

### [N-59] Event is not properly `indexed`

Index event fields make the field more quickly accessible to off-chain tools that parse events.
This is especially useful when it comes to filtering based on an address. However, note that each index field costs extra gas during emission, so it's not necessarily best to index the maximum allowed per event (three fields).
Where applicable, each event should use three indexed fields if there are three or more fields, and gas usage is not particularly of concern for the events in question.
If there are fewer than three applicable fields, all of the applicable fields should be indexed.

<details>
<summary><i>42 issue instances in 19 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

29: event NewExecutionDelay(uint256 _newExecutionDelay);
32: event ValidatorAdded(uint256 _chainId, address _addedValidator);
35: event ValidatorRemoved(uint256 _chainId, address _removedValidator);
```
[29](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L29) | [32](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L32) | [35](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L35)

```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol

58: event NewVerifierParams(VerifierParams oldVerifierParams, VerifierParams newVerifierParams);
61: event UpgradeComplete(uint256 indexed newProtocolVersion, bytes32 indexed l2UpgradeTxHash, ProposedUpgrade upgrade);
```
[58](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L58) | [61](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L61)

```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol

24: event DiamondCut(FacetCut[] facetCuts, address initAddress, bytes initCalldata);
```
[24](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L24)

```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol

20: event WithdrawalFinalized(address indexed to, address indexed l1Token, uint256 amount);
22: event ClaimedFailedDeposit(address indexed to, address indexed l1Token, uint256 amount);
```
[20](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L20) | [22](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L22)

```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol

31: event BridgehubDepositBaseTokenInitiated(
        uint256 indexed chainId,
        address indexed from,
        address l1Token,
        uint256 amount
    );
```
[31](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L31)

```solidity
File: code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol

133: event NewChain(uint256 indexed chainId, address stateTransitionManager, address indexed chainGovernance);
```
[133](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L133)

```solidity
File: code/contracts/ethereum/contracts/governance/IGovernance.sol

68: event TransparentOperationScheduled(bytes32 indexed _id, uint256 delay, Operation _operation);
71: event ShadowOperationScheduled(bytes32 indexed _id, uint256 delay);
77: event ChangeSecurityCouncil(address _securityCouncilBefore, address _securityCouncilAfter);
80: event ChangeMinDelay(uint256 _delayBefore, uint256 _delayAfter);
```
[68](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/IGovernance.sol#L68) | [71](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/IGovernance.sol#L71) | [77](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/IGovernance.sol#L77) | [80](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/IGovernance.sol#L80)

```solidity
File: code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol

30: event SetChainIdUpgrade(
        address indexed _stateTransitionChain,
        L2CanonicalTransaction _l2Transaction,
        uint256 indexed _protocolVersion
    );
```
[30](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L30)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol

61: event IsPorterAvailableStatusUpdate(bool isPorterAvailable);
64: event ValidatorStatusUpdate(address indexed validatorAddress, bool isActive);
74: event NewPriorityTxMaxGasLimit(uint256 oldPriorityTxMaxGasLimit, uint256 newPriorityTxMaxGasLimit);
77: event NewFeeParams(FeeParams oldFeeParams, FeeParams newFeeParams);
80: event ValidiumModeStatusUpdate(PubdataPricingMode validiumMode);
83: event NewBaseTokenMultiplier(
        uint128 oldNominator,
        uint128 oldDenominator,
        uint128 newNominator,
        uint128 newDenominator
    );
91: event ExecuteUpgrade(Diamond.DiamondCutData diamondCut);
```
[61](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L61) | [64](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L64) | [74](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L74) | [77](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L77) | [80](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L80) | [83](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L83) | [91](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L91)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol

211: event BlocksRevert(uint256 totalBatchesCommitted, uint256 totalBatchesVerified, uint256 totalBatchesExecuted);
```
[211](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L211)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol

123: event NewPriorityRequest(
        uint256 txId,
        bytes32 txHash,
        uint64 expirationTimestamp,
        L2CanonicalTransaction transaction,
        bytes[] factoryDeps
    );
134: event EthWithdrawalFinalized(address indexed to, uint256 amount);
```
[123](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L123) | [134](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L134)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol

17: event ProposeTransparentUpgrade(
        Diamond.DiamondCutData diamondCut,
        uint256 indexed proposalId,
        bytes32 proposalSalt
    );
```
[17](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol#L17)

```solidity
File: code/system-contracts/contracts/interfaces/IBaseToken.sol

24: event Mint(address indexed account, uint256 amount);
26: event Transfer(address indexed from, address indexed to, uint256 value);
28: event Withdrawal(address indexed _l2Sender, address indexed _l1Receiver, uint256 _amount);
30: event WithdrawalWithMessage(
        address indexed _l2Sender,
        address indexed _l1Receiver,
        uint256 _amount,
        bytes _additionalData
    );
```
[24](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IBaseToken.sol#L24) | [26](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IBaseToken.sol#L26) | [28](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IBaseToken.sol#L28) | [30](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IBaseToken.sol#L30)

```solidity
File: code/system-contracts/contracts/interfaces/IContractDeployer.sol

39: event AccountNonceOrderingUpdated(address indexed accountAddress, AccountNonceOrdering nonceOrdering);
41: event AccountVersionUpdated(address indexed accountAddress, AccountAbstractionVersion aaVersion);
```
[39](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L39) | [41](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L41)

```solidity
File: code/system-contracts/contracts/interfaces/IL1Messenger.sol

43: event L1MessageSent(address indexed _sender, bytes32 indexed _hash, bytes _message);
45: event L2ToL1LogSent(L2ToL1Log _l2log);
47: event BytecodeL1PublicationRequested(bytes32 _bytecodeHash);
```
[43](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IL1Messenger.sol#L43) | [45](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IL1Messenger.sol#L45) | [47](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IL1Messenger.sol#L47)

```solidity
File: code/system-contracts/contracts/interfaces/IL2StandardToken.sol

6: event BridgeMint(address indexed _account, uint256 _amount);
8: event BridgeBurn(address indexed _account, uint256 _amount);
```
[6](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IL2StandardToken.sol#L6) | [8](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IL2StandardToken.sol#L8)

```solidity
File: code/system-contracts/contracts/interfaces/INonceHolder.sol

14: event ValueSetUnderNonce(address indexed accountAddress, uint256 indexed key, uint256 value);
```
[14](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/INonceHolder.sol#L14)

```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol

22: event BaseTokenReceived(uint256 amount);
```
[22](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol#L22)

```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol

6: event BridgeInitialize(address indexed l1Token, string name, string symbol, uint8 decimals);
8: event BridgeMint(address indexed _account, uint256 _amount);
10: event BridgeBurn(address indexed _account, uint256 _amount);
```
[6](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol#L6) | [8](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol#L8) | [10](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol#L10)
</details>

### [N-60] Consider Adding Emergency-Stop Functionality

Smart contracts that hold significant value, interact with external contracts, or have complex logic should include an emergency-stop mechanism for added security. This allows pausing certain contract functionalities in case of emergencies, mitigating potential damages.

This contract seems to lack such a mechanism. Implementing an emergency stop can enhance contract security and reliability.

<details>
<summary><i>35 issue instances in 34 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

1: No emergency stop pattern found
1: No emergency stop pattern found
```
[1](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L1) | [1](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L1)

```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

1: No emergency stop pattern found
```
[1](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L1)

```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

1: No emergency stop pattern found
```
[1](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L1)

```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

1: No emergency stop pattern found
```
[1](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L1)

```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

1: No emergency stop pattern found
```
[1](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L1)

```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

1: No emergency stop pattern found
```
[1](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L1)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol

1: No emergency stop pattern found
```
[1](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol#L1)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol

1: No emergency stop pattern found
```
[1](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol#L1)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol

1: No emergency stop pattern found
```
[1](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L1)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

1: No emergency stop pattern found
```
[1](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L1)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol

1: No emergency stop pattern found
```
[1](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L1)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

1: No emergency stop pattern found
```
[1](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L1)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol

1: No emergency stop pattern found
```
[1](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L1)

```solidity
File: code/contracts/ethereum/contracts/upgrades/DefaultUpgrade.sol

1: No emergency stop pattern found
```
[1](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/DefaultUpgrade.sol#L1)

```solidity
File: code/contracts/ethereum/contracts/upgrades/GenesisUpgrade.sol

1: No emergency stop pattern found
```
[1](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/GenesisUpgrade.sol#L1)

```solidity
File: code/system-contracts/contracts/AccountCodeStorage.sol

1: No emergency stop pattern found
```
[1](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/AccountCodeStorage.sol#L1)

```solidity
File: code/system-contracts/contracts/BootloaderUtilities.sol

1: No emergency stop pattern found
```
[1](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L1)

```solidity
File: code/system-contracts/contracts/ComplexUpgrader.sol

1: No emergency stop pattern found
```
[1](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ComplexUpgrader.sol#L1)

```solidity
File: code/system-contracts/contracts/Compressor.sol

1: No emergency stop pattern found
```
[1](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L1)

```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

1: No emergency stop pattern found
```
[1](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L1)

```solidity
File: code/system-contracts/contracts/DefaultAccount.sol

1: No emergency stop pattern found
```
[1](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L1)

```solidity
File: code/system-contracts/contracts/EmptyContract.sol

1: No emergency stop pattern found
```
[1](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/EmptyContract.sol#L1)

```solidity
File: code/system-contracts/contracts/ImmutableSimulator.sol

1: No emergency stop pattern found
```
[1](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ImmutableSimulator.sol#L1)

```solidity
File: code/system-contracts/contracts/KnownCodesStorage.sol

1: No emergency stop pattern found
```
[1](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/KnownCodesStorage.sol#L1)

```solidity
File: code/system-contracts/contracts/L1Messenger.sol

1: No emergency stop pattern found
```
[1](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L1)

```solidity
File: code/system-contracts/contracts/L2BaseToken.sol

1: No emergency stop pattern found
```
[1](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L2BaseToken.sol#L1)

```solidity
File: code/system-contracts/contracts/MsgValueSimulator.sol

1: No emergency stop pattern found
```
[1](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/MsgValueSimulator.sol#L1)

```solidity
File: code/system-contracts/contracts/NonceHolder.sol

1: No emergency stop pattern found
```
[1](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L1)

```solidity
File: code/system-contracts/contracts/PubdataChunkPublisher.sol

1: No emergency stop pattern found
```
[1](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/PubdataChunkPublisher.sol#L1)

```solidity
File: code/system-contracts/contracts/SystemContext.sol

1: No emergency stop pattern found
```
[1](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L1)

```solidity
File: code/system-contracts/contracts/GasBoundCaller.sol

1: No emergency stop pattern found
```
[1](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/GasBoundCaller.sol#L1)

```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

1: No emergency stop pattern found
```
[1](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L1)

```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

1: No emergency stop pattern found
```
[1](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L1)

```solidity
File: code/contracts/zksync/contracts/ForceDeployUpgrader.sol

1: No emergency stop pattern found
```
[1](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/ForceDeployUpgrader.sol#L1)
</details>

### [N-61] Missing NatSpec Descriptions for Modifier Declarations

Modifiers in the contract should include NatSpec comments, specifically with the `@dev` or `@notice` tags to elucidate their role and input parameters.
These annotations assist in offering a clearer insight into the contract's operation for developers, auditors, and end-users.
[Additional Details in Solidity Documentation](https://docs.soliditylang.org/en/latest/natspec-format.html)

<details>
<summary><i>11 issue instances in 6 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

45: modifier onlyOwnerOrAdmin() {
```
[45](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L45)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol

26: modifier onlyStateTransitionManager() {
31: modifier onlyBridgehub() {
36: modifier onlyAdminOrStateTransitionManager() {
44: modifier onlyValidatorOrStateTransitionManager() {
52: modifier onlyBaseTokenBridge() {
```
[26](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L26) | [31](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L31) | [36](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L36) | [44](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L44) | [52](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L52)

```solidity
File: code/contracts/ethereum/contracts/common/ReentrancyGuard.sol

41: modifier reentrancyGuardInitializer() {
```
[41](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/ReentrancyGuard.sol#L41)

```solidity
File: code/system-contracts/contracts/AccountCodeStorage.sol

25: modifier onlyDeployer() {
```
[25](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/AccountCodeStorage.sol#L25)

```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

28: modifier onlySelf() {
```
[28](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L28)

```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

129: modifier onlyBridge() {
134: modifier onlyNextVersion(uint8 _version) {
```
[129](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L129) | [134](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L134)
</details>

### [N-62] `constant` variables not using all capital letters

Variable names for `constant` variables should consist of all capital letters.

<details>
<summary><i>7 issue instances in 7 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

26: string public constant override getName = "ValidatorTimelock";
```
[26](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L26)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol

20: string public constant override getName = "AdminFacet";
```
[20](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L20)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

27: string public constant override getName = "ExecutorFacet";
```
[27](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L27)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol

25: string public constant override getName = "GettersFacet";
```
[25](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L25)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

35: string public constant override getName = "MailboxFacet";
```
[35](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L35)

```solidity
File: code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol

22: uint160 constant offset = uint160(0x1111000000000000000000000000000000001111);
```
[22](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol#L22)

```solidity
File: code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol

22: uint160 constant offset = uint160(0x1111000000000000000000000000000000001111);
```
[22](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol#L22)
</details>

### [N-63] Consider adding a block/deny-list

While adding a block or deny-list may increase the level of centralization in the contract, it provides an additional layer of security by preventing hackers from using stolen tokens or carrying out other malicious activities.

Although it's a trade-off, a block or deny-list can help improve the overall security posture of the contract.

<details>
<summary><i>4 issue instances in 3 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

19: contract L1ERC20Bridge is IL1ERC20Bridge, ReentrancyGuard {
19: contract L1ERC20Bridge is IL1ERC20Bridge, ReentrancyGuard {
```
[19](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L19) | [19](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L19)

```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

30: contract L1SharedBridge is IL1SharedBridge, ReentrancyGuard, Initializable, Ownable2Step {
```
[30](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L30)

```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

15: contract L2StandardERC20 is ERC20PermitUpgradeable, IL2StandardToken, ERC1967Upgrade {
```
[15](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L15)
</details>

### [N-64] Non-uppercase/Constant-case Naming for `immutable` Variables

For better readability and adherence to common naming conventions, variable names declared as immutable should be written in all uppercase letters.

<details>
<summary><i>6 issue instances in 3 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

23: IL1SharedBridge public immutable override sharedBridge;
23: IL1SharedBridge public immutable override sharedBridge;
```
[23](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L23) | [23](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L23)

```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

34: address public immutable override l1WethAddress;
37: IBridgehub public immutable override bridgehub;
40: IL1ERC20Bridge public immutable override legacyBridge;
```
[34](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L34) | [37](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L37) | [40](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L40)

```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

27: address public immutable bridgehub;
```
[27](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L27)
</details>

### [N-65] Not using the named return variables anywhere in the function is confusing

Declaring a named return variable but returning a different value within the function is an inconsistent use of named return variables.
This practice can lead to confusion and misinterpretation of the function's intended behavior, as it contradicts the purpose of declaring named return variables, which is to enhance readability and reduce complexity in the code.

This inconsistency might signal an error in the function logic where the declared return variable is not being used as intended.
It is recommended to revisit the function's logic to ensure that the named return variables are being utilized correctly, or to adjust the return statements to reflect the actual values being returned, fostering better clarity and coherence in the code.

<details>
<summary><i>3 issue instances in 3 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

/// @audit - `return _chainId;` statement in functions but `chainId` are declared
114: function createNewChain(
        uint256 _chainId,
        address _stateTransitionManager,
        address _baseToken,
        uint256, //_salt
        address _admin,
        bytes calldata _initData
    ) external onlyOwnerOrAdmin nonReentrant returns (uint256 chainId) {
```
[114](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L114)

```solidity
File: code/system-contracts/contracts/BootloaderUtilities.sol

/// @audit - `return
            keccak256(
                bytes.concat(
                    encodedListLength,
                    encodedNonce,
                    encodedGasParam,
                    encodedTo,
                    encodedValue,
                    encodedDataLength,
                    _transaction.data,
                    vEncoded,
                    rEncoded,
                    sEncoded
                )
            );` statement in functions but `txHash` are declared
44: function encodeLegacyTransactionHash(Transaction calldata _transaction) internal view returns (bytes32 txHash) {
```
[44](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L44)

```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

/// @audit - `return accountInfo[_address];` statement in functions but `info` are declared
34: function getAccountInfo(address _address) external view returns (AccountInfo memory info) {
```
[34](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L34)
</details>

### [N-66] Function Names Not in mixedCase

Function names should use mixedCase for better readability and consistency with Solidity style guidelines. 
Examples of good practice include: getBalance, transfer, verifyOwner, addMember, changeOwner. 
[More information in Documentation](https://docs.soliditylang.org/en/v0.8.20/style-guide.html#function-names)

<details>
<summary><i>12 issue instances in 7 files:</i></summary>

```solidity
File: code/system-contracts/contracts/BootloaderUtilities.sol

139: function encodeEIP2930TransactionHash(Transaction calldata _transaction) internal view returns (bytes32) {
229: function encodeEIP1559TransactionHash(Transaction calldata _transaction) internal view returns (bytes32) {
```
[139](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L139) | [229](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L229)

```solidity
File: code/system-contracts/contracts/SystemContext.sol

132: function getBlockHashEVM(uint256 _block) external view returns (bytes32 hash) {
```
[132](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L132)

```solidity
File: code/system-contracts/contracts/libraries/EfficientCall.sol

245: function _loadFarCallABIIntoActivePtr(
```
[245](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L245)

```solidity
File: code/system-contracts/contracts/libraries/SystemContractsCaller.sol

214: function getFarCallABI(
250: function getFarCallABIWithEmptyFatPointer(
```
[214](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L214) | [250](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L250)

```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

118: function _encodeHashEIP712Transaction(Transaction calldata _transaction) private view returns (bytes32) {
219: function _encodeHashEIP2930Transaction(Transaction calldata _transaction) private view returns (bytes32) {
289: function _encodeHashEIP1559Transaction(Transaction calldata _transaction) private view returns (bytes32) {
```
[118](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L118) | [219](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L219) | [289](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L289)

```solidity
File: code/system-contracts/contracts/interfaces/ISystemContext.sol

45: function getBlockHashEVM(uint256 _block) external view returns (bytes32);
```
[45](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/ISystemContext.sol#L45)

```solidity
File: code/contracts/zksync/contracts/SystemContractsCaller.sol

94: function getFarCallABI(
120: function getFarCallABIWithEmptyFatPointer(
```
[94](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/SystemContractsCaller.sol#L94) | [120](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/SystemContractsCaller.sol#L120)
</details>

### [N-67] Insufficient Comments in Complex Functions

Complex functions spanning multiple lines should have more comments to better explain the purpose of each logic step.
Proper commenting can greatly improve the readability and maintainability of the codebase. Consider adding explicit comments
to provide insights into the function's operation.

<details>
<summary><i>16 issue instances in 9 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

/// @audit function with 33 lines has only 3 comment lines
182: function bridgehubDeposit(
        uint256 _chainId,
        address _prevMsgSender,
        uint256, // l2Value, needed for Weth deposits in the future
        bytes calldata _data
    ) external payable override onlyBridgehub returns (L2TransactionRequestTwoBridgesInner memory request) {
/// @audit function with 40 lines has only 9 comment lines
303: function _claimFailedDeposit(
        bool _checkedInLegacyBridge,
        uint256 _chainId,
        address _depositSender,
        address _l1Token,
        uint256 _amount,
        bytes32 _l2TxHash,
        uint256 _l2BatchNumber,
        uint256 _l2MessageIndex,
        uint16 _l2TxNumberInBatch,
        bytes32[] calldata _merkleProof
    ) internal nonReentrant {
```
[182](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L182) | [303](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L303)

```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

/// @audit function with 52 lines has only 1 comment lines
262: function requestL2TransactionTwoBridges(
        L2TransactionRequestTwoBridgesOuter calldata _request
    ) external payable override nonReentrant returns (bytes32 canonicalTxHash) {
```
[262](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L262)

```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

/// @audit function with 45 lines has only 1 comment lines
177: function _setChainIdUpgrade(uint256 _chainId, address _chainContract) internal {
```
[177](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L177)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

/// @audit function with 42 lines has only 12 comment lines
32: function _commitOneBatch(
        StoredBatchInfo memory _previousBatch,
        CommitBatchInfo calldata _newBatch,
        bytes32 _expectedSystemContractUpgradeTxHash
    ) internal view returns (StoredBatchInfo memory) {
/// @audit function with 47 lines has only 10 comment lines
130: function _processL2Logs(
        CommitBatchInfo calldata _newBatch,
        bytes32 _expectedSystemContractUpgradeTxHash
    ) internal pure returns (LogProcessingOutput memory logOutput) {
/// @audit function with 30 lines has only 7 comment lines
625: function _verifyBlobInformation(
        bytes calldata _pubdataCommitments,
        bytes32[] memory _blobHashes
    ) internal view returns (bytes32[] memory blobCommitments) {
```
[32](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L32) | [130](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L130) | [625](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L625)

```solidity
File: code/system-contracts/contracts/BootloaderUtilities.sol

/// @audit function with 65 lines has only 16 comment lines
44: function encodeLegacyTransactionHash(Transaction calldata _transaction) internal view returns (bytes32 txHash) {
/// @audit function with 68 lines has only 9 comment lines
139: function encodeEIP2930TransactionHash(Transaction calldata _transaction) internal view returns (bytes32) {
/// @audit function with 70 lines has only 12 comment lines
229: function encodeEIP1559TransactionHash(Transaction calldata _transaction) internal view returns (bytes32) {
```
[44](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L44) | [139](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L139) | [229](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L229)

```solidity
File: code/system-contracts/contracts/Compressor.sol

/// @audit function with 56 lines has only 6 comment lines
110: function verifyCompressedStateDiffs(
        uint256 _numberOfStateDiffs,
        uint256 _enumerationIndexSize,
        bytes calldata _stateDiffs,
        bytes calldata _compressedStateDiffs
    ) external payable onlyCallFrom(address(L1_MESSENGER_CONTRACT)) returns (bytes32 stateDiffHash) {
```
[110](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L110)

```solidity
File: code/system-contracts/contracts/L1Messenger.sol

/// @audit function with 108 lines has only 11 comment lines
194: function publishPubdataAndClearState(
        bytes calldata _totalL2ToL1PubdataAndStateDiffs
    ) external onlyCallFromBootloader {
```
[194](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L194)

```solidity
File: code/system-contracts/contracts/SystemContext.sol

/// @audit function with 38 lines has only 5 comment lines
341: function setL2Block(
        uint128 _l2BlockNumber,
        uint128 _l2BlockTimestamp,
        bytes32 _expectedPrevL2BlockHash,
        bool _isFirstInBatch,
        uint128 _maxVirtualBlocksToCreate
    ) external onlyCallFromBootloader {
```
[341](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L341)

```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

/// @audit function with 46 lines has only 15 comment lines
147: function _encodeHashLegacyTransaction(Transaction calldata _transaction) private view returns (bytes32) {
/// @audit function with 46 lines has only 13 comment lines
219: function _encodeHashEIP2930Transaction(Transaction calldata _transaction) private view returns (bytes32) {
/// @audit function with 48 lines has only 13 comment lines
289: function _encodeHashEIP1559Transaction(Transaction calldata _transaction) private view returns (bytes32) {
```
[147](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L147) | [219](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L219) | [289](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L289)
</details>

### [N-68] Common functions should be refactored to a common base contract

The codebase contains several functions with the same implementations across multiple files.
To enhance maintainability and reduce potential errors, consider refactoring these common functions into a shared base contract.
This practice promotes code reuse and easier future upgrades.

<details>
<summary><i>46 issue instances in 16 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

51: function setPendingAdmin(address _newPendingAdmin) external onlyOwnerOrAdmin {
        // Save previous value into the stack to put it into the event later
        address oldPendingAdmin = pendingAdmin;
        // Change pending admin
        pendingAdmin = _newPendingAdmin;
        emit NewPendingAdmin(oldPendingAdmin, _newPendingAdmin);
    }
60: function acceptAdmin() external {
        address currentPendingAdmin = pendingAdmin;
        require(msg.sender == currentPendingAdmin, "n42"); // Only proposed by current admin address can claim the admin rights

        address previousAdmin = admin;
        admin = currentPendingAdmin;
        delete pendingAdmin;

        emit NewPendingAdmin(currentPendingAdmin, address(0));
        emit NewAdmin(previousAdmin, pendingAdmin);
    }
```
[51](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L51) | [60](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L60)

```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

110: function setPendingAdmin(address _newPendingAdmin) external onlyOwnerOrAdmin {
        // Save previous value into the stack to put it into the event later
        address oldPendingAdmin = pendingAdmin;
        // Change pending admin
        pendingAdmin = _newPendingAdmin;
        emit NewPendingAdmin(oldPendingAdmin, _newPendingAdmin);
    }
119: function acceptAdmin() external {
        address currentPendingAdmin = pendingAdmin;
        require(msg.sender == currentPendingAdmin, "n42"); // Only proposed by current admin address can claim the admin rights

        address previousAdmin = admin;
        admin = currentPendingAdmin;
        delete pendingAdmin;

        emit NewPendingAdmin(currentPendingAdmin, address(0));
        emit NewAdmin(previousAdmin, pendingAdmin);
    }
160: function freezeChain(uint256 _chainId) external onlyOwner {
        IZkSyncStateTransition(stateTransition[_chainId]).freezeDiamond();
    }
165: function unfreezeChain(uint256 _chainId) external onlyOwner {
        IZkSyncStateTransition(stateTransition[_chainId]).freezeDiamond();
    }
```
[110](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L110) | [119](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L119) | [160](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L160) | [165](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L165)

```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

146: function revertBatches(uint256) external onlyValidator(ERA_CHAIN_ID) {
        _propagateToZkSyncStateTransition(ERA_CHAIN_ID);
    }
160: function proveBatches(
        StoredBatchInfo calldata,
        StoredBatchInfo[] calldata,
        ProofInput calldata
    ) external onlyValidator(ERA_CHAIN_ID) {
        _propagateToZkSyncStateTransition(ERA_CHAIN_ID);
    }
153: function revertBatchesSharedBridge(uint256 _chainId, uint256) external onlyValidator(_chainId) {
        _propagateToZkSyncStateTransition(_chainId);
    }
171: function proveBatchesSharedBridge(
        uint256 _chainId,
        StoredBatchInfo calldata,
        StoredBatchInfo[] calldata,
        ProofInput calldata
    ) external onlyValidator(_chainId) {
        _propagateToZkSyncStateTransition(_chainId);
    }
```
[146](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L146) | [160](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L160) | [153](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L153) | [171](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L171)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

199: function commitBatches(
        StoredBatchInfo memory _lastCommittedBatchData,
        CommitBatchInfo[] calldata _newBatchesData
    ) external nonReentrant onlyValidator {
        _commitBatches(_lastCommittedBatchData, _newBatchesData);
    }
207: function commitBatchesSharedBridge(
        uint256, // _chainId
        StoredBatchInfo memory _lastCommittedBatchData,
        CommitBatchInfo[] calldata _newBatchesData
    ) external nonReentrant onlyValidator {
        _commitBatches(_lastCommittedBatchData, _newBatchesData);
    }
337: function executeBatchesSharedBridge(
        uint256,
        StoredBatchInfo[] calldata _batchesData
    ) external nonReentrant onlyValidator {
        _executeBatches(_batchesData);
    }
345: function executeBatches(StoredBatchInfo[] calldata _batchesData) external nonReentrant onlyValidator {
        _executeBatches(_batchesData);
    }
368: function proveBatches(
        StoredBatchInfo calldata _prevBatch,
        StoredBatchInfo[] calldata _committedBatches,
        ProofInput calldata _proof
    ) external nonReentrant onlyValidator {
        _proveBatches(_prevBatch, _committedBatches, _proof);
    }
377: function proveBatchesSharedBridge(
        uint256, // _chainId
        StoredBatchInfo calldata _prevBatch,
        StoredBatchInfo[] calldata _committedBatches,
        ProofInput calldata _proof
    ) external nonReentrant onlyValidator {
        _proveBatches(_prevBatch, _committedBatches, _proof);
    }
```
[199](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L199) | [207](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L207) | [337](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L337) | [345](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L345) | [368](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L368) | [377](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L377)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol

77: function getTotalBatchesCommitted() external view returns (uint256) {
        return s.totalBatchesCommitted;
    }
239: function getTotalBlocksCommitted() external view returns (uint256) {
        return s.totalBatchesCommitted;
    }
82: function getTotalBatchesVerified() external view returns (uint256) {
        return s.totalBatchesVerified;
    }
244: function getTotalBlocksVerified() external view returns (uint256) {
        return s.totalBatchesVerified;
    }
87: function getTotalBatchesExecuted() external view returns (uint256) {
        return s.totalBatchesExecuted;
    }
249: function getTotalBlocksExecuted() external view returns (uint256) {
        return s.totalBatchesExecuted;
    }
122: function storedBatchHash(uint256 _batchNumber) external view returns (bytes32) {
        return s.storedBatchHashes[_batchNumber];
    }
254: function storedBlockHash(uint256 _batchNumber) external view returns (bytes32) {
        return s.storedBatchHashes[_batchNumber];
    }
152: function getL2SystemContractsUpgradeBatchNumber() external view returns (uint256) {
        return s.l2SystemContractsUpgradeBatchNumber;
    }
259: function getL2SystemContractsUpgradeBlockNumber() external view returns (uint256) {
        return s.l2SystemContractsUpgradeBatchNumber;
    }
```
[77](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L77) | [239](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L239) | [82](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L82) | [244](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L244) | [87](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L87) | [249](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L249) | [122](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L122) | [254](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L254) | [152](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L152) | [259](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L259)

```solidity
File: code/contracts/ethereum/contracts/upgrades/DefaultUpgrade.sol

13: function upgrade(ProposedUpgrade calldata _proposedUpgrade) public override returns (bytes32) {
        super.upgrade(_proposedUpgrade);
        return Diamond.DIAMOND_INIT_SUCCESS_RETURN_VALUE;
    }
```
[13](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/DefaultUpgrade.sol#L13)

```solidity
File: code/contracts/ethereum/contracts/upgrades/GenesisUpgrade.sol

14: function upgrade(ProposedUpgrade calldata _proposedUpgrade) public override returns (bytes32) {
        super.upgrade(_proposedUpgrade);
        return Diamond.DIAMOND_INIT_SUCCESS_RETURN_VALUE;
    }
```
[14](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/GenesisUpgrade.sol#L14)

```solidity
File: code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol

60: function computeCreate2Address(
        address _sender,
        bytes32 _salt,
        bytes32 _bytecodeHash,
        bytes32 _constructorInputHash
    ) internal pure returns (address) {
        bytes32 senderBytes = bytes32(uint256(uint160(_sender)));
        bytes32 data = keccak256(
            bytes.concat(CREATE2_PREFIX, senderBytes, _salt, _bytecodeHash, _constructorInputHash)
        );

        return address(uint160(uint256(data)));
    }
```
[60](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L60)

```solidity
File: code/contracts/zksync/contracts/L2ContractHelper.sol

101: function computeCreate2Address(
        address _sender,
        bytes32 _salt,
        bytes32 _bytecodeHash,
        bytes32 _constructorInputHash
    ) internal pure returns (address) {
        bytes32 senderBytes = bytes32(uint256(uint160(_sender)));
        bytes32 data = keccak256(
            bytes.concat(CREATE2_PREFIX, senderBytes, _salt, _bytecodeHash, _constructorInputHash)
        );

        return address(uint160(uint256(data)));
    }
```
[101](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/L2ContractHelper.sol#L101)

```solidity
File: code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol

32: function readUint256(bytes memory _bytes, uint256 _start) internal pure returns (uint256 result, uint256 offset) {
        assembly {
            offset := add(_start, 32)
            result := mload(add(_bytes, offset))
        }
    }
39: function readBytes32(bytes memory _bytes, uint256 _start) internal pure returns (bytes32 result, uint256 offset) {
        assembly {
            offset := add(_start, 32)
            result := mload(add(_bytes, offset))
        }
    }
```
[32](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol#L32) | [39](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol#L39)

```solidity
File: code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol

28: function applyL1ToL2Alias(address l1Address) internal pure returns (address l2Address) {
        unchecked {
            l2Address = address(uint160(l1Address) + offset);
        }
    }
38: function undoL1ToL2Alias(address l2Address) internal pure returns (address l1Address) {
        unchecked {
            l1Address = address(uint160(l2Address) - offset);
        }
    }
```
[28](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol#L28) | [38](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol#L38)

```solidity
File: code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol

28: function applyL1ToL2Alias(address l1Address) internal pure returns (address l2Address) {
        unchecked {
            l2Address = address(uint160(l1Address) + offset);
        }
    }
38: function undoL1ToL2Alias(address l2Address) internal pure returns (address l1Address) {
        unchecked {
            l1Address = address(uint160(l2Address) - offset);
        }
    }
```
[28](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol#L28) | [38](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol#L38)

```solidity
File: code/system-contracts/contracts/libraries/SystemContractsCaller.sol

123: function systemCallWithReturndata(
        uint32 gasLimit,
        address to,
        uint128 value,
        bytes memory data
    ) internal returns (bool success, bytes memory returnData) {
        success = systemCall(gasLimit, to, value, data);

        uint256 size;
        assembly {
            size := returndatasize()
        }

        returnData = new bytes(size);
        assembly {
            returndatacopy(add(returnData, 0x20), 0, size)
        }
    }
214: function getFarCallABI(
        uint32 dataOffset,
        uint32 memoryPage,
        uint32 dataStart,
        uint32 dataLength,
        uint32 gasPassed,
        uint8 shardId,
        CalldataForwardingMode forwardingMode,
        bool isConstructorCall,
        bool isSystemCall
    ) internal pure returns (uint256 farCallAbi) {
        // Fill in the call parameter fields
        farCallAbi = getFarCallABIWithEmptyFatPointer(
            gasPassed,
            shardId,
            forwardingMode,
            isConstructorCall,
            isSystemCall
        );
        // Fill in the fat pointer fields
        farCallAbi |= dataOffset;
        farCallAbi |= (uint256(memoryPage) << 32);
        farCallAbi |= (uint256(dataStart) << 64);
        farCallAbi |= (uint256(dataLength) << 96);
    }
250: function getFarCallABIWithEmptyFatPointer(
        uint32 gasPassed,
        uint8 shardId,
        CalldataForwardingMode forwardingMode,
        bool isConstructorCall,
        bool isSystemCall
    ) internal pure returns (uint256 farCallAbiWithEmptyFatPtr) {
        farCallAbiWithEmptyFatPtr |= (uint256(gasPassed) << 192);
        farCallAbiWithEmptyFatPtr |= (uint256(forwardingMode) << 224);
        farCallAbiWithEmptyFatPtr |= (uint256(shardId) << 232);
        if (isConstructorCall) {
            farCallAbiWithEmptyFatPtr |= (1 << 240);
        }
        if (isSystemCall) {
            farCallAbiWithEmptyFatPtr |= (1 << 248);
        }
    }
```
[123](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L123) | [214](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L214) | [250](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L250)

```solidity
File: code/contracts/zksync/contracts/SystemContractsCaller.sol

75: function systemCallWithReturndata(
        uint32 gasLimit,
        address to,
        uint128 value,
        bytes memory data
    ) internal returns (bool success, bytes memory returnData) {
        success = systemCall(gasLimit, to, value, data);

        uint256 size;
        assembly {
            size := returndatasize()
        }

        returnData = new bytes(size);
        assembly {
            returndatacopy(add(returnData, 0x20), 0, size)
        }
    }
94: function getFarCallABI(
        uint32 dataOffset,
        uint32 memoryPage,
        uint32 dataStart,
        uint32 dataLength,
        uint32 gasPassed,
        uint8 shardId,
        CalldataForwardingMode forwardingMode,
        bool isConstructorCall,
        bool isSystemCall
    ) internal pure returns (uint256 farCallAbi) {
        // Fill in the call parameter fields
        farCallAbi = getFarCallABIWithEmptyFatPointer(
            gasPassed,
            shardId,
            forwardingMode,
            isConstructorCall,
            isSystemCall
        );
        // Fill in the fat pointer fields
        farCallAbi |= dataOffset;
        farCallAbi |= (uint256(memoryPage) << 32);
        farCallAbi |= (uint256(dataStart) << 64);
        farCallAbi |= (uint256(dataLength) << 96);
    }
120: function getFarCallABIWithEmptyFatPointer(
        uint32 gasPassed,
        uint8 shardId,
        CalldataForwardingMode forwardingMode,
        bool isConstructorCall,
        bool isSystemCall
    ) internal pure returns (uint256 farCallAbiWithEmptyFatPtr) {
        farCallAbiWithEmptyFatPtr |= (uint256(gasPassed) << 192);
        farCallAbiWithEmptyFatPtr |= (uint256(forwardingMode) << 224);
        farCallAbiWithEmptyFatPtr |= (uint256(shardId) << 232);
        if (isConstructorCall) {
            farCallAbiWithEmptyFatPtr |= (1 << 240);
        }
        if (isSystemCall) {
            farCallAbiWithEmptyFatPtr |= (1 << 248);
        }
    }
27: function safeCastToU32(uint256 _x) internal pure returns (uint32) {
        require(_x <= type(uint32).max, "Overflow");

        return uint32(_x);
    }
```
[75](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/SystemContractsCaller.sol#L75) | [94](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/SystemContractsCaller.sol#L94) | [120](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/SystemContractsCaller.sol#L120) | [27](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/SystemContractsCaller.sol#L27)

```solidity
File: code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol

39: function readBytes32(bytes calldata _bytes, uint256 _start) internal pure returns (bytes32 result) {
        assembly {
            result := calldataload(add(_bytes.offset, _start))
        }
    }
45: function readUint256(bytes calldata _bytes, uint256 _start) internal pure returns (uint256 result) {
        assembly {
            result := calldataload(add(_bytes.offset, _start))
        }
    }
```
[39](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol#L39) | [45](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol#L45)

```solidity
File: code/system-contracts/contracts/libraries/Utils.sol

25: function safeCastToU32(uint256 _x) internal pure returns (uint32) {
        require(_x <= type(uint32).max, "Overflow");

        return uint32(_x);
    }
```
[25](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L25)
</details>

### [N-69] NatSpec: Non-public state variable declarations should use `@dev` tags

Non-public state variables in smart contracts often have specialized purposes that may not be immediately clear to developers who did not write the original code.
Adding comments to explain the role and functionality of these variables can greatly aid in code readability and maintainability.
This is especially beneficial for future code reviews and audits.

<details>
<summary><i>46 issue instances in 20 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol

12: ZkSyncStateTransitionStorage internal s;
```
[12](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L12)

```solidity
File: code/contracts/ethereum/contracts/common/Config.sol

22: bytes32 constant DEFAULT_L2_LOGS_TREE_ROOT_HASH = bytes32(0);
101: address constant ETH_TOKEN_ADDRESS = address(1);
112: bytes32 constant TWO_BRIDGES_MAGIC_VALUE = bytes32(uint256(keccak256("TWO_BRIDGES_MAGIC_VALUE")) - 1);
```
[22](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L22) | [101](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L101) | [112](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L112)

```solidity
File: code/contracts/ethereum/contracts/common/ReentrancyGuard.sol

29: uint256 private constant LOCK_FLAG_ADDRESS = 0x8e94fed44239eb2314ab7a406345e6c5a8f0ccedf3b600de3d004e672c33abf4;
38: uint256 private constant _NOT_ENTERED = 1;
39: uint256 private constant _ENTERED = 2;
```
[29](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/ReentrancyGuard.sol#L29) | [38](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/ReentrancyGuard.sol#L38) | [39](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/ReentrancyGuard.sol#L39)

```solidity
File: code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol

22: uint160 constant offset = uint160(0x1111000000000000000000000000000000001111);
```
[22](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol#L22)

```solidity
File: code/system-contracts/contracts/AccountCodeStorage.sol

23: bytes32 constant EMPTY_STRING_KECCAK = 0xc5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470;
```
[23](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/AccountCodeStorage.sol#L23)

```solidity
File: code/system-contracts/contracts/Constants.sol

31: address constant ECRECOVER_SYSTEM_CONTRACT = address(0x01);
48: address payable constant BOOTLOADER_FORMAL_ADDRESS = payable(address(SYSTEM_CONTRACTS_OFFSET + 0x01));
61: address constant FORCE_DEPLOYER = address(SYSTEM_CONTRACTS_OFFSET + 0x07);
65: IBaseToken constant BASE_TOKEN_SYSTEM_CONTRACT = IBaseToken(address(SYSTEM_CONTRACTS_OFFSET + 0x0a));
71: address constant KECCAK256_SYSTEM_CONTRACT = address(0x8010);
73: ISystemContext constant SYSTEM_CONTEXT_CONTRACT = ISystemContext(payable(address(SYSTEM_CONTRACTS_OFFSET + 0x0b)));
76: IBootloaderUtilities constant BOOTLOADER_UTILITIES = IBootloaderUtilities(address(SYSTEM_CONTRACTS_OFFSET + 0x0c));
79: address constant EVENT_WRITER_CONTRACT = address(SYSTEM_CONTRACTS_OFFSET + 0x0d);
81: ICompressor constant COMPRESSOR_CONTRACT = ICompressor(address(SYSTEM_CONTRACTS_OFFSET + 0x0e));
83: IComplexUpgrader constant COMPLEX_UPGRADER_CONTRACT = IComplexUpgrader(address(SYSTEM_CONTRACTS_OFFSET + 0x0f));
85: IPubdataChunkPublisher constant PUBDATA_CHUNK_PUBLISHER = IPubdataChunkPublisher(
    address(SYSTEM_CONTRACTS_OFFSET + 0x11)
);
```
[31](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L31) | [48](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L48) | [61](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L61) | [65](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L65) | [71](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L71) | [73](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L73) | [76](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L76) | [79](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L79) | [81](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L81) | [83](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L83) | [85](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L85)

```solidity
File: code/system-contracts/contracts/L1Messenger.sol

44: uint256 internal constant KECCAK_ROUND_GAS_COST = 40;
47: uint256 internal constant KECCAK_ROUND_NUMBER_OF_BYTES = 136;
55: uint256 internal constant SHA256_ROUND_GAS_COST = 7;
58: uint256 internal constant SHA256_ROUND_NUMBER_OF_BYTES = 64;
```
[44](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L44) | [47](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L47) | [55](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L55) | [58](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L58)

```solidity
File: code/system-contracts/contracts/NonceHolder.sol

28: uint256 private constant DEPLOY_NONCE_MULTIPLIER = 2 ** 128;
31: uint256 private constant MAXIMAL_MIN_NONCE_INCREMENT = 2 ** 32;
36: mapping(uint256 account => uint256 packedMinAndDeploymentNonce) internal rawNonces;
41: mapping(uint256 account => mapping(uint256 nonceKey => uint256 value)) internal nonceValues;
```
[28](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L28) | [31](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L31) | [36](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L36) | [41](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L41)

```solidity
File: code/system-contracts/contracts/libraries/SystemContractHelper.sol

9: uint256 constant UINT32_MASK = type(uint32).max;
```
[9](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L9)

```solidity
File: code/system-contracts/contracts/libraries/SystemContractsCaller.sol

12: address constant TO_L1_CALL_ADDRESS = address((1 << 16) - 1);
41: uint256 constant META_GAS_PER_PUBDATA_BYTE_OFFSET = 0 * 8;
```
[12](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L12) | [41](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L41)

```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

84: bytes32 constant EIP712_TRANSACTION_TYPE_HASH =
        keccak256(
            "Transaction(uint256 txType,uint256 from,uint256 to,uint256 gasLimit,uint256 gasPerPubdataByteLimit,uint256 maxFeePerGas,uint256 maxPriorityFeePerGas,uint256 paymaster,uint256 nonce,uint256 value,bytes data,bytes32[] factoryDeps,bytes paymasterInput)"
        );
```
[84](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L84)

```solidity
File: code/system-contracts/contracts/interfaces/IAccount.sol

7: bytes4 constant ACCOUNT_VALIDATION_SUCCESS_MAGIC = IAccount.validateTransaction.selector;
```
[7](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IAccount.sol#L7)

```solidity
File: code/system-contracts/contracts/interfaces/ICompressor.sol

6: uint8 constant OPERATION_BITMASK = 7;
8: uint8 constant LENGTH_BITS_OFFSET = 3;
10: uint8 constant MAX_ENUMERATION_INDEX_SIZE = 8;
```
[6](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/ICompressor.sol#L6) | [8](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/ICompressor.sol#L8) | [10](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/ICompressor.sol#L10)

```solidity
File: code/system-contracts/contracts/interfaces/IPaymaster.sol

12: bytes4 constant PAYMASTER_VALIDATION_SUCCESS_MAGIC = IPaymaster.validateAndPayForPaymasterTransaction.selector;
```
[12](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IPaymaster.sol#L12)

```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

37: address private l1LegacyBridge;
```
[37](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L37)

```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

26: ERC20Getters private availableGetters;
```
[26](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L26)

```solidity
File: code/contracts/zksync/contracts/interfaces/IPaymaster.sol

12: bytes4 constant PAYMASTER_VALIDATION_SUCCESS_MAGIC = IPaymaster.validateAndPayForPaymasterTransaction.selector;
```
[12](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/interfaces/IPaymaster.sol#L12)

```solidity
File: code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol

22: uint160 constant offset = uint160(0x1111000000000000000000000000000000001111);
```
[22](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol#L22)

```solidity
File: code/contracts/zksync/contracts/L2ContractHelper.sol

68: uint160 constant SYSTEM_CONTRACTS_OFFSET = 0x8000; // 2^15
70: address constant BOOTLOADER_ADDRESS = address(SYSTEM_CONTRACTS_OFFSET + 0x01);
74: IL2Messenger constant L2_MESSENGER = IL2Messenger(address(SYSTEM_CONTRACTS_OFFSET + 0x08));
76: IBaseToken constant L2_BASE_TOKEN_ADDRESS = IBaseToken(address(SYSTEM_CONTRACTS_OFFSET + 0x0a));
```
[68](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/L2ContractHelper.sol#L68) | [70](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/L2ContractHelper.sol#L70) | [74](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/L2ContractHelper.sol#L74) | [76](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/L2ContractHelper.sol#L76)

```solidity
File: code/contracts/zksync/contracts/SystemContractsCaller.sol

7: address constant SYSTEM_CALL_CALL_ADDRESS = address((1 << 16) - 11);
```
[7](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/SystemContractsCaller.sol#L7)
</details>

### [N-70] `constant`s should be defined rather than using magic numbers

Magic numbers are hardcoded numerical values used directly in the code, making it harder to read and maintain.
Consider using constants instead of magic numbers.

<details>
<summary><i>122 issue instances in 26 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

/// @audit 0x00
237: require(depositHappened[_chainId][_txHash] == 0x00, "ShB tx hap");
/// @audit 18
258: bytes memory decimals = abi.encode(uint8(18));
/// @audit 56
501: require(_l2ToL1message.length >= 56, "ShB wrong msg len"); // wrong messsage length
/// @audit 76
517: require(_l2ToL1message.length == 76, "ShB wrong msg len 2");
```
[237](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L237) | [258](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L258) | [501](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L501) | [517](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L517)

```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

/// @audit 32
106: assert(L2_TO_L1_LOG_SERIALIZE_SIZE != 2 * 32);
```
[106](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L106)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol

/// @audit 32
51: assert(L2_TO_L1_LOG_SERIALIZE_SIZE != 2 * 32);
```
[51](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol#L51)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

/// @audit 0x00
50: require(logOutput.pubdataHash == 0x00, "v0h");
/// @audit 32
63: keccak256(_newBatch.pubdataCommitments[1:_newBatch.pubdataCommitments.length - 32]),
/// @audit 32
68: _newBatch.pubdataCommitments[_newBatch.pubdataCommitments.length - 32:_newBatch
/// @audit 128
109: uint256 batchTimestamp = _packedBatchAndL2BlockTimestamp >> 128;
/// @audit 511
192: require(processedLogs == 511, "b7");
/// @audit 1023
194: require(processedLogs == 1023, "b8");
```
[50](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L50) | [63](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L63) | [68](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L68) | [109](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L109) | [192](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L192) | [194](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L194)

```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol

/// @audit 32
224: require(_factoryDeps.length <= MAX_NEW_FACTORY_DEPS, "Factory deps can be at most 32");
```
[224](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L224)

```solidity
File: code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol

/// @audit 32
23: require(_bytecode.length % 32 == 0, "pq");
/// @audit 32
25: uint256 bytecodeLenInWords = _bytecode.length / 32;
/// @audit 2 ** 16
26: require(bytecodeLenInWords < 2 ** 16, "pp"); // bytecode length must be less than 2^16 words
/// @audit 0x00000000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF
28: hashedBytecode = sha256(_bytecode) & 0x00000000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF;
/// @audit 248
30: hashedBytecode = (hashedBytecode | bytes32(uint256(1 << 248)));
/// @audit 224
32: hashedBytecode = hashedBytecode | bytes32(bytecodeLenInWords << 224);
/// @audit 256
50: codeLengthInWords = uint256(uint8(_bytecodeHash[2])) * 256 + uint256(uint8(_bytecodeHash[3]));
```
[23](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L23) | [25](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L25) | [26](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L26) | [28](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L28) | [30](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L30) | [32](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L32) | [50](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L50)

```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol

/// @audit 0x33774e659306e47509050e97cb651e731180a42d458212294d30751925c551a2
18: 0x33774e659306e47509050e97cb651e731180a42d458212294d30751925c551a2; // keccak256("diamond.zksync.init") - 1
/// @audit 0xc8fcad8db84d3cc18b4c41d551ea0ee66dd599cde068d998e57d5e09332c131b
22: 0xc8fcad8db84d3cc18b4c41d551ea0ee66dd599cde068d998e57d5e09332c131b; // keccak256("diamond.standard.diamond.storage") - 1;
```
[18](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L18) | [22](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L22)

```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/LibMap.sol

/// @audit 32
27: uint256 bitOffset = (_index & 7) * 32;
/// @audit 32
48: uint256 bitOffset = (_index & 7) * 32;
```
[27](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/LibMap.sol#L27) | [48](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/LibMap.sol#L48)

```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol

/// @audit 256
25: require(pathLength < 256, "bt");
```
[25](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol#L25)

```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol

/// @audit 544
83: costForComputation += Math.ceilDiv(_encodingLength * L1_TX_DELTA_544_ENCODING_BYTES, 544);
```
[83](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L83)

```solidity
File: code/system-contracts/contracts/AccountCodeStorage.sol

/// @audit 0x00
102: if (codeHash == 0x00 && NONCE_HOLDER_SYSTEM_CONTRACT.getRawNonce(account) > 0) {
/// @audit 0x00
133: codeHash != 0x00 &&
```
[102](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/AccountCodeStorage.sol#L102) | [133](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/AccountCodeStorage.sol#L133)

```solidity
File: code/system-contracts/contracts/BootloaderUtilities.sol

/// @audit 0x80
72: } else if (_transaction.data[0] >= 0x80) {
/// @audit 27
92: require(vInt == 27 || vInt == 28, "Invalid v value");
/// @audit 28
92: require(vInt == 27 || vInt == 28, "Invalid v value");
/// @audit 0x80
168: } else if (_transaction.data[0] >= 0x80) {
/// @audit 27
191: require(vInt == 27 || vInt == 28, "Invalid v value");
/// @audit 28
191: require(vInt == 27 || vInt == 28, "Invalid v value");
/// @audit 27
193: vEncoded = RLPEncoder.encodeUint256(vInt - 27);
/// @audit 0x80
263: } else if (_transaction.data[0] >= 0x80) {
/// @audit 27
286: require(vInt == 27 || vInt == 28, "Invalid v value");
/// @audit 28
286: require(vInt == 27 || vInt == 28, "Invalid v value");
/// @audit 27
288: vEncoded = RLPEncoder.encodeUint256(vInt - 27);
```
[72](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L72) | [92](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L92) | [92](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L92) | [168](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L168) | [191](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L191) | [191](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L191) | [193](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L193) | [263](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L263) | [286](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L286) | [286](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L286) | [288](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L288)

```solidity
File: code/system-contracts/contracts/Compressor.sol

/// @audit 84
129: uint64 enumIndex = stateDiff.readUint64(84);
/// @audit 52
137: bytes32 derivedKey = stateDiff.readBytes32(52);
/// @audit 92
138: uint256 initValue = stateDiff.readUint256(92);
/// @audit 124
139: uint256 finalValue = stateDiff.readUint256(124);
/// @audit 32
141: stateDiffPtr += 32;
/// @audit 32
146: uint8 len = operation == 0 ? 32 : metadata >> LENGTH_BITS_OFFSET;
/// @audit 84
161: uint64 enumIndex = stateDiff.readUint64(84);
/// @audit 92
166: uint256 initValue = stateDiff.readUint256(92);
/// @audit 124
167: uint256 finalValue = stateDiff.readUint256(124);
/// @audit 32
177: uint8 len = operation == 0 ? 32 : metadata >> LENGTH_BITS_OFFSET;
/// @audit 256
253: number >>= (256 - (_calldataSlice.length * 8));
```
[129](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L129) | [137](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L137) | [138](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L138) | [139](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L139) | [141](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L141) | [146](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L146) | [161](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L161) | [166](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L166) | [167](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L167) | [177](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L177) | [253](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L253)

```solidity
File: code/system-contracts/contracts/Constants.sol

/// @audit 0x02
50: address(SYSTEM_CONTRACTS_OFFSET + 0x02)
/// @audit 0x05
55: address(SYSTEM_CONTRACTS_OFFSET + 0x05)
/// @audit 0x11
86: address(SYSTEM_CONTRACTS_OFFSET + 0x11)
```
[50](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L50) | [55](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L55) | [86](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L86)

```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

/// @audit 0x00
273: require(NONCE_HOLDER_SYSTEM_CONTRACT.getRawNonce(_newAddress) == 0x00, "Account is occupied");
```
[273](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L273)

```solidity
File: code/system-contracts/contracts/DefaultAccount.sol

/// @audit 65
160: require(_signature.length == 65, "Signature length is incorrect");
```
[160](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L160)

```solidity
File: code/system-contracts/contracts/L1Messenger.sol

/// @audit 64
89: uint256 gasToPay = keccakGasCost(L2_TO_L1_LOG_SERIALIZE_SIZE) + 2 * keccakGasCost(64);
/// @audit 64
150: keccakGasCost(64) +
/// @audit 64
176: keccakGasCost(64) +
```
[89](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L89) | [150](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L150) | [176](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L176)

```solidity
File: code/system-contracts/contracts/L2BaseToken.sol

/// @audit 18
141: return 18;
```
[141](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L2BaseToken.sol#L141)

```solidity
File: code/system-contracts/contracts/SystemContext.sol

/// @audit 256
144: if (blockNumber <= _block || blockNumber - _block > 256) {
/// @audit 128
416: uint256 packedTimestamps = (uint256(currentBatchTimestamp) << 128) | currentL2BlockTimestamp;
/// @audit 128
498: blockInfo = (uint256(blockNumber) << 128) | uint256(blockTimestamp);
```
[144](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L144) | [416](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L416) | [498](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L498)

```solidity
File: code/system-contracts/contracts/libraries/EfficientCall.sol

/// @audit 32
38: require(returnData.length == 32, "keccak256 returned invalid data");
/// @audit 32
47: require(returnData.length == 32, "sha returned invalid data");
```
[38](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L38) | [47](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L47)

```solidity
File: code/system-contracts/contracts/libraries/RLPEncoder.sol

/// @audit 0x15
13: encoded = new bytes(0x15);
/// @audit 128
26: if (_val < 128) {
/// @audit 128
29: encoded[0] = (_val == 0) ? bytes1(uint8(128)) : bytes1(uint8(_val));
/// @audit 0x81
34: encoded[0] = bytes1(uint8(hbs + 0x81));
/// @audit 31
36: uint256 lbs = 31 - hbs;
/// @audit 0x80
51: return _encodeLength(_len, 0x80);
/// @audit 0xc0
57: return _encodeLength(_len, 0xc0);
/// @audit 56
62: if (_len < 56) {
/// @audit 56
69: encoded[0] = bytes1(uint8(_offset + hbs + 56));
/// @audit 31
71: uint256 lbs = 31 - hbs;
/// @audit 128
87: _number >>= 128;
/// @audit 16
88: hbs += 16;
/// @audit 64
91: _number >>= 64;
/// @audit 32
95: _number >>= 32;
/// @audit 16
99: _number >>= 16;
```
[13](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/RLPEncoder.sol#L13) | [26](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/RLPEncoder.sol#L26) | [29](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/RLPEncoder.sol#L29) | [34](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/RLPEncoder.sol#L34) | [36](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/RLPEncoder.sol#L36) | [51](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/RLPEncoder.sol#L51) | [57](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/RLPEncoder.sol#L57) | [62](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/RLPEncoder.sol#L62) | [69](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/RLPEncoder.sol#L69) | [71](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/RLPEncoder.sol#L71) | [87](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/RLPEncoder.sol#L87) | [88](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/RLPEncoder.sol#L88) | [91](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/RLPEncoder.sol#L91) | [95](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/RLPEncoder.sol#L95) | [99](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/RLPEncoder.sol#L99)

```solidity
File: code/system-contracts/contracts/libraries/SystemContractHelper.sol

/// @audit 32
132: rawParams |= uint256(_inputMemoryLength) << 32;
/// @audit 64
133: rawParams |= uint256(_outputMemoryOffset) << 64;
/// @audit 96
134: rawParams |= uint256(_outputMemoryLength) << 96;
/// @audit 192
135: rawParams |= uint256(_perPrecompileInterpreted) << 192;
/// @audit 32
155: uint256 params = uint256(_gasToBurn) + (uint256(_pubdataToSpend) << 32);
/// @audit 256
217: uint256 shifted = (meta << (256 - size - offset));
/// @audit 256
219: result = (shifted >> (256 - size));
/// @audit 32
228: pubdataPublished = uint32(extractNumberFromMeta(meta, META_GAS_PER_PUBDATA_BYTE_OFFSET, 32));
/// @audit 32
238: heapSize = uint32(extractNumberFromMeta(meta, META_HEAP_SIZE_OFFSET, 32));
/// @audit 32
247: auxHeapSize = uint32(extractNumberFromMeta(meta, META_AUX_HEAP_SIZE_OFFSET, 32));
/// @audit 10
319: require(index < 10, "There are only 10 accessible registers");
```
[132](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L132) | [133](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L133) | [134](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L134) | [135](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L135) | [155](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L155) | [217](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L217) | [219](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L219) | [228](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L228) | [238](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L238) | [247](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L247) | [319](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L319)

```solidity
File: code/system-contracts/contracts/libraries/SystemContractsCaller.sol

/// @audit 32
235: farCallAbi |= (uint256(memoryPage) << 32);
/// @audit 64
236: farCallAbi |= (uint256(dataStart) << 64);
/// @audit 96
237: farCallAbi |= (uint256(dataLength) << 96);
/// @audit 192
257: farCallAbiWithEmptyFatPtr |= (uint256(gasPassed) << 192);
/// @audit 224
258: farCallAbiWithEmptyFatPtr |= (uint256(forwardingMode) << 224);
/// @audit 232
259: farCallAbiWithEmptyFatPtr |= (uint256(shardId) << 232);
/// @audit 240
261: farCallAbiWithEmptyFatPtr |= (1 << 240);
/// @audit 248
264: farCallAbiWithEmptyFatPtr |= (1 << 248);
```
[235](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L235) | [236](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L236) | [237](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L237) | [257](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L257) | [258](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L258) | [259](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L259) | [261](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L261) | [264](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L264)

```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

/// @audit 0x80
175: } else if (_transaction.data[0] >= 0x80) {
/// @audit 0x80
253: } else if (_transaction.data[0] >= 0x80) {
/// @audit 0x80
325: } else if (_transaction.data[0] >= 0x80) {
/// @audit 68
368: _transaction.paymasterInput.length >= 68,
/// @audit 68
369: "The approvalBased paymaster input must be at least 68 bytes long"
```
[175](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L175) | [253](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L253) | [325](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L325) | [368](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L368) | [369](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L369)

```solidity
File: code/system-contracts/contracts/libraries/Utils.sol

/// @audit 0x00ff000000000000000000000000000000000000000000000000000000000000
14: 0x00ff000000000000000000000000000000000000000000000000000000000000;
/// @audit 0x0001000000000000000000000000000000000000000000000000000000000000
18: 0x0001000000000000000000000000000000000000000000000000000000000000;
/// @audit 256
46: codeLengthInWords = uint256(uint8(_bytecodeHash[2])) * 256 + uint256(uint8(_bytecodeHash[3]));
/// @audit 0x00
52: return _bytecodeHash[1] == 0x00;
/// @audit 0x01
57: return _bytecodeHash[1] == 0x01;
/// @audit 32
84: require(_bytecode.length % 32 == 0, "po");
/// @audit 32
86: uint256 lengthInWords = _bytecode.length / 32;
/// @audit 2 ** 16
87: require(lengthInWords < 2 ** 16, "pp"); // bytecode length must be less than 2^16 words
/// @audit 0x00000000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF
91: 0x00000000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF;
/// @audit 248
93: hashedBytecode = (hashedBytecode | bytes32(uint256(1 << 248)));
/// @audit 224
95: hashedBytecode = hashedBytecode | bytes32(lengthInWords << 224);
```
[14](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L14) | [18](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L18) | [46](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L46) | [52](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L52) | [57](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L57) | [84](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L84) | [86](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L86) | [87](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L87) | [91](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L91) | [93](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L93) | [95](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L95)

```solidity
File: code/contracts/zksync/contracts/SystemContractsCaller.sol

/// @audit 32
116: farCallAbi |= (uint256(memoryPage) << 32);
/// @audit 64
117: farCallAbi |= (uint256(dataStart) << 64);
/// @audit 96
118: farCallAbi |= (uint256(dataLength) << 96);
/// @audit 192
128: farCallAbiWithEmptyFatPtr |= (uint256(gasPassed) << 192);
/// @audit 224
129: farCallAbiWithEmptyFatPtr |= (uint256(forwardingMode) << 224);
/// @audit 232
130: farCallAbiWithEmptyFatPtr |= (uint256(shardId) << 232);
/// @audit 240
132: farCallAbiWithEmptyFatPtr |= (1 << 240);
/// @audit 248
135: farCallAbiWithEmptyFatPtr |= (1 << 248);
```
[116](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/SystemContractsCaller.sol#L116) | [117](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/SystemContractsCaller.sol#L117) | [118](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/SystemContractsCaller.sol#L118) | [128](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/SystemContractsCaller.sol#L128) | [129](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/SystemContractsCaller.sol#L129) | [130](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/SystemContractsCaller.sol#L130) | [132](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/SystemContractsCaller.sol#L132) | [135](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/SystemContractsCaller.sol#L135)
</details>

### [N-71] `require()`/`revert()` statements should have descriptive reason strings

In Solidity, require() and revert() functions can include an optional 'reason' string that describes what caused the function to fail. This string can be incredibly helpful during testing and debugging, as it provides more context for what went wrong.

Please ensure that the reason strings are comprehensive and descriptive. Strings with fewer than 12 characters may not provide enough context to understand the cause of the function failure.

<details>
<summary><i>146 issue instances in 20 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

/// @audit Reason string `0T` is not informative enough
141: require(_amount != 0, "0T"); // empty deposit
/// @audit Reason string `3T` is not informative enough
143: require(amount == _amount, "3T"); // The token has non-standard transfer logic
/// @audit Reason string `2T` is not informative enough
186: require(amount != 0, "2T"); // empty deposit
/// @audit Reason string `pw` is not informative enough
215: require(!isWithdrawalFinalized[_l2BatchNumber][_l2MessageIndex], "pw");
/// @audit Reason string `0T` is not informative enough
141: require(_amount != 0, "0T"); // empty deposit
/// @audit Reason string `3T` is not informative enough
143: require(amount == _amount, "3T"); // The token has non-standard transfer logic
/// @audit Reason string `2T` is not informative enough
186: require(amount != 0, "2T"); // empty deposit
/// @audit Reason string `pw` is not informative enough
215: require(!isWithdrawalFinalized[_l2BatchNumber][_l2MessageIndex], "pw");
```
[141](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L141) | [143](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L143) | [186](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L186) | [215](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L215) | [141](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L141) | [143](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L143) | [186](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L186) | [215](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L215)

```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

/// @audit Reason string `ShB not BH` is not informative enough
69: require(msg.sender == address(bridgehub), "ShB not BH");
/// @audit Reason string `3T` is not informative enough
161: require(amount == _amount, "3T"); // The token has non-standard transfer logic
/// @audit Reason string `5T` is not informative enough
206: require(withdrawAmount == _depositAmount, "5T"); // The token has non-standard transfer logic
/// @audit Reason string `6T` is not informative enough
208: require(amount != 0, "6T"); // empty deposit amount
/// @audit Reason string `ShB tx hap` is not informative enough
237: require(depositHappened[_chainId][_txHash] == 0x00, "ShB tx hap");
/// @audit Reason string `yn` is not informative enough
325: require(proofValid, "yn");
/// @audit Reason string `y1` is not informative enough
327: require(_amount > 0, "y1");
```
[69](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L69) | [161](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L161) | [206](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L206) | [208](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L208) | [237](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L237) | [325](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L325) | [327](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L327)

```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

/// @audit Reason string `n42` is not informative enough
62: require(msg.sender == currentPendingAdmin, "n42"); // Only proposed by current admin address can claim the admin rights
```
[62](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L62)

```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

/// @audit Reason string `n42` is not informative enough
121: require(msg.sender == currentPendingAdmin, "n42"); // Only proposed by current admin address can claim the admin rights
```
[121](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L121)

```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

/// @audit Reason string `5c` is not informative enough
195: require(block.timestamp >= commitBatchTimestamp + delay, "5c"); // The delay is not passed
/// @audit Reason string `5c` is not informative enough
217: require(block.timestamp >= commitBatchTimestamp + delay, "5c"); // The delay is not passed
```
[195](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L195) | [217](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L217)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol

/// @audit Reason string `vt` is not informative enough
25: require(address(_initializeData.verifier) != address(0), "vt");
/// @audit Reason string `vy` is not informative enough
26: require(_initializeData.admin != address(0), "vy");
/// @audit Reason string `hc` is not informative enough
27: require(_initializeData.validatorTimelock != address(0), "hc");
/// @audit Reason string `vu` is not informative enough
28: require(_initializeData.priorityTxMaxGasLimit <= MAX_GAS_PER_TRANSACTION, "vu");
```
[25](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol#L25) | [26](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol#L26) | [27](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol#L27) | [28](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol#L28)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol

/// @audit Reason string `pr` is not informative enough
14: require(_chainId == block.chainid, "pr");
/// @audit Reason string `Ut` is not informative enough
25: require(msg.data.length >= 4 || msg.data.length == 0, "Ut");
/// @audit Reason string `F` is not informative enough
30: require(facetAddress != address(0), "F"); // Proxy has no facet for this selector
/// @audit Reason string `q1` is not informative enough
31: require(!diamondStorage.isFrozen || !facet.isFreezable, "q1"); // Facet is frozen
```
[14](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol#L14) | [25](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol#L25) | [30](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol#L30) | [31](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol#L31)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol

/// @audit Reason string `n4` is not informative enough
34: require(msg.sender == pendingAdmin, "n4"); // Only proposed by current admin address can claim the admin rights
/// @audit Reason string `n5` is not informative enough
59: require(_newPriorityTxMaxGasLimit <= MAX_GAS_PER_TRANSACTION, "n5");
/// @audit Reason string `n6` is not informative enough
70: require(_newFeeParams.maxPubdataPerBatch >= _newFeeParams.priorityTxMaxPubdata, "n6");
/// @audit Reason string `a9` is not informative enough
136: require(!diamondStorage.isFrozen, "a9"); // diamond proxy is frozen already
/// @audit Reason string `a7` is not informative enough
146: require(diamondStorage.isFrozen, "a7"); // diamond proxy is not frozen
```
[34](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L34) | [59](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L59) | [70](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L70) | [136](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L136) | [146](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L146)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

/// @audit Reason string `f` is not informative enough
37: require(_newBatch.batchNumber == _previousBatch.batchNumber + 1, "f"); // only commit next batch
/// @audit Reason string `us` is not informative enough
40: require(pubdataSource == uint8(PubdataSource.Calldata) || pubdataSource == uint8(PubdataSource.Blob), "us");
/// @audit Reason string `v0h` is not informative enough
50: require(logOutput.pubdataHash == 0x00, "v0h");
/// @audit Reason string `wp` is not informative enough
61: require(
                logOutput.pubdataHash ==
                    keccak256(_newBatch.pubdataCommitments[1:_newBatch.pubdataCommitments.length - 32]),
                "wp"
            );
/// @audit Reason string `l` is not informative enough
74: require(_previousBatch.batchHash == logOutput.previousBatchHash, "l");
/// @audit Reason string `t` is not informative enough
76: require(logOutput.chainedPriorityTxsHash == _newBatch.priorityOperationsHash, "t");
/// @audit Reason string `ta` is not informative enough
78: require(logOutput.numberOfLayer1Txs == _newBatch.numberOfLayer1Txs, "ta");
/// @audit Reason string `tb` is not informative enough
110: require(batchTimestamp == _expectedBatchTimestamp, "tb");
/// @audit Reason string `h3` is not informative enough
114: require(_previousBatchTimestamp < batchTimestamp, "h3");
/// @audit Reason string `h1` is not informative enough
122: require(block.timestamp - COMMIT_TIMESTAMP_NOT_OLDER <= batchTimestamp, "h1"); // New batch timestamp is too small
/// @audit Reason string `h2` is not informative enough
123: require(lastL2BlockTimestamp <= block.timestamp + COMMIT_TIMESTAMP_APPROXIMATION_DELTA, "h2"); // The last L2 block timestamp is too big
/// @audit Reason string `kp` is not informative enough
149: require(!_checkBit(processedLogs, uint8(logKey)), "kp");
/// @audit Reason string `lm` is not informative enough
154: require(logSender == L2_TO_L1_MESSENGER_SYSTEM_CONTRACT_ADDR, "lm");
/// @audit Reason string `ln` is not informative enough
157: require(logSender == L2_TO_L1_MESSENGER_SYSTEM_CONTRACT_ADDR, "ln");
/// @audit Reason string `lb` is not informative enough
160: require(logSender == L2_TO_L1_MESSENGER_SYSTEM_CONTRACT_ADDR, "lb");
/// @audit Reason string `sc` is not informative enough
163: require(logSender == L2_SYSTEM_CONTEXT_SYSTEM_CONTRACT_ADDR, "sc");
/// @audit Reason string `sv` is not informative enough
166: require(logSender == L2_SYSTEM_CONTEXT_SYSTEM_CONTRACT_ADDR, "sv");
/// @audit Reason string `bl` is not informative enough
169: require(logSender == L2_BOOTLOADER_ADDRESS, "bl");
/// @audit Reason string `bk` is not informative enough
172: require(logSender == L2_BOOTLOADER_ADDRESS, "bk");
/// @audit Reason string `pc` is not informative enough
175: require(logSender == L2_PUBDATA_CHUNK_PUBLISHER_ADDR, "pc");
/// @audit Reason string `pd` is not informative enough
178: require(logSender == L2_PUBDATA_CHUNK_PUBLISHER_ADDR, "pd");
/// @audit Reason string `bu` is not informative enough
181: require(logSender == L2_BOOTLOADER_ADDRESS, "bu");
/// @audit Reason string `ut` is not informative enough
182: require(_expectedSystemContractUpgradeTxHash == logValue, "ut");
/// @audit Reason string `ul` is not informative enough
184: revert("ul");
/// @audit Reason string `b7` is not informative enough
192: require(processedLogs == 511, "b7");
/// @audit Reason string `b8` is not informative enough
194: require(processedLogs == 1023, "b8");
/// @audit Reason string `e4` is not informative enough
231: require(_newBatchesData.length == 1, "e4");
/// @audit Reason string `i` is not informative enough
233: require(s.storedBatchHashes[s.totalBatchesCommitted] == _hashStoredBatchInfo(_lastCommittedBatchData), "i"); // incorrect previous batch data
/// @audit Reason string `ik` is not informative enough
284: require(s.l2SystemContractsUpgradeBatchNumber == 0, "ik");
/// @audit Reason string `k` is not informative enough
323: require(currentBatchNumber == s.totalBatchesExecuted + _executedBatchIdx + 1, "k"); // Execute batches in order
/// @audit Reason string `x` is not informative enough
330: require(priorityOperationsHash == _storedBatch.priorityOperationsHash, "x"); // priority operations hash does not match to expected
/// @audit Reason string `n` is not informative enough
358: require(newTotalBatchesExecuted <= s.totalBatchesVerified, "n"); // Can't execute batches more than committed and proven currently.
/// @audit Reason string `t1` is not informative enough
402: require(_hashStoredBatchInfo(_prevBatch) == s.storedBatchHashes[currentTotalBatchesVerified], "t1");
/// @audit Reason string `o1` is not informative enough
407: require(
                _hashStoredBatchInfo(_committedBatches[i]) == s.storedBatchHashes[currentTotalBatchesVerified],
                "o1"
            );
/// @audit Reason string `q` is not informative enough
421: require(currentTotalBatchesVerified <= s.totalBatchesCommitted, "q");
/// @audit Reason string `t4` is not informative enough
442: require(proofPublicInput.length == 1, "t4");
/// @audit Reason string `p` is not informative enough
449: require(successVerifyProof, "p"); // Proof verification fail
/// @audit Reason string `v1` is not informative enough
482: require(s.totalBatchesCommitted > _newLastBatch, "v1"); // The last committed batch is less than new last batch
/// @audit Reason string `v2` is not informative enough
483: require(_newLastBatch >= s.totalBatchesExecuted, "v2"); // Already executed batches cannot be reverted
/// @audit Reason string `pu` is not informative enough
543: require(_batch.systemLogs.length <= MAX_L2_TO_L1_LOGS_COMMITMENT_BYTES, "pu");
/// @audit Reason string `b10` is not informative enough
567: require(_blobCommitments.length == MAX_NUMBER_OF_BLOBS, "b10");
/// @audit Reason string `b11` is not informative enough
568: require(_blobHashes.length == MAX_NUMBER_OF_BLOBS, "b11");
/// @audit Reason string `pl` is not informative enough
631: require(_pubdataCommitments.length > 0, "pl");
/// @audit Reason string `bd` is not informative enough
632: require(_pubdataCommitments.length <= PUBDATA_COMMITMENT_SIZE * MAX_NUMBER_OF_BLOBS, "bd");
/// @audit Reason string `bs` is not informative enough
633: require(_pubdataCommitments.length % PUBDATA_COMMITMENT_SIZE == 0, "bs");
/// @audit Reason string `vh` is not informative enough
639: require(blobVersionedHash != bytes32(0), "vh");
/// @audit Reason string `lh` is not informative enough
663: require(versionedHash == bytes32(0), "lh");
/// @audit Reason string `bh` is not informative enough
668: require(
                (_blobHashes[i] == bytes32(0) && blobCommitments[i] == bytes32(0)) ||
                    (_blobHashes[i] != bytes32(0) && blobCommitments[i] != bytes32(0)),
                "bh"
            );
/// @audit Reason string `vc` is not informative enough
681: require(success, "vc");
```
[37](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L37) | [40](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L40) | [50](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L50) | [61](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L61) | [74](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L74) | [76](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L76) | [78](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L78) | [110](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L110) | [114](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L114) | [122](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L122) | [123](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L123) | [149](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L149) | [154](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L154) | [157](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L157) | [160](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L160) | [163](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L163) | [166](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L166) | [169](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L169) | [172](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L172) | [175](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L175) | [178](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L178) | [181](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L181) | [182](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L182) | [184](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L184) | [192](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L192) | [194](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L194) | [231](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L231) | [233](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L233) | [284](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L284) | [323](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L323) | [330](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L330) | [358](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L358) | [402](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L402) | [407](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L407) | [421](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L421) | [442](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L442) | [449](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L449) | [482](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L482) | [483](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L483) | [543](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L543) | [567](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L567) | [568](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L568) | [631](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L631) | [632](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L632) | [633](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L633) | [639](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L639) | [663](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L663) | [668](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L668) | [681](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L681)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol

/// @audit Reason string `g2` is not informative enough
183: require(ds.selectorToFacet[_selector].facetAddress != address(0), "g2");
```
[183](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L183)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

/// @audit Reason string `xx` is not informative enough
110: require(_batchNumber <= s.totalBatchesExecuted, "xx");
/// @audit Reason string `tw` is not informative enough
117: require(hashedLog != L2_L1_LOGS_TREE_DEFAULT_LEAF_HASH, "tw");
/// @audit Reason string `qp` is not informative enough
243: require(_request.l2GasPerPubdataByteLimit == REQUIRED_L2_GAS_PRICE_PER_PUBDATA, "qp");
/// @audit Reason string `uj` is not informative enough
264: require(_factoryDeps.length <= MAX_NEW_FACTORY_DEPS, "uj");
/// @audit Reason string `mv` is not informative enough
272: require(_mintValue >= baseCost + _params.l2Value, "mv"); // The `msg.value` doesn't cover the transaction cost
```
[110](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L110) | [117](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L117) | [243](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L243) | [264](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L264) | [272](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L272)

```solidity
File: code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol

/// @audit Reason string `pq` is not informative enough
23: require(_bytecode.length % 32 == 0, "pq");
/// @audit Reason string `pp` is not informative enough
26: require(bytecodeLenInWords < 2 ** 16, "pp"); // bytecode length must be less than 2^16 words
/// @audit Reason string `ps` is not informative enough
27: require(bytecodeLenInWords % 2 == 1, "ps"); // bytecode length in words must be odd
/// @audit Reason string `zf` is not informative enough
41: require(version == 1 && _bytecodeHash[1] == bytes1(0), "zf"); // Incorrectly formatted bytecodeHash
/// @audit Reason string `uy` is not informative enough
43: require(bytecodeLen(_bytecodeHash) % 2 == 1, "uy"); // Code length in words must be odd
```
[23](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L23) | [26](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L26) | [27](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L27) | [41](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L41) | [43](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L43)

```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol

/// @audit Reason string `B` is not informative enough
107: require(selectors.length > 0, "B"); // no functions for diamond cut
/// @audit Reason string `C` is not informative enough
116: revert("C"); // undefined diamond cut action
/// @audit Reason string `G` is not informative enough
132: require(_facet.code.length > 0, "G");
/// @audit Reason string `J` is not informative enough
141: require(oldFacet.facetAddress == address(0), "J"); // facet for this selector already exists
/// @audit Reason string `K` is not informative enough
155: require(_facet.code.length > 0, "K");
/// @audit Reason string `L` is not informative enough
161: require(oldFacet.facetAddress != address(0), "L"); // it is impossible to replace the facet with zero address
/// @audit Reason string `a1` is not informative enough
175: require(_facet == address(0), "a1"); // facet address must be zero
/// @audit Reason string `a2` is not informative enough
181: require(oldFacet.facetAddress != address(0), "a2"); // Can't delete a non-existent facet
/// @audit Reason string `J1` is not informative enough
215: require(_isSelectorFreezable == ds.selectorToFacet[selector0].isFreezable, "J1");
/// @audit Reason string `H` is not informative enough
280: require(_calldata.length == 0, "H"); // Non-empty calldata for zero address
/// @audit Reason string `I` is not informative enough
287: revert("I"); // delegatecall failed
```
[107](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L107) | [116](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L116) | [132](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L132) | [141](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L141) | [155](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L155) | [161](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L161) | [175](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L175) | [181](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L181) | [215](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L215) | [280](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L280) | [287](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L287)

```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol

/// @audit Reason string `xc` is not informative enough
24: require(pathLength > 0, "xc");
/// @audit Reason string `bt` is not informative enough
25: require(pathLength < 256, "bt");
/// @audit Reason string `px` is not informative enough
26: require(_index < (1 << pathLength), "px");
```
[24](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol#L24) | [25](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol#L25) | [26](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol#L26)

```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol

/// @audit Reason string `D` is not informative enough
65: require(!_queue.isEmpty(), "D"); // priority queue is empty
/// @audit Reason string `s` is not informative enough
73: require(!_queue.isEmpty(), "s"); // priority queue is empty
```
[65](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L65) | [73](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L73)

```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol

/// @audit Reason string `ui` is not informative enough
28: require(l2GasForTxBody <= _priorityTxMaxGasLimit, "ui");
/// @audit Reason string `uk` is not informative enough
30: require(l2GasForTxBody / _transaction.gasPerPubdataByteLimit <= _priorityTxMaxPubdata, "uk");
/// @audit Reason string `up` is not informative enough
34: require(
            getMinimalPriorityTransactionGasLimit(
                _encoded.length,
                _transaction.factoryDeps.length,
                _transaction.gasPerPubdataByteLimit
            ) <= l2GasForTxBody,
            "up"
        );
/// @audit Reason string `ua` is not informative enough
48: require(_transaction.from <= type(uint16).max, "ua");
/// @audit Reason string `ub` is not informative enough
49: require(_transaction.to <= type(uint160).max, "ub");
/// @audit Reason string `uc` is not informative enough
50: require(_transaction.paymaster == 0, "uc");
/// @audit Reason string `ud` is not informative enough
51: require(_transaction.value == 0, "ud");
/// @audit Reason string `uq` is not informative enough
52: require(_transaction.maxFeePerGas == 0, "uq");
/// @audit Reason string `ux` is not informative enough
53: require(_transaction.maxPriorityFeePerGas == 0, "ux");
/// @audit Reason string `ue` is not informative enough
54: require(_transaction.reserved[0] == 0, "ue");
/// @audit Reason string `uf` is not informative enough
55: require(_transaction.reserved[1] <= type(uint160).max, "uf");
/// @audit Reason string `ug` is not informative enough
56: require(_transaction.reserved[2] == 0, "ug");
/// @audit Reason string `uo` is not informative enough
57: require(_transaction.reserved[3] == 0, "uo");
/// @audit Reason string `uh` is not informative enough
58: require(_transaction.signature.length == 0, "uh");
/// @audit Reason string `ul1` is not informative enough
59: require(_transaction.paymasterInput.length == 0, "ul1");
/// @audit Reason string `um` is not informative enough
60: require(_transaction.reservedDynamic.length == 0, "um");
/// @audit Reason string `my` is not informative enough
115: require(_totalGasLimit >= overhead, "my"); // provided gas limit doesn't cover transaction overhead
```
[28](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L28) | [30](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L30) | [34](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L34) | [48](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L48) | [49](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L49) | [50](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L50) | [51](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L51) | [52](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L52) | [53](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L53) | [54](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L54) | [55](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L55) | [56](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L56) | [57](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L57) | [58](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L58) | [59](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L59) | [60](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L60) | [115](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L115)

```solidity
File: code/system-contracts/contracts/libraries/Utils.sol

/// @audit Reason string `Overflow` is not informative enough
21: require(_x <= type(uint128).max, "Overflow");
/// @audit Reason string `Overflow` is not informative enough
27: require(_x <= type(uint32).max, "Overflow");
/// @audit Reason string `Overflow` is not informative enough
33: require(_x <= type(uint24).max, "Overflow");
/// @audit Reason string `po` is not informative enough
84: require(_bytecode.length % 32 == 0, "po");
/// @audit Reason string `pp` is not informative enough
87: require(lengthInWords < 2 ** 16, "pp"); // bytecode length must be less than 2^16 words
/// @audit Reason string `pr` is not informative enough
88: require(lengthInWords % 2 == 1, "pr"); // bytecode length in words must be odd
```
[21](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L21) | [27](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L27) | [33](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L33) | [84](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L84) | [87](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L87) | [88](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L88)

```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

/// @audit Reason string `bf` is not informative enough
55: require(_l1Bridge != address(0), "bf");
/// @audit Reason string `df` is not informative enough
56: require(_l2TokenProxyBytecodeHash != bytes32(0), "df");
/// @audit Reason string `sf` is not informative enough
57: require(_aliasedOwner != address(0), "sf");
/// @audit Reason string `df` is not informative enough
58: require(_l2TokenProxyBytecodeHash != bytes32(0), "df");
/// @audit Reason string `bf2` is not informative enough
68: require(_l1LegecyBridge != address(0), "bf2");
/// @audit Reason string `mq` is not informative enough
87: require(
            AddressAliasHelper.undoL1ToL2Alias(msg.sender) == l1Bridge ||
                AddressAliasHelper.undoL1ToL2Alias(msg.sender) == l1LegacyBridge,
            "mq"
        );
/// @audit Reason string `mt` is not informative enough
98: require(deployedToken == expectedL2Token, "mt");
/// @audit Reason string `gg` is not informative enough
101: require(currentL1Token == _l1Token, "gg"); // Double check that the expected value equal to real one
/// @audit Reason string `yh` is not informative enough
129: require(l1Token != address(0), "yh");
/// @audit Reason string `mk` is not informative enough
176: require(success, "mk");
```
[55](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L55) | [56](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L56) | [57](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L57) | [58](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L58) | [68](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L68) | [87](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L87) | [98](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L98) | [101](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L101) | [129](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L129) | [176](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L176)

```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

/// @audit Reason string `in6` is not informative enough
51: require(_l1Address != address(0), "in6"); // Should be non-zero address
/// @audit Reason string `tt` is not informative enough
120: require(msg.sender == UpgradeableBeacon(beaconAddress).owner(), "tt");
/// @audit Reason string `xnt` is not informative enough
130: require(msg.sender == l2Bridge, "xnt"); // Only L2 bridge can call this method
/// @audit Reason string `v` is not informative enough
137: require(_version == _getInitializedVersion() + 1, "v");
```
[51](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L51) | [120](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L120) | [130](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L130) | [137](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L137)

```solidity
File: code/contracts/zksync/contracts/SystemContractsCaller.sol

/// @audit Reason string `Overflow` is not informative enough
28: require(_x <= type(uint32).max, "Overflow");
```
[28](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/SystemContractsCaller.sol#L28)
</details>

### [N-72] Variable Names Not in mixedCase

State or Local Variable names in your contract don't align with the Solidity naming convention.
For clarity and code consistency, it's recommended to use mixedCase for local and state variables that are not constants, and add a trailing underscore for internal variables.
Adhering to this convention helps in improving code readability and maintenance.
[More information in Documentation](https://docs.soliditylang.org/en/v0.8.20/style-guide.html#function-names)

<details>
<summary><i>12 issue instances in 2 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

/// @audit - Variable name `__DEPRECATED_lastWithdrawalLimitReset` should be in mixedCase
45: mapping(address => uint256) private __DEPRECATED_lastWithdrawalLimitReset;
/// @audit - Variable name `__DEPRECATED_withdrawnAmountInWindow` should be in mixedCase
48: mapping(address => uint256) private __DEPRECATED_withdrawnAmountInWindow;
/// @audit - Variable name `__DEPRECATED_totalDepositedAmountPerUser` should be in mixedCase
51: mapping(address => mapping(address => uint256)) private __DEPRECATED_totalDepositedAmountPerUser;
/// @audit - Variable name `__DEPRECATED_lastWithdrawalLimitReset` should be in mixedCase
45: mapping(address => uint256) private __DEPRECATED_lastWithdrawalLimitReset;
/// @audit - Variable name `__DEPRECATED_withdrawnAmountInWindow` should be in mixedCase
48: mapping(address => uint256) private __DEPRECATED_withdrawnAmountInWindow;
/// @audit - Variable name `__DEPRECATED_totalDepositedAmountPerUser` should be in mixedCase
51: mapping(address => mapping(address => uint256)) private __DEPRECATED_totalDepositedAmountPerUser;
```
[45](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L45) | [48](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L48) | [51](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L51) | [45](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L45) | [48](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L48) | [51](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L51)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol

/// @audit - Variable name `__DEPRECATED_governor` should be in mixedCase
70: address __DEPRECATED_governor;
/// @audit - Variable name `__DEPRECATED_pendingGovernor` should be in mixedCase
72: address __DEPRECATED_pendingGovernor;
/// @audit - Variable name `__DEPRECATED_allowList` should be in mixedCase
92: address __DEPRECATED_allowList;
/// @audit - Variable name `__DEPRECATED_upgrades` should be in mixedCase
109: UpgradeStorage __DEPRECATED_upgrades;
/// @audit - Variable name `__DEPRECATED_lastWithdrawalLimitReset` should be in mixedCase
116: uint256 __DEPRECATED_lastWithdrawalLimitReset;
/// @audit - Variable name `__DEPRECATED_withdrawnAmountInWindow` should be in mixedCase
118: uint256 __DEPRECATED_withdrawnAmountInWindow;
```
[70](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L70) | [72](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L72) | [92](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L92) | [109](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L109) | [116](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L116) | [118](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L118)
</details>

### [N-73] Consider moving `msg.sender` checks to a common authorization `modifier`

Functions that are only allowed to be called by a specific actor should use a modifier to check if the caller is the specified actor (e.g., owner, specific role, etc.).
Using `require` to check `msg.sender` in the function body is less efficient and less clear.

Consider refactoring these `require` statements into a modifier for better readability, organization, and gas efficiency.

<details>
<summary><i>14 issue instances in 12 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

64: require(msg.sender == address(sharedBridge), "Not shared bridge");
64: require(msg.sender == address(sharedBridge), "Not shared bridge");
```
[64](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L64) | [64](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L64)

```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

138: require(bridgehub.getStateTransition(_chainId) == msg.sender, "receiveEth not state transition");
```
[138](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L138)

```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

62: require(msg.sender == currentPendingAdmin, "n42"); // Only proposed by current admin address can claim the admin rights
```
[62](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L62)

```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

121: require(msg.sender == currentPendingAdmin, "n42"); // Only proposed by current admin address can claim the admin rights
```
[121](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L121)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol

34: require(msg.sender == pendingAdmin, "n4"); // Only proposed by current admin address can claim the admin rights
```
[34](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L34)

```solidity
File: code/system-contracts/contracts/ComplexUpgrader.sol

22: require(msg.sender == FORCE_DEPLOYER, "Can only be called by FORCE_DEPLOYER");
```
[22](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ComplexUpgrader.sol#L22)

```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

239: require(
            msg.sender == FORCE_DEPLOYER || msg.sender == address(COMPLEX_UPGRADER_CONTRACT),
```
[239](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L239)

```solidity
File: code/system-contracts/contracts/ImmutableSimulator.sol

35: require(msg.sender == address(DEPLOYER_SYSTEM_CONTRACT), "Callable only by the deployer system contract");
```
[35](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ImmutableSimulator.sol#L35)

```solidity
File: code/system-contracts/contracts/L2BaseToken.sol

33: require(
            msg.sender == MSG_VALUE_SYSTEM_CONTRACT ||
                msg.sender == address(DEPLOYER_SYSTEM_CONTRACT) ||
```
[33](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L2BaseToken.sol#L33)

```solidity
File: code/system-contracts/contracts/NonceHolder.sol

89: require(isNonceUsed(msg.sender, _key - 1), "Previous nonce has not been used");
136: require(
            msg.sender == address(DEPLOYER_SYSTEM_CONTRACT),
```
[89](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L89) | [136](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L136)

```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

87: require(
            AddressAliasHelper.undoL1ToL2Alias(msg.sender) == l1Bridge ||
```
[87](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L87)

```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

120: require(msg.sender == UpgradeableBeacon(beaconAddress).owner(), "tt");
```
[120](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L120)
</details>

### [N-74] NatSpec: Contract declarations should have descriptions

NatSpec descriptions are crucial for self-documenting smart contracts. They provide vital information 
about the contract's purpose and behavior.

Specifically, the `@dev` or `@notice` tags are quintessential 
for detailed explanations about the contract. 

Ensure these descriptions are present directly above the contract definition braces. 
This positioning allows the compiler to correctly identify and associate the descriptions with the contract.

[Learn More about Proper NatSpec Formatting](https://docs.soliditylang.org/en/develop/natspec-format.html)

<details>
<summary><i>23 issue instances in 23 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

15: contract Bridgehub is IBridgehub, ReentrancyGuard, Ownable2Step {
```
[15](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L15)

```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IWETH9.sol

3: interface IWETH9 {
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IWETH9.sol#L3)

```solidity
File: code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol

41: interface IBridgehub {
```
[41](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L41)

```solidity
File: code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol

25: interface IStateTransitionManager {
```
[25](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L25)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol

60: interface IDiamondInit {
```
[60](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol#L60)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol

14: interface IZkSyncStateTransition is IAdmin, IExecutor, IGetters, IMailbox {
```
[14](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol#L14)

```solidity
File: code/contracts/ethereum/contracts/state-transition/l2-deps/ISystemContext.sol

3: interface ISystemContext {
```
[3](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/l2-deps/ISystemContext.sol#L3)

```solidity
File: code/contracts/ethereum/contracts/upgrades/IDefaultUpgrade.sol

6: interface IDefaultUpgrade {
```
[6](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/IDefaultUpgrade.sol#L6)

```solidity
File: code/contracts/ethereum/contracts/common/ReentrancyGuard.sol

25: abstract contract ReentrancyGuard {
```
[25](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/ReentrancyGuard.sol#L25)

```solidity
File: code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol

20: library AddressAliasHelper {
```
[20](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol#L20)

```solidity
File: code/system-contracts/contracts/interfaces/IAccount.sol

8: interface IAccount {
```
[8](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IAccount.sol#L8)

```solidity
File: code/system-contracts/contracts/interfaces/IAccountCodeStorage.sol

4: interface IAccountCodeStorage {
```
[4](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IAccountCodeStorage.sol#L4)

```solidity
File: code/system-contracts/contracts/interfaces/IBaseToken.sol

4: interface IBaseToken {
```
[4](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IBaseToken.sol#L4)

```solidity
File: code/system-contracts/contracts/interfaces/IBootloaderUtilities.sol

6: interface IBootloaderUtilities {
```
[6](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IBootloaderUtilities.sol#L6)

```solidity
File: code/system-contracts/contracts/interfaces/IContractDeployer.sol

4: interface IContractDeployer {
```
[4](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L4)

```solidity
File: code/system-contracts/contracts/interfaces/IImmutableSimulator.sol

9: interface IImmutableSimulator {
```
[9](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IImmutableSimulator.sol#L9)

```solidity
File: code/system-contracts/contracts/interfaces/IL2StandardToken.sol

4: interface IL2StandardToken {
```
[4](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IL2StandardToken.sol#L4)

```solidity
File: code/system-contracts/contracts/interfaces/IMailbox.sol

4: interface IMailbox {
```
[4](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IMailbox.sol#L4)

```solidity
File: code/system-contracts/contracts/interfaces/IPaymaster.sol

13: interface IPaymaster {
```
[13](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IPaymaster.sol#L13)

```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol

4: interface IL2StandardToken {
```
[4](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol#L4)

```solidity
File: code/contracts/zksync/contracts/interfaces/IPaymaster.sol

13: interface IPaymaster {
```
[13](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/interfaces/IPaymaster.sol#L13)

```solidity
File: code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol

20: library AddressAliasHelper {
```
[20](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol#L20)

```solidity
File: code/contracts/zksync/contracts/SystemContractsCaller.sol

25: library Utils {
```
[25](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/SystemContractsCaller.sol#L25)
</details>

### [N-75] NatSpec: Contract declarations should have `@author` tag

In the world of decentralized code, giving credit is key. NatSpec's `@author` tag acknowledges the minds behind the code.
It appears this Solidity contract omits the `@author` directive in its NatSpec annotations.
Properly attributing code to its contributors not only recognizes effort but also aids in establishing trust and credibility.
[Dive Deeper into NatSpec Guidelines](https://docs.soliditylang.org/en/develop/natspec-format.html)

<details>
<summary><i>25 issue instances in 24 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

16: contract Bridgehub is IBridgehub, ReentrancyGuard, Ownable2Step {
```
[16](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L16)

```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IWETH9.sol

4: interface IWETH9 {
```
[4](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IWETH9.sol#L4)

```solidity
File: code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol

42: interface IBridgehub {
```
[42](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L42)

```solidity
File: code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol

26: interface IStateTransitionManager {
```
[26](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L26)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol

61: interface IDiamondInit {
```
[61](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol#L61)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol

15: interface IZkSyncStateTransition is IAdmin, IExecutor, IGetters, IMailbox {
```
[15](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol#L15)

```solidity
File: code/contracts/ethereum/contracts/state-transition/l2-deps/ISystemContext.sol

4: interface ISystemContext {
```
[4](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/l2-deps/ISystemContext.sol#L4)

```solidity
File: code/contracts/ethereum/contracts/upgrades/IDefaultUpgrade.sol

7: interface IDefaultUpgrade {
```
[7](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/IDefaultUpgrade.sol#L7)

```solidity
File: code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol

21: library AddressAliasHelper {
```
[21](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol#L21)

```solidity
File: code/system-contracts/contracts/Compressor.sol

22: contract Compressor is ICompressor, ISystemContract {
```
[22](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L22)

```solidity
File: code/system-contracts/contracts/interfaces/IAccount.sol

9: interface IAccount {
```
[9](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IAccount.sol#L9)

```solidity
File: code/system-contracts/contracts/interfaces/IAccountCodeStorage.sol

5: interface IAccountCodeStorage {
```
[5](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IAccountCodeStorage.sol#L5)

```solidity
File: code/system-contracts/contracts/interfaces/IBaseToken.sol

5: interface IBaseToken {
```
[5](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IBaseToken.sol#L5)

```solidity
File: code/system-contracts/contracts/interfaces/IBootloaderUtilities.sol

7: interface IBootloaderUtilities {
```
[7](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IBootloaderUtilities.sol#L7)

```solidity
File: code/system-contracts/contracts/interfaces/IContractDeployer.sol

5: interface IContractDeployer {
```
[5](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L5)

```solidity
File: code/system-contracts/contracts/interfaces/IImmutableSimulator.sol

10: interface IImmutableSimulator {
```
[10](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IImmutableSimulator.sol#L10)

```solidity
File: code/system-contracts/contracts/interfaces/IL2StandardToken.sol

5: interface IL2StandardToken {
```
[5](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IL2StandardToken.sol#L5)

```solidity
File: code/system-contracts/contracts/interfaces/IMailbox.sol

5: interface IMailbox {
```
[5](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IMailbox.sol#L5)

```solidity
File: code/system-contracts/contracts/interfaces/IPaymaster.sol

14: interface IPaymaster {
```
[14](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IPaymaster.sol#L14)

```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol

5: interface IL2StandardToken {
```
[5](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol#L5)

```solidity
File: code/contracts/zksync/contracts/interfaces/IPaymaster.sol

14: interface IPaymaster {
```
[14](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/interfaces/IPaymaster.sol#L14)

```solidity
File: code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol

21: library AddressAliasHelper {
```
[21](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol#L21)

```solidity
File: code/contracts/zksync/contracts/ForceDeployUpgrader.sol

10: contract ForceDeployUpgrader {
```
[10](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/ForceDeployUpgrader.sol#L10)

```solidity
File: code/contracts/zksync/contracts/SystemContractsCaller.sol

26: library Utils {
36: library SystemContractsCaller {
```
[26](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/SystemContractsCaller.sol#L26) | [36](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/SystemContractsCaller.sol#L36)
</details>

### [N-76] Style guide: Non-`external`/`public` function names should begin with an underscore

In Solidity, it is suggested to use a leading underscore for non-public (private and internal) function names.
This convention helps to distinguish clearly between public/external and non-public functions, improving code clarity.
By adhering to this convention, developers can mitigate potential misinterpretation or errors, thus making the code more comprehensible and easier to maintain.

<details>
<summary><i>109 issue instances in 21 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol

21: function hashL2Bytecode(bytes memory _bytecode) internal pure returns (bytes32 hashedBytecode) {
39: function validateBytecodeHash(bytes32 _bytecodeHash) internal pure {
49: function bytecodeLen(bytes32 _bytecodeHash) internal pure returns (uint256 codeLengthInWords) {
60: function computeCreate2Address(
        address _sender,
        bytes32 _salt,
        bytes32 _bytecodeHash,
        bytes32 _constructorInputHash
    ) internal pure returns (address) {
```
[21](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L21) | [39](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L39) | [49](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L49) | [60](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L60)

```solidity
File: code/contracts/ethereum/contracts/common/libraries/UncheckedMath.sol

11: function uncheckedInc(uint256 _number) internal pure returns (uint256) {
16: function uncheckedAdd(uint256 _lhs, uint256 _rhs) internal pure returns (uint256) {
```
[11](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/UncheckedMath.sol#L11) | [16](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/UncheckedMath.sol#L16)

```solidity
File: code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol

19: function readUint32(bytes memory _bytes, uint256 _start) internal pure returns (uint32 result, uint256 offset) {
25: function readAddress(bytes memory _bytes, uint256 _start) internal pure returns (address result, uint256 offset) {
32: function readUint256(bytes memory _bytes, uint256 _start) internal pure returns (uint256 result, uint256 offset) {
39: function readBytes32(bytes memory _bytes, uint256 _start) internal pure returns (bytes32 result, uint256 offset) {
```
[19](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol#L19) | [25](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol#L25) | [32](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol#L32) | [39](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol#L39)

```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol

87: function getDiamondStorage() internal pure returns (DiamondStorage storage diamondStorage) {
96: function diamondCut(DiamondCutData memory _diamondCut) internal {
```
[87](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L87) | [96](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L96)

```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/LibMap.sol

18: function get(Uint32Map storage _map, uint256 _index) internal view returns (uint32 result) {
38: function set(Uint32Map storage _map, uint256 _index, uint32 _value) internal {
```
[18](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/LibMap.sol#L18) | [38](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/LibMap.sol#L38)

```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol

18: function calculateRoot(
        bytes32[] calldata _path,
        uint256 _index,
        bytes32 _itemHash
    ) internal pure returns (bytes32) {
```
[18](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol#L18)

```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol

35: function getFirstUnprocessedPriorityTx(Queue storage _queue) internal view returns (uint256) {
40: function getTotalPriorityTxs(Queue storage _queue) internal view returns (uint256) {
45: function getSize(Queue storage _queue) internal view returns (uint256) {
50: function isEmpty(Queue storage _queue) internal view returns (bool) {
55: function pushBack(Queue storage _queue, PriorityOperation memory _operation) internal {
64: function front(Queue storage _queue) internal view returns (PriorityOperation memory) {
72: function popFront(Queue storage _queue) internal returns (PriorityOperation memory priorityOperation) {
```
[35](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L35) | [40](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L40) | [45](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L45) | [50](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L50) | [55](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L55) | [64](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L64) | [72](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L72)

```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol

19: function validateL1ToL2Transaction(
        L2CanonicalTransaction memory _transaction,
        bytes memory _encoded,
        uint256 _priorityTxMaxGasLimit,
        uint256 _priorityTxMaxPubdata
    ) internal pure {
46: function validateUpgradeTransaction(L2CanonicalTransaction memory _transaction) internal pure {
69: function getMinimalPriorityTransactionGasLimit(
        uint256 _encodingLength,
        uint256 _numberOfFactoryDependencies,
        uint256 _l2GasPricePerPubdata
    ) internal pure returns (uint256) {
109: function getTransactionBodyGasLimit(
        uint256 _totalGasLimit,
        uint256 _encodingLength
    ) internal pure returns (uint256 txBodyGasLimit) {
128: function getOverheadForTransaction(
        uint256 _encodingLength
    ) internal pure returns (uint256 batchOverheadForTransaction) {
```
[19](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L19) | [46](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L46) | [69](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L69) | [109](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L109) | [128](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L128)

```solidity
File: code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol

28: function applyL1ToL2Alias(address l1Address) internal pure returns (address l2Address) {
38: function undoL1ToL2Alias(address l2Address) internal pure returns (address l1Address) {
```
[28](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol#L28) | [38](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol#L38)

```solidity
File: code/system-contracts/contracts/BootloaderUtilities.sol

44: function encodeLegacyTransactionHash(Transaction calldata _transaction) internal view returns (bytes32 txHash) {
139: function encodeEIP2930TransactionHash(Transaction calldata _transaction) internal view returns (bytes32) {
229: function encodeEIP1559TransactionHash(Transaction calldata _transaction) internal view returns (bytes32) {
```
[44](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L44) | [139](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L139) | [229](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L229)

```solidity
File: code/system-contracts/contracts/L1Messenger.sol

50: function keccakGasCost(uint256 _length) internal pure returns (uint256) {
61: function sha256GasCost(uint256 _length) internal pure returns (uint256) {
```
[50](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L50) | [61](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L61)

```solidity
File: code/system-contracts/contracts/libraries/EfficientCall.sol

36: function keccak(bytes calldata _data) internal view returns (bytes32) {
45: function sha(bytes calldata _data) internal view returns (bytes32) {
58: function call(
        uint256 _gas,
        address _address,
        uint256 _value,
        bytes calldata _data,
        bool _isSystem
    ) internal returns (bytes memory returnData) {
74: function staticCall(
        uint256 _gas,
        address _address,
        bytes calldata _data
    ) internal view returns (bytes memory returnData) {
88: function delegateCall(
        uint256 _gas,
        address _address,
        bytes calldata _data
    ) internal returns (bytes memory returnData) {
105: function mimicCall(
        uint256 _gas,
        address _address,
        bytes calldata _data,
        address _whoToMimic,
        bool _isConstructor,
        bool _isSystem
    ) internal returns (bytes memory returnData) {
124: function rawCall(
        uint256 _gas,
        address _address,
        uint256 _value,
        bytes calldata _data,
        bool _isSystem
    ) internal returns (bool success) {
159: function rawStaticCall(uint256 _gas, address _address, bytes calldata _data) internal view returns (bool success) {
173: function rawDelegateCall(uint256 _gas, address _address, bytes calldata _data) internal returns (bool success) {
191: function rawMimicCall(
        uint256 _gas,
        address _address,
        bytes calldata _data,
        address _whoToMimic,
        bool _isConstructor,
        bool _isSystem
    ) internal returns (bool success) {
232: function propagateRevert() internal pure {
```
[36](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L36) | [45](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L45) | [58](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L58) | [74](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L74) | [88](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L88) | [105](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L105) | [124](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L124) | [159](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L159) | [173](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L173) | [191](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L191) | [232](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L232)

```solidity
File: code/system-contracts/contracts/libraries/RLPEncoder.sol

11: function encodeAddress(address _val) internal pure returns (bytes memory encoded) {
23: function encodeUint256(uint256 _val) internal pure returns (bytes memory encoded) {
49: function encodeNonSingleBytesLen(uint64 _len) internal pure returns (bytes memory) {
56: function encodeListLen(uint64 _len) internal pure returns (bytes memory) {
```
[11](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/RLPEncoder.sol#L11) | [23](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/RLPEncoder.sol#L23) | [49](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/RLPEncoder.sol#L49) | [56](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/RLPEncoder.sol#L56)

```solidity
File: code/system-contracts/contracts/libraries/SystemContractHelper.sol

48: function toL1(bool _isService, bytes32 _key, bytes32 _value) internal {
63: function getCodeAddress() internal view returns (address addr) {
74: function loadCalldataIntoActivePtr() internal view {
85: function ptrPackIntoActivePtr(uint256 _farCallAbi) internal view {
94: function ptrAddIntoActive(uint32 _value) internal view {
106: function ptrShrinkIntoActive(uint32 _shrink) internal view {
124: function packPrecompileParams(
        uint32 _inputMemoryOffset,
        uint32 _inputMemoryLength,
        uint32 _outputMemoryOffset,
        uint32 _outputMemoryLength,
        uint64 _perPrecompileInterpreted
    ) internal pure returns (uint256 rawParams) {
148: function unsafePrecompileCall(
        uint256 _rawParams,
        uint32 _gasToBurn,
        uint32 _pubdataToSpend
    ) internal view returns (bool success) {
168: function setValueForNextFarCall(uint128 _value) internal returns (bool success) {
181: function eventInitialize(uint256 initializer, uint256 value1) internal {
191: function eventWrite(uint256 value1, uint256 value2) internal {
203: function getZkSyncMetaBytes() internal view returns (uint256 meta) {
215: function extractNumberFromMeta(uint256 meta, uint256 offset, uint256 size) internal pure returns (uint256 result) {
227: function getPubdataPublishedFromMeta(uint256 meta) internal pure returns (uint32 pubdataPublished) {
237: function getHeapSizeFromMeta(uint256 meta) internal pure returns (uint32 heapSize) {
246: function getAuxHeapSizeFromMeta(uint256 meta) internal pure returns (uint32 auxHeapSize) {
254: function getShardIdFromMeta(uint256 meta) internal pure returns (uint8 shardId) {
263: function getCallerShardIdFromMeta(uint256 meta) internal pure returns (uint8 callerShardId) {
272: function getCodeShardIdFromMeta(uint256 meta) internal pure returns (uint8 codeShardId) {
279: function getZkSyncMeta() internal view returns (ZkSyncMeta memory meta) {
296: function getCallFlags() internal view returns (uint256 callFlags) {
307: function getCalldataPtr() internal view returns (uint256 ptr) {
318: function getExtraAbiData(uint256 index) internal view returns (uint256 extraAbiData) {
329: function isSystemCall() internal view returns (bool) {
338: function isSystemContract(address _address) internal pure returns (bool) {
344: function burnGas(uint32 _gasToPay, uint32 _pubdataToSpend) internal view {
```
[48](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L48) | [63](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L63) | [74](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L74) | [85](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L85) | [94](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L94) | [106](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L106) | [124](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L124) | [148](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L148) | [168](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L168) | [181](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L181) | [191](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L191) | [203](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L203) | [215](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L215) | [227](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L227) | [237](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L237) | [246](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L246) | [254](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L254) | [263](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L263) | [272](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L272) | [279](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L279) | [296](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L296) | [307](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L307) | [318](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L318) | [329](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L329) | [338](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L338) | [344](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L344)

```solidity
File: code/system-contracts/contracts/libraries/SystemContractsCaller.sol

76: function systemCall(uint32 gasLimit, address to, uint256 value, bytes memory data) internal returns (bool success) {
123: function systemCallWithReturndata(
        uint32 gasLimit,
        address to,
        uint128 value,
        bytes memory data
    ) internal returns (bool success, bytes memory returnData) {
150: function systemCallWithPropagatedRevert(
        uint32 gasLimit,
        address to,
        uint128 value,
        bytes memory data
    ) internal returns (bytes memory returnData) {
214: function getFarCallABI(
        uint32 dataOffset,
        uint32 memoryPage,
        uint32 dataStart,
        uint32 dataLength,
        uint32 gasPassed,
        uint8 shardId,
        CalldataForwardingMode forwardingMode,
        bool isConstructorCall,
        bool isSystemCall
    ) internal pure returns (uint256 farCallAbi) {
250: function getFarCallABIWithEmptyFatPointer(
        uint32 gasPassed,
        uint8 shardId,
        CalldataForwardingMode forwardingMode,
        bool isConstructorCall,
        bool isSystemCall
    ) internal pure returns (uint256 farCallAbiWithEmptyFatPtr) {
```
[76](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L76) | [123](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L123) | [150](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L150) | [214](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L214) | [250](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L250)

```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

94: function isEthToken(uint256 _addr) internal pure returns (bool) {
100: function encodeHash(Transaction calldata _transaction) internal view returns (bytes32 resultHash) {
362: function processPaymasterInput(Transaction calldata _transaction) internal {
395: function payToTheBootloader(Transaction calldata _transaction) internal returns (bool success) {
405: function totalRequiredBalance(Transaction calldata _transaction) internal pure returns (uint256 requiredBalance) {
```
[94](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L94) | [100](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L100) | [362](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L362) | [395](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L395) | [405](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L405)

```solidity
File: code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol

19: function readUint16(bytes calldata _bytes, uint256 _start) internal pure returns (uint16 result) {
25: function readUint32(bytes calldata _bytes, uint256 _start) internal pure returns (uint32 result) {
32: function readUint64(bytes calldata _bytes, uint256 _start) internal pure returns (uint64 result) {
39: function readBytes32(bytes calldata _bytes, uint256 _start) internal pure returns (bytes32 result) {
45: function readUint256(bytes calldata _bytes, uint256 _start) internal pure returns (uint256 result) {
```
[19](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol#L19) | [25](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol#L25) | [32](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol#L32) | [39](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol#L39) | [45](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol#L45)

```solidity
File: code/system-contracts/contracts/libraries/Utils.sol

19: function safeCastToU128(uint256 _x) internal pure returns (uint128) {
25: function safeCastToU32(uint256 _x) internal pure returns (uint32) {
31: function safeCastToU24(uint256 _x) internal pure returns (uint24) {
39: function bytecodeLenInBytes(bytes32 _bytecodeHash) internal pure returns (uint256 codeLength) {
44: function bytecodeLenInWords(bytes32 _bytecodeHash) internal pure returns (uint256 codeLengthInWords) {
51: function isContractConstructed(bytes32 _bytecodeHash) internal pure returns (bool) {
56: function isContractConstructing(bytes32 _bytecodeHash) internal pure returns (bool) {
63: function constructingBytecodeHash(bytes32 _bytecodeHash) internal pure returns (bytes32) {
71: function constructedBytecodeHash(bytes32 _bytecodeHash) internal pure returns (bytes32) {
82: function hashL2Bytecode(bytes calldata _bytecode) internal view returns (bytes32 hashedBytecode) {
```
[19](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L19) | [25](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L25) | [31](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L31) | [39](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L39) | [44](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L44) | [51](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L51) | [56](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L56) | [63](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L63) | [71](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L71) | [82](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L82)

```solidity
File: code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol

28: function applyL1ToL2Alias(address l1Address) internal pure returns (address l2Address) {
38: function undoL1ToL2Alias(address l2Address) internal pure returns (address l1Address) {
```
[28](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol#L28) | [38](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol#L38)

```solidity
File: code/contracts/zksync/contracts/L2ContractHelper.sol

90: function sendMessageToL1(bytes memory _message) internal returns (bytes32) {
101: function computeCreate2Address(
        address _sender,
        bytes32 _salt,
        bytes32 _bytecodeHash,
        bytes32 _constructorInputHash
    ) internal pure returns (address) {
```
[90](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/L2ContractHelper.sol#L90) | [101](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/L2ContractHelper.sol#L101)

```solidity
File: code/contracts/zksync/contracts/SystemContractsCaller.sol

27: function safeCastToU32(uint256 _x) internal pure returns (uint32) {
37: function systemCall(uint32 gasLimit, address to, uint256 value, bytes memory data) internal returns (bool success) {
75: function systemCallWithReturndata(
        uint32 gasLimit,
        address to,
        uint128 value,
        bytes memory data
    ) internal returns (bool success, bytes memory returnData) {
94: function getFarCallABI(
        uint32 dataOffset,
        uint32 memoryPage,
        uint32 dataStart,
        uint32 dataLength,
        uint32 gasPassed,
        uint8 shardId,
        CalldataForwardingMode forwardingMode,
        bool isConstructorCall,
        bool isSystemCall
    ) internal pure returns (uint256 farCallAbi) {
120: function getFarCallABIWithEmptyFatPointer(
        uint32 gasPassed,
        uint8 shardId,
        CalldataForwardingMode forwardingMode,
        bool isConstructorCall,
        bool isSystemCall
    ) internal pure returns (uint256 farCallAbiWithEmptyFatPtr) {
```
[27](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/SystemContractsCaller.sol#L27) | [37](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/SystemContractsCaller.sol#L37) | [75](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/SystemContractsCaller.sol#L75) | [94](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/SystemContractsCaller.sol#L94) | [120](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/SystemContractsCaller.sol#L120)
</details>

### [N-77] Missing NatSpec Descriptions for Event Declarations

Event declarations should have accompanying NatSpec comments with `@dev` or `@notice` tag to describe their purpose and the meaning of emitted parameters. 
These comments provide clarity for developers, reviewers, and users of the contract.
[More information in Documentation](https://docs.soliditylang.org/en/latest/natspec-format.html)

<details>
<summary><i>29 issue instances in 12 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol

24: event DiamondCut(FacetCut[] facetCuts, address initAddress, bytes initCalldata);
```
[24](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L24)

```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol

20: event WithdrawalFinalized(address indexed to, address indexed l1Token, uint256 amount);
22: event ClaimedFailedDeposit(address indexed to, address indexed l1Token, uint256 amount);
```
[20](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L20) | [22](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L22)

```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol

13: event LegacyDepositInitiated(
        uint256 indexed chainId,
        bytes32 indexed l2DepositTxHash,
        address indexed from,
        address to,
        address l1Token,
        uint256 amount
    );
22: event BridgehubDepositInitiated(
        uint256 indexed chainId,
        bytes32 indexed txDataHash,
        address indexed from,
        address to,
        address l1Token,
        uint256 amount
    );
31: event BridgehubDepositBaseTokenInitiated(
        uint256 indexed chainId,
        address indexed from,
        address l1Token,
        uint256 amount
    );
38: event BridgehubDepositFinalized(
        uint256 indexed chainId,
        bytes32 indexed txDataHash,
        bytes32 indexed l2DepositTxHash
    );
44: event WithdrawalFinalizedSharedBridge(
        uint256 indexed chainId,
        address indexed to,
        address indexed l1Token,
        uint256 amount
    );
51: event ClaimedFailedDepositSharedBridge(
        uint256 indexed chainId,
        address indexed to,
        address indexed l1Token,
        uint256 amount
    );
```
[13](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L13) | [22](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L22) | [31](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L31) | [38](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L38) | [44](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L44) | [51](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L51)

```solidity
File: code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol

133: event NewChain(uint256 indexed chainId, address stateTransitionManager, address indexed chainGovernance);
```
[133](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L133)

```solidity
File: code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol

28: event StateTransitionNewChain(uint256 indexed _chainId, address indexed _stateTransitionContract);
30: event SetChainIdUpgrade(
        address indexed _stateTransitionChain,
        L2CanonicalTransaction _l2Transaction,
        uint256 indexed _protocolVersion
    );
```
[28](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L28) | [30](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L30)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol

17: event ProposeTransparentUpgrade(
        Diamond.DiamondCutData diamondCut,
        uint256 indexed proposalId,
        bytes32 proposalSalt
    );
```
[17](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol#L17)

```solidity
File: code/system-contracts/contracts/interfaces/IBaseToken.sol

24: event Mint(address indexed account, uint256 amount);
26: event Transfer(address indexed from, address indexed to, uint256 value);
28: event Withdrawal(address indexed _l2Sender, address indexed _l1Receiver, uint256 _amount);
30: event WithdrawalWithMessage(
        address indexed _l2Sender,
        address indexed _l1Receiver,
        uint256 _amount,
        bytes _additionalData
    );
```
[24](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IBaseToken.sol#L24) | [26](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IBaseToken.sol#L26) | [28](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IBaseToken.sol#L28) | [30](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IBaseToken.sol#L30)

```solidity
File: code/system-contracts/contracts/interfaces/IContractDeployer.sol

33: event ContractDeployed(
        address indexed deployerAddress,
        bytes32 indexed bytecodeHash,
        address indexed contractAddress
    );
39: event AccountNonceOrderingUpdated(address indexed accountAddress, AccountNonceOrdering nonceOrdering);
41: event AccountVersionUpdated(address indexed accountAddress, AccountAbstractionVersion aaVersion);
```
[33](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L33) | [39](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L39) | [41](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L41)

```solidity
File: code/system-contracts/contracts/interfaces/IL1Messenger.sol

45: event L2ToL1LogSent(L2ToL1Log _l2log);
47: event BytecodeL1PublicationRequested(bytes32 _bytecodeHash);
```
[45](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IL1Messenger.sol#L45) | [47](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IL1Messenger.sol#L47)

```solidity
File: code/system-contracts/contracts/interfaces/IL2StandardToken.sol

6: event BridgeMint(address indexed _account, uint256 _amount);
8: event BridgeBurn(address indexed _account, uint256 _amount);
```
[6](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IL2StandardToken.sol#L6) | [8](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IL2StandardToken.sol#L8)

```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol

7: event FinalizeDeposit(
        address indexed l1Sender,
        address indexed l2Receiver,
        address indexed l2Token,
        uint256 amount
    );
14: event WithdrawalInitiated(
        address indexed l2Sender,
        address indexed l1Receiver,
        address indexed l2Token,
        uint256 amount
    );
```
[7](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol#L7) | [14](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol#L14)

```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol

6: event BridgeInitialize(address indexed l1Token, string name, string symbol, uint8 decimals);
8: event BridgeMint(address indexed _account, uint256 _amount);
10: event BridgeBurn(address indexed _account, uint256 _amount);
```
[6](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol#L6) | [8](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol#L8) | [10](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol#L10)
</details>

### [N-78] Unused Function Parameters

Function parameters that are not used within the function body can introduce confusion and reduce code clarity.
It's recommended to comment out the variable name or remove it if not needed. This will not only improve the readability of the code but also suppress any compiler warnings associated with unused parameters.
Ensure that removing or commenting out the parameter doesn't affect any function calls or overrides in derived contracts.

If function is `virtual`, it's recommended to remove the parameter name from the function declaration.

<details>
<summary><i>4 issue instances in 3 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

/// @audit `l2Value` never used in function body or passed to modifiers
182: function bridgehubDeposit(
        uint256 _chainId,
        address _prevMsgSender,
        uint256, // l2Value, needed for Weth deposits in the future
        bytes calldata _data
    ) external payable override onlyBridgehub returns (L2TransactionRequestTwoBridgesInner memory request) {
```
[182](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L182)

```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol

/// @audit `_customCallDataForUpgrade` never used in function body or passed to modifiers
263: function _upgradeL1Contract(bytes calldata _customCallDataForUpgrade) internal virtual {}
/// @audit `_customCallDataForUpgrade` never used in function body or passed to modifiers
269: function _postUpgrade(bytes calldata _customCallDataForUpgrade) internal virtual {}
```
[263](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L263) | [269](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L269)

```solidity
File: code/system-contracts/contracts/DefaultAccount.sol

/// @audit `_transaction` never used in function body or passed to modifiers
125: function executeTransactionFromOutside(Transaction calldata _transaction) external payable override {
```
[125](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L125)
</details>

### [N-79] Consider defining system-wide constants in a single file

System-wide constants should be declared in a single file for better maintainability and readability.
This contract seems to contain constants which could potentially be system-wide and could be better managed if they were centralized in a single location.

<details>
<summary><i>9 issue instances in 5 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

22: uint256 internal constant EXECUTED_PROPOSAL_TIMESTAMP = uint256(1);
```
[22](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L22)

```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

26: string public constant override getName = "ValidatorTimelock";
```
[26](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L26)

```solidity
File: code/system-contracts/contracts/L1Messenger.sol

44: uint256 internal constant KECCAK_ROUND_GAS_COST = 40;
47: uint256 internal constant KECCAK_ROUND_NUMBER_OF_BYTES = 136;
55: uint256 internal constant SHA256_ROUND_GAS_COST = 7;
58: uint256 internal constant SHA256_ROUND_NUMBER_OF_BYTES = 64;
```
[44](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L44) | [47](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L47) | [55](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L55) | [58](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L58)

```solidity
File: code/system-contracts/contracts/NonceHolder.sol

28: uint256 private constant DEPLOY_NONCE_MULTIPLIER = 2 ** 128;
31: uint256 private constant MAXIMAL_MIN_NONCE_INCREMENT = 2 ** 32;
```
[28](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L28) | [31](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L31)

```solidity
File: code/system-contracts/contracts/SystemContext.sol

23: uint256 internal constant MINIBLOCK_HASHES_TO_STORE = 257;
```
[23](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L23)
</details>

### [N-80] Add inline comments for unnamed variables

Having unnamed variables in function definitions can be confusing and decrease the code readability. 
Adding inline comments to explain the purpose of unnamed variables could make the code easier to understand and maintain.

For example, convert function declarations like `function foo(address x, address)` to `function foo(address x, address /* y */)` to indicate that the unnamed variable could have been named 'y'.

<details>
<summary><i>18 issue instances in 7 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

/// @audit - `uint256`
182: function bridgehubDeposit(
        uint256 _chainId,
        address _prevMsgSender,
        uint256, // l2Value, needed for Weth deposits in the future
        bytes calldata _data
    ) external payable override onlyBridgehub returns (L2TransactionRequestTwoBridgesInner memory request) {
```
[182](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L182)

```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

/// @audit - `uint256`
114: function createNewChain(
        uint256 _chainId,
        address _stateTransitionManager,
        address _baseToken,
        uint256, //_salt
        address _admin,
        bytes calldata _initData
    ) external onlyOwnerOrAdmin nonReentrant returns (uint256 chainId) {
```
[114](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L114)

```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

/// @audit - `StoredBatchInfo`
108: function commitBatches(
        StoredBatchInfo calldata,
        CommitBatchInfo[] calldata _newBatchesData
    ) external onlyValidator(ERA_CHAIN_ID) {
/// @audit - `StoredBatchInfo`
126: function commitBatchesSharedBridge(
        uint256 _chainId,
        StoredBatchInfo calldata,
        CommitBatchInfo[] calldata _newBatchesData
    ) external onlyValidator(_chainId) {
/// @audit - `uint256`
146: function revertBatches(uint256) external onlyValidator(ERA_CHAIN_ID) {
/// @audit - `uint256`
153: function revertBatchesSharedBridge(uint256 _chainId, uint256) external onlyValidator(_chainId) {
/// @audit - `StoredBatchInfo,StoredBatchInfo[],ProofInput`
160: function proveBatches(
        StoredBatchInfo calldata,
        StoredBatchInfo[] calldata,
        ProofInput calldata
    ) external onlyValidator(ERA_CHAIN_ID) {
/// @audit - `StoredBatchInfo,StoredBatchInfo[],ProofInput`
171: function proveBatchesSharedBridge(
        uint256 _chainId,
        StoredBatchInfo calldata,
        StoredBatchInfo[] calldata,
        ProofInput calldata
    ) external onlyValidator(_chainId) {
```
[108](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L108) | [126](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L126) | [146](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L146) | [153](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L153) | [160](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L160) | [171](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L171)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

/// @audit - `uint256`
207: function commitBatchesSharedBridge(
        uint256, // _chainId
        StoredBatchInfo memory _lastCommittedBatchData,
        CommitBatchInfo[] calldata _newBatchesData
    ) external nonReentrant onlyValidator {
/// @audit - `uint256`
337: function executeBatchesSharedBridge(
        uint256,
        StoredBatchInfo[] calldata _batchesData
    ) external nonReentrant onlyValidator {
/// @audit - `uint256`
377: function proveBatchesSharedBridge(
        uint256, // _chainId
        StoredBatchInfo calldata _prevBatch,
        StoredBatchInfo[] calldata _committedBatches,
        ProofInput calldata _proof
    ) external nonReentrant onlyValidator {
/// @audit - `uint256`
477: function revertBatchesSharedBridge(uint256, uint256 _newLastBatch) external nonReentrant onlyValidator {
```
[207](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L207) | [337](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L337) | [377](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L377) | [477](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L477)

```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

/// @audit - `bytes32`
182: function createAccount(
        bytes32, // salt
        bytes32 _bytecodeHash,
        bytes calldata _input,
        AccountAbstractionVersion _aaVersion
    ) public payable override onlySystemCall returns (address) {
```
[182](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L182)

```solidity
File: code/system-contracts/contracts/DefaultAccount.sol

/// @audit - `bytes32`
67: function validateTransaction(
        bytes32, // _txHash
        bytes32 _suggestedSignedHash,
        Transaction calldata _transaction
    ) external payable override ignoreNonBootloader ignoreInDelegateCall returns (bytes4 magic) {
/// @audit - `bytes32`
112: function executeTransaction(
        bytes32, // _txHash
        bytes32, // _suggestedSignedHash
        Transaction calldata _transaction
    ) external payable override ignoreNonBootloader ignoreInDelegateCall {
/// @audit - `bytes32`
196: function payForTransaction(
        bytes32, // _txHash
        bytes32, // _suggestedSignedHash
        Transaction calldata _transaction
    ) external payable ignoreNonBootloader ignoreInDelegateCall {
/// @audit - `bytes32`
212: function prepareForPaymaster(
        bytes32, // _txHash
        bytes32, // _suggestedSignedHash
        Transaction calldata _transaction
    ) external payable ignoreNonBootloader ignoreInDelegateCall {
```
[67](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L67) | [112](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L112) | [196](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L196) | [212](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L212)

```solidity
File: code/system-contracts/contracts/interfaces/IBaseToken.sol

/// @audit - `uint256`
6: function balanceOf(uint256) external view returns (uint256);
```
[6](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IBaseToken.sol#L6)
</details>

### [N-81] Consider making contracts `Upgradeable`

Contract uses a non-upgradeable design.
Transitioning to an upgradeable contract structure is more aligned with contemporary smart contract practices.
This approach not only enhances flexibility but also allows for continuous improvement and adaptation, ensuring the contract stays relevant and robust in an ever-evolving ecosystem.

<details>
<summary><i>38 issue instances in 37 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

/// @audit - Contract `L1ERC20Bridge` is not upgradeable
19: contract L1ERC20Bridge is IL1ERC20Bridge, ReentrancyGuard {
/// @audit - Contract `L1ERC20Bridge` is not upgradeable
19: contract L1ERC20Bridge is IL1ERC20Bridge, ReentrancyGuard {
```
[19](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L19) | [19](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L19)

```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

/// @audit - Contract `L1SharedBridge` is not upgradeable
30: contract L1SharedBridge is IL1SharedBridge, ReentrancyGuard, Initializable, Ownable2Step {
```
[30](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L30)

```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

/// @audit - Contract `Bridgehub` is not upgradeable
15: contract Bridgehub is IBridgehub, ReentrancyGuard, Ownable2Step {
```
[15](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L15)

```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

/// @audit - Contract `Governance` is not upgradeable
20: contract Governance is IGovernance, Ownable2Step {
```
[20](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L20)

```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

/// @audit - Contract `StateTransitionManager` is not upgradeable
25: contract StateTransitionManager is IStateTransitionManager, ReentrancyGuard, Ownable2Step {
```
[25](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L25)

```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

/// @audit - Contract `ValidatorTimelock` is not upgradeable
22: contract ValidatorTimelock is IExecutor, Ownable2Step {
```
[22](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L22)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol

/// @audit - Contract `DiamondInit` is not upgradeable
17: contract DiamondInit is ZkSyncStateTransitionBase, IDiamondInit {
```
[17](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol#L17)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol

/// @audit - Contract `DiamondProxy` is not upgradeable
10: contract DiamondProxy {
```
[10](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol#L10)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol

/// @audit - Contract `AdminFacet` is not upgradeable
18: contract AdminFacet is ZkSyncStateTransitionBase, IAdmin {
```
[18](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L18)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

/// @audit - Contract `ExecutorFacet` is not upgradeable
22: contract ExecutorFacet is ZkSyncStateTransitionBase, IExecutor {
```
[22](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L22)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol

/// @audit - Contract `GettersFacet` is not upgradeable
20: contract GettersFacet is ZkSyncStateTransitionBase, IGetters, ILegacyGetters {
```
[20](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L20)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

/// @audit - Contract `MailboxFacet` is not upgradeable
30: contract MailboxFacet is ZkSyncStateTransitionBase, IMailbox {
```
[30](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L30)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol

/// @audit - Contract `ZkSyncStateTransitionBase` is not upgradeable
11: contract ZkSyncStateTransitionBase is ReentrancyGuard {
```
[11](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L11)

```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol

/// @audit - Contract `BaseZkSyncUpgrade` is not upgradeable
44: abstract contract BaseZkSyncUpgrade is ZkSyncStateTransitionBase {
```
[44](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L44)

```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol

/// @audit - Contract `BaseZkSyncUpgradeGenesis` is not upgradeable
17: abstract contract BaseZkSyncUpgradeGenesis is BaseZkSyncUpgrade {
```
[17](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L17)

```solidity
File: code/contracts/ethereum/contracts/upgrades/DefaultUpgrade.sol

/// @audit - Contract `DefaultUpgrade` is not upgradeable
10: contract DefaultUpgrade is BaseZkSyncUpgrade {
```
[10](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/DefaultUpgrade.sol#L10)

```solidity
File: code/contracts/ethereum/contracts/upgrades/GenesisUpgrade.sol

/// @audit - Contract `GenesisUpgrade` is not upgradeable
11: contract GenesisUpgrade is BaseZkSyncUpgradeGenesis {
```
[11](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/GenesisUpgrade.sol#L11)

```solidity
File: code/contracts/ethereum/contracts/common/ReentrancyGuard.sol

/// @audit - Contract `ReentrancyGuard` is not upgradeable
25: abstract contract ReentrancyGuard {
```
[25](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/ReentrancyGuard.sol#L25)

```solidity
File: code/system-contracts/contracts/AccountCodeStorage.sol

/// @audit - Contract `AccountCodeStorage` is not upgradeable
22: contract AccountCodeStorage is IAccountCodeStorage {
```
[22](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/AccountCodeStorage.sol#L22)

```solidity
File: code/system-contracts/contracts/BootloaderUtilities.sol

/// @audit - Contract `BootloaderUtilities` is not upgradeable
16: contract BootloaderUtilities is IBootloaderUtilities {
```
[16](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L16)

```solidity
File: code/system-contracts/contracts/ComplexUpgrader.sol

/// @audit - Contract `ComplexUpgrader` is not upgradeable
14: contract ComplexUpgrader is IComplexUpgrader {
```
[14](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ComplexUpgrader.sol#L14)

```solidity
File: code/system-contracts/contracts/Compressor.sol

/// @audit - Contract `Compressor` is not upgradeable
22: contract Compressor is ICompressor, ISystemContract {
```
[22](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L22)

```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

/// @audit - Contract `ContractDeployer` is not upgradeable
23: contract ContractDeployer is IContractDeployer, ISystemContract {
```
[23](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L23)

```solidity
File: code/system-contracts/contracts/DefaultAccount.sol

/// @audit - Contract `DefaultAccount` is not upgradeable
19: contract DefaultAccount is IAccount {
```
[19](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L19)

```solidity
File: code/system-contracts/contracts/EmptyContract.sol

/// @audit - Contract `EmptyContract` is not upgradeable
10: contract EmptyContract {
```
[10](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/EmptyContract.sol#L10)

```solidity
File: code/system-contracts/contracts/ImmutableSimulator.sol

/// @audit - Contract `ImmutableSimulator` is not upgradeable
18: contract ImmutableSimulator is IImmutableSimulator {
```
[18](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ImmutableSimulator.sol#L18)

```solidity
File: code/system-contracts/contracts/KnownCodesStorage.sol

/// @audit - Contract `KnownCodesStorage` is not upgradeable
18: contract KnownCodesStorage is IKnownCodesStorage, ISystemContract {
```
[18](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/KnownCodesStorage.sol#L18)

```solidity
File: code/system-contracts/contracts/L1Messenger.sol

/// @audit - Contract `L1Messenger` is not upgradeable
25: contract L1Messenger is IL1Messenger, ISystemContract {
```
[25](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L25)

```solidity
File: code/system-contracts/contracts/L2BaseToken.sol

/// @audit - Contract `L2BaseToken` is not upgradeable
18: contract L2BaseToken is IBaseToken, ISystemContract {
```
[18](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L2BaseToken.sol#L18)

```solidity
File: code/system-contracts/contracts/MsgValueSimulator.sol

/// @audit - Contract `MsgValueSimulator` is not upgradeable
19: contract MsgValueSimulator is ISystemContract {
```
[19](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/MsgValueSimulator.sol#L19)

```solidity
File: code/system-contracts/contracts/NonceHolder.sol

/// @audit - Contract `NonceHolder` is not upgradeable
27: contract NonceHolder is INonceHolder, ISystemContract {
```
[27](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L27)

```solidity
File: code/system-contracts/contracts/PubdataChunkPublisher.sol

/// @audit - Contract `PubdataChunkPublisher` is not upgradeable
16: contract PubdataChunkPublisher is IPubdataChunkPublisher, ISystemContract {
```
[16](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/PubdataChunkPublisher.sol#L16)

```solidity
File: code/system-contracts/contracts/SystemContext.sol

/// @audit - Contract `SystemContext` is not upgradeable
17: contract SystemContext is ISystemContext, ISystemContextDeprecated, ISystemContract {
```
[17](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L17)

```solidity
File: code/system-contracts/contracts/GasBoundCaller.sol

/// @audit - Contract `GasBoundCaller` is not upgradeable
15: contract GasBoundCaller {
```
[15](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/GasBoundCaller.sol#L15)

```solidity
File: code/system-contracts/contracts/interfaces/ISystemContract.sol

/// @audit - Contract `ISystemContract` is not upgradeable
17: abstract contract ISystemContract {
```
[17](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/ISystemContract.sol#L17)

```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

/// @audit - Contract `L2SharedBridge` is not upgradeable
23: contract L2SharedBridge is IL2SharedBridge, Initializable {
```
[23](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L23)

```solidity
File: code/contracts/zksync/contracts/ForceDeployUpgrader.sol

/// @audit - Contract `ForceDeployUpgrader` is not upgradeable
10: contract ForceDeployUpgrader {
```
[10](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/ForceDeployUpgrader.sol#L10)
</details>

### [N-82] Events that mark critical parameter changes should contain both the old and the new value

When emitting events that signify critical changes in parameters, it's important to include both the old and new values. 

This aids in auditability, providing more complete information about the state change. It's especially necessary when the new value isn't required to be different from the old one, as this prevents ambiguity in event logs.

<details>
<summary><i>6 issue instances in 3 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

180: emit OperationExecuted(id);
199: emit OperationExecuted(id);
```
[180](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L180) | [199](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L199)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol

54: emit IsPorterAvailableStatusUpdate(_zkPorterIsAvailable);
92: emit ValidiumModeStatusUpdate(_validiumMode);
```
[54](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L54) | [92](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L92)

```solidity
File: code/system-contracts/contracts/L1Messenger.sol

111: emit L2ToL1LogSent(_l2ToL1Log);
181: emit BytecodeL1PublicationRequested(_bytecodeHash);
```
[111](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L111) | [181](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L181)
</details>

### [N-83] Style guide: Non-`external`/`public` variable names should begin with an underscore

The naming convention for non-public (private and internal) variables in Solidity recommends the use of a leading underscore.

Since `constants` can be public, to avoid confusion, they should also be prefixed with an underscore.

This practice clearly differentiates between public/external and non-public variables, enhancing code clarity and reducing the likelihood of misinterpretation or errors.
Following this convention improves code readability and maintainability.

<details>
<summary><i>204 issue instances in 37 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

45: uint256 internal eraFirstPostUpgradeBatch;
61: mapping(uint256 chainId => bool enabled) internal hyperbridgingEnabled;
65: mapping(uint256 chainId => mapping(address l1Token => uint256 balance)) internal chainBalance;
```
[45](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L45) | [61](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L61) | [65](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L65)

```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

35: address private pendingAdmin;
```
[35](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L35)

```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

22: uint256 internal constant EXECUTED_PROPOSAL_TIMESTAMP = uint256(1);
```
[22](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L22)

```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

54: address private pendingAdmin;
```
[54](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L54)

```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

47: mapping(uint256 => LibMap.Uint32Map) internal committedBatchTimestamp;
```
[47](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L47)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol

12: ZkSyncStateTransitionStorage internal s;
```
[12](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L12)

```solidity
File: code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol

12: bytes32 private constant CREATE2_PREFIX = keccak256("zksyncCreate2");
```
[12](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L12)

```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol

17: bytes32 internal constant DIAMOND_INIT_SUCCESS_RETURN_VALUE =
        0x33774e659306e47509050e97cb651e731180a42d458212294d30751925c551a2; // keccak256("diamond.zksync.init") - 1
21: bytes32 private constant DIAMOND_STORAGE_POSITION =
        0xc8fcad8db84d3cc18b4c41d551ea0ee66dd599cde068d998e57d5e09332c131b; // keccak256("diamond.standard.diamond.storage") - 1;
```
[17](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L17) | [21](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L21)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol

40: uint256 constant L2_LOG_ADDRESS_OFFSET = 4;
43: uint256 constant L2_LOG_KEY_OFFSET = 24;
46: uint256 constant L2_LOG_VALUE_OFFSET = 56;
50: uint256 constant BLS_MODULUS = 52435875175126190479447740508185965837690552500527637822603658699938581184513;
54: uint256 constant PUBDATA_COMMITMENT_SIZE = 144;
57: uint256 constant PUBDATA_COMMITMENT_CLAIMED_VALUE_OFFSET = 16;
60: uint256 constant PUBDATA_COMMITMENT_COMMITMENT_OFFSET = 48;
63: uint256 constant MAX_NUMBER_OF_BLOBS = 2;
68: uint256 constant TOTAL_BLOBS_IN_COMMITMENT = 16;
```
[40](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L40) | [43](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L43) | [46](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L46) | [50](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L50) | [54](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L54) | [57](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L57) | [60](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L60) | [63](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L63) | [68](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L68)

```solidity
File: code/contracts/ethereum/contracts/common/Config.sol

6: bytes32 constant EMPTY_STRING_KECCAK = 0xc5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470;
11: uint256 constant L2_TO_L1_LOG_SERIALIZE_SIZE = 88;
14: uint256 constant MAX_L2_TO_L1_LOGS_COMMITMENT_BYTES = 4 + L2_TO_L1_LOG_SERIALIZE_SIZE * 512;
19: bytes32 constant L2_L1_LOGS_TREE_DEFAULT_LEAF_HASH = 0x72abee45b59e344af8a6e520241c4744aff26ed411f4c4b00f8af09adada43ba;
22: bytes32 constant DEFAULT_L2_LOGS_TREE_ROOT_HASH = bytes32(0);
25: uint256 constant PRIORITY_OPERATION_L2_TX_TYPE = 255;
28: uint256 constant SYSTEM_UPGRADE_L2_TX_TYPE = 254;
33: uint256 constant MAX_ALLOWED_PROTOCOL_VERSION_DELTA = 100;
37: uint256 constant PRIORITY_EXPIRATION = 0 days;
40: uint256 constant COMMIT_TIMESTAMP_NOT_OLDER = 3 days;
44: uint256 constant COMMIT_TIMESTAMP_APPROXIMATION_DELTA = 1 hours;
47: uint256 constant PUBLIC_INPUT_SHIFT = 32;
50: uint256 constant MAX_GAS_PER_TRANSACTION = $(MAX_GAS_PER_TRANSACTION);
54: uint256 constant L1_GAS_PER_PUBDATA_BYTE = $(L1_GAS_PER_PUBDATA_BYTE);
57: uint256 constant L1_TX_INTRINSIC_L2_GAS = $(L1_TX_INTRINSIC_L2_GAS);
60: uint256 constant L1_TX_INTRINSIC_PUBDATA = $(L1_TX_INTRINSIC_PUBDATA);
63: uint256 constant L1_TX_MIN_L2_GAS_BASE = $(L1_TX_MIN_L2_GAS_BASE);
66: uint256 constant L1_TX_DELTA_544_ENCODING_BYTES = $(L1_TX_DELTA_544_ENCODING_BYTES);
69: uint256 constant L1_TX_DELTA_FACTORY_DEPS_L2_GAS = $(L1_TX_DELTA_FACTORY_DEPS_L2_GAS);
72: uint256 constant L1_TX_DELTA_FACTORY_DEPS_PUBDATA = $(L1_TX_DELTA_FACTORY_DEPS_PUBDATA);
75: uint256 constant MAX_NEW_FACTORY_DEPS = $(MAX_NEW_FACTORY_DEPS);
78: uint256 constant REQUIRED_L2_GAS_PRICE_PER_PUBDATA = $(REQUIRED_L2_GAS_PRICE_PER_PUBDATA);
82: uint256 constant PACKED_L2_BLOCK_TIMESTAMP_MASK = 0xffffffffffffffffffffffffffffffff;
85: address constant POINT_EVALUATION_PRECOMPILE_ADDR = address(0x0A);
92: uint256 constant TX_SLOT_OVERHEAD_L2_GAS = 10000;
99: uint256 constant MEMORY_OVERHEAD_GAS = 10;
101: address constant ETH_TOKEN_ADDRESS = address(1);
104: uint256 constant ERA_CHAIN_ID = $(ERA_CHAIN_ID);
107: address constant ERA_ERC20_BRIDGE_ADDRESS = $(ERA_ERC20_BRIDGE_ADDRESS);
110: address constant ERA_DIAMOND_PROXY = $(ERA_DIAMOND_PROXY);
112: bytes32 constant TWO_BRIDGES_MAGIC_VALUE = bytes32(uint256(keccak256("TWO_BRIDGES_MAGIC_VALUE")) - 1);
115: address constant BRIDGEHUB_MIN_SECOND_BRIDGE_ADDRESS = address(uint160(type(uint16).max));
```
[6](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L6) | [11](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L11) | [14](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L14) | [19](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L19) | [22](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L22) | [25](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L25) | [28](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L28) | [33](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L33) | [37](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L37) | [40](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L40) | [44](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L44) | [47](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L47) | [50](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L50) | [54](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L54) | [57](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L57) | [60](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L60) | [63](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L63) | [66](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L66) | [69](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L69) | [72](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L72) | [75](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L75) | [78](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L78) | [82](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L82) | [85](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L85) | [92](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L92) | [99](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L99) | [101](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L101) | [104](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L104) | [107](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L107) | [110](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L110) | [112](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L112) | [115](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L115)

```solidity
File: code/contracts/ethereum/contracts/common/L2ContractAddresses.sol

6: address constant L2_BOOTLOADER_ADDRESS = address(0x8001);
9: address constant L2_KNOWN_CODE_STORAGE_SYSTEM_CONTRACT_ADDR = address(0x8004);
12: address constant L2_DEPLOYER_SYSTEM_CONTRACT_ADDR = address(0x8006);
21: address constant L2_FORCE_DEPLOYER_ADDR = address(0x8007);
24: address constant L2_TO_L1_MESSENGER_SYSTEM_CONTRACT_ADDR = address(0x8008);
27: address constant L2_BASE_TOKEN_SYSTEM_CONTRACT_ADDR = address(0x800a);
30: address constant L2_SYSTEM_CONTEXT_SYSTEM_CONTRACT_ADDR = address(0x800b);
33: address constant L2_PUBDATA_CHUNK_PUBLISHER_ADDR = address(0x8011);
```
[6](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/L2ContractAddresses.sol#L6) | [9](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/L2ContractAddresses.sol#L9) | [12](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/L2ContractAddresses.sol#L12) | [21](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/L2ContractAddresses.sol#L21) | [24](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/L2ContractAddresses.sol#L24) | [27](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/L2ContractAddresses.sol#L27) | [30](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/L2ContractAddresses.sol#L30) | [33](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/L2ContractAddresses.sol#L33)

```solidity
File: code/contracts/ethereum/contracts/common/ReentrancyGuard.sol

29: uint256 private constant LOCK_FLAG_ADDRESS = 0x8e94fed44239eb2314ab7a406345e6c5a8f0ccedf3b600de3d004e672c33abf4;
```
[29](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/ReentrancyGuard.sol#L29)

```solidity
File: code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol

22: uint160 constant offset = uint160(0x1111000000000000000000000000000000001111);
```
[22](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol#L22)

```solidity
File: code/system-contracts/contracts/AccountCodeStorage.sol

23: bytes32 constant EMPTY_STRING_KECCAK = 0xc5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470;
```
[23](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/AccountCodeStorage.sol#L23)

```solidity
File: code/system-contracts/contracts/Constants.sol

25: uint160 constant REAL_SYSTEM_CONTRACTS_OFFSET = 0x8000;
29: uint160 constant MAX_SYSTEM_CONTRACT_ADDRESS = 0xffff; // 2^16 - 1
31: address constant ECRECOVER_SYSTEM_CONTRACT = address(0x01);
32: address constant SHA256_SYSTEM_CONTRACT = address(0x02);
33: address constant ECADD_SYSTEM_CONTRACT = address(0x06);
34: address constant ECMUL_SYSTEM_CONTRACT = address(0x07);
41: uint256 constant COMPUTATIONAL_PRICE_FOR_PUBDATA = 80;
46: uint256 constant CURRENT_MAX_PRECOMPILE_ADDRESS = 0xff;
48: address payable constant BOOTLOADER_FORMAL_ADDRESS = payable(address(SYSTEM_CONTRACTS_OFFSET + 0x01));
49: IAccountCodeStorage constant ACCOUNT_CODE_STORAGE_SYSTEM_CONTRACT = IAccountCodeStorage(
    address(SYSTEM_CONTRACTS_OFFSET + 0x02)
);
52: INonceHolder constant NONCE_HOLDER_SYSTEM_CONTRACT = INonceHolder(address(SYSTEM_CONTRACTS_OFFSET + 0x03));
53: IKnownCodesStorage constant KNOWN_CODE_STORAGE_CONTRACT = IKnownCodesStorage(address(SYSTEM_CONTRACTS_OFFSET + 0x04));
54: IImmutableSimulator constant IMMUTABLE_SIMULATOR_SYSTEM_CONTRACT = IImmutableSimulator(
    address(SYSTEM_CONTRACTS_OFFSET + 0x05)
);
57: IContractDeployer constant DEPLOYER_SYSTEM_CONTRACT = IContractDeployer(address(SYSTEM_CONTRACTS_OFFSET + 0x06));
61: address constant FORCE_DEPLOYER = address(SYSTEM_CONTRACTS_OFFSET + 0x07);
62: IL1Messenger constant L1_MESSENGER_CONTRACT = IL1Messenger(address(SYSTEM_CONTRACTS_OFFSET + 0x08));
63: address constant MSG_VALUE_SYSTEM_CONTRACT = address(SYSTEM_CONTRACTS_OFFSET + 0x09);
65: IBaseToken constant BASE_TOKEN_SYSTEM_CONTRACT = IBaseToken(address(SYSTEM_CONTRACTS_OFFSET + 0x0a));
66: IBaseToken constant REAL_BASE_TOKEN_SYSTEM_CONTRACT = IBaseToken(address(REAL_SYSTEM_CONTRACTS_OFFSET + 0x0a));
71: address constant KECCAK256_SYSTEM_CONTRACT = address(0x8010);
73: ISystemContext constant SYSTEM_CONTEXT_CONTRACT = ISystemContext(payable(address(SYSTEM_CONTRACTS_OFFSET + 0x0b)));
74: ISystemContext constant REAL_SYSTEM_CONTEXT_CONTRACT = ISystemContext(payable(address(REAL_SYSTEM_CONTRACTS_OFFSET + 0x0b)));
76: IBootloaderUtilities constant BOOTLOADER_UTILITIES = IBootloaderUtilities(address(SYSTEM_CONTRACTS_OFFSET + 0x0c));
79: address constant EVENT_WRITER_CONTRACT = address(SYSTEM_CONTRACTS_OFFSET + 0x0d);
81: ICompressor constant COMPRESSOR_CONTRACT = ICompressor(address(SYSTEM_CONTRACTS_OFFSET + 0x0e));
83: IComplexUpgrader constant COMPLEX_UPGRADER_CONTRACT = IComplexUpgrader(address(SYSTEM_CONTRACTS_OFFSET + 0x0f));
85: IPubdataChunkPublisher constant PUBDATA_CHUNK_PUBLISHER = IPubdataChunkPublisher(
    address(SYSTEM_CONTRACTS_OFFSET + 0x11)
);
91: uint256 constant MSG_VALUE_SIMULATOR_IS_SYSTEM_BIT = 1;
94: uint256 constant MAX_MSG_VALUE = 2 ** 128 - 1;
98: bytes32 constant CREATE2_PREFIX = 0x2020dba91b30cc0006188af794c2fb30dd8520db7e2c088b7fc7c103c00ca494;
101: bytes32 constant CREATE_PREFIX = 0x63bae3a9951d38e8a3fbb7b70909afc1200610fc5bc55ade242f815974674f23;
104: uint256 constant STATE_DIFF_ENTRY_SIZE = 272;
108: uint256 constant MAX_ALLOWED_PUBDATA_PER_BATCH = 520000;
125: uint256 constant L2_TO_L1_LOGS_MERKLE_TREE_LEAVES = 4096;
128: uint256 constant DERIVED_KEY_LENGTH = 32;
130: uint256 constant ENUM_INDEX_LENGTH = 8;
132: uint256 constant VALUE_LENGTH = 32;
135: uint256 constant COMPRESSED_INITIAL_WRITE_SIZE = DERIVED_KEY_LENGTH + VALUE_LENGTH;
137: uint256 constant COMPRESSED_REPEATED_WRITE_SIZE = ENUM_INDEX_LENGTH + VALUE_LENGTH;
140: uint256 constant INITIAL_WRITE_STARTING_POSITION = 4;
145: uint256 constant STATE_DIFF_DERIVED_KEY_OFFSET = 52;
147: uint256 constant STATE_DIFF_ENUM_INDEX_OFFSET = 84;
149: uint256 constant STATE_DIFF_FINAL_VALUE_OFFSET = 124;
154: uint256 constant BLOB_SIZE_BYTES = 126_976;
157: uint256 constant MAX_NUMBER_OF_BLOBS = 2;
```
[25](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L25) | [29](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L29) | [31](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L31) | [32](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L32) | [33](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L33) | [34](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L34) | [41](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L41) | [46](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L46) | [48](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L48) | [49](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L49) | [52](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L52) | [53](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L53) | [54](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L54) | [57](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L57) | [61](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L61) | [62](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L62) | [63](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L63) | [65](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L65) | [66](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L66) | [71](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L71) | [73](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L73) | [74](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L74) | [76](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L76) | [79](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L79) | [81](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L81) | [83](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L83) | [85](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L85) | [91](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L91) | [94](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L94) | [98](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L98) | [101](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L101) | [104](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L104) | [108](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L108) | [125](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L125) | [128](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L128) | [130](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L130) | [132](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L132) | [135](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L135) | [137](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L137) | [140](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L140) | [145](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L145) | [147](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L147) | [149](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L149) | [154](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L154) | [157](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L157)

```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

26: mapping(address => AccountInfo) internal accountInfo;
```
[26](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L26)

```solidity
File: code/system-contracts/contracts/ImmutableSimulator.sol

21: mapping(uint256 contractAddress => mapping(uint256 index => bytes32 value)) internal immutableDataStorage;
```
[21](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ImmutableSimulator.sol#L21)

```solidity
File: code/system-contracts/contracts/L1Messenger.sol

28: bytes32 internal chainedLogsHash;
32: uint256 internal numberOfLogsToProcess;
36: bytes32 internal chainedMessagesHash;
41: bytes32 internal chainedL1BytecodesRevealDataHash;
44: uint256 internal constant KECCAK_ROUND_GAS_COST = 40;
47: uint256 internal constant KECCAK_ROUND_NUMBER_OF_BYTES = 136;
55: uint256 internal constant SHA256_ROUND_GAS_COST = 7;
58: uint256 internal constant SHA256_ROUND_NUMBER_OF_BYTES = 64;
```
[28](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L28) | [32](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L32) | [36](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L36) | [41](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L41) | [44](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L44) | [47](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L47) | [55](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L55) | [58](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L58)

```solidity
File: code/system-contracts/contracts/L2BaseToken.sol

20: mapping(address account => uint256 balance) internal balance;
```
[20](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L2BaseToken.sol#L20)

```solidity
File: code/system-contracts/contracts/MsgValueSimulator.sol

36: uint256 constant GAS_TO_PASS = 2300;
41: uint256 constant MSG_VALUE_SIMULATOR_STIPEND_GAS = 27000;
```
[36](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/MsgValueSimulator.sol#L36) | [41](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/MsgValueSimulator.sol#L41)

```solidity
File: code/system-contracts/contracts/NonceHolder.sol

28: uint256 private constant DEPLOY_NONCE_MULTIPLIER = 2 ** 128;
31: uint256 private constant MAXIMAL_MIN_NONCE_INCREMENT = 2 ** 32;
36: mapping(uint256 account => uint256 packedMinAndDeploymentNonce) internal rawNonces;
41: mapping(uint256 account => mapping(uint256 nonceKey => uint256 value)) internal nonceValues;
```
[28](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L28) | [31](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L31) | [36](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L36) | [41](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L41)

```solidity
File: code/system-contracts/contracts/SystemContext.sol

23: uint256 internal constant MINIBLOCK_HASHES_TO_STORE = 257;
51: BlockInfo internal currentBatchInfo;
55: mapping(uint256 batchNumber => bytes32 batchHash) internal batchHashes;
58: BlockInfo internal currentL2BlockInfo;
61: bytes32 internal currentL2BlockTxsRollingHash;
70: bytes32[MINIBLOCK_HASHES_TO_STORE] internal l2BlockHash;
77: BlockInfo internal currentVirtualL2BlockInfo;
80: VirtualBlockUpgradeInfo internal virtualBlockUpgradeInfo;
95: uint256 internal basePubdataSpent;
```
[23](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L23) | [51](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L51) | [55](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L55) | [58](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L58) | [61](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L61) | [70](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L70) | [77](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L77) | [80](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L80) | [95](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L95)

```solidity
File: code/system-contracts/contracts/GasBoundCaller.sol

18: uint256 constant CALL_ENTRY_OVERHEAD = 800;
21: uint256 constant CALL_RETURN_OVERHEAD = 200;
```
[18](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/GasBoundCaller.sol#L18) | [21](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/GasBoundCaller.sol#L21)

```solidity
File: code/system-contracts/contracts/libraries/SystemContractHelper.sol

9: uint256 constant UINT32_MASK = type(uint32).max;
10: uint256 constant UINT64_MASK = type(uint64).max;
11: uint256 constant UINT128_MASK = type(uint128).max;
12: uint256 constant ADDRESS_MASK = type(uint160).max;
```
[9](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L9) | [10](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L10) | [11](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L11) | [12](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L12)

```solidity
File: code/system-contracts/contracts/libraries/SystemContractsCaller.sol

12: address constant TO_L1_CALL_ADDRESS = address((1 << 16) - 1);
13: address constant CODE_ADDRESS_CALL_ADDRESS = address((1 << 16) - 2);
14: address constant PRECOMPILE_CALL_ADDRESS = address((1 << 16) - 3);
15: address constant META_CALL_ADDRESS = address((1 << 16) - 4);
16: address constant MIMIC_CALL_CALL_ADDRESS = address((1 << 16) - 5);
17: address constant SYSTEM_MIMIC_CALL_CALL_ADDRESS = address((1 << 16) - 6);
18: address constant MIMIC_CALL_BY_REF_CALL_ADDRESS = address((1 << 16) - 7);
19: address constant SYSTEM_MIMIC_CALL_BY_REF_CALL_ADDRESS = address((1 << 16) - 8);
20: address constant RAW_FAR_CALL_CALL_ADDRESS = address((1 << 16) - 9);
21: address constant RAW_FAR_CALL_BY_REF_CALL_ADDRESS = address((1 << 16) - 10);
22: address constant SYSTEM_CALL_CALL_ADDRESS = address((1 << 16) - 11);
23: address constant SYSTEM_CALL_BY_REF_CALL_ADDRESS = address((1 << 16) - 12);
24: address constant SET_CONTEXT_VALUE_CALL_ADDRESS = address((1 << 16) - 13);
25: address constant SET_PUBDATA_PRICE_CALL_ADDRESS = address((1 << 16) - 14);
26: address constant INCREMENT_TX_COUNTER_CALL_ADDRESS = address((1 << 16) - 15);
27: address constant PTR_CALLDATA_CALL_ADDRESS = address((1 << 16) - 16);
28: address constant CALLFLAGS_CALL_ADDRESS = address((1 << 16) - 17);
29: address constant PTR_RETURNDATA_CALL_ADDRESS = address((1 << 16) - 18);
30: address constant EVENT_INITIALIZE_ADDRESS = address((1 << 16) - 19);
31: address constant EVENT_WRITE_ADDRESS = address((1 << 16) - 20);
32: address constant LOAD_CALLDATA_INTO_ACTIVE_PTR_CALL_ADDRESS = address((1 << 16) - 21);
33: address constant LOAD_LATEST_RETURNDATA_INTO_ACTIVE_PTR_CALL_ADDRESS = address((1 << 16) - 22);
34: address constant PTR_ADD_INTO_ACTIVE_CALL_ADDRESS = address((1 << 16) - 23);
35: address constant PTR_SHRINK_INTO_ACTIVE_CALL_ADDRESS = address((1 << 16) - 24);
36: address constant PTR_PACK_INTO_ACTIVE_CALL_ADDRESS = address((1 << 16) - 25);
37: address constant MULTIPLICATION_HIGH_ADDRESS = address((1 << 16) - 26);
38: address constant GET_EXTRA_ABI_DATA_ADDRESS = address((1 << 16) - 27);
41: uint256 constant META_GAS_PER_PUBDATA_BYTE_OFFSET = 0 * 8;
42: uint256 constant META_HEAP_SIZE_OFFSET = 8 * 8;
43: uint256 constant META_AUX_HEAP_SIZE_OFFSET = 12 * 8;
44: uint256 constant META_SHARD_ID_OFFSET = 28 * 8;
45: uint256 constant META_CALLER_SHARD_ID_OFFSET = 29 * 8;
46: uint256 constant META_CODE_SHARD_ID_OFFSET = 30 * 8;
```
[12](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L12) | [13](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L13) | [14](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L14) | [15](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L15) | [16](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L16) | [17](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L17) | [18](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L18) | [19](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L19) | [20](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L20) | [21](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L21) | [22](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L22) | [23](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L23) | [24](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L24) | [25](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L25) | [26](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L26) | [27](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L27) | [28](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L28) | [29](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L29) | [30](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L30) | [31](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L31) | [32](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L32) | [33](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L33) | [34](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L34) | [35](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L35) | [36](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L36) | [37](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L37) | [38](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L38) | [41](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L41) | [42](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L42) | [43](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L43) | [44](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L44) | [45](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L45) | [46](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L46)

```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

15: uint8 constant EIP_712_TX_TYPE = 0x71;
18: uint8 constant LEGACY_TX_TYPE = 0x0;
20: uint8 constant EIP_2930_TX_TYPE = 0x01;
22: uint8 constant EIP_1559_TX_TYPE = 0x02;
82: bytes32 constant EIP712_DOMAIN_TYPEHASH = keccak256("EIP712Domain(string name,string version,uint256 chainId)");
84: bytes32 constant EIP712_TRANSACTION_TYPE_HASH =
        keccak256(
            "Transaction(uint256 txType,uint256 from,uint256 to,uint256 gasLimit,uint256 gasPerPubdataByteLimit,uint256 maxFeePerGas,uint256 maxPriorityFeePerGas,uint256 paymaster,uint256 nonce,uint256 value,bytes data,bytes32[] factoryDeps,bytes paymasterInput)"
        );
```
[15](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L15) | [18](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L18) | [20](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L20) | [22](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L22) | [82](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L82) | [84](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L84)

```solidity
File: code/system-contracts/contracts/libraries/Utils.sol

13: bytes32 constant IS_CONSTRUCTOR_BYTECODE_HASH_BIT_MASK =
        0x00ff000000000000000000000000000000000000000000000000000000000000;
17: bytes32 constant SET_IS_CONSTRUCTOR_MARKER_BIT_MASK =
        0x0001000000000000000000000000000000000000000000000000000000000000;
```
[13](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L13) | [17](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L17)

```solidity
File: code/system-contracts/contracts/interfaces/IAccount.sol

7: bytes4 constant ACCOUNT_VALIDATION_SUCCESS_MAGIC = IAccount.validateTransaction.selector;
```
[7](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IAccount.sol#L7)

```solidity
File: code/system-contracts/contracts/interfaces/ICompressor.sol

6: uint8 constant OPERATION_BITMASK = 7;
8: uint8 constant LENGTH_BITS_OFFSET = 3;
10: uint8 constant MAX_ENUMERATION_INDEX_SIZE = 8;
```
[6](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/ICompressor.sol#L6) | [8](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/ICompressor.sol#L8) | [10](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/ICompressor.sol#L10)

```solidity
File: code/system-contracts/contracts/interfaces/IL1Messenger.sol

25: uint256 constant L2_TO_L1_LOG_SERIALIZE_SIZE = 88;
30: bytes32 constant L2_L1_LOGS_TREE_DEFAULT_LEAF_HASH = 0x72abee45b59e344af8a6e520241c4744aff26ed411f4c4b00f8af09adada43ba;
33: uint256 constant STATE_DIFF_COMPRESSION_VERSION_NUMBER = 1;
```
[25](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IL1Messenger.sol#L25) | [30](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IL1Messenger.sol#L30) | [33](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IL1Messenger.sol#L33)

```solidity
File: code/system-contracts/contracts/interfaces/IPaymaster.sol

12: bytes4 constant PAYMASTER_VALIDATION_SUCCESS_MAGIC = IPaymaster.validateAndPayForPaymasterTransaction.selector;
```
[12](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IPaymaster.sol#L12)

```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

32: bytes32 internal l2TokenProxyBytecodeHash;
37: address private l1LegacyBridge;
```
[32](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L32) | [37](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L37)

```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

26: ERC20Getters private availableGetters;
31: uint8 private decimals_;
```
[26](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L26) | [31](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L31)

```solidity
File: code/contracts/zksync/contracts/interfaces/IPaymaster.sol

12: bytes4 constant PAYMASTER_VALIDATION_SUCCESS_MAGIC = IPaymaster.validateAndPayForPaymasterTransaction.selector;
```
[12](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/interfaces/IPaymaster.sol#L12)

```solidity
File: code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol

22: uint160 constant offset = uint160(0x1111000000000000000000000000000000001111);
```
[22](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol#L22)

```solidity
File: code/contracts/zksync/contracts/L2ContractHelper.sol

68: uint160 constant SYSTEM_CONTRACTS_OFFSET = 0x8000; // 2^15
70: address constant BOOTLOADER_ADDRESS = address(SYSTEM_CONTRACTS_OFFSET + 0x01);
71: address constant MSG_VALUE_SYSTEM_CONTRACT = address(SYSTEM_CONTRACTS_OFFSET + 0x09);
72: address constant DEPLOYER_SYSTEM_CONTRACT = address(SYSTEM_CONTRACTS_OFFSET + 0x06);
74: IL2Messenger constant L2_MESSENGER = IL2Messenger(address(SYSTEM_CONTRACTS_OFFSET + 0x08));
76: IBaseToken constant L2_BASE_TOKEN_ADDRESS = IBaseToken(address(SYSTEM_CONTRACTS_OFFSET + 0x0a));
85: bytes32 private constant CREATE2_PREFIX = keccak256("zksyncCreate2");
```
[68](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/L2ContractHelper.sol#L68) | [70](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/L2ContractHelper.sol#L70) | [71](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/L2ContractHelper.sol#L71) | [72](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/L2ContractHelper.sol#L72) | [74](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/L2ContractHelper.sol#L74) | [76](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/L2ContractHelper.sol#L76) | [85](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/L2ContractHelper.sol#L85)

```solidity
File: code/contracts/zksync/contracts/SystemContractsCaller.sol

7: address constant SYSTEM_CALL_CALL_ADDRESS = address((1 << 16) - 11);
10: uint256 constant MSG_VALUE_SIMULATOR_IS_SYSTEM_BIT = 1;
```
[7](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/SystemContractsCaller.sol#L7) | [10](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/SystemContractsCaller.sol#L10)
</details>

### [N-84] Use type(uint<n>).max instead of 2**<n> - 1

When specifying the maximum value for a uint variable in Solidity, it's recommended to use `type(uint<n>).max` instead of `2**<n> - 1`.
This syntax is more explicit, easier to understand, and less error-prone.
Moreover, it enhances code readability and maintainability by clearly conveying the developer's intent.

<details>
<summary><i>1 issue instances in 1 files:</i></summary>

```solidity
File: code/system-contracts/contracts/Constants.sol

94: uint256 constant MAX_MSG_VALUE = 2 ** 128 - 1;
```
[94](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L94)
</details>

### [N-85] Style guide: Contract does not follow the Solidity style guide's suggested layout ordering

Adhering to a recommended order in Solidity contracts enhances code readability and maintenance.
[More information in Documentation](https://docs.soliditylang.org/en/latest/style-guide.html#order-of-layout)
It's recommended to use the following order:
1. Type declarations
2. State variables
3. Events
4. Errors
5. Modifiers
6. Functions

<details>
<summary><i>12 issue instances in 11 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

/// @audit `type` declared after `function`
400: struct MessageParams {
        uint256 l2BatchNumber;
        uint256 l2MessageIndex;
        uint16 l2TxNumberInBatch;
    }
```
[400](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L400)

```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

/// @audit `modifier` declared after `function`
44: modifier onlyOwnerOrAdmin() {
```
[44](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L44)

```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

/// @audit `modifier` declared after `constructor`
58: modifier onlySelf() {
```
[58](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L58)

```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

/// @audit `modifier` declared after `constructor`
63: modifier onlyBridgehub() {
```
[63](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L63)

```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

/// @audit `state variable` declared after `error`
44: IStateTransitionManager public stateTransitionManager;
/// @audit `modifier` declared after `constructor`
61: modifier onlyChainAdmin(uint256 _chainId) {
```
[44](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L44) | [61](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L61)

```solidity
File: code/contracts/ethereum/contracts/common/ReentrancyGuard.sol

/// @audit `modifier` declared after `function`
68: modifier nonReentrant() {
```
[68](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/ReentrancyGuard.sol#L68)

```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

/// @audit `type` declared after `function`
197: struct ForceDeployment {
        // The bytecode hash to put on an address
        bytes32 bytecodeHash;
        // The address on which to deploy the bytecodehash to
        address newAddress;
        // Whether to run the constructor on the force deployment
        bool callConstructor;
        // The value with which to initialize a contract
        uint256 value;
        // The constructor calldata
        bytes input;
    }
```
[197](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L197)

```solidity
File: code/system-contracts/contracts/L1Messenger.sol

/// @audit `state variable` declared after `function`
55: uint256 internal constant SHA256_ROUND_GAS_COST = 7;
```
[55](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L55)

```solidity
File: code/system-contracts/contracts/MsgValueSimulator.sol

/// @audit `state variable` declared after `function`
36: uint256 constant GAS_TO_PASS = 2300;
```
[36](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/MsgValueSimulator.sol#L36)

```solidity
File: code/system-contracts/contracts/SystemContext.sol

/// @audit `state variable` declared after `function`
89: uint16 public txNumberInBlock;
```
[89](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L89)

```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

/// @audit `modifier` declared after `function`
128: modifier onlyBridge() {
```
[128](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L128)
</details>

### [N-86] Style guide: Control structures do not follow the Solidity Style Guide

Following best practices for control structures in solidity code is vital for readability and maintainability. The control structures in contracts, libraries, functions, and structs should adhere to the following standards:

- Braces denoting the body should open on the same line as the declaration and close on their own line at the same indentation level as the beginning of the declaration. 
- A single space should precede the opening brace. 
- Control structures such as 'if', 'else', 'while', and 'for' should also follow these spacing and brace placement recommendations.

It is advised to revisit the [control structures](https://docs.soliditylang.org/en/latest/style-guide.html#control-structures) sections in documentation to ensure conformity with these best practices, fostering cleaner and more maintainable code.

<details>
<summary><i>3 issue instances in 1 files:</i></summary>

```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

/// @audit `Return or revert statement should be on new line.`
161: if (availableGetters.ignoreName) revert();
/// @audit `Return or revert statement should be on new line.`
167: if (availableGetters.ignoreSymbol) revert();
/// @audit `Return or revert statement should be on new line.`
173: if (availableGetters.ignoreDecimals) revert();
```
[161](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L161) | [167](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L167) | [173](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L173)
</details>

### [N-87] Using Low-Level Call for Transfers

Directly using low-level calls for Ether transfers can introduce vulnerabilities and obscure the intent of your transfers.
Adopt modern Solidity best practices by switching to recognized libraries like `SafeTransferLib.safeTransferETH` or `Address.sendValue`.
This ensures safer transactions, enhances code clarity, and aligns with the standards of the Solidity community.

<details>
<summary><i>1 issue instances in 1 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

226: (bool success, bytes memory returnData) = _calls[i].target.call{value: _calls[i].value}(_calls[i].data);
```
[226](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L226)
</details>

### [N-88] Consider bounding input array length

The functions in question operate on arrays without established boundaries, executing function calls for each of their entries.
If these arrays become excessively long, a function might revert due to gas constraints.
To enhance user experience, consider incorporating a `require()` statement that enforces a sensible maximum array length.
This approach can avoid unnecessary computational work and ensure smoother transactions.

<details>
<summary><i>9 issue instances in 5 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

/// @audit `_calls` is a function array parameter and `_calls.length` is not bounded
225: for (uint256 i = 0; i < _calls.length; ++i) {
```
[225](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L225)

```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

/// @audit `_newBatchesData` is a function array parameter and `_newBatchesData.length` is not bounded
116: for (uint256 i = 0; i < _newBatchesData.length; ++i) {
/// @audit `_newBatchesData` is a function array parameter and `_newBatchesData.length` is not bounded
135: for (uint256 i = 0; i < _newBatchesData.length; ++i) {
/// @audit `_newBatchesData` is a function array parameter and `_newBatchesData.length` is not bounded
185: for (uint256 i = 0; i < _newBatchesData.length; ++i) {
/// @audit `_newBatchesData` is a function array parameter and `_newBatchesData.length` is not bounded
209: for (uint256 i = 0; i < _newBatchesData.length; ++i) {
```
[116](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L116) | [135](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L135) | [185](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L185) | [209](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L209)

```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

/// @audit `deploymentsLength` equal to `_deployments.length` and it not bounded
248: for (uint256 i = 0; i < deploymentsLength; ++i) {
/// @audit `deploymentsLength` equal to `_deployments.length` and it not bounded
253: for (uint256 i = 0; i < deploymentsLength; ++i) {
```
[248](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L248) | [253](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L253)

```solidity
File: code/system-contracts/contracts/ImmutableSimulator.sol

/// @audit `immutablesLength` equal to `_immutables.length` and it not bounded
38: for (uint256 i = 0; i < immutablesLength; ++i) {
```
[38](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ImmutableSimulator.sol#L38)

```solidity
File: code/system-contracts/contracts/KnownCodesStorage.sol

/// @audit `hashesLen` equal to `_hashes.length` and it not bounded
30: for (uint256 i = 0; i < hashesLen; ++i) {
```
[30](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/KnownCodesStorage.sol#L30)
</details>

### [N-89] NatSpec: Function declarations should have `@notice` tag

In Solidity, the `@notice` tag in NatSpec comments is used to provide important explanations to end users about what a function does. 
It appears that this contract's function declarations are missing `@notice` tags in their NatSpec annotations.

The absence of `@notice` tags reduces the contract's transparency and could lead to misunderstandings about a function's purpose and behavior.
Note that the Solidity compiler treats comments beginning with `///` or `/**` as `@notice` tags if one wasn't explicitly provided.
[Learn More About NatSpec Guidelines](https://docs.soliditylang.org/en/develop/natspec-format.html)

<details>
<summary><i>285 issue instances in 53 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

55: constructor(IL1SharedBridge _sharedBridge) reentrancyGuardInitializer {
60: function initialize() external reentrancyGuardInitializer {}
63: function tranferTokenToSharedBridge(address _token, uint256 _amount) external {
75: function l2TokenAddress(address _l1Token) external view returns (address) {
176: function claimFailedDeposit(
        address _depositSender,
        address _l1Token,
        bytes32 _l2TxHash,
        uint256 _l2BatchNumber,
        uint256 _l2MessageIndex,
        uint16 _l2TxNumberInBatch,
        bytes32[] calldata _merkleProof
    ) external nonReentrant {
55: constructor(IL1SharedBridge _sharedBridge) reentrancyGuardInitializer {
60: function initialize() external reentrancyGuardInitializer {}
63: function tranferTokenToSharedBridge(address _token, uint256 _amount) external {
75: function l2TokenAddress(address _l1Token) external view returns (address) {
176: function claimFailedDeposit(
        address _depositSender,
        address _l1Token,
        bytes32 _l2TxHash,
        uint256 _l2BatchNumber,
        uint256 _l2MessageIndex,
        uint16 _l2TxNumberInBatch,
        bytes32[] calldata _merkleProof
    ) external nonReentrant {
```
[55](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L55) | [60](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L60) | [63](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L63) | [75](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L75) | [176](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L176) | [55](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L55) | [60](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L60) | [63](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L63) | [75](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L75) | [176](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L176)

```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

90: constructor(
        address _l1WethAddress,
        IBridgehub _bridgehub,
        IL1ERC20Bridge _legacyBridge
    ) reentrancyGuardInitializer {
104: function initialize(
        address _owner,
        uint256 _eraFirstPostUpgradeBatch
    ) external reentrancyGuardInitializer initializer {
116: function transferFundsFromLegacy(address _token, address _target, uint256 _targetChainId) external onlyOwner {
137: function receiveEth(uint256 _chainId) external payable {
142: function initializeChainGovernance(uint256 _chainId, address _l2BridgeAddress) external onlyOwner {
277: function claimFailedDeposit(
        uint256 _chainId,
        address _depositSender,
        address _l1Token,
        uint256 _amount,
        bytes32 _l2TxHash,
        uint256 _l2BatchNumber,
        uint256 _l2MessageIndex,
        uint16 _l2TxNumberInBatch,
        bytes32[] calldata _merkleProof
    ) external override {
```
[90](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L90) | [104](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L104) | [116](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L116) | [137](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L137) | [142](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L142) | [277](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L277)

```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

84: function isOperation(bytes32 _id) public view returns (bool) {
89: function isOperationPending(bytes32 _id) public view returns (bool) {
95: function isOperationReady(bytes32 _id) public view returns (bool) {
100: function isOperationDone(bytes32 _id) public view returns (bool) {
105: function getOperationState(bytes32 _id) public view returns (OperationState) {
154: function cancel(bytes32 _id) external onlyOwner {
204: function hashOperation(Operation calldata _operation) public pure returns (bytes32) {
249: function updateDelay(uint256 _newDelay) external onlySelf {
256: function updateSecurityCouncil(address _newSecurityCouncil) external onlySelf {
```
[84](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L84) | [89](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L89) | [95](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L95) | [100](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L100) | [105](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L105) | [154](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L154) | [204](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L204) | [249](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L249) | [256](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L256)

```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

58: constructor(address _bridgehub) reentrancyGuardInitializer {
74: function getChainAdmin(uint256 _chainId) external view override returns (address) {
79: function initialize(
        StateTransitionManagerInitializeData calldata _initializeData
    ) external reentrancyGuardInitializer {
132: function setValidatorTimelock(address _validatorTimelock) external onlyOwnerOrAdmin {
137: function setInitialCutHash(Diamond.DiamondCutData calldata _diamondCut) external onlyOwner {
142: function setNewVersionUpgrade(
        Diamond.DiamondCutData calldata _cutData,
        uint256 _oldProtocolVersion,
        uint256 _newProtocolVersion
    ) external onlyOwner {
152: function setUpgradeDiamondCut(
        Diamond.DiamondCutData calldata _cutData,
        uint256 _oldProtocolVersion
    ) external onlyOwner {
160: function freezeChain(uint256 _chainId) external onlyOwner {
165: function unfreezeChain(uint256 _chainId) external onlyOwner {
170: function revertBatches(uint256 _chainId, uint256 _newLastBatch) external onlyOwnerOrAdmin {
230: function registerAlreadyDeployedStateTransition(
        uint256 _chainId,
        address _stateTransitionContract
    ) external onlyOwner {
```
[58](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L58) | [74](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L74) | [79](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L79) | [132](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L132) | [137](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L137) | [142](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L142) | [152](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L152) | [160](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L160) | [165](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L165) | [170](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L170) | [230](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L230)

```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

55: constructor(address _initialOwner, uint32 _executionDelay) {
73: function setStateTransitionManager(IStateTransitionManager _stateTransitionManager) external onlyOwner {
78: function addValidator(uint256 _chainId, address _newValidator) external onlyChainAdmin(_chainId) {
87: function removeValidator(uint256 _chainId, address _validator) external onlyChainAdmin(_chainId) {
96: function setExecutionDelay(uint32 _executionDelay) external onlyOwner {
102: function getCommittedBatchTimestamp(uint256 _chainId, uint256 _l2BatchNumber) external view returns (uint256) {
108: function commitBatches(
        StoredBatchInfo calldata,
        CommitBatchInfo[] calldata _newBatchesData
    ) external onlyValidator(ERA_CHAIN_ID) {
126: function commitBatchesSharedBridge(
        uint256 _chainId,
        StoredBatchInfo calldata,
        CommitBatchInfo[] calldata _newBatchesData
    ) external onlyValidator(_chainId) {
146: function revertBatches(uint256) external onlyValidator(ERA_CHAIN_ID) {
153: function revertBatchesSharedBridge(uint256 _chainId, uint256) external onlyValidator(_chainId) {
160: function proveBatches(
        StoredBatchInfo calldata,
        StoredBatchInfo[] calldata,
        ProofInput calldata
    ) external onlyValidator(ERA_CHAIN_ID) {
171: function proveBatchesSharedBridge(
        uint256 _chainId,
        StoredBatchInfo calldata,
        StoredBatchInfo[] calldata,
        ProofInput calldata
    ) external onlyValidator(_chainId) {
182: function executeBatches(StoredBatchInfo[] calldata _newBatchesData) external onlyValidator(ERA_CHAIN_ID) {
203: function executeBatchesSharedBridge(
        uint256 _chainId,
        StoredBatchInfo[] calldata _newBatchesData
    ) external onlyValidator(_chainId) {
```
[55](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L55) | [73](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L73) | [78](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L78) | [87](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L87) | [96](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L96) | [102](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L102) | [108](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L108) | [126](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L126) | [146](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L146) | [153](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L153) | [160](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L160) | [171](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L171) | [182](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L182) | [203](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L203)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol

19: constructor() reentrancyGuardInitializer {}
```
[19](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol#L19)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol

11: constructor(uint256 _chainId, Diamond.DiamondCutData memory _diamondCut) {
```
[11](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol#L11)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol

89: function setValidiumMode(PubdataPricingMode _validiumMode) external onlyAdmin {
100: function upgradeChainFromVersion(
        uint256 _oldProtocolVersion,
        Diamond.DiamondCutData calldata _diamondCut
    ) external onlyAdminOrStateTransitionManager {
```
[89](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L89) | [100](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L100)

```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol

24: function isWithdrawalFinalized(uint256 _l2BatchNumber, uint256 _l2MessageIndex) external view returns (bool);
26: function deposit(
        address _l2Receiver,
        address _l1Token,
        uint256 _amount,
        uint256 _l2TxGasLimit,
        uint256 _l2TxGasPerPubdataByte,
        address _refundRecipient
    ) external payable returns (bytes32 txHash);
35: function deposit(
        address _l2Receiver,
        address _l1Token,
        uint256 _amount,
        uint256 _l2TxGasLimit,
        uint256 _l2TxGasPerPubdataByte
    ) external payable returns (bytes32 txHash);
43: function claimFailedDeposit(
        address _depositSender,
        address _l1Token,
        bytes32 _l2TxHash,
        uint256 _l2BatchNumber,
        uint256 _l2MessageIndex,
        uint16 _l2TxNumberInBatch,
        bytes32[] calldata _merkleProof
    ) external;
53: function finalizeWithdrawal(
        uint256 _l2BatchNumber,
        uint256 _l2MessageIndex,
        uint16 _l2TxNumberInBatch,
        bytes calldata _message,
        bytes32[] calldata _merkleProof
    ) external;
61: function l2TokenAddress(address _l1Token) external view returns (address);
63: function sharedBridge() external view returns (IL1SharedBridge);
65: function l2TokenBeacon() external view returns (address);
67: function l2Bridge() external view returns (address);
69: function depositAmount(
        address _account,
        address _l1Token,
        bytes32 _depositL2TxHash
    ) external returns (uint256 amount);
75: function tranferTokenToSharedBridge(address _token, uint256 _amount) external;
```
[24](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L24) | [26](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L26) | [35](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L35) | [43](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L43) | [53](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L53) | [61](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L61) | [63](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L63) | [65](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L65) | [67](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L67) | [69](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L69) | [75](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L75)

```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol

58: function isWithdrawalFinalized(
        uint256 _chainId,
        uint256 _l2BatchNumber,
        uint256 _l2MessageIndex
    ) external view returns (bool);
64: function depositLegacyErc20Bridge(
        address _msgSender,
        address _l2Receiver,
        address _l1Token,
        uint256 _amount,
        uint256 _l2TxGasLimit,
        uint256 _l2TxGasPerPubdataByte,
        address _refundRecipient
    ) external payable returns (bytes32 txHash);
74: function claimFailedDepositLegacyErc20Bridge(
        address _depositSender,
        address _l1Token,
        uint256 _amount,
        bytes32 _l2TxHash,
        uint256 _l2BatchNumber,
        uint256 _l2MessageIndex,
        uint16 _l2TxNumberInBatch,
        bytes32[] calldata _merkleProof
    ) external;
85: function claimFailedDeposit(
        uint256 _chainId,
        address _depositSender,
        address _l1Token,
        uint256 _amount,
        bytes32 _l2TxHash,
        uint256 _l2BatchNumber,
        uint256 _l2MessageIndex,
        uint16 _l2TxNumberInBatch,
        bytes32[] calldata _merkleProof
    ) external;
97: function finalizeWithdrawalLegacyErc20Bridge(
        uint256 _l2BatchNumber,
        uint256 _l2MessageIndex,
        uint16 _l2TxNumberInBatch,
        bytes calldata _message,
        bytes32[] calldata _merkleProof
    ) external returns (address l1Receiver, address l1Token, uint256 amount);
105: function finalizeWithdrawal(
        uint256 _chainId,
        uint256 _l2BatchNumber,
        uint256 _l2MessageIndex,
        uint16 _l2TxNumberInBatch,
        bytes calldata _message,
        bytes32[] calldata _merkleProof
    ) external;
114: function l1WethAddress() external view returns (address);
116: function bridgehub() external view returns (IBridgehub);
118: function legacyBridge() external view returns (IL1ERC20Bridge);
120: function l2BridgeAddress(uint256 _chainId) external view returns (address);
122: function depositHappened(uint256 _chainId, bytes32 _l2TxHash) external view returns (bytes32);
128: function bridgehubDeposit(
        uint256 _chainId,
        address _prevMsgSender,
        uint256 _l2Value,
        bytes calldata _data
    ) external payable returns (L2TransactionRequestTwoBridgesInner memory request);
135: function bridgehubDepositBaseToken(
        uint256 _chainId,
        address _prevMsgSender,
        address _l1Token,
        uint256 _amount
    ) external payable;
142: function bridgehubConfirmL2Transaction(uint256 _chainId, bytes32 _txDataHash, bytes32 _txHash) external;
144: function receiveEth(uint256 _chainId) external payable;
```
[58](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L58) | [64](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L64) | [74](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L74) | [85](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L85) | [97](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L97) | [105](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L105) | [114](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L114) | [116](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L116) | [118](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L118) | [120](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L120) | [122](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L122) | [128](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L128) | [135](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L135) | [142](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L142) | [144](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L144)

```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL2Bridge.sol

7: function finalizeDeposit(
        address _l1Sender,
        address _l2Receiver,
        address _l1Token,
        uint256 _amount,
        bytes calldata _data
    ) external payable;
15: function withdraw(address _l1Receiver, address _l2Token, uint256 _amount) external;
17: function l1TokenAddress(address _l2Token) external view returns (address);
19: function l2TokenAddress(address _l1Token) external view returns (address);
21: function l1Bridge() external view returns (address);
```
[7](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL2Bridge.sol#L7) | [15](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL2Bridge.sol#L15) | [17](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL2Bridge.sol#L17) | [19](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL2Bridge.sol#L19) | [21](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL2Bridge.sol#L21)

```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IWETH9.sol

5: function deposit() external payable;
7: function withdraw(uint256 wad) external;
```
[5](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IWETH9.sol#L5) | [7](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IWETH9.sol#L7)

```solidity
File: code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol

59: function stateTransitionManagerIsRegistered(address _stateTransitionManager) external view returns (bool);
61: function stateTransitionManager(uint256 _chainId) external view returns (address);
63: function tokenIsRegistered(address _baseToken) external view returns (bool);
65: function baseToken(uint256 _chainId) external view returns (address);
67: function sharedBridge() external view returns (IL1SharedBridge);
69: function getStateTransition(uint256 _chainId) external view returns (address);
73: function proveL2MessageInclusion(
        uint256 _chainId,
        uint256 _batchNumber,
        uint256 _index,
        L2Message calldata _message,
        bytes32[] calldata _proof
    ) external view returns (bool);
81: function proveL2LogInclusion(
        uint256 _chainId,
        uint256 _batchNumber,
        uint256 _index,
        L2Log memory _log,
        bytes32[] calldata _proof
    ) external view returns (bool);
89: function proveL1ToL2TransactionStatus(
        uint256 _chainId,
        bytes32 _l2TxHash,
        uint256 _l2BatchNumber,
        uint256 _l2MessageIndex,
        uint16 _l2TxNumberInBatch,
        bytes32[] calldata _merkleProof,
        TxStatus _status
    ) external view returns (bool);
99: function requestL2TransactionDirect(
        L2TransactionRequestDirect calldata _request
    ) external payable returns (bytes32 canonicalTxHash);
103: function requestL2TransactionTwoBridges(
        L2TransactionRequestTwoBridgesOuter calldata _request
    ) external payable returns (bytes32 canonicalTxHash);
107: function l2TransactionBaseCost(
        uint256 _chainId,
        uint256 _gasPrice,
        uint256 _l2GasLimit,
        uint256 _l2GasPerPubdataByteLimit
    ) external view returns (uint256);
116: function createNewChain(
        uint256 _chainId,
        address _stateTransitionManager,
        address _baseToken,
        uint256 _salt,
        address _admin,
        bytes calldata _initData
    ) external returns (uint256 chainId);
125: function addStateTransitionManager(address _stateTransitionManager) external;
127: function removeStateTransitionManager(address _stateTransitionManager) external;
129: function addToken(address _token) external;
131: function setSharedBridge(address _sharedBridge) external;
```
[59](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L59) | [61](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L61) | [63](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L63) | [65](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L65) | [67](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L67) | [69](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L69) | [73](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L73) | [81](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L81) | [89](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L89) | [99](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L99) | [103](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L103) | [107](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L107) | [116](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L116) | [125](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L125) | [127](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L127) | [129](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L129) | [131](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L131)

```solidity
File: code/contracts/ethereum/contracts/governance/IGovernance.sol

41: function isOperation(bytes32 _id) external view returns (bool);
43: function isOperationPending(bytes32 _id) external view returns (bool);
45: function isOperationReady(bytes32 _id) external view returns (bool);
47: function isOperationDone(bytes32 _id) external view returns (bool);
49: function getOperationState(bytes32 _id) external view returns (OperationState);
51: function scheduleTransparent(Operation calldata _operation, uint256 _delay) external;
53: function scheduleShadow(bytes32 _id, uint256 _delay) external;
55: function cancel(bytes32 _id) external;
57: function execute(Operation calldata _operation) external payable;
59: function executeInstant(Operation calldata _operation) external payable;
61: function hashOperation(Operation calldata _operation) external pure returns (bytes32);
63: function updateDelay(uint256 _newDelay) external;
65: function updateSecurityCouncil(address _newSecurityCouncil) external;
```
[41](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/IGovernance.sol#L41) | [43](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/IGovernance.sol#L43) | [45](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/IGovernance.sol#L45) | [47](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/IGovernance.sol#L47) | [49](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/IGovernance.sol#L49) | [51](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/IGovernance.sol#L51) | [53](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/IGovernance.sol#L53) | [55](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/IGovernance.sol#L55) | [57](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/IGovernance.sol#L57) | [59](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/IGovernance.sol#L59) | [61](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/IGovernance.sol#L61) | [63](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/IGovernance.sol#L63) | [65](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/IGovernance.sol#L65)

```solidity
File: code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol

43: function bridgehub() external view returns (address);
53: function stateTransition(uint256 _chainId) external view returns (address);
55: function storedBatchZero() external view returns (bytes32);
57: function initialCutHash() external view returns (bytes32);
59: function genesisUpgrade() external view returns (address);
61: function upgradeCutHash(uint256 _protocolVersion) external view returns (bytes32);
63: function protocolVersion() external view returns (uint256);
65: function initialize(StateTransitionManagerInitializeData calldata _initalizeData) external;
67: function setInitialCutHash(Diamond.DiamondCutData calldata _diamondCut) external;
69: function setValidatorTimelock(address _validatorTimelock) external;
71: function getChainAdmin(uint256 _chainId) external view returns (address);
82: function registerAlreadyDeployedStateTransition(uint256 _chainId, address _stateTransitionContract) external;
84: function setNewVersionUpgrade(
        Diamond.DiamondCutData calldata _cutData,
        uint256 _oldProtocolVersion,
        uint256 _newProtocolVersion
    ) external;
90: function setUpgradeDiamondCut(Diamond.DiamondCutData calldata _cutData, uint256 _oldProtocolVersion) external;
92: function freezeChain(uint256 _chainId) external;
94: function unfreezeChain(uint256 _chainId) external;
```
[43](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L43) | [53](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L53) | [55](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L55) | [57](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L57) | [59](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L59) | [61](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L61) | [63](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L63) | [65](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L65) | [67](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L67) | [69](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L69) | [71](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L71) | [82](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L82) | [84](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L84) | [90](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L90) | [92](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L92) | [94](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L94)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol

45: function upgradeChainFromVersion(uint256 _protocolVersion, Diamond.DiamondCutData calldata _cutData) external;
```
[45](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L45)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol

62: function initialize(InitializeData calldata _initData) external returns (bytes32);
```
[62](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol#L62)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol

19: function getVerifier() external view returns (address);
22: function getAdmin() external view returns (address);
25: function getPendingAdmin() external view returns (address);
28: function getBridgehub() external view returns (address);
31: function getStateTransitionManager() external view returns (address);
34: function getBaseToken() external view returns (address);
37: function getBaseTokenBridge() external view returns (address);
40: function getTotalBatchesCommitted() external view returns (uint256);
43: function getTotalBatchesVerified() external view returns (uint256);
46: function getTotalBatchesExecuted() external view returns (uint256);
49: function getTotalPriorityTxs() external view returns (uint256);
59: function getPriorityQueueSize() external view returns (uint256);
62: function priorityQueueFrontOperation() external view returns (PriorityOperation memory);
65: function isValidator(address _address) external view returns (bool);
68: function l2LogsRootHash(uint256 _batchNumber) external view returns (bytes32 merkleRoot);
76: function getL2BootloaderBytecodeHash() external view returns (bytes32);
79: function getL2DefaultAccountBytecodeHash() external view returns (bytes32);
82: function getVerifierParams() external view returns (VerifierParams memory);
85: function isDiamondStorageFrozen() external view returns (bool);
88: function getProtocolVersion() external view returns (uint256);
91: function getL2SystemContractsUpgradeTxHash() external view returns (bytes32);
98: function getL2SystemContractsUpgradeBatchNumber() external view returns (uint256);
101: function getPriorityTxMaxGasLimit() external view returns (uint256);
106: function isEthWithdrawalFinalized(uint256 _l2BatchNumber, uint256 _l2MessageIndex) external view returns (bool);
109: function getPubdataPricingMode() external view returns (PubdataPricingMode);
112: function baseTokenGasPriceMultiplierNominator() external view returns (uint128);
115: function baseTokenGasPriceMultiplierDenominator() external view returns (uint128);
130: function facets() external view returns (Facet[] memory);
133: function facetFunctionSelectors(address _facet) external view returns (bytes4[] memory);
136: function facetAddresses() external view returns (address[] memory facets);
139: function facetAddress(bytes4 _selector) external view returns (address facet);
142: function isFunctionFreezable(bytes4 _selector) external view returns (bool);
145: function isFacetFreezable(address _facet) external view returns (bool isFreezable);
```
[19](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L19) | [22](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L22) | [25](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L25) | [28](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L28) | [31](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L31) | [34](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L34) | [37](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L37) | [40](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L40) | [43](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L43) | [46](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L46) | [49](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L49) | [59](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L59) | [62](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L62) | [65](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L65) | [68](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L68) | [76](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L76) | [79](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L79) | [82](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L82) | [85](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L85) | [88](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L88) | [91](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L91) | [98](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L98) | [101](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L101) | [106](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L106) | [109](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L109) | [112](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L112) | [115](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L115) | [130](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L130) | [133](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L133) | [136](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L136) | [139](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L139) | [142](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L142) | [145](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L145)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/ILegacyGetters.sol

14: function getTotalBlocksCommitted() external view returns (uint256);
18: function getTotalBlocksVerified() external view returns (uint256);
22: function getTotalBlocksExecuted() external view returns (uint256);
36: function getL2SystemContractsUpgradeBlockNumber() external view returns (uint256);
```
[14](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/ILegacyGetters.sol#L14) | [18](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/ILegacyGetters.sol#L18) | [22](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/ILegacyGetters.sol#L22) | [36](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/ILegacyGetters.sol#L36)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol

98: function bridgehubRequestL2Transaction(
        BridgehubL2TransactionRequest calldata _request
    ) external payable returns (bytes32 canonicalTxHash);
```
[98](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L98)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IVerifier.sol

19: function verify(
        uint256[] calldata _publicInputs,
        uint256[] calldata _proof,
        uint256[] calldata _recursiveAggregationInput
    ) external view returns (bool);
```
[19](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IVerifier.sol#L19)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransitionBase.sol

9: function getName() external view returns (string memory);
```
[9](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransitionBase.sol#L9)

```solidity
File: code/contracts/ethereum/contracts/state-transition/l2-deps/ISystemContext.sol

5: function setChainId(uint256 _newChainId) external;
```
[5](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/l2-deps/ISystemContext.sol#L5)

```solidity
File: code/contracts/ethereum/contracts/upgrades/IDefaultUpgrade.sol

8: function upgrade(ProposedUpgrade calldata _upgrade) external returns (bytes32);
```
[8](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/IDefaultUpgrade.sol#L8)

```solidity
File: code/system-contracts/contracts/Compressor.sol

110: function verifyCompressedStateDiffs(
        uint256 _numberOfStateDiffs,
        uint256 _enumerationIndexSize,
        bytes calldata _stateDiffs,
        bytes calldata _compressedStateDiffs
    ) external payable onlyCallFrom(address(L1_MESSENGER_CONTRACT)) returns (bytes32 stateDiffHash) {
```
[110](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L110)

```solidity
File: code/system-contracts/contracts/L1Messenger.sol

161: function requestBytecodeL1Publication(
        bytes32 _bytecodeHash
    ) external override onlyCallFrom(address(KNOWN_CODE_STORAGE_CONTRACT)) {
194: function publishPubdataAndClearState(
        bytes calldata _totalL2ToL1PubdataAndStateDiffs
    ) external onlyCallFromBootloader {
```
[161](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L161) | [194](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L194)

```solidity
File: code/system-contracts/contracts/L2BaseToken.sol

128: function name() external pure override returns (string memory) {
134: function symbol() external pure override returns (string memory) {
140: function decimals() external pure override returns (uint8) {
```
[128](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L2BaseToken.sol#L128) | [134](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L2BaseToken.sol#L134) | [140](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L2BaseToken.sol#L140)

```solidity
File: code/system-contracts/contracts/SystemContext.sol

117: function getCurrentPubdataSpent() public view returns (uint256) {
122: function getCurrentPubdataCost() external view returns (uint256) {
482: function incrementTxNumberInBatch() external onlyCallFromBootloader {
486: function resetTxNumberInBatch() external onlyCallFromBootloader {
```
[117](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L117) | [122](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L122) | [482](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L482) | [486](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L486)

```solidity
File: code/system-contracts/contracts/interfaces/IAccount.sol

26: function executeTransaction(
        bytes32 _txHash,
        bytes32 _suggestedSignedHash,
        Transaction calldata _transaction
    ) external payable;
34: function executeTransactionFromOutside(Transaction calldata _transaction) external payable;
36: function payForTransaction(
        bytes32 _txHash,
        bytes32 _suggestedSignedHash,
        Transaction calldata _transaction
    ) external payable;
42: function prepareForPaymaster(
        bytes32 _txHash,
        bytes32 _possibleSignedHash,
        Transaction calldata _transaction
    ) external payable;
```
[26](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IAccount.sol#L26) | [34](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IAccount.sol#L34) | [36](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IAccount.sol#L36) | [42](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IAccount.sol#L42)

```solidity
File: code/system-contracts/contracts/interfaces/IAccountCodeStorage.sol

6: function storeAccountConstructingCodeHash(address _address, bytes32 _hash) external;
8: function storeAccountConstructedCodeHash(address _address, bytes32 _hash) external;
10: function markAccountCodeHashAsConstructed(address _address) external;
12: function getRawCodeHash(address _address) external view returns (bytes32 codeHash);
14: function getCodeHash(uint256 _input) external view returns (bytes32 codeHash);
16: function getCodeSize(uint256 _input) external view returns (uint256 codeSize);
```
[6](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IAccountCodeStorage.sol#L6) | [8](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IAccountCodeStorage.sol#L8) | [10](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IAccountCodeStorage.sol#L10) | [12](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IAccountCodeStorage.sol#L12) | [14](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IAccountCodeStorage.sol#L14) | [16](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IAccountCodeStorage.sol#L16)

```solidity
File: code/system-contracts/contracts/interfaces/IBaseToken.sol

6: function balanceOf(uint256) external view returns (uint256);
8: function transferFromTo(address _from, address _to, uint256 _amount) external;
10: function totalSupply() external view returns (uint256);
12: function name() external pure returns (string memory);
14: function symbol() external pure returns (string memory);
16: function decimals() external pure returns (uint8);
18: function mint(address _account, uint256 _amount) external;
20: function withdraw(address _l1Receiver) external payable;
22: function withdrawWithMessage(address _l1Receiver, bytes calldata _additionalData) external payable;
```
[6](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IBaseToken.sol#L6) | [8](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IBaseToken.sol#L8) | [10](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IBaseToken.sol#L10) | [12](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IBaseToken.sol#L12) | [14](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IBaseToken.sol#L14) | [16](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IBaseToken.sol#L16) | [18](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IBaseToken.sol#L18) | [20](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IBaseToken.sol#L20) | [22](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IBaseToken.sol#L22)

```solidity
File: code/system-contracts/contracts/interfaces/IBootloaderUtilities.sol

8: function getTransactionHashes(
        Transaction calldata _transaction
    ) external view returns (bytes32 txHash, bytes32 signedTxHash);
```
[8](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IBootloaderUtilities.sol#L8)

```solidity
File: code/system-contracts/contracts/interfaces/IComplexUpgrader.sol

11: function upgrade(address _delegateTo, bytes calldata _calldata) external payable;
```
[11](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IComplexUpgrader.sol#L11)

```solidity
File: code/system-contracts/contracts/interfaces/ICompressor.sol

19: function publishCompressedBytecode(
        bytes calldata _bytecode,
        bytes calldata _rawCompressedData
    ) external payable returns (bytes32 bytecodeHash);
24: function verifyCompressedStateDiffs(
        uint256 _numberOfStateDiffs,
        uint256 _enumerationIndexSize,
        bytes calldata _stateDiffs,
        bytes calldata _compressedStateDiffs
    ) external payable returns (bytes32 stateDiffHash);
```
[19](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/ICompressor.sol#L19) | [24](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/ICompressor.sol#L24)

```solidity
File: code/system-contracts/contracts/interfaces/IContractDeployer.sol

43: function getNewAddressCreate2(
        address _sender,
        bytes32 _bytecodeHash,
        bytes32 _salt,
        bytes calldata _input
    ) external view returns (address newAddress);
50: function getNewAddressCreate(address _sender, uint256 _senderNonce) external pure returns (address newAddress);
52: function create2(
        bytes32 _salt,
        bytes32 _bytecodeHash,
        bytes calldata _input
    ) external payable returns (address newAddress);
58: function create2Account(
        bytes32 _salt,
        bytes32 _bytecodeHash,
        bytes calldata _input,
        AccountAbstractionVersion _aaVersion
    ) external payable returns (address newAddress);
68: function create(
        bytes32 _salt,
        bytes32 _bytecodeHash,
        bytes calldata _input
    ) external payable returns (address newAddress);
76: function createAccount(
        bytes32 _salt,
        bytes32 _bytecodeHash,
        bytes calldata _input,
        AccountAbstractionVersion _aaVersion
    ) external payable returns (address newAddress);
```
[43](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L43) | [50](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L50) | [52](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L52) | [58](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L58) | [68](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L68) | [76](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L76)

```solidity
File: code/system-contracts/contracts/interfaces/IImmutableSimulator.sol

11: function getImmutable(address _dest, uint256 _index) external view returns (bytes32);
13: function setImmutables(address _dest, ImmutableData[] calldata _immutables) external;
```
[11](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IImmutableSimulator.sol#L11) | [13](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IImmutableSimulator.sol#L13)

```solidity
File: code/system-contracts/contracts/interfaces/IKnownCodesStorage.sol

14: function markFactoryDeps(bool _shouldSendToL1, bytes32[] calldata _hashes) external;
16: function markBytecodeAsPublished(bytes32 _bytecodeHash) external;
18: function getMarker(bytes32 _hash) external view returns (uint256);
```
[14](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IKnownCodesStorage.sol#L14) | [16](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IKnownCodesStorage.sol#L16) | [18](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IKnownCodesStorage.sol#L18)

```solidity
File: code/system-contracts/contracts/interfaces/IL1Messenger.sol

49: function sendToL1(bytes memory _message) external returns (bytes32);
51: function sendL2ToL1Log(bool _isService, bytes32 _key, bytes32 _value) external returns (uint256 logIdInMerkleTree);
54: function requestBytecodeL1Publication(bytes32 _bytecodeHash) external;
```
[49](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IL1Messenger.sol#L49) | [51](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IL1Messenger.sol#L51) | [54](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IL1Messenger.sol#L54)

```solidity
File: code/system-contracts/contracts/interfaces/IL2StandardToken.sol

10: function bridgeMint(address _account, uint256 _amount) external;
12: function bridgeBurn(address _account, uint256 _amount) external;
14: function l1Address() external view returns (address);
16: function l2Bridge() external view returns (address);
```
[10](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IL2StandardToken.sol#L10) | [12](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IL2StandardToken.sol#L12) | [14](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IL2StandardToken.sol#L14) | [16](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IL2StandardToken.sol#L16)

```solidity
File: code/system-contracts/contracts/interfaces/IMailbox.sol

6: function finalizeEthWithdrawal(
        uint256 _l2BatchNumber,
        uint256 _l2MessageIndex,
        uint16 _l2TxNumberInBlock,
        bytes calldata _message,
        bytes32[] calldata _merkleProof
    ) external;
```
[6](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IMailbox.sol#L6)

```solidity
File: code/system-contracts/contracts/interfaces/INonceHolder.sol

17: function getMinNonce(address _address) external view returns (uint256);
21: function getRawNonce(address _address) external view returns (uint256);
24: function increaseMinNonce(uint256 _value) external returns (uint256);
27: function setValueUnderNonce(uint256 _key, uint256 _value) external;
30: function getValueUnderNonce(uint256 _key) external view returns (uint256);
34: function incrementMinNonceIfEquals(uint256 _expectedNonce) external;
37: function getDeploymentNonce(address _address) external view returns (uint256);
40: function incrementDeploymentNonce(address _address) external returns (uint256);
43: function validateNonceUsage(address _address, uint256 _key, bool _shouldBeUsed) external view;
46: function isNonceUsed(address _address, uint256 _nonce) external view returns (bool);
```
[17](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/INonceHolder.sol#L17) | [21](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/INonceHolder.sol#L21) | [24](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/INonceHolder.sol#L24) | [27](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/INonceHolder.sol#L27) | [30](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/INonceHolder.sol#L30) | [34](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/INonceHolder.sol#L34) | [37](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/INonceHolder.sol#L37) | [40](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/INonceHolder.sol#L40) | [43](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/INonceHolder.sol#L43) | [46](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/INonceHolder.sol#L46)

```solidity
File: code/system-contracts/contracts/interfaces/IPaymaster.sol

28: function validateAndPayForPaymasterTransaction(
        bytes32 _txHash,
        bytes32 _suggestedSignedHash,
        Transaction calldata _transaction
    ) external payable returns (bytes4 magic, bytes memory context);
43: function postTransaction(
        bytes calldata _context,
        Transaction calldata _transaction,
        bytes32 _txHash,
        bytes32 _suggestedSignedHash,
        ExecutionResult _txResult,
        uint256 _maxRefundedGas
    ) external payable;
```
[28](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IPaymaster.sol#L28) | [43](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IPaymaster.sol#L43)

```solidity
File: code/system-contracts/contracts/interfaces/IPaymasterFlow.sol

13: function general(bytes calldata input) external;
15: function approvalBased(address _token, uint256 _minAllowance, bytes calldata _innerInput) external;
```
[13](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IPaymasterFlow.sol#L13) | [15](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IPaymasterFlow.sol#L15)

```solidity
File: code/system-contracts/contracts/interfaces/ISystemContext.sol

30: function chainId() external view returns (uint256);
32: function origin() external view returns (address);
34: function gasPrice() external view returns (uint256);
36: function blockGasLimit() external view returns (uint256);
38: function coinbase() external view returns (address);
40: function difficulty() external view returns (uint256);
42: function baseFee() external view returns (uint256);
44: function txNumberInBlock() external view returns (uint16);
46: function getBlockHashEVM(uint256 _block) external view returns (bytes32);
48: function getBatchHash(uint256 _batchNumber) external view returns (bytes32 hash);
50: function getBlockNumber() external view returns (uint128);
52: function getBlockTimestamp() external view returns (uint128);
54: function getBatchNumberAndTimestamp() external view returns (uint128 blockNumber, uint128 blockTimestamp);
56: function getL2BlockNumberAndTimestamp() external view returns (uint128 blockNumber, uint128 blockTimestamp);
58: function gasPerPubdataByte() external view returns (uint256 gasPerPubdataByte);
60: function getCurrentPubdataSpent() external view returns (uint256 currentPubdataSpent);
```
[30](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/ISystemContext.sol#L30) | [32](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/ISystemContext.sol#L32) | [34](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/ISystemContext.sol#L34) | [36](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/ISystemContext.sol#L36) | [38](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/ISystemContext.sol#L38) | [40](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/ISystemContext.sol#L40) | [42](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/ISystemContext.sol#L42) | [44](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/ISystemContext.sol#L44) | [46](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/ISystemContext.sol#L46) | [48](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/ISystemContext.sol#L48) | [50](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/ISystemContext.sol#L50) | [52](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/ISystemContext.sol#L52) | [54](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/ISystemContext.sol#L54) | [56](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/ISystemContext.sol#L56) | [58](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/ISystemContext.sol#L58) | [60](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/ISystemContext.sol#L60)

```solidity
File: code/system-contracts/contracts/interfaces/ISystemContextDeprecated.sol

11: function currentBlockInfo() external view returns (uint256);
13: function getBlockNumberAndTimestamp() external view returns (uint256 blockNumber, uint256 blockTimestamp);
15: function blockHash(uint256 _blockNumber) external view returns (bytes32 hash);
```
[11](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/ISystemContextDeprecated.sol#L11) | [13](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/ISystemContextDeprecated.sol#L13) | [15](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/ISystemContextDeprecated.sol#L15)

```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

41: constructor() {
149: function l2TokenAddress(address _l1Token) public view override returns (address) {
```
[41](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L41) | [149](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L149)

```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

40: constructor() {
159: function name() public view override returns (string memory) {
165: function symbol() public view override returns (string memory) {
171: function decimals() public view override returns (uint8) {
178: function decodeString(bytes memory _input) external pure returns (string memory result) {
183: function decodeUint8(bytes memory _input) external pure returns (uint8 result) {
```
[40](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L40) | [159](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L159) | [165](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L165) | [171](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L171) | [178](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L178) | [183](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L183)

```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL1ERC20Bridge.sol

9: function finalizeWithdrawal(
        uint256 _l2BatchNumber,
        uint256 _l2MessageIndex,
        uint16 _l2TxNumberInBatch,
        bytes calldata _message,
        bytes32[] calldata _merkleProof
    ) external;
```
[9](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L9)

```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL1SharedBridge.sol

9: function finalizeWithdrawal(
        uint256 _chainId,
        uint256 _l2BatchNumber,
        uint256 _l2MessageIndex,
        uint16 _l2TxNumberInBatch,
        bytes calldata _message,
        bytes32[] calldata _merkleProof
    ) external;
```
[9](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/interfaces/IL1SharedBridge.sol#L9)

```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol

24: function finalizeDeposit(
        address _l1Sender,
        address _l2Receiver,
        address _l1Token,
        uint256 _amount,
        bytes calldata _data
    ) external payable;
32: function withdraw(address _l1Receiver, address _l2Token, uint256 _amount) external;
34: function l1TokenAddress(address _l2Token) external view returns (address);
36: function l2TokenAddress(address _l1Token) external view returns (address);
38: function l1Bridge() external view returns (address);
```
[24](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol#L24) | [32](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol#L32) | [34](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol#L34) | [36](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol#L36) | [38](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol#L38)

```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol

12: function bridgeMint(address _account, uint256 _amount) external;
14: function bridgeBurn(address _account, uint256 _amount) external;
16: function l1Address() external view returns (address);
18: function l2Bridge() external view returns (address);
```
[12](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol#L12) | [14](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol#L14) | [16](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol#L16) | [18](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol#L18)

```solidity
File: code/contracts/zksync/contracts/interfaces/IPaymaster.sol

28: function validateAndPayForPaymasterTransaction(
        bytes32 _txHash,
        bytes32 _suggestedSignedHash,
        Transaction calldata _transaction
    ) external payable returns (bytes4 magic, bytes memory context);
43: function postTransaction(
        bytes calldata _context,
        Transaction calldata _transaction,
        bytes32 _txHash,
        bytes32 _suggestedSignedHash,
        ExecutionResult _txResult,
        uint256 _maxRefundedGas
    ) external payable;
```
[28](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/interfaces/IPaymaster.sol#L28) | [43](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/interfaces/IPaymaster.sol#L43)

```solidity
File: code/contracts/zksync/contracts/interfaces/IPaymasterFlow.sol

14: function general(bytes calldata input) external;
16: function approvalBased(address _token, uint256 _minAllowance, bytes calldata _innerInput) external;
```
[14](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/interfaces/IPaymasterFlow.sol#L14) | [16](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/interfaces/IPaymasterFlow.sol#L16)
</details>

### [N-90] Constants in comparisons should appear on the left side

Placing constants on the left side of comparison statements can help prevent accidental assignments and improve code readability.
In languages like C, placing constants on the left can protect against unintended assignments that would be treated as true conditions, leading to bugs.
Although Solidity does not have this specific issue, using the same practice can still be beneficial for code readability and consistency.

Consider placing constants on the left side of comparison operators like `==`, `!=`, `<`, `>`, `<=`, and `>=`."

<details>
<summary><i>156 issue instances in 36 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

141: require(_amount != 0, "0T"); // empty deposit
186: require(amount != 0, "2T"); // empty deposit
141: require(_amount != 0, "0T"); // empty deposit
186: require(amount != 0, "2T"); // empty deposit
```
[141](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L141) | [186](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L186) | [141](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L141) | [186](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L186)

```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

129: require(amount > 0, "ShB: 0 amount to transfer");
158: require(msg.value == 0, "ShB m.v > 0 b d.it");
200: require(_depositAmount == 0, "ShB wrong withdraw amount");
208: require(amount != 0, "6T"); // empty deposit amount
237: require(depositHappened[_chainId][_txHash] == 0x00, "ShB tx hap");
327: require(_amount > 0, "y1");
501: require(_l2ToL1message.length >= 56, "ShB wrong msg len"); // wrong messsage length
517: require(_l2ToL1message.length == 76, "ShB wrong msg len 2");
```
[129](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L129) | [158](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L158) | [200](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L200) | [208](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L208) | [237](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L237) | [327](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L327) | [501](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L501) | [517](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L517)

```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

122: require(_chainId != 0, "Bridgehub: chainId cannot be 0");
225: require(msg.value == 0, "Bridgehub: non-eth bridge with msg.value");
329: } else if (_refundRecipient.code.length > 0) {
```
[122](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L122) | [225](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L225) | [329](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L329)

```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

107: if (timestamp == 0) {
```
[107](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L107)

```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

106: assert(L2_TO_L1_LOG_SERIALIZE_SIZE != 2 * 32);
```
[106](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L106)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol

51: assert(L2_TO_L1_LOG_SERIALIZE_SIZE != 2 * 32);
```
[51](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol#L51)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol

25: require(msg.data.length >= 4 || msg.data.length == 0, "Ut");
```
[25](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol#L25)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

50: require(logOutput.pubdataHash == 0x00, "v0h");
51: require(_newBatch.pubdataCommitments.length == 1);
192: require(processedLogs == 511, "b7");
194: require(processedLogs == 1023, "b8");
231: require(_newBatchesData.length == 1, "e4");
284: require(s.l2SystemContractsUpgradeBatchNumber == 0, "ik");
361: if (batchWhenUpgradeHappened != 0 && batchWhenUpgradeHappened <= newTotalBatchesExecuted) {
426: assert(block.chainid != 1);
429: if (_proof.serializedProof.length > 0) {
442: require(proofPublicInput.length == 1, "t4");
631: require(_pubdataCommitments.length > 0, "pl");
633: require(_pubdataCommitments.length % PUBDATA_COMMITMENT_SIZE == 0, "bs");
```
[50](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L50) | [51](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L51) | [192](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L192) | [194](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L194) | [231](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L231) | [284](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L284) | [361](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L361) | [426](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L426) | [429](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L429) | [442](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L442) | [631](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L631) | [633](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L633)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol

169: if (selectorsArrayLen != 0) {
```
[169](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L169)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

158: require(s.baseTokenGasPriceMultiplierDenominator > 0, "Mailbox: baseTokenGasPriceDenominator not set");
277: if (refundRecipient.code.length > 0) {
```
[158](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L158) | [277](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L277)

```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol

186: if (_l2ProtocolUpgradeTx.txType == 0) {
250: require(
            s.l2SystemContractsUpgradeBatchNumber == 0,
            "The batch number of the previous upgrade has not been cleaned"
        );
```
[186](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L186) | [250](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L250)

```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol

34: require(
            s.l2SystemContractsUpgradeBatchNumber == 0,
            "The batch number of the previous upgrade has not been cleaned"
        );
```
[34](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L34)

```solidity
File: code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol

23: require(_bytecode.length % 32 == 0, "pq");
26: require(bytecodeLenInWords < 2 ** 16, "pp"); // bytecode length must be less than 2^16 words
27: require(bytecodeLenInWords % 2 == 1, "ps"); // bytecode length in words must be odd
30: hashedBytecode = (hashedBytecode | bytes32(uint256(1 << 248)));
32: hashedBytecode = hashedBytecode | bytes32(bytecodeLenInWords << 224);
```
[23](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L23) | [26](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L26) | [27](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L27) | [30](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L30) | [32](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L32)

```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol

132: require(_facet.code.length > 0, "G");
155: require(_facet.code.length > 0, "K");
194: if (selectorsLength == 0) {
213: if (selectorPosition != 0) {
250: if (lastSelectorPosition == 0) {
286: if (data.length <= 4) {
297: require(data.length == 32, "lp");
```
[132](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L132) | [155](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L155) | [194](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L194) | [213](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L213) | [250](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L250) | [286](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L286) | [297](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L297)

```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol

24: require(pathLength > 0, "xc");
25: require(pathLength < 256, "bt");
30: currentHash = (_index % 2 == 0)
```
[24](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol#L24) | [25](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol#L25) | [30](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol#L30)

```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol

50: require(_transaction.paymaster == 0, "uc");
51: require(_transaction.value == 0, "ud");
52: require(_transaction.maxFeePerGas == 0, "uq");
53: require(_transaction.maxPriorityFeePerGas == 0, "ux");
54: require(_transaction.reserved[0] == 0, "ue");
56: require(_transaction.reserved[2] == 0, "ug");
57: require(_transaction.reserved[3] == 0, "uo");
58: require(_transaction.signature.length == 0, "uh");
59: require(_transaction.paymasterInput.length == 0, "ul1");
60: require(_transaction.reservedDynamic.length == 0, "um");
```
[50](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L50) | [51](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L51) | [52](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L52) | [53](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L53) | [54](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L54) | [56](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L56) | [57](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L57) | [58](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L58) | [59](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L59) | [60](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L60)

```solidity
File: code/contracts/ethereum/contracts/common/ReentrancyGuard.sol

58: require(lockSlotOldValue == 0, "1B");
```
[58](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/ReentrancyGuard.sol#L58)

```solidity
File: code/system-contracts/contracts/AccountCodeStorage.sol

102: if (codeHash == 0x00 && NONCE_HOLDER_SYSTEM_CONTRACT.getRawNonce(account) > 0) {
```
[102](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/AccountCodeStorage.sol#L102)

```solidity
File: code/system-contracts/contracts/BootloaderUtilities.sol

69: if (txDataLen != 1) {
72: } else if (_transaction.data[0] >= 0x80) {
92: require(vInt == 27 || vInt == 28, "Invalid v value");
96: if (_transaction.reserved[0] != 0) {
165: if (txDataLen != 1) {
168: } else if (_transaction.data[0] >= 0x80) {
191: require(vInt == 27 || vInt == 28, "Invalid v value");
260: if (txDataLen != 1) {
263: } else if (_transaction.data[0] >= 0x80) {
286: require(vInt == 27 || vInt == 28, "Invalid v value");
```
[69](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L69) | [72](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L72) | [92](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L92) | [96](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L96) | [165](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L165) | [168](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L168) | [191](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L191) | [260](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L260) | [263](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L263) | [286](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L286)

```solidity
File: code/system-contracts/contracts/ComplexUpgrader.sol

24: require(_delegateTo.code.length > 0, "Delegatee is an EOA");
```
[24](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ComplexUpgrader.sol#L24)

```solidity
File: code/system-contracts/contracts/Compressor.sol

130: if (enumIndex != 0) {
162: if (enumIndex == 0) {
229: if (_operation == 0 || _operation == 3) {
231: } else if (_operation == 1) {
236: } else if (_operation == 2) {
```
[130](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L130) | [162](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L162) | [229](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L229) | [231](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L231) | [236](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L236)

```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

303: require(knownCodeMarker > 0, "The code hash is not known");
332: if (value > 0) {
339: if (value > 0) {
350: require(value == 0, "The value must be zero if we do not call the constructor");
```
[303](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L303) | [332](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L332) | [339](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L339) | [350](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L350)

```solidity
File: code/system-contracts/contracts/DefaultAccount.sol

160: require(_signature.length == 65, "Signature length is incorrect");
173: require(v == 27 || v == 28, "v is neither 27 nor 28");
```
[160](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L160) | [173](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L173)

```solidity
File: code/system-contracts/contracts/L1Messenger.sol

222: while (nodesOnCurrentLevel > 1) {
```
[222](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L222)

```solidity
File: code/system-contracts/contracts/MsgValueSimulator.sol

62: if (value != 0) {
```
[62](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/MsgValueSimulator.sol#L62)

```solidity
File: code/system-contracts/contracts/NonceHolder.sol

85: require(_value != 0, "Nonce value cannot be set to 0");
```
[85](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L85)

```solidity
File: code/system-contracts/contracts/SystemContext.sol

245: require(_l2BlockNumber > 0, "L2 block number is never expected to be zero");
268: if (virtualBlockUpgradeInfo.virtualBlockFinishL2Block != 0) {
277: if (currentVirtualL2BlockInfo.number == 0 && virtualBlockInfo.timestamp == 0) {
287: require(_maxVirtualBlocksToCreate > 0, "Can't initialize the first virtual block");
289: } else if (_maxVirtualBlocksToCreate == 0) {
355: require(_maxVirtualBlocksToCreate > 0, "There must be a virtual block created at the start of the batch");
360: if (currentL2BlockNumber == 0 && currentL2BlockTimestamp == 0) {
373: require(_maxVirtualBlocksToCreate == 0, "Can not create virtual blocks in the middle of the miniblock");
413: require(currentBatchNumber > 0, "The current batch number must be greater than 0");
```
[245](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L245) | [268](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L268) | [277](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L277) | [287](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L287) | [289](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L289) | [355](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L355) | [360](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L360) | [373](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L373) | [413](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L413)

```solidity
File: code/system-contracts/contracts/GasBoundCaller.sol

73: if (pubdataCost != 0) {
```
[73](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/GasBoundCaller.sol#L73)

```solidity
File: code/system-contracts/contracts/libraries/EfficientCall.sol

38: require(returnData.length == 32, "keccak256 returned invalid data");
47: require(returnData.length == 32, "sha returned invalid data");
131: if (_value == 0) {
```
[38](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L38) | [47](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L47) | [131](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L131)

```solidity
File: code/system-contracts/contracts/libraries/RLPEncoder.sol

26: if (_val < 128) {
29: encoded[0] = (_val == 0) ? bytes1(uint8(128)) : bytes1(uint8(_val));
50: assert(_len != 1);
62: if (_len < 56) {
```
[26](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/RLPEncoder.sol#L26) | [29](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/RLPEncoder.sol#L29) | [50](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/RLPEncoder.sol#L50) | [62](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/RLPEncoder.sol#L62)

```solidity
File: code/system-contracts/contracts/libraries/SystemContractHelper.sol

319: require(index < 10, "There are only 10 accessible registers");
```
[319](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L319)

```solidity
File: code/system-contracts/contracts/libraries/SystemContractsCaller.sol

12: address constant TO_L1_CALL_ADDRESS = address((1 << 16) - 1);
13: address constant CODE_ADDRESS_CALL_ADDRESS = address((1 << 16) - 2);
14: address constant PRECOMPILE_CALL_ADDRESS = address((1 << 16) - 3);
15: address constant META_CALL_ADDRESS = address((1 << 16) - 4);
16: address constant MIMIC_CALL_CALL_ADDRESS = address((1 << 16) - 5);
17: address constant SYSTEM_MIMIC_CALL_CALL_ADDRESS = address((1 << 16) - 6);
18: address constant MIMIC_CALL_BY_REF_CALL_ADDRESS = address((1 << 16) - 7);
19: address constant SYSTEM_MIMIC_CALL_BY_REF_CALL_ADDRESS = address((1 << 16) - 8);
20: address constant RAW_FAR_CALL_CALL_ADDRESS = address((1 << 16) - 9);
21: address constant RAW_FAR_CALL_BY_REF_CALL_ADDRESS = address((1 << 16) - 10);
22: address constant SYSTEM_CALL_CALL_ADDRESS = address((1 << 16) - 11);
23: address constant SYSTEM_CALL_BY_REF_CALL_ADDRESS = address((1 << 16) - 12);
24: address constant SET_CONTEXT_VALUE_CALL_ADDRESS = address((1 << 16) - 13);
25: address constant SET_PUBDATA_PRICE_CALL_ADDRESS = address((1 << 16) - 14);
26: address constant INCREMENT_TX_COUNTER_CALL_ADDRESS = address((1 << 16) - 15);
27: address constant PTR_CALLDATA_CALL_ADDRESS = address((1 << 16) - 16);
28: address constant CALLFLAGS_CALL_ADDRESS = address((1 << 16) - 17);
29: address constant PTR_RETURNDATA_CALL_ADDRESS = address((1 << 16) - 18);
30: address constant EVENT_INITIALIZE_ADDRESS = address((1 << 16) - 19);
31: address constant EVENT_WRITE_ADDRESS = address((1 << 16) - 20);
32: address constant LOAD_CALLDATA_INTO_ACTIVE_PTR_CALL_ADDRESS = address((1 << 16) - 21);
33: address constant LOAD_LATEST_RETURNDATA_INTO_ACTIVE_PTR_CALL_ADDRESS = address((1 << 16) - 22);
34: address constant PTR_ADD_INTO_ACTIVE_CALL_ADDRESS = address((1 << 16) - 23);
35: address constant PTR_SHRINK_INTO_ACTIVE_CALL_ADDRESS = address((1 << 16) - 24);
36: address constant PTR_PACK_INTO_ACTIVE_CALL_ADDRESS = address((1 << 16) - 25);
37: address constant MULTIPLICATION_HIGH_ADDRESS = address((1 << 16) - 26);
38: address constant GET_EXTRA_ABI_DATA_ADDRESS = address((1 << 16) - 27);
98: if (value == 0) {
261: farCallAbiWithEmptyFatPtr |= (1 << 240);
264: farCallAbiWithEmptyFatPtr |= (1 << 248);
```
[12](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L12) | [13](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L13) | [14](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L14) | [15](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L15) | [16](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L16) | [17](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L17) | [18](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L18) | [19](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L19) | [20](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L20) | [21](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L21) | [22](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L22) | [23](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L23) | [24](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L24) | [25](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L25) | [26](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L26) | [27](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L27) | [28](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L28) | [29](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L29) | [30](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L30) | [31](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L31) | [32](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L32) | [33](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L33) | [34](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L34) | [35](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L35) | [36](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L36) | [37](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L37) | [38](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L38) | [98](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L98) | [261](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L261) | [264](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L264)

```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

172: if (txDataLen != 1) {
175: } else if (_transaction.data[0] >= 0x80) {
184: if (_transaction.reserved[0] != 0) {
250: if (txDataLen != 1) {
253: } else if (_transaction.data[0] >= 0x80) {
322: if (txDataLen != 1) {
325: } else if (_transaction.data[0] >= 0x80) {
363: require(_transaction.paymasterInput.length >= 4, "The standard paymaster input must be at least 4 bytes long");
367: require(
                _transaction.paymasterInput.length >= 68,
                "The approvalBased paymaster input must be at least 68 bytes long"
            );
```
[172](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L172) | [175](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L175) | [184](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L184) | [250](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L250) | [253](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L253) | [322](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L322) | [325](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L325) | [363](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L363) | [367](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L367)

```solidity
File: code/system-contracts/contracts/libraries/Utils.sol

84: require(_bytecode.length % 32 == 0, "po");
87: require(lengthInWords < 2 ** 16, "pp"); // bytecode length must be less than 2^16 words
88: require(lengthInWords % 2 == 1, "pr"); // bytecode length in words must be odd
93: hashedBytecode = (hashedBytecode | bytes32(uint256(1 << 248)));
95: hashedBytecode = hashedBytecode | bytes32(lengthInWords << 224);
```
[84](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L84) | [87](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L87) | [88](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L88) | [93](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L93) | [95](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L95)

```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

124: require(_amount > 0, "Amount cannot be zero");
```
[124](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L124)

```solidity
File: code/contracts/zksync/contracts/SystemContractsCaller.sol

7: address constant SYSTEM_CALL_CALL_ADDRESS = address((1 << 16) - 11);
59: if (value == 0) {
132: farCallAbiWithEmptyFatPtr |= (1 << 240);
135: farCallAbiWithEmptyFatPtr |= (1 << 248);
```
[7](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/SystemContractsCaller.sol#L7) | [59](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/SystemContractsCaller.sol#L59) | [132](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/SystemContractsCaller.sol#L132) | [135](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/SystemContractsCaller.sol#L135)
</details>

### [N-91] NatSpec: Contract declarations should have `@notice` tag

The `@notice` tag in NatSpec annotations serves to provide information about the contract's functionality that is visible to end-users.
Including `@notice` comments helps to improve the contract's transparency and ease of understanding, contributing to the overall trust and credibility of the code.
[NatSpec Guidelines](https://docs.soliditylang.org/en/develop/natspec-format.html)

<details>
<summary><i>54 issue instances in 54 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

30: contract L1SharedBridge is IL1SharedBridge, ReentrancyGuard, Initializable, Ownable2Step {
```
[30](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L30)

```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

16: contract Bridgehub is IBridgehub, ReentrancyGuard, Ownable2Step {
```
[16](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L16)

```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

25: contract StateTransitionManager is IStateTransitionManager, ReentrancyGuard, Ownable2Step {
```
[25](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L25)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol

17: contract DiamondInit is ZkSyncStateTransitionBase, IDiamondInit {
```
[17](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol#L17)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol

10: contract DiamondProxy {
```
[10](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol#L10)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol

18: contract AdminFacet is ZkSyncStateTransitionBase, IAdmin {
```
[18](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L18)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

22: contract ExecutorFacet is ZkSyncStateTransitionBase, IExecutor {
```
[22](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L22)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol

20: contract GettersFacet is ZkSyncStateTransitionBase, IGetters, ILegacyGetters {
```
[20](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L20)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

30: contract MailboxFacet is ZkSyncStateTransitionBase, IMailbox {
```
[30](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L30)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol

11: contract ZkSyncStateTransitionBase is ReentrancyGuard {
```
[11](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L11)

```solidity
File: code/contracts/ethereum/contracts/upgrades/DefaultUpgrade.sol

10: contract DefaultUpgrade is BaseZkSyncUpgrade {
```
[10](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/DefaultUpgrade.sol#L10)

```solidity
File: code/contracts/ethereum/contracts/upgrades/GenesisUpgrade.sol

11: contract GenesisUpgrade is BaseZkSyncUpgradeGenesis {
```
[11](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/GenesisUpgrade.sol#L11)

```solidity
File: code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol

18: library UnsafeBytes {
```
[18](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol#L18)

```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol

9: library Merkle {
```
[9](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol#L9)

```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol

20: library PriorityQueue {
```
[20](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L20)

```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol

13: library TransactionValidator {
```
[13](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L13)

```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol

12: interface IL1SharedBridge {
```
[12](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L12)

```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL2Bridge.sol

6: interface IL2Bridge {
```
[6](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL2Bridge.sol#L6)

```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IWETH9.sol

4: interface IWETH9 {
```
[4](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IWETH9.sol#L4)

```solidity
File: code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol

42: interface IBridgehub {
```
[42](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L42)

```solidity
File: code/contracts/ethereum/contracts/governance/IGovernance.sol

8: interface IGovernance {
```
[8](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/IGovernance.sol#L8)

```solidity
File: code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol

26: interface IStateTransitionManager {
```
[26](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L26)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol

13: interface IAdmin is IZkSyncStateTransitionBase {
```
[13](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L13)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol

61: interface IDiamondInit {
```
[61](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol#L61)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol

73: interface IExecutor is IZkSyncStateTransitionBase {
```
[73](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L73)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol

13: interface IGetters is IZkSyncStateTransitionBase {
```
[13](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L13)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/ILegacyGetters.sol

11: interface ILegacyGetters is IZkSyncStateTransitionBase {
```
[11](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/ILegacyGetters.sol#L11)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol

11: interface IMailbox is IZkSyncStateTransitionBase {
```
[11](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L11)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IVerifier.sol

15: interface IVerifier {
```
[15](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IVerifier.sol#L15)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol

15: interface IZkSyncStateTransition is IAdmin, IExecutor, IGetters, IMailbox {
```
[15](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol#L15)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransitionBase.sol

7: interface IZkSyncStateTransitionBase {
```
[7](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransitionBase.sol#L7)

```solidity
File: code/contracts/ethereum/contracts/state-transition/l2-deps/ISystemContext.sol

4: interface ISystemContext {
```
[4](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/l2-deps/ISystemContext.sol#L4)

```solidity
File: code/contracts/ethereum/contracts/upgrades/IDefaultUpgrade.sol

7: interface IDefaultUpgrade {
```
[7](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/IDefaultUpgrade.sol#L7)

```solidity
File: code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol

21: library AddressAliasHelper {
```
[21](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol#L21)

```solidity
File: code/system-contracts/contracts/Compressor.sol

22: contract Compressor is ICompressor, ISystemContract {
```
[22](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L22)

```solidity
File: code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol

18: library UnsafeBytesCalldata {
```
[18](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol#L18)

```solidity
File: code/system-contracts/contracts/libraries/Utils.sol

11: library Utils {
```
[11](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L11)

```solidity
File: code/system-contracts/contracts/interfaces/IAccount.sol

9: interface IAccount {
```
[9](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IAccount.sol#L9)

```solidity
File: code/system-contracts/contracts/interfaces/IAccountCodeStorage.sol

5: interface IAccountCodeStorage {
```
[5](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IAccountCodeStorage.sol#L5)

```solidity
File: code/system-contracts/contracts/interfaces/IBaseToken.sol

5: interface IBaseToken {
```
[5](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IBaseToken.sol#L5)

```solidity
File: code/system-contracts/contracts/interfaces/IBootloaderUtilities.sol

7: interface IBootloaderUtilities {
```
[7](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IBootloaderUtilities.sol#L7)

```solidity
File: code/system-contracts/contracts/interfaces/IContractDeployer.sol

5: interface IContractDeployer {
```
[5](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L5)

```solidity
File: code/system-contracts/contracts/interfaces/IImmutableSimulator.sol

10: interface IImmutableSimulator {
```
[10](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IImmutableSimulator.sol#L10)

```solidity
File: code/system-contracts/contracts/interfaces/IL2StandardToken.sol

5: interface IL2StandardToken {
```
[5](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IL2StandardToken.sol#L5)

```solidity
File: code/system-contracts/contracts/interfaces/IMailbox.sol

5: interface IMailbox {
```
[5](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IMailbox.sol#L5)

```solidity
File: code/system-contracts/contracts/interfaces/INonceHolder.sol

13: interface INonceHolder {
```
[13](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/INonceHolder.sol#L13)

```solidity
File: code/system-contracts/contracts/interfaces/IPaymaster.sol

14: interface IPaymaster {
```
[14](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IPaymaster.sol#L14)

```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL1ERC20Bridge.sol

8: interface IL1ERC20Bridge {
```
[8](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L8)

```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL1SharedBridge.sol

8: interface IL1SharedBridge {
```
[8](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/interfaces/IL1SharedBridge.sol#L8)

```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol

6: interface IL2SharedBridge {
```
[6](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol#L6)

```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol

5: interface IL2StandardToken {
```
[5](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol#L5)

```solidity
File: code/contracts/zksync/contracts/interfaces/IPaymaster.sol

14: interface IPaymaster {
```
[14](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/interfaces/IPaymaster.sol#L14)

```solidity
File: code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol

21: library AddressAliasHelper {
```
[21](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol#L21)

```solidity
File: code/contracts/zksync/contracts/SystemContractsCaller.sol

26: library Utils {
```
[26](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/SystemContractsCaller.sol#L26)
</details>

### [N-92] Large numeric literals should use underscores for readability

Large numeric literals are often hard to read and prone to mistakes.
To improve readability and reduce the likelihood of errors, it is recommended to separate the digits of large numeric literals using underscores.
For example, instead of '1000000', use '1_000_000'.

<details>
<summary><i>7 issue instances in 5 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

194: require(processedLogs == 1023, "b8");
```
[194](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L194)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol

50: uint256 constant BLS_MODULUS = 52435875175126190479447740508185965837690552500527637822603658699938581184513;
```
[50](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L50)

```solidity
File: code/contracts/ethereum/contracts/common/Config.sol

92: uint256 constant TX_SLOT_OVERHEAD_L2_GAS = 10000;
```
[92](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L92)

```solidity
File: code/system-contracts/contracts/Constants.sol

108: uint256 constant MAX_ALLOWED_PUBDATA_PER_BATCH = 520000;
125: uint256 constant L2_TO_L1_LOGS_MERKLE_TREE_LEAVES = 4096;
```
[108](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L108) | [125](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L125)

```solidity
File: code/system-contracts/contracts/MsgValueSimulator.sol

36: uint256 constant GAS_TO_PASS = 2300;
41: uint256 constant MSG_VALUE_SIMULATOR_STIPEND_GAS = 27000;
```
[36](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/MsgValueSimulator.sol#L36) | [41](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/MsgValueSimulator.sol#L41)
</details>

### [N-93] Named Imports of Parent Contracts Are Missing

It's important to have named imports for parent contracts to ensure code readability and maintainability.
Missing named imports can make it difficult to understand the code hierarchy and can lead to issues in the future.

<details>
<summary><i>5 issue instances in 4 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

/// @audit Missing named import for parent contract: `IBridgehub`
15: contract Bridgehub is IBridgehub, ReentrancyGuard, Ownable2Step {
/// @audit Missing named import for parent contract: `ReentrancyGuard`
15: contract Bridgehub is IBridgehub, ReentrancyGuard, Ownable2Step {
```
[15](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L15) | [15](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L15)

```solidity
File: code/contracts/ethereum/contracts/upgrades/GenesisUpgrade.sol

/// @audit Missing named import for parent contract: `BaseZkSyncUpgradeGenesis`
11: contract GenesisUpgrade is BaseZkSyncUpgradeGenesis {
```
[11](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/GenesisUpgrade.sol#L11)

```solidity
File: code/system-contracts/contracts/AccountCodeStorage.sol

/// @audit Missing named import for parent contract: `IAccountCodeStorage`
22: contract AccountCodeStorage is IAccountCodeStorage {
```
[22](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/AccountCodeStorage.sol#L22)

```solidity
File: code/system-contracts/contracts/DefaultAccount.sol

/// @audit Missing named import for parent contract: `IAccount`
19: contract DefaultAccount is IAccount {
```
[19](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L19)
</details>

### [N-94] Long functions should be refactored into multiple, smaller, functions

Functions that span many lines can be hard to understand and maintain.
It is often beneficial to refactor long functions into multiple smaller functions.
This improves readability, makes testing easier, and can even lead to gas optimization if it eliminates the need for variables that would otherwise have to be stored in memory.

<details>
<summary><i>16 issue instances in 9 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

 /// @audit 33 lines (excluding comments)
182: function bridgehubDeposit(
        uint256 _chainId,
        address _prevMsgSender,
        uint256, // l2Value, needed for Weth deposits in the future
        bytes calldata _data
    ) external payable override onlyBridgehub returns (L2TransactionRequestTwoBridgesInner memory request) {
 /// @audit 40 lines (excluding comments)
303: function _claimFailedDeposit(
        bool _checkedInLegacyBridge,
        uint256 _chainId,
        address _depositSender,
        address _l1Token,
        uint256 _amount,
        bytes32 _l2TxHash,
        uint256 _l2BatchNumber,
        uint256 _l2MessageIndex,
        uint16 _l2TxNumberInBatch,
        bytes32[] calldata _merkleProof
    ) internal nonReentrant {
```
[182](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L182) | [303](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L303)

```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

 /// @audit 52 lines (excluding comments)
262: function requestL2TransactionTwoBridges(
        L2TransactionRequestTwoBridgesOuter calldata _request
    ) external payable override nonReentrant returns (bytes32 canonicalTxHash) {
```
[262](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L262)

```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

 /// @audit 45 lines (excluding comments)
177: function _setChainIdUpgrade(uint256 _chainId, address _chainContract) internal {
```
[177](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L177)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

 /// @audit 42 lines (excluding comments)
32: function _commitOneBatch(
        StoredBatchInfo memory _previousBatch,
        CommitBatchInfo calldata _newBatch,
        bytes32 _expectedSystemContractUpgradeTxHash
    ) internal view returns (StoredBatchInfo memory) {
 /// @audit 47 lines (excluding comments)
130: function _processL2Logs(
        CommitBatchInfo calldata _newBatch,
        bytes32 _expectedSystemContractUpgradeTxHash
    ) internal pure returns (LogProcessingOutput memory logOutput) {
 /// @audit 30 lines (excluding comments)
625: function _verifyBlobInformation(
        bytes calldata _pubdataCommitments,
        bytes32[] memory _blobHashes
    ) internal view returns (bytes32[] memory blobCommitments) {
```
[32](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L32) | [130](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L130) | [625](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L625)

```solidity
File: code/system-contracts/contracts/BootloaderUtilities.sol

 /// @audit 65 lines (excluding comments)
44: function encodeLegacyTransactionHash(Transaction calldata _transaction) internal view returns (bytes32 txHash) {
 /// @audit 68 lines (excluding comments)
139: function encodeEIP2930TransactionHash(Transaction calldata _transaction) internal view returns (bytes32) {
 /// @audit 70 lines (excluding comments)
229: function encodeEIP1559TransactionHash(Transaction calldata _transaction) internal view returns (bytes32) {
```
[44](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L44) | [139](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L139) | [229](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L229)

```solidity
File: code/system-contracts/contracts/Compressor.sol

 /// @audit 56 lines (excluding comments)
110: function verifyCompressedStateDiffs(
        uint256 _numberOfStateDiffs,
        uint256 _enumerationIndexSize,
        bytes calldata _stateDiffs,
        bytes calldata _compressedStateDiffs
    ) external payable onlyCallFrom(address(L1_MESSENGER_CONTRACT)) returns (bytes32 stateDiffHash) {
```
[110](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L110)

```solidity
File: code/system-contracts/contracts/L1Messenger.sol

 /// @audit 108 lines (excluding comments)
194: function publishPubdataAndClearState(
        bytes calldata _totalL2ToL1PubdataAndStateDiffs
    ) external onlyCallFromBootloader {
```
[194](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L194)

```solidity
File: code/system-contracts/contracts/SystemContext.sol

 /// @audit 38 lines (excluding comments)
341: function setL2Block(
        uint128 _l2BlockNumber,
        uint128 _l2BlockTimestamp,
        bytes32 _expectedPrevL2BlockHash,
        bool _isFirstInBatch,
        uint128 _maxVirtualBlocksToCreate
    ) external onlyCallFromBootloader {
```
[341](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L341)

```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

 /// @audit 46 lines (excluding comments)
147: function _encodeHashLegacyTransaction(Transaction calldata _transaction) private view returns (bytes32) {
 /// @audit 46 lines (excluding comments)
219: function _encodeHashEIP2930Transaction(Transaction calldata _transaction) private view returns (bytes32) {
 /// @audit 48 lines (excluding comments)
289: function _encodeHashEIP1559Transaction(Transaction calldata _transaction) private view returns (bytes32) {
```
[147](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L147) | [219](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L219) | [289](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L289)
</details>

### [N-95] NatSpec: Contract declarations should have `@dev` tags

NatSpec comments are a critical part of Solidity's documentation system, designed to help developers and others understand the behavior and purpose of a contract.
The `@dev` tag, in particular, provides context and insight into the contract's development considerations.
A missing `@dev` comment can lead to misunderstandings about the contract, making it harder for others to contribute to or use the contract effectively.
Therefore, it's highly recommended to include `@dev` comments in the documentation to enhance code readability and maintainability.
[Refer to NatSpec Documentation](https://docs.soliditylang.org/en/develop/natspec-format.html)

<details>
<summary><i>70 issue instances in 68 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

16: contract Bridgehub is IBridgehub, ReentrancyGuard, Ownable2Step {
```
[16](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L16)

```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

25: contract StateTransitionManager is IStateTransitionManager, ReentrancyGuard, Ownable2Step {
```
[25](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L25)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol

10: contract DiamondProxy {
```
[10](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol#L10)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol

18: contract AdminFacet is ZkSyncStateTransitionBase, IAdmin {
```
[18](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L18)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

22: contract ExecutorFacet is ZkSyncStateTransitionBase, IExecutor {
```
[22](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L22)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol

20: contract GettersFacet is ZkSyncStateTransitionBase, IGetters, ILegacyGetters {
```
[20](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L20)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

30: contract MailboxFacet is ZkSyncStateTransitionBase, IMailbox {
```
[30](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L30)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol

11: contract ZkSyncStateTransitionBase is ReentrancyGuard {
```
[11](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L11)

```solidity
File: code/contracts/ethereum/contracts/upgrades/DefaultUpgrade.sol

10: contract DefaultUpgrade is BaseZkSyncUpgrade {
```
[10](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/DefaultUpgrade.sol#L10)

```solidity
File: code/contracts/ethereum/contracts/upgrades/GenesisUpgrade.sol

11: contract GenesisUpgrade is BaseZkSyncUpgradeGenesis {
```
[11](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/GenesisUpgrade.sol#L11)

```solidity
File: code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol

10: library L2ContractHelper {
```
[10](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L10)

```solidity
File: code/contracts/ethereum/contracts/common/libraries/UncheckedMath.sol

10: library UncheckedMath {
```
[10](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/UncheckedMath.sol#L10)

```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol

11: library Diamond {
```
[11](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L11)

```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol

9: library Merkle {
```
[9](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol#L9)

```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol

13: library TransactionValidator {
```
[13](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L13)

```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol

11: interface IL1ERC20Bridge {
```
[11](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L11)

```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol

12: interface IL1SharedBridge {
```
[12](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L12)

```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL2Bridge.sol

6: interface IL2Bridge {
```
[6](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL2Bridge.sol#L6)

```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IWETH9.sol

4: interface IWETH9 {
```
[4](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IWETH9.sol#L4)

```solidity
File: code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol

42: interface IBridgehub {
```
[42](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L42)

```solidity
File: code/contracts/ethereum/contracts/common/interfaces/IL2ContractDeployer.sol

9: interface IL2ContractDeployer {
```
[9](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/interfaces/IL2ContractDeployer.sol#L9)

```solidity
File: code/contracts/ethereum/contracts/governance/IGovernance.sol

8: interface IGovernance {
```
[8](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/IGovernance.sol#L8)

```solidity
File: code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol

26: interface IStateTransitionManager {
```
[26](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L26)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol

13: interface IAdmin is IZkSyncStateTransitionBase {
```
[13](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L13)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol

61: interface IDiamondInit {
```
[61](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol#L61)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol

73: interface IExecutor is IZkSyncStateTransitionBase {
```
[73](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L73)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol

13: interface IGetters is IZkSyncStateTransitionBase {
```
[13](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L13)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol

11: interface IMailbox is IZkSyncStateTransitionBase {
```
[11](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L11)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IVerifier.sol

15: interface IVerifier {
```
[15](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IVerifier.sol#L15)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol

15: interface IZkSyncStateTransition is IAdmin, IExecutor, IGetters, IMailbox {
```
[15](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol#L15)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransitionBase.sol

7: interface IZkSyncStateTransitionBase {
```
[7](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransitionBase.sol#L7)

```solidity
File: code/contracts/ethereum/contracts/state-transition/l2-deps/ISystemContext.sol

4: interface ISystemContext {
```
[4](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/l2-deps/ISystemContext.sol#L4)

```solidity
File: code/contracts/ethereum/contracts/upgrades/IDefaultUpgrade.sol

7: interface IDefaultUpgrade {
```
[7](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/IDefaultUpgrade.sol#L7)

```solidity
File: code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol

21: library AddressAliasHelper {
```
[21](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol#L21)

```solidity
File: code/system-contracts/contracts/BootloaderUtilities.sol

16: contract BootloaderUtilities is IBootloaderUtilities {
```
[16](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L16)

```solidity
File: code/system-contracts/contracts/ComplexUpgrader.sol

14: contract ComplexUpgrader is IComplexUpgrader {
```
[14](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ComplexUpgrader.sol#L14)

```solidity
File: code/system-contracts/contracts/EmptyContract.sol

10: contract EmptyContract {
```
[10](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/EmptyContract.sol#L10)

```solidity
File: code/system-contracts/contracts/PubdataChunkPublisher.sol

16: contract PubdataChunkPublisher is IPubdataChunkPublisher, ISystemContract {
```
[16](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/PubdataChunkPublisher.sol#L16)

```solidity
File: code/system-contracts/contracts/SystemContext.sol

17: contract SystemContext is ISystemContext, ISystemContextDeprecated, ISystemContract {
```
[17](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L17)

```solidity
File: code/system-contracts/contracts/libraries/RLPEncoder.sol

10: library RLPEncoder {
```
[10](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/RLPEncoder.sol#L10)

```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

78: library TransactionHelper {
```
[78](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L78)

```solidity
File: code/system-contracts/contracts/interfaces/IAccount.sol

9: interface IAccount {
```
[9](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IAccount.sol#L9)

```solidity
File: code/system-contracts/contracts/interfaces/IAccountCodeStorage.sol

5: interface IAccountCodeStorage {
```
[5](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IAccountCodeStorage.sol#L5)

```solidity
File: code/system-contracts/contracts/interfaces/IBaseToken.sol

5: interface IBaseToken {
```
[5](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IBaseToken.sol#L5)

```solidity
File: code/system-contracts/contracts/interfaces/IBootloaderUtilities.sol

7: interface IBootloaderUtilities {
```
[7](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IBootloaderUtilities.sol#L7)

```solidity
File: code/system-contracts/contracts/interfaces/IComplexUpgrader.sol

10: interface IComplexUpgrader {
```
[10](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IComplexUpgrader.sol#L10)

```solidity
File: code/system-contracts/contracts/interfaces/ICompressor.sol

18: interface ICompressor {
```
[18](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/ICompressor.sol#L18)

```solidity
File: code/system-contracts/contracts/interfaces/IContractDeployer.sol

5: interface IContractDeployer {
```
[5](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L5)

```solidity
File: code/system-contracts/contracts/interfaces/IImmutableSimulator.sol

10: interface IImmutableSimulator {
```
[10](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IImmutableSimulator.sol#L10)

```solidity
File: code/system-contracts/contracts/interfaces/IKnownCodesStorage.sol

11: interface IKnownCodesStorage {
```
[11](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IKnownCodesStorage.sol#L11)

```solidity
File: code/system-contracts/contracts/interfaces/IL1Messenger.sol

40: interface IL1Messenger {
```
[40](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IL1Messenger.sol#L40)

```solidity
File: code/system-contracts/contracts/interfaces/IL2StandardToken.sol

5: interface IL2StandardToken {
```
[5](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IL2StandardToken.sol#L5)

```solidity
File: code/system-contracts/contracts/interfaces/IMailbox.sol

5: interface IMailbox {
```
[5](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IMailbox.sol#L5)

```solidity
File: code/system-contracts/contracts/interfaces/IPaymaster.sol

14: interface IPaymaster {
```
[14](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IPaymaster.sol#L14)

```solidity
File: code/system-contracts/contracts/interfaces/IPubdataChunkPublisher.sol

9: interface IPubdataChunkPublisher {
```
[9](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IPubdataChunkPublisher.sol#L9)

```solidity
File: code/system-contracts/contracts/interfaces/ISystemContext.sol

11: interface ISystemContext {
```
[11](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/ISystemContext.sol#L11)

```solidity
File: code/system-contracts/contracts/interfaces/ISystemContextDeprecated.sol

10: interface ISystemContextDeprecated {
```
[10](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/ISystemContextDeprecated.sol#L10)

```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

23: contract L2SharedBridge is IL2SharedBridge, Initializable {
```
[23](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L23)

```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

15: contract L2StandardERC20 is ERC20PermitUpgradeable, IL2StandardToken, ERC1967Upgrade {
```
[15](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L15)

```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL1ERC20Bridge.sol

8: interface IL1ERC20Bridge {
```
[8](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L8)

```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL1SharedBridge.sol

8: interface IL1SharedBridge {
```
[8](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/interfaces/IL1SharedBridge.sol#L8)

```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol

6: interface IL2SharedBridge {
```
[6](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol#L6)

```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol

5: interface IL2StandardToken {
```
[5](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol#L5)

```solidity
File: code/contracts/zksync/contracts/interfaces/IPaymaster.sol

14: interface IPaymaster {
```
[14](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/interfaces/IPaymaster.sol#L14)

```solidity
File: code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol

21: library AddressAliasHelper {
```
[21](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol#L21)

```solidity
File: code/contracts/zksync/contracts/ForceDeployUpgrader.sol

10: contract ForceDeployUpgrader {
```
[10](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/ForceDeployUpgrader.sol#L10)

```solidity
File: code/contracts/zksync/contracts/L2ContractHelper.sol

30: interface IContractDeployer {
61: interface IBaseToken {
83: library L2ContractHelper {
```
[30](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/L2ContractHelper.sol#L30) | [61](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/L2ContractHelper.sol#L61) | [83](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/L2ContractHelper.sol#L83)

```solidity
File: code/contracts/zksync/contracts/SystemContractsCaller.sol

26: library Utils {
```
[26](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/SystemContractsCaller.sol#L26)
</details>

### [N-96] The nonReentrant modifier should occur before all other modifiers

This is a best-practice to protect against reentrancy in other modifiers.

<details>
<summary><i>2 issue instances in 2 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

554: function depositLegacyErc20Bridge(
        address _prevMsgSender,
        address _l2Receiver,
        address _l1Token,
        uint256 _amount,
        uint256 _l2TxGasLimit,
        uint256 _l2TxGasPerPubdataByte,
        address _refundRecipient
    ) external payable override onlyLegacyBridge nonReentrant returns (bytes32 l2TxHash) {
```
[554](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L554)

```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

114: function createNewChain(
        uint256 _chainId,
        address _stateTransitionManager,
        address _baseToken,
        uint256, //_salt
        address _admin,
        bytes calldata _initData
    ) external onlyOwnerOrAdmin nonReentrant returns (uint256 chainId) {
```
[114](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L114)
</details>

### [N-97] `public` functions not called by the contract should be declared `external` instead

Contracts are allowed to override their parents' functions and change the visibility from `external` to `public`.
If a `public` function is not called internally within the contract, it should be declared as `external` to save gas.

<details>
<summary><i>11 issue instances in 5 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

54: function proveL2MessageInclusion(
        uint256 _batchNumber,
        uint256 _index,
        L2Message memory _message,
        bytes32[] calldata _proof
    ) public view returns (bool) {
74: function proveL1ToL2TransactionStatus(
        bytes32 _l2TxHash,
        uint256 _l2BatchNumber,
        uint256 _l2MessageIndex,
        uint16 _l2TxNumberInBatch,
        bytes32[] calldata _merkleProof,
        TxStatus _status
    ) public view returns (bool) {
143: function l2TransactionBaseCost(
        uint256 _gasPrice,
        uint256 _l2GasLimit,
        uint256 _l2GasPerPubdataByteLimit
    ) public view returns (uint256) {
```
[54](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L54) | [74](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L74) | [143](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L143)

```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

40: function extendedAccountVersion(address _address) public view returns (AccountAbstractionVersion) {
```
[40](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L40)

```solidity
File: code/system-contracts/contracts/NonceHolder.sol

57: function getRawNonce(address _address) public view returns (uint256) {
65: function increaseMinNonce(uint256 _value) public onlySystemCall returns (uint256 oldMinNonce) {
82: function setValueUnderNonce(uint256 _key, uint256 _value) public onlySystemCall {
102: function getValueUnderNonce(uint256 _key) public view returns (uint256) {
```
[57](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L57) | [65](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L65) | [82](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L82) | [102](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L102)

```solidity
File: code/system-contracts/contracts/SystemContext.sol

190: function getBlockNumber() public view returns (uint128) {
198: function getBlockTimestamp() public view returns (uint128) {
```
[190](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L190) | [198](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L198)

```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

170: function decimals() public view override returns (uint8) {
```
[170](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L170)
</details>

### [N-98] Large multiples of ten should use scientific notation

Large multiples of ten should use scientific notation (e.g., 1e4) instead of decimal literals (e.g., 10000)
for better code readability.

<details>
<summary><i>1 issue instances in 1 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/common/Config.sol

/// @audit `10000` should be written as `1e4`
92: uint256 constant TX_SLOT_OVERHEAD_L2_GAS = 10000;
```
[92](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L92)
</details>

### [N-99] Prefer Casting to `bytes` or `bytes32` Over `abi.encodePacked()` for Single Arguments

When using `abi.encodePacked()` on a single argument, it is often clearer to use a cast to `bytes` or `bytes32`.
This improves the semantic clarity of the code, making it easier for reviewers to understand the developer's intentions.

<details>
<summary><i>1 issue instances in 1 files:</i></summary>

```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

133: keccak256(abi.encodePacked(_transaction.factoryDeps)),
```
[133](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L133)
</details>

### [N-100] Complex casting

Complex casting in Solidity contracts can introduce both readability issues and potential for overflows. 
Whenever multiple casts are found, consider whether the complexity is necessary.
If so, it is strongly recommended to add inline comments to explain why these casts are needed and to assure that no overflows are introduced.

<details>
<summary><i>101 issue instances in 25 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

77: bytes32 salt = bytes32(uint256(uint160(_l1Token)));
77: bytes32 salt = bytes32(uint256(uint160(_l1Token)));
```
[77](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L77) | [77](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L77)

```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

184: from: uint256(uint160(L2_FORCE_DEPLOYER_ADDR)),
185: to: uint256(uint160(L2_SYSTEM_CONTEXT_SYSTEM_CONTRACT_ADDR)),
264: bytes32(uint256(uint160(bridgehub))),
265: bytes32(uint256(uint160(address(this)))),
265: bytes32(uint256(uint160(address(this)))),
266: bytes32(uint256(protocolVersion)),
267: bytes32(uint256(uint160(_admin))),
268: bytes32(uint256(uint160(validatorTimelock))),
269: bytes32(uint256(uint160(_baseToken))),
270: bytes32(uint256(uint160(_sharedBridge))),
```
[184](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L184) | [185](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L185) | [264](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L264) | [265](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L265) | [265](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L265) | [266](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L266) | [267](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L267) | [268](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L268) | [269](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L269) | [270](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L270)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

39: uint8 pubdataSource = uint8(bytes1(_newBatch.pubdataCommitments[0]));
644: uint256(uint128(bytes16(_pubdataCommitments[i:i + PUBDATA_COMMITMENT_CLAIMED_VALUE_OFFSET])))
```
[39](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L39) | [644](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L644)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

98: value: bytes32(uint256(_status))
137: key: bytes32(uint256(uint160(_message.sender))),
296: from: uint256(uint160(_priorityOpParams.sender)),
297: to: uint256(uint160(_priorityOpParams.contractAddressL2)),
306: reserved: [_priorityOpParams.valueToMint, uint256(uint160(_priorityOpParams.refundRecipient)), 0, 0],
```
[98](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L98) | [137](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L137) | [296](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L296) | [297](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L297) | [306](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L306)

```solidity
File: code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol

30: hashedBytecode = (hashedBytecode | bytes32(uint256(1 << 248)));
50: codeLengthInWords = uint256(uint8(_bytecodeHash[2])) * 256 + uint256(uint8(_bytecodeHash[3]));
50: codeLengthInWords = uint256(uint8(_bytecodeHash[2])) * 256 + uint256(uint8(_bytecodeHash[3]));
66: bytes32 senderBytes = bytes32(uint256(uint160(_sender)));
71: return address(uint160(uint256(data)));
```
[30](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L30) | [50](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L50) | [50](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L50) | [66](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L66) | [71](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L71)

```solidity
File: code/contracts/ethereum/contracts/common/Config.sol

112: bytes32 constant TWO_BRIDGES_MAGIC_VALUE = bytes32(uint256(keccak256("TWO_BRIDGES_MAGIC_VALUE")) - 1);
115: address constant BRIDGEHUB_MIN_SECOND_BRIDGE_ADDRESS = address(uint160(type(uint16).max));
```
[112](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L112) | [115](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L115)

```solidity
File: code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol

30: l2Address = address(uint160(l1Address) + offset);
40: l1Address = address(uint160(l2Address) - offset);
```
[30](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol#L30) | [40](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol#L40)

```solidity
File: code/system-contracts/contracts/AccountCodeStorage.sol

69: uint256 addressAsKey = uint256(uint160(_address));
79: uint256 addressAsKey = uint256(uint160(_address));
92: address account = address(uint160(_input));
120: address account = address(uint160(_input));
```
[69](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/AccountCodeStorage.sol#L69) | [79](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/AccountCodeStorage.sol#L79) | [92](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/AccountCodeStorage.sol#L92) | [120](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/AccountCodeStorage.sol#L120)

```solidity
File: code/system-contracts/contracts/BootloaderUtilities.sol

61: bytes memory encodedTo = RLPEncoder.encodeAddress(address(uint160(_transaction.to)));
81: uint256 rInt = uint256(bytes32(_transaction.signature[0:32]));
86: uint256 sInt = uint256(bytes32(_transaction.signature[32:64]));
91: uint256 vInt = uint256(uint8(_transaction.signature[64]));
147: bytes memory encodedTo = RLPEncoder.encodeAddress(address(uint160(_transaction.to)));
180: uint256 rInt = uint256(bytes32(_transaction.signature[0:32]));
185: uint256 sInt = uint256(bytes32(_transaction.signature[32:64]));
190: uint256 vInt = uint256(uint8(_transaction.signature[64]));
241: bytes memory encodedTo = RLPEncoder.encodeAddress(address(uint160(_transaction.to)));
275: uint256 rInt = uint256(bytes32(_transaction.signature[0:32]));
280: uint256 sInt = uint256(bytes32(_transaction.signature[32:64]));
285: uint256 vInt = uint256(uint8(_transaction.signature[64]));
```
[61](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L61) | [81](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L81) | [86](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L86) | [91](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L91) | [147](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L147) | [180](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L180) | [185](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L185) | [190](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L190) | [241](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L241) | [275](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L275) | [280](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L280) | [285](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L285)

```solidity
File: code/system-contracts/contracts/Compressor.sol

143: uint8 metadata = uint8(bytes1(_compressedStateDiffs[stateDiffPtr]));
174: uint8 metadata = uint8(bytes1(_compressedStateDiffs[stateDiffPtr]));
252: number = uint256(bytes32(_calldataSlice));
```
[143](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L143) | [174](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L174) | [252](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L252)

```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

106: bytes.concat(CREATE2_PREFIX, bytes32(uint256(uint160(_sender))), _salt, _bytecodeHash, constructorInputHash)
109: newAddress = address(uint160(uint256(hash)));
122: bytes.concat(CREATE_PREFIX, bytes32(uint256(uint160(_sender))), bytes32(_senderNonce))
125: newAddress = address(uint160(uint256(hash)));
269: ACCOUNT_CODE_STORAGE_SYSTEM_CONTRACT.getCodeHash(uint256(uint160(_newAddress))) == 0x0,
```
[106](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L106) | [109](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L109) | [122](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L122) | [125](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L125) | [269](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L269)

```solidity
File: code/system-contracts/contracts/DefaultAccount.sol

132: address to = address(uint160(_transaction.to));
```
[132](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L132)

```solidity
File: code/system-contracts/contracts/ImmutableSimulator.sol

28: return immutableDataStorage[uint256(uint160(_dest))][_index];
41: immutableDataStorage[uint256(uint160(_dest))][index] = value;
```
[28](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ImmutableSimulator.sol#L28) | [41](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ImmutableSimulator.sol#L41)

```solidity
File: code/system-contracts/contracts/L1Messenger.sol

130: key: bytes32(uint256(uint160(msg.sender))),
200: uint32 numberOfL2ToL1Logs = uint32(bytes4(_totalL2ToL1PubdataAndStateDiffs[calldataPtr:calldataPtr + 4]));
233: uint32 numberOfMessages = uint32(bytes4(_totalL2ToL1PubdataAndStateDiffs[calldataPtr:calldataPtr + 4]));
237: uint32 currentMessageLength = uint32(bytes4(_totalL2ToL1PubdataAndStateDiffs[calldataPtr:calldataPtr + 4]));
251: uint32 numberOfBytecodes = uint32(bytes4(_totalL2ToL1PubdataAndStateDiffs[calldataPtr:calldataPtr + 4]));
280: uint256(uint8(bytes1(_totalL2ToL1PubdataAndStateDiffs[calldataPtr]))) ==
286: uint24 compressedStateDiffSize = uint24(bytes3(_totalL2ToL1PubdataAndStateDiffs[calldataPtr:calldataPtr + 3]));
289: uint8 enumerationIndexSize = uint8(bytes1(_totalL2ToL1PubdataAndStateDiffs[calldataPtr]));
300: uint32 numberOfStateDiffs = uint32(bytes4(_totalL2ToL1PubdataAndStateDiffs[calldataPtr:calldataPtr + 4]));
320: SystemContractHelper.toL1(true, bytes32(uint256(SystemLogKey.L2_TO_L1_LOGS_TREE_ROOT_KEY)), l2ToL1LogsTreeRoot);
323: bytes32(uint256(SystemLogKey.TOTAL_L2_TO_L1_PUBDATA_KEY)),
326: SystemContractHelper.toL1(true, bytes32(uint256(SystemLogKey.STATE_DIFF_HASH_KEY)), stateDiffHash);
```
[130](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L130) | [200](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L200) | [233](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L233) | [237](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L237) | [251](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L251) | [280](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L280) | [286](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L286) | [289](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L289) | [300](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L300) | [320](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L320) | [323](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L323) | [326](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L326)

```solidity
File: code/system-contracts/contracts/L2BaseToken.sol

57: return balance[address(uint160(_account))];
```
[57](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L2BaseToken.sol#L57)

```solidity
File: code/system-contracts/contracts/MsgValueSimulator.sol

32: to = address(uint160(addressAsUint));
```
[32](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/MsgValueSimulator.sol#L32)

```solidity
File: code/system-contracts/contracts/NonceHolder.sol

47: uint256 addressAsKey = uint256(uint160(_address));
58: uint256 addressAsKey = uint256(uint160(_address));
68: uint256 addressAsKey = uint256(uint160(msg.sender));
92: uint256 addressAsKey = uint256(uint160(msg.sender));
103: uint256 addressAsKey = uint256(uint160(msg.sender));
111: uint256 addressAsKey = uint256(uint160(msg.sender));
126: uint256 addressAsKey = uint256(uint160(_address));
140: uint256 addressAsKey = uint256(uint160(_address));
155: uint256 addressAsKey = uint256(uint160(_address));
```
[47](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L47) | [58](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L58) | [68](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L68) | [92](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L92) | [103](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L103) | [111](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L111) | [126](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L126) | [140](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L140) | [155](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L155)

```solidity
File: code/system-contracts/contracts/PubdataChunkPublisher.sol

55: SystemContractHelper.toL1(true, bytes32(uint256(SystemLogKey.BLOB_ONE_HASH_KEY)), blobHashes[0]);
56: SystemContractHelper.toL1(true, bytes32(uint256(SystemLogKey.BLOB_TWO_HASH_KEY)), blobHashes[1]);
```
[55](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/PubdataChunkPublisher.sol#L55) | [56](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/PubdataChunkPublisher.sol#L56)

```solidity
File: code/system-contracts/contracts/SystemContext.sol

420: bytes32(uint256(SystemLogKey.PACKED_BATCH_AND_L2_BLOCK_TIMESTAMP_KEY)),
466: SystemContractHelper.toL1(false, bytes32(uint256(SystemLogKey.PREV_BATCH_HASH_KEY)), _prevBatchHash);
```
[420](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L420) | [466](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L466)

```solidity
File: code/system-contracts/contracts/libraries/RLPEncoder.sol

29: encoded[0] = (_val == 0) ? bytes1(uint8(128)) : bytes1(uint8(_val));
29: encoded[0] = (_val == 0) ? bytes1(uint8(128)) : bytes1(uint8(_val));
34: encoded[0] = bytes1(uint8(hbs + 0x81));
64: encoded[0] = bytes1(uint8(_len + _offset));
69: encoded[0] = bytes1(uint8(_offset + hbs + 56));
```
[29](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/RLPEncoder.sol#L29) | [29](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/RLPEncoder.sol#L29) | [34](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/RLPEncoder.sol#L34) | [64](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/RLPEncoder.sol#L64) | [69](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/RLPEncoder.sol#L69)

```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

95: return _addr == uint256(uint160(address(BASE_TOKEN_SYSTEM_CONTRACT))) || _addr == 0;
164: bytes memory encodedTo = RLPEncoder.encodeAddress(address(uint160(_transaction.to)));
232: bytes memory encodedTo = RLPEncoder.encodeAddress(address(uint160(_transaction.to)));
303: bytes memory encodedTo = RLPEncoder.encodeAddress(address(uint160(_transaction.to)));
375: address paymaster = address(uint160(_transaction.paymaster));
406: if (address(uint160(_transaction.paymaster)) != address(0)) {
```
[95](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L95) | [164](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L164) | [232](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L232) | [303](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L303) | [375](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L375) | [406](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L406)

```solidity
File: code/system-contracts/contracts/libraries/Utils.sol

46: codeLengthInWords = uint256(uint8(_bytecodeHash[2])) * 256 + uint256(uint8(_bytecodeHash[3]));
46: codeLengthInWords = uint256(uint8(_bytecodeHash[2])) * 256 + uint256(uint8(_bytecodeHash[3]));
93: hashedBytecode = (hashedBytecode | bytes32(uint256(1 << 248)));
```
[46](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L46) | [46](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L46) | [93](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L93)

```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

158: salt = bytes32(uint256(uint160(_l1Token)));
```
[158](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L158)

```solidity
File: code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol

30: l2Address = address(uint160(l1Address) + offset);
40: l1Address = address(uint160(l2Address) - offset);
```
[30](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol#L30) | [40](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol#L40)

```solidity
File: code/contracts/zksync/contracts/L2ContractHelper.sol

107: bytes32 senderBytes = bytes32(uint256(uint160(_sender)));
112: return address(uint160(uint256(data)));
```
[107](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/L2ContractHelper.sol#L107) | [112](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/L2ContractHelper.sol#L112)
</details>

### [N-101] Unused Event Declarations

Events that aren't emitted in the contract add unnecessary complexity to the codebase. 
Removing these unused events can streamline the contract, enhancing its readability and maintainability.

<details>
<summary><i>3 issue instances in 3 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol

/// @audit `EthWithdrawalFinalized` event declared but never emitted
134: event EthWithdrawalFinalized(address indexed to, uint256 amount);
```
[134](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L134)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol

/// @audit `ProposeTransparentUpgrade` event declared but never emitted
17: event ProposeTransparentUpgrade(
        Diamond.DiamondCutData diamondCut,
        uint256 indexed proposalId,
        bytes32 proposalSalt
    );
```
[17](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol#L17)

```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol

/// @audit `BaseTokenReceived` event declared but never emitted
22: event BaseTokenReceived(uint256 amount);
```
[22](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol#L22)
</details>

### [N-102] Non-assembly High-Level Solidity Functions Available

Usage of inline assembly can increase the complexity of a project and potentially introduce security risks. 
It's best to avoid using inline assembly where possible, especially when equivalent non-assembly methods are available.

<details>
<summary><i>7 issue instances in 4 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

357: assembly {
                callSuccess := call(gas(), _depositSender, _amount, 0, 0, 0, 0)
            }
446: assembly {
                callSuccess := call(gas(), l1Receiver, amount, 0, 0, 0, 0)
            }
```
[357](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L357) | [446](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L446)

```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

227: assembly {
            // Copy function signature and arguments from calldata at zero position into memory at pointer position
            calldatacopy(0, 0, calldatasize())
            // Call method of the hyperchain diamond contract returns 0 on error
            let result := call(gas(), contractAddress, 0, 0, calldatasize(), 0, 0)
            // Get the size of the last return data
            let size := returndatasize()
            // Copy the size length of bytes from return data at zero position to pointer position
            returndatacopy(0, 0, size)
            // Depending on the result value
            switch result
            case 0 {
                // End execution and revert state changes
                revert(0, size)
            }
227: assembly {
            // Copy function signature and arguments from calldata at zero position into memory at pointer position
            calldatacopy(0, 0, calldatasize())
            // Call method of the hyperchain diamond contract returns 0 on error
            let result := call(gas(), contractAddress, 0, 0, calldatasize(), 0, 0)
            // Get the size of the last return data
            let size := returndatasize()
            // Copy the size length of bytes from return data at zero position to pointer position
            returndatacopy(0, 0, size)
            // Depending on the result value
            switch result
            case 0 {
                // End execution and revert state changes
                revert(0, size)
            }
```
[227](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L227) | [227](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L227)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol

33: assembly {
            // The pointer to the free memory slot
            let ptr := mload(0x40)
            // Copy function signature and arguments from calldata at zero position into memory at pointer position
            calldatacopy(ptr, 0, calldatasize())
            // Delegatecall method of the implementation contract returns 0 on error
            let result := delegatecall(gas(), facetAddress, ptr, calldatasize(), 0, 0)
            // Get the size of the last return data
            let size := returndatasize()
            // Copy the size length of bytes from return data at zero position to pointer position
            returndatacopy(ptr, 0, size)
            // Depending on the result value
            switch result
            case 0 {
                // End execution and revert state changes
                revert(ptr, size)
            }
33: assembly {
            // The pointer to the free memory slot
            let ptr := mload(0x40)
            // Copy function signature and arguments from calldata at zero position into memory at pointer position
            calldatacopy(ptr, 0, calldatasize())
            // Delegatecall method of the implementation contract returns 0 on error
            let result := delegatecall(gas(), facetAddress, ptr, calldatasize(), 0, 0)
            // Get the size of the last return data
            let size := returndatasize()
            // Copy the size length of bytes from return data at zero position to pointer position
            returndatacopy(ptr, 0, size)
            // Depending on the result value
            switch result
            case 0 {
                // End execution and revert state changes
                revert(ptr, size)
            }
```
[33](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol#L33) | [33](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol#L33)

```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

399: assembly {
            success := call(gas(), bootloaderAddr, amount, 0, 0, 0, 0)
        }
```
[399](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L399)
</details>

### [N-103] Equal `block.timestamp` Cases Not Handled

Solidity code that checks if `block.timestamp` is greater than a certain variable but fails to handle the case when `block.timestamp` is equal to the variable may lead to unintended behaviors and potential vulnerabilities.

To ensure correct and secure function execution, it's recommended to include checks for cases where `block.timestamp` equals the compared variable.

<details>
<summary><i>1 issue instances in 1 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

111: } else if (timestamp > block.timestamp) {
```
[111](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L111)
</details>

### [N-104] `else`-block not required

In Solidity, if an `if` block contains a `return` statement, subsequent `else` blocks become unnecessary.
This is because the `return` statement halts the execution of the function at that point, making any `else` conditions redundant.
Therefore, omitting `else` after such `if` blocks can lead to cleaner and more readable code without any change in the functionality.

<details>
<summary><i>2 issue instances in 2 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

107: if (timestamp == 0) {
            return OperationState.Unset;
        } else if (timestamp == EXECUTED_PROPOSAL_TIMESTAMP) {
            return OperationState.Done;
        } else if (timestamp > block.timestamp) {
```
[107](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L107)

```solidity
File: code/system-contracts/contracts/NonceHolder.sol

169: if (isUsed && !_shouldBeUsed) {
            revert("Reusing the same nonce twice");
        } else if (!isUsed && _shouldBeUsed) {
            revert("The nonce was not set as used");
        }
```
[169](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L169)
</details>

### [N-105] Polymorphic functions make security audits more time-consuming and error-prone

While function overriding allows for functions with the same name to coexist, it's advisable to avoid this practice for the sake of readability and maintainability. 

Having multiple functions with the same name, even with different parameters or in inherited contracts, can cause confusion and increase the chance of errors during development, testing, and debugging.
Using distinct and descriptive function names not only clarifies the purpose and behavior of each function but also helps prevent unintended function calls or incorrect overriding.

<details>
<summary><i>4 issue instances in 1 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

98: function deposit(
        address _l2Receiver,
        address _l1Token,
        uint256 _amount,
        uint256 _l2TxGasLimit,
        uint256 _l2TxGasPerPubdataByte
    ) external payable returns (bytes32 l2TxHash) {
133: function deposit(
        address _l2Receiver,
        address _l1Token,
        uint256 _amount,
        uint256 _l2TxGasLimit,
        uint256 _l2TxGasPerPubdataByte,
        address _refundRecipient
    ) public payable nonReentrant returns (bytes32 l2TxHash) {
98: function deposit(
        address _l2Receiver,
        address _l1Token,
        uint256 _amount,
        uint256 _l2TxGasLimit,
        uint256 _l2TxGasPerPubdataByte
    ) external payable returns (bytes32 l2TxHash) {
133: function deposit(
        address _l2Receiver,
        address _l1Token,
        uint256 _amount,
        uint256 _l2TxGasLimit,
        uint256 _l2TxGasPerPubdataByte,
        address _refundRecipient
    ) public payable nonReentrant returns (bytes32 l2TxHash) {
```
[98](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L98) | [133](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L133) | [98](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L98) | [133](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L133)
</details>

### [N-106] Style guide: Function ordering does not follow the Solidity style guide

Ordering helps readers identify which functions they can call and to find the constructor and fallback definitions easier.
But there are contracts in the project that do not comply with this.
Functions should be grouped according to their visibility and ordered:
- constructor 
- receive function (if exists)
- fallback function (if exists)
- external
- public
- internal
- private.

<details>
<summary><i>88 issue instances in 21 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

/// @audit `internal` function `_depositFundsToSharedBridge()` declared before `external` function `claimFailedDeposit()`
160: function _depositFundsToSharedBridge(address _from, IERC20 _token, uint256 _amount) internal returns (uint256) {
176: function claimFailedDeposit(
        address _depositSender,
        address _l1Token,
        bytes32 _l2TxHash,
        uint256 _l2BatchNumber,
        uint256 _l2MessageIndex,
        uint16 _l2TxNumberInBatch,
        bytes32[] calldata _merkleProof
    ) external nonReentrant {
/// @audit `internal` function `_depositFundsToSharedBridge()` declared before `external` function `claimFailedDeposit()`
160: function _depositFundsToSharedBridge(address _from, IERC20 _token, uint256 _amount) internal returns (uint256) {
176: function claimFailedDeposit(
        address _depositSender,
        address _l1Token,
        bytes32 _l2TxHash,
        uint256 _l2BatchNumber,
        uint256 _l2MessageIndex,
        uint16 _l2TxNumberInBatch,
        bytes32[] calldata _merkleProof
    ) external nonReentrant {
```
[160](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L160) | [176](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L176) | [160](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L160) | [176](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L176)

```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

/// @audit `internal` function `_depositFunds()` declared before `external` function `bridgehubDeposit()`
173: function _depositFunds(address _from, IERC20 _token, uint256 _amount) internal returns (uint256) {
182: function bridgehubDeposit(
        uint256 _chainId,
        address _prevMsgSender,
        uint256, // l2Value, needed for Weth deposits in the future
        bytes calldata _data
    ) external payable override onlyBridgehub returns (L2TransactionRequestTwoBridgesInner memory request) {
/// @audit `internal` function `_getERC20Getters()` declared before `external` function `claimFailedDeposit()`
254: function _getERC20Getters(address _token) internal view returns (bytes memory) {
277: function claimFailedDeposit(
        uint256 _chainId,
        address _depositSender,
        address _l1Token,
        uint256 _amount,
        bytes32 _l2TxHash,
        uint256 _l2BatchNumber,
        uint256 _l2MessageIndex,
        uint16 _l2TxNumberInBatch,
        bytes32[] calldata _merkleProof
    ) external override {
/// @audit `internal` function `_isEraLegacyWithdrawal()` declared before `external` function `finalizeWithdrawal()`
374: function _isEraLegacyWithdrawal(uint256 _chainId, uint256 _l2BatchNumber) internal view returns (bool) {
385: function finalizeWithdrawal(
        uint256 _chainId,
        uint256 _l2BatchNumber,
        uint256 _l2MessageIndex,
        uint16 _l2TxNumberInBatch,
        bytes calldata _message,
        bytes32[] calldata _merkleProof
    ) external override {
/// @audit `internal` function `_parseL2WithdrawalMessage()` declared before `external` function `depositLegacyErc20Bridge()`
486: function _parseL2WithdrawalMessage(
        uint256 _chainId,
        bytes memory _l2ToL1message
    ) internal view returns (address l1Receiver, address l1Token, uint256 amount) {
554: function depositLegacyErc20Bridge(
        address _prevMsgSender,
        address _l2Receiver,
        address _l1Token,
        uint256 _amount,
        uint256 _l2TxGasLimit,
        uint256 _l2TxGasPerPubdataByte,
        address _refundRecipient
    ) external payable override onlyLegacyBridge nonReentrant returns (bytes32 l2TxHash) {
```
[173](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L173) | [182](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L182) | [254](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L254) | [277](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L277) | [374](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L374) | [385](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L385) | [486](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L486) | [554](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L554)

```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

/// @audit `public` function `getStateTransition()` declared before `external` function `addStateTransitionManager()`
75: function getStateTransition(uint256 _chainId) public view returns (address) {
82: function addStateTransitionManager(address _stateTransitionManager) external onlyOwner {
```
[75](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L75) | [82](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L82)

```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

/// @audit `public` function `getOperationState()` declared before `external` function `scheduleTransparent()`
105: function getOperationState(bytes32 _id) public view returns (OperationState) {
129: function scheduleTransparent(Operation calldata _operation, uint256 _delay) external onlyOwner {
/// @audit `internal` function `_checkPredecessorDone()` declared before `external` function `updateDelay()`
239: function _checkPredecessorDone(bytes32 _predecessorId) internal view {
249: function updateDelay(uint256 _newDelay) external onlySelf {
/// @audit `function` declared before `receive`
256: function updateSecurityCouncil(address _newSecurityCouncil) external onlySelf {
262: receive() external payable {}
```
[105](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L105) | [129](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L129) | [239](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L239) | [249](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L249) | [256](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L256) | [262](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L262)

```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

/// @audit `internal` function `_setChainIdUpgrade()` declared before `external` function `registerAlreadyDeployedStateTransition()`
177: function _setChainIdUpgrade(uint256 _chainId, address _chainContract) internal {
229: function registerAlreadyDeployedStateTransition(
        uint256 _chainId,
        address _stateTransitionContract
    ) external onlyOwner {
```
[177](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L177) | [229](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L229)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

/// @audit `internal` function `_processL2Logs()` declared before `external` function `commitBatches()`
130: function _processL2Logs(
        CommitBatchInfo calldata _newBatch,
        bytes32 _expectedSystemContractUpgradeTxHash
    ) internal pure returns (LogProcessingOutput memory logOutput) {
199: function commitBatches(
        StoredBatchInfo memory _lastCommittedBatchData,
        CommitBatchInfo[] calldata _newBatchesData
    ) external nonReentrant onlyValidator {
/// @audit `internal` function `_executeOneBatch()` declared before `external` function `executeBatchesSharedBridge()`
321: function _executeOneBatch(StoredBatchInfo memory _storedBatch, uint256 _executedBatchIdx) internal {
337: function executeBatchesSharedBridge(
        uint256,
        StoredBatchInfo[] calldata _batchesData
    ) external nonReentrant onlyValidator {
/// @audit `internal` function `_executeBatches()` declared before `external` function `proveBatches()`
348: function _executeBatches(StoredBatchInfo[] calldata _batchesData) internal {
368: function proveBatches(
        StoredBatchInfo calldata _prevBatch,
        StoredBatchInfo[] calldata _committedBatches,
        ProofInput calldata _proof
    ) external nonReentrant onlyValidator {
/// @audit `internal` function `_getBatchProofPublicInput()` declared before `external` function `revertBatches()`
453: function _getBatchProofPublicInput(
        bytes32 _prevBatchCommitment,
        bytes32 _currentBatchCommitment,
        VerifierParams memory _verifierParams
    ) internal pure returns (uint256) {
472: function revertBatches(uint256 _newLastBatch) external nonReentrant onlyValidatorOrStateTransitionManager {
```
[130](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L130) | [199](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L199) | [321](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L321) | [337](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L337) | [348](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L348) | [368](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L368) | [453](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L453) | [472](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L472)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

/// @audit `public` function `proveL2MessageInclusion()` declared before `external` function `proveL2LogInclusion()`
54: function proveL2MessageInclusion(
        uint256 _batchNumber,
        uint256 _index,
        L2Message memory _message,
        bytes32[] calldata _proof
    ) public view returns (bool) {
64: function proveL2LogInclusion(
        uint256 _batchNumber,
        uint256 _index,
        L2Log memory _log,
        bytes32[] calldata _proof
    ) external view returns (bool) {
/// @audit `internal` function `_L2MessageToLog()` declared before `public` function `l2TransactionBaseCost()`
130: function _L2MessageToLog(L2Message memory _message) internal pure returns (L2Log memory) {
143: function l2TransactionBaseCost(
        uint256 _gasPrice,
        uint256 _l2GasLimit,
        uint256 _l2GasPerPubdataByteLimit
    ) public view returns (uint256) {
/// @audit `internal` function `_deriveL2GasPrice()` declared before `external` function `finalizeEthWithdrawal()`
156: function _deriveL2GasPrice(uint256 _l1GasPrice, uint256 _gasPerPubdata) internal view returns (uint256) {
178: function finalizeEthWithdrawal(
        uint256 _l2BatchNumber,
        uint256 _l2MessageIndex,
        uint16 _l2TxNumberInBatch,
        bytes calldata _message,
        bytes32[] calldata _merkleProof
    ) external nonReentrant {
```
[54](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L54) | [64](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L64) | [130](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L130) | [143](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L143) | [156](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L156) | [178](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L178)

```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol

/// @audit `private` function `_setVerifierParams()` declared before `internal` function `_upgradeVerifier()`
142: function _setVerifierParams(VerifierParams calldata _newVerifierParams) private {
163: function _upgradeVerifier(address _newVerifier, VerifierParams calldata _verifierParams) internal {
/// @audit `private` function `_verifyFactoryDeps()` declared before `internal` function `_setNewProtocolVersion()`
222: function _verifyFactoryDeps(bytes[] calldata _factoryDeps, uint256[] calldata _expectedHashes) private pure {
236: function _setNewProtocolVersion(uint256 _newProtocolVersion) internal virtual {
```
[142](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L142) | [163](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L163) | [222](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L222) | [236](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L236)

```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol

/// @audit `internal` function `_setNewProtocolVersion()` declared before `public` function `upgrade()`
20: function _setNewProtocolVersion(uint256 _newProtocolVersion) internal override {
47: function upgrade(ProposedUpgrade calldata _proposedUpgrade) public virtual override returns (bytes32) {
```
[20](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L20) | [47](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L47)

```solidity
File: code/system-contracts/contracts/AccountCodeStorage.sol

/// @audit `internal` function `_storeCodeHash()` declared before `public` function `getRawCodeHash()`
68: function _storeCodeHash(address _address, bytes32 _hash) internal {
78: function getRawCodeHash(address _address) public view override returns (bytes32 codeHash) {
/// @audit `public` function `getRawCodeHash()` declared before `external` function `getCodeHash()`
78: function getRawCodeHash(address _address) public view override returns (bytes32 codeHash) {
89: function getCodeHash(uint256 _input) external view override returns (bytes32) {
```
[68](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/AccountCodeStorage.sol#L68) | [78](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/AccountCodeStorage.sol#L78) | [78](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/AccountCodeStorage.sol#L78) | [89](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/AccountCodeStorage.sol#L89)

```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

/// @audit `internal` function `_storeAccountInfo()` declared before `external` function `updateAccountVersion()`
58: function _storeAccountInfo(address _address, AccountInfo memory _newInfo) internal {
65: function updateAccountVersion(AccountAbstractionVersion _version) external onlySystemCall {
/// @audit `public` function `getNewAddressCreate()` declared before `external` function `create2()`
115: function getNewAddressCreate(
        address _sender,
        uint256 _senderNonce
    ) public pure override returns (address newAddress) {
132: function create2(
        bytes32 _salt,
        bytes32 _bytecodeHash,
        bytes calldata _input
    ) external payable override returns (address) {
/// @audit `public` function `createAccount()` declared before `external` function `forceDeployOnAddress()`
182: function createAccount(
        bytes32, // salt
        bytes32 _bytecodeHash,
        bytes calldata _input,
        AccountAbstractionVersion _aaVersion
    ) public payable override onlySystemCall returns (address) {
213: function forceDeployOnAddress(ForceDeployment calldata _deployment, address _sender) external payable onlySelf {
```
[58](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L58) | [65](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L65) | [115](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L115) | [132](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L132) | [182](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L182) | [213](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L213)

```solidity
File: code/system-contracts/contracts/DefaultAccount.sol

/// @audit `internal` function `_validateTransaction()` declared before `external` function `executeTransaction()`
78: function _validateTransaction(
        bytes32 _suggestedSignedHash,
        Transaction calldata _transaction
    ) internal returns (bytes4 magic) {
112: function executeTransaction(
        bytes32, // _txHash
        bytes32, // _suggestedSignedHash
        Transaction calldata _transaction
    ) external payable override ignoreNonBootloader ignoreInDelegateCall {
/// @audit `internal` function `_isValidSignature()` declared before `external` function `payForTransaction()`
159: function _isValidSignature(bytes32 _hash, bytes memory _signature) internal view returns (bool) {
196: function payForTransaction(
        bytes32, // _txHash
        bytes32, // _suggestedSignedHash
        Transaction calldata _transaction
    ) external payable ignoreNonBootloader ignoreInDelegateCall {
/// @audit `function` declared before `fallback`
212: function prepareForPaymaster(
        bytes32, // _txHash
        bytes32, // _suggestedSignedHash
        Transaction calldata _transaction
    ) external payable ignoreNonBootloader ignoreInDelegateCall {
219: fallback() external payable ignoreInDelegateCall {
/// @audit `fallback` declared before `receive`
219: fallback() external payable ignoreInDelegateCall {
226: receive() external payable {
```
[78](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L78) | [112](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L112) | [159](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L159) | [196](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L196) | [212](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L212) | [219](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L219) | [219](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L219) | [226](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L226)

```solidity
File: code/system-contracts/contracts/EmptyContract.sol

/// @audit `fallback` declared before `receive`
11: fallback() external payable {}
12: receive() external payable {}
```
[11](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/EmptyContract.sol#L11) | [12](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/EmptyContract.sol#L12)

```solidity
File: code/system-contracts/contracts/KnownCodesStorage.sol

/// @audit `internal` function `_markBytecodeAsPublished()` declared before `public` function `getMarker()`
46: function _markBytecodeAsPublished(bytes32 _bytecodeHash, bool _shouldSendToL1) internal {
65: function getMarker(bytes32 _hash) public view override returns (uint256 marker) {
```
[46](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/KnownCodesStorage.sol#L46) | [65](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/KnownCodesStorage.sol#L65)

```solidity
File: code/system-contracts/contracts/L1Messenger.sol

/// @audit `internal` function `sha256GasCost()` declared before `external` function `sendL2ToL1Log()`
61: function sha256GasCost(uint256 _length) internal pure returns (uint256) {
70: function sendL2ToL1Log(
        bool _isService,
        bytes32 _key,
        bytes32 _value
    ) external onlyCallFromSystemContract returns (uint256 logIdInMerkleTree) {
/// @audit `internal` function `_processL2ToL1Log()` declared before `external` function `sendToL1()`
94: function _processL2ToL1Log(L2ToL1Log memory _l2ToL1Log) internal returns (uint256 logIdInMerkleTree) {
116: function sendToL1(bytes calldata _message) external override returns (bytes32 hash) {
```
[61](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L61) | [70](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L70) | [94](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L94) | [116](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L116)

```solidity
File: code/system-contracts/contracts/L2BaseToken.sol

/// @audit `internal` function `_getExtendedWithdrawMessage()` declared before `external` function `name()`
117: function _getExtendedWithdrawMessage(
        address _to,
        uint256 _amount,
        address _sender,
        bytes memory _additionalData
    ) internal pure returns (bytes memory) {
128: function name() external pure override returns (string memory) {
```
[117](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L2BaseToken.sol#L117) | [128](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L2BaseToken.sol#L128)

```solidity
File: code/system-contracts/contracts/MsgValueSimulator.sol

/// @audit `function` declared before `fallback`
25: function _getAbiParams() internal view returns (uint256 value, bool isSystemCall, address to) {
47: fallback(bytes calldata _data) external onlySystemCall returns (bytes memory) {
```
[25](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/MsgValueSimulator.sol#L25) | [47](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/MsgValueSimulator.sol#L47)

```solidity
File: code/system-contracts/contracts/NonceHolder.sol

/// @audit `public` function `getValueUnderNonce()` declared before `external` function `incrementMinNonceIfEquals()`
102: function getValueUnderNonce(uint256 _key) public view returns (uint256) {
110: function incrementMinNonceIfEquals(uint256 _expectedNonce) external onlySystemCall {
/// @audit `public` function `isNonceUsed()` declared before `external` function `validateNonceUsage()`
154: function isNonceUsed(address _address, uint256 _nonce) public view returns (bool) {
166: function validateNonceUsage(address _address, uint256 _key, bool _shouldBeUsed) external view {
```
[102](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L102) | [110](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L110) | [154](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L154) | [166](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L166)

```solidity
File: code/system-contracts/contracts/SystemContext.sol

/// @audit `public` function `getCurrentPubdataSpent()` declared before `external` function `getCurrentPubdataCost()`
116: function getCurrentPubdataSpent() public view returns (uint256) {
121: function getCurrentPubdataCost() external view returns (uint256) {
/// @audit `internal` function `_setNewL2BlockData()` declared before `external` function `setL2Block()`
314: function _setNewL2BlockData(uint128 _l2BlockNumber, uint128 _l2BlockTimestamp, bytes32 _prevL2BlockHash) internal {
341: function setL2Block(
        uint128 _l2BlockNumber,
        uint128 _l2BlockTimestamp,
        bytes32 _expectedPrevL2BlockHash,
        bool _isFirstInBatch,
        uint128 _maxVirtualBlocksToCreate
    ) external onlyCallFromBootloader {
/// @audit `internal` function `_ensureBatchConsistentWithL2Block()` declared before `external` function `setNewBatch()`
427: function _ensureBatchConsistentWithL2Block(uint128 _newTimestamp) internal view {
444: function setNewBatch(
        bytes32 _prevBatchHash,
        uint128 _newTimestamp,
        uint128 _expectedNewNumber,
        uint256 _baseFee
    ) external onlyCallFromBootloader {
```
[116](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L116) | [121](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L121) | [314](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L314) | [341](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L341) | [427](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L427) | [444](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L444)

```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

/// @audit `internal` function `_deployL2Token()` declared before `external` function `withdraw()`
109: function _deployL2Token(address _l1Token, bytes calldata _data) internal returns (address) {
123: function withdraw(address _l1Receiver, address _l2Token, uint256 _amount) external override {
/// @audit `internal` function `_getL1WithdrawMessage()` declared before `public` function `l2TokenAddress()`
138: function _getL1WithdrawMessage(
        address _to,
        address _l1Token,
        uint256 _amount
    ) internal pure returns (bytes memory) {
149: function l2TokenAddress(address _l1Token) public view override returns (address) {
```
[109](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L109) | [123](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L123) | [138](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L138) | [149](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L149)

```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

/// @audit `public` function `decimals()` declared before `external` function `decodeString()`
170: function decimals() public view override returns (uint8) {
178: function decodeString(bytes memory _input) external pure returns (string memory result) {
```
[170](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L170) | [178](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L178)
</details>

### [N-107] Style guide: Lines are too long

It is generally recommended that lines in the source code should not exceed 80-120 characters.
Multiline output parameters and return statements should follow the same style recommended for wrapping long lines found in the Maximum Line Length section.

<details>
<summary><i>171 issue instances in 46 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

31: /// @dev Used for saving the number of deposited funds, to claim them in case the deposit transaction will fail in zkSync Era.
31: /// @dev Used for saving the number of deposited funds, to claim them in case the deposit transaction will fail in zkSync Era.
```
[31](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L31) | [31](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L31)

```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

21: import {ERA_CHAIN_ID, ERA_ERC20_BRIDGE_ADDRESS, ETH_TOKEN_ADDRESS, ERA_DIAMOND_PROXY, TWO_BRIDGES_MAGIC_VALUE} from "../common/Config.sol";
43: /// This variable is used to differentiate between pre-upgrade and post-upgrade withdrawals. Withdrawals from batches older
47: /// @dev A mapping chainId => bridgeProxy. Used to store the bridge proxy's address, and to see if it has been deployed yet.
57: mapping(uint256 chainId => mapping(uint256 l2BatchNumber => mapping(uint256 l2ToL1MessageNumber => bool isFinalized)))
103: /// implementation. The owner is the Governor and separate from the ProxyAdmin from now on, so that the Governor can call the bridge.
160: uint256 amount = _depositFunds(_prevMsgSender, IERC20(_l1Token), _amount); // note if _prevMsgSender is this contract, this will return 0. This does not happen.
167: // Note that we don't save the deposited amount, as this is for the base token, which gets sent to the refundRecipient if the tx fails
230: /// @notice Confirms the acceptance of a transaction by the Mailbox, as part of the L2 transaction process within Bridgehub.
332: // Deposits that happened before the upgrade cannot be checked here, they have to be claimed and checked in the legacyBridge
494: // It should be equal to the length of the bytes4 function signature + address l1Receiver + uint256 amount = 4 + 20 + 32 = 56 (bytes).
515: // It should be equal to the length of the function signature + address + address + uint256 = 4 + 20 + 20 + 32 =
587: mintValue: msg.value, // l2 gas + l2 msg.Value the bridgehub will withdraw the mintValue from the base token bridge for gas
588: l2Value: 0, // L2 msg.value, this contract doesn't support base token deposits or wrapping functionality, for direct deposits use bridgehub
```
[21](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L21) | [43](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L43) | [47](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L47) | [57](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L57) | [103](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L103) | [160](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L160) | [167](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L167) | [230](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L230) | [332](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L332) | [494](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L494) | [515](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L515) | [587](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L587) | [588](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L588)

```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

62: require(msg.sender == currentPendingAdmin, "n42"); // Only proposed by current admin address can claim the admin rights
216: /// This means this is not ideal for contract calls, as the contract would have to handle token allowance of the base Token
```
[62](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L62) | [216](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L216)

```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

19: import {REQUIRED_L2_GAS_PRICE_PER_PUBDATA, L2_TO_L1_LOG_SERIALIZE_SIZE, DEFAULT_L2_LOGS_TREE_ROOT_HASH, EMPTY_STRING_KECCAK, SYSTEM_UPGRADE_L2_TX_TYPE, ERA_DIAMOND_PROXY, ERA_CHAIN_ID} from "../common/Config.sol";
121: require(msg.sender == currentPendingAdmin, "n42"); // Only proposed by current admin address can claim the admin rights
```
[19](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L19) | [121](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L121)

```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

13: /// @notice Intermediate smart contract between the validator EOA account and the hyperchains state transition diamond smart contract.
15: /// modifying the main hyperchain diamond contract. As such, even if this contract is compromised, it will not impact the main
```
[13](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L13) | [15](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L15)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol

69: /// @notice Address which will exercise critical changes to the Diamond Proxy (upgrades, freezing & unfreezing). Replaced by STM
149: /// @notice gasPriceMultiplier for each baseToken, so that each L1->L2 transaction pays for its transaction on the destination
```
[69](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L69) | [149](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L149)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol

90: require(s.totalBatchesCommitted == 0, "AdminFacet: set validium only after genesis"); // Validium mode can be set only before the first batch is committed
```
[90](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L90)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

6: import {COMMIT_TIMESTAMP_NOT_OLDER, COMMIT_TIMESTAMP_APPROXIMATION_DELTA, EMPTY_STRING_KECCAK, L2_TO_L1_LOG_SERIALIZE_SIZE, MAX_L2_TO_L1_LOGS_COMMITMENT_BYTES, PACKED_L2_BLOCK_TIMESTAMP_MASK, PUBLIC_INPUT_SHIFT, POINT_EVALUATION_PRECOMPILE_ADDR} from "../../../common/Config.sol";
7: import {IExecutor, L2_LOG_ADDRESS_OFFSET, L2_LOG_KEY_OFFSET, L2_LOG_VALUE_OFFSET, SystemLogKey, LogProcessingOutput, PubdataSource, BLS_MODULUS, PUBDATA_COMMITMENT_SIZE, PUBDATA_COMMITMENT_CLAIMED_VALUE_OFFSET, PUBDATA_COMMITMENT_COMMITMENT_OFFSET, MAX_NUMBER_OF_BLOBS, TOTAL_BLOBS_IN_COMMITMENT} from "../../chain-interfaces/IExecutor.sol";
12: import {L2_BOOTLOADER_ADDRESS, L2_TO_L1_MESSENGER_SYSTEM_CONTRACT_ADDR, L2_SYSTEM_CONTEXT_SYSTEM_CONTRACT_ADDR, L2_PUBDATA_CHUNK_PUBLISHER_ADDR} from "../../../common/L2ContractAddresses.sol";
57: // In this scenario, pubdataCommitments is a list of: opening point (16 bytes) || claimed value (32 bytes) || commitment (48 bytes) || proof (48 bytes)) = 144 bytes
60: // In this scenario pubdataCommitments is actual pubdata consisting of l2 to l1 logs, l2 to l1 message, compressed smart contract bytecode, and compressed state diffs
100: /// @param _packedBatchAndL2BlockTimestamp - packed batch and L2 block timestamp in a format of batchTimestamp * 2**128 + l2BatchTimestamp
122: require(block.timestamp - COMMIT_TIMESTAMP_NOT_OLDER <= batchTimestamp, "h1"); // New batch timestamp is too small
123: require(lastL2BlockTimestamp <= block.timestamp + COMMIT_TIMESTAMP_APPROXIMATION_DELTA, "h2"); // The last L2 block timestamp is too big
221: // 1. A chain has to keep their protocol version up to date, as processing a block requires the latest or previous protocol version
222: // to solve this we will need to add the feature to create batches with only the protocol upgrade tx, without any other txs.
223: // 2. A chain might become out of sync if it launches while we are in the middle of a protocol upgrade. This would mean they cannot process their genesis upgrade
224: // as thier protocolversion would be outdated, and they also cannot process the protocol upgrade tx as they have a pending upgrade.
225: // 3. The protocol upgrade is increased in the BaseZkSyncUpgrade, in the executor only the systemContractsUpgradeTxHash is checked
230: // With the new changes for EIP-4844, namely the restriction on number of blobs per block, we only allow for a single batch to be committed at a time.
233: require(s.storedBatchHashes[s.totalBatchesCommitted] == _hashStoredBatchInfo(_lastCommittedBatchData), "i"); // incorrect previous batch data
282: // While the logic of the contract ensures that the s.l2SystemContractsUpgradeBatchNumber is 0 when this function is called,
330: require(priorityOperationsHash == _storedBatch.priorityOperationsHash, "x"); // priority operations hash does not match to expected
358: require(newTotalBatchesExecuted <= s.totalBatchesVerified, "n"); // Can't execute batches more than committed and proven currently.
532: // VM 1.5.0 requires us to pass the EVM simulator code hash. For now it is the same as the default account.
615: // response is equal to BLS_MODULUS as defined in https://eips.ethereum.org/EIPS/eip-4844#point-evaluation-precompile
621: /// @dev Verifies that the blobs contain the correct data by calling the point evaluation precompile. For the precompile we need:
624: /// pubdataCommitments is a list of: opening point (16 bytes) || claimed value (32 bytes) || commitment (48 bytes) || proof (48 bytes)) = 144 bytes
```
[6](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L6) | [7](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L7) | [12](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L12) | [57](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L57) | [60](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L60) | [100](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L100) | [122](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L122) | [123](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L123) | [221](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L221) | [222](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L222) | [223](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L223) | [224](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L224) | [225](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L225) | [230](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L230) | [233](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L233) | [282](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L282) | [330](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L330) | [358](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L358) | [532](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L532) | [615](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L615) | [621](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L621) | [624](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L624)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

11: import {WritePriorityOpParams, L2CanonicalTransaction, L2Message, L2Log, TxStatus, BridgehubL2TransactionRequest} from "../../../common/Messaging.sol";
18: import {REQUIRED_L2_GAS_PRICE_PER_PUBDATA, L1_GAS_PER_PUBDATA_BYTE, L2_L1_LOGS_TREE_DEFAULT_LEAF_HASH, PRIORITY_OPERATION_L2_TX_TYPE, PRIORITY_EXPIRATION, MAX_NEW_FACTORY_DEPS, ETH_TOKEN_ADDRESS, ERA_CHAIN_ID} from "../../../common/Config.sol";
19: import {L2_BOOTLOADER_ADDRESS, L2_TO_L1_MESSENGER_SYSTEM_CONTRACT_ADDR, L2_BASE_TOKEN_SYSTEM_CONTRACT_ADDR} from "../../../common/L2ContractAddresses.sol";
90: // - l2ShardId = 0 (means that L1 -> L2 transaction was processed in a rollup shard, other shards are not available yet anyway)
232: // Please note, currently zkSync address derivation is different from Ethereum one, but it may be changed in the future.
239: // to ensure that users do not get used to using "exotic" numbers for _request.l2GasPerPubdataByteLimit, e.g. 1-2, etc.
240: // VERY IMPORTANT: nobody should rely on this constant to be fixed and every contract should give their users the ability to provide the
```
[11](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L11) | [18](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L18) | [19](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L19) | [90](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L90) | [232](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L232) | [239](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L239) | [240](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L240)

```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol

11: import {MAX_NEW_FACTORY_DEPS, SYSTEM_UPGRADE_L2_TX_TYPE, MAX_ALLOWED_PROTOCOL_VERSION_DELTA} from "../common/Config.sol";
143: // An upgrade to the verifier params must be done carefully to ensure there aren't batches in the committed state
145: // Batches committed expecting the old verifier params will fail. Ensure all commited batches are finalized before the
```
[11](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L11) | [143](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L143) | [145](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L145)

```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol

11: import {MAX_NEW_FACTORY_DEPS, SYSTEM_UPGRADE_L2_TX_TYPE, MAX_ALLOWED_PROTOCOL_VERSION_DELTA} from "../common/Config.sol";
```
[11](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L11)

```solidity
File: code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol

9: * @dev Each of the functions accepts the `bytes memory` and the offset where data should be read and returns a value of a certain type.
```
[9](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol#L9)

```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol

16: /// @dev Used to distinguish calls to contracts that were supposed to be used as diamond initializer from other contracts.
22: 0xc8fcad8db84d3cc18b4c41d551ea0ee66dd599cde068d998e57d5e09332c131b; // keccak256("diamond.standard.diamond.storage") - 1;
161: require(oldFacet.facetAddress != address(0), "L"); // it is impossible to replace the facet with zero address
```
[16](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L16) | [22](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L22) | [161](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L161)

```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/LibMap.sol

6: /// @dev This library is an adaptation of the corresponding Solady library (https://github.com/vectorized/solady/blob/main/src/utils/LibMap.sol)
60: // shifted to its proper position. The XOR operation will effectively replace the old value with the new value.
```
[6](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/LibMap.sol#L6) | [60](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/LibMap.sol#L60)

```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol

13: /// NOTE: When using this function, check that the _path length is equal to the tree height to prevent shorter/longer paths attack
```
[13](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol#L13)

```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol

39: /// @return The total number of priority operations that were added to the priority queue, including all processed ones
```
[39](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L39)

```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol

8: import {TX_SLOT_OVERHEAD_L2_GAS, MEMORY_OVERHEAD_GAS, L1_TX_INTRINSIC_L2_GAS, L1_TX_DELTA_544_ENCODING_BYTES, L1_TX_DELTA_FACTORY_DEPS_L2_GAS, L1_TX_MIN_L2_GAS_BASE, L1_TX_INTRINSIC_PUBDATA, L1_TX_DELTA_FACTORY_DEPS_PUBDATA} from "../../common/Config.sol";
68: /// Note: The calculation includes the main cost of the priority transaction, however, in reality, the operator can spend a little more gas on overheads.
107: /// and the L2 gas needed to process the transaction itself (i.e. the actual l2GasLimit that will be used for the transaction).
```
[8](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L8) | [68](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L68) | [107](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L107)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol

21: /// @dev Enum used to determine the source of pubdata. At first we will support calldata and blobs but this can be extended.
45: /// @dev Offset used to pull Value From Log. Equal to 4 (bytes for isService) + 20 (bytes for address) + 32 (bytes for key)
53: /// @dev Format: list of: opening point (16 bytes) || claimed value (32 bytes) || commitment (48 bytes) || proof (48 bytes)) = 144 bytes
77: /// @param indexRepeatedStorageChanges The serial number of the shortcut index that's used as a unique identifier for storage keys that were used twice or more
97: /// @param indexRepeatedStorageChanges The serial number of the shortcut index that's used as a unique identifier for storage keys that were used twice or more
101: /// @param bootloaderHeapInitialContentsHash Hash of the initial contents of the bootloader heap. In practice it serves as the commitment to the transactions in the batch.
102: /// @param eventsQueueStateHash Hash of the events queue state. In practice it serves as the commitment to the events in the batch.
105: /// @dev pubdataCommitments format: This will always start with a 1 byte pubdataSource flag. Current allowed values are 0 (calldata) or 1 (blobs)
106: ///                             kzg: list of: opening point (16 bytes) || claimed value (32 bytes) || commitment (48 bytes) || proof (48 bytes) = 144 bytes
108: ///                                       and 32 bytes appended to serve as the blob commitment part for the aux output part of the batch commitment
110: /// @dev When using calldata, we only need to send one blob commitment since the max number of bytes in calldata fits in a single blob and we can pull the
196: /// @dev It has the name "BlocksVerification" and not "BatchesVerification" due to backward compatibility considerations
```
[21](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L21) | [45](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L45) | [53](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L53) | [77](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L77) | [97](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L97) | [101](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L101) | [102](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L102) | [105](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L105) | [106](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L106) | [108](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L108) | [110](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L110) | [196](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L196)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol

10: /// @title The interface of the Getters Contract that implements functions for getting contract state from outside the blockchain.
48: /// @return The total number of priority operations that were added to the priority queue, including all processed ones
54: /// in case exactly *unprocessed* transactions are needed, one should check that getPriorityQueueSize() is greater than 0.
111: /// @return the baseTokenGasPriceMultiplierNominator, used to compare the baseTokenPrice to ether for L1->L2 transactions
114: /// @return the baseTokenGasPriceMultiplierDenominator, used to compare the baseTokenPrice to ether for L1->L2 transactions
```
[10](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L10) | [48](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L48) | [54](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L54) | [111](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L111) | [114](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L114)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol

6: import {L2CanonicalTransaction, L2Log, L2Message, TxStatus, BridgehubL2TransactionRequest} from "../../common/Messaging.sol";
15: /// @param _message Information about the sent message: sender address, the message itself, tx index in the L2 batch where the message was sent
46: /// NOTE: It may return `false` for incorrect proof, but it doesn't mean that the L1 -> L2 transaction has an opposite status!
75: /// @param _l2GasPerPubdataByteLimit The maximum amount L2 gas that the operator may charge the user for single byte of pubdata.
79: /// Please note, the contract may change the refund recipient's address to eliminate sending funds to addresses out of control.
81: /// - If `_refundRecipient` is set to `address(0)` and the sender has NO deployed bytecode on L1, the refund will be sent to the `msg.sender` address.
82: /// - If `_refundRecipient` is set to `address(0)` and the sender has deployed bytecode on L1, the refund will be sent to the aliased `msg.sender` address.
83: /// @dev The address aliasing of L1 contracts as refund recipient on L2 is necessary to guarantee that the funds are controllable,
85: /// Without address aliasing for L1 contracts as refund recipients they would not be able to make proper L2 tx requests
87: /// @return canonicalTxHash The hash of the requested L2 transaction. This hash can be used to follow the transaction status
105: /// @param _l2GasPerPubdataByteLimit The maximum amount of L2 gas that the operator may charge the user for a single byte of pubdata.
```
[6](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L6) | [15](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L15) | [46](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L46) | [75](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L75) | [79](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L79) | [81](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L81) | [82](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L82) | [83](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L83) | [85](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L85) | [87](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L87) | [105](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L105)

```solidity
File: code/contracts/ethereum/contracts/common/ReentrancyGuard.sol

32: // https://github.com/OpenZeppelin/openzeppelin-contracts/blob/566a774222707e424896c0c390a84dc3c13bdcb2/contracts/security/ReentrancyGuard.sol
```
[32](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/ReentrancyGuard.sol#L32)

```solidity
File: code/system-contracts/contracts/AccountCodeStorage.sol

14: * the second byte denotes whether the contract is constructed, and the next two bytes denote the length in 32-byte words.
17: * @dev The length of each bytecode MUST be odd.  It's internal code format requirements, due to padding of SHA256 function.
```
[14](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/AccountCodeStorage.sol#L14) | [17](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/AccountCodeStorage.sol#L17)

```solidity
File: code/system-contracts/contracts/BootloaderUtilities.sol

6: import {Transaction, TransactionHelper, EIP_712_TX_TYPE, LEGACY_TX_TYPE, EIP_2930_TX_TYPE, EIP_1559_TX_TYPE} from "./libraries/TransactionHelper.sol";
21: /// @return txHash and signedTxHash of the transaction, i.e. the transaction hash to be used in the explorer and commits to all
```
[6](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L6) | [21](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L21)

```solidity
File: code/system-contracts/contracts/ComplexUpgrader.sol

11: * @notice Upgrader which should be used to perform complex multistep upgrades on L2. In case some custom logic for an upgrade is needed
```
[11](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ComplexUpgrader.sol#L11)

```solidity
File: code/system-contracts/contracts/Compressor.sol

5: import {ICompressor, OPERATION_BITMASK, LENGTH_BITS_OFFSET, MAX_ENUMERATION_INDEX_SIZE} from "./interfaces/ICompressor.sol";
10: import {L1_MESSENGER_CONTRACT, INITIAL_WRITE_STARTING_POSITION, COMPRESSED_INITIAL_WRITE_SIZE, STATE_DIFF_ENTRY_SIZE, STATE_DIFF_ENUM_INDEX_OFFSET, STATE_DIFF_FINAL_VALUE_OFFSET, STATE_DIFF_DERIVED_KEY_OFFSET, DERIVED_KEY_LENGTH, VALUE_LENGTH, ENUM_INDEX_LENGTH, KNOWN_CODE_STORAGE_CONTRACT} from "./Constants.sol";
17: * @dev Every deployed bytecode/published state diffs in zkEVM should be publicly restorable from the L1 data availability.
41: /// @dev Currently, the method may be called only from the bootloader because the server is not ready to publish bytecodes
43: /// @dev Read more about the compression: https://github.com/matter-labs/zksync-era/blob/main/docs/guides/advanced/compression.md
82: /// @dev We don't verify that the size of {_stateDiffs} is equivalent to {_numberOfStateDiffs} * STATE_DIFF_ENTRY_SIZE since that check is
85: /// @dev This check assumes that the ordering of state diffs are sorted by (address, key) for the encoded state diffs and
87: /// @dev state diff:   [20bytes address][32bytes key][32bytes derived key][8bytes enum index][32bytes initial value][32bytes final value]
208: /// @notice Verify value compression was done correct given initial value, final value, operation, and compressed value
213: /// value or difference between initial and final value. It should be of arbitrary length less than or equal to 32 bytes.
214: /// @dev It is the responsibility of the caller of this function to ensure that the `_compressedValue` has length no longer than 32 bytes.
```
[5](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L5) | [10](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L10) | [17](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L17) | [41](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L41) | [43](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L43) | [82](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L82) | [85](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L85) | [87](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L87) | [208](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L208) | [213](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L213) | [214](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L214)

```solidity
File: code/system-contracts/contracts/Constants.sol

40: /// - That it is not possible that the pubdata counter grows too high without spending proportional amount of computation.
74: ISystemContext constant REAL_SYSTEM_CONTEXT_CONTRACT = ISystemContext(payable(address(REAL_SYSTEM_CONTRACTS_OFFSET + 0x0b)));
78: // It will be a different value for tests, while shouldn't. But for now, this constant is not used by other contracts, so that's fine.
103: /// @dev Each state diff consists of 156 bytes of actual data and 116 bytes of unused padding, needed for circuit efficiency.
106: /// @dev While the "real" amount of pubdata that can be sent rarely exceeds the BLOB_SIZE_BYTES * MAX_NUMBER_OF_BLOBS, it is better to
```
[40](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L40) | [74](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L74) | [78](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L78) | [103](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L103) | [106](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L106)

```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

7: import {CREATE2_PREFIX, CREATE_PREFIX, NONCE_HOLDER_SYSTEM_CONTRACT, ACCOUNT_CODE_STORAGE_SYSTEM_CONTRACT, FORCE_DEPLOYER, MAX_SYSTEM_CONTRACT_ADDRESS, KNOWN_CODE_STORAGE_CONTRACT, BASE_TOKEN_SYSTEM_CONTRACT, IMMUTABLE_SIMULATOR_SYSTEM_CONTRACT, COMPLEX_UPGRADER_CONTRACT, KECCAK256_SYSTEM_CONTRACT} from "./Constants.sol";
216: // Since the `forceDeployOnAddress` function is called only during upgrades, the Governance is trusted to correctly select
217: // the addresses to deploy the new bytecodes to and to assess whether overriding the AccountInfo for the "force-deployed"
```
[7](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L7) | [216](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L216) | [217](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L217)

```solidity
File: code/system-contracts/contracts/DefaultAccount.sol

9: import {BOOTLOADER_FORMAL_ADDRESS, NONCE_HOLDER_SYSTEM_CONTRACT, DEPLOYER_SYSTEM_CONTRACT, INonceHolder} from "./Constants.sol";
```
[9](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L9)

```solidity
File: code/system-contracts/contracts/KnownCodesStorage.sol

15: * the second byte denotes whether the contract is constructed, and the next two bytes denote the length in 32-byte words.
```
[15](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/KnownCodesStorage.sol#L15)

```solidity
File: code/system-contracts/contracts/L1Messenger.sol

5: import {IL1Messenger, L2ToL1Log, L2_L1_LOGS_TREE_DEFAULT_LEAF_HASH, L2_TO_L1_LOG_SERIALIZE_SIZE, STATE_DIFF_COMPRESSION_VERSION_NUMBER} from "./interfaces/IL1Messenger.sol";
10: import {SystemLogKey, SYSTEM_CONTEXT_CONTRACT, KNOWN_CODE_STORAGE_CONTRACT, COMPRESSOR_CONTRACT, STATE_DIFF_ENTRY_SIZE, MAX_ALLOWED_PUBDATA_PER_BATCH, L2_TO_L1_LOGS_MERKLE_TREE_LEAVES, PUBDATA_CHUNK_PUBLISHER, COMPUTATIONAL_PRICE_FOR_PUBDATA} from "./Constants.sol";
187: ///        processed in the current L1 Batch. Pubdata consists of L2 to L1 Logs, messages, deployed bytecode, and state diffs.
190: /// @dev The data passed in also contains the encoded state diffs to be checked again, however this is aux data that is not
277: /// body (`compressedStateDiffSize` bytes, 4 bytes number of state diffs, `numberOfStateDiffs` * `STATE_DIFF_ENTRY_SIZE` bytes for the uncompressed state diffs)
278: /// encoded state diffs: [20bytes address][32bytes key][32bytes derived key][8bytes enum index][32bytes initial value][32bytes final value]
```
[5](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L5) | [10](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L10) | [187](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L187) | [190](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L190) | [277](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L277) | [278](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L278)

```solidity
File: code/system-contracts/contracts/L2BaseToken.sol

7: import {MSG_VALUE_SYSTEM_CONTRACT, DEPLOYER_SYSTEM_CONTRACT, BOOTLOADER_FORMAL_ADDRESS, L1_MESSENGER_CONTRACT} from "./Constants.sol";
14: * @dev It does NOT provide interfaces for personal interaction with tokens like `transfer`, `approve`, and `transferFrom`.
82: /// @notice Initiate the ETH withdrawal, with the sent message. The funds will be available to claim on L1 `finalizeEthWithdrawal` method.
```
[7](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L2BaseToken.sol#L7) | [14](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L2BaseToken.sol#L14) | [82](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L2BaseToken.sol#L82)

```solidity
File: code/system-contracts/contracts/MsgValueSimulator.sol

40: /// It is equal to the following constant: https://github.com/matter-labs/era-zkevm_opcode_defs/blob/7bf8016f5bb13a73289f321ad6ea8f614540ece9/src/system_params.rs#L96.
```
[40](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/MsgValueSimulator.sol#L40)

```solidity
File: code/system-contracts/contracts/NonceHolder.sol

24: * @dev The behavior of some of the methods depends on the nonce ordering of the account. Nonce ordering is a mere suggestion and all the checks that are present
```
[24](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L24)

```solidity
File: code/system-contracts/contracts/PubdataChunkPublisher.sol

20: /// @dev We always publish 2 system logs even if our pubdata fits into a single blob. This makes processing logs on L1 easier.
```
[20](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/PubdataChunkPublisher.sol#L20)

```solidity
File: code/system-contracts/contracts/SystemContext.sol

21: /// - Store the latest 256 hashes (and strictly rely that we do not accidentally override the hash of the block 256 blocks ago)
65: /// of the miniblocks cheaper, we only store the previous MINIBLOCK_HASHES_TO_STORE ones. Since whenever we need to publish a state
67: /// By having this data in a cyclic array of MINIBLOCK_HASHES_TO_STORE blocks, we bring the costs down by 40% (i.e. 40 bytes per miniblock instead of 64 bytes).
69: /// @dev Hashes of the blocks older than the ones which are stored here can be calculated as _calculateLegacyL2BlockHash(blockNumber).
74: /// - Their number will start from being equal to the number of the batch and it will increase until it reaches the L2 block number.
79: /// @notice The information about the virtual blocks upgrade, which tracks when the migration to the L2 blocks has started and finished.
139: // 2. If the block was created before the upgrade for the virtual blocks (i.e. there we used to use hashes of the batches),
142: // all the information which is returned for users should be for L2 blocks, we return the hash of the corresponding L2 block.
156: // Important: we do not want this number to ever collide with the L2 block hash (either new or old one) and so
157: // that's why the legacy L2 blocks' hashes are keccak256(abi.encodePacked(uint32(_block))), while these are equivalent to
281: // Note, that when setting the virtual block number we use the batch number to make a smoother upgrade from batch number to
299: // We do not use a `require` here, since the virtual blocks are a temporary solution to let the Solidity's `block.number`
340: /// @dev It is also enforced that the number of the current virtual L2 block can not exceed the number of the L2 block.
```
[21](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L21) | [65](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L65) | [67](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L67) | [69](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L69) | [74](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L74) | [79](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L79) | [139](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L139) | [142](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L142) | [156](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L156) | [157](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L157) | [281](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L281) | [299](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L299) | [340](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L340)

```solidity
File: code/system-contracts/contracts/GasBoundCaller.sol

19: /// @notice We assume that no more than `CALL_RETURN_OVERHEAD` ergs are used for the O(1) operations at the end of the execution,
27: /// (`BOUND_CALL_OVERHEAD`) to ensure that the call will not exceed the limit, so it may actually spend a bit less than
30: /// of the `_maxTotalGas` parameter. In other words, `max(gas(), _maxTotalGas)` is the maximum amount of gas that can be spent by this function.
31: /// @dev The function relays the `returndata` returned by the callee. In case the `callee` reverts, it reverts with the same error.
45: // Ultimately, the entire `gas` sent to this call can be spent on compute regardless of the `_maxTotalGas` parameter.
48: // This is the amount of gas that can be spent *exclusively* on pubdata in addition to the `gas` provided to this function.
```
[19](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/GasBoundCaller.sol#L19) | [27](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/GasBoundCaller.sol#L27) | [30](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/GasBoundCaller.sol#L30) | [31](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/GasBoundCaller.sol#L31) | [45](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/GasBoundCaller.sol#L45) | [48](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/GasBoundCaller.sol#L48)

```solidity
File: code/system-contracts/contracts/libraries/EfficientCall.sol

16: * In turn, zkEVM operates over a fat pointer, which is a set of (memory page, offset, start, length) in the memory/calldata/returndata.
25: * 3. `ptr.pack` - Do the concatenation between the lowest 128 bits of the pointer itself and the highest 128 bits of `_value`. It is typically used to prepare the ABI for external calls.
```
[16](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L16) | [25](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L25)

```solidity
File: code/system-contracts/contracts/libraries/SystemContractHelper.sol

7: import {SystemContractsCaller, CalldataForwardingMode, CALLFLAGS_CALL_ADDRESS, CODE_ADDRESS_CALL_ADDRESS, EVENT_WRITE_ADDRESS, EVENT_INITIALIZE_ADDRESS, GET_EXTRA_ABI_DATA_ADDRESS, LOAD_CALLDATA_INTO_ACTIVE_PTR_CALL_ADDRESS, META_CODE_SHARD_ID_OFFSET, META_CALLER_SHARD_ID_OFFSET, META_SHARD_ID_OFFSET, META_AUX_HEAP_SIZE_OFFSET, META_HEAP_SIZE_OFFSET, META_GAS_PER_PUBDATA_BYTE_OFFSET, MIMIC_CALL_BY_REF_CALL_ADDRESS, META_CALL_ADDRESS, MSG_VALUE_SIMULATOR_IS_SYSTEM_BIT, PTR_CALLDATA_CALL_ADDRESS, PTR_ADD_INTO_ACTIVE_CALL_ADDRESS, PTR_SHRINK_INTO_ACTIVE_CALL_ADDRESS, PTR_PACK_INTO_ACTIVE_CALL_ADDRESS, RAW_FAR_CALL_BY_REF_CALL_ADDRESS, PRECOMPILE_CALL_ADDRESS, SET_CONTEXT_VALUE_CALL_ADDRESS, SYSTEM_CALL_BY_REF_CALL_ADDRESS, TO_L1_CALL_ADDRESS} from "./SystemContractsCaller.sol";
105: /// @dev Transforms `ACTIVE_PTR.length` into `ACTIVE_PTR.length - u32(_shrink)`. If underflow happens then it panics.
```
[7](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L7) | [105](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L105)

```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

86: "Transaction(uint256 txType,uint256 from,uint256 to,uint256 gasLimit,uint256 gasPerPubdataByteLimit,uint256 maxFeePerGas,uint256 maxPriorityFeePerGas,uint256 paymaster,uint256 nonce,uint256 value,bytes data,bytes32[] factoryDeps,bytes paymasterInput)"
291: // H(0x02 || RLP(chain_id, nonce, max_priority_fee_per_gas, max_fee_per_gas, gas_limit, destination, amount, data, access_list))
```
[86](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L86) | [291](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L291)

```solidity
File: code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol

9: * @dev Each of the functions accepts the `bytes calldata` and the offset where data should be read and returns a value of a certain type.
```
[9](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol#L9)

```solidity
File: code/system-contracts/contracts/libraries/Utils.sol

55: /// @notice Denotes whether bytecode hash corresponds to a contract that is on constructor or has already been constructed
```
[55](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L55)

```solidity
File: code/system-contracts/contracts/interfaces/IL1Messenger.sol

6: /// @param l2ShardId The shard identifier, 0 - rollup, 1 - porter. All other values are not used but are reserved for the future
24: /// @dev Equal to the bytes size of the tuple - (uint8 ShardId, bool isService, uint16 txNumberInBlock, address sender, bytes32 key, bytes32 value)
```
[6](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IL1Messenger.sol#L6) | [24](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IL1Messenger.sol#L24)

```solidity
File: code/system-contracts/contracts/interfaces/ISystemContext.sol

25: /// all the information returned to users for block.timestamp/number, etc should be the information about the L2 blocks and
```
[25](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/ISystemContext.sol#L25)

```solidity
File: code/system-contracts/contracts/interfaces/ISystemContextDeprecated.sol

8: * @notice The interface with deprecated functions of the SystemContext contract. It is aimed for backward compatibility.
```
[8](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/ISystemContextDeprecated.sol#L8)

```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

15: import {L2ContractHelper, DEPLOYER_SYSTEM_CONTRACT, L2_BASE_TOKEN_ADDRESS, IContractDeployer} from "../L2ContractHelper.sol";
143: // note we use the IL1ERC20Bridge.finalizeWithdrawal function selector to specify the selector for L1<>L2 messages,
162: /// @dev This function uses raw call to ContractDeployer to make sure that exactly `l2TokenProxyBytecodeHash` is used
```
[15](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L15) | [143](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L143) | [162](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L162)

```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

5: import {ERC20PermitUpgradeable} from "@openzeppelin/contracts-upgradeable/token/ERC20/extensions/draft-ERC20PermitUpgradeable.sol";
19: /// @notice Our goal is to store all the getters that L1 token implements, and for others, we keep it as an unimplemented method.
```
[5](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L5) | [19](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L19)
</details>

### [N-108] Style guide: Extraneous whitespace

See the [whitespace](https://docs.soliditylang.org/en/v0.8.24/style-guide.html#whitespace-in-expressions) section of the Solidity Style Guide

<details>
<summary><i>16 issue instances in 9 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

/// @audit `More than one space around an assignment or other operator to align with another`
122: chainBalance[_targetChainId][ETH_TOKEN_ADDRESS] =
                chainBalance[_targetChainId][ETH_TOKEN_ADDRESS] +
```
[122](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L122)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
144: (address logSender, ) = UnsafeBytes.readAddress(emittedL2Logs, i + L2_LOG_ADDRESS_OFFSET);
/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
145: (uint256 logKey, ) = UnsafeBytes.readUint256(emittedL2Logs, i + L2_LOG_KEY_OFFSET);
/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
146: (bytes32 logValue, ) = UnsafeBytes.readBytes32(emittedL2Logs, i + L2_LOG_VALUE_OFFSET);
/// @audit `More than one space around an assignment or other operator to align with another`
62: logOutput.pubdataHash ==
                    keccak256(_newBatch.pubdataCommitments[1:_newBatch.pubdataCommitments.length - 32]),
```
[144](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L144) | [145](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L145) | [146](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L146) | [62](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L62)

```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol

/// @audit `More than one space around an assignment or other operator to align with another`
17: bytes32 internal constant DIAMOND_INIT_SUCCESS_RETURN_VALUE =
        0x33774e659306e47509050e97cb651e731180a42d458212294d30751925c551a2; // keccak256("diamond.zksync.init") - 1
/// @audit `More than one space around an assignment or other operator to align with another`
21: bytes32 private constant DIAMOND_STORAGE_POSITION =
        0xc8fcad8db84d3cc18b4c41d551ea0ee66dd599cde068d998e57d5e09332c131b; // keccak256("diamond.standard.diamond.storage") - 1;
```
[17](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L17) | [21](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L21)

```solidity
File: code/system-contracts/contracts/DefaultAccount.sol

/// @audit `More than one space around an assignment or other operator to align with another`
143: isSystemCall =
                selector == DEPLOYER_SYSTEM_CONTRACT.create.selector ||
```
[143](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L143)

```solidity
File: code/system-contracts/contracts/L1Messenger.sol

/// @audit `More than one space around an assignment or other operator to align with another`
280: uint256(uint8(bytes1(_totalL2ToL1PubdataAndStateDiffs[calldataPtr]))) ==
                STATE_DIFF_COMPRESSION_VERSION_NUMBER,
```
[280](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L280)

```solidity
File: code/system-contracts/contracts/MsgValueSimulator.sol

/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
63: (bool success, ) = address(REAL_BASE_TOKEN_SYSTEM_CONTRACT).call(
```
[63](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/MsgValueSimulator.sol#L63)

```solidity
File: code/system-contracts/contracts/NonceHolder.sol

/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
127: (deploymentNonce, ) = _splitRawNonce(rawNonces[addressAsKey]);
/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
147: (prevDeploymentNonce, ) = _splitRawNonce(oldRawNonce);
```
[127](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L127) | [147](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L147)

```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

/// @audit `More than one space around an assignment or other operator to align with another`
84: bytes32 constant EIP712_TRANSACTION_TYPE_HASH =
        keccak256(
```
[84](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L84)

```solidity
File: code/system-contracts/contracts/libraries/Utils.sol

/// @audit `More than one space around an assignment or other operator to align with another`
13: bytes32 constant IS_CONSTRUCTOR_BYTECODE_HASH_BIT_MASK =
        0x00ff000000000000000000000000000000000000000000000000000000000000;
/// @audit `More than one space around an assignment or other operator to align with another`
17: bytes32 constant SET_IS_CONSTRUCTOR_MARKER_BIT_MASK =
        0x0001000000000000000000000000000000000000000000000000000000000000;
/// @audit `More than one space around an assignment or other operator to align with another`
89: hashedBytecode =
            EfficientCall.sha(_bytecode) &
```
[13](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L13) | [17](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L17) | [89](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L89)
</details>

### [N-109] Contract/Libraries Names Do Not Match Their Filenames

According to the Solidity Style Guide, contract names should match their filenames. 
Mismatching contract names and filenames can lead to confusion and make the code harder to maintain and review.

<details>
<summary><i>5 issue instances in 5 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol

18: contract AdminFacet is ZkSyncStateTransitionBase, IAdmin {
```
[18](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L18)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

22: contract ExecutorFacet is ZkSyncStateTransitionBase, IExecutor {
```
[22](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L22)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol

20: contract GettersFacet is ZkSyncStateTransitionBase, IGetters, ILegacyGetters {
```
[20](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L20)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

30: contract MailboxFacet is ZkSyncStateTransitionBase, IMailbox {
```
[30](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L30)

```solidity
File: code/contracts/zksync/contracts/SystemContractsCaller.sol

25: library Utils {
```
[25](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/SystemContractsCaller.sol#L25)
</details>

### [N-110] Avoid the use of sensitive terms

Inclusive language plays a critical role in fostering an environment where everyone belongs.
Please use alternative terms as suggested below:
master -> source
slave -> replica
blacklist -> blocklist
whitelist -> allowlist

<details>
<summary><i>65 issue instances in 12 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

190: paymaster: uint256(0),
198: paymasterInput: new bytes(0),
```
[190](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L190) | [198](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L198)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

302: paymaster: uint256(0),
310: paymasterInput: new bytes(0),
```
[302](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L302) | [310](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L310)

```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol

50: require(_transaction.paymaster == 0, "uc");
59: require(_transaction.paymasterInput.length == 0, "ul1");
```
[50](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L50) | [59](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L59)

```solidity
File: code/contracts/ethereum/contracts/common/Messaging.sol

86: /// @param paymaster The address of the EIP-4337 paymaster, that will pay fees for the
96: /// @param paymasterInput The arbitrary-length data that is used as a calldata to the paymaster pre-call
106: uint256 paymaster;
121: bytes paymasterInput;
```
[86](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Messaging.sol#L86) | [96](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Messaging.sol#L96) | [106](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Messaging.sol#L106) | [121](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Messaging.sol#L121)

```solidity
File: code/system-contracts/contracts/DefaultAccount.sol

206: /// paid for by a paymaster.
212: function prepareForPaymaster(
217: _transaction.processPaymasterInput();
```
[206](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L206) | [212](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L212) | [217](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L217)

```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

8: import "../interfaces/IPaymasterFlow.sol";
43: // The transaction's paymaster. If there is no paymaster, it is equal to 0.
44: uint256 paymaster;
66: // The input to the paymaster.
67: bytes paymasterInput;
86: "Transaction(uint256 txType,uint256 from,uint256 to,uint256 gasLimit,uint256 gasPerPubdataByteLimit,uint256 maxFeePerGas,uint256 maxPriorityFeePerGas,uint256 paymaster,uint256 nonce,uint256 value,bytes data,bytes32[] factoryDeps,bytes paymasterInput)"
129: _transaction.paymaster,
134: EfficientCall.keccak(_transaction.paymasterInput)
359: /// @notice Processes the common paymaster flows, e.g. setting proper allowance
361: /// the "Paymaster flows" section in the documentation.
362: function processPaymasterInput(Transaction calldata _transaction) internal {
363: require(_transaction.paymasterInput.length >= 4, "The standard paymaster input must be at least 4 bytes long");
365: bytes4 paymasterInputSelector = bytes4(_transaction.paymasterInput[0:4]);
366: if (paymasterInputSelector == IPaymasterFlow.approvalBased.selector) {
368: _transaction.paymasterInput.length >= 68,
369: "The approvalBased paymaster input must be at least 68 bytes long"
373: // the data is needed only for the paymaster, so we ignore it here for the sake of optimization
374: (address token, uint256 minAllowance) = abi.decode(_transaction.paymasterInput[4:68], (address, uint256));
375: address paymaster = address(uint160(_transaction.paymaster));
377: uint256 currentAllowance = IERC20(token).allowance(address(this), paymaster);
382: IERC20(token).safeApprove(paymaster, 0);
383: IERC20(token).safeApprove(paymaster, minAllowance);
385: } else if (paymasterInputSelector == IPaymasterFlow.general.selector) {
386: // Do nothing. general(bytes) paymaster flow means that the paymaster must interpret these bytes on his own.
388: revert("Unsupported paymaster flow");
406: if (address(uint160(_transaction.paymaster)) != address(0)) {
407: // Paymaster pays for the fee
```
[8](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L8) | [43](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L43) | [44](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L44) | [66](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L66) | [67](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L67) | [86](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L86) | [129](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L129) | [134](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L134) | [359](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L359) | [361](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L361) | [362](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L362) | [363](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L363) | [365](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L365) | [366](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L366) | [368](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L368) | [369](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L369) | [373](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L373) | [374](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L374) | [375](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L375) | [377](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L377) | [382](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L382) | [383](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L383) | [385](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L385) | [386](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L386) | [388](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L388) | [406](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L406) | [407](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L407)

```solidity
File: code/system-contracts/contracts/interfaces/IAccount.sol

42: function prepareForPaymaster(
```
[42](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IAccount.sol#L42)

```solidity
File: code/system-contracts/contracts/interfaces/IPaymaster.sol

12: bytes4 constant PAYMASTER_VALIDATION_SUCCESS_MAGIC = IPaymaster.validateAndPayForPaymasterTransaction.selector;
14: interface IPaymaster {
15: /// @dev Called by the bootloader to verify that the paymaster agrees to pay for the
21: /// @return magic The value that should be equal to the signature of the validateAndPayForPaymasterTransaction
22: /// if the paymaster agrees to pay for the transaction.
28: function validateAndPayForPaymasterTransaction(
37: /// @param _context, the context of the execution, returned by the "validateAndPayForPaymasterTransaction" method.
40: /// @param _maxRefundedGas, the upper bound on the amout of gas that could be refunded to the paymaster.
```
[12](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IPaymaster.sol#L12) | [14](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IPaymaster.sol#L14) | [15](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IPaymaster.sol#L15) | [21](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IPaymaster.sol#L21) | [22](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IPaymaster.sol#L22) | [28](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IPaymaster.sol#L28) | [37](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IPaymaster.sol#L37) | [40](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IPaymaster.sol#L40)

```solidity
File: code/system-contracts/contracts/interfaces/IPaymasterFlow.sol

8: * different types of paymaster flows.
12: interface IPaymasterFlow {
```
[8](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IPaymasterFlow.sol#L8) | [12](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IPaymasterFlow.sol#L12)

```solidity
File: code/contracts/zksync/contracts/interfaces/IPaymaster.sol

12: bytes4 constant PAYMASTER_VALIDATION_SUCCESS_MAGIC = IPaymaster.validateAndPayForPaymasterTransaction.selector;
14: interface IPaymaster {
15: /// @dev Called by the bootloader to verify that the paymaster agrees to pay for the
21: /// @return magic The value that should be equal to the signature of the validateAndPayForPaymasterTransaction
22: /// if the paymaster agrees to pay for the transaction.
28: function validateAndPayForPaymasterTransaction(
37: /// @param _context, the context of the execution, returned by the "validateAndPayForPaymasterTransaction" method.
40: /// @param _maxRefundedGas, the upper bound on the amout of gas that could be refunded to the paymaster.
```
[12](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/interfaces/IPaymaster.sol#L12) | [14](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/interfaces/IPaymaster.sol#L14) | [15](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/interfaces/IPaymaster.sol#L15) | [21](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/interfaces/IPaymaster.sol#L21) | [22](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/interfaces/IPaymaster.sol#L22) | [28](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/interfaces/IPaymaster.sol#L28) | [37](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/interfaces/IPaymaster.sol#L37) | [40](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/interfaces/IPaymaster.sol#L40)

```solidity
File: code/contracts/zksync/contracts/interfaces/IPaymasterFlow.sol

9: * different types of paymaster flows.
13: interface IPaymasterFlow {
```
[9](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/interfaces/IPaymasterFlow.sol#L9) | [13](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/interfaces/IPaymasterFlow.sol#L13)

```solidity
File: code/contracts/zksync/contracts/L2ContractHelper.sol

135: // The transaction's paymaster. If there is no paymaster, it is equal to 0.
136: uint256 paymaster;
158: // The input to the paymaster.
159: bytes paymasterInput;
```
[135](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/L2ContractHelper.sol#L135) | [136](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/L2ContractHelper.sol#L136) | [158](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/L2ContractHelper.sol#L158) | [159](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/L2ContractHelper.sol#L159)
</details>

### [N-111] Unused import

The contract contains import statements for libraries or other contracts that are not utilized within the code.
Excessive or unused imports can clutter the codebase, leading to inefficiency and potential confusion.
Consider removing any imports that are not essential to the contract's functionality.

<details>
<summary><i>40 issue instances in 23 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

/// @audit imported `L2ContractHelper` not used)
11: import {L2ContractHelper} from "../common/libraries/L2ContractHelper.sol";
/// @audit imported `L2ContractHelper` not used)
11: import {L2ContractHelper} from "../common/libraries/L2ContractHelper.sol";
```
[11](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L11) | [11](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L11)

```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

/// @audit imported `ERA_DIAMOND_PROXY, ERA_CHAIN_ID` not used)
19: import {REQUIRED_L2_GAS_PRICE_PER_PUBDATA, L2_TO_L1_LOG_SERIALIZE_SIZE, DEFAULT_L2_LOGS_TREE_ROOT_HASH, EMPTY_STRING_KECCAK, SYSTEM_UPGRADE_L2_TX_TYPE, ERA_DIAMOND_PROXY, ERA_CHAIN_ID} from "../common/Config.sol";
```
[19](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L19)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol

/// @audit imported `FeeParams` not used)
7: import {FeeParams} from "./ZkSyncStateTransitionStorage.sol";
/// @audit imported `VerifierParams` not used)
10: import {VerifierParams} from "../chain-interfaces/IVerifier.sol";
/// @audit - ISystemContext imported but not used
12: import "../l2-deps/ISystemContext.sol";
```
[7](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol#L7) | [10](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol#L10) | [12](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol#L12)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol

/// @audit imported `IZkSyncStateTransitionBase` not used)
12: // While formally the following import is not used, it is needed to inherit documentation from it
import {IZkSyncStateTransitionBase} from "../../chain-interfaces/IZkSyncStateTransitionBase.sol";
```
[12](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L12)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

/// @audit imported `IZkSyncStateTransitionBase` not used)
16: // While formally the following import is not used, it is needed to inherit documentation from it
import {IZkSyncStateTransitionBase} from "../../chain-interfaces/IZkSyncStateTransitionBase.sol";
```
[16](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L16)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol

/// @audit imported `IZkSyncStateTransitionBase` not used)
14: // While formally the following import is not used, it is needed to inherit documentation from it
import {IZkSyncStateTransitionBase} from "../../chain-interfaces/IZkSyncStateTransitionBase.sol";
```
[14](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L14)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

/// @audit imported `UnsafeBytes` not used)
14: import {UnsafeBytes} from "../../../common/libraries/UnsafeBytes.sol";
/// @audit imported `L2_BASE_TOKEN_SYSTEM_CONTRACT_ADDR` not used)
19: import {L2_BOOTLOADER_ADDRESS, L2_TO_L1_MESSENGER_SYSTEM_CONTRACT_ADDR, L2_BASE_TOKEN_SYSTEM_CONTRACT_ADDR} from "../../../common/L2ContractAddresses.sol";
/// @audit imported `IBridgehub` not used)
21: import {IBridgehub} from "../../../bridgehub/IBridgehub.sol";
/// @audit imported `IZkSyncStateTransitionBase` not used)
24: // While formally the following import is not used, it is needed to inherit documentation from it
import {IZkSyncStateTransitionBase} from "../../chain-interfaces/IZkSyncStateTransitionBase.sol";
```
[14](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L14) | [19](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L19) | [21](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L21) | [24](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L24)

```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol

/// @audit imported `IMailbox` not used)
6: import {IMailbox} from "../state-transition/chain-interfaces/IMailbox.sol";
```
[6](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L6)

```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol

/// @audit - ZkSyncStateTransitionBase imported but not used
5: import "../state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol";
/// @audit - IMailbox imported but not used
6: import "../state-transition/chain-interfaces/IMailbox.sol";
/// @audit - IVerifier imported but not used
7: import "../state-transition/chain-interfaces/IVerifier.sol";
/// @audit - L2ContractHelper imported but not used
8: import "../common/libraries/L2ContractHelper.sol";
/// @audit - Messaging imported but not used
9: import "../common/Messaging.sol";
/// @audit - TransactionValidator imported but not used
10: import "../state-transition/libraries/TransactionValidator.sol";
/// @audit imported `MAX_NEW_FACTORY_DEPS, SYSTEM_UPGRADE_L2_TX_TYPE` not used)
11: import {MAX_NEW_FACTORY_DEPS, SYSTEM_UPGRADE_L2_TX_TYPE, MAX_ALLOWED_PROTOCOL_VERSION_DELTA} from "../common/Config.sol";
```
[5](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L5) | [6](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L6) | [7](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L7) | [8](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L8) | [9](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L9) | [10](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L10) | [11](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L11)

```solidity
File: code/contracts/ethereum/contracts/upgrades/GenesisUpgrade.sol

/// @audit - IDefaultUpgrade imported but not used
7: import "./IDefaultUpgrade.sol";
```
[7](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/GenesisUpgrade.sol#L7)

```solidity
File: code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol

/// @audit - Messaging imported but not used
6: import "../common/Messaging.sol";
/// @audit - IStateTransitionManager imported but not used
7: import "../state-transition/IStateTransitionManager.sol";
/// @audit - Diamond imported but not used
8: import "../state-transition/libraries/Diamond.sol";
```
[6](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L6) | [7](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L7) | [8](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L8)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol

/// @audit imported `L2CanonicalTransaction` not used)
5: import {L2CanonicalTransaction} from "../../common/Messaging.sol";
```
[5](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol#L5)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol

/// @audit imported `Verifier` not used)
9: import {Verifier} from "../Verifier.sol";
/// @audit imported `VerifierParams` not used)
10: import {VerifierParams} from "./IVerifier.sol";
```
[9](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol#L9) | [10](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol#L10)

```solidity
File: code/system-contracts/contracts/Compressor.sol

/// @audit imported `INITIAL_WRITE_STARTING_POSITION, COMPRESSED_INITIAL_WRITE_SIZE, STATE_DIFF_ENUM_INDEX_OFFSET, STATE_DIFF_FINAL_VALUE_OFFSET, STATE_DIFF_DERIVED_KEY_OFFSET, DERIVED_KEY_LENGTH, VALUE_LENGTH, ENUM_INDEX_LENGTH` not used)
10: import {L1_MESSENGER_CONTRACT, INITIAL_WRITE_STARTING_POSITION, COMPRESSED_INITIAL_WRITE_SIZE, STATE_DIFF_ENTRY_SIZE, STATE_DIFF_ENUM_INDEX_OFFSET, STATE_DIFF_FINAL_VALUE_OFFSET, STATE_DIFF_DERIVED_KEY_OFFSET, DERIVED_KEY_LENGTH, VALUE_LENGTH, ENUM_INDEX_LENGTH, KNOWN_CODE_STORAGE_CONTRACT} from "./Constants.sol";
```
[10](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L10)

```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

/// @audit imported `KECCAK256_SYSTEM_CONTRACT` not used)
7: import {CREATE2_PREFIX, CREATE_PREFIX, NONCE_HOLDER_SYSTEM_CONTRACT, ACCOUNT_CODE_STORAGE_SYSTEM_CONTRACT, FORCE_DEPLOYER, MAX_SYSTEM_CONTRACT_ADDRESS, KNOWN_CODE_STORAGE_CONTRACT, BASE_TOKEN_SYSTEM_CONTRACT, IMMUTABLE_SIMULATOR_SYSTEM_CONTRACT, COMPLEX_UPGRADER_CONTRACT, KECCAK256_SYSTEM_CONTRACT} from "./Constants.sol";
```
[7](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L7)

```solidity
File: code/system-contracts/contracts/PubdataChunkPublisher.sol

/// @audit imported `EfficientCall` not used)
7: import {EfficientCall} from "./libraries/EfficientCall.sol";
```
[7](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/PubdataChunkPublisher.sol#L7)

```solidity
File: code/system-contracts/contracts/libraries/SystemContractHelper.sol

/// @audit imported `SystemContractsCaller, CalldataForwardingMode, MIMIC_CALL_BY_REF_CALL_ADDRESS, MSG_VALUE_SIMULATOR_IS_SYSTEM_BIT, RAW_FAR_CALL_BY_REF_CALL_ADDRESS, SYSTEM_CALL_BY_REF_CALL_ADDRESS` not used)
7: import {SystemContractsCaller, CalldataForwardingMode, CALLFLAGS_CALL_ADDRESS, CODE_ADDRESS_CALL_ADDRESS, EVENT_WRITE_ADDRESS, EVENT_INITIALIZE_ADDRESS, GET_EXTRA_ABI_DATA_ADDRESS, LOAD_CALLDATA_INTO_ACTIVE_PTR_CALL_ADDRESS, META_CODE_SHARD_ID_OFFSET, META_CALLER_SHARD_ID_OFFSET, META_SHARD_ID_OFFSET, META_AUX_HEAP_SIZE_OFFSET, META_HEAP_SIZE_OFFSET, META_GAS_PER_PUBDATA_BYTE_OFFSET, MIMIC_CALL_BY_REF_CALL_ADDRESS, META_CALL_ADDRESS, MSG_VALUE_SIMULATOR_IS_SYSTEM_BIT, PTR_CALLDATA_CALL_ADDRESS, PTR_ADD_INTO_ACTIVE_CALL_ADDRESS, PTR_SHRINK_INTO_ACTIVE_CALL_ADDRESS, PTR_PACK_INTO_ACTIVE_CALL_ADDRESS, RAW_FAR_CALL_BY_REF_CALL_ADDRESS, PRECOMPILE_CALL_ADDRESS, SET_CONTEXT_VALUE_CALL_ADDRESS, SYSTEM_CALL_BY_REF_CALL_ADDRESS, TO_L1_CALL_ADDRESS} from "./SystemContractsCaller.sol";
```
[7](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L7)

```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

/// @audit - IContractDeployer imported but not used
9: import "../interfaces/IContractDeployer.sol";
```
[9](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L9)

```solidity
File: code/system-contracts/contracts/interfaces/IAccount.sol

/// @audit - TransactionHelper imported but not used
5: import "../libraries/TransactionHelper.sol";
```
[5](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IAccount.sol#L5)

```solidity
File: code/system-contracts/contracts/interfaces/IBootloaderUtilities.sol

/// @audit - TransactionHelper imported but not used
5: import "../libraries/TransactionHelper.sol";
```
[5](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IBootloaderUtilities.sol#L5)

```solidity
File: code/system-contracts/contracts/interfaces/IPaymaster.sol

/// @audit - TransactionHelper imported but not used
5: import "../libraries/TransactionHelper.sol";
```
[5](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IPaymaster.sol#L5)

```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

/// @audit imported `DEPLOYER_SYSTEM_CONTRACT, L2_BASE_TOKEN_ADDRESS, IContractDeployer` not used)
15: import {L2ContractHelper, DEPLOYER_SYSTEM_CONTRACT, L2_BASE_TOKEN_ADDRESS, IContractDeployer} from "../L2ContractHelper.sol";
/// @audit imported `SystemContractsCaller` not used)
16: import {SystemContractsCaller} from "../SystemContractsCaller.sol";
/// @audit imported `ERA_WETH_ADDRESS` not used)
17: import {ERA_CHAIN_ID, ERA_WETH_ADDRESS} from "../Config.sol";
```
[15](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L15) | [16](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L16) | [17](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L17)

```solidity
File: code/contracts/zksync/contracts/interfaces/IPaymaster.sol

/// @audit - L2ContractHelper imported but not used
5: import "../L2ContractHelper.sol";
```
[5](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/interfaces/IPaymaster.sol#L5)
</details>

### [N-112] `if`-statement can be converted to a ternary

The ternary operator provides a shorthand way to write if / else statements.
It can improve readability and reduce the number of lines of code.
Traditional `if / else` statements, particularly those spanning only a one lines, could potentially be refactored using the ternary operator.

<details>
<summary><i>5 issue instances in 4 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

222: if (token == ETH_TOKEN_ADDRESS) {
                require(msg.value == _request.mintValue, "Bridgehub: msg.value mismatch 1");
            } else {
                require(msg.value == 0, "Bridgehub: non-eth bridge with msg.value");
            }
329: } else if (_refundRecipient.code.length > 0) {
            // If the `_refundRecipient` is a smart contract, we apply the L1 to L2 alias to prevent foot guns.
            _recipient = AddressAliasHelper.applyL1ToL2Alias(_refundRecipient);
        } else {
            _recipient = _refundRecipient;
        }
```
[222](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L222) | [329](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L329)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

191: if (_expectedSystemContractUpgradeTxHash == bytes32(0)) {
            require(processedLogs == 511, "b7");
        } else {
            require(processedLogs == 1023, "b8");
        }
```
[191](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L191)

```solidity
File: code/system-contracts/contracts/SystemContext.sol

150: } else if (
            _block >= currentVirtualBlockUpgradeInfo.virtualBlockFinishL2Block &&
            currentVirtualBlockUpgradeInfo.virtualBlockFinishL2Block > 0
        ) {
            hash = _getLatest257L2blockHash(_block);
        } else {
            // Important: we do not want this number to ever collide with the L2 block hash (either new or old one) and so
            // that's why the legacy L2 blocks' hashes are keccak256(abi.encodePacked(uint32(_block))), while these are equivalent to
            // keccak256(abi.encodePacked(_block))
            hash = keccak256(abi.encode(_block));
        }
```
[150](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L150)

```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

406: if (address(uint160(_transaction.paymaster)) != address(0)) {
            // Paymaster pays for the fee
            requiredBalance = _transaction.value;
        } else {
            // The user should have enough balance for both the fee and the value of the transaction
            requiredBalance = _transaction.maxFeePerGas * _transaction.gasLimit + _transaction.value;
        }
```
[406](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L406)
</details>

### [N-113] Unused Structs Declaration

Structs that aren't utilized in the contract add unnecessary complexity to the codebase. 
Removing these unused structs can streamline the contract, enhancing its readability and maintainability.
It's recommended to thoroughly review the contract and ensure that these structs are indeed superfluous.

<details>
<summary><i>1 issue instances in 1 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol

/// @audit Struct `InitializeDataNewChain` declared but never used
51: struct InitializeDataNewChain {
    IVerifier verifier;
    VerifierParams verifierParams;
    bytes32 l2BootloaderBytecodeHash;
    bytes32 l2DefaultAccountBytecodeHash;
    uint256 priorityTxMaxGasLimit;
    FeeParams feeParams;
    address blobVersionedHashRetriever;
}
```
[51](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol#L51)
</details>

### [N-114] Consider using named mappings

As of Solidity version 0.8.18, it is possible to use named mappings to clarify the purpose of each mapping in the code. 
It is recommended to use this feature for better code readability and maintainability.

More information: [Solidity 0.8.18 Release Announcement](https://blog.soliditylang.org/2023/02/01/solidity-0.8.18-release-announcement/)

<details>
<summary><i>11 issue instances in 5 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

45: mapping(address => uint256) private __DEPRECATED_lastWithdrawalLimitReset;
48: mapping(address => uint256) private __DEPRECATED_withdrawnAmountInWindow;
51: mapping(address => mapping(address => uint256)) private __DEPRECATED_totalDepositedAmountPerUser;
45: mapping(address => uint256) private __DEPRECATED_lastWithdrawalLimitReset;
48: mapping(address => uint256) private __DEPRECATED_withdrawnAmountInWindow;
51: mapping(address => mapping(address => uint256)) private __DEPRECATED_totalDepositedAmountPerUser;
```
[45](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L45) | [48](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L48) | [51](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L51) | [45](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L45) | [48](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L48) | [51](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L51)

```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

30: mapping(uint256 => address) public stateTransition;
48: mapping(uint256 => bytes32) public upgradeCutHash;
```
[30](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L30) | [48](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L48)

```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

47: mapping(uint256 => LibMap.Uint32Map) internal committedBatchTimestamp;
```
[47](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L47)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol

120: mapping(address => uint256) __DEPRECATED_totalDepositedAmountPerUser;
```
[120](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L120)

```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

26: mapping(address => AccountInfo) internal accountInfo;
```
[26](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L26)
</details>

### [N-115] Use of `override` is unnecessary

In Solidity version 0.8.8 and later, the use of the `override` keyword becomes superfluous when a function is overriding solely from an interface and the function isn't present in multiple base contracts.
Previously, the `override` keyword was required as an explicit indication to the compiler. However, this is no longer the case, and the extraneous use of the keyword can make the code less clean and more verbose.

Solidity documentation on [Function Overriding](https://docs.soliditylang.org/en/v0.8.20/contracts.html#function-overriding).

<details>
<summary><i>54 issue instances in 16 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

182: function bridgehubDeposit(
        uint256 _chainId,
        address _prevMsgSender,
        uint256, // l2Value, needed for Weth deposits in the future
        bytes calldata _data
    ) external payable override onlyBridgehub returns (L2TransactionRequestTwoBridgesInner memory request) {
232: function bridgehubConfirmL2Transaction(
        uint256 _chainId,
        bytes32 _txDataHash,
        bytes32 _txHash
    ) external override onlyBridgehub {
277: function claimFailedDeposit(
        uint256 _chainId,
        address _depositSender,
        address _l1Token,
        uint256 _amount,
        bytes32 _l2TxHash,
        uint256 _l2BatchNumber,
        uint256 _l2MessageIndex,
        uint16 _l2TxNumberInBatch,
        bytes32[] calldata _merkleProof
    ) external override {
385: function finalizeWithdrawal(
        uint256 _chainId,
        uint256 _l2BatchNumber,
        uint256 _l2MessageIndex,
        uint16 _l2TxNumberInBatch,
        bytes calldata _message,
        bytes32[] calldata _merkleProof
    ) external override {
554: function depositLegacyErc20Bridge(
        address _prevMsgSender,
        address _l2Receiver,
        address _l1Token,
        uint256 _amount,
        uint256 _l2TxGasLimit,
        uint256 _l2TxGasPerPubdataByte,
        address _refundRecipient
    ) external payable override onlyLegacyBridge nonReentrant returns (bytes32 l2TxHash) {
615: function finalizeWithdrawalLegacyErc20Bridge(
        uint256 _l2BatchNumber,
        uint256 _l2MessageIndex,
        uint16 _l2TxNumberInBatch,
        bytes calldata _message,
        bytes32[] calldata _merkleProof
    ) external override onlyLegacyBridge returns (address l1Receiver, address l1Token, uint256 amount) {
644: function claimFailedDepositLegacyErc20Bridge(
        address _depositSender,
        address _l1Token,
        uint256 _amount,
        bytes32 _l2TxHash,
        uint256 _l2BatchNumber,
        uint256 _l2MessageIndex,
        uint16 _l2TxNumberInBatch,
        bytes32[] calldata _merkleProof
    ) external override onlyLegacyBridge {
```
[182](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L182) | [232](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L232) | [277](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L277) | [385](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L385) | [554](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L554) | [615](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L615) | [644](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L644)

```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

152: function proveL2MessageInclusion(
        uint256 _chainId,
        uint256 _batchNumber,
        uint256 _index,
        L2Message calldata _message,
        bytes32[] calldata _proof
    ) external view override returns (bool) {
164: function proveL2LogInclusion(
        uint256 _chainId,
        uint256 _batchNumber,
        uint256 _index,
        L2Log memory _log,
        bytes32[] calldata _proof
    ) external view override returns (bool) {
176: function proveL1ToL2TransactionStatus(
        uint256 _chainId,
        bytes32 _l2TxHash,
        uint256 _l2BatchNumber,
        uint256 _l2MessageIndex,
        uint16 _l2TxNumberInBatch,
        bytes32[] calldata _merkleProof,
        TxStatus _status
    ) external view override returns (bool) {
217: function requestL2TransactionDirect(
        L2TransactionRequestDirect calldata _request
    ) external payable override nonReentrant returns (bytes32 canonicalTxHash) {
262: function requestL2TransactionTwoBridges(
        L2TransactionRequestTwoBridgesOuter calldata _request
    ) external payable override nonReentrant returns (bytes32 canonicalTxHash) {
```
[152](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L152) | [164](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L164) | [176](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L176) | [217](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L217) | [262](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L262)

```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

73: function getChainAdmin(uint256 _chainId) external view override returns (address) {
```
[73](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L73)

```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol

20: function _setNewProtocolVersion(uint256 _newProtocolVersion) internal override {
47: function upgrade(ProposedUpgrade calldata _proposedUpgrade) public virtual override returns (bytes32) {
```
[20](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L20) | [47](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L47)

```solidity
File: code/contracts/ethereum/contracts/upgrades/DefaultUpgrade.sol

13: function upgrade(ProposedUpgrade calldata _proposedUpgrade) public override returns (bytes32) {
```
[13](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/DefaultUpgrade.sol#L13)

```solidity
File: code/contracts/ethereum/contracts/upgrades/GenesisUpgrade.sol

14: function upgrade(ProposedUpgrade calldata _proposedUpgrade) public override returns (bytes32) {
```
[14](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/GenesisUpgrade.sol#L14)

```solidity
File: code/system-contracts/contracts/AccountCodeStorage.sol

35: function storeAccountConstructingCodeHash(address _address, bytes32 _hash) external override onlyDeployer {
46: function storeAccountConstructedCodeHash(address _address, bytes32 _hash) external override onlyDeployer {
54: function markAccountCodeHashAsConstructed(address _address) external override onlyDeployer {
78: function getRawCodeHash(address _address) public view override returns (bytes32 codeHash) {
89: function getCodeHash(uint256 _input) external view override returns (bytes32) {
117: function getCodeSize(uint256 _input) external view override returns (uint256 codeSize) {
```
[35](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/AccountCodeStorage.sol#L35) | [46](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/AccountCodeStorage.sol#L46) | [54](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/AccountCodeStorage.sol#L54) | [78](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/AccountCodeStorage.sol#L78) | [89](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/AccountCodeStorage.sol#L89) | [117](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/AccountCodeStorage.sol#L117)

```solidity
File: code/system-contracts/contracts/BootloaderUtilities.sol

24: function getTransactionHashes(
        Transaction calldata _transaction
    ) external view override returns (bytes32 txHash, bytes32 signedTxHash) {
```
[24](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L24)

```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

95: function getNewAddressCreate2(
        address _sender,
        bytes32 _bytecodeHash,
        bytes32 _salt,
        bytes calldata _input
    ) public view override returns (address newAddress) {
115: function getNewAddressCreate(
        address _sender,
        uint256 _senderNonce
    ) public pure override returns (address newAddress) {
132: function create2(
        bytes32 _salt,
        bytes32 _bytecodeHash,
        bytes calldata _input
    ) external payable override returns (address) {
147: function create(
        bytes32 _salt,
        bytes32 _bytecodeHash,
        bytes calldata _input
    ) external payable override returns (address) {
162: function create2Account(
        bytes32 _salt,
        bytes32 _bytecodeHash,
        bytes calldata _input,
        AccountAbstractionVersion _aaVersion
    ) public payable override onlySystemCall returns (address) {
182: function createAccount(
        bytes32, // salt
        bytes32 _bytecodeHash,
        bytes calldata _input,
        AccountAbstractionVersion _aaVersion
    ) public payable override onlySystemCall returns (address) {
```
[95](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L95) | [115](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L115) | [132](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L132) | [147](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L147) | [162](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L162) | [182](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L182)

```solidity
File: code/system-contracts/contracts/DefaultAccount.sol

67: function validateTransaction(
        bytes32, // _txHash
        bytes32 _suggestedSignedHash,
        Transaction calldata _transaction
    ) external payable override ignoreNonBootloader ignoreInDelegateCall returns (bytes4 magic) {
112: function executeTransaction(
        bytes32, // _txHash
        bytes32, // _suggestedSignedHash
        Transaction calldata _transaction
    ) external payable override ignoreNonBootloader ignoreInDelegateCall {
125: function executeTransactionFromOutside(Transaction calldata _transaction) external payable override {
```
[67](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L67) | [112](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L112) | [125](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L125)

```solidity
File: code/system-contracts/contracts/ImmutableSimulator.sol

27: function getImmutable(address _dest, uint256 _index) external view override returns (bytes32) {
34: function setImmutables(address _dest, ImmutableData[] calldata _immutables) external override {
```
[27](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ImmutableSimulator.sol#L27) | [34](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ImmutableSimulator.sol#L34)

```solidity
File: code/system-contracts/contracts/KnownCodesStorage.sol

65: function getMarker(bytes32 _hash) public view override returns (uint256 marker) {
```
[65](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/KnownCodesStorage.sol#L65)

```solidity
File: code/system-contracts/contracts/L1Messenger.sol

116: function sendToL1(bytes calldata _message) external override returns (bytes32 hash) {
161: function requestBytecodeL1Publication(
        bytes32 _bytecodeHash
    ) external override onlyCallFrom(address(KNOWN_CODE_STORAGE_CONTRACT)) {
```
[116](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L116) | [161](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L161)

```solidity
File: code/system-contracts/contracts/L2BaseToken.sol

32: function transferFromTo(address _from, address _to, uint256 _amount) external override {
56: function balanceOf(uint256 _account) external view override returns (uint256) {
64: function mint(address _account, uint256 _amount) external override onlyCallFromBootloader {
72: function withdraw(address _l1Receiver) external payable override {
85: function withdrawWithMessage(address _l1Receiver, bytes memory _additionalData) external payable override {
128: function name() external pure override returns (string memory) {
134: function symbol() external pure override returns (string memory) {
140: function decimals() external pure override returns (uint8) {
```
[32](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L2BaseToken.sol#L32) | [56](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L2BaseToken.sol#L56) | [64](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L2BaseToken.sol#L64) | [72](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L2BaseToken.sol#L72) | [85](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L2BaseToken.sol#L85) | [128](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L2BaseToken.sol#L128) | [134](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L2BaseToken.sol#L134) | [140](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L2BaseToken.sol#L140)

```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

79: function finalizeDeposit(
        address _l1Sender,
        address _l2Receiver,
        address _l1Token,
        uint256 _amount,
        bytes calldata _data
    ) external payable override {
123: function withdraw(address _l1Receiver, address _l2Token, uint256 _amount) external override {
149: function l2TokenAddress(address _l1Token) public view override returns (address) {
```
[79](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L79) | [123](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L123) | [149](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L149)

```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

145: function bridgeMint(address _to, uint256 _amount) external override onlyBridge {
154: function bridgeBurn(address _from, uint256 _amount) external override onlyBridge {
158: function name() public view override returns (string memory) {
164: function symbol() public view override returns (string memory) {
170: function decimals() public view override returns (uint8) {
```
[145](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L145) | [154](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L154) | [158](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L158) | [164](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L164) | [170](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L170)
</details>

### [N-116] Setters should prevent re-setting of the same value

Setter functions should include a condition to check if the new value being assigned is different from the current value. This practice prevents redundant state changes and the emission of unnecessary events, ensuring that changes only occur when actual updates to the values are made.

This not only helps to maintain the integrity of the contract's state but also keeps the event logs cleaner and more meaningful by avoiding the recording of identical consecutive values. Such an approach can improve the clarity and efficiency of debugging and data tracking processes.

<details>
<summary><i>22 issue instances in 7 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

/// @audit Missing `_newPendingAdmin` check before state change
55: pendingAdmin = _newPendingAdmin;
```
[55](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L55)

```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

/// @audit Missing `_newDelay` check before state change
251: minDelay = _newDelay;
/// @audit Missing `_newSecurityCouncil` check before state change
258: securityCouncil = _newSecurityCouncil;
```
[251](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L251) | [258](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L258)

```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

/// @audit Missing `_newPendingAdmin` check before state change
114: pendingAdmin = _newPendingAdmin;
/// @audit Missing `_validatorTimelock` check before state change
133: validatorTimelock = _validatorTimelock;
/// @audit Missing `_newProtocolVersion` check before state change
148: protocolVersion = _newProtocolVersion;
```
[114](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L114) | [133](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L133) | [148](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L148)

```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

/// @audit Missing `_stateTransitionManager` check before state change
74: stateTransitionManager = _stateTransitionManager;
/// @audit Missing `_executionDelay` check before state change
97: executionDelay = _executionDelay;
```
[74](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L74) | [97](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L97)

```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol

/// @audit Missing `_bootloaderHash` check before state change
172: _setL2BootloaderBytecodeHash(_bootloaderHash);
/// @audit Missing `_defaultAccountHash` check before state change
173: _setL2DefaultAccountBytecodeHash(_defaultAccountHash);
```
[172](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L172) | [173](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L173)

```solidity
File: code/system-contracts/contracts/NonceHolder.sol

/// @audit Missing `_value` check before state change
93: nonceValues[addressAsKey][_key] = _value;
```
[93](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L93)

```solidity
File: code/system-contracts/contracts/SystemContext.sol

/// @audit Missing `_newChainId` check before state change
85: chainId = _newChainId;
/// @audit Missing `_newOrigin` check before state change
100: origin = _newOrigin;
/// @audit Missing `_gasPrice` check before state change
106: gasPrice = _gasPrice;
/// @audit Missing `_basePubdataSpent` check before state change
113: basePubdataSpent = _basePubdataSpent;
/// @audit Missing `_gasPerPubdataByte` check before state change
114: gasPerPubdataByte = _gasPerPubdataByte;
/// @audit Missing `_prevL2BlockHash` check before state change
319: _setL2BlockHash(_l2BlockNumber - 1, _prevL2BlockHash);
/// @audit Missing `_expectedPrevL2BlockHash` check before state change
365: _setNewL2BlockData(_l2BlockNumber, _l2BlockTimestamp, _expectedPrevL2BlockHash);
/// @audit Missing `_expectedPrevL2BlockHash` check before state change
392: _setNewL2BlockData(_l2BlockNumber, _l2BlockTimestamp, _expectedPrevL2BlockHash);
/// @audit Missing `_l2BlockTimestamp` check before state change
397: _setVirtualBlock(_l2BlockNumber, _maxVirtualBlocksToCreate, _l2BlockTimestamp);
/// @audit Missing `_prevBatchHash` check before state change
455: batchHashes[previousBatchNumber] = _prevBatchHash;
/// @audit Missing `_baseFee` check before state change
462: baseFee = _baseFee;
```
[85](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L85) | [100](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L100) | [106](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L106) | [113](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L113) | [114](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L114) | [319](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L319) | [365](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L365) | [392](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L392) | [397](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L397) | [455](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L455) | [462](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L462)
</details>

### [N-117] NatSpec: Contract declarations should have `@title` tags

NatSpec comments offer an intuitive way to understand the core purpose of a smart contract. 
Especially, the `@title` tag serves as a brief descriptor of the contract's function or intent.
In this Solidity file, the `@title` directive seems to be overlooked.
Incorporating the `@title` tag gives readers a concise overview, thus enhancing clarity.
[Refer to NatSpec Documentation](https://docs.soliditylang.org/en/develop/natspec-format.html)

<details>
<summary><i>83 issue instances in 78 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

19: contract L1ERC20Bridge is IL1ERC20Bridge, ReentrancyGuard {
19: contract L1ERC20Bridge is IL1ERC20Bridge, ReentrancyGuard {
```
[19](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L19) | [19](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L19)

```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

30: contract L1SharedBridge is IL1SharedBridge, ReentrancyGuard, Initializable, Ownable2Step {
```
[30](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L30)

```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

16: contract Bridgehub is IBridgehub, ReentrancyGuard, Ownable2Step {
```
[16](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L16)

```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

20: contract Governance is IGovernance, Ownable2Step {
```
[20](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/governance/Governance.sol#L20)

```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

22: contract ValidatorTimelock is IExecutor, Ownable2Step {
```
[22](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L22)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol

17: contract DiamondInit is ZkSyncStateTransitionBase, IDiamondInit {
```
[17](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol#L17)

```solidity
File: code/contracts/ethereum/contracts/upgrades/DefaultUpgrade.sol

10: contract DefaultUpgrade is BaseZkSyncUpgrade {
```
[10](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/DefaultUpgrade.sol#L10)

```solidity
File: code/contracts/ethereum/contracts/upgrades/GenesisUpgrade.sol

11: contract GenesisUpgrade is BaseZkSyncUpgradeGenesis {
```
[11](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/GenesisUpgrade.sol#L11)

```solidity
File: code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol

10: library L2ContractHelper {
```
[10](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L10)

```solidity
File: code/contracts/ethereum/contracts/common/libraries/UncheckedMath.sol

10: library UncheckedMath {
```
[10](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/UncheckedMath.sol#L10)

```solidity
File: code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol

18: library UnsafeBytes {
```
[18](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol#L18)

```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol

11: library Diamond {
```
[11](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L11)

```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/LibMap.sol

8: library LibMap {
```
[8](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/LibMap.sol#L8)

```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol

9: library Merkle {
```
[9](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol#L9)

```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol

20: library PriorityQueue {
```
[20](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L20)

```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL2Bridge.sol

6: interface IL2Bridge {
```
[6](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IL2Bridge.sol#L6)

```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IWETH9.sol

4: interface IWETH9 {
```
[4](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridge/interfaces/IWETH9.sol#L4)

```solidity
File: code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol

42: interface IBridgehub {
```
[42](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L42)

```solidity
File: code/contracts/ethereum/contracts/common/interfaces/IL2ContractDeployer.sol

9: interface IL2ContractDeployer {
```
[9](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/interfaces/IL2ContractDeployer.sol#L9)

```solidity
File: code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol

26: interface IStateTransitionManager {
```
[26](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L26)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol

61: interface IDiamondInit {
```
[61](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol#L61)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/ILegacyGetters.sol

11: interface ILegacyGetters is IZkSyncStateTransitionBase {
```
[11](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/ILegacyGetters.sol#L11)

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol

15: interface IZkSyncStateTransition is IAdmin, IExecutor, IGetters, IMailbox {
```
[15](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol#L15)

```solidity
File: code/contracts/ethereum/contracts/state-transition/l2-deps/ISystemContext.sol

4: interface ISystemContext {
```
[4](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/l2-deps/ISystemContext.sol#L4)

```solidity
File: code/contracts/ethereum/contracts/upgrades/IDefaultUpgrade.sol

7: interface IDefaultUpgrade {
```
[7](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/upgrades/IDefaultUpgrade.sol#L7)

```solidity
File: code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol

21: library AddressAliasHelper {
```
[21](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol#L21)

```solidity
File: code/system-contracts/contracts/AccountCodeStorage.sol

22: contract AccountCodeStorage is IAccountCodeStorage {
```
[22](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/AccountCodeStorage.sol#L22)

```solidity
File: code/system-contracts/contracts/BootloaderUtilities.sol

16: contract BootloaderUtilities is IBootloaderUtilities {
```
[16](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/BootloaderUtilities.sol#L16)

```solidity
File: code/system-contracts/contracts/ComplexUpgrader.sol

14: contract ComplexUpgrader is IComplexUpgrader {
```
[14](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ComplexUpgrader.sol#L14)

```solidity
File: code/system-contracts/contracts/Compressor.sol

22: contract Compressor is ICompressor, ISystemContract {
```
[22](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Compressor.sol#L22)

```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

23: contract ContractDeployer is IContractDeployer, ISystemContract {
```
[23](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ContractDeployer.sol#L23)

```solidity
File: code/system-contracts/contracts/DefaultAccount.sol

19: contract DefaultAccount is IAccount {
```
[19](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/DefaultAccount.sol#L19)

```solidity
File: code/system-contracts/contracts/EmptyContract.sol

10: contract EmptyContract {
```
[10](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/EmptyContract.sol#L10)

```solidity
File: code/system-contracts/contracts/ImmutableSimulator.sol

18: contract ImmutableSimulator is IImmutableSimulator {
```
[18](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/ImmutableSimulator.sol#L18)

```solidity
File: code/system-contracts/contracts/KnownCodesStorage.sol

18: contract KnownCodesStorage is IKnownCodesStorage, ISystemContract {
```
[18](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/KnownCodesStorage.sol#L18)

```solidity
File: code/system-contracts/contracts/L1Messenger.sol

25: contract L1Messenger is IL1Messenger, ISystemContract {
```
[25](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L25)

```solidity
File: code/system-contracts/contracts/L2BaseToken.sol

18: contract L2BaseToken is IBaseToken, ISystemContract {
```
[18](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L2BaseToken.sol#L18)

```solidity
File: code/system-contracts/contracts/MsgValueSimulator.sol

19: contract MsgValueSimulator is ISystemContract {
```
[19](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/MsgValueSimulator.sol#L19)

```solidity
File: code/system-contracts/contracts/NonceHolder.sol

27: contract NonceHolder is INonceHolder, ISystemContract {
```
[27](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L27)

```solidity
File: code/system-contracts/contracts/PubdataChunkPublisher.sol

16: contract PubdataChunkPublisher is IPubdataChunkPublisher, ISystemContract {
```
[16](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/PubdataChunkPublisher.sol#L16)

```solidity
File: code/system-contracts/contracts/SystemContext.sol

17: contract SystemContext is ISystemContext, ISystemContextDeprecated, ISystemContract {
```
[17](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/SystemContext.sol#L17)

```solidity
File: code/system-contracts/contracts/GasBoundCaller.sol

15: contract GasBoundCaller {
```
[15](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/GasBoundCaller.sol#L15)

```solidity
File: code/system-contracts/contracts/libraries/EfficientCall.sol

32: library EfficientCall {
```
[32](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/EfficientCall.sol#L32)

```solidity
File: code/system-contracts/contracts/libraries/RLPEncoder.sol

10: library RLPEncoder {
```
[10](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/RLPEncoder.sol#L10)

```solidity
File: code/system-contracts/contracts/libraries/SystemContractHelper.sol

41: library SystemContractHelper {
```
[41](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L41)

```solidity
File: code/system-contracts/contracts/libraries/SystemContractsCaller.sol

68: library SystemContractsCaller {
```
[68](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L68)

```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

78: library TransactionHelper {
```
[78](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L78)

```solidity
File: code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol

18: library UnsafeBytesCalldata {
```
[18](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol#L18)

```solidity
File: code/system-contracts/contracts/libraries/Utils.sol

11: library Utils {
```
[11](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L11)

```solidity
File: code/system-contracts/contracts/interfaces/IAccount.sol

9: interface IAccount {
```
[9](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IAccount.sol#L9)

```solidity
File: code/system-contracts/contracts/interfaces/IAccountCodeStorage.sol

5: interface IAccountCodeStorage {
```
[5](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IAccountCodeStorage.sol#L5)

```solidity
File: code/system-contracts/contracts/interfaces/IBaseToken.sol

5: interface IBaseToken {
```
[5](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IBaseToken.sol#L5)

```solidity
File: code/system-contracts/contracts/interfaces/IBootloaderUtilities.sol

7: interface IBootloaderUtilities {
```
[7](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IBootloaderUtilities.sol#L7)

```solidity
File: code/system-contracts/contracts/interfaces/IComplexUpgrader.sol

10: interface IComplexUpgrader {
```
[10](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IComplexUpgrader.sol#L10)

```solidity
File: code/system-contracts/contracts/interfaces/ICompressor.sol

18: interface ICompressor {
```
[18](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/ICompressor.sol#L18)

```solidity
File: code/system-contracts/contracts/interfaces/IContractDeployer.sol

5: interface IContractDeployer {
```
[5](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L5)

```solidity
File: code/system-contracts/contracts/interfaces/IImmutableSimulator.sol

10: interface IImmutableSimulator {
```
[10](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IImmutableSimulator.sol#L10)

```solidity
File: code/system-contracts/contracts/interfaces/IKnownCodesStorage.sol

11: interface IKnownCodesStorage {
```
[11](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IKnownCodesStorage.sol#L11)

```solidity
File: code/system-contracts/contracts/interfaces/IL1Messenger.sol

40: interface IL1Messenger {
```
[40](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IL1Messenger.sol#L40)

```solidity
File: code/system-contracts/contracts/interfaces/IL2StandardToken.sol

5: interface IL2StandardToken {
```
[5](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IL2StandardToken.sol#L5)

```solidity
File: code/system-contracts/contracts/interfaces/IMailbox.sol

5: interface IMailbox {
```
[5](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IMailbox.sol#L5)

```solidity
File: code/system-contracts/contracts/interfaces/INonceHolder.sol

13: interface INonceHolder {
```
[13](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/INonceHolder.sol#L13)

```solidity
File: code/system-contracts/contracts/interfaces/IPaymaster.sol

14: interface IPaymaster {
```
[14](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IPaymaster.sol#L14)

```solidity
File: code/system-contracts/contracts/interfaces/IPaymasterFlow.sol

12: interface IPaymasterFlow {
```
[12](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IPaymasterFlow.sol#L12)

```solidity
File: code/system-contracts/contracts/interfaces/IPubdataChunkPublisher.sol

9: interface IPubdataChunkPublisher {
```
[9](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IPubdataChunkPublisher.sol#L9)

```solidity
File: code/system-contracts/contracts/interfaces/ISystemContext.sol

11: interface ISystemContext {
```
[11](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/ISystemContext.sol#L11)

```solidity
File: code/system-contracts/contracts/interfaces/ISystemContextDeprecated.sol

10: interface ISystemContextDeprecated {
```
[10](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/ISystemContextDeprecated.sol#L10)

```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

23: contract L2SharedBridge is IL2SharedBridge, Initializable {
```
[23](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L23)

```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

15: contract L2StandardERC20 is ERC20PermitUpgradeable, IL2StandardToken, ERC1967Upgrade {
```
[15](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L15)

```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL1ERC20Bridge.sol

8: interface IL1ERC20Bridge {
```
[8](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L8)

```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol

6: interface IL2SharedBridge {
```
[6](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol#L6)

```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol

5: interface IL2StandardToken {
```
[5](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol#L5)

```solidity
File: code/contracts/zksync/contracts/interfaces/IPaymaster.sol

14: interface IPaymaster {
```
[14](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/interfaces/IPaymaster.sol#L14)

```solidity
File: code/contracts/zksync/contracts/interfaces/IPaymasterFlow.sol

13: interface IPaymasterFlow {
```
[13](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/interfaces/IPaymasterFlow.sol#L13)

```solidity
File: code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol

21: library AddressAliasHelper {
```
[21](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol#L21)

```solidity
File: code/contracts/zksync/contracts/ForceDeployUpgrader.sol

10: contract ForceDeployUpgrader {
```
[10](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/ForceDeployUpgrader.sol#L10)

```solidity
File: code/contracts/zksync/contracts/L2ContractHelper.sol

18: interface IL2Messenger {
30: interface IContractDeployer {
61: interface IBaseToken {
83: library L2ContractHelper {
```
[18](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/L2ContractHelper.sol#L18) | [30](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/L2ContractHelper.sol#L30) | [61](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/L2ContractHelper.sol#L61) | [83](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/L2ContractHelper.sol#L83)

```solidity
File: code/contracts/zksync/contracts/SystemContractsCaller.sol

26: library Utils {
36: library SystemContractsCaller {
```
[26](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/SystemContractsCaller.sol#L26) | [36](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/SystemContractsCaller.sol#L36)
</details>

### [N-118] Use Unchecked for Divisions on Constant or Immutable Values

Unsigned divisions on constant or immutable values do not result in overflow.
Therefore, these operations can be marked as unchecked, optimizing gas usage without compromising safety.

For instance, if `a` is an unsigned integer and `b` is a constant or immutable, a / b can be safely rewritten as: unchecked { a / b }

<details>
<summary><i>3 issue instances in 2 files:</i></summary>

```solidity
File: code/system-contracts/contracts/L1Messenger.sol

51: return KECCAK_ROUND_GAS_COST * (_length / KECCAK_ROUND_NUMBER_OF_BYTES + 1);
62: return SHA256_ROUND_GAS_COST * ((_length + 8) / SHA256_ROUND_NUMBER_OF_BYTES + 1);
```
[51](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L51) | [62](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/L1Messenger.sol#L62)

```solidity
File: code/system-contracts/contracts/NonceHolder.sol

180: deploymentNonce = _rawMinNonce / DEPLOY_NONCE_MULTIPLIER;
```
[180](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/NonceHolder.sol#L180)
</details>

### [N-119] Explicit Visibility Recommended in Variable/Function Definitions

In Solidity, variable/function visibility is crucial for controlling access and protecting against unwanted modifications. 
While Solidity functions default to `internal` visibility, it is best practice to explicitly state the visibility for better code readability and avoiding confusion.

The missing visibility could lead to a false sense of security in contract design and potential vulnerabilities.

<details>
<summary><i>163 issue instances in 20 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol

40: uint256 constant L2_LOG_ADDRESS_OFFSET = 4;
43: uint256 constant L2_LOG_KEY_OFFSET = 24;
46: uint256 constant L2_LOG_VALUE_OFFSET = 56;
50: uint256 constant BLS_MODULUS = 52435875175126190479447740508185965837690552500527637822603658699938581184513;
54: uint256 constant PUBDATA_COMMITMENT_SIZE = 144;
57: uint256 constant PUBDATA_COMMITMENT_CLAIMED_VALUE_OFFSET = 16;
60: uint256 constant PUBDATA_COMMITMENT_COMMITMENT_OFFSET = 48;
63: uint256 constant MAX_NUMBER_OF_BLOBS = 2;
68: uint256 constant TOTAL_BLOBS_IN_COMMITMENT = 16;
```
[40](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L40) | [43](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L43) | [46](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L46) | [50](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L50) | [54](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L54) | [57](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L57) | [60](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L60) | [63](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L63) | [68](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L68)

```solidity
File: code/contracts/ethereum/contracts/common/Config.sol

6: bytes32 constant EMPTY_STRING_KECCAK = 0xc5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470;
11: uint256 constant L2_TO_L1_LOG_SERIALIZE_SIZE = 88;
14: uint256 constant MAX_L2_TO_L1_LOGS_COMMITMENT_BYTES = 4 + L2_TO_L1_LOG_SERIALIZE_SIZE * 512;
19: bytes32 constant L2_L1_LOGS_TREE_DEFAULT_LEAF_HASH = 0x72abee45b59e344af8a6e520241c4744aff26ed411f4c4b00f8af09adada43ba;
22: bytes32 constant DEFAULT_L2_LOGS_TREE_ROOT_HASH = bytes32(0);
25: uint256 constant PRIORITY_OPERATION_L2_TX_TYPE = 255;
28: uint256 constant SYSTEM_UPGRADE_L2_TX_TYPE = 254;
33: uint256 constant MAX_ALLOWED_PROTOCOL_VERSION_DELTA = 100;
37: uint256 constant PRIORITY_EXPIRATION = 0 days;
40: uint256 constant COMMIT_TIMESTAMP_NOT_OLDER = 3 days;
44: uint256 constant COMMIT_TIMESTAMP_APPROXIMATION_DELTA = 1 hours;
47: uint256 constant PUBLIC_INPUT_SHIFT = 32;
50: uint256 constant MAX_GAS_PER_TRANSACTION = $(MAX_GAS_PER_TRANSACTION);
54: uint256 constant L1_GAS_PER_PUBDATA_BYTE = $(L1_GAS_PER_PUBDATA_BYTE);
57: uint256 constant L1_TX_INTRINSIC_L2_GAS = $(L1_TX_INTRINSIC_L2_GAS);
60: uint256 constant L1_TX_INTRINSIC_PUBDATA = $(L1_TX_INTRINSIC_PUBDATA);
63: uint256 constant L1_TX_MIN_L2_GAS_BASE = $(L1_TX_MIN_L2_GAS_BASE);
66: uint256 constant L1_TX_DELTA_544_ENCODING_BYTES = $(L1_TX_DELTA_544_ENCODING_BYTES);
69: uint256 constant L1_TX_DELTA_FACTORY_DEPS_L2_GAS = $(L1_TX_DELTA_FACTORY_DEPS_L2_GAS);
72: uint256 constant L1_TX_DELTA_FACTORY_DEPS_PUBDATA = $(L1_TX_DELTA_FACTORY_DEPS_PUBDATA);
75: uint256 constant MAX_NEW_FACTORY_DEPS = $(MAX_NEW_FACTORY_DEPS);
78: uint256 constant REQUIRED_L2_GAS_PRICE_PER_PUBDATA = $(REQUIRED_L2_GAS_PRICE_PER_PUBDATA);
82: uint256 constant PACKED_L2_BLOCK_TIMESTAMP_MASK = 0xffffffffffffffffffffffffffffffff;
85: address constant POINT_EVALUATION_PRECOMPILE_ADDR = address(0x0A);
92: uint256 constant TX_SLOT_OVERHEAD_L2_GAS = 10000;
99: uint256 constant MEMORY_OVERHEAD_GAS = 10;
101: address constant ETH_TOKEN_ADDRESS = address(1);
104: uint256 constant ERA_CHAIN_ID = $(ERA_CHAIN_ID);
107: address constant ERA_ERC20_BRIDGE_ADDRESS = $(ERA_ERC20_BRIDGE_ADDRESS);
110: address constant ERA_DIAMOND_PROXY = $(ERA_DIAMOND_PROXY);
112: bytes32 constant TWO_BRIDGES_MAGIC_VALUE = bytes32(uint256(keccak256("TWO_BRIDGES_MAGIC_VALUE")) - 1);
115: address constant BRIDGEHUB_MIN_SECOND_BRIDGE_ADDRESS = address(uint160(type(uint16).max));
```
[6](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L6) | [11](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L11) | [14](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L14) | [19](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L19) | [22](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L22) | [25](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L25) | [28](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L28) | [33](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L33) | [37](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L37) | [40](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L40) | [44](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L44) | [47](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L47) | [50](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L50) | [54](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L54) | [57](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L57) | [60](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L60) | [63](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L63) | [66](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L66) | [69](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L69) | [72](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L72) | [75](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L75) | [78](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L78) | [82](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L82) | [85](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L85) | [92](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L92) | [99](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L99) | [101](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L101) | [104](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L104) | [107](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L107) | [110](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L110) | [112](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L112) | [115](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L115)

```solidity
File: code/contracts/ethereum/contracts/common/L2ContractAddresses.sol

6: address constant L2_BOOTLOADER_ADDRESS = address(0x8001);
9: address constant L2_KNOWN_CODE_STORAGE_SYSTEM_CONTRACT_ADDR = address(0x8004);
12: address constant L2_DEPLOYER_SYSTEM_CONTRACT_ADDR = address(0x8006);
21: address constant L2_FORCE_DEPLOYER_ADDR = address(0x8007);
24: address constant L2_TO_L1_MESSENGER_SYSTEM_CONTRACT_ADDR = address(0x8008);
27: address constant L2_BASE_TOKEN_SYSTEM_CONTRACT_ADDR = address(0x800a);
30: address constant L2_SYSTEM_CONTEXT_SYSTEM_CONTRACT_ADDR = address(0x800b);
33: address constant L2_PUBDATA_CHUNK_PUBLISHER_ADDR = address(0x8011);
```
[6](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/L2ContractAddresses.sol#L6) | [9](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/L2ContractAddresses.sol#L9) | [12](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/L2ContractAddresses.sol#L12) | [21](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/L2ContractAddresses.sol#L21) | [24](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/L2ContractAddresses.sol#L24) | [27](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/L2ContractAddresses.sol#L27) | [30](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/L2ContractAddresses.sol#L30) | [33](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/L2ContractAddresses.sol#L33)

```solidity
File: code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol

22: uint160 constant offset = uint160(0x1111000000000000000000000000000000001111);
```
[22](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol#L22)

```solidity
File: code/system-contracts/contracts/AccountCodeStorage.sol

23: bytes32 constant EMPTY_STRING_KECCAK = 0xc5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470;
```
[23](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/AccountCodeStorage.sol#L23)

```solidity
File: code/system-contracts/contracts/Constants.sol

25: uint160 constant REAL_SYSTEM_CONTRACTS_OFFSET = 0x8000;
29: uint160 constant MAX_SYSTEM_CONTRACT_ADDRESS = 0xffff; // 2^16 - 1
31: address constant ECRECOVER_SYSTEM_CONTRACT = address(0x01);
32: address constant SHA256_SYSTEM_CONTRACT = address(0x02);
33: address constant ECADD_SYSTEM_CONTRACT = address(0x06);
34: address constant ECMUL_SYSTEM_CONTRACT = address(0x07);
41: uint256 constant COMPUTATIONAL_PRICE_FOR_PUBDATA = 80;
46: uint256 constant CURRENT_MAX_PRECOMPILE_ADDRESS = 0xff;
48: address payable constant BOOTLOADER_FORMAL_ADDRESS = payable(address(SYSTEM_CONTRACTS_OFFSET + 0x01));
49: IAccountCodeStorage constant ACCOUNT_CODE_STORAGE_SYSTEM_CONTRACT = IAccountCodeStorage(
    address(SYSTEM_CONTRACTS_OFFSET + 0x02)
);
52: INonceHolder constant NONCE_HOLDER_SYSTEM_CONTRACT = INonceHolder(address(SYSTEM_CONTRACTS_OFFSET + 0x03));
53: IKnownCodesStorage constant KNOWN_CODE_STORAGE_CONTRACT = IKnownCodesStorage(address(SYSTEM_CONTRACTS_OFFSET + 0x04));
54: IImmutableSimulator constant IMMUTABLE_SIMULATOR_SYSTEM_CONTRACT = IImmutableSimulator(
    address(SYSTEM_CONTRACTS_OFFSET + 0x05)
);
57: IContractDeployer constant DEPLOYER_SYSTEM_CONTRACT = IContractDeployer(address(SYSTEM_CONTRACTS_OFFSET + 0x06));
61: address constant FORCE_DEPLOYER = address(SYSTEM_CONTRACTS_OFFSET + 0x07);
62: IL1Messenger constant L1_MESSENGER_CONTRACT = IL1Messenger(address(SYSTEM_CONTRACTS_OFFSET + 0x08));
63: address constant MSG_VALUE_SYSTEM_CONTRACT = address(SYSTEM_CONTRACTS_OFFSET + 0x09);
65: IBaseToken constant BASE_TOKEN_SYSTEM_CONTRACT = IBaseToken(address(SYSTEM_CONTRACTS_OFFSET + 0x0a));
66: IBaseToken constant REAL_BASE_TOKEN_SYSTEM_CONTRACT = IBaseToken(address(REAL_SYSTEM_CONTRACTS_OFFSET + 0x0a));
71: address constant KECCAK256_SYSTEM_CONTRACT = address(0x8010);
73: ISystemContext constant SYSTEM_CONTEXT_CONTRACT = ISystemContext(payable(address(SYSTEM_CONTRACTS_OFFSET + 0x0b)));
74: ISystemContext constant REAL_SYSTEM_CONTEXT_CONTRACT = ISystemContext(payable(address(REAL_SYSTEM_CONTRACTS_OFFSET + 0x0b)));
76: IBootloaderUtilities constant BOOTLOADER_UTILITIES = IBootloaderUtilities(address(SYSTEM_CONTRACTS_OFFSET + 0x0c));
79: address constant EVENT_WRITER_CONTRACT = address(SYSTEM_CONTRACTS_OFFSET + 0x0d);
81: ICompressor constant COMPRESSOR_CONTRACT = ICompressor(address(SYSTEM_CONTRACTS_OFFSET + 0x0e));
83: IComplexUpgrader constant COMPLEX_UPGRADER_CONTRACT = IComplexUpgrader(address(SYSTEM_CONTRACTS_OFFSET + 0x0f));
85: IPubdataChunkPublisher constant PUBDATA_CHUNK_PUBLISHER = IPubdataChunkPublisher(
    address(SYSTEM_CONTRACTS_OFFSET + 0x11)
);
91: uint256 constant MSG_VALUE_SIMULATOR_IS_SYSTEM_BIT = 1;
94: uint256 constant MAX_MSG_VALUE = 2 ** 128 - 1;
98: bytes32 constant CREATE2_PREFIX = 0x2020dba91b30cc0006188af794c2fb30dd8520db7e2c088b7fc7c103c00ca494;
101: bytes32 constant CREATE_PREFIX = 0x63bae3a9951d38e8a3fbb7b70909afc1200610fc5bc55ade242f815974674f23;
104: uint256 constant STATE_DIFF_ENTRY_SIZE = 272;
108: uint256 constant MAX_ALLOWED_PUBDATA_PER_BATCH = 520000;
125: uint256 constant L2_TO_L1_LOGS_MERKLE_TREE_LEAVES = 4096;
128: uint256 constant DERIVED_KEY_LENGTH = 32;
130: uint256 constant ENUM_INDEX_LENGTH = 8;
132: uint256 constant VALUE_LENGTH = 32;
135: uint256 constant COMPRESSED_INITIAL_WRITE_SIZE = DERIVED_KEY_LENGTH + VALUE_LENGTH;
137: uint256 constant COMPRESSED_REPEATED_WRITE_SIZE = ENUM_INDEX_LENGTH + VALUE_LENGTH;
140: uint256 constant INITIAL_WRITE_STARTING_POSITION = 4;
145: uint256 constant STATE_DIFF_DERIVED_KEY_OFFSET = 52;
147: uint256 constant STATE_DIFF_ENUM_INDEX_OFFSET = 84;
149: uint256 constant STATE_DIFF_FINAL_VALUE_OFFSET = 124;
154: uint256 constant BLOB_SIZE_BYTES = 126_976;
157: uint256 constant MAX_NUMBER_OF_BLOBS = 2;
```
[25](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L25) | [29](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L29) | [31](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L31) | [32](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L32) | [33](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L33) | [34](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L34) | [41](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L41) | [46](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L46) | [48](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L48) | [49](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L49) | [52](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L52) | [53](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L53) | [54](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L54) | [57](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L57) | [61](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L61) | [62](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L62) | [63](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L63) | [65](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L65) | [66](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L66) | [71](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L71) | [73](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L73) | [74](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L74) | [76](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L76) | [79](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L79) | [81](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L81) | [83](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L83) | [85](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L85) | [91](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L91) | [94](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L94) | [98](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L98) | [101](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L101) | [104](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L104) | [108](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L108) | [125](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L125) | [128](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L128) | [130](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L130) | [132](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L132) | [135](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L135) | [137](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L137) | [140](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L140) | [145](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L145) | [147](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L147) | [149](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L149) | [154](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L154) | [157](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/Constants.sol#L157)

```solidity
File: code/system-contracts/contracts/MsgValueSimulator.sol

36: uint256 constant GAS_TO_PASS = 2300;
41: uint256 constant MSG_VALUE_SIMULATOR_STIPEND_GAS = 27000;
```
[36](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/MsgValueSimulator.sol#L36) | [41](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/MsgValueSimulator.sol#L41)

```solidity
File: code/system-contracts/contracts/GasBoundCaller.sol

18: uint256 constant CALL_ENTRY_OVERHEAD = 800;
21: uint256 constant CALL_RETURN_OVERHEAD = 200;
```
[18](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/GasBoundCaller.sol#L18) | [21](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/GasBoundCaller.sol#L21)

```solidity
File: code/system-contracts/contracts/libraries/SystemContractHelper.sol

9: uint256 constant UINT32_MASK = type(uint32).max;
10: uint256 constant UINT64_MASK = type(uint64).max;
11: uint256 constant UINT128_MASK = type(uint128).max;
12: uint256 constant ADDRESS_MASK = type(uint160).max;
```
[9](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L9) | [10](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L10) | [11](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L11) | [12](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L12)

```solidity
File: code/system-contracts/contracts/libraries/SystemContractsCaller.sol

12: address constant TO_L1_CALL_ADDRESS = address((1 << 16) - 1);
13: address constant CODE_ADDRESS_CALL_ADDRESS = address((1 << 16) - 2);
14: address constant PRECOMPILE_CALL_ADDRESS = address((1 << 16) - 3);
15: address constant META_CALL_ADDRESS = address((1 << 16) - 4);
16: address constant MIMIC_CALL_CALL_ADDRESS = address((1 << 16) - 5);
17: address constant SYSTEM_MIMIC_CALL_CALL_ADDRESS = address((1 << 16) - 6);
18: address constant MIMIC_CALL_BY_REF_CALL_ADDRESS = address((1 << 16) - 7);
19: address constant SYSTEM_MIMIC_CALL_BY_REF_CALL_ADDRESS = address((1 << 16) - 8);
20: address constant RAW_FAR_CALL_CALL_ADDRESS = address((1 << 16) - 9);
21: address constant RAW_FAR_CALL_BY_REF_CALL_ADDRESS = address((1 << 16) - 10);
22: address constant SYSTEM_CALL_CALL_ADDRESS = address((1 << 16) - 11);
23: address constant SYSTEM_CALL_BY_REF_CALL_ADDRESS = address((1 << 16) - 12);
24: address constant SET_CONTEXT_VALUE_CALL_ADDRESS = address((1 << 16) - 13);
25: address constant SET_PUBDATA_PRICE_CALL_ADDRESS = address((1 << 16) - 14);
26: address constant INCREMENT_TX_COUNTER_CALL_ADDRESS = address((1 << 16) - 15);
27: address constant PTR_CALLDATA_CALL_ADDRESS = address((1 << 16) - 16);
28: address constant CALLFLAGS_CALL_ADDRESS = address((1 << 16) - 17);
29: address constant PTR_RETURNDATA_CALL_ADDRESS = address((1 << 16) - 18);
30: address constant EVENT_INITIALIZE_ADDRESS = address((1 << 16) - 19);
31: address constant EVENT_WRITE_ADDRESS = address((1 << 16) - 20);
32: address constant LOAD_CALLDATA_INTO_ACTIVE_PTR_CALL_ADDRESS = address((1 << 16) - 21);
33: address constant LOAD_LATEST_RETURNDATA_INTO_ACTIVE_PTR_CALL_ADDRESS = address((1 << 16) - 22);
34: address constant PTR_ADD_INTO_ACTIVE_CALL_ADDRESS = address((1 << 16) - 23);
35: address constant PTR_SHRINK_INTO_ACTIVE_CALL_ADDRESS = address((1 << 16) - 24);
36: address constant PTR_PACK_INTO_ACTIVE_CALL_ADDRESS = address((1 << 16) - 25);
37: address constant MULTIPLICATION_HIGH_ADDRESS = address((1 << 16) - 26);
38: address constant GET_EXTRA_ABI_DATA_ADDRESS = address((1 << 16) - 27);
41: uint256 constant META_GAS_PER_PUBDATA_BYTE_OFFSET = 0 * 8;
42: uint256 constant META_HEAP_SIZE_OFFSET = 8 * 8;
43: uint256 constant META_AUX_HEAP_SIZE_OFFSET = 12 * 8;
44: uint256 constant META_SHARD_ID_OFFSET = 28 * 8;
45: uint256 constant META_CALLER_SHARD_ID_OFFSET = 29 * 8;
46: uint256 constant META_CODE_SHARD_ID_OFFSET = 30 * 8;
```
[12](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L12) | [13](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L13) | [14](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L14) | [15](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L15) | [16](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L16) | [17](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L17) | [18](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L18) | [19](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L19) | [20](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L20) | [21](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L21) | [22](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L22) | [23](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L23) | [24](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L24) | [25](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L25) | [26](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L26) | [27](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L27) | [28](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L28) | [29](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L29) | [30](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L30) | [31](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L31) | [32](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L32) | [33](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L33) | [34](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L34) | [35](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L35) | [36](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L36) | [37](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L37) | [38](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L38) | [41](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L41) | [42](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L42) | [43](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L43) | [44](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L44) | [45](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L45) | [46](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L46)

```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

15: uint8 constant EIP_712_TX_TYPE = 0x71;
18: uint8 constant LEGACY_TX_TYPE = 0x0;
20: uint8 constant EIP_2930_TX_TYPE = 0x01;
22: uint8 constant EIP_1559_TX_TYPE = 0x02;
82: bytes32 constant EIP712_DOMAIN_TYPEHASH = keccak256("EIP712Domain(string name,string version,uint256 chainId)");
84: bytes32 constant EIP712_TRANSACTION_TYPE_HASH =
        keccak256(
            "Transaction(uint256 txType,uint256 from,uint256 to,uint256 gasLimit,uint256 gasPerPubdataByteLimit,uint256 maxFeePerGas,uint256 maxPriorityFeePerGas,uint256 paymaster,uint256 nonce,uint256 value,bytes data,bytes32[] factoryDeps,bytes paymasterInput)"
        );
```
[15](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L15) | [18](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L18) | [20](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L20) | [22](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L22) | [82](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L82) | [84](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/TransactionHelper.sol#L84)

```solidity
File: code/system-contracts/contracts/libraries/Utils.sol

13: bytes32 constant IS_CONSTRUCTOR_BYTECODE_HASH_BIT_MASK =
        0x00ff000000000000000000000000000000000000000000000000000000000000;
17: bytes32 constant SET_IS_CONSTRUCTOR_MARKER_BIT_MASK =
        0x0001000000000000000000000000000000000000000000000000000000000000;
```
[13](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L13) | [17](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/libraries/Utils.sol#L17)

```solidity
File: code/system-contracts/contracts/interfaces/IAccount.sol

7: bytes4 constant ACCOUNT_VALIDATION_SUCCESS_MAGIC = IAccount.validateTransaction.selector;
```
[7](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IAccount.sol#L7)

```solidity
File: code/system-contracts/contracts/interfaces/ICompressor.sol

6: uint8 constant OPERATION_BITMASK = 7;
8: uint8 constant LENGTH_BITS_OFFSET = 3;
10: uint8 constant MAX_ENUMERATION_INDEX_SIZE = 8;
```
[6](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/ICompressor.sol#L6) | [8](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/ICompressor.sol#L8) | [10](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/ICompressor.sol#L10)

```solidity
File: code/system-contracts/contracts/interfaces/IL1Messenger.sol

25: uint256 constant L2_TO_L1_LOG_SERIALIZE_SIZE = 88;
30: bytes32 constant L2_L1_LOGS_TREE_DEFAULT_LEAF_HASH = 0x72abee45b59e344af8a6e520241c4744aff26ed411f4c4b00f8af09adada43ba;
33: uint256 constant STATE_DIFF_COMPRESSION_VERSION_NUMBER = 1;
```
[25](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IL1Messenger.sol#L25) | [30](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IL1Messenger.sol#L30) | [33](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IL1Messenger.sol#L33)

```solidity
File: code/system-contracts/contracts/interfaces/IPaymaster.sol

12: bytes4 constant PAYMASTER_VALIDATION_SUCCESS_MAGIC = IPaymaster.validateAndPayForPaymasterTransaction.selector;
```
[12](https://github.com/code-423n4/2024-03-zksync/blob/main/code/system-contracts/contracts/interfaces/IPaymaster.sol#L12)

```solidity
File: code/contracts/zksync/contracts/interfaces/IPaymaster.sol

12: bytes4 constant PAYMASTER_VALIDATION_SUCCESS_MAGIC = IPaymaster.validateAndPayForPaymasterTransaction.selector;
```
[12](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/interfaces/IPaymaster.sol#L12)

```solidity
File: code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol

22: uint160 constant offset = uint160(0x1111000000000000000000000000000000001111);
```
[22](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol#L22)

```solidity
File: code/contracts/zksync/contracts/L2ContractHelper.sol

68: uint160 constant SYSTEM_CONTRACTS_OFFSET = 0x8000; // 2^15
70: address constant BOOTLOADER_ADDRESS = address(SYSTEM_CONTRACTS_OFFSET + 0x01);
71: address constant MSG_VALUE_SYSTEM_CONTRACT = address(SYSTEM_CONTRACTS_OFFSET + 0x09);
72: address constant DEPLOYER_SYSTEM_CONTRACT = address(SYSTEM_CONTRACTS_OFFSET + 0x06);
74: IL2Messenger constant L2_MESSENGER = IL2Messenger(address(SYSTEM_CONTRACTS_OFFSET + 0x08));
76: IBaseToken constant L2_BASE_TOKEN_ADDRESS = IBaseToken(address(SYSTEM_CONTRACTS_OFFSET + 0x0a));
```
[68](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/L2ContractHelper.sol#L68) | [70](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/L2ContractHelper.sol#L70) | [71](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/L2ContractHelper.sol#L71) | [72](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/L2ContractHelper.sol#L72) | [74](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/L2ContractHelper.sol#L74) | [76](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/L2ContractHelper.sol#L76)

```solidity
File: code/contracts/zksync/contracts/SystemContractsCaller.sol

7: address constant SYSTEM_CALL_CALL_ADDRESS = address((1 << 16) - 11);
10: uint256 constant MSG_VALUE_SIMULATOR_IS_SYSTEM_BIT = 1;
```
[7](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/SystemContractsCaller.sol#L7) | [10](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync/contracts/SystemContractsCaller.sol#L10)
</details>

### [N-120] Open TODOs

An open TODO is present in the code. It is recommended to avoid open TODOs
as they may indicate programming errors that still need to be fixed.

<details>
<summary><i>2 issue instances in 2 files:</i></summary>

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

338: layer2Tip: uint192(0) // TODO: Restore after fee modeling will be stable. (SMA-1230)
```
[338](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L338)

```solidity
File: code/contracts/ethereum/contracts/common/Config.sol

21: // TODO: change constant to the real root hash of empty Merkle tree (SMA-184)
```
[21](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum/contracts/common/Config.sol#L21)
</details>

### [N-121] Contracts should have full test coverage

It's recommended to have full test coverage for all contracts.
While 100% code coverage does not guarantee absence of bugs, it can catch simple bugs and reduce regressions during code modifications.
Moreover, to achieve full coverage, authors often have to refactor their code into more modular components, each testable separately.
This leads to lower interdependencies, and results in code that is easier to understand and audit.

<details>
<summary><i>1 issue instances in 1 files:</i></summary>

```solidity
File: app/2024-03-zksync

1: All files
```
[1](https://github.com/code-423n4/2024-03-zksync/blob/main/app/2024-03-zksync#L1)
</details>

### [N-122] Large or complicated code bases should implement invariant tests

Large or complex code bases should include invariant fuzzing tests, such as those provided by Echidna.
These tests require the identification of invariants that should not be violated under any circumstances, with the fuzzer testing various inputs and function calls to ensure these invariants always hold.
This is especially important for code with a lot of inline-assembly, complicated math, or complex interactions between contracts. Despite having 100% code coverage, bugs can still occur due to the order of operations a user performs.
Extensive and well-written invariant tests can significantly reduce this testing gap.

<details>
<summary><i>1 issue instances in 1 files:</i></summary>

```solidity
File: app/2024-03-zksync

1: All files
```
[1](https://github.com/code-423n4/2024-03-zksync/blob/main/app/2024-03-zksync#L1)
</details>

### [N-123] Implement Formal Verification Proofs to Improve Security

Formal verification offers a mathematical proof confirming that your code operates as intended and is devoid of edge cases 
that may lead to unintended behavior. By leveraging this rigorous audit technique, you not only enhance the robustness 
of your code but also strengthen the trust of stakeholders in the safety of your contract.

<details>
<summary><i>1 issue instances in 1 files:</i></summary>

```solidity
File: app/2024-03-zksync

1: All files
```
[1](https://github.com/code-423n4/2024-03-zksync/blob/main/app/2024-03-zksync#L1)
</details>

