## Summary

### Low Risk Issues

| |Issue|Instances|
|-|:-|:-:|
| [[L&#x2011;1](#l1-vulnerable-versions-of-packages-are-being-used)] | Vulnerable versions of packages are being used | 2 | 
| [[L&#x2011;2](#l2-missing-checks-for-address-0-when-assigning-values-to-address-state-variables)] | Missing checks for `address(0)` when assigning values to address state variables | 12 | 
| [[L&#x2011;3](#l3-avoid-using-abi-encodepacked-with-dynamic-types-in-hash-functions-like-keccak256)] | Avoid Using abi.encodePacked() with Dynamic Types in Hash Functions like keccak256() | 2 | 
| [[L&#x2011;4](#l4-for-loops-in-public-or-external-functions-should-be-avoided-due-to-high-gas-costs-and-possible-dos)] | For loops in public or external functions should be avoided due to high gas costs and possible DOS | 18 | 
| [[L&#x2011;5](#l5-external-call-recipient-may-consume-all-transaction-gas-gas-griefing)] | External call `recipient` may consume all transaction gas (gas griefing) | 2 | 
| [[L&#x2011;6](#l6-missing-checks-in-constructor)] | Missing checks in constructor | 1 | 
| [[L&#x2011;7](#l7-signature-malleability-of-evm-s-ecrecover)] | Signature Malleability of EVM's ecrecover | 1 | 
| [[L&#x2011;8](#l8-division-before-multiplication-can-lead-to-precision-errors)] | Division before multiplication can lead to precision errors | 2 | 
| [[L&#x2011;9](#l9-double-type-casts-create-complexity-within-the-code)] | Double type casts create complexity within the code | 9 | 
| [[L&#x2011;10](#l10-draft-imports-may-break-in-new-minor-versions)] | Draft imports may break in new minor versions | 1 | 
| [[L&#x2011;11](#l11-initialization-can-be-front-run)] | Initialization can be front-run | 6 | 
| [[L&#x2011;12](#l12-internal-function-calls-within-for-loops)] | `internal` Function calls within for loops | 25 | 
| [[L&#x2011;13](#l13-loss-of-precision)] | Loss of precision | 3 | 
| [[L&#x2011;14](#l14-missing-contract-existence-checks-before-low-level-calls)] | Missing contract-existence checks before low-level calls | 4 | 
| [[L&#x2011;15](#l15-require-should-be-used-instead-of-assert)] | `require()` should be used instead of `assert()` | 5 | 
| [[L&#x2011;16](#l16-consider-using-openzeppelin-s-safecast-library-to-prevent-unexpected-overflows-when-casting-from-various-type-int-uint-values)] | Consider using OpenZeppelinâ€™s SafeCast library to prevent unexpected overflows when casting from various type int/uint values | 48 | 
| [[L&#x2011;17](#l17-setters-should-have-initial-value-check)] | Setters should have initial value check | 16 | 
| [[L&#x2011;18](#l18-solidity-version-0-8-20-may-not-work-on-other-chains-due-to-push0)] | Solidity version 0.8.20 may not work on other chains due to `PUSH0` | 3 | 
| [[L&#x2011;19](#l19-int-casting-block-timestamp-can-reduce-the-lifespan-of-a-contract)] | Int casting `block.timestamp` can reduce the lifespan of a contract | 2 | 
| [[L&#x2011;20](#l20-unsafe-downcast)] | Unsafe downcast | 33 | 
| [[L&#x2011;21](#l21-unused-empty-receive-fallback-function)] | Unused/empty `receive()`/`fallback()` function | 4 | 
| [[L&#x2011;22](#l22-consider-implementing-two-step-procedure-for-updating-protocol-addresses)] | Consider implementing two-step procedure for updating protocol addresses | 7 | 
| [[L&#x2011;23](#l23-upgradeable-contract-uses-non-upgradeable-version-of-the-openzeppelin-libraries-contracts)] | Upgradeable contract uses non-upgradeable version of the OpenZeppelin libraries/contracts | 4 | 
| [[L&#x2011;24](#l24-upgradeable-contract-is-missing-a-gap-50-storage-variable-to-allow-for-new-storage-variables-in-later-versions)] | Upgradeable contract is missing a `__gap[50]` storage variable to allow for new storage variables in later versions | 1 | 
| [[L&#x2011;25](#l25-safeapprove-is-deprecated)] | `safeApprove()` is deprecated | 2 | 
| [[L&#x2011;26](#l26-consider-using-descriptive-constant-s-when-passing-zero-as-a-function-argument)] | Consider using descriptive `constant`s when passing zero as a function argument | 15 | 
| [[L&#x2011;27](#l27-check-of-division-by-zero)] | Check of division by zero | 1 | 
| [[L&#x2011;28](#l28-functions-calling-contracts-addresses-with-transfer-hooks-are-missing-reentrancy-guards)] | Functions calling contracts/addresses with transfer hooks are missing reentrancy guards | 3 | 
| [[L&#x2011;29](#l29-code-does-not-follow-the-best-practice-of-check-effects-interaction)] | Code does not follow the best practice of check-effects-interaction | 6 | 
| [[L&#x2011;30](#l30-prevent-re-setting-a-state-variable-with-the-same-value)] | prevent re-setting a state variable with the same value | 28 | 
| [[L&#x2011;31](#l31-missing-contract-existence-checks-before-yul-call)] | Missing contract-existence checks before yul `call()` | 28 | 
| [[L&#x2011;32](#l32-subtraction-may-underflow-if-multiplication-is-too-large)] | Subtraction may underflow if multiplication is too large | 1 | 
| [[L&#x2011;33](#l33-use-of-tx-origin-is-unsafe-in-almost-every-context)] | Use of `tx.origin` is unsafe in almost every context | 3 | 
| [[L&#x2011;34](#l34-address-es-upcast-and-compared-to-values-larger-than-a-uint160-may-result-in-collisions)] | `address`es upcast and compared to values larger than a `uint160`, may result in collisions | 1 | 
| [[L&#x2011;35](#l35-function-can-return-unassigned-variable)] | Function can return unassigned variable | 4 | 
| [[L&#x2011;36](#l36-named-return-variable-used-before-assignment)] | Named return variable used before assignment | 1 | 
| [[L&#x2011;37](#l37-missing-checks-in-initializer-function)] | Missing checks in initializer function | 1 | 
| [[L&#x2011;38](#l38-variables-shadowing-other-definitions)] | Variables shadowing other definitions | 4 | 
| [[L&#x2011;39](#l39-solidity-bug-in-legacy-code-generation-when-accessing-the-selector-member-on-expressions-with-side-effects)] | [Solidity]: Bug in Legacy Code Generation When Accessing the .selector Member on Expressions with Side Effects | 9 | 
| [[L&#x2011;40](#l40-empty-receive-functions-can-cause-gas-issues)] | Empty receive functions can cause gas issues | 3 | 

Total: 321 instances over 40 issues

### Non-critical Issues

| |Issue|Instances|
|-|:-|:-:|
| [[NC&#x2011;1](#nc1-consider-using-modifiers-for-address-control)] | Consider using modifiers for address control | 15 | 
| [[NC&#x2011;2](#nc2-large-or-complicated-code-bases-should-implement-invariant-tests)] | Large or complicated code bases should implement invariant tests | 2 | 
| [[NC&#x2011;3](#nc3-assembly-blocks-should-have-extensive-comments)] | Assembly blocks should have extensive comments | 71 | 
| [[NC&#x2011;4](#nc4-natspec-natspec-author-is-missing-from-contract)] | [NatSpec] Natspec `@author` is missing from `contract` | 25 | 
| [[NC&#x2011;5](#nc5-avoid-the-use-of-sensitive-terms)] | Avoid the use of sensitive terms | 65 | 
| [[NC&#x2011;6](#nc6-use-bit-shifts-in-an-imutable-variable-rather-than-long-bit-masks-of-a-single-bit-for-readability)] | Use bit shifts in an imutable variable rather than long bit masks of a single bit, for readability | 1 | 
| [[NC&#x2011;7](#nc7-common-functions-should-be-refactored-to-a-common-base-contract)] | Common functions should be refactored to a common base contract | 3 | 
| [[NC&#x2011;8](#nc8-overly-complicated-arithmetic)] | Overly complicated arithmetic | 2 | 
| [[NC&#x2011;9](#nc9-constant-redefined-elsewhere)] | Constant redefined elsewhere | 5 | 
| [[NC&#x2011;10](#nc10-constants-in-comparisons-should-appear-on-the-left-side)] | Constants in comparisons should appear on the left side | 160 | 
| [[NC&#x2011;11](#nc11-const-variable-names-don-t-follow-the-solidity-style-guide)] | `const` Variable names don\'t follow the Solidity style guide | 7 | 
| [[NC&#x2011;12](#nc12-natspec-natspec-description-is-missing-from-contract)] | [NatSpec] Natspec description is missing from `contract` | 287 | 
| [[NC&#x2011;13](#nc13-contract-does-not-follow-the-solidity-style-guide-s-suggested-layout-ordering)] | Contract does not follow the Solidity style guide's suggested layout ordering | 12 | 
| [[NC&#x2011;14](#nc14-control-structures-do-not-follow-the-solidity-style-guide)] | Control structures do not follow the Solidity Style Guide | 181 | 
| [[NC&#x2011;15](#nc15-default-address-0-can-be-returned)] | Default address(0) can be returned | 2 | 
| [[NC&#x2011;16](#nc16-consider-using-delete-rather-than-assigning-zero-to-clear-values)] | Consider using `delete` rather than assigning `zero` to clear values | 3 | 
| [[NC&#x2011;17](#nc17-use-eip-5627-to-describe-eip-712-domains)] | Use EIP-5627 to describe EIP-712 domains | 1 | 
| [[NC&#x2011;18](#nc18-else-block-not-required)] | `else`-block not required | 3 | 
| [[NC&#x2011;19](#nc19-empty-bytes-check-is-missing)] | Empty bytes check is missing | 113 | 
| [[NC&#x2011;20](#nc20-events-are-missing-sender-information)] | Events are missing sender information | 69 | 
| [[NC&#x2011;21](#nc21-events-may-be-emitted-out-of-order-due-to-reentrancy)] | Events may be emitted out of order due to reentrancy | 19 | 
| [[NC&#x2011;22](#nc22-explicitly-define-visibility-of-state-variables-to-prevent-misconceptions-on-what-can-access-the-variable)] | Explicitly define visibility of state variables to prevent misconceptions on what can access the variable | 13 | 
| [[NC&#x2011;23](#nc23-defining-all-external-public-functions-in-contract-interfaces)] | Defining All External/Public Functions in Contract Interfaces | 29 | 
| [[NC&#x2011;24](#nc24-function-ordering-does-not-follow-the-solidity-style-guide)] | Function ordering does not follow the Solidity style guide | 30 | 
| [[NC&#x2011;25](#nc25-address-s-shouldn-t-be-hard-coded)] | `address`s shouldn't be hard-coded | 2 | 
| [[NC&#x2011;26](#nc26-array-indicies-should-be-referenced-via-enum-s-rather-than-via-numeric-literals)] | Array indicies should be referenced via `enum`s rather than via numeric literals | 22 | 
| [[NC&#x2011;27](#nc27-hardcoded-string-that-is-repeatedly-used-can-be-replaced-with-a-constant)] | Hardcoded string that is repeatedly used can be replaced with a constant | 5 | 
| [[NC&#x2011;28](#nc28-duplicated-require-checks-should-be-refactored-to-a-modifier-or-function)] | Duplicated `require()` checks should be refactored to a modifier or function | 7 | 
| [[NC&#x2011;29](#nc29-some-if-statement-can-be-converted-to-a-ternary)] | Some if-statement can be converted to a ternary | 11 | 
| [[NC&#x2011;30](#nc30-imports-could-be-organized-more-systematically)] | Imports could be organized more systematically | 19 | 
| [[NC&#x2011;31](#nc31-import-declarations-should-import-specific-identifiers-rather-than-the-whole-file)] | Import declarations should import specific identifiers, rather than the whole file | 41 | 
| [[NC&#x2011;32](#nc32-inconsistent-spacing-in-comments)] | Inconsistent spacing in comments | 16 | 
| [[NC&#x2011;33](#nc33-inconsistent-usage-of-require-error)] | Inconsistent usage of `require`/`error` | 2 | 
| [[NC&#x2011;34](#nc34-internal-functions-not-called-by-the-contract-should-be-removed)] | `internal` functions not called by the contract should be removed | 10 | 
| [[NC&#x2011;35](#nc35-large-numeric-literals-should-use-underscores-for-readability)] | Large numeric literals should use underscores for readability | 8 | 
| [[NC&#x2011;36](#nc36-long-functions-should-be-refactored-into-multiple-smaller-functions)] | Long functions should be refactored into multiple, smaller, functions | 29 | 
| [[NC&#x2011;37](#nc37-long-lines-of-code)] | Long lines of code | 164 | 
| [[NC&#x2011;38](#nc38-missing-event-and-or-timelock-for-critical-parameter-change)] | Missing event and or timelock for critical parameter change | 11 | 
| [[NC&#x2011;39](#nc39-file-is-missing-natspec)] | File is missing NatSpec | 11 | 
| [[NC&#x2011;40](#nc40-mixed-usage-of-int-uint-with-int256-uint256)] | Mixed usage of `int`/`uint` with `int256`/`uint256` | 1 | 
| [[NC&#x2011;41](#nc41-consider-using-named-mappings)] | Consider using named mappings | 9 | 
| [[NC&#x2011;42](#nc42-consider-using-later-versions-of-solidity-for-more-cappabilities)] | Consider using later versions of solidity for more cappabilities | 1 | 
| [[NC&#x2011;43](#nc43-some-error-strings-are-not-descriptive)] | Some error strings are not descriptive | 152 | 
| [[NC&#x2011;44](#nc44-the-nonreentrant-modifier-should-occur-before-all-other-modifiers)] | The `nonReentrant` `modifier` should occur before all other modifiers | 2 | 
| [[NC&#x2011;45](#nc45-events-that-mark-critical-parameter-changes-should-contain-both-the-old-and-the-new-value)] | Events that mark critical parameter changes should contain both the old and the new value | 22 | 
| [[NC&#x2011;46](#nc46-override-function-arguments-that-are-unused-should-have-the-variable-name-removed-or-commented-out-to-avoid-compiler-warnings)] | `override` function arguments that are unused should have the variable name removed or commented out to avoid compiler warnings | 2 | 
| [[NC&#x2011;47](#nc47-use-of-override-is-unnecessary)] | Use of `override` is unnecessary | 50 | 
| [[NC&#x2011;48](#nc48-use-openzeppelin-s-merkleproof-rather-than-rolling-your-own)] | Use OpenZeppelin's `MerkleProof` rather than rolling your own | 1 | 
| [[NC&#x2011;49](#nc49-functions-which-are-either-private-or-internal-should-have-a-preceding-in-their-name)] | Functions which are either private or internal should have a preceding _ in their name | 109 | 
| [[NC&#x2011;50](#nc50-private-and-internal-state-variables-should-have-a-preceding-in-their-name-unless-they-are-constants)] | Private and internal state variables should have a preceding _ in their name unless they are constants | 28 | 
| [[NC&#x2011;51](#nc51-public-functions-not-called-by-the-contract-should-be-declared-external-instead)] | `public` functions not called by the contract should be declared `external` instead | 11 | 
| [[NC&#x2011;52](#nc52-adding-a-return-statement-when-the-function-defines-a-named-return-variable-is-redundant)] | Adding a `return` statement when the function defines a named return variable, is redundant | 1 | 
| [[NC&#x2011;53](#nc53-require-revert-statements-should-have-descriptive-reason-strings)] | `require()` / `revert()` statements should have descriptive reason strings | 16 | 
| [[NC&#x2011;54](#nc54-setters-should-prevent-re-setting-of-the-same-value)] | Setters should prevent re-setting of the same value | 15 | 
| [[NC&#x2011;55](#nc55-natspec-return-argument-is-missing)] | NatSpec `@return` argument is missing | 100 | 
| [[NC&#x2011;56](#nc56-consider-using-safetransferlib-safetransfereth-or-address-sendvalue-for-clearer-semantic-meaning)] | Consider using `SafeTransferLib.safeTransferETH()` or `Address.sendValue()` for clearer semantic meaning | 2 | 
| [[NC&#x2011;57](#nc57-polymorphic-functions-make-security-audits-more-time-consuming-and-error-prone)] | Polymorphic functions make security audits more time-consuming and error-prone | 2 | 
| [[NC&#x2011;58](#nc58-large-multiples-of-ten-should-use-scientific-notation-e-g-1e6-rather-than-decimal-literals-e-g-1000000-for-readability)] | Large multiples of ten should use scientific notation (e.g. `1e6`) rather than decimal literals (e.g. `1000000`), for readability | 1 | 
| [[NC&#x2011;59](#nc59-consider-moving-msg-sender-checks-to-a-common-authorization-modifier)] | Consider moving `msg.sender` checks to a common authorization `modifier` | 9 | 
| [[NC&#x2011;60](#nc60-empty-receive-payable-fallback-function-does-not-authorize-requests)] | Empty `receive()`/`payable fallback()` function does not authorize requests | 4 | 
| [[NC&#x2011;61](#nc61-state-variables-should-have-natspec-comments)] | State variables should have `Natspec` comments | 10 | 
| [[NC&#x2011;62](#nc62-contracts-should-have-full-test-coverage)] | Contracts should have full test coverage | 3 | 
| [[NC&#x2011;63](#nc63-natspec-natspec-title-is-missing-from-contract)] | [NatSpec] Natspec `@title` is missing from `contract` | 85 | 
| [[NC&#x2011;64](#nc64-open-todos)] | Open TODOs | 3 | 
| [[NC&#x2011;65](#nc65-top-level-pragma-declarations-should-be-separated-by-two-blank-lines)] | Top level pragma declarations should be separated by two blank lines | 76 | 
| [[NC&#x2011;66](#nc66-critical-functions-should-be-a-two-step-procedure)] | Critical functions should be a two step procedure | 36 | 
| [[NC&#x2011;67](#nc67-typos)] | Typos | 1 | 
| [[NC&#x2011;68](#nc68-2-n-1-should-be-re-written-as-type-uint-n-max)] | `2**<n> - 1` should be re-written as `type(uint<n>).max` | 5 | 
| [[NC&#x2011;69](#nc69-uncommented-fields-in-a-struct)] | Uncommented fields in a struct | 18 | 
| [[NC&#x2011;70](#nc70-using-underscore-at-the-end-of-variable-name)] | Using underscore at the end of variable name | 1 | 
| [[NC&#x2011;71](#nc71-event-is-missing-indexed-fields)] | Event is missing `indexed` fields | 42 | 
| [[NC&#x2011;72](#nc72-unused-import)] | Unused Import | 69 | 
| [[NC&#x2011;73](#nc73-unused-internal-private-contract-variable)] | Unused `internal`/`private` contract variable | 3 | 
| [[NC&#x2011;74](#nc74-unused-struct-definition)] | Unused `struct` definition | 1 | 
| [[NC&#x2011;75](#nc75-missing-upgradability-functionality)] | Missing upgradability functionality | 42 | 
| [[NC&#x2011;76](#nc76-cast-to-bytes-or-bytes32-for-clearer-semantic-meaning)] | Cast to `bytes` or `bytes32` for clearer semantic meaning | 2 | 
| [[NC&#x2011;77](#nc77-use-bytes-concat-on-bytes-instead-of-abi-encodepacked-for-clearer-semantic-meaning)] | Use `bytes.concat()` on bytes instead of `abi.encodePacked()` for clearer semantic meaning | 9 | 
| [[NC&#x2011;78](#nc78-constants-should-be-defined-rather-than-using-magic-numbers)] | Constants should be defined rather than using magic numbers | 172 | 
| [[NC&#x2011;79](#nc79-use-the-latest-solidity-prior-to-0-8-20-if-on-l2s-for-deployment)] | Use the latest solidity (prior to 0.8.20 if on L2s) for deployment | 1 | 
| [[NC&#x2011;80](#nc80-use-openzeppelin-s-reentrancyguard-reentrancyguardupgradeable-rather-than-writing-your-own)] | Use OpenZeppelin's `ReentrancyGuard` / `ReentrancyGuardUpgradeable` rather than writing your own | 1 | 
| [[NC&#x2011;81](#nc81-use-a-single-file-for-system-wide-constants)] | Use a single file for system wide constants | 19 | 
| [[NC&#x2011;82](#nc82-consider-using-smtchecker)] | Consider using SMTChecker | 104 | 
| [[NC&#x2011;83](#nc83-variable-name-must-be-in-mixedcase)] | Variable name must be in mixedCase | 11 | 
| [[NC&#x2011;84](#nc84-whitespace-in-expressions)] | Whitespace in Expressions | 6 | 
| [[NC&#x2011;85](#nc85-complex-function-controle-flow)] | Complex function controle flow | 1 | 
| [[NC&#x2011;86](#nc86-consider-bounding-input-array-length)] | Consider bounding input array length | 10 | 
| [[NC&#x2011;87](#nc87-a-function-which-defines-named-returns-in-it-s-declaration-doesn-t-need-to-use-return)] | A function which defines named returns in it's declaration doesn't need to use return | 4 | 
| [[NC&#x2011;88](#nc88-natspec-natspec-dev-is-missing-from-contract)] | [NatSpec] Natspec `@dev` is missing from `contract` | 705 | 
| [[NC&#x2011;89](#nc89-add-inline-comments-for-unnamed-variables)] | Add inline comments for unnamed variables | 6 | 
| [[NC&#x2011;90](#nc90-contract-should-expose-an-interface)] | Contract should expose an `interface` | 28 | 
| [[NC&#x2011;91](#nc91-named-imports-of-parent-contracts-are-missing)] | Named imports of parent contracts are missing | 5 | 
| [[NC&#x2011;92](#nc92-natspec-natspec-notice-is-missing-from-contract)] | [NatSpec] Natspec `@notice` is missing from `contract` | 578 | 
| [[NC&#x2011;93](#nc93-do-not-use-underscore-in-struct-elements-names)] | Do not use UNDERSCORE in `struct` elements names | 1 | 
| [[NC&#x2011;94](#nc94-events-should-use-parameters-to-convey-information)] | Events should use parameters to convey information | 2 | 
| [[NC&#x2011;95](#nc95-expressions-for-constant-values-should-use-immutable-rather-than-constant)] | Expressions for constant values should use `immutable` rather than `constant` | 9 | 
| [[NC&#x2011;96](#nc96-contract-uses-both-require-revert-as-well-as-custom-errors)] | Contract uses both `require()`/`revert()` as well as custom errors | 2 | 
| [[NC&#x2011;97](#nc97-immutable-variable-names-don-t-follow-the-solidity-style-guide)] | `immutable` variable names don\'t follow the Solidity style guide | 5 | 
| [[NC&#x2011;98](#nc98-private-public-function-name-should-start-with-underscore)] | `private`/`public` function name should start with underscore | 109 | 
| [[NC&#x2011;99](#nc99-pure-function-accesses-storage)] | `pure` function accesses storage | 1 | 
| [[NC&#x2011;100](#nc100-assembly-block-creates-dirty-bits)] | Assembly block creates dirty bits | 5 | 
| [[NC&#x2011;101](#nc101-add-inline-comments-for-unnamed-parameters)] | Add inline comments for unnamed parameters | 51 | 
| [[NC&#x2011;102](#nc102-function-state-mutability-can-be-restricted-to-pure)] | Function state mutability can be restricted to pure | 1 | 
| [[NC&#x2011;103](#nc103-use-the-latest-solidity-version-for-better-security)] | Use the latest Solidity version for better security | 104 | 
| [[NC&#x2011;104](#nc104-consider-adding-formal-verification-proofs)] | Consider adding formal verification proofs | 3 | 
| [[NC&#x2011;105](#nc105-missing-zero-address-check-in-functions-with-address-parameters)] | Missing zero address check in functions with address parameters | 17 | 
| [[NC&#x2011;106](#nc106-use-a-struct-to-encapsulate-multiple-function-parameters)] | Use a struct to encapsulate multiple function parameters | 55 | 
| [[NC&#x2011;107](#nc107-do-not-cache-constants)] | Do not cache `constants` | 1 | 
| [[NC&#x2011;108](#nc108-function-state-mutability-can-be-restricted-to-view)] | Function state mutability can be restricted to `view` | 1 | 
| [[NC&#x2011;109](#nc109-do-not-cache-immutable)] | Do not cache `immutable` | 1 | 
| [[NC&#x2011;110](#nc110-use-custom-errors-rather-than-revert-require-strings-for-better-readability)] | Use custom errors rather than `revert()`/`require()` strings for better readability | 324 | 
| [[NC&#x2011;111](#nc111-use-inheritdoc-for-overridden-functions)] | Use `@inheritdoc` for overridden functions | 54 | 
| [[NC&#x2011;112](#nc112-multiple-mappings-with-same-keys-can-be-combined-into-a-single-struct-mapping-for-readability)] | Multiple mappings with same keys can be combined into a single struct mapping for readability | 6 | 
| [[NC&#x2011;113](#nc113-constructor-should-emit-an-event)] | constructor should emit an event | 9 | 
| [[NC&#x2011;114](#nc114-complex-functions-should-include-comments)] | Complex functions should include comments | 9 | 
| [[NC&#x2011;115](#nc115-make-use-of-solidiy-s-using-keyword)] | Make use of Solidiy's `using` keyword | 186 | 
| [[NC&#x2011;116](#nc116-avoid-using-underscore-at-the-end-of-a-variable-name)] | Avoid using underscore at the end of a variable name | 1 | 
| [[NC&#x2011;117](#nc117-solidity-all-verbatim-blocks-are-considered-identical-by-deduplicator-and-can-incorrectly-be-unified)] | [Solidity]: All `verbatim` blocks are considered identical by deduplicator and can incorrectly be unified | 103 | 
| [[NC&#x2011;118](#nc118-natspec-natspec-param-is-missing-from-error)] | [NatSpec] Natspec `@param` is missing from `error` | 414 | 
| [[NC&#x2011;119](#nc119-natspec-natspec-comment-is-missing-from-scope-block)] | [NatSpec] Natspec comment is missing from scope `block` | 31 | 
| [[NC&#x2011;120](#nc120-openzeppelin-libraries-should-be-upgraded-to-a-newer-version)] | OpenZeppelin libraries should be upgraded to a newer version | 21 | 
| [[NC&#x2011;121](#nc121-not-using-the-latest-version-of-prb-math-from-dependencies)] | Not using the latest version of `prb-math` from dependencies | 3 | 
| [[NC&#x2011;122](#nc122-enforcing-lowercase-and-underscores-only-in-the-name-field-of-package-json)] | Enforcing Lowercase and Underscores Only in the `name` Field of package.json | 3 | 
| [[NC&#x2011;123](#nc123-non-constant-immutable-state-variables-are-missing-a-setter-post-deployment)] | Non constant/immutable state variables are missing a setter post deployment | 15 | 
| [[NC&#x2011;124](#nc124-consider-making-private-state-variables-internal-to-increase-flexibility)] | Consider making private state variables internal to increase flexibility | 16 | 
| [[NC&#x2011;125](#nc125-using-low-level-call-for-transfers)] | Using Low-Level Call for Transfers | 1 | 
| [[NC&#x2011;126](#nc126-off-by-one-timestamp-error)] | Off-by-one timestamp error | 4 | 
| [[NC&#x2011;127](#nc127-lack-of-space-near-the-operator)] | Lack of space near the operator | 15 | 
| [[NC&#x2011;128](#nc128-incorrect-withdraw-declaration)] | Incorrect withdraw declaration | 6 | 
| [[NC&#x2011;129](#nc129-avoid-mutating-function-parameters)] | Avoid mutating function parameters | 5 | 
| [[NC&#x2011;130](#nc130-a-event-should-be-emitted-if-a-non-immutable-state-variable-is-set-in-a-constructor)] | A event should be emitted if a non immutable state variable is set in a constructor | 6 | 
| [[NC&#x2011;131](#nc131-contracts-use-both-1-and-and-1)] | Contracts use both += 1 and ++ (-- and -= 1) | 2 | 
| [[NC&#x2011;132](#nc132-solidity-order-of-argument-evaluation-disrupted-in-non-expression-split-code-by-optimizer-sequences-with-fullinliner)] | [Solidity]: Order of Argument Evaluation Disrupted in Non-Expression-Split Code by Optimizer Sequences with FullInliner | 104 | 
| [[NC&#x2011;133](#nc133-not-using-the-named-return-variables-anywhere-in-the-function-is-confusing)] | Not using the named return variables anywhere in the function is confusing | 4 | 
| [[NC&#x2011;134](#nc134-use-named-return-values)] | Use named return values | 145 | 
| [[NC&#x2011;135](#nc135-consider-moving-duplicated-strings-to-constants)] | Consider moving duplicated strings to constants | 27 | 
| [[NC&#x2011;136](#nc136-unused-public-contract-variable)] | Unused `public` contract variable | 3 | 
| [[NC&#x2011;137](#nc137-missing-checks-for-uint-state-variable-assignments)] | Missing checks for uint state variable assignments | 13 | 
| [[NC&#x2011;138](#nc138-consider-adding-validation-of-user-inputs)] | Consider adding validation of user inputs | 162 | 
| [[NC&#x2011;139](#nc139-interfaces-should-use-floating-version-pragmas)] | Interfaces should use floating version pragmas | 43 | 
| [[NC&#x2011;140](#nc140-consider-disallowing-transfers-to-address-this)] | Consider disallowing transfers to `address(this)` | 2 | 
| [[NC&#x2011;141](#nc141-unusual-loop-variable)] | Unusual loop variable | 1 | 
| [[NC&#x2011;142](#nc142-consider-using-named-function-calls)] | Consider using named function calls | 131 | 

Total: 6308 instances over 142 issues

## Low Risk Issues

### [L&#x2011;1] Vulnerable versions of packages are being used 
This project's specific package versions are vulnerable to the specific CVEs listed below. Consider switching to more recent versions of these packages that don't have these vulnerabilities


*There are 2 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: package.json


<details><summary>Vulnerabilities related to `@openzeppelin/contracts`:</summary>


- [CVE-2023-34459](https://github.com/OpenZeppelin/openzeppelin-contracts/security/advisories/GHSA-wprv-93r4-jj2p) :When the verifyMultiProof, verifyMultiProofCalldata, processMultiProof, or processMultiProofCalldata functions are in use, it is possible to construct merkle trees that allow forging a valid multiproof for an arbitrary set of leaves.
A contract may be vulnerable if it uses multiproofs for verification and the merkle tree that is processed includes a node with value 0 at depth 1(just under the root).This could happen inadvertently for balanced trees with 3 leaves or less, if the leaves are not hashed.This could happen deliberately if a malicious tree builder includes such a node in the tree.
A contract is not vulnerable if it uses single- leaf proving(verify, verifyCalldata, processProof, or processProofCalldata), or if it uses multiproofs with a known tree that has hashed leaves.Standard merkle trees produced or validated with the @openzeppelin/merkle-tree library are safe.


- [CVE-2023-34234](https://github.com/OpenZeppelin/openzeppelin-contracts/security/advisories/GHSA-5h3x-9wvq-w4m2) :By frontrunning the creation of a proposal, an attacker can become the proposer and gain the ability to cancel it. The attacker can do this repeatedly to try to prevent a proposal from being proposed at all.
This impacts the Governor contract in v4.9.0 only, and the GovernorCompatibilityBravo contract since v4.3.0.
</details>
1: 


<details><summary>Vulnerabilities related to `@openzeppelin/contracts`:</summary>


- [CVE-2022-35915](https://github.com/OpenZeppelin/openzeppelin-contracts/security/advisories/GHSA-7grf-83vw-6f5x) :This issue concerns instances of Governor that use the module GovernorVotesQuorumFraction, a mechanism that determines quorum requirements as a percentage of the voting token's total supply. In affected instances, when a proposal is passed to lower the quorum requirement, past proposals may become executable if they had been defeated only due to lack of quorum, and the number of votes it received meets the new quorum requirement.

Analysis of instances on chain found only one proposal that met this condition, and we are actively monitoring for new occurrences of this particular issue.
</details>
1: 


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//package.json#L1-L1) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//package.json#L1-L1)


</details>


### [L&#x2011;2] Missing checks for `address(0)` when assigning values to address state variables 



*There are 12 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/SystemContext.sol

100:         origin = _newOrigin;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L100-L100) 


```solidity

File: contracts/bridge/L1ERC20Bridge.sol

56:         sharedBridge = _sharedBridge;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1ERC20Bridge.sol#L56-L56) 


```solidity

File: contracts/bridge/L1SharedBridge.sol

96:         l1WethAddress = _l1WethAddress;

97:         bridgehub = _bridgehub;

98:         legacyBridge = _legacyBridge;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L96-L96) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L97-L97), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L98-L98)


```solidity

File: contracts/bridgehub/Bridgehub.sol

55:         pendingAdmin = _newPendingAdmin;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L55-L55) 


```solidity

File: contracts/governance/Governance.sol

46:         securityCouncil = _securityCouncil;

258:         securityCouncil = _newSecurityCouncil;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/Governance.sol#L46-L46) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/Governance.sol#L258-L258)


```solidity

File: contracts/state-transition/StateTransitionManager.sol

59:         bridgehub = _bridgehub;

114:         pendingAdmin = _newPendingAdmin;

133:         validatorTimelock = _validatorTimelock;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L59-L59) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L114-L114), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L133-L133)


```solidity

File: contracts/state-transition/ValidatorTimelock.sol

74:         stateTransitionManager = _stateTransitionManager;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L74-L74) 


</details>


### [L&#x2011;3] Avoid Using abi.encodePacked() with Dynamic Types in Hash Functions like keccak256() 
Use `abi.encode()` instead which will pad items to 32 bytes, which will [prevent hash collisions](https://docs.soliditylang.org/en/v0.8.13/abi-spec.html#non-standard-packed-mode) (e.g. `abi.encodePacked(0x123,0x456)` => `0x123456` => `abi.encodePacked(0x1,0x23456)`, but `abi.encode(0x123,0x456)` => `0x0...1230...456`). "Unless there is a compelling reason, `abi.encode` should be preferred". If there is only one argument to `abi.encodePacked()` it can often be cast to `bytes()` or `bytes32()` [instead](https://ethereum.stackexchange.com/questions/30912/how-to-compare-strings-in-solidity#answer-82739).
If all arguments are strings and or bytes, `bytes.concat()` should be used instead


*There are 2 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/state-transition/chain-deps/facets/Executor.sol

460:                 keccak256(
461:                     abi.encodePacked(
462:                         _prevBatchCommitment,
463:                         _currentBatchCommitment,
464:                         _verifierParams.recursionNodeLevelVkHash,
465:                         _verifierParams.recursionLeafLevelVkHash
466:                     )
467:                 )

654:             blobCommitments[versionedHashIndex] = keccak256(
655:                 abi.encodePacked(blobVersionedHash, _pubdataCommitments[i:i + PUBDATA_COMMITMENT_COMMITMENT_OFFSET])
656:             );


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L460-L467) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L654-L656)


</details>


### [L&#x2011;4] For loops in public or external functions should be avoided due to high gas costs and possible DOS 
In Solidity, for loops can potentially cause Denial of Service (DoS) attacks if not handled carefully. DoS attacks can occur when an attacker intentionally exploits the gas cost of a function, causing it to run out of gas or making it too expensive for other users to call. Below are some scenarios where for loops can lead to DoS attacks: Nested for loops can become exceptionally gas expensive and should be used sparingly


*There are 18 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/Compressor.sol

44:     function publishCompressedBytecode(
45:         bytes calldata _bytecode,
46:         bytes calldata _rawCompressedData
47:     ) external payable onlyCallFromBootloader returns (bytes32 bytecodeHash) {
48:         unchecked {
49:             (bytes calldata dictionary, bytes calldata encodedData) = _decodeRawBytecode(_rawCompressedData);
50: 
51:             require(
52:                 encodedData.length * 4 == _bytecode.length,
53:                 "Encoded data length should be 4 times shorter than the original bytecode"
54:             );
55: 
56:             require(
57:                 dictionary.length / 8 <= encodedData.length / 2,
58:                 "Dictionary should have at most the same number of entries as the encoded data"
59:             );
60: 
61:             for (uint256 encodedDataPointer = 0; encodedDataPointer < encodedData.length; encodedDataPointer += 2) {

110:     function verifyCompressedStateDiffs(
111:         uint256 _numberOfStateDiffs,
112:         uint256 _enumerationIndexSize,
113:         bytes calldata _stateDiffs,
114:         bytes calldata _compressedStateDiffs
115:     ) external payable onlyCallFrom(address(L1_MESSENGER_CONTRACT)) returns (bytes32 stateDiffHash) {
116:         // We do not enforce the operator to use the optimal, i.e. the minimally possible _enumerationIndexSize.
117:         // We do enforce however, that the _enumerationIndexSize is not larger than 8 bytes long, which is the
118:         // maximal ever possible size for enumeration index.
119:         require(_enumerationIndexSize <= MAX_ENUMERATION_INDEX_SIZE, "enumeration index size is too large");
120: 
121:         uint256 numberOfInitialWrites = uint256(_compressedStateDiffs.readUint16(0));
122: 
123:         uint256 stateDiffPtr = 2;
124:         uint256 numInitialWritesProcessed = 0;
125: 
126:         // Process initial writes
127:         for (uint256 i = 0; i < _numberOfStateDiffs * STATE_DIFF_ENTRY_SIZE; i += STATE_DIFF_ENTRY_SIZE) {

110:     function verifyCompressedStateDiffs(
111:         uint256 _numberOfStateDiffs,
112:         uint256 _enumerationIndexSize,
113:         bytes calldata _stateDiffs,
114:         bytes calldata _compressedStateDiffs
115:     ) external payable onlyCallFrom(address(L1_MESSENGER_CONTRACT)) returns (bytes32 stateDiffHash) {
116:         // We do not enforce the operator to use the optimal, i.e. the minimally possible _enumerationIndexSize.
117:         // We do enforce however, that the _enumerationIndexSize is not larger than 8 bytes long, which is the
118:         // maximal ever possible size for enumeration index.
119:         require(_enumerationIndexSize <= MAX_ENUMERATION_INDEX_SIZE, "enumeration index size is too large");
120: 
121:         uint256 numberOfInitialWrites = uint256(_compressedStateDiffs.readUint16(0));
122: 
123:         uint256 stateDiffPtr = 2;
124:         uint256 numInitialWritesProcessed = 0;
125: 
126:         // Process initial writes
127:         for (uint256 i = 0; i < _numberOfStateDiffs * STATE_DIFF_ENTRY_SIZE; i += STATE_DIFF_ENTRY_SIZE) {
128:             bytes calldata stateDiff = _stateDiffs[i:i + STATE_DIFF_ENTRY_SIZE];
129:             uint64 enumIndex = stateDiff.readUint64(84);
130:             if (enumIndex != 0) {
131:                 // It is a repeated write, so we skip it.
132:                 continue;
133:             }
134: 
135:             numInitialWritesProcessed++;
136: 
137:             bytes32 derivedKey = stateDiff.readBytes32(52);
138:             uint256 initValue = stateDiff.readUint256(92);
139:             uint256 finalValue = stateDiff.readUint256(124);
140:             require(derivedKey == _compressedStateDiffs.readBytes32(stateDiffPtr), "iw: initial key mismatch");
141:             stateDiffPtr += 32;
142: 
143:             uint8 metadata = uint8(bytes1(_compressedStateDiffs[stateDiffPtr]));
144:             stateDiffPtr++;
145:             uint8 operation = metadata & OPERATION_BITMASK;
146:             uint8 len = operation == 0 ? 32 : metadata >> LENGTH_BITS_OFFSET;
147:             _verifyValueCompression(
148:                 initValue,
149:                 finalValue,
150:                 operation,
151:                 _compressedStateDiffs[stateDiffPtr:stateDiffPtr + len]
152:             );
153:             stateDiffPtr += len;
154:         }
155: 
156:         require(numInitialWritesProcessed == numberOfInitialWrites, "Incorrect number of initial storage diffs");
157: 
158:         // Process repeated writes
159:         for (uint256 i = 0; i < _numberOfStateDiffs * STATE_DIFF_ENTRY_SIZE; i += STATE_DIFF_ENTRY_SIZE) {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Compressor.sol#L44-L61) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Compressor.sol#L110-L127), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Compressor.sol#L110-L159)


```solidity

File: contracts/ContractDeployer.sol

238:     function forceDeployOnAddresses(ForceDeployment[] calldata _deployments) external payable {
239:         require(
240:             msg.sender == FORCE_DEPLOYER || msg.sender == address(COMPLEX_UPGRADER_CONTRACT),
241:             "Can only be called by FORCE_DEPLOYER or COMPLEX_UPGRADER_CONTRACT"
242:         );
243: 
244:         uint256 deploymentsLength = _deployments.length;
245:         // We need to ensure that the `value` provided by the call is enough to provide `value`
246:         // for all of the deployments
247:         uint256 sumOfValues = 0;
248:         for (uint256 i = 0; i < deploymentsLength; ++i) {

238:     function forceDeployOnAddresses(ForceDeployment[] calldata _deployments) external payable {
239:         require(
240:             msg.sender == FORCE_DEPLOYER || msg.sender == address(COMPLEX_UPGRADER_CONTRACT),
241:             "Can only be called by FORCE_DEPLOYER or COMPLEX_UPGRADER_CONTRACT"
242:         );
243: 
244:         uint256 deploymentsLength = _deployments.length;
245:         // We need to ensure that the `value` provided by the call is enough to provide `value`
246:         // for all of the deployments
247:         uint256 sumOfValues = 0;
248:         for (uint256 i = 0; i < deploymentsLength; ++i) {
249:             sumOfValues += _deployments[i].value;
250:         }
251:         require(msg.value == sumOfValues, "`value` provided is not equal to the combined `value`s of deployments");
252: 
253:         for (uint256 i = 0; i < deploymentsLength; ++i) {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L238-L248) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L238-L253)


```solidity

File: contracts/ImmutableSimulator.sol

34:     function setImmutables(address _dest, ImmutableData[] calldata _immutables) external override {
35:         require(msg.sender == address(DEPLOYER_SYSTEM_CONTRACT), "Callable only by the deployer system contract");
36:         unchecked {
37:             uint256 immutablesLength = _immutables.length;
38:             for (uint256 i = 0; i < immutablesLength; ++i) {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ImmutableSimulator.sol#L34-L38) 


```solidity

File: contracts/KnownCodesStorage.sol

27:     function markFactoryDeps(bool _shouldSendToL1, bytes32[] calldata _hashes) external onlyCallFromBootloader {
28:         unchecked {
29:             uint256 hashesLen = _hashes.length;
30:             for (uint256 i = 0; i < hashesLen; ++i) {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/KnownCodesStorage.sol#L27-L30) 


```solidity

File: contracts/L1Messenger.sol

194:     function publishPubdataAndClearState(
195:         bytes calldata _totalL2ToL1PubdataAndStateDiffs
196:     ) external onlyCallFromBootloader {
197:         uint256 calldataPtr = 0;
198: 
199:         /// Check logs
200:         uint32 numberOfL2ToL1Logs = uint32(bytes4(_totalL2ToL1PubdataAndStateDiffs[calldataPtr:calldataPtr + 4]));
201:         require(numberOfL2ToL1Logs <= L2_TO_L1_LOGS_MERKLE_TREE_LEAVES, "Too many L2->L1 logs");
202:         calldataPtr += 4;
203: 
204:         bytes32[] memory l2ToL1LogsTreeArray = new bytes32[](L2_TO_L1_LOGS_MERKLE_TREE_LEAVES);
205:         bytes32 reconstructedChainedLogsHash;
206:         for (uint256 i = 0; i < numberOfL2ToL1Logs; ++i) {

194:     function publishPubdataAndClearState(
195:         bytes calldata _totalL2ToL1PubdataAndStateDiffs
196:     ) external onlyCallFromBootloader {
197:         uint256 calldataPtr = 0;
198: 
199:         /// Check logs
200:         uint32 numberOfL2ToL1Logs = uint32(bytes4(_totalL2ToL1PubdataAndStateDiffs[calldataPtr:calldataPtr + 4]));
201:         require(numberOfL2ToL1Logs <= L2_TO_L1_LOGS_MERKLE_TREE_LEAVES, "Too many L2->L1 logs");
202:         calldataPtr += 4;
203: 
204:         bytes32[] memory l2ToL1LogsTreeArray = new bytes32[](L2_TO_L1_LOGS_MERKLE_TREE_LEAVES);
205:         bytes32 reconstructedChainedLogsHash;
206:         for (uint256 i = 0; i < numberOfL2ToL1Logs; ++i) {
207:             bytes32 hashedLog = EfficientCall.keccak(
208:                 _totalL2ToL1PubdataAndStateDiffs[calldataPtr:calldataPtr + L2_TO_L1_LOG_SERIALIZE_SIZE]
209:             );
210:             calldataPtr += L2_TO_L1_LOG_SERIALIZE_SIZE;
211:             l2ToL1LogsTreeArray[i] = hashedLog;
212:             reconstructedChainedLogsHash = keccak256(abi.encode(reconstructedChainedLogsHash, hashedLog));
213:         }
214:         require(
215:             reconstructedChainedLogsHash == chainedLogsHash,
216:             "reconstructedChainedLogsHash is not equal to chainedLogsHash"
217:         );
218:         for (uint256 i = numberOfL2ToL1Logs; i < L2_TO_L1_LOGS_MERKLE_TREE_LEAVES; ++i) {

194:     function publishPubdataAndClearState(
195:         bytes calldata _totalL2ToL1PubdataAndStateDiffs
196:     ) external onlyCallFromBootloader {
197:         uint256 calldataPtr = 0;
198: 
199:         /// Check logs
200:         uint32 numberOfL2ToL1Logs = uint32(bytes4(_totalL2ToL1PubdataAndStateDiffs[calldataPtr:calldataPtr + 4]));
201:         require(numberOfL2ToL1Logs <= L2_TO_L1_LOGS_MERKLE_TREE_LEAVES, "Too many L2->L1 logs");
202:         calldataPtr += 4;
203: 
204:         bytes32[] memory l2ToL1LogsTreeArray = new bytes32[](L2_TO_L1_LOGS_MERKLE_TREE_LEAVES);
205:         bytes32 reconstructedChainedLogsHash;
206:         for (uint256 i = 0; i < numberOfL2ToL1Logs; ++i) {
207:             bytes32 hashedLog = EfficientCall.keccak(
208:                 _totalL2ToL1PubdataAndStateDiffs[calldataPtr:calldataPtr + L2_TO_L1_LOG_SERIALIZE_SIZE]
209:             );
210:             calldataPtr += L2_TO_L1_LOG_SERIALIZE_SIZE;
211:             l2ToL1LogsTreeArray[i] = hashedLog;
212:             reconstructedChainedLogsHash = keccak256(abi.encode(reconstructedChainedLogsHash, hashedLog));
213:         }
214:         require(
215:             reconstructedChainedLogsHash == chainedLogsHash,
216:             "reconstructedChainedLogsHash is not equal to chainedLogsHash"
217:         );
218:         for (uint256 i = numberOfL2ToL1Logs; i < L2_TO_L1_LOGS_MERKLE_TREE_LEAVES; ++i) {
219:             l2ToL1LogsTreeArray[i] = L2_L1_LOGS_TREE_DEFAULT_LEAF_HASH;
220:         }
221:         uint256 nodesOnCurrentLevel = L2_TO_L1_LOGS_MERKLE_TREE_LEAVES;
222:         while (nodesOnCurrentLevel > 1) {
223:             nodesOnCurrentLevel /= 2;
224:             for (uint256 i = 0; i < nodesOnCurrentLevel; ++i) {
225:                 l2ToL1LogsTreeArray[i] = keccak256(
226:                     abi.encode(l2ToL1LogsTreeArray[2 * i], l2ToL1LogsTreeArray[2 * i + 1])
227:                 );
228:             }
229:         }
230:         bytes32 l2ToL1LogsTreeRoot = l2ToL1LogsTreeArray[0];
231: 
232:         /// Check messages
233:         uint32 numberOfMessages = uint32(bytes4(_totalL2ToL1PubdataAndStateDiffs[calldataPtr:calldataPtr + 4]));
234:         calldataPtr += 4;
235:         bytes32 reconstructedChainedMessagesHash;
236:         for (uint256 i = 0; i < numberOfMessages; ++i) {

194:     function publishPubdataAndClearState(
195:         bytes calldata _totalL2ToL1PubdataAndStateDiffs
196:     ) external onlyCallFromBootloader {
197:         uint256 calldataPtr = 0;
198: 
199:         /// Check logs
200:         uint32 numberOfL2ToL1Logs = uint32(bytes4(_totalL2ToL1PubdataAndStateDiffs[calldataPtr:calldataPtr + 4]));
201:         require(numberOfL2ToL1Logs <= L2_TO_L1_LOGS_MERKLE_TREE_LEAVES, "Too many L2->L1 logs");
202:         calldataPtr += 4;
203: 
204:         bytes32[] memory l2ToL1LogsTreeArray = new bytes32[](L2_TO_L1_LOGS_MERKLE_TREE_LEAVES);
205:         bytes32 reconstructedChainedLogsHash;
206:         for (uint256 i = 0; i < numberOfL2ToL1Logs; ++i) {
207:             bytes32 hashedLog = EfficientCall.keccak(
208:                 _totalL2ToL1PubdataAndStateDiffs[calldataPtr:calldataPtr + L2_TO_L1_LOG_SERIALIZE_SIZE]
209:             );
210:             calldataPtr += L2_TO_L1_LOG_SERIALIZE_SIZE;
211:             l2ToL1LogsTreeArray[i] = hashedLog;
212:             reconstructedChainedLogsHash = keccak256(abi.encode(reconstructedChainedLogsHash, hashedLog));
213:         }
214:         require(
215:             reconstructedChainedLogsHash == chainedLogsHash,
216:             "reconstructedChainedLogsHash is not equal to chainedLogsHash"
217:         );
218:         for (uint256 i = numberOfL2ToL1Logs; i < L2_TO_L1_LOGS_MERKLE_TREE_LEAVES; ++i) {
219:             l2ToL1LogsTreeArray[i] = L2_L1_LOGS_TREE_DEFAULT_LEAF_HASH;
220:         }
221:         uint256 nodesOnCurrentLevel = L2_TO_L1_LOGS_MERKLE_TREE_LEAVES;
222:         while (nodesOnCurrentLevel > 1) {
223:             nodesOnCurrentLevel /= 2;
224:             for (uint256 i = 0; i < nodesOnCurrentLevel; ++i) {
225:                 l2ToL1LogsTreeArray[i] = keccak256(
226:                     abi.encode(l2ToL1LogsTreeArray[2 * i], l2ToL1LogsTreeArray[2 * i + 1])
227:                 );
228:             }
229:         }
230:         bytes32 l2ToL1LogsTreeRoot = l2ToL1LogsTreeArray[0];
231: 
232:         /// Check messages
233:         uint32 numberOfMessages = uint32(bytes4(_totalL2ToL1PubdataAndStateDiffs[calldataPtr:calldataPtr + 4]));
234:         calldataPtr += 4;
235:         bytes32 reconstructedChainedMessagesHash;
236:         for (uint256 i = 0; i < numberOfMessages; ++i) {
237:             uint32 currentMessageLength = uint32(bytes4(_totalL2ToL1PubdataAndStateDiffs[calldataPtr:calldataPtr + 4]));
238:             calldataPtr += 4;
239:             bytes32 hashedMessage = EfficientCall.keccak(
240:                 _totalL2ToL1PubdataAndStateDiffs[calldataPtr:calldataPtr + currentMessageLength]
241:             );
242:             calldataPtr += currentMessageLength;
243:             reconstructedChainedMessagesHash = keccak256(abi.encode(reconstructedChainedMessagesHash, hashedMessage));
244:         }
245:         require(
246:             reconstructedChainedMessagesHash == chainedMessagesHash,
247:             "reconstructedChainedMessagesHash is not equal to chainedMessagesHash"
248:         );
249: 
250:         /// Check bytecodes
251:         uint32 numberOfBytecodes = uint32(bytes4(_totalL2ToL1PubdataAndStateDiffs[calldataPtr:calldataPtr + 4]));
252:         calldataPtr += 4;
253:         bytes32 reconstructedChainedL1BytecodesRevealDataHash;
254:         for (uint256 i = 0; i < numberOfBytecodes; ++i) {

194:     function publishPubdataAndClearState(
195:         bytes calldata _totalL2ToL1PubdataAndStateDiffs
196:     ) external onlyCallFromBootloader {
197:         uint256 calldataPtr = 0;
198: 
199:         /// Check logs
200:         uint32 numberOfL2ToL1Logs = uint32(bytes4(_totalL2ToL1PubdataAndStateDiffs[calldataPtr:calldataPtr + 4]));
201:         require(numberOfL2ToL1Logs <= L2_TO_L1_LOGS_MERKLE_TREE_LEAVES, "Too many L2->L1 logs");
202:         calldataPtr += 4;
203: 
204:         bytes32[] memory l2ToL1LogsTreeArray = new bytes32[](L2_TO_L1_LOGS_MERKLE_TREE_LEAVES);
205:         bytes32 reconstructedChainedLogsHash;
206:         for (uint256 i = 0; i < numberOfL2ToL1Logs; ++i) {
207:             bytes32 hashedLog = EfficientCall.keccak(
208:                 _totalL2ToL1PubdataAndStateDiffs[calldataPtr:calldataPtr + L2_TO_L1_LOG_SERIALIZE_SIZE]
209:             );
210:             calldataPtr += L2_TO_L1_LOG_SERIALIZE_SIZE;
211:             l2ToL1LogsTreeArray[i] = hashedLog;
212:             reconstructedChainedLogsHash = keccak256(abi.encode(reconstructedChainedLogsHash, hashedLog));
213:         }
214:         require(
215:             reconstructedChainedLogsHash == chainedLogsHash,
216:             "reconstructedChainedLogsHash is not equal to chainedLogsHash"
217:         );
218:         for (uint256 i = numberOfL2ToL1Logs; i < L2_TO_L1_LOGS_MERKLE_TREE_LEAVES; ++i) {
219:             l2ToL1LogsTreeArray[i] = L2_L1_LOGS_TREE_DEFAULT_LEAF_HASH;
220:         }
221:         uint256 nodesOnCurrentLevel = L2_TO_L1_LOGS_MERKLE_TREE_LEAVES;
222:         while (nodesOnCurrentLevel > 1) {
223:             nodesOnCurrentLevel /= 2;
224:             for (uint256 i = 0; i < nodesOnCurrentLevel; ++i) {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L194-L206) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L194-L218), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L194-L236), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L194-L254), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L194-L224)


```solidity

File: contracts/PubdataChunkPublisher.sol

21:     function chunkAndPublishPubdata(bytes calldata _pubdata) external onlyCallFrom(address(L1_MESSENGER_CONTRACT)) {
22:         require(_pubdata.length <= BLOB_SIZE_BYTES * MAX_NUMBER_OF_BLOBS, "pubdata should fit in 2 blobs");
23: 
24:         bytes32[] memory blobHashes = new bytes32[](MAX_NUMBER_OF_BLOBS);
25: 
26:         // We allocate to the full size of MAX_NUMBER_OF_BLOBS * BLOB_SIZE_BYTES because we need to pad
27:         // the data on the right with 0s if it doesn't take up the full blob
28:         bytes memory totalBlobs = new bytes(BLOB_SIZE_BYTES * MAX_NUMBER_OF_BLOBS);
29: 
30:         assembly {
31:             // The pointer to the allocated memory above. We skip 32 bytes to avoid overwriting the length.
32:             let ptr := add(totalBlobs, 0x20)
33:             calldatacopy(ptr, _pubdata.offset, _pubdata.length)
34:         }
35: 
36:         for (uint256 i = 0; i < MAX_NUMBER_OF_BLOBS; i++) {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/PubdataChunkPublisher.sol#L21-L36) 


```solidity

File: contracts/state-transition/ValidatorTimelock.sol

108:     function commitBatches(
109:         StoredBatchInfo calldata,
110:         CommitBatchInfo[] calldata _newBatchesData
111:     ) external onlyValidator(ERA_CHAIN_ID) {
112:         unchecked {
113:             // This contract is only a temporary solution, that hopefully will be disabled until 2106 year, so...
114:             // It is safe to cast.
115:             uint32 timestamp = uint32(block.timestamp);
116:             for (uint256 i = 0; i < _newBatchesData.length; ++i) {

126:     function commitBatchesSharedBridge(
127:         uint256 _chainId,
128:         StoredBatchInfo calldata,
129:         CommitBatchInfo[] calldata _newBatchesData
130:     ) external onlyValidator(_chainId) {
131:         unchecked {
132:             // This contract is only a temporary solution, that hopefully will be disabled until 2106 year, so...
133:             // It is safe to cast.
134:             uint32 timestamp = uint32(block.timestamp);
135:             for (uint256 i = 0; i < _newBatchesData.length; ++i) {

182:     function executeBatches(StoredBatchInfo[] calldata _newBatchesData) external onlyValidator(ERA_CHAIN_ID) {
183:         uint256 delay = executionDelay; // uint32
184:         unchecked {
185:             for (uint256 i = 0; i < _newBatchesData.length; ++i) {

203:     function executeBatchesSharedBridge(
204:         uint256 _chainId,
205:         StoredBatchInfo[] calldata _newBatchesData
206:     ) external onlyValidator(_chainId) {
207:         uint256 delay = executionDelay; // uint32
208:         unchecked {
209:             for (uint256 i = 0; i < _newBatchesData.length; ++i) {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L108-L116) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L126-L135), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L182-L185), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L203-L209)


```solidity

File: contracts/state-transition/chain-deps/facets/Getters.sol

202:     function facets() external view returns (Facet[] memory result) {
203:         Diamond.DiamondStorage storage ds = Diamond.getDiamondStorage();
204: 
205:         uint256 facetsLen = ds.facets.length;
206:         result = new Facet[](facetsLen);
207: 
208:         for (uint256 i = 0; i < facetsLen; i = i.uncheckedInc()) {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L202-L208) 


</details>


### [L&#x2011;5] External call `recipient` may consume all transaction gas (gas griefing) 
There is no limit specified on the amount of gas used, so the recipient can use up all of the transaction's gas, causing it to revert. Use `addr.call{ gas: <amount>}("")` or [this](https://github.com/nomad-xyz/ExcessivelySafeCall) library instead.


*There are 2 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/MsgValueSimulator.sol

63:             (bool success, ) = address(REAL_BASE_TOKEN_SYSTEM_CONTRACT).call(


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/MsgValueSimulator.sol#L63-L63) 


```solidity

File: contracts/governance/Governance.sol

226:             (bool success, bytes memory returnData) = _calls[i].target.call{value: _calls[i].value}(_calls[i].data);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/Governance.sol#L226-L226) 


</details>


### [L&#x2011;6] Missing checks in constructor 
There are some missing checks in these functions, and this could lead to unexpected scenarios. Consider always adding a sanity check for state variables.


*There are 1 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/state-transition/ValidatorTimelock.sol

//@audit _executionDelay,  are not checked
55:     constructor(address _initialOwner, uint32 _executionDelay) {
56:         _transferOwnership(_initialOwner);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L55-L56) 


</details>


### [L&#x2011;7] Signature Malleability of EVM's ecrecover 
The function calls the Solidity ecrecover() function directly to verify the given signatures. However, the ecrecover() EVM opcode allows malleable (non-unique) signatures and thus is susceptible to replay attacks. Consider using the OpenZeppelin ECDSA library instead, which provides a safe ecrecover() wrapper that guarantees unique signatures.


*There are 1 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/DefaultAccount.sol

186:         address recoveredAddress = ecrecover(_hash, v, r, s);


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/DefaultAccount.sol#L186-L186) 


</details>


### [L&#x2011;8] Division before multiplication can lead to precision errors 
Because Solidity integer division may truncate, it is often preferable to do multiplication before division to prevent precision loss.


*There are 2 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/L1Messenger.sol

51:         return KECCAK_ROUND_GAS_COST * (_length / KECCAK_ROUND_NUMBER_OF_BYTES + 1);

62:         return SHA256_ROUND_GAS_COST * ((_length + 8) / SHA256_ROUND_NUMBER_OF_BYTES + 1);


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L51-L51) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L62-L62)


</details>


### [L&#x2011;9] Double type casts create complexity within the code 
Double type casting should be avoided in Solidity contracts to prevent unintended consequences and ensure accurate data representation. Performing multiple type casts in succession can lead to unexpected truncation, rounding errors, or loss of precision, potentially compromising the contract's functionality and reliability. Furthermore, double type casting can make the code less readable and harder to maintain, increasing the likelihood of errors and misunderstandings during development and debugging. To ensure precise and consistent data handling, developers should use appropriate data types and avoid unnecessary or excessive type casting, promoting a more robust and dependable contract execution. 


*There are 9 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/BootloaderUtilities.sol

91:             uint256 vInt = uint256(uint8(_transaction.signature[64]));

190:             uint256 vInt = uint256(uint8(_transaction.signature[64]));

285:             uint256 vInt = uint256(uint8(_transaction.signature[64]));


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L91-L91) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L190-L190), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L285-L285)


```solidity

File: contracts/L1Messenger.sol

280:             uint256(uint8(bytes1(_totalL2ToL1PubdataAndStateDiffs[calldataPtr]))) ==


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L280-L280) 


```solidity

File: contracts/libraries/Utils.sol

46:             codeLengthInWords = uint256(uint8(_bytecodeHash[2])) * 256 + uint256(uint8(_bytecodeHash[3]));

46:             codeLengthInWords = uint256(uint8(_bytecodeHash[2])) * 256 + uint256(uint8(_bytecodeHash[3]));


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L46-L46) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L46-L46)


```solidity

File: contracts/common/libraries/L2ContractHelper.sol

50:         codeLengthInWords = uint256(uint8(_bytecodeHash[2])) * 256 + uint256(uint8(_bytecodeHash[3]));

50:         codeLengthInWords = uint256(uint8(_bytecodeHash[2])) * 256 + uint256(uint8(_bytecodeHash[3]));


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/L2ContractHelper.sol#L50-L50) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/L2ContractHelper.sol#L50-L50)


```solidity

File: contracts/state-transition/chain-deps/facets/Executor.sol

644:                 uint256(uint128(bytes16(_pubdataCommitments[i:i + PUBDATA_COMMITMENT_CLAIMED_VALUE_OFFSET])))


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L644-L644) 


</details>


### [L&#x2011;10] Draft imports may break in new minor versions 
While OpenZeppelin draft contracts are safe to use and have been audited, their 'draft' status means that the EIPs they're based on are not finalized, and thus there may be breaking changes in even [minor releases](https://docs.openzeppelin.com/contracts/3.x/api/drafts). If a bug is found in this version of OpenZeppelin, and the version that you're forced to upgrade to has breaking changes in the new version, you'll encounter unnecessary delays in porting and testing replacement contracts. Ensure that you have extensive test coverage of this area so that differences can be automatically detected, and have a plan in place for how you would fully test a new version of these contracts if they do indeed change unexpectedly. Consider creating a forked version of the file rather than importing it from the package, and manually patch your fork as changes are made.


*There are 1 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/bridge/L2StandardERC20.sol

5: import {ERC20PermitUpgradeable} from "@openzeppelin/contracts-upgradeable/token/ERC20/extensions/draft-ERC20PermitUpgradeable.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2StandardERC20.sol#L5-L5) 


</details>


### [L&#x2011;11] Initialization can be front-run 
The `initialize()` functions are not protected by a modifier, which allow attackers to call this function once the contract is deployed through the proxy. Consider adding modifiers to protect this function or create a contract that both deploy the project and initialize it on the same transaction.


*There are 6 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/bridge/L1ERC20Bridge.sol

60:     function initialize() external reentrancyGuardInitializer {}


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1ERC20Bridge.sol#L60-L60) 


```solidity

File: contracts/bridge/L1SharedBridge.sol

104:     function initialize(


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L104-L104) 


```solidity

File: contracts/bridgehub/Bridgehub.sol

41:     function initialize(address _owner) external reentrancyGuardInitializer {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L41-L41) 


```solidity

File: contracts/state-transition/StateTransitionManager.sol

79:     function initialize(


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L79-L79) 


```solidity

File: contracts/state-transition/libraries/Diamond.sol

278:     function _initializeDiamondCut(address _init, bytes memory _calldata) private {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L278-L278) 


```solidity

File: contracts/bridge/L2SharedBridge.sol

49:     function initialize(


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L49-L49) 


</details>


### [L&#x2011;12] `internal` Function calls within for loops 
Making function calls or external calls within loops in Solidity can lead to inefficient gas usage, potential bottlenecks, and increased vulnerability to attacks. Each function call or external call consumes gas, and when executed within a loop, the gas cost multiplies, potentially causing the transaction to run out of gas or exceed block gas limits. This can result in transaction failure or unpredictable behavior.


*There are 25 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/Compressor.sol

147:             _verifyValueCompression(

168:             uint256 compressedEnumIndex = _sliceToUint256(

178:             _verifyValueCompression(


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Compressor.sol#L147-L147) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Compressor.sol#L168-L168), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Compressor.sol#L178-L178)


```solidity

File: contracts/KnownCodesStorage.sol

31:                 _markBytecodeAsPublished(_hashes[i], _shouldSendToL1);


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/KnownCodesStorage.sol#L31-L31) 


```solidity

File: contracts/state-transition/chain-deps/facets/Executor.sol

149:             require(!_checkBit(processedLogs, uint8(logKey)), "kp");

150:             processedLogs = _setBit(processedLogs, uint8(logKey));

258:             _lastCommittedBatchData = _commitOneBatch(_lastCommittedBatchData, _newBatchesData[i], bytes32(0));

260:             s.storedBatchHashes[_lastCommittedBatchData.batchNumber] = _hashStoredBatchInfo(_lastCommittedBatchData);

292:             _lastCommittedBatchData = _commitOneBatch(

298:             s.storedBatchHashes[_lastCommittedBatchData.batchNumber] = _hashStoredBatchInfo(_lastCommittedBatchData);

352:             _executeOneBatch(_batchesData[i], i);

408:                 _hashStoredBatchInfo(_committedBatches[i]) == s.storedBatchHashes[currentTotalBatchesVerified],

413:             proofPublicInput[i] = _getBatchProofPublicInput(

637:             bytes32 blobVersionedHash = _getBlobVersionedHash(versionedHashIndex);

647:             _pointEvaluationPrecompile(


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L149-L149) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L150-L150), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L258-L258), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L260-L260), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L292-L292), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L298-L298), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L352-L352), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L408-L408), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L413-L413), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L637-L637), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L647-L647)


```solidity

File: contracts/state-transition/libraries/Diamond.sol

110:                 _addFunctions(facet, selectors, isFacetFreezable);

112:                 _replaceFunctions(facet, selectors, isFacetFreezable);

114:                 _removeFunctions(facet, selectors);

143:             _addOneFunction(_facet, selector, _isFacetFreezable);

163:             _removeOneFunction(oldFacet.facetAddress, selector);

165:             _saveFacetIfNew(_facet);

166:             _addOneFunction(_facet, selector, _isFacetFreezable);

183:             _removeOneFunction(oldFacet.facetAddress, selector);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L110-L110) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L112-L112), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L114-L114), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L143-L143), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L163-L163), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L165-L165), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L166-L166), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L183-L183)


```solidity

File: contracts/state-transition/libraries/Merkle.sol

31:                 ? _efficientHash(currentHash, _path[i])

32:                 : _efficientHash(_path[i], currentHash);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Merkle.sol#L31-L31) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Merkle.sol#L32-L32)


</details>


### [L&#x2011;13] Loss of precision 
Division by large numbers may result in the result being zero, due to solidity not supporting fractions. Consider requiring a minimum amount for the numerator to ensure that it is always larger than the denominator


*There are 3 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/state-transition/chain-deps/facets/Mailbox.sol

159:         uint256 l1GasPriceConverted = (_l1GasPrice * s.baseTokenGasPriceMultiplierNominator) /

168:             batchOverheadBaseToken /

171:         uint256 l2GasPrice = feeParams.minimalL2GasPrice + batchOverheadBaseToken / uint256(feeParams.maxL2GasPerBatch);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L159-L159) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L168-L168), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L171-L171)


</details>


### [L&#x2011;14] Missing contract-existence checks before low-level calls 
Low-level calls return success if there is no code present at the specified address. In addition to the zero-address checks, add a check to verify that `<address>.code.length > 0`


*There are 4 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/bridge/L1SharedBridge.sol

264:         (, bytes memory data3) = _token.staticcall(abi.encodeCall(IERC20Metadata.decimals, ()));
265:         return abi.encode(data1, data2, data3);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L264-L265) 


```solidity

File: contracts/governance/Governance.sol

226:             (bool success, bytes memory returnData) = _calls[i].target.call{value: _calls[i].value}(_calls[i].data);
227:             if (!success) {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/Governance.sol#L226-L227) 


```solidity

File: contracts/state-transition/chain-deps/facets/Executor.sol

680:         (bool success, bytes memory data) = s.blobVersionedHashRetriever.staticcall(abi.encode(_index));
681:         require(success, "vc");


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L680-L681) 


```solidity

File: contracts/state-transition/libraries/Diamond.sol

283:             (bool success, bytes memory data) = _init.delegatecall(_calldata);
284:             if (!success) {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L283-L284) 


</details>


### [L&#x2011;15] `require()` should be used instead of `assert()` 
Prior to solidity version 0.8.0, hitting an assert consumes the ** remainder of the transaction's available gas** rather than returning it, as `require()` / `revert()` do. `assert()` should be avoided even past solidity version 0.8.0 as its[documentation](https://docs.soliditylang.org/en/v0.8.14/control-structures.html#panic-via-assert-and-error-via-require) states that "The assert function creates an error of type Panic(uint256). ... Properly functioning code should never create a Panic, not even on invalid external input. If this happens, then there is a bug in your contract which you should fix".


*There are 5 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/DefaultAccount.sol

222:         assert(msg.sender != BOOTLOADER_FORMAL_ADDRESS);


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/DefaultAccount.sol#L222-L222) 


```solidity

File: contracts/libraries/RLPEncoder.sol

50:         assert(_len != 1);


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/RLPEncoder.sol#L50-L50) 


```solidity

File: contracts/state-transition/StateTransitionManager.sol

106:         assert(L2_TO_L1_LOG_SERIALIZE_SIZE != 2 * 32);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L106-L106) 


```solidity

File: contracts/state-transition/chain-deps/DiamondInit.sol

51:         assert(L2_TO_L1_LOG_SERIALIZE_SIZE != 2 * 32);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/DiamondInit.sol#L51-L51) 


```solidity

File: contracts/state-transition/chain-deps/facets/Executor.sol

426:         assert(block.chainid != 1);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L426-L426) 


</details>


### [L&#x2011;16] Consider using OpenZeppelinâ€™s SafeCast library to prevent unexpected overflows when casting from various type int/uint values 



*There are 48 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/AccountCodeStorage.sol

//@audit `_input` is getting converted from `uint256` to `uint160`
92:         address account = address(uint160(_input));

//@audit `_input` is getting converted from `uint256` to `uint160`
120:         address account = address(uint160(_input));


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/AccountCodeStorage.sol#L92-L92) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/AccountCodeStorage.sol#L120-L120)


```solidity

File: contracts/BootloaderUtilities.sol

//@audit `listLength` is getting converted from `uint256` to `uint64`
116:             encodedListLength = RLPEncoder.encodeListLen(uint64(listLength));

//@audit `listLength` is getting converted from `uint256` to `uint64`
207:             encodedListLength = RLPEncoder.encodeListLen(uint64(listLength));

//@audit `listLength` is getting converted from `uint256` to `uint64`
302:             encodedListLength = RLPEncoder.encodeListLen(uint64(listLength));


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L116-L116) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L207-L207), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L302-L302)


```solidity

File: contracts/ContractDeployer.sol

//@audit `MAX_SYSTEM_CONTRACT_ADDRESS` is getting converted from `uint160` to `address`
48:             _address > address(MAX_SYSTEM_CONTRACT_ADDRESS) &&

//@audit `value` is getting converted from `uint256` to `uint128`
341:                 SystemContractHelper.setValueForNextFarCall(uint128(value));


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L48-L48) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L341-L341)


```solidity

File: contracts/L1Messenger.sol

//@audit `pubdataLen` is getting converted from `uint256` to `uint32`
154:         SystemContractHelper.burnGas(Utils.safeCastToU32(gasToPay), uint32(pubdataLen));

//@audit `pubdataLen` is getting converted from `uint256` to `uint32`
179:         SystemContractHelper.burnGas(Utils.safeCastToU32(gasToPay), uint32(pubdataLen));


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L154-L154) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L179-L179)


```solidity

File: contracts/L2BaseToken.sol

//@audit `_account` is getting converted from `uint256` to `uint160`
57:         return balance[address(uint160(_account))];


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L2BaseToken.sol#L57-L57) 


```solidity

File: contracts/MsgValueSimulator.sol

//@audit `addressAsUint` is getting converted from `uint256` to `uint160`
32:         to = address(uint160(addressAsUint));


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/MsgValueSimulator.sol#L32-L32) 


```solidity

File: contracts/SystemContext.sol

//@audit `_blockNumber` is getting converted from `uint128` to `uint32`
234:         return keccak256(abi.encodePacked(uint32(_blockNumber)));

//@audit `currentBatchTimestamp` is getting converted from `uint128` to `uint256`
416:         uint256 packedTimestamps = (uint256(currentBatchTimestamp) << 128) | currentL2BlockTimestamp;

//@audit `_number` is getting converted from `uint256` to `uint128`
476:         BlockInfo memory newBlockInfo = BlockInfo({number: uint128(_number), timestamp: uint128(_newTimestamp)});

//@audit `_newTimestamp` is getting converted from `uint256` to `uint128`
476:         BlockInfo memory newBlockInfo = BlockInfo({number: uint128(_number), timestamp: uint128(_newTimestamp)});

//@audit `blockTimestamp` is getting converted from `uint128` to `uint256`
498:         blockInfo = (uint256(blockNumber) << 128) | uint256(blockTimestamp);

//@audit `blockNumber` is getting converted from `uint128` to `uint256`
498:         blockInfo = (uint256(blockNumber) << 128) | uint256(blockTimestamp);


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L234-L234) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L416-L416), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L476-L476), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L476-L476), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L498-L498), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L498-L498)


```solidity

File: contracts/libraries/EfficientCall.sol

//@audit `dataOffset` is getting converted from `uint256` to `uint32`
259:         SystemContractHelper.ptrAddIntoActive(uint32(dataOffset));


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L259-L259) 


```solidity

File: contracts/libraries/RLPEncoder.sol

//@audit `_val` is getting converted from `uint256` to `uint8`
29:                 encoded[0] = (_val == 0) ? bytes1(uint8(128)) : bytes1(uint8(_val));

//@audit `_len` is getting converted from `uint64` to `uint256`
66:                 uint256 hbs = _highestByteSet(uint256(_len));

//@audit `_len` is getting converted from `uint64` to `uint256`
72:                 uint256 shiftedVal = uint256(_len) << (lbs * 8);


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/RLPEncoder.sol#L29-L29) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/RLPEncoder.sol#L66-L66), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/RLPEncoder.sol#L72-L72)


```solidity

File: contracts/libraries/SystemContractHelper.sol

//@audit `_inputMemoryLength` is getting converted from `uint32` to `uint256`
132:         rawParams |= uint256(_inputMemoryLength) << 32;

//@audit `_outputMemoryOffset` is getting converted from `uint32` to `uint256`
133:         rawParams |= uint256(_outputMemoryOffset) << 64;

//@audit `_outputMemoryLength` is getting converted from `uint32` to `uint256`
134:         rawParams |= uint256(_outputMemoryLength) << 96;

//@audit `_perPrecompileInterpreted` is getting converted from `uint64` to `uint256`
135:         rawParams |= uint256(_perPrecompileInterpreted) << 192;

//@audit `_gasToBurn` is getting converted from `uint32` to `uint256`
155:         uint256 params = uint256(_gasToBurn) + (uint256(_pubdataToSpend) << 32);

//@audit `_pubdataToSpend` is getting converted from `uint32` to `uint256`
155:         uint256 params = uint256(_gasToBurn) + (uint256(_pubdataToSpend) << 32);

//@audit `MAX_SYSTEM_CONTRACT_ADDRESS` is getting converted from `uint160` to `uint160`
339:         return uint160(_address) <= uint160(MAX_SYSTEM_CONTRACT_ADDRESS);


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L132-L132) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L133-L133), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L134-L134), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L135-L135), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L155-L155), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L155-L155), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L339-L339)


```solidity

File: contracts/libraries/SystemContractsCaller.sol

//@audit `memoryPage` is getting converted from `uint32` to `uint256`
235:         farCallAbi |= (uint256(memoryPage) << 32);

//@audit `dataStart` is getting converted from `uint32` to `uint256`
236:         farCallAbi |= (uint256(dataStart) << 64);

//@audit `dataLength` is getting converted from `uint32` to `uint256`
237:         farCallAbi |= (uint256(dataLength) << 96);

//@audit `gasPassed` is getting converted from `uint32` to `uint256`
257:         farCallAbiWithEmptyFatPtr |= (uint256(gasPassed) << 192);

//@audit `shardId` is getting converted from `uint8` to `uint256`
259:         farCallAbiWithEmptyFatPtr |= (uint256(shardId) << 232);


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractsCaller.sol#L235-L235) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractsCaller.sol#L236-L236), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractsCaller.sol#L237-L237), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractsCaller.sol#L257-L257), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractsCaller.sol#L259-L259)


```solidity

File: contracts/libraries/TransactionHelper.sol

//@audit `listLength` is getting converted from `uint256` to `uint64`
199:             encodedListLength = RLPEncoder.encodeListLen(uint64(listLength));

//@audit `listLength` is getting converted from `uint256` to `uint64`
271:             encodedListLength = RLPEncoder.encodeListLen(uint64(listLength));

//@audit `listLength` is getting converted from `uint256` to `uint64`
343:             encodedListLength = RLPEncoder.encodeListLen(uint64(listLength));


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L199-L199) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L271-L271), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L343-L343)


```solidity

File: contracts/libraries/Utils.sol

//@audit `_x` is getting converted from `uint256` to `uint128`
23:         return uint128(_x);

//@audit `_x` is getting converted from `uint256` to `uint32`
29:         return uint32(_x);

//@audit `_x` is getting converted from `uint256` to `uint24`
35:         return uint24(_x);


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L23-L23) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L29-L29), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L35-L35)


```solidity

File: contracts/state-transition/StateTransitionManager.sol

//@audit `protocolVersion` is getting converted from `uint256` to `uint256`
266:             bytes32(uint256(protocolVersion)),


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L266-L266) 


```solidity

File: contracts/state-transition/chain-deps/facets/Executor.sol

//@audit `logKey` is getting converted from `uint256` to `uint8`
149:             require(!_checkBit(processedLogs, uint8(logKey)), "kp");

//@audit `logKey` is getting converted from `uint256` to `uint8`
150:             processedLogs = _setBit(processedLogs, uint8(logKey));


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L149-L149) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L150-L150)


```solidity

File: contracts/SystemContractsCaller.sol

//@audit `_x` is getting converted from `uint256` to `uint32`
30:         return uint32(_x);

//@audit `memoryPage` is getting converted from `uint32` to `uint256`
116:         farCallAbi |= (uint256(memoryPage) << 32);

//@audit `dataStart` is getting converted from `uint32` to `uint256`
117:         farCallAbi |= (uint256(dataStart) << 64);

//@audit `dataLength` is getting converted from `uint32` to `uint256`
118:         farCallAbi |= (uint256(dataLength) << 96);

//@audit `gasPassed` is getting converted from `uint32` to `uint256`
128:         farCallAbiWithEmptyFatPtr |= (uint256(gasPassed) << 192);

//@audit `shardId` is getting converted from `uint8` to `uint256`
130:         farCallAbiWithEmptyFatPtr |= (uint256(shardId) << 232);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/SystemContractsCaller.sol#L30-L30) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/SystemContractsCaller.sol#L116-L116), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/SystemContractsCaller.sol#L117-L117), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/SystemContractsCaller.sol#L118-L118), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/SystemContractsCaller.sol#L128-L128), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/SystemContractsCaller.sol#L130-L130)


</details>


### [L&#x2011;17] Setters should have initial value check 
Setters should have initial value check to prevent assigning wrong value to the variable. Assginment of wrong value can lead to unexpected behavior of the contract.


*There are 16 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/SystemContext.sol

84:     function setChainId(uint256 _newChainId) external onlyCallFromForceDeployer {

99:     function setTxOrigin(address _newOrigin) external onlyCallFromBootloader {

105:     function setGasPrice(uint256 _gasPrice) external onlyCallFromBootloader {

112:     function setPubdataInfo(uint256 _gasPerPubdataByte, uint256 _basePubdataSpent) external onlyCallFromBootloader {

486:     function resetTxNumberInBatch() external onlyCallFromBootloader {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L84-L84) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L99-L99), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L105-L105), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L112-L112), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L486-L486)


```solidity

File: contracts/bridgehub/Bridgehub.sol

51:     function setPendingAdmin(address _newPendingAdmin) external onlyOwnerOrAdmin {

108:     function setSharedBridge(address _sharedBridge) external onlyOwner {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L51-L51) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L108-L108)


```solidity

File: contracts/governance/Governance.sol

249:     function updateDelay(uint256 _newDelay) external onlySelf {

256:     function updateSecurityCouncil(address _newSecurityCouncil) external onlySelf {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/Governance.sol#L249-L249) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/Governance.sol#L256-L256)


```solidity

File: contracts/state-transition/StateTransitionManager.sol

110:     function setPendingAdmin(address _newPendingAdmin) external onlyOwnerOrAdmin {

132:     function setValidatorTimelock(address _validatorTimelock) external onlyOwnerOrAdmin {

137:     function setInitialCutHash(Diamond.DiamondCutData calldata _diamondCut) external onlyOwner {

142:     function setNewVersionUpgrade(

152:     function setUpgradeDiamondCut(


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L110-L110) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L132-L132), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L137-L137), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L142-L142), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L152-L152)


```solidity

File: contracts/state-transition/ValidatorTimelock.sol

73:     function setStateTransitionManager(IStateTransitionManager _stateTransitionManager) external onlyOwner {

96:     function setExecutionDelay(uint32 _executionDelay) external onlyOwner {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L73-L73) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L96-L96)


</details>


### [L&#x2011;18] Solidity version 0.8.20 may not work on other chains due to `PUSH0` 
The compiler for Solidity 0.8.20 switches the default target EVM version to [Shanghai](https://blog.soliditylang.org/2023/05/10/solidity-0.8.20-release-announcement/#important-note), which includes the new `PUSH0` op code. This op code may not yet be implemented on all L2s, so deployment on these chains will fail. To work around this issue, use an earlier [EVM](https://docs.soliditylang.org/en/v0.8.20/using-the-compiler.html?ref=zaryabs.com#setting-the-evm-version-to-target) [version](https://book.getfoundry.sh/reference/config/solidity-compiler#evm_version)


*There are 3 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/AccountCodeStorage.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/AccountCodeStorage.sol#L3-L3) 


```solidity

File: contracts/bridge/L1ERC20Bridge.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1ERC20Bridge.sol#L3-L3) 


```solidity

File: contracts/bridge/L2SharedBridge.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L3-L3) 


</details>


### [L&#x2011;19] Int casting `block.timestamp` can reduce the lifespan of a contract 
Consider removing casting to ensure future functionality.


*There are 2 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/state-transition/ValidatorTimelock.sol

115:             uint32 timestamp = uint32(block.timestamp);

134:             uint32 timestamp = uint32(block.timestamp);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L115-L115) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L134-L134)


</details>


### [L&#x2011;20] Unsafe downcast 
When a type is downcast to a smaller type, the higher order bits are truncated, effectively applying a modulo to the original value. Without any other checks, this wrapping will lead to unexpected behavior and bugs


*There are 33 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/BootloaderUtilities.sol

//@audit converting from `uint256` to `uint64`
68:             uint64 txDataLen = uint64(_transaction.data.length);

//@audit `listLength` is getting converted from `uint256` to `uint64`
116:             encodedListLength = RLPEncoder.encodeListLen(uint64(listLength));

//@audit converting from `uint256` to `uint64`
164:             uint64 txDataLen = uint64(_transaction.data.length);

//@audit `listLength` is getting converted from `uint256` to `uint64`
207:             encodedListLength = RLPEncoder.encodeListLen(uint64(listLength));

//@audit converting from `uint256` to `uint64`
259:             uint64 txDataLen = uint64(_transaction.data.length);

//@audit `listLength` is getting converted from `uint256` to `uint64`
302:             encodedListLength = RLPEncoder.encodeListLen(uint64(listLength));


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L68-L68) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L116-L116), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L164-L164), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L207-L207), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L259-L259), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L302-L302)


```solidity

File: contracts/DefaultAccount.sol

//@audit converting from `uint256` to `uint32`
84:             uint32(gasleft()),


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/DefaultAccount.sol#L84-L84) 


```solidity

File: contracts/L1Messenger.sol

//@audit `pubdataLen` is getting converted from `uint256` to `uint32`
154:         SystemContractHelper.burnGas(Utils.safeCastToU32(gasToPay), uint32(pubdataLen));

//@audit `pubdataLen` is getting converted from `uint256` to `uint32`
179:         SystemContractHelper.burnGas(Utils.safeCastToU32(gasToPay), uint32(pubdataLen));


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L154-L154) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L179-L179)


```solidity

File: contracts/SystemContext.sol

//@audit `_blockNumber` is getting converted from `uint128` to `uint32`
234:         return keccak256(abi.encodePacked(uint32(_blockNumber)));

//@audit `_number` is getting converted from `uint256` to `uint128`
476:         BlockInfo memory newBlockInfo = BlockInfo({number: uint128(_number), timestamp: uint128(_newTimestamp)});

//@audit `_newTimestamp` is getting converted from `uint256` to `uint128`
476:         BlockInfo memory newBlockInfo = BlockInfo({number: uint128(_number), timestamp: uint128(_newTimestamp)});


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L234-L234) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L476-L476), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L476-L476)


```solidity

File: contracts/libraries/EfficientCall.sol

//@audit `dataOffset` is getting converted from `uint256` to `uint32`
259:         SystemContractHelper.ptrAddIntoActive(uint32(dataOffset));

//@audit converting from `uint256` to `uint32`
261:         uint32 shrinkTo = uint32(msg.data.length - (_data.length + dataOffset));


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L259-L259) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L261-L261)


```solidity

File: contracts/libraries/RLPEncoder.sol

//@audit converting from `uint256` to `uint8`
34:                 encoded[0] = bytes1(uint8(hbs + 0x81));

//@audit converting from `uint256` to `uint8`
64:                 encoded[0] = bytes1(uint8(_len + _offset));

//@audit converting from `uint256` to `uint8`
69:                 encoded[0] = bytes1(uint8(_offset + hbs + 56));


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/RLPEncoder.sol#L34-L34) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/RLPEncoder.sol#L64-L64), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/RLPEncoder.sol#L69-L69)


```solidity

File: contracts/libraries/SystemContractHelper.sol

//@audit converting from `uint256` to `uint32`
228:         pubdataPublished = uint32(extractNumberFromMeta(meta, META_GAS_PER_PUBDATA_BYTE_OFFSET, 32));

//@audit converting from `uint256` to `uint32`
238:         heapSize = uint32(extractNumberFromMeta(meta, META_HEAP_SIZE_OFFSET, 32));

//@audit converting from `uint256` to `uint32`
247:         auxHeapSize = uint32(extractNumberFromMeta(meta, META_AUX_HEAP_SIZE_OFFSET, 32));

//@audit converting from `uint256` to `uint8`
255:         shardId = uint8(extractNumberFromMeta(meta, META_SHARD_ID_OFFSET, 8));

//@audit converting from `uint256` to `uint8`
264:         callerShardId = uint8(extractNumberFromMeta(meta, META_CALLER_SHARD_ID_OFFSET, 8));

//@audit converting from `uint256` to `uint8`
273:         codeShardId = uint8(extractNumberFromMeta(meta, META_CODE_SHARD_ID_OFFSET, 8));


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L228-L228) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L238-L238), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L247-L247), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L255-L255), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L264-L264), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L273-L273)


```solidity

File: contracts/libraries/TransactionHelper.sol

//@audit converting from `uint256` to `uint64`
171:             uint64 txDataLen = uint64(_transaction.data.length);

//@audit `listLength` is getting converted from `uint256` to `uint64`
199:             encodedListLength = RLPEncoder.encodeListLen(uint64(listLength));

//@audit converting from `uint256` to `uint64`
249:             uint64 txDataLen = uint64(_transaction.data.length);

//@audit `listLength` is getting converted from `uint256` to `uint64`
271:             encodedListLength = RLPEncoder.encodeListLen(uint64(listLength));

//@audit converting from `uint256` to `uint64`
321:             uint64 txDataLen = uint64(_transaction.data.length);

//@audit `listLength` is getting converted from `uint256` to `uint64`
343:             encodedListLength = RLPEncoder.encodeListLen(uint64(listLength));


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L171-L171) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L199-L199), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L249-L249), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L271-L271), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L321-L321), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L343-L343)


```solidity

File: contracts/state-transition/chain-deps/facets/Mailbox.sol

//@audit converting from `uint256` to `uint64`
283:         _params.expirationTimestamp = uint64(block.timestamp + PRIORITY_EXPIRATION); // Safe to cast


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L283-L283) 


```solidity

File: contracts/state-transition/libraries/LibMap.sol

//@audit converting from `uint256` to `uint32`
30:             result = uint32(mapValue >> bitOffset);

//@audit converting from `uint256` to `uint32`
54:             uint32 oldValue = uint32(mapValue >> bitOffset);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/LibMap.sol#L30-L30) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/LibMap.sol#L54-L54)


```solidity

File: contracts/bridge/L2SharedBridge.sol

//@audit converting from `uint256` to `uint32`
166:             uint32(gasleft()),


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L166-L166) 


</details>


### [L&#x2011;21] Unused/empty `receive()`/`fallback()` function 
If the intention is for the Ether to be used, the function should call another function or emit an event, otherwise it should revert.


*There are 4 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/DefaultAccount.sol

227:     receive() external payable {
228:         // If the contract is called directly, behave like an EOA
229:     }


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/DefaultAccount.sol#L227-L229) 


```solidity

File: contracts/EmptyContract.sol

11:     fallback() external payable {}
12: 

13:     receive() external payable {}
14: }


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/EmptyContract.sol#L11-L12) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/EmptyContract.sol#L13-L14)


```solidity

File: contracts/governance/Governance.sol

262:     receive() external payable {}
263: }


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/Governance.sol#L262-L263) 


</details>


### [L&#x2011;22] Consider implementing two-step procedure for updating protocol addresses 
A copy-paste error or a typo may end up bricking protocol functionality, or sending tokens to an address with no known private key. Consider implementing a two-step procedure for updating protocol addresses, where the recipient is set as pending, and must 'accept' the assignment by making an affirmative call. A straight forward way of doing this would be to have the target contracts implement [EIP-165](https://eips.ethereum.org/EIPS/eip-165), and to have the 'set' functions ensure that the recipient is of the right interface type.


*There are 7 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/SystemContext.sol

099:     function setTxOrigin(address _newOrigin) external onlyCallFromBootloader {
100:         origin = _newOrigin;
101:     }


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L99-L101) 


```solidity

File: contracts/bridgehub/Bridgehub.sol

51:     function setPendingAdmin(address _newPendingAdmin) external onlyOwnerOrAdmin {
52:         // Save previous value into the stack to put it into the event later
53:         address oldPendingAdmin = pendingAdmin;
54:         // Change pending admin
55:         pendingAdmin = _newPendingAdmin;
56:         emit NewPendingAdmin(oldPendingAdmin, _newPendingAdmin);
57:     }


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L51-L57) 


```solidity

File: contracts/governance/Governance.sol

256:     function updateSecurityCouncil(address _newSecurityCouncil) external onlySelf {
257:         emit ChangeSecurityCouncil(securityCouncil, _newSecurityCouncil);
258:         securityCouncil = _newSecurityCouncil;
259:     }


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/Governance.sol#L256-L259) 


```solidity

File: contracts/state-transition/StateTransitionManager.sol

110:     function setPendingAdmin(address _newPendingAdmin) external onlyOwnerOrAdmin {
111:         // Save previous value into the stack to put it into the event later
112:         address oldPendingAdmin = pendingAdmin;
113:         // Change pending admin
114:         pendingAdmin = _newPendingAdmin;
115:         emit NewPendingAdmin(oldPendingAdmin, _newPendingAdmin);
116:     }

132:     function setValidatorTimelock(address _validatorTimelock) external onlyOwnerOrAdmin {
133:         validatorTimelock = _validatorTimelock;
134:     }


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L110-L116) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L132-L134)


```solidity

File: contracts/state-transition/ValidatorTimelock.sol

73:     function setStateTransitionManager(IStateTransitionManager _stateTransitionManager) external onlyOwner {
74:         stateTransitionManager = _stateTransitionManager;
75:     }


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L73-L75) 


```solidity

File: contracts/state-transition/chain-deps/facets/Admin.sol

23:     function setPendingAdmin(address _newPendingAdmin) external onlyAdmin {
24:         // Save previous value into the stack to put it into the event later
25:         address oldPendingAdmin = s.pendingAdmin;
26:         // Change pending admin
27:         s.pendingAdmin = _newPendingAdmin;
28:         emit NewPendingAdmin(oldPendingAdmin, _newPendingAdmin);
29:     }


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Admin.sol#L23-L29) 


</details>


### [L&#x2011;23] Upgradeable contract uses non-upgradeable version of the OpenZeppelin libraries/contracts 
OpenZeppelin has an [Upgradeable](https://github.com/OpenZeppelin/openzeppelin-contracts-upgradeable/tree/master/contracts/utils) variants of each of its libraries and contracts, and upgradeable contracts should use those variants.


*There are 4 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/bridge/L1SharedBridge.sol

6: import {Ownable2Step} from "@openzeppelin/contracts/access/Ownable2Step.sol";

8: import {IERC20Metadata} from "@openzeppelin/contracts/token/ERC20/extensions/IERC20Metadata.sol";

9: import {IERC20} from "@openzeppelin/contracts/token/ERC20/IERC20.sol";

10: import {SafeERC20} from "@openzeppelin/contracts/token/ERC20/utils/SafeERC20.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L6-L6) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L8-L8), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L9-L9), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L10-L10)


</details>


### [L&#x2011;24] Upgradeable contract is missing a `__gap[50]` storage variable to allow for new storage variables in later versions 
See [this](https://docs.openzeppelin.com/contracts/4.x/upgradeable#storage_gaps) link for a description of this storage variable. While some contracts may not currently be sub-classed, adding the variable now protects against forgetting to add it in the future.


*There are 1 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/bridge/L2StandardERC20.sol

15: contract L2StandardERC20 is ERC20PermitUpgradeable, IL2StandardToken, ERC1967Upgrade {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2StandardERC20.sol#L15-L15) 


</details>


### [L&#x2011;25] `safeApprove()` is deprecated 
[Deprecated](https://github.com/OpenZeppelin/openzeppelin-contracts/blob/bfff03c0d2a59bcd8e2ead1da9aed9edf0080d05/contracts/token/ERC20/utils/SafeERC20.sol#L38-L45) in favor of `safeIncreaseAllowance()` and `safeDecreaseAllowance()`. If only setting the initial allowance to the value that means infinite, `safeIncreaseAllowance()` can be used instead. The function may currently work, but if a bug is found in this version of OpenZeppelin, and the version that you're forced to upgrade to no longer has this function, you'll encounter unnecessary delays in porting and testing replacement contracts.


*There are 2 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/libraries/TransactionHelper.sol

382:                 IERC20(token).safeApprove(paymaster, 0);

383:                 IERC20(token).safeApprove(paymaster, minAllowance);


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L382-L382) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L383-L383)


</details>


### [L&#x2011;26] Consider using descriptive `constant`s when passing zero as a function argument 
Passing zero as a function argument can sometimes result in a security issue (e.g. passing zero as the slippage parameter). Consider using a `constant` variable with a descriptive name, so it's clear that the argument is intentionally being used, and for the right reasons.


*There are 15 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/BootloaderUtilities.sol

//@audit parameter number 1 starting from left
176:         bytes memory encodedAccessListLength = RLPEncoder.encodeListLen(0);

//@audit parameter number 1 starting from left
271:         bytes memory encodedAccessListLength = RLPEncoder.encodeListLen(0);


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L176-L176) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L271-L271)


```solidity

File: contracts/Compressor.sol

//@audit parameter number 1 starting from left
121:         uint256 numberOfInitialWrites = uint256(_compressedStateDiffs.readUint16(0));

//@audit parameter number 1 starting from left
202:             uint256 dictionaryLen = uint256(_rawCompressedData.readUint16(0));


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Compressor.sol#L121-L121) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Compressor.sol#L202-L202)


```solidity

File: contracts/DefaultAccount.sol

//@audit parameter number 3 starting from left
83:         SystemContractsCaller.systemCallWithPropagatedRevert(
84:             uint32(gasleft()),
85:             address(NONCE_HOLDER_SYSTEM_CONTRACT),
86:             0,
87:             abi.encodeCall(INonceHolder.incrementMinNonceIfEquals, (_transaction.nonce))
88:         );


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/DefaultAccount.sol#L83-L88) 


```solidity

File: contracts/L1Messenger.sol

//@audit parameter number 2 starting from left
90:         SystemContractHelper.burnGas(Utils.safeCastToU32(gasToPay), 0);


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L90-L90) 


```solidity

File: contracts/libraries/SystemContractHelper.sol

//@audit parameter number 1 starting from left
345:         bool precompileCallSuccess = unsafePrecompileCall(
346:             0, // The precompile parameters are formal ones. We only need the precompile call to burn gas.
347:             _gasToPay,
348:             _pubdataToSpend
349:         );


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L345-L349) 


```solidity

File: contracts/libraries/SystemContractsCaller.sol

//@audit parameter number 1 starting from left
85:         uint256 farCallAbi = SystemContractsCaller.getFarCallABI(
86:             0,
87:             0,
88:             dataStart,
89:             dataLength,
90:             gasLimit,
91:             // Only rollup is supported for now
92:             0,
93:             CalldataForwardingMode.UseHeap,
94:             false,
95:             true
96:         );

//@audit parameter number 6 starting from left
85:         uint256 farCallAbi = SystemContractsCaller.getFarCallABI(
86:             0,
87:             0,
88:             dataStart,
89:             dataLength,
90:             gasLimit,
91:             // Only rollup is supported for now
92:             0,
93:             CalldataForwardingMode.UseHeap,
94:             false,
95:             true
96:         );


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractsCaller.sol#L85-L96) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractsCaller.sol#L85-L96)


```solidity

File: contracts/libraries/TransactionHelper.sol

//@audit parameter number 1 starting from left
261:         bytes memory encodedAccessListLength = RLPEncoder.encodeListLen(0);

//@audit parameter number 1 starting from left
333:         bytes memory encodedAccessListLength = RLPEncoder.encodeListLen(0);


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L261-L261) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L333-L333)


```solidity

File: contracts/bridge/L1SharedBridge.sol

//@audit parameter number 2 starting from left
503:         (uint32 functionSignature, uint256 offset) = UnsafeBytes.readUint32(_l2ToL1message, 0);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L503-L503) 


```solidity

File: contracts/SystemContractsCaller.sol

//@audit parameter number 1 starting from left
46:         uint256 farCallAbi = getFarCallABI(
47:             0,
48:             0,
49:             dataStart,
50:             dataLength,
51:             gasLimit,
52:             // Only rollup is supported for now
53:             0,
54:             CalldataForwardingMode.UseHeap,
55:             false,
56:             true
57:         );

//@audit parameter number 6 starting from left
46:         uint256 farCallAbi = getFarCallABI(
47:             0,
48:             0,
49:             dataStart,
50:             dataLength,
51:             gasLimit,
52:             // Only rollup is supported for now
53:             0,
54:             CalldataForwardingMode.UseHeap,
55:             false,
56:             true
57:         );


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/SystemContractsCaller.sol#L46-L57) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/SystemContractsCaller.sol#L46-L57)


```solidity

File: contracts/bridge/L2SharedBridge.sol

//@audit parameter number 3 starting from left
165:         (bool success, bytes memory returndata) = SystemContractsCaller.systemCallWithReturndata(
166:             uint32(gasleft()),
167:             DEPLOYER_SYSTEM_CONTRACT,
168:             0,
169:             abi.encodeCall(
170:                 IContractDeployer.create2,
171:                 (salt, l2TokenProxyBytecodeHash, abi.encode(address(l2TokenBeacon), ""))
172:             )
173:         );


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L165-L173) 


</details>


### [L&#x2011;27] Check of division by zero 



*There are 1 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/state-transition/chain-deps/facets/Mailbox.sol

172:         uint256 minL2GasPriceBaseToken = (fullPubdataPriceBaseToken + _gasPerPubdata - 1) / _gasPerPubdata;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L172-L172) 


</details>


### [L&#x2011;28] Functions calling contracts/addresses with transfer hooks are missing reentrancy guards 
Even if the function follows the best practice of check-effects-interaction, not using a reentrancy guard when there may be transfer hooks will open the users of this protocol up to [read-only reentrancies](https://chainsecurity.com/curve-lp-oracle-manipulation-post-mortem/) with no way to protect against it, except by block-listing the whole protocol.


*There are 3 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/bridge/L1ERC20Bridge.sol

//@audit function `tranferTokenToSharedBridge()` is not protected against reentrancy
67:         IERC20(_token).safeTransfer(address(sharedBridge), amount);

//@audit function `_depositFundsToSharedBridge()` is not protected against reentrancy
162:         _token.safeTransferFrom(_from, address(sharedBridge), _amount);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1ERC20Bridge.sol#L67-L67) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1ERC20Bridge.sol#L162-L162)


```solidity

File: contracts/bridge/L1SharedBridge.sol

//@audit function `_depositFunds()` is not protected against reentrancy
175:         _token.safeTransferFrom(_from, address(this), _amount);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L175-L175) 


</details>


### [L&#x2011;29] Code does not follow the best practice of check-effects-interaction 
Code should follow the best-practice of [check-effects-interaction](https://blockchain-academy.hs-mittweida.de/courses/solidity-coding-beginners-to-intermediate/lessons/solidity-11-coding-patterns/topic/checks-effects-interactions/), where state variables are updated before any external calls are made. Doing so prevents a large class of reentrancy bugs.


*There are 6 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/L1Messenger.sol

//@audit the function `toL1()` is called before the following assignment
329:         chainedLogsHash = bytes32(0);

//@audit the function `toL1()` is called before the following assignment
330:         numberOfLogsToProcess = 0;

//@audit the function `toL1()` is called before the following assignment
331:         chainedMessagesHash = bytes32(0);

//@audit the function `toL1()` is called before the following assignment
332:         chainedL1BytecodesRevealDataHash = bytes32(0);


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L329-L329) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L330-L330), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L331-L331), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L332-L332)


```solidity

File: contracts/bridge/L1SharedBridge.sol

//@audit the function `transferEthToSharedBridge()` is called before the following assignment
122:             chainBalance[_targetChainId][ETH_TOKEN_ADDRESS] =

//@audit the function `tranferTokenToSharedBridge()` is called before the following assignment
133:             chainBalance[_targetChainId][_token] = chainBalance[_targetChainId][_token] + amount;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L122-L122) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L133-L133)


</details>


### [L&#x2011;30] prevent re-setting a state variable with the same value 
Not only is wasteful in terms of gas, but this is especially problematic when an event is emitted and the old and new values set are the same, as listeners might not expect this kind of scenario.


*There are 28 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/ContractDeployer.sol

65:     function updateAccountVersion(AccountAbstractionVersion _version) external onlySystemCall {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L65-L65) 


```solidity

File: contracts/SystemContext.sol

84:     function setChainId(uint256 _newChainId) external onlyCallFromForceDeployer {

99:     function setTxOrigin(address _newOrigin) external onlyCallFromBootloader {

105:     function setGasPrice(uint256 _gasPrice) external onlyCallFromBootloader {

112:     function setPubdataInfo(uint256 _gasPerPubdataByte, uint256 _basePubdataSpent) external onlyCallFromBootloader {

486:     function resetTxNumberInBatch() external onlyCallFromBootloader {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L84-L84) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L99-L99), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L105-L105), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L112-L112), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L486-L486)


```solidity

File: contracts/bridgehub/Bridgehub.sol

51:     function setPendingAdmin(address _newPendingAdmin) external onlyOwnerOrAdmin {

108:     function setSharedBridge(address _sharedBridge) external onlyOwner {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L51-L51) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L108-L108)


```solidity

File: contracts/governance/Governance.sol

249:     function updateDelay(uint256 _newDelay) external onlySelf {

256:     function updateSecurityCouncil(address _newSecurityCouncil) external onlySelf {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/Governance.sol#L249-L249) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/Governance.sol#L256-L256)


```solidity

File: contracts/state-transition/StateTransitionManager.sol

110:     function setPendingAdmin(address _newPendingAdmin) external onlyOwnerOrAdmin {

132:     function setValidatorTimelock(address _validatorTimelock) external onlyOwnerOrAdmin {

137:     function setInitialCutHash(Diamond.DiamondCutData calldata _diamondCut) external onlyOwner {

142:     function setNewVersionUpgrade(

152:     function setUpgradeDiamondCut(


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L110-L110) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L132-L132), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L137-L137), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L142-L142), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L152-L152)


```solidity

File: contracts/state-transition/ValidatorTimelock.sol

73:     function setStateTransitionManager(IStateTransitionManager _stateTransitionManager) external onlyOwner {

96:     function setExecutionDelay(uint32 _executionDelay) external onlyOwner {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L73-L73) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L96-L96)


```solidity

File: contracts/state-transition/chain-deps/facets/Admin.sol

23:     function setPendingAdmin(address _newPendingAdmin) external onlyAdmin {

45:     function setValidator(address _validator, bool _active) external onlyStateTransitionManager {

51:     function setPorterAvailability(bool _zkPorterIsAvailable) external onlyStateTransitionManager {

58:     function setPriorityTxMaxGasLimit(uint256 _newPriorityTxMaxGasLimit) external onlyStateTransitionManager {

67:     function changeFeeParams(FeeParams calldata _newFeeParams) external onlyAdminOrStateTransitionManager {

79:     function setTokenMultiplier(uint128 _nominator, uint128 _denominator) external onlyAdminOrStateTransitionManager {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Admin.sol#L23-L23) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Admin.sol#L45-L45), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Admin.sol#L51-L51), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Admin.sol#L58-L58), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Admin.sol#L67-L67), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Admin.sol#L79-L79)


```solidity

File: contracts/state-transition/chain-deps/facets/Getters.sol

57:     function getBaseToken() external view returns (address) {

62:     function getBaseTokenBridge() external view returns (address) {

67:     function baseTokenGasPriceMultiplierNominator() external view returns (uint128) {

72:     function baseTokenGasPriceMultiplierDenominator() external view returns (uint128) {

188:     function isEthWithdrawalFinalized(uint256 _l2BatchNumber, uint256 _l2MessageIndex) external view returns (bool) {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L57-L57) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L62-L62), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L67-L67), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L72-L72), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L188-L188)


</details>


### [L&#x2011;31] Missing contract-existence checks before yul `call()` 
Low-level calls return success if there is no code present at the specified address. In addition to the zero-address checks, add a check to verify that `extcodesize()` is non-zero.


*There are 28 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/libraries/EfficientCall.sol

135:             assembly {
136:                 success := call(_address, callAddr, 0, 0, 0xFFFF, 0, 0)

148:             assembly {
149:                 success := call(msgValueSimulator, callAddr, _value, _address, 0xFFFF, forwardMask, 0)

163:         assembly {
164:             success := staticcall(_address, callAddr, 0, 0xFFFF, 0, 0)

177:         assembly {
178:             success := delegatecall(_address, callAddr, 0, 0xFFFF, 0, 0)

203:         assembly {
204:             // Clearing values before usage in assembly, since Solidity
205:             // doesn't do it by default
206:             _whoToMimic := and(_whoToMimic, cleanupMask)
207: 
208:             success := call(_address, callAddr, 0, 0, _whoToMimic, 0, 0)


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L135-L136) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L148-L149), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L163-L164), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L177-L178), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L203-L208)


```solidity

File: contracts/libraries/SystemContractHelper.sol

50:         assembly {
51:             // Ensuring that the type is bool
52:             _isService := and(_isService, 1)
53:             // This `success` is always 0, but the method always succeeds
54:             // (except for the cases when there is not enough gas)
55:             let success := call(_isService, callAddr, _key, _value, 0xFFFF, 0, 0)

65:         assembly {
66:             addr := staticcall(0, callAddr, 0, 0xFFFF, 0, 0)

76:         assembly {
77:             pop(staticcall(0, callAddr, 0, 0xFFFF, 0, 0))

87:         assembly {
88:             pop(staticcall(_farCallAbi, callAddr, 0, 0xFFFF, 0, 0))

097:         assembly {
098:             // Clearing input params as they are not cleaned by Solidity by default
099:             _value := and(_value, cleanupMask)
100:             pop(staticcall(_value, callAddr, 0, 0xFFFF, 0, 0))

109:         assembly {
110:             // Clearing input params as they are not cleaned by Solidity by default
111:             _shrink := and(_shrink, cleanupMask)
112:             pop(staticcall(_shrink, callAddr, 0, 0xFFFF, 0, 0))

158:         assembly {
159:             // Clearing input params as they are not cleaned by Solidity by default
160:             params := and(params, cleanupMask)
161:             success := staticcall(_rawParams, callAddr, params, 0xFFFF, 0, 0)

171:         assembly {
172:             // Clearing input params as they are not cleaned by Solidity by default
173:             _value := and(_value, cleanupMask)
174:             success := call(0, callAddr, _value, 0, 0xFFFF, 0, 0)

183:         assembly {
184:             pop(call(initializer, callAddr, value1, 0, 0xFFFF, 0, 0))

193:         assembly {
194:             pop(call(value1, callAddr, value2, 0, 0xFFFF, 0, 0))

205:         assembly {
206:             meta := staticcall(0, callAddr, 0, 0xFFFF, 0, 0)

298:         assembly {
299:             callFlags := staticcall(0, callAddr, 0, 0xFFFF, 0, 0)

309:         assembly {
310:             ptr := staticcall(0, callAddr, 0, 0xFFFF, 0, 0)

322:         assembly {
323:             extraAbiData := staticcall(index, callAddr, 0, 0xFFFF, 0, 0)


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L50-L55) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L65-L66), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L76-L77), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L87-L88), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L97-L100), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L109-L112), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L158-L161), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L171-L174), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L183-L184), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L193-L194), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L205-L206), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L298-L299), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L309-L310), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L322-L323)


```solidity

File: contracts/libraries/SystemContractsCaller.sol

100:             assembly {
101:                 success := call(to, callAddr, 0, 0, farCallAbi, 0, 0)

109:             assembly {
110:                 success := call(msgValueSimulator, callAddr, value, to, farCallAbi, forwardMask, 0)


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractsCaller.sol#L100-L101) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractsCaller.sol#L109-L110)


```solidity

File: contracts/libraries/TransactionHelper.sol

399:         assembly {
400:             success := call(gas(), bootloaderAddr, amount, 0, 0, 0, 0)


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L399-L400) 


```solidity

File: contracts/bridge/L1SharedBridge.sol

357:             assembly {
358:                 callSuccess := call(gas(), _depositSender, _amount, 0, 0, 0, 0)

446:             assembly {
447:                 callSuccess := call(gas(), l1Receiver, amount, 0, 0, 0, 0)


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L357-L358) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L446-L447)


```solidity

File: contracts/state-transition/ValidatorTimelock.sol

227:         assembly {
228:             // Copy function signature and arguments from calldata at zero position into memory at pointer position


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L227-L228) 


```solidity

File: contracts/state-transition/chain-deps/DiamondProxy.sol

33:         assembly {
34:             // The pointer to the free memory slot
35:             let ptr := mload(0x40)
36:             // Copy function signature and arguments from calldata at zero position into memory at pointer position


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/DiamondProxy.sol#L33-L36) 


```solidity

File: contracts/SystemContractsCaller.sol

61:             assembly {
62:                 success := call(to, callAddr, 0, 0, farCallAbi, 0, 0)

70:             assembly {
71:                 success := call(msgValueSimulator, callAddr, value, to, farCallAbi, forwardMask, 0)


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/SystemContractsCaller.sol#L61-L62) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/SystemContractsCaller.sol#L70-L71)


</details>


### [L&#x2011;32] Subtraction may underflow if multiplication is too large 
 


*There are 1 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/Compressor.sol

253:         number >>= (256 - (_calldataSlice.length * 8));


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Compressor.sol#L253-L253) 


</details>


### [L&#x2011;33] Use of `tx.origin` is unsafe in almost every context 
According to [Vitalik Buterin](https://ethereum.stackexchange.com/questions/196/how-do-i-make-my-dapp-serenity-proof), contracts should _not_ `assume that tx.origin will continue to be usable or meaningful`. An example of this is [EIP-3074](https://eips.ethereum.org/EIPS/eip-3074#allowing-txorigin-as-signer-1) which explicitly mentions the intention to change its semantics when it's used with new op codes.There have also been calls to [remove](https://github.com/ethereum/solidity/issues/683) `tx.origin`, and there are [security issues](solidity.readthedocs.io/en/v0.4.24/security-considerations.html#tx-origin) associated with using it for authorization. For these reasons, it's best to completely avoid the feature.Using the variable could make a contract vulnerable if an authorized account calls a malicious contract.You can impersonate a user using a third party contract.


*There are 3 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/bridge/L1SharedBridge.sol

579:                 refundRecipient = _prevMsgSender != tx.origin


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L579-L579) 


```solidity

File: contracts/bridgehub/Bridgehub.sol

328:             _recipient = msg.sender == tx.origin ? msg.sender : AddressAliasHelper.applyL1ToL2Alias(msg.sender);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L328-L328) 


```solidity

File: contracts/state-transition/chain-deps/facets/Mailbox.sol

234:         if (l2Sender != tx.origin) {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L234-L234) 


</details>


### [L&#x2011;34] `address`es upcast and compared to values larger than a `uint160`, may result in collisions 
If the value is being compared to an input value in order to reject it, rather than allowing it to be converted to an address, the check will pass if the value is larger than `type(uint160).max`, even if, when cast, it matches the gating address.


*There are 1 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/libraries/TransactionHelper.sol

95:         return _addr == uint256(uint160(address(BASE_TOKEN_SYSTEM_CONTRACT))) || _addr == 0;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L95-L95) 


</details>


### [L&#x2011;35] Function can return unassigned variable 
Make sure that functions with a return value always return a valid and assigned value. Even if the default value is as expected, it should be assigned with the default value for code clarity and to reduce confusion.


*There are 4 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/ContractDeployer.sol

173:         return newAddress;

193:         return newAddress;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L173-L173) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L193-L193)


```solidity

File: contracts/NonceHolder.sol

50:         return minNonce;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/NonceHolder.sol#L50-L50) 


```solidity

File: contracts/upgrades/BaseZkSyncUpgrade.sol

216:         return l2ProtocolUpgradeTxHash;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgrade.sol#L216-L216) 


</details>


### [L&#x2011;36] Named return variable used before assignment 
As no value is written to the variable, the default value is always read. This is usually due to a bug in the code logic that causes an invalid value to be used.


*There are 1 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/NonceHolder.sol

129:         return deploymentNonce;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/NonceHolder.sol#L129-L129) 


</details>


### [L&#x2011;37] Missing checks in initializer function 
There are some missing checks in these functions, and this could lead to unexpected scenarios. Consider always adding a sanity check for state variables.


*There are 1 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/bridge/L1SharedBridge.sol

//@audit _eraFirstPostUpgradeBatch,  are not checked
104:     function initialize(
105:         address _owner,
106:         uint256 _eraFirstPostUpgradeBatch
107:     ) external reentrancyGuardInitializer initializer {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L104-L107) 


</details>


### [L&#x2011;38] Variables shadowing other definitions 
A variable declaration shadowing any other existing definition is error-prone. It can cause confusion for developers, potentially introduce bugs, and reduce the readability and maintainability.


*There are 4 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/bridge/L1SharedBridge.sol

//@audit this variable is shadowing the `Ownable`'s stat variable `_owner`
105:         address _owner,


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L105-L105) 


```solidity

File: contracts/bridgehub/Bridgehub.sol

//@audit this variable is shadowing the `Ownable`'s stat variable `_owner`
41:     function initialize(address _owner) external reentrancyGuardInitializer {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L41-L41) 


```solidity

File: contracts/bridge/L2StandardERC20.sol

//@audit this variable is shadowing the `EIP712Upgradeable`'s stat variable `_version`
115:         uint8 _version

//@audit this variable is shadowing the `EIP712Upgradeable`'s stat variable `_version`
134:     modifier onlyNextVersion(uint8 _version) {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2StandardERC20.sol#L115-L115) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2StandardERC20.sol#L134-L134)


</details>


### [L&#x2011;39] [Solidity]: Bug in Legacy Code Generation When Accessing the .selector Member on Expressions with Side Effects 
This version of solidity is vulnerable to a bug in the legacy code generation pipeline of the Solidity compiler that was found during investigation of a security report On June 26, 2023. For more details check the following [link](https://soliditylang.org/blog/2023/07/19/missing-side-effects-on-selector-access-bug/)


*There are 9 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/DefaultAccount.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/DefaultAccount.sol#L3-L3) 


```solidity

File: contracts/L2BaseToken.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L2BaseToken.sol#L3-L3) 


```solidity

File: contracts/interfaces/IAccount.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IAccount.sol#L3-L3) 


```solidity

File: contracts/interfaces/IPaymaster.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IPaymaster.sol#L3-L3) 


```solidity

File: contracts/libraries/TransactionHelper.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L3-L3) 


```solidity

File: contracts/bridge/L1SharedBridge.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L3-L3) 


```solidity

File: contracts/state-transition/StateTransitionManager.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L3-L3) 


```solidity

File: contracts/bridge/L2SharedBridge.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L3-L3) 


```solidity

File: contracts/interfaces/IPaymaster.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/interfaces/IPaymaster.sol#L3-L3) 


</details>


### [L&#x2011;40] Empty receive functions can cause gas issues 
In Solidity, functions that receive Ether without corresponding functionality to utilize or withdraw these funds can inadvertently lead to a permanent loss of value. This is because if someone sends Ether to the contract, they may be unable to retrieve it. To avoid this, functions receiving Ether should be accompanied by additional methods that process or allow the withdrawal of these funds. If the intent is to use the received Ether, it should trigger a separate function; if not, it should revert the transaction (for instance, via `require(msg.sender == address(weth))`). Access control checks can also prevent unintended Ether transfers, despite the slight gas cost they entail. If concerns over gas costs persist, at minimum, include a rescue function to recover unused Ether. Missteps in handling Ether in smart contracts can lead to irreversible financial losses, hence these precautions are crucial.


*There are 3 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/DefaultAccount.sol

227:     receive() external payable {
228:         // If the contract is called directly, behave like an EOA
229:     }


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/DefaultAccount.sol#L227-L229) 


```solidity

File: contracts/EmptyContract.sol

13:     receive() external payable {}


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/EmptyContract.sol#L13-L13) 


```solidity

File: contracts/governance/Governance.sol

262:     receive() external payable {}


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/Governance.sol#L262-L262) 


</details>


## Non-critical Issues

### [NC&#x2011;1] Consider using modifiers for address control 
Modifiers in Solidity can improve code readability and modularity by encapsulating repetitive checks, such as address validity checks, into a reusable construct. For example, an `onlyOwner` modifier can be used to replace repetitive `require(msg.sender == owner)` checks across several functions, reducing code redundancy and enhancing maintainability. To implement, define a modifier with the check, then apply the modifier to relevant functions.


*There are 15 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/ComplexUpgrader.sol

22:         require(msg.sender == FORCE_DEPLOYER, "Can only be called by FORCE_DEPLOYER");


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ComplexUpgrader.sol#L22-L22) 


```solidity

File: contracts/ContractDeployer.sol

240:             msg.sender == FORCE_DEPLOYER || msg.sender == address(COMPLEX_UPGRADER_CONTRACT),

240:             msg.sender == FORCE_DEPLOYER || msg.sender == address(COMPLEX_UPGRADER_CONTRACT),


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L240-L240) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L240-L240)


```solidity

File: contracts/ImmutableSimulator.sol

35:         require(msg.sender == address(DEPLOYER_SYSTEM_CONTRACT), "Callable only by the deployer system contract");


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ImmutableSimulator.sol#L35-L35) 


```solidity

File: contracts/L2BaseToken.sol

36:                 msg.sender == BOOTLOADER_FORMAL_ADDRESS,

34:             msg.sender == MSG_VALUE_SYSTEM_CONTRACT ||

35:                 msg.sender == address(DEPLOYER_SYSTEM_CONTRACT) ||


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L2BaseToken.sol#L36-L36) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L2BaseToken.sol#L34-L34), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L2BaseToken.sol#L35-L35)


```solidity

File: contracts/NonceHolder.sol

137:             msg.sender == address(DEPLOYER_SYSTEM_CONTRACT),


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/NonceHolder.sol#L137-L137) 


```solidity

File: contracts/bridge/L1ERC20Bridge.sol

64:         require(msg.sender == address(sharedBridge), "Not shared bridge");


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1ERC20Bridge.sol#L64-L64) 


```solidity

File: contracts/bridge/L1SharedBridge.sol

138:         require(bridgehub.getStateTransition(_chainId) == msg.sender, "receiveEth not state transition");


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L138-L138) 


```solidity

File: contracts/bridgehub/Bridgehub.sol

62:         require(msg.sender == currentPendingAdmin, "n42"); // Only proposed by current admin address can claim the admin rights

328:             _recipient = msg.sender == tx.origin ? msg.sender : AddressAliasHelper.applyL1ToL2Alias(msg.sender);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L62-L62) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L328-L328)


```solidity

File: contracts/state-transition/StateTransitionManager.sol

121:         require(msg.sender == currentPendingAdmin, "n42"); // Only proposed by current admin address can claim the admin rights


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L121-L121) 


```solidity

File: contracts/state-transition/chain-deps/facets/Admin.sol

34:         require(msg.sender == pendingAdmin, "n4"); // Only proposed by current admin address can claim the admin rights


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Admin.sol#L34-L34) 


```solidity

File: contracts/bridge/L2StandardERC20.sol

120:         require(msg.sender == UpgradeableBeacon(beaconAddress).owner(), "tt");


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2StandardERC20.sol#L120-L120) 


</details>


### [NC&#x2011;2] Large or complicated code bases should implement invariant tests 
Large code bases, or code with lots of inline-assembly, complicated math, or complicated interactions between multiple contracts, should implement [invariant fuzzing tests](https://medium.com/coinmonks/smart-contract-fuzzing-d9b88e0b0a05). Invariant fuzzers such as Echidna require the test writer to come up with invariants which should not be violated under any circumstances, and the fuzzer tests various inputs and function calls to ensure that the invariants always hold. Even code with 100% code coverage can still have bugs due to the order of the operations a user performs, and invariant fuzzers, with properly and extensively-written invariants, can close this testing gap significantly.


*There are 2 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/bridge/L1ERC20Bridge.sol

@audit Should implement invariant tests
1: 


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1ERC20Bridge.sol#L1-L1) 


```solidity

File: contracts/bridge/L2SharedBridge.sol

@audit Should implement invariant tests
1: 


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L1-L1) 


</details>


### [NC&#x2011;3] Assembly blocks should have extensive comments 
Assembly blocks are taking a lot more time to audit than normal Solidity code, and often have gotchas and side-effects that the Solidity versions of the same code do not. Consider adding more comments explaining what is being done in every step of the assembly code


*There are 71 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/AccountCodeStorage.sol

70:         assembly {

81:         assembly {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/AccountCodeStorage.sol#L70-L70) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/AccountCodeStorage.sol#L81-L81)


```solidity

File: contracts/ComplexUpgrader.sol

26:         assembly {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ComplexUpgrader.sol#L26-L26) 


```solidity

File: contracts/DefaultAccount.sol

168:         assembly {

31:             assembly {

49:             assembly {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/DefaultAccount.sol#L168-L168) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/DefaultAccount.sol#L31-L31), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/DefaultAccount.sol#L49-L49)


```solidity

File: contracts/KnownCodesStorage.sol

66:         assembly {

55:             assembly {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/KnownCodesStorage.sol#L66-L66) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/KnownCodesStorage.sol#L55-L55)


```solidity

File: contracts/MsgValueSimulator.sol

69:                 assembly {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/MsgValueSimulator.sol#L69-L69) 


```solidity

File: contracts/PubdataChunkPublisher.sol

30:         assembly {

46:             assembly {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/PubdataChunkPublisher.sol#L30-L30) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/PubdataChunkPublisher.sol#L46-L46)


```solidity

File: contracts/libraries/EfficientCall.sol

163:         assembly {

177:         assembly {

203:         assembly {

233:         assembly {

254:         assembly {

148:             assembly {

135:             assembly {

218:             assembly {

223:             assembly {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L163-L163) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L177-L177), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L203-L203), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L233-L233), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L254-L254), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L148-L148), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L135-L135), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L218-L218), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L223-L223)


```solidity

File: contracts/libraries/RLPEncoder.sol

16:         assembly {

39:                 assembly {

74:                 assembly {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/RLPEncoder.sol#L16-L16) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/RLPEncoder.sol#L39-L39), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/RLPEncoder.sol#L74-L74)


```solidity

File: contracts/libraries/SystemContractHelper.sol

50:         assembly {

65:         assembly {

76:         assembly {

87:         assembly {

97:         assembly {

109:         assembly {

158:         assembly {

171:         assembly {

183:         assembly {

193:         assembly {

205:         assembly {

298:         assembly {

309:         assembly {

322:         assembly {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L50-L50) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L65-L65), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L76-L76), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L87-L87), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L97-L97), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L109-L109), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L158-L158), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L171-L171), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L183-L183), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L193-L193), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L205-L205), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L298-L298), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L309-L309), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L322-L322)


```solidity

File: contracts/libraries/SystemContractsCaller.sol

80:         assembly {

132:         assembly {

137:         assembly {

109:             assembly {

100:             assembly {

160:             assembly {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractsCaller.sol#L80-L80) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractsCaller.sol#L132-L132), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractsCaller.sol#L137-L137), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractsCaller.sol#L109-L109), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractsCaller.sol#L100-L100), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractsCaller.sol#L160-L160)


```solidity

File: contracts/libraries/TransactionHelper.sol

399:         assembly {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L399-L399) 


```solidity

File: contracts/libraries/UnsafeBytesCalldata.sol

20:         assembly {

27:         assembly {

34:         assembly {

41:         assembly {

47:         assembly {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/UnsafeBytesCalldata.sol#L20-L20) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/UnsafeBytesCalldata.sol#L27-L27), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/UnsafeBytesCalldata.sol#L34-L34), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/UnsafeBytesCalldata.sol#L41-L41), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/UnsafeBytesCalldata.sol#L47-L47)


```solidity

File: contracts/bridge/L1SharedBridge.sol

357:             assembly {

446:             assembly {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L357-L357) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L446-L446)


```solidity

File: contracts/governance/Governance.sol

229:                 assembly {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/Governance.sol#L229-L229) 


```solidity

File: contracts/state-transition/ValidatorTimelock.sol

227:         assembly {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L227-L227) 


```solidity

File: contracts/state-transition/chain-deps/DiamondProxy.sol

33:         assembly {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/DiamondProxy.sol#L33-L33) 


```solidity

File: contracts/state-transition/chain-deps/facets/Mailbox.sol

360:             assembly {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L360-L360) 


```solidity

File: contracts/common/libraries/UnsafeBytes.sol

20:         assembly {

27:         assembly {

34:         assembly {

41:         assembly {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/UnsafeBytes.sol#L20-L20) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/UnsafeBytes.sol#L27-L27), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/UnsafeBytes.sol#L34-L34), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/UnsafeBytes.sol#L41-L41)


```solidity

File: contracts/state-transition/libraries/Diamond.sol

89:         assembly {

290:                 assembly {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L89-L89) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L290-L290)


```solidity

File: contracts/state-transition/libraries/Merkle.sol

41:         assembly {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Merkle.sol#L41-L41) 


```solidity

File: contracts/common/ReentrancyGuard.sol

52:         assembly {

70:         assembly {

78:         assembly {

86:         assembly {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/ReentrancyGuard.sol#L52-L52) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/ReentrancyGuard.sol#L70-L70), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/ReentrancyGuard.sol#L78-L78), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/ReentrancyGuard.sol#L86-L86)


```solidity

File: contracts/SystemContractsCaller.sol

41:         assembly {

85:         assembly {

90:         assembly {

70:             assembly {

61:             assembly {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/SystemContractsCaller.sol#L41-L41) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/SystemContractsCaller.sol#L85-L85), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/SystemContractsCaller.sol#L90-L90), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/SystemContractsCaller.sol#L70-L70), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/SystemContractsCaller.sol#L61-L61)


</details>


### [NC&#x2011;4] [NatSpec] Natspec `@author` is missing from `contract` 



*There are 25 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/interfaces/IAccount.sol

9: interface IAccount {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IAccount.sol#L9-L9) 


```solidity

File: contracts/interfaces/IAccountCodeStorage.sol

5: interface IAccountCodeStorage {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IAccountCodeStorage.sol#L5-L5) 


```solidity

File: contracts/interfaces/IBaseToken.sol

5: interface IBaseToken {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IBaseToken.sol#L5-L5) 


```solidity

File: contracts/interfaces/IBootloaderUtilities.sol

7: interface IBootloaderUtilities {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IBootloaderUtilities.sol#L7-L7) 


```solidity

File: contracts/interfaces/IContractDeployer.sol

5: interface IContractDeployer {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IContractDeployer.sol#L5-L5) 


```solidity

File: contracts/interfaces/IImmutableSimulator.sol

10: interface IImmutableSimulator {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IImmutableSimulator.sol#L10-L10) 


```solidity

File: contracts/interfaces/IL2StandardToken.sol

5: interface IL2StandardToken {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IL2StandardToken.sol#L5-L5) 


```solidity

File: contracts/interfaces/IMailbox.sol

5: interface IMailbox {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IMailbox.sol#L5-L5) 


```solidity

File: contracts/interfaces/IPaymaster.sol

14: interface IPaymaster {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IPaymaster.sol#L14-L14) 


```solidity

File: contracts/bridgehub/Bridgehub.sol

16: contract Bridgehub is IBridgehub, ReentrancyGuard, Ownable2Step {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L16-L16) 


```solidity

File: contracts/bridge/interfaces/IWETH9.sol

4: interface IWETH9 {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IWETH9.sol#L4-L4) 


```solidity

File: contracts/bridgehub/IBridgehub.sol

42: interface IBridgehub {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L42-L42) 


```solidity

File: contracts/state-transition/IStateTransitionManager.sol

26: interface IStateTransitionManager {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/IStateTransitionManager.sol#L26-L26) 


```solidity

File: contracts/state-transition/chain-interfaces/IDiamondInit.sol

61: interface IDiamondInit {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IDiamondInit.sol#L61-L61) 


```solidity

File: contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol

15: interface IZkSyncStateTransition is IAdmin, IExecutor, IGetters, IMailbox {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol#L15-L15) 


```solidity

File: contracts/state-transition/l2-deps/ISystemContext.sol

4: interface ISystemContext {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/l2-deps/ISystemContext.sol#L4-L4) 


```solidity

File: contracts/upgrades/IDefaultUpgrade.sol

7: interface IDefaultUpgrade {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/IDefaultUpgrade.sol#L7-L7) 


```solidity

File: contracts/common/ReentrancyGuard.sol

05: /**
06:  * @custom:security-contact security@matterlabs.dev
07:  * @dev Contract module that helps prevent reentrant calls to a function.
08:  *
09:  * Inheriting from `ReentrancyGuard` will make the {nonReentrant} modifier
10:  * available, which can be applied to functions to make sure there are no nested
11:  * (reentrant) calls to them.
12:  *
13:  * Note that because there is a single `nonReentrant` guard, functions marked as
14:  * `nonReentrant` may not call one another. This can be worked around by making
15:  * those functions `private`, and then adding `external` `nonReentrant` entry
16:  * points to them.
17:  *
18:  * TIP: If you would like to learn more about reentrancy and alternative ways
19:  * to protect against it, check out our blog post
20:  * https://blog.openzeppelin.com/reentrancy-after-istanbul/[Reentrancy After Istanbul].
21:  *
22:  * _Since v2.5.0:_ this module is now much more gas efficient, given net gas
23:  * metering changes introduced in the Istanbul hardfork.
24:  */


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/ReentrancyGuard.sol#L5-L24) 


```solidity

File: contracts/vendor/AddressAliasHelper.sol

21: library AddressAliasHelper {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/vendor/AddressAliasHelper.sol#L21-L21) 


```solidity

File: contracts/bridge/interfaces/IL2StandardToken.sol

5: interface IL2StandardToken {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL2StandardToken.sol#L5-L5) 


```solidity

File: contracts/interfaces/IPaymaster.sol

14: interface IPaymaster {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/interfaces/IPaymaster.sol#L14-L14) 


```solidity

File: contracts/vendor/AddressAliasHelper.sol

21: library AddressAliasHelper {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/vendor/AddressAliasHelper.sol#L21-L21) 


```solidity

File: contracts/ForceDeployUpgrader.sol

07: /// @custom:security-contact security@matterlabs.dev
08: /// @notice The contract that calls force deployment during the L2 system contract upgrade.
09: /// @notice It is supposed to be used as an implementation of the ComplexUpgrader.
10: contract ForceDeployUpgrader {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/ForceDeployUpgrader.sol#L7-L10) 


```solidity

File: contracts/SystemContractsCaller.sol

26: library Utils {

34: /// @notice The library contains the functions to make system calls.
35: /// @dev A more detailed description of the library and its methods can be found in the `system-contracts` repo.
36: library SystemContractsCaller {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/SystemContractsCaller.sol#L26-L26) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/SystemContractsCaller.sol#L34-L36)


</details>


### [NC&#x2011;5] Avoid the use of sensitive terms 
Use [alternative variants](https://www.zdnet.com/article/mysql-drops-master-slave-and-blacklist-whitelist-terminology/), e.g. allowlist/denylist instead of whitelist/blacklist


*There are 65 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/DefaultAccount.sol

206:     /// paid for by a paymaster.

212:     function prepareForPaymaster(

217:         _transaction.processPaymasterInput();


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/DefaultAccount.sol#L206-L206) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/DefaultAccount.sol#L212-L212), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/DefaultAccount.sol#L217-L217)


```solidity

File: contracts/libraries/TransactionHelper.sol

8: import "../interfaces/IPaymasterFlow.sol";

43:     // The transaction's paymaster. If there is no paymaster, it is equal to 0.

44:     uint256 paymaster;

66:     // The input to the paymaster.

67:     bytes paymasterInput;

86:             "Transaction(uint256 txType,uint256 from,uint256 to,uint256 gasLimit,uint256 gasPerPubdataByteLimit,uint256 maxFeePerGas,uint256 maxPriorityFeePerGas,uint256 paymaster,uint256 nonce,uint256 value,bytes data,bytes32[] factoryDeps,bytes paymasterInput)"

129:                 _transaction.paymaster,

134:                 EfficientCall.keccak(_transaction.paymasterInput)

359:     /// @notice Processes the common paymaster flows, e.g. setting proper allowance

361:     /// the "Paymaster flows" section in the documentation.

362:     function processPaymasterInput(Transaction calldata _transaction) internal {

363:         require(_transaction.paymasterInput.length >= 4, "The standard paymaster input must be at least 4 bytes long");

365:         bytes4 paymasterInputSelector = bytes4(_transaction.paymasterInput[0:4]);

366:         if (paymasterInputSelector == IPaymasterFlow.approvalBased.selector) {

368:                 _transaction.paymasterInput.length >= 68,

369:                 "The approvalBased paymaster input must be at least 68 bytes long"

373:             // the data is needed only for the paymaster, so we ignore it here for the sake of optimization

374:             (address token, uint256 minAllowance) = abi.decode(_transaction.paymasterInput[4:68], (address, uint256));

375:             address paymaster = address(uint160(_transaction.paymaster));

377:             uint256 currentAllowance = IERC20(token).allowance(address(this), paymaster);

382:                 IERC20(token).safeApprove(paymaster, 0);

383:                 IERC20(token).safeApprove(paymaster, minAllowance);

385:         } else if (paymasterInputSelector == IPaymasterFlow.general.selector) {

386:             // Do nothing. general(bytes) paymaster flow means that the paymaster must interpret these bytes on his own.

388:             revert("Unsupported paymaster flow");

406:         if (address(uint160(_transaction.paymaster)) != address(0)) {

407:             // Paymaster pays for the fee


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L8-L8) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L43-L43), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L44-L44), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L66-L66), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L67-L67), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L86-L86), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L129-L129), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L134-L134), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L359-L359), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L361-L361), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L362-L362), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L363-L363), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L365-L365), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L366-L366), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L368-L368), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L369-L369), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L373-L373), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L374-L374), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L375-L375), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L377-L377), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L382-L382), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L383-L383), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L385-L385), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L386-L386), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L388-L388), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L406-L406), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L407-L407)


```solidity

File: contracts/interfaces/IAccount.sol

42:     function prepareForPaymaster(


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IAccount.sol#L42-L42) 


```solidity

File: contracts/interfaces/IPaymaster.sol

12: bytes4 constant PAYMASTER_VALIDATION_SUCCESS_MAGIC = IPaymaster.validateAndPayForPaymasterTransaction.selector;

14: interface IPaymaster {

15:     /// @dev Called by the bootloader to verify that the paymaster agrees to pay for the

21:     /// @return magic The value that should be equal to the signature of the validateAndPayForPaymasterTransaction

22:     /// if the paymaster agrees to pay for the transaction.

28:     function validateAndPayForPaymasterTransaction(

37:     /// @param _context, the context of the execution, returned by the "validateAndPayForPaymasterTransaction" method.

40:     /// @param _maxRefundedGas, the upper bound on the amout of gas that could be refunded to the paymaster.


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IPaymaster.sol#L12-L12) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IPaymaster.sol#L14-L14), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IPaymaster.sol#L15-L15), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IPaymaster.sol#L21-L21), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IPaymaster.sol#L22-L22), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IPaymaster.sol#L28-L28), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IPaymaster.sol#L37-L37), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IPaymaster.sol#L40-L40)


```solidity

File: contracts/interfaces/IPaymasterFlow.sol

8:  * different types of paymaster flows.

12: interface IPaymasterFlow {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IPaymasterFlow.sol#L8-L8) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IPaymasterFlow.sol#L12-L12)


```solidity

File: contracts/state-transition/StateTransitionManager.sol

190:             paymaster: uint256(0),

198:             paymasterInput: new bytes(0),


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L190-L190) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L198-L198)


```solidity

File: contracts/state-transition/chain-deps/facets/Mailbox.sol

302:             paymaster: uint256(0),

310:             paymasterInput: new bytes(0),


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L302-L302) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L310-L310)


```solidity

File: contracts/state-transition/libraries/TransactionValidator.sol

50:         require(_transaction.paymaster == 0, "uc");

59:         require(_transaction.paymasterInput.length == 0, "ul1");


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/TransactionValidator.sol#L50-L50) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/TransactionValidator.sol#L59-L59)


```solidity

File: contracts/common/Messaging.sol

86: /// @param paymaster The address of the EIP-4337 paymaster, that will pay fees for the

96: /// @param paymasterInput The arbitrary-length data that is used as a calldata to the paymaster pre-call

106:     uint256 paymaster;

121:     bytes paymasterInput;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/Messaging.sol#L86-L86) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/Messaging.sol#L96-L96), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/Messaging.sol#L106-L106), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/Messaging.sol#L121-L121)


```solidity

File: contracts/interfaces/IPaymaster.sol

12: bytes4 constant PAYMASTER_VALIDATION_SUCCESS_MAGIC = IPaymaster.validateAndPayForPaymasterTransaction.selector;

14: interface IPaymaster {

15:     /// @dev Called by the bootloader to verify that the paymaster agrees to pay for the

21:     /// @return magic The value that should be equal to the signature of the validateAndPayForPaymasterTransaction

22:     /// if the paymaster agrees to pay for the transaction.

28:     function validateAndPayForPaymasterTransaction(

37:     /// @param _context, the context of the execution, returned by the "validateAndPayForPaymasterTransaction" method.

40:     /// @param _maxRefundedGas, the upper bound on the amout of gas that could be refunded to the paymaster.


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/interfaces/IPaymaster.sol#L12-L12) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/interfaces/IPaymaster.sol#L14-L14), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/interfaces/IPaymaster.sol#L15-L15), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/interfaces/IPaymaster.sol#L21-L21), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/interfaces/IPaymaster.sol#L22-L22), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/interfaces/IPaymaster.sol#L28-L28), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/interfaces/IPaymaster.sol#L37-L37), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/interfaces/IPaymaster.sol#L40-L40)


```solidity

File: contracts/interfaces/IPaymasterFlow.sol

9:  * different types of paymaster flows.

13: interface IPaymasterFlow {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/interfaces/IPaymasterFlow.sol#L9-L9) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/interfaces/IPaymasterFlow.sol#L13-L13)


```solidity

File: contracts/L2ContractHelper.sol

135:     // The transaction's paymaster. If there is no paymaster, it is equal to 0.

136:     uint256 paymaster;

158:     // The input to the paymaster.

159:     bytes paymasterInput;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/L2ContractHelper.sol#L135-L135) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/L2ContractHelper.sol#L136-L136), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/L2ContractHelper.sol#L158-L158), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/L2ContractHelper.sol#L159-L159)


</details>


### [NC&#x2011;6] Use bit shifts in an imutable variable rather than long bit masks of a single bit, for readability 



*There are 1 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/libraries/Utils.sol

17:     bytes32 constant SET_IS_CONSTRUCTOR_MARKER_BIT_MASK =
18:         0x0001000000000000000000000000000000000000000000000000000000000000;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L17-L18) 


</details>


### [NC&#x2011;7] Common functions should be refactored to a common base contract 
The functions below have the same implementation as is seen in other files. The functions should be refactored into functions of a common base contract


*There are 3 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/state-transition/StateTransitionManager.sol

//@audit this function is already seen in `contracts/state-transition/StateTransitionManager.sol`
110:     function setPendingAdmin(address _newPendingAdmin) external onlyOwnerOrAdmin {
111:         // Save previous value into the stack to put it into the event later
112:         address oldPendingAdmin = pendingAdmin;
113:         // Change pending admin
114:         pendingAdmin = _newPendingAdmin;
115:         emit NewPendingAdmin(oldPendingAdmin, _newPendingAdmin);
116:     }

//@audit this function is already seen in `contracts/state-transition/StateTransitionManager.sol`
119:     function acceptAdmin() external {
120:         address currentPendingAdmin = pendingAdmin;
121:         require(msg.sender == currentPendingAdmin, "n42"); // Only proposed by current admin address can claim the admin rights
122: 
123:         address previousAdmin = admin;
124:         admin = currentPendingAdmin;
125:         delete pendingAdmin;
126: 
127:         emit NewPendingAdmin(currentPendingAdmin, address(0));
128:         emit NewAdmin(previousAdmin, pendingAdmin);
129:     }


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L110-L116) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L119-L129)


```solidity

File: contracts/bridgehub/IBridgehub.sol

//@audit this function is already seen in `contracts/bridgehub/IBridgehub.sol`
67:     function sharedBridge() external view returns (IL1SharedBridge);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L67-L67) 


</details>


### [NC&#x2011;8] Overly complicated arithmetic 
To maintain readability in code, particularly in Solidity which can involve complex mathematical operations, it is often recommended to limit the number of arithmetic operations to a maximum of 2-3 per line. Too many operations in a single line can make the code difficult to read and understand, increase the likelihood of mistakes, and complicate the process of debugging and reviewing the code. Consider splitting such operations over more than one line, take special care when dealing with division however. Try to limit the number of arithmetic operations to a maximum of 3 per line.


*There are 2 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/L1Messenger.sol

62:         return SHA256_ROUND_GAS_COST * ((_length + 8) / SHA256_ROUND_NUMBER_OF_BYTES + 1);
63:     }

148:         uint256 gasToPay = keccakGasCost(L2_TO_L1_LOG_SERIALIZE_SIZE) +
149:             3 *
150:             keccakGasCost(64) +
151:             gasSpentOnMessageHashing +
152:             COMPUTATIONAL_PRICE_FOR_PUBDATA *
153:             pubdataLen;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L62-L63) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L148-L153)


</details>


### [NC&#x2011;9] Constant redefined elsewhere 
Consider defining in only one contract so that values cannot become out of sync when only one location is updated. A [cheap way](https://medium.com/coinmonks/gas-cost-of-solidity-library-functions-dbe0cedd4678) to store constants in a single location is to create an `internal constant` in a `library`. If the variable is a local cache of another contract's value, consider making the cache variable internal or private, which will require external users to query the contract with the source of truth, so that callers don't get out of sync.


*There are 5 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/state-transition/StateTransitionManager.sol

//@audit The same constant is already defined on file : contracts/bridge/L1SharedBridge.sol
27:     address public immutable bridgehub;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L27-L27) 


```solidity

File: contracts/state-transition/chain-deps/facets/Admin.sol

//@audit The same constant is already defined on file : contracts/state-transition/ValidatorTimelock.sol
20:     string public constant override getName = "AdminFacet";


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Admin.sol#L20-L20) 


```solidity

File: contracts/state-transition/chain-deps/facets/Executor.sol

//@audit The same constant is already defined on file : contracts/state-transition/ValidatorTimelock.sol
27:     string public constant override getName = "ExecutorFacet";


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L27-L27) 


```solidity

File: contracts/state-transition/chain-deps/facets/Getters.sol

//@audit The same constant is already defined on file : contracts/state-transition/ValidatorTimelock.sol
25:     string public constant override getName = "GettersFacet";


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L25-L25) 


```solidity

File: contracts/state-transition/chain-deps/facets/Mailbox.sol

//@audit The same constant is already defined on file : contracts/state-transition/ValidatorTimelock.sol
35:     string public constant override getName = "MailboxFacet";


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L35-L35) 


</details>


### [NC&#x2011;10] Constants in comparisons should appear on the left side 



*There are 160 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/AccountCodeStorage.sol

//@audit `0x00`
102:         if (codeHash == 0x00 && NONCE_HOLDER_SYSTEM_CONTRACT.getRawNonce(account) > 0) {

//@audit `0`
102:         if (codeHash == 0x00 && NONCE_HOLDER_SYSTEM_CONTRACT.getRawNonce(account) > 0) {

//@audit `0x00`
133:             codeHash != 0x00 &&


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/AccountCodeStorage.sol#L102-L102) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/AccountCodeStorage.sol#L102-L102), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/AccountCodeStorage.sol#L133-L133)


```solidity

File: contracts/BootloaderUtilities.sol

//@audit `1`
69:             if (txDataLen != 1) {

//@audit `0`
96:             if (_transaction.reserved[0] != 0) {

//@audit `0x80`
72:             } else if (_transaction.data[0] >= 0x80) {

//@audit `27`
92:             require(vInt == 27 || vInt == 28, "Invalid v value");

//@audit `28`
92:             require(vInt == 27 || vInt == 28, "Invalid v value");

//@audit `1`
165:             if (txDataLen != 1) {

//@audit `0x80`
168:             } else if (_transaction.data[0] >= 0x80) {

//@audit `27`
191:             require(vInt == 27 || vInt == 28, "Invalid v value");

//@audit `28`
191:             require(vInt == 27 || vInt == 28, "Invalid v value");

//@audit `1`
260:             if (txDataLen != 1) {

//@audit `0x80`
263:             } else if (_transaction.data[0] >= 0x80) {

//@audit `27`
286:             require(vInt == 27 || vInt == 28, "Invalid v value");

//@audit `28`
286:             require(vInt == 27 || vInt == 28, "Invalid v value");


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L69-L69) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L96-L96), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L72-L72), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L92-L92), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L92-L92), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L165-L165), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L168-L168), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L191-L191), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L191-L191), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L260-L260), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L263-L263), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L286-L286), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L286-L286)


```solidity

File: contracts/ComplexUpgrader.sol

//@audit `0`
24:         require(_delegateTo.code.length > 0, "Delegatee is an EOA");


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ComplexUpgrader.sol#L24-L24) 


```solidity

File: contracts/Compressor.sol

//@audit `0`
130:             if (enumIndex != 0) {

//@audit `0`
162:             if (enumIndex == 0) {

//@audit `0`
146:             uint8 len = operation == 0 ? 32 : metadata >> LENGTH_BITS_OFFSET;

//@audit `0`
177:             uint8 len = operation == 0 ? 32 : metadata >> LENGTH_BITS_OFFSET;

//@audit `0`
229:             if (_operation == 0 || _operation == 3) {

//@audit `3`
229:             if (_operation == 0 || _operation == 3) {

//@audit `1`
231:             } else if (_operation == 1) {

//@audit `2`
236:             } else if (_operation == 2) {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Compressor.sol#L130-L130) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Compressor.sol#L162-L162), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Compressor.sol#L146-L146), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Compressor.sol#L177-L177), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Compressor.sol#L229-L229), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Compressor.sol#L229-L229), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Compressor.sol#L231-L231), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Compressor.sol#L236-L236)


```solidity

File: contracts/ContractDeployer.sol

//@audit `0`
49:             ACCOUNT_CODE_STORAGE_SYSTEM_CONTRACT.getRawCodeHash(_address) == 0

//@audit `0x0`
269:             ACCOUNT_CODE_STORAGE_SYSTEM_CONTRACT.getCodeHash(uint256(uint160(_newAddress))) == 0x0,

//@audit `0x00`
273:         require(NONCE_HOLDER_SYSTEM_CONTRACT.getRawNonce(_newAddress) == 0x00, "Account is occupied");

//@audit `0`
303:         require(knownCodeMarker > 0, "The code hash is not known");

//@audit `0`
332:             if (value > 0) {

//@audit `0`
339:             if (value > 0) {

//@audit `0`
350:             require(value == 0, "The value must be zero if we do not call the constructor");


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L49-L49) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L269-L269), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L273-L273), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L303-L303), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L332-L332), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L339-L339), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L350-L350)


```solidity

File: contracts/DefaultAccount.sol

//@audit `4`
139:         if (to == address(DEPLOYER_SYSTEM_CONTRACT) && data.length >= 4) {

//@audit `65`
160:         require(_signature.length == 65, "Signature length is incorrect");

//@audit `0x7FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF5D576E7357A4501DDFE92F46681B20A0`
184:         require(uint256(s) <= 0x7FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF5D576E7357A4501DDFE92F46681B20A0, "Invalid s");

//@audit `27`
173:         require(v == 27 || v == 28, "v is neither 27 nor 28");

//@audit `28`
173:         require(v == 27 || v == 28, "v is neither 27 nor 28");


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/DefaultAccount.sol#L139-L139) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/DefaultAccount.sol#L160-L160), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/DefaultAccount.sol#L184-L184), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/DefaultAccount.sol#L173-L173), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/DefaultAccount.sol#L173-L173)


```solidity

File: contracts/KnownCodesStorage.sol

//@audit `0`
47:         if (getMarker(_bytecodeHash) == 0) {

//@audit `1`
78:         require(Utils.bytecodeLenInWords(_bytecodeHash) % 2 == 1, "Code length in words must be odd");

//@audit `1`
76:         require(version == 1 && _bytecodeHash[1] == bytes1(0), "Incorrectly formatted bytecodeHash");


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/KnownCodesStorage.sol#L47-L47) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/KnownCodesStorage.sol#L78-L78), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/KnownCodesStorage.sol#L76-L76)


```solidity

File: contracts/L1Messenger.sol

//@audit `1`
222:         while (nodesOnCurrentLevel > 1) {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L222-L222) 


```solidity

File: contracts/MsgValueSimulator.sol

//@audit `0`
30:         isSystemCall = (mask & MSG_VALUE_SIMULATOR_IS_SYSTEM_BIT) != 0;

//@audit `0`
62:         if (value != 0) {

//@audit `MSG_VALUE_SIMULATOR_STIPEND_GAS`
53:         uint256 userGas = gasInContext > MSG_VALUE_SIMULATOR_STIPEND_GAS


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/MsgValueSimulator.sol#L30-L30) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/MsgValueSimulator.sol#L62-L62), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/MsgValueSimulator.sol#L53-L53)


```solidity

File: contracts/NonceHolder.sol

//@audit `MAXIMAL_MIN_NONCE_INCREMENT`
66:         require(_value <= MAXIMAL_MIN_NONCE_INCREMENT, "The value for incrementing the nonce is too high");

//@audit `0`
85:         require(_value != 0, "Nonce value cannot be set to 0");

//@audit `0`
88:         if (accountInfo.nonceOrdering == IContractDeployer.AccountNonceOrdering.Sequential && _key != 0) {

//@audit `0`
156:         return (_nonce < getMinNonce(_address) || nonceValues[addressAsKey][_nonce] > 0);


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/NonceHolder.sol#L66-L66) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/NonceHolder.sol#L85-L85), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/NonceHolder.sol#L88-L88), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/NonceHolder.sol#L156-L156)


```solidity

File: contracts/SystemContext.sol

//@audit `256`
144:         if (blockNumber <= _block || blockNumber - _block > 256) {

//@audit `0`
152:             currentVirtualBlockUpgradeInfo.virtualBlockFinishL2Block > 0

//@audit `0`
245:         require(_l2BlockNumber > 0, "L2 block number is never expected to be zero");

//@audit `0`
268:         if (virtualBlockUpgradeInfo.virtualBlockFinishL2Block != 0) {

//@audit `0`
277:         if (currentVirtualL2BlockInfo.number == 0 && virtualBlockInfo.timestamp == 0) {

//@audit `0`
277:         if (currentVirtualL2BlockInfo.number == 0 && virtualBlockInfo.timestamp == 0) {

//@audit `0`
289:         } else if (_maxVirtualBlocksToCreate == 0) {

//@audit `0`
287:             require(_maxVirtualBlocksToCreate > 0, "Can't initialize the first virtual block");

//@audit `0`
360:         if (currentL2BlockNumber == 0 && currentL2BlockTimestamp == 0) {

//@audit `0`
360:         if (currentL2BlockNumber == 0 && currentL2BlockTimestamp == 0) {

//@audit `0`
355:             require(_maxVirtualBlocksToCreate > 0, "There must be a virtual block created at the start of the batch");

//@audit `0`
373:             require(_maxVirtualBlocksToCreate == 0, "Can not create virtual blocks in the middle of the miniblock");

//@audit `0`
413:         require(currentBatchNumber > 0, "The current batch number must be greater than 0");


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L144-L144) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L152-L152), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L245-L245), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L268-L268), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L277-L277), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L277-L277), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L289-L289), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L287-L287), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L360-L360), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L360-L360), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L355-L355), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L373-L373), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L413-L413)


```solidity

File: contracts/libraries/EfficientCall.sol

//@audit `32`
38:         require(returnData.length == 32, "keccak256 returned invalid data");

//@audit `32`
47:         require(returnData.length == 32, "sha returned invalid data");

//@audit `0`
131:         if (_value == 0) {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L38-L38) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L47-L47), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L131-L131)


```solidity

File: contracts/libraries/RLPEncoder.sol

//@audit `128`
26:             if (_val < 128) {

//@audit `0`
29:                 encoded[0] = (_val == 0) ? bytes1(uint8(128)) : bytes1(uint8(_val));

//@audit `1`
50:         assert(_len != 1);

//@audit `56`
62:             if (_len < 56) {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/RLPEncoder.sol#L26-L26) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/RLPEncoder.sol#L29-L29), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/RLPEncoder.sol#L50-L50), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/RLPEncoder.sol#L62-L62)


```solidity

File: contracts/libraries/SystemContractHelper.sol

//@audit `10`
319:         require(index < 10, "There are only 10 accessible registers");

//@audit `0`
332:         return (callFlags & 2) != 0;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L319-L319) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L332-L332)


```solidity

File: contracts/libraries/SystemContractsCaller.sol

//@audit `0`
98:         if (value == 0) {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractsCaller.sol#L98-L98) 


```solidity

File: contracts/libraries/TransactionHelper.sol

//@audit `0`
95:         return _addr == uint256(uint160(address(BASE_TOKEN_SYSTEM_CONTRACT))) || _addr == 0;

//@audit `LEGACY_TX_TYPE`
101:         if (_transaction.txType == LEGACY_TX_TYPE) {

//@audit `EIP_712_TX_TYPE`
103:         } else if (_transaction.txType == EIP_712_TX_TYPE) {

//@audit `EIP_1559_TX_TYPE`
105:         } else if (_transaction.txType == EIP_1559_TX_TYPE) {

//@audit `EIP_2930_TX_TYPE`
107:         } else if (_transaction.txType == EIP_2930_TX_TYPE) {

//@audit `0`
184:         if (_transaction.reserved[0] != 0) {

//@audit `1`
172:             if (txDataLen != 1) {

//@audit `0x80`
175:             } else if (_transaction.data[0] >= 0x80) {

//@audit `1`
250:             if (txDataLen != 1) {

//@audit `0x80`
253:             } else if (_transaction.data[0] >= 0x80) {

//@audit `1`
322:             if (txDataLen != 1) {

//@audit `0x80`
325:             } else if (_transaction.data[0] >= 0x80) {

//@audit `4`
363:         require(_transaction.paymasterInput.length >= 4, "The standard paymaster input must be at least 4 bytes long");

//@audit `68`
368:                 _transaction.paymasterInput.length >= 68,


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L95-L95) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L101-L101), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L103-L103), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L105-L105), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L107-L107), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L184-L184), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L172-L172), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L175-L175), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L250-L250), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L253-L253), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L322-L322), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L325-L325), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L363-L363), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L368-L368)


```solidity

File: contracts/libraries/Utils.sol

//@audit `0x00`
52:         return _bytecodeHash[1] == 0x00;

//@audit `0x01`
57:         return _bytecodeHash[1] == 0x01;

//@audit `0`
84:         require(_bytecode.length % 32 == 0, "po");

//@audit `1`
88:         require(lengthInWords % 2 == 1, "pr"); // bytecode length in words must be odd


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L52-L52) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L57-L57), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L84-L84), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L88-L88)


```solidity

File: contracts/bridge/L1ERC20Bridge.sol

//@audit `0`
141:         require(_amount != 0, "0T"); // empty deposit

//@audit `0`
186:         require(amount != 0, "2T"); // empty deposit


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1ERC20Bridge.sol#L141-L141) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1ERC20Bridge.sol#L186-L186)


```solidity

File: contracts/bridge/L1SharedBridge.sol

//@audit `0`
129:             require(amount > 0, "ShB: 0 amount to transfer");

//@audit `0`
158:             require(msg.value == 0, "ShB m.v > 0 b d.it");

//@audit `0`
208:         require(amount != 0, "6T"); // empty deposit amount

//@audit `0`
202:             require(msg.value == 0, "ShB m.v > 0 for BH d.it 2");

//@audit `0`
200:             require(_depositAmount == 0, "ShB wrong withdraw amount");

//@audit `0x00`
237:         require(depositHappened[_chainId][_txHash] == 0x00, "ShB tx hap");

//@audit `0`
327:         require(_amount > 0, "y1");

//@audit `56`
501:         require(_l2ToL1message.length >= 56, "ShB wrong msg len"); // wrong messsage length

//@audit `76`
517:             require(_l2ToL1message.length == 76, "ShB wrong msg len 2");


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L129-L129) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L158-L158), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L208-L208), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L202-L202), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L200-L200), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L237-L237), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L327-L327), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L501-L501), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L517-L517)


```solidity

File: contracts/bridgehub/Bridgehub.sol

//@audit `0`
122:         require(_chainId != 0, "Bridgehub: chainId cannot be 0");

//@audit `0`
225:                 require(msg.value == 0, "Bridgehub: non-eth bridge with msg.value");

//@audit `0`
329:         } else if (_refundRecipient.code.length > 0) {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L122-L122) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L225-L225), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L329-L329)


```solidity

File: contracts/governance/Governance.sol

//@audit `0`
107:         if (timestamp == 0) {

//@audit `EXECUTED_PROPOSAL_TIMESTAMP`
109:         } else if (timestamp == EXECUTED_PROPOSAL_TIMESTAMP) {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/Governance.sol#L107-L107) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/Governance.sol#L109-L109)


```solidity

File: contracts/state-transition/chain-deps/DiamondProxy.sol

//@audit `4`
25:         require(msg.data.length >= 4 || msg.data.length == 0, "Ut");

//@audit `0`
25:         require(msg.data.length >= 4 || msg.data.length == 0, "Ut");


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/DiamondProxy.sol#L25-L25) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/DiamondProxy.sol#L25-L25)


```solidity

File: contracts/state-transition/chain-deps/facets/Admin.sol

//@audit `0`
90:         require(s.totalBatchesCommitted == 0, "AdminFacet: set validium only after genesis"); // Validium mode can be set only before the first batch is committed


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Admin.sol#L90-L90) 


```solidity

File: contracts/state-transition/chain-deps/facets/Executor.sol

//@audit `0x00`
50:             require(logOutput.pubdataHash == 0x00, "v0h");

//@audit `1`
51:             require(_newBatch.pubdataCommitments.length == 1);

//@audit `1023`
194:             require(processedLogs == 1023, "b8");

//@audit `511`
192:             require(processedLogs == 511, "b7");

//@audit `1`
231:         require(_newBatchesData.length == 1, "e4");

//@audit `0`
237:         if (systemContractsUpgradeTxHash == bytes32(0) || s.l2SystemContractsUpgradeBatchNumber != 0) {

//@audit `0`
284:         require(s.l2SystemContractsUpgradeBatchNumber == 0, "ik");

//@audit `0`
291:             bytes32 expectedUpgradeTxHash = i == 0 ? _systemContractUpgradeTxHash : bytes32(0);

//@audit `0`
361:         if (batchWhenUpgradeHappened != 0 && batchWhenUpgradeHappened <= newTotalBatchesExecuted) {

//@audit `0`
429:         if (_proof.serializedProof.length > 0) {

//@audit `1`
426:         assert(block.chainid != 1);

//@audit `1`
442:         require(proofPublicInput.length == 1, "t4");

//@audit `0`
593:         return (_bitMap & (1 << _index)) > 0;

//@audit `0`
631:         require(_pubdataCommitments.length > 0, "pl");

//@audit `0`
633:         require(_pubdataCommitments.length % PUBDATA_COMMITMENT_SIZE == 0, "bs");


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L50-L50) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L51-L51), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L194-L194), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L192-L192), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L231-L231), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L237-L237), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L284-L284), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L291-L291), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L361-L361), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L429-L429), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L426-L426), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L442-L442), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L593-L593), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L631-L631), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L633-L633)


```solidity

File: contracts/state-transition/chain-deps/facets/Getters.sol

//@audit `0`
169:         if (selectorsArrayLen != 0) {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L169-L169) 


```solidity

File: contracts/state-transition/chain-deps/facets/Mailbox.sol

//@audit `0`
158:         require(s.baseTokenGasPriceMultiplierDenominator > 0, "Mailbox: baseTokenGasPriceDenominator not set");

//@audit `0`
277:         if (refundRecipient.code.length > 0) {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L158-L158) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L277-L277)


```solidity

File: contracts/upgrades/BaseZkSyncUpgrade.sol

//@audit `0`
186:         if (_l2ProtocolUpgradeTx.txType == 0) {

//@audit `0`
251:             s.l2SystemContractsUpgradeBatchNumber == 0,


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgrade.sol#L186-L186) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgrade.sol#L251-L251)


```solidity

File: contracts/upgrades/BaseZkSyncUpgradeGenesis.sol

//@audit `0`
35:             s.l2SystemContractsUpgradeBatchNumber == 0,


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L35-L35) 


```solidity

File: contracts/common/libraries/L2ContractHelper.sol

//@audit `0`
23:         require(_bytecode.length % 32 == 0, "pq");

//@audit `1`
27:         require(bytecodeLenInWords % 2 == 1, "ps"); // bytecode length in words must be odd

//@audit `1`
43:         require(bytecodeLen(_bytecodeHash) % 2 == 1, "uy"); // Code length in words must be odd

//@audit `1`
41:         require(version == 1 && _bytecodeHash[1] == bytes1(0), "zf"); // Incorrectly formatted bytecodeHash


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/L2ContractHelper.sol#L23-L23) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/L2ContractHelper.sol#L27-L27), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/L2ContractHelper.sol#L43-L43), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/L2ContractHelper.sol#L41-L41)


```solidity

File: contracts/state-transition/libraries/Diamond.sol

//@audit `0`
107:             require(selectors.length > 0, "B"); // no functions for diamond cut

//@audit `0`
132:         require(_facet.code.length > 0, "G");

//@audit `0`
155:         require(_facet.code.length > 0, "K");

//@audit `0`
194:         if (selectorsLength == 0) {

//@audit `0`
213:         if (selectorPosition != 0) {

//@audit `0`
250:         if (lastSelectorPosition == 0) {

//@audit `32`
297:             require(data.length == 32, "lp");

//@audit `DIAMOND_INIT_SUCCESS_RETURN_VALUE`
298:             require(abi.decode(data, (bytes32)) == DIAMOND_INIT_SUCCESS_RETURN_VALUE, "lp1");

//@audit `0`
280:             require(_calldata.length == 0, "H"); // Non-empty calldata for zero address

//@audit `4`
286:                 if (data.length <= 4) {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L107-L107) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L132-L132), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L155-L155), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L194-L194), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L213-L213), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L250-L250), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L297-L297), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L298-L298), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L280-L280), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L286-L286)


```solidity

File: contracts/state-transition/libraries/Merkle.sol

//@audit `0`
24:         require(pathLength > 0, "xc");

//@audit `256`
25:         require(pathLength < 256, "bt");

//@audit `0`
30:             currentHash = (_index % 2 == 0)


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Merkle.sol#L24-L24) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Merkle.sol#L25-L25), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Merkle.sol#L30-L30)


```solidity

File: contracts/state-transition/libraries/TransactionValidator.sol

//@audit `0`
50:         require(_transaction.paymaster == 0, "uc");

//@audit `0`
51:         require(_transaction.value == 0, "ud");

//@audit `0`
52:         require(_transaction.maxFeePerGas == 0, "uq");

//@audit `0`
53:         require(_transaction.maxPriorityFeePerGas == 0, "ux");

//@audit `0`
54:         require(_transaction.reserved[0] == 0, "ue");

//@audit `0`
56:         require(_transaction.reserved[2] == 0, "ug");

//@audit `0`
57:         require(_transaction.reserved[3] == 0, "uo");

//@audit `0`
58:         require(_transaction.signature.length == 0, "uh");

//@audit `0`
59:         require(_transaction.paymasterInput.length == 0, "ul1");

//@audit `0`
60:         require(_transaction.reservedDynamic.length == 0, "um");


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/TransactionValidator.sol#L50-L50) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/TransactionValidator.sol#L51-L51), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/TransactionValidator.sol#L52-L52), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/TransactionValidator.sol#L53-L53), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/TransactionValidator.sol#L54-L54), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/TransactionValidator.sol#L56-L56), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/TransactionValidator.sol#L57-L57), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/TransactionValidator.sol#L58-L58), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/TransactionValidator.sol#L59-L59), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/TransactionValidator.sol#L60-L60)


```solidity

File: contracts/common/ReentrancyGuard.sol

//@audit `0`
58:         require(lockSlotOldValue == 0, "1B");


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/ReentrancyGuard.sol#L58-L58) 


```solidity

File: contracts/bridge/L2SharedBridge.sol

//@audit `0`
92:         require(msg.value == 0, "Value should be 0 for ERC20 bridge");

//@audit `0`
124:         require(_amount > 0, "Amount cannot be zero");


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L92-L92) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L124-L124)


```solidity

File: contracts/SystemContractsCaller.sol

//@audit `0`
59:         if (value == 0) {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/SystemContractsCaller.sol#L59-L59) 


</details>


### [NC&#x2011;11] `const` Variable names don\'t follow the Solidity style guide 
For `constant` variable names, each word should use all capital letters, with underscores separating each word (CONSTANT_CASE)


*There are 7 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/state-transition/ValidatorTimelock.sol

26:     string public constant override getName = "ValidatorTimelock";


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L26-L26) 


```solidity

File: contracts/state-transition/chain-deps/facets/Admin.sol

20:     string public constant override getName = "AdminFacet";


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Admin.sol#L20-L20) 


```solidity

File: contracts/state-transition/chain-deps/facets/Executor.sol

27:     string public constant override getName = "ExecutorFacet";


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L27-L27) 


```solidity

File: contracts/state-transition/chain-deps/facets/Getters.sol

25:     string public constant override getName = "GettersFacet";


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L25-L25) 


```solidity

File: contracts/state-transition/chain-deps/facets/Mailbox.sol

35:     string public constant override getName = "MailboxFacet";


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L35-L35) 


```solidity

File: contracts/vendor/AddressAliasHelper.sol

22:     uint160 constant offset = uint160(0x1111000000000000000000000000000000001111);

22:     uint160 constant offset = uint160(0x1111000000000000000000000000000000001111);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/vendor/AddressAliasHelper.sol#L22-L22) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/vendor/AddressAliasHelper.sol#L22-L22)


</details>


### [NC&#x2011;12] [NatSpec] Natspec description is missing from `contract` 
It is recommended that Solidity contracts are fully annotated using NatSpec for all public interfaces (everything in the ABI). It is clearly stated in the Solidity official documentation. In complex projects such as Defi, the interpretation of all functions and their arguments and returns is important for code readability and auditability.[source](https://docs.soliditylang.org/en/v0.8.15/natspec-format.html)


*There are 287 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/AccountCodeStorage.sol

23:     bytes32 constant EMPTY_STRING_KECCAK = 0xc5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470;

25:     modifier onlyDeployer() {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/AccountCodeStorage.sol#L23-L23) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/AccountCodeStorage.sol#L25-L25)


```solidity

File: contracts/ContractDeployer.sol

28:     modifier onlySelf() {

258:     function _nonSystemDeployOnAddress(


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L28-L28) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L258-L258)


```solidity

File: contracts/DefaultAccount.sol

220:     fallback() external payable ignoreInDelegateCall {

227:     receive() external payable {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/DefaultAccount.sol#L220-L220) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/DefaultAccount.sol#L227-L227)


```solidity

File: contracts/EmptyContract.sol

11:     fallback() external payable {}

13:     receive() external payable {}


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/EmptyContract.sol#L11-L11) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/EmptyContract.sol#L13-L13)


```solidity

File: contracts/KnownCodesStorage.sol

19:     modifier onlyCompressor() {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/KnownCodesStorage.sol#L19-L19) 


```solidity

File: contracts/NonceHolder.sol

28:     uint256 private constant DEPLOY_NONCE_MULTIPLIER = 2 ** 128;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/NonceHolder.sol#L28-L28) 


```solidity

File: contracts/SystemContext.sol

117:     function getCurrentPubdataSpent() public view returns (uint256) {

122:     function getCurrentPubdataCost() external view returns (uint256) {

482:     function incrementTxNumberInBatch() external onlyCallFromBootloader {

486:     function resetTxNumberInBatch() external onlyCallFromBootloader {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L117-L117) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L122-L122), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L482-L482), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L486-L486)


```solidity

File: contracts/libraries/RLPEncoder.sol

11:     function encodeAddress(address _val) internal pure returns (bytes memory encoded) {

24:     function encodeUint256(uint256 _val) internal pure returns (bytes memory encoded) {

60:     function _encodeLength(uint64 _len, uint256 _offset) private pure returns (bytes memory encoded) {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/RLPEncoder.sol#L11-L11) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/RLPEncoder.sol#L24-L24), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/RLPEncoder.sol#L60-L60)


```solidity

File: contracts/libraries/TransactionHelper.sol

84:     bytes32 constant EIP712_TRANSACTION_TYPE_HASH =

405:     function totalRequiredBalance(Transaction calldata _transaction) internal pure returns (uint256 requiredBalance) {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L84-L84) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L405-L405)


```solidity

File: contracts/libraries/UnsafeBytesCalldata.sol

19:     function readUint16(bytes calldata _bytes, uint256 _start) internal pure returns (uint16 result) {

26:     function readUint32(bytes calldata _bytes, uint256 _start) internal pure returns (uint32 result) {

33:     function readUint64(bytes calldata _bytes, uint256 _start) internal pure returns (uint64 result) {

40:     function readBytes32(bytes calldata _bytes, uint256 _start) internal pure returns (bytes32 result) {

46:     function readUint256(bytes calldata _bytes, uint256 _start) internal pure returns (uint256 result) {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/UnsafeBytesCalldata.sol#L19-L19) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/UnsafeBytesCalldata.sol#L26-L26), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/UnsafeBytesCalldata.sol#L33-L33), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/UnsafeBytesCalldata.sol#L40-L40), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/UnsafeBytesCalldata.sol#L46-L46)


```solidity

File: contracts/libraries/Utils.sol

20:     function safeCastToU128(uint256 _x) internal pure returns (uint128) {

26:     function safeCastToU32(uint256 _x) internal pure returns (uint32) {

32:     function safeCastToU24(uint256 _x) internal pure returns (uint24) {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L20-L20) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L26-L26), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L32-L32)


```solidity

File: contracts/interfaces/IAccount.sol

9: interface IAccount {

26:     function executeTransaction(

34:     function executeTransactionFromOutside(Transaction calldata _transaction) external payable;

36:     function payForTransaction(

42:     function prepareForPaymaster(


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IAccount.sol#L9-L9) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IAccount.sol#L26-L26), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IAccount.sol#L34-L34), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IAccount.sol#L36-L36), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IAccount.sol#L42-L42)


```solidity

File: contracts/interfaces/IAccountCodeStorage.sol

5: interface IAccountCodeStorage {

6:     function storeAccountConstructingCodeHash(address _address, bytes32 _hash) external;

8:     function storeAccountConstructedCodeHash(address _address, bytes32 _hash) external;

10:     function markAccountCodeHashAsConstructed(address _address) external;

12:     function getRawCodeHash(address _address) external view returns (bytes32 codeHash);

14:     function getCodeHash(uint256 _input) external view returns (bytes32 codeHash);

16:     function getCodeSize(uint256 _input) external view returns (uint256 codeSize);


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IAccountCodeStorage.sol#L5-L5) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IAccountCodeStorage.sol#L6-L6), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IAccountCodeStorage.sol#L8-L8), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IAccountCodeStorage.sol#L10-L10), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IAccountCodeStorage.sol#L12-L12), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IAccountCodeStorage.sol#L14-L14), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IAccountCodeStorage.sol#L16-L16)


```solidity

File: contracts/interfaces/IBaseToken.sol

5: interface IBaseToken {

6:     function balanceOf(uint256) external view returns (uint256);

8:     function transferFromTo(address _from, address _to, uint256 _amount) external;

10:     function totalSupply() external view returns (uint256);

12:     function name() external pure returns (string memory);

14:     function symbol() external pure returns (string memory);

16:     function decimals() external pure returns (uint8);

18:     function mint(address _account, uint256 _amount) external;

20:     function withdraw(address _l1Receiver) external payable;

22:     function withdrawWithMessage(address _l1Receiver, bytes calldata _additionalData) external payable;

24:     event Mint(address indexed account, uint256 amount);

26:     event Transfer(address indexed from, address indexed to, uint256 value);

28:     event Withdrawal(address indexed _l2Sender, address indexed _l1Receiver, uint256 _amount);

30:     event WithdrawalWithMessage(


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IBaseToken.sol#L5-L5) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IBaseToken.sol#L6-L6), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IBaseToken.sol#L8-L8), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IBaseToken.sol#L10-L10), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IBaseToken.sol#L12-L12), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IBaseToken.sol#L14-L14), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IBaseToken.sol#L16-L16), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IBaseToken.sol#L18-L18), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IBaseToken.sol#L20-L20), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IBaseToken.sol#L22-L22), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IBaseToken.sol#L24-L24), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IBaseToken.sol#L26-L26), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IBaseToken.sol#L28-L28), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IBaseToken.sol#L30-L30)


```solidity

File: contracts/interfaces/IBootloaderUtilities.sol

7: interface IBootloaderUtilities {

8:     function getTransactionHashes(


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IBootloaderUtilities.sol#L7-L7) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IBootloaderUtilities.sol#L8-L8)


```solidity

File: contracts/interfaces/IComplexUpgrader.sol

11:     function upgrade(address _delegateTo, bytes calldata _calldata) external payable;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IComplexUpgrader.sol#L11-L11) 


```solidity

File: contracts/interfaces/ICompressor.sol

19:     function publishCompressedBytecode(

24:     function verifyCompressedStateDiffs(


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ICompressor.sol#L19-L19) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ICompressor.sol#L24-L24)


```solidity

File: contracts/interfaces/IContractDeployer.sol

5: interface IContractDeployer {

33:     event ContractDeployed(

39:     event AccountNonceOrderingUpdated(address indexed accountAddress, AccountNonceOrdering nonceOrdering);

41:     event AccountVersionUpdated(address indexed accountAddress, AccountAbstractionVersion aaVersion);

43:     function getNewAddressCreate2(

50:     function getNewAddressCreate(address _sender, uint256 _senderNonce) external pure returns (address newAddress);

52:     function create2(

58:     function create2Account(


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IContractDeployer.sol#L5-L5) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IContractDeployer.sol#L33-L33), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IContractDeployer.sol#L39-L39), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IContractDeployer.sol#L41-L41), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IContractDeployer.sol#L43-L43), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IContractDeployer.sol#L50-L50), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IContractDeployer.sol#L52-L52), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IContractDeployer.sol#L58-L58)


```solidity

File: contracts/interfaces/IImmutableSimulator.sol

10: interface IImmutableSimulator {

11:     function getImmutable(address _dest, uint256 _index) external view returns (bytes32);

13:     function setImmutables(address _dest, ImmutableData[] calldata _immutables) external;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IImmutableSimulator.sol#L10-L10) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IImmutableSimulator.sol#L11-L11), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IImmutableSimulator.sol#L13-L13)


```solidity

File: contracts/interfaces/IKnownCodesStorage.sol

12:     event MarkedAsKnown(bytes32 indexed bytecodeHash, bool indexed sendBytecodeToL1);

14:     function markFactoryDeps(bool _shouldSendToL1, bytes32[] calldata _hashes) external;

16:     function markBytecodeAsPublished(bytes32 _bytecodeHash) external;

18:     function getMarker(bytes32 _hash) external view returns (uint256);


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IKnownCodesStorage.sol#L12-L12) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IKnownCodesStorage.sol#L14-L14), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IKnownCodesStorage.sol#L16-L16), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IKnownCodesStorage.sol#L18-L18)


```solidity

File: contracts/interfaces/IL1Messenger.sol

43:     event L1MessageSent(address indexed _sender, bytes32 indexed _hash, bytes _message);

45:     event L2ToL1LogSent(L2ToL1Log _l2log);

47:     event BytecodeL1PublicationRequested(bytes32 _bytecodeHash);

49:     function sendToL1(bytes memory _message) external returns (bytes32);

51:     function sendL2ToL1Log(bool _isService, bytes32 _key, bytes32 _value) external returns (uint256 logIdInMerkleTree);

54:     function requestBytecodeL1Publication(bytes32 _bytecodeHash) external;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IL1Messenger.sol#L43-L43) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IL1Messenger.sol#L45-L45), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IL1Messenger.sol#L47-L47), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IL1Messenger.sol#L49-L49), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IL1Messenger.sol#L51-L51), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IL1Messenger.sol#L54-L54)


```solidity

File: contracts/interfaces/IL2StandardToken.sol

5: interface IL2StandardToken {

6:     event BridgeMint(address indexed _account, uint256 _amount);

8:     event BridgeBurn(address indexed _account, uint256 _amount);

10:     function bridgeMint(address _account, uint256 _amount) external;

12:     function bridgeBurn(address _account, uint256 _amount) external;

14:     function l1Address() external view returns (address);

16:     function l2Bridge() external view returns (address);


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IL2StandardToken.sol#L5-L5) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IL2StandardToken.sol#L6-L6), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IL2StandardToken.sol#L8-L8), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IL2StandardToken.sol#L10-L10), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IL2StandardToken.sol#L12-L12), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IL2StandardToken.sol#L14-L14), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IL2StandardToken.sol#L16-L16)


```solidity

File: contracts/interfaces/IMailbox.sol

5: interface IMailbox {

6:     function finalizeEthWithdrawal(


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IMailbox.sol#L5-L5) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IMailbox.sol#L6-L6)


```solidity

File: contracts/interfaces/INonceHolder.sol

14:     event ValueSetUnderNonce(address indexed accountAddress, uint256 indexed key, uint256 value);


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/INonceHolder.sol#L14-L14) 


```solidity

File: contracts/interfaces/IPaymaster.sol

14: interface IPaymaster {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IPaymaster.sol#L14-L14) 


```solidity

File: contracts/interfaces/IPaymasterFlow.sol

13:     function general(bytes calldata input) external;

15:     function approvalBased(address _token, uint256 _minAllowance, bytes calldata _innerInput) external;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IPaymasterFlow.sol#L13-L13) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IPaymasterFlow.sol#L15-L15)


```solidity

File: contracts/interfaces/ISystemContext.sol

30:     function chainId() external view returns (uint256);

32:     function origin() external view returns (address);

34:     function gasPrice() external view returns (uint256);

36:     function blockGasLimit() external view returns (uint256);

38:     function coinbase() external view returns (address);

40:     function difficulty() external view returns (uint256);

42:     function baseFee() external view returns (uint256);

44:     function txNumberInBlock() external view returns (uint16);

46:     function getBlockHashEVM(uint256 _block) external view returns (bytes32);

48:     function getBatchHash(uint256 _batchNumber) external view returns (bytes32 hash);

50:     function getBlockNumber() external view returns (uint128);

52:     function getBlockTimestamp() external view returns (uint128);

54:     function getBatchNumberAndTimestamp() external view returns (uint128 blockNumber, uint128 blockTimestamp);

56:     function getL2BlockNumberAndTimestamp() external view returns (uint128 blockNumber, uint128 blockTimestamp);

58:     function gasPerPubdataByte() external view returns (uint256 gasPerPubdataByte);

60:     function getCurrentPubdataSpent() external view returns (uint256 currentPubdataSpent);


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ISystemContext.sol#L30-L30) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ISystemContext.sol#L32-L32), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ISystemContext.sol#L34-L34), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ISystemContext.sol#L36-L36), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ISystemContext.sol#L38-L38), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ISystemContext.sol#L40-L40), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ISystemContext.sol#L42-L42), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ISystemContext.sol#L44-L44), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ISystemContext.sol#L46-L46), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ISystemContext.sol#L48-L48), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ISystemContext.sol#L50-L50), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ISystemContext.sol#L52-L52), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ISystemContext.sol#L54-L54), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ISystemContext.sol#L56-L56), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ISystemContext.sol#L58-L58), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ISystemContext.sol#L60-L60)


```solidity

File: contracts/interfaces/ISystemContextDeprecated.sol

11:     function currentBlockInfo() external view returns (uint256);

13:     function getBlockNumberAndTimestamp() external view returns (uint256 blockNumber, uint256 blockTimestamp);

15:     function blockHash(uint256 _blockNumber) external view returns (bytes32 hash);


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ISystemContextDeprecated.sol#L11-L11) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ISystemContextDeprecated.sol#L13-L13), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ISystemContextDeprecated.sol#L15-L15)


```solidity

File: contracts/bridge/L1SharedBridge.sol

137:     function receiveEth(uint256 _chainId) external payable {

487:     function _parseL2WithdrawalMessage(


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L137-L137) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L487-L487)


```solidity

File: contracts/bridgehub/Bridgehub.sol

16: contract Bridgehub is IBridgehub, ReentrancyGuard, Ownable2Step {

45:     modifier onlyOwnerOrAdmin() {

325:     function _actualRefundRecipient(address _refundRecipient) internal view returns (address _recipient) {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L16-L16) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L45-L45), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L325-L325)


```solidity

File: contracts/state-transition/StateTransitionManager.sol

74:     function getChainAdmin(uint256 _chainId) external view override returns (address) {

230:     function registerAlreadyDeployedStateTransition(


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L74-L74) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L230-L230)


```solidity

File: contracts/state-transition/ValidatorTimelock.sol

55:     constructor(address _initialOwner, uint32 _executionDelay) {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L55-L55) 


```solidity

File: contracts/state-transition/chain-deps/DiamondProxy.sol

11:     constructor(uint256 _chainId, Diamond.DiamondCutData memory _diamondCut) {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/DiamondProxy.sol#L11-L11) 


```solidity

File: contracts/state-transition/chain-deps/facets/Admin.sol

89:     function setValidiumMode(PubdataPricingMode _validiumMode) external onlyAdmin {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Admin.sol#L89-L89) 


```solidity

File: contracts/state-transition/chain-deps/facets/Executor.sol

215:     function _commitBatches(

349:     function _executeBatches(StoredBatchInfo[] calldata _batchesData) internal {

386:     function _proveBatches(

440:     function _verifyProof(uint256[] memory proofPublicInput, ProofInput calldata _proof) internal view {

481:     function _revertBatches(uint256 _newLastBatch) internal {

515:     function _batchPassThroughData(CommitBatchInfo calldata _batch) internal pure returns (bytes memory) {

525:     function _batchMetaParameters() internal view returns (bytes memory) {

537:     function _batchAuxiliaryOutput(


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L215-L215) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L349-L349), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L386-L386), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L440-L440), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L481-L481), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L515-L515), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L525-L525), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L537-L537)


```solidity

File: contracts/state-transition/chain-deps/facets/Mailbox.sol

228:     function _requestL2TransactionSender(

258:     function _requestL2Transaction(

289:     function _serializeL2Transaction(


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L228-L228) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L258-L258), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L289-L289)


```solidity

File: contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol

12:     ZkSyncStateTransitionStorage internal s;

26:     modifier onlyStateTransitionManager() {

31:     modifier onlyBridgehub() {

36:     modifier onlyAdminOrStateTransitionManager() {

44:     modifier onlyValidatorOrStateTransitionManager() {

52:     modifier onlyBaseTokenBridge() {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L12-L12) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L26-L26), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L31-L31), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L36-L36), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L44-L44), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L52-L52)


```solidity

File: contracts/common/libraries/UncheckedMath.sol

11:     function uncheckedInc(uint256 _number) internal pure returns (uint256) {

17:     function uncheckedAdd(uint256 _lhs, uint256 _rhs) internal pure returns (uint256) {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/UncheckedMath.sol#L11-L11) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/UncheckedMath.sol#L17-L17)


```solidity

File: contracts/common/libraries/UnsafeBytes.sol

19:     function readUint32(bytes memory _bytes, uint256 _start) internal pure returns (uint32 result, uint256 offset) {

26:     function readAddress(bytes memory _bytes, uint256 _start) internal pure returns (address result, uint256 offset) {

33:     function readUint256(bytes memory _bytes, uint256 _start) internal pure returns (uint256 result, uint256 offset) {

40:     function readBytes32(bytes memory _bytes, uint256 _start) internal pure returns (bytes32 result, uint256 offset) {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/UnsafeBytes.sol#L19-L19) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/UnsafeBytes.sol#L26-L26), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/UnsafeBytes.sol#L33-L33), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/UnsafeBytes.sol#L40-L40)


```solidity

File: contracts/state-transition/libraries/Diamond.sol

24:     event DiamondCut(FacetCut[] facetCuts, address initAddress, bytes initCalldata);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L24-L24) 


```solidity

File: contracts/bridge/interfaces/IL1ERC20Bridge.sol

12:     event DepositInitiated(

20:     event WithdrawalFinalized(address indexed to, address indexed l1Token, uint256 amount);

22:     event ClaimedFailedDeposit(address indexed to, address indexed l1Token, uint256 amount);

24:     function isWithdrawalFinalized(uint256 _l2BatchNumber, uint256 _l2MessageIndex) external view returns (bool);

26:     function deposit(

35:     function deposit(

43:     function claimFailedDeposit(

53:     function finalizeWithdrawal(

61:     function l2TokenAddress(address _l1Token) external view returns (address);

63:     function sharedBridge() external view returns (IL1SharedBridge);

65:     function l2TokenBeacon() external view returns (address);

67:     function l2Bridge() external view returns (address);

69:     function depositAmount(

75:     function tranferTokenToSharedBridge(address _token, uint256 _amount) external;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1ERC20Bridge.sol#L12-L12) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1ERC20Bridge.sol#L20-L20), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1ERC20Bridge.sol#L22-L22), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1ERC20Bridge.sol#L24-L24), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1ERC20Bridge.sol#L26-L26), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1ERC20Bridge.sol#L35-L35), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1ERC20Bridge.sol#L43-L43), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1ERC20Bridge.sol#L53-L53), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1ERC20Bridge.sol#L61-L61), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1ERC20Bridge.sol#L63-L63), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1ERC20Bridge.sol#L65-L65), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1ERC20Bridge.sol#L67-L67), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1ERC20Bridge.sol#L69-L69), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1ERC20Bridge.sol#L75-L75)


```solidity

File: contracts/bridge/interfaces/IL1SharedBridge.sol

13:     event LegacyDepositInitiated(

22:     event BridgehubDepositInitiated(

31:     event BridgehubDepositBaseTokenInitiated(

38:     event BridgehubDepositFinalized(

44:     event WithdrawalFinalizedSharedBridge(

51:     event ClaimedFailedDepositSharedBridge(

58:     function isWithdrawalFinalized(

64:     function depositLegacyErc20Bridge(

74:     function claimFailedDepositLegacyErc20Bridge(

85:     function claimFailedDeposit(

97:     function finalizeWithdrawalLegacyErc20Bridge(

105:     function finalizeWithdrawal(

114:     function l1WethAddress() external view returns (address);

116:     function bridgehub() external view returns (IBridgehub);

118:     function legacyBridge() external view returns (IL1ERC20Bridge);

120:     function l2BridgeAddress(uint256 _chainId) external view returns (address);

122:     function depositHappened(uint256 _chainId, bytes32 _l2TxHash) external view returns (bytes32);

135:     function bridgehubDepositBaseToken(

142:     function bridgehubConfirmL2Transaction(uint256 _chainId, bytes32 _txDataHash, bytes32 _txHash) external;

144:     function receiveEth(uint256 _chainId) external payable;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L13-L13) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L22-L22), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L31-L31), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L38-L38), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L44-L44), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L51-L51), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L58-L58), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L64-L64), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L74-L74), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L85-L85), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L97-L97), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L105-L105), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L114-L114), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L116-L116), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L118-L118), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L120-L120), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L122-L122), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L135-L135), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L142-L142), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L144-L144)


```solidity

File: contracts/bridge/interfaces/IL2Bridge.sol

7:     function finalizeDeposit(

15:     function withdraw(address _l1Receiver, address _l2Token, uint256 _amount) external;

17:     function l1TokenAddress(address _l2Token) external view returns (address);

19:     function l2TokenAddress(address _l1Token) external view returns (address);

21:     function l1Bridge() external view returns (address);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL2Bridge.sol#L7-L7) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL2Bridge.sol#L15-L15), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL2Bridge.sol#L17-L17), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL2Bridge.sol#L19-L19), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL2Bridge.sol#L21-L21)


```solidity

File: contracts/bridge/interfaces/IWETH9.sol

4: interface IWETH9 {

5:     function deposit() external payable;

7:     function withdraw(uint256 wad) external;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IWETH9.sol#L4-L4) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IWETH9.sol#L5-L5), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IWETH9.sol#L7-L7)


```solidity

File: contracts/bridgehub/IBridgehub.sol

42: interface IBridgehub {

61:     function stateTransitionManager(uint256 _chainId) external view returns (address);

63:     function tokenIsRegistered(address _baseToken) external view returns (bool);

65:     function baseToken(uint256 _chainId) external view returns (address);

67:     function sharedBridge() external view returns (IL1SharedBridge);

69:     function getStateTransition(uint256 _chainId) external view returns (address);

81:     function proveL2LogInclusion(

89:     function proveL1ToL2TransactionStatus(

99:     function requestL2TransactionDirect(

103:     function requestL2TransactionTwoBridges(

107:     function l2TransactionBaseCost(

116:     function createNewChain(

125:     function addStateTransitionManager(address _stateTransitionManager) external;

127:     function removeStateTransitionManager(address _stateTransitionManager) external;

129:     function addToken(address _token) external;

131:     function setSharedBridge(address _sharedBridge) external;

133:     event NewChain(uint256 indexed chainId, address stateTransitionManager, address indexed chainGovernance);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L42-L42) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L61-L61), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L63-L63), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L65-L65), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L67-L67), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L69-L69), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L81-L81), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L89-L89), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L99-L99), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L103-L103), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L107-L107), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L116-L116), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L125-L125), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L127-L127), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L129-L129), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L131-L131), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L133-L133)


```solidity

File: contracts/governance/IGovernance.sol

41:     function isOperation(bytes32 _id) external view returns (bool);

43:     function isOperationPending(bytes32 _id) external view returns (bool);

45:     function isOperationReady(bytes32 _id) external view returns (bool);

47:     function isOperationDone(bytes32 _id) external view returns (bool);

49:     function getOperationState(bytes32 _id) external view returns (OperationState);

51:     function scheduleTransparent(Operation calldata _operation, uint256 _delay) external;

53:     function scheduleShadow(bytes32 _id, uint256 _delay) external;

55:     function cancel(bytes32 _id) external;

57:     function execute(Operation calldata _operation) external payable;

59:     function executeInstant(Operation calldata _operation) external payable;

61:     function hashOperation(Operation calldata _operation) external pure returns (bytes32);

63:     function updateDelay(uint256 _newDelay) external;

65:     function updateSecurityCouncil(address _newSecurityCouncil) external;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/IGovernance.sol#L41-L41) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/IGovernance.sol#L43-L43), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/IGovernance.sol#L45-L45), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/IGovernance.sol#L47-L47), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/IGovernance.sol#L49-L49), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/IGovernance.sol#L51-L51), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/IGovernance.sol#L53-L53), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/IGovernance.sol#L55-L55), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/IGovernance.sol#L57-L57), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/IGovernance.sol#L59-L59), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/IGovernance.sol#L61-L61), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/IGovernance.sol#L63-L63), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/IGovernance.sol#L65-L65)


```solidity

File: contracts/state-transition/IStateTransitionManager.sol

26: interface IStateTransitionManager {

28:     event StateTransitionNewChain(uint256 indexed _chainId, address indexed _stateTransitionContract);

30:     event SetChainIdUpgrade(

43:     function bridgehub() external view returns (address);

53:     function stateTransition(uint256 _chainId) external view returns (address);

55:     function storedBatchZero() external view returns (bytes32);

57:     function initialCutHash() external view returns (bytes32);

59:     function genesisUpgrade() external view returns (address);

61:     function upgradeCutHash(uint256 _protocolVersion) external view returns (bytes32);

63:     function protocolVersion() external view returns (uint256);

65:     function initialize(StateTransitionManagerInitializeData calldata _initalizeData) external;

67:     function setInitialCutHash(Diamond.DiamondCutData calldata _diamondCut) external;

69:     function setValidatorTimelock(address _validatorTimelock) external;

71:     function getChainAdmin(uint256 _chainId) external view returns (address);

82:     function registerAlreadyDeployedStateTransition(uint256 _chainId, address _stateTransitionContract) external;

84:     function setNewVersionUpgrade(

90:     function setUpgradeDiamondCut(Diamond.DiamondCutData calldata _cutData, uint256 _oldProtocolVersion) external;

92:     function freezeChain(uint256 _chainId) external;

94:     function unfreezeChain(uint256 _chainId) external;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/IStateTransitionManager.sol#L26-L26) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/IStateTransitionManager.sol#L28-L28), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/IStateTransitionManager.sol#L30-L30), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/IStateTransitionManager.sol#L43-L43), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/IStateTransitionManager.sol#L53-L53), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/IStateTransitionManager.sol#L55-L55), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/IStateTransitionManager.sol#L57-L57), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/IStateTransitionManager.sol#L59-L59), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/IStateTransitionManager.sol#L61-L61), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/IStateTransitionManager.sol#L63-L63), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/IStateTransitionManager.sol#L65-L65), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/IStateTransitionManager.sol#L67-L67), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/IStateTransitionManager.sol#L69-L69), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/IStateTransitionManager.sol#L71-L71), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/IStateTransitionManager.sol#L82-L82), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/IStateTransitionManager.sol#L84-L84), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/IStateTransitionManager.sol#L90-L90), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/IStateTransitionManager.sol#L92-L92), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/IStateTransitionManager.sol#L94-L94)


```solidity

File: contracts/state-transition/chain-interfaces/IAdmin.sol

45:     function upgradeChainFromVersion(uint256 _protocolVersion, Diamond.DiamondCutData calldata _cutData) external;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IAdmin.sol#L45-L45) 


```solidity

File: contracts/state-transition/chain-interfaces/IDiamondInit.sol

61: interface IDiamondInit {

62:     function initialize(InitializeData calldata _initData) external returns (bytes32);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IDiamondInit.sol#L61-L61) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IDiamondInit.sol#L62-L62)


```solidity

File: contracts/state-transition/chain-interfaces/IMailbox.sol

98:     function bridgehubRequestL2Transaction(


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IMailbox.sol#L98-L98) 


```solidity

File: contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol

15: interface IZkSyncStateTransition is IAdmin, IExecutor, IGetters, IMailbox {

17:     event ProposeTransparentUpgrade(


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol#L15-L15) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol#L17-L17)


```solidity

File: contracts/state-transition/l2-deps/ISystemContext.sol

4: interface ISystemContext {

5:     function setChainId(uint256 _newChainId) external;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/l2-deps/ISystemContext.sol#L4-L4) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/l2-deps/ISystemContext.sol#L5-L5)


```solidity

File: contracts/upgrades/IDefaultUpgrade.sol

7: interface IDefaultUpgrade {

8:     function upgrade(ProposedUpgrade calldata _upgrade) external returns (bytes32);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/IDefaultUpgrade.sol#L7-L7) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/IDefaultUpgrade.sol#L8-L8)


```solidity

File: contracts/common/ReentrancyGuard.sol

38:     uint256 private constant _NOT_ENTERED = 1;

39:     uint256 private constant _ENTERED = 2;

41:     modifier reentrancyGuardInitializer() {

46:     function _initializeReentrancyGuard() private {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/ReentrancyGuard.sol#L38-L38) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/ReentrancyGuard.sol#L39-L39), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/ReentrancyGuard.sol#L41-L41), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/ReentrancyGuard.sol#L46-L46)


```solidity

File: contracts/vendor/AddressAliasHelper.sol

21: library AddressAliasHelper {

22:     uint160 constant offset = uint160(0x1111000000000000000000000000000000001111);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/vendor/AddressAliasHelper.sol#L21-L21) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/vendor/AddressAliasHelper.sol#L22-L22)


```solidity

File: contracts/bridge/L2SharedBridge.sol

37:     address private l1LegacyBridge;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L37-L37) 


```solidity

File: contracts/bridge/L2StandardERC20.sol

26:     ERC20Getters private availableGetters;

129:     modifier onlyBridge() {

134:     modifier onlyNextVersion(uint8 _version) {

159:     function name() public view override returns (string memory) {

165:     function symbol() public view override returns (string memory) {

171:     function decimals() public view override returns (uint8) {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2StandardERC20.sol#L26-L26) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2StandardERC20.sol#L129-L129), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2StandardERC20.sol#L134-L134), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2StandardERC20.sol#L159-L159), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2StandardERC20.sol#L165-L165), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2StandardERC20.sol#L171-L171)


```solidity

File: contracts/bridge/interfaces/IL1ERC20Bridge.sol

9:     function finalizeWithdrawal(


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL1ERC20Bridge.sol#L9-L9) 


```solidity

File: contracts/bridge/interfaces/IL1SharedBridge.sol

9:     function finalizeWithdrawal(


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL1SharedBridge.sol#L9-L9) 


```solidity

File: contracts/bridge/interfaces/IL2SharedBridge.sol

7:     event FinalizeDeposit(

14:     event WithdrawalInitiated(

24:     function finalizeDeposit(

32:     function withdraw(address _l1Receiver, address _l2Token, uint256 _amount) external;

34:     function l1TokenAddress(address _l2Token) external view returns (address);

36:     function l2TokenAddress(address _l1Token) external view returns (address);

38:     function l1Bridge() external view returns (address);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL2SharedBridge.sol#L7-L7) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL2SharedBridge.sol#L14-L14), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL2SharedBridge.sol#L24-L24), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL2SharedBridge.sol#L32-L32), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL2SharedBridge.sol#L34-L34), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL2SharedBridge.sol#L36-L36), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL2SharedBridge.sol#L38-L38)


```solidity

File: contracts/bridge/interfaces/IL2StandardToken.sol

5: interface IL2StandardToken {

6:     event BridgeInitialize(address indexed l1Token, string name, string symbol, uint8 decimals);

8:     event BridgeMint(address indexed _account, uint256 _amount);

10:     event BridgeBurn(address indexed _account, uint256 _amount);

12:     function bridgeMint(address _account, uint256 _amount) external;

14:     function bridgeBurn(address _account, uint256 _amount) external;

16:     function l1Address() external view returns (address);

18:     function l2Bridge() external view returns (address);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL2StandardToken.sol#L5-L5) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL2StandardToken.sol#L6-L6), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL2StandardToken.sol#L8-L8), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL2StandardToken.sol#L10-L10), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL2StandardToken.sol#L12-L12), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL2StandardToken.sol#L14-L14), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL2StandardToken.sol#L16-L16), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL2StandardToken.sol#L18-L18)


```solidity

File: contracts/interfaces/IPaymaster.sol

14: interface IPaymaster {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/interfaces/IPaymaster.sol#L14-L14) 


```solidity

File: contracts/interfaces/IPaymasterFlow.sol

14:     function general(bytes calldata input) external;

16:     function approvalBased(address _token, uint256 _minAllowance, bytes calldata _innerInput) external;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/interfaces/IPaymasterFlow.sol#L14-L14) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/interfaces/IPaymasterFlow.sol#L16-L16)


```solidity

File: contracts/vendor/AddressAliasHelper.sol

21: library AddressAliasHelper {

22:     uint160 constant offset = uint160(0x1111000000000000000000000000000000001111);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/vendor/AddressAliasHelper.sol#L21-L21) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/vendor/AddressAliasHelper.sol#L22-L22)


```solidity

File: contracts/SystemContractsCaller.sol

26: library Utils {

27:     function safeCastToU32(uint256 _x) internal pure returns (uint32) {

37:     function systemCall(uint32 gasLimit, address to, uint256 value, bytes memory data) internal returns (bool success) {

76:     function systemCallWithReturndata(

95:     function getFarCallABI(

121:     function getFarCallABIWithEmptyFatPointer(


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/SystemContractsCaller.sol#L26-L26) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/SystemContractsCaller.sol#L27-L27), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/SystemContractsCaller.sol#L37-L37), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/SystemContractsCaller.sol#L76-L76), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/SystemContractsCaller.sol#L95-L95), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/SystemContractsCaller.sol#L121-L121)


</details>


### [NC&#x2011;13] Contract does not follow the Solidity style guide's suggested layout ordering 
The [style guide](https://docs.soliditylang.org/en/v0.8.16/style-guide.html#order-of-layout) says that, within a contract, the ordering should be 1) Type declarations, 2) State variables, 3) Events, 4) Modifiers, and 5) Functions, but the contract(s) below do not follow this ordering


*There are 12 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/ContractDeployer.sol

//@audit the structure definition is misplaced
197:     struct ForceDeployment {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L197-L197) 


```solidity

File: contracts/interfaces/IBaseToken.sol

//@audit the event definition is misplaced
24:     event Mint(address indexed account, uint256 amount);


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IBaseToken.sol#L24-L24) 


```solidity

File: contracts/bridge/L1SharedBridge.sol

//@audit the structure definition is misplaced
401:     struct MessageParams {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L401-L401) 


```solidity

File: contracts/state-transition/ValidatorTimelock.sol

//@audit the variable definition is misplaced
44:     IStateTransitionManager public stateTransitionManager;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L44-L44) 


```solidity

File: contracts/state-transition/libraries/Diamond.sol

//@audit the structure definition is misplaced
30:     struct SelectorToFacet {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L30-L30) 


```solidity

File: contracts/bridgehub/IBridgehub.sol

//@audit the event definition is misplaced
133:     event NewChain(uint256 indexed chainId, address stateTransitionManager, address indexed chainGovernance);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L133-L133) 


```solidity

File: contracts/governance/IGovernance.sol

//@audit the event definition is misplaced
68:     event TransparentOperationScheduled(bytes32 indexed _id, uint256 delay, Operation _operation);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/IGovernance.sol#L68-L68) 


```solidity

File: contracts/state-transition/chain-interfaces/IAdmin.sol

//@audit the event definition is misplaced
61:     event IsPorterAvailableStatusUpdate(bool isPorterAvailable);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IAdmin.sol#L61-L61) 


```solidity

File: contracts/state-transition/chain-interfaces/IExecutor.sol

//@audit the event definition is misplaced
191:     event BlockCommit(uint256 indexed batchNumber, bytes32 indexed batchHash, bytes32 indexed commitment);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IExecutor.sol#L191-L191) 


```solidity

File: contracts/state-transition/chain-interfaces/IMailbox.sol

//@audit the event definition is misplaced
123:     event NewPriorityRequest(


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IMailbox.sol#L123-L123) 


```solidity

File: contracts/common/ReentrancyGuard.sol

//@audit the modifier definition is misplaced
68:     modifier nonReentrant() {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/ReentrancyGuard.sol#L68-L68) 


```solidity

File: contracts/L2ContractHelper.sol

//@audit the structure definition is misplaced
117: struct Transaction {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/L2ContractHelper.sol#L117-L117) 


</details>


### [NC&#x2011;14] Control structures do not follow the Solidity Style Guide 
See the [control structures](https://docs.soliditylang.org/en/latest/style-guide.html#control-structures) section of the Solidity Style Guide


*There are 181 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/AccountCodeStorage.sol

131:         if (


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/AccountCodeStorage.sol#L131-L131) 


```solidity

File: contracts/BootloaderUtilities.sol

24:     function getTransactionHashes(


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L24-L24) 


```solidity

File: contracts/Compressor.sol

44:     function publishCompressedBytecode(

110:     function verifyCompressedStateDiffs(

197:     function _decodeRawBytecode(

220:     function _verifyValueCompression(


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Compressor.sol#L44-L44) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Compressor.sol#L110-L110), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Compressor.sol#L197-L197), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Compressor.sol#L220-L220)


```solidity

File: contracts/ContractDeployer.sol

95:     function getNewAddressCreate2(

115:     function getNewAddressCreate(

132:     function create2(

147:     function create(

162:     function create2Account(

182:     function createAccount(

258:     function _nonSystemDeployOnAddress(

283:     function _performDeployOnAddress(

321:     function _constructContract(

47:         if (


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L95-L95) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L115-L115), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L132-L132), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L147-L147), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L162-L162), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L182-L182), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L258-L258), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L283-L283), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L321-L321), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L47-L47)


```solidity

File: contracts/DefaultAccount.sol

67:     function validateTransaction(

78:     function _validateTransaction(

112:     function executeTransaction(

196:     function payForTransaction(

212:     function prepareForPaymaster(


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/DefaultAccount.sol#L67-L67) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/DefaultAccount.sol#L78-L78), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/DefaultAccount.sol#L112-L112), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/DefaultAccount.sol#L196-L196), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/DefaultAccount.sol#L212-L212)


```solidity

File: contracts/L1Messenger.sol

70:     function sendL2ToL1Log(

161:     function requestBytecodeL1Publication(

194:     function publishPubdataAndClearState(


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L70-L70) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L161-L161), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L194-L194)


```solidity

File: contracts/L2BaseToken.sol

117:     function _getExtendedWithdrawMessage(


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L2BaseToken.sol#L117-L117) 


```solidity

File: contracts/SystemContext.sol

221:     function _calculateL2BlockHash(

263:     function _setVirtualBlock(

341:     function setL2Block(

444:     function setNewBatch(

471:     function unsafeOverrideBatch(

150:         } else if (


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L221-L221) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L263-L263), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L341-L341), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L444-L444), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L471-L471), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L150-L150)


```solidity

File: contracts/libraries/EfficientCall.sol

58:     function call(

74:     function staticCall(

88:     function delegateCall(

105:     function mimicCall(

124:     function rawCall(

191:     function rawMimicCall(

245:     function _loadFarCallABIIntoActivePtr(


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L58-L58) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L74-L74), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L88-L88), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L105-L105), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L124-L124), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L191-L191), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L245-L245)


```solidity

File: contracts/libraries/SystemContractHelper.sol

124:     function packPrecompileParams(

148:     function unsafePrecompileCall(


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L124-L124) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L148-L148)


```solidity

File: contracts/libraries/SystemContractsCaller.sol

123:     function systemCallWithReturndata(

150:     function systemCallWithPropagatedRevert(

214:     function getFarCallABI(

250:     function getFarCallABIWithEmptyFatPointer(


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractsCaller.sol#L123-L123) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractsCaller.sol#L150-L150), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractsCaller.sol#L214-L214), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractsCaller.sol#L250-L250)


```solidity

File: contracts/interfaces/IAccount.sol

20:     function validateTransaction(

26:     function executeTransaction(

36:     function payForTransaction(

42:     function prepareForPaymaster(


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IAccount.sol#L20-L20) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IAccount.sol#L26-L26), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IAccount.sol#L36-L36), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IAccount.sol#L42-L42)


```solidity

File: contracts/interfaces/IBootloaderUtilities.sol

8:     function getTransactionHashes(


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IBootloaderUtilities.sol#L8-L8) 


```solidity

File: contracts/interfaces/ICompressor.sol

19:     function publishCompressedBytecode(

24:     function verifyCompressedStateDiffs(


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ICompressor.sol#L19-L19) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ICompressor.sol#L24-L24)


```solidity

File: contracts/interfaces/IContractDeployer.sol

43:     function getNewAddressCreate2(

52:     function create2(

58:     function create2Account(

68:     function create(

76:     function createAccount(


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IContractDeployer.sol#L43-L43) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IContractDeployer.sol#L52-L52), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IContractDeployer.sol#L58-L58), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IContractDeployer.sol#L68-L68), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IContractDeployer.sol#L76-L76)


```solidity

File: contracts/interfaces/IMailbox.sol

6:     function finalizeEthWithdrawal(


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IMailbox.sol#L6-L6) 


```solidity

File: contracts/interfaces/IPaymaster.sol

28:     function validateAndPayForPaymasterTransaction(

43:     function postTransaction(


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IPaymaster.sol#L28-L28) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IPaymaster.sol#L43-L43)


```solidity

File: contracts/bridge/L1ERC20Bridge.sol

98:     function deposit(

133:     function deposit(

176:     function claimFailedDeposit(

208:     function finalizeWithdrawal(


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1ERC20Bridge.sol#L98-L98) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1ERC20Bridge.sol#L133-L133), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1ERC20Bridge.sol#L176-L176), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1ERC20Bridge.sol#L208-L208)


```solidity

File: contracts/bridge/L1SharedBridge.sol

104:     function initialize(

148:     function bridgehubDepositBaseToken(

182:     function bridgehubDeposit(

232:     function bridgehubConfirmL2Transaction(

243:     function _getDepositL2Calldata(

277:     function claimFailedDeposit(

303:     function _claimFailedDeposit(

385:     function finalizeWithdrawal(

409:     function _finalizeWithdrawal(

458:     function _checkWithdrawal(

487:     function _parseL2WithdrawalMessage(

554:     function depositLegacyErc20Bridge(

615:     function finalizeWithdrawalLegacyErc20Bridge(

644:     function claimFailedDepositLegacyErc20Bridge(


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L104-L104) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L148-L148), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L182-L182), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L232-L232), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L243-L243), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L277-L277), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L303-L303), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L385-L385), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L409-L409), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L458-L458), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L487-L487), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L554-L554), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L615-L615), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L644-L644)


```solidity

File: contracts/bridgehub/Bridgehub.sol

114:     function createNewChain(

152:     function proveL2MessageInclusion(

164:     function proveL2LogInclusion(

176:     function proveL1ToL2TransactionStatus(

198:     function l2TransactionBaseCost(

217:     function requestL2TransactionDirect(

262:     function requestL2TransactionTwoBridges(


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L114-L114) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L152-L152), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L164-L164), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L176-L176), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L198-L198), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L217-L217), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L262-L262)


```solidity

File: contracts/state-transition/StateTransitionManager.sol

79:     function initialize(

142:     function setNewVersionUpgrade(

152:     function setUpgradeDiamondCut(

230:     function registerAlreadyDeployedStateTransition(

239:     function createNewChain(


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L79-L79) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L142-L142), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L152-L152), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L230-L230), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L239-L239)


```solidity

File: contracts/state-transition/ValidatorTimelock.sol

108:     function commitBatches(

126:     function commitBatchesSharedBridge(

160:     function proveBatches(

171:     function proveBatchesSharedBridge(

203:     function executeBatchesSharedBridge(


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L108-L108) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L126-L126), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L160-L160), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L171-L171), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L203-L203)


```solidity

File: contracts/state-transition/chain-deps/facets/Admin.sol

100:     function upgradeChainFromVersion(


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Admin.sol#L100-L100) 


```solidity

File: contracts/state-transition/chain-deps/facets/Executor.sol

32:     function _commitOneBatch(

103:     function _verifyBatchTimestamp(

130:     function _processL2Logs(

199:     function commitBatches(

207:     function commitBatchesSharedBridge(

215:     function _commitBatches(

253:     function _commitBatchesWithoutSystemContractsUpgrade(

273:     function _commitBatchesWithSystemContractsUpgrade(

337:     function executeBatchesSharedBridge(

368:     function proveBatches(

377:     function proveBatchesSharedBridge(

386:     function _proveBatches(

453:     function _getBatchProofPublicInput(

500:     function _createBatchCommitment(

537:     function _batchAuxiliaryOutput(

561:     function _encodeBlobAuxilaryOutput(

605:     function _pointEvaluationPrecompile(

625:     function _verifyBlobInformation(


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L32-L32) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L103-L103), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L130-L130), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L199-L199), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L207-L207), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L215-L215), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L253-L253), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L273-L273), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L337-L337), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L368-L368), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L377-L377), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L386-L386), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L453-L453), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L500-L500), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L537-L537), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L561-L561), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L605-L605), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L625-L625)


```solidity

File: contracts/state-transition/chain-deps/facets/Mailbox.sol

47:     function bridgehubRequestL2Transaction(

54:     function proveL2MessageInclusion(

64:     function proveL2LogInclusion(

74:     function proveL1ToL2TransactionStatus(

104:     function _proveL2LogInclusion(

143:     function l2TransactionBaseCost(

178:     function finalizeEthWithdrawal(

197:     function requestL2Transaction(

228:     function _requestL2TransactionSender(

258:     function _requestL2Transaction(

289:     function _serializeL2Transaction(

316:     function _writePriorityOp(


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L47-L47) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L54-L54), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L64-L64), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L74-L74), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L104-L104), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L143-L143), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L178-L178), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L197-L197), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L228-L228), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L258-L258), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L289-L289), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L316-L316)


```solidity

File: contracts/upgrades/BaseZkSyncUpgrade.sol

180:     function _setL2SystemContractUpgrade(

147:         if (


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgrade.sol#L180-L180) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgrade.sol#L147-L147)


```solidity

File: contracts/common/libraries/L2ContractHelper.sol

60:     function computeCreate2Address(


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/L2ContractHelper.sol#L60-L60) 


```solidity

File: contracts/state-transition/libraries/Merkle.sol

18:     function calculateRoot(


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Merkle.sol#L18-L18) 


```solidity

File: contracts/state-transition/libraries/TransactionValidator.sol

19:     function validateL1ToL2Transaction(

69:     function getMinimalPriorityTransactionGasLimit(

109:     function getTransactionBodyGasLimit(

128:     function getOverheadForTransaction(


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/TransactionValidator.sol#L19-L19) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/TransactionValidator.sol#L69-L69), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/TransactionValidator.sol#L109-L109), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/TransactionValidator.sol#L128-L128)


```solidity

File: contracts/bridge/interfaces/IL1ERC20Bridge.sol

26:     function deposit(

35:     function deposit(

43:     function claimFailedDeposit(

53:     function finalizeWithdrawal(

69:     function depositAmount(


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1ERC20Bridge.sol#L26-L26) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1ERC20Bridge.sol#L35-L35), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1ERC20Bridge.sol#L43-L43), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1ERC20Bridge.sol#L53-L53), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1ERC20Bridge.sol#L69-L69)


```solidity

File: contracts/bridge/interfaces/IL1SharedBridge.sol

58:     function isWithdrawalFinalized(

64:     function depositLegacyErc20Bridge(

74:     function claimFailedDepositLegacyErc20Bridge(

85:     function claimFailedDeposit(

97:     function finalizeWithdrawalLegacyErc20Bridge(

105:     function finalizeWithdrawal(

128:     function bridgehubDeposit(

135:     function bridgehubDepositBaseToken(


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L58-L58) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L64-L64), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L74-L74), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L85-L85), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L97-L97), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L105-L105), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L128-L128), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L135-L135)


```solidity

File: contracts/bridge/interfaces/IL2Bridge.sol

7:     function finalizeDeposit(


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL2Bridge.sol#L7-L7) 


```solidity

File: contracts/bridgehub/IBridgehub.sol

73:     function proveL2MessageInclusion(

81:     function proveL2LogInclusion(

89:     function proveL1ToL2TransactionStatus(

99:     function requestL2TransactionDirect(

103:     function requestL2TransactionTwoBridges(

107:     function l2TransactionBaseCost(

116:     function createNewChain(


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L73-L73) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L81-L81), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L89-L89), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L99-L99), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L103-L103), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L107-L107), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L116-L116)


```solidity

File: contracts/state-transition/IStateTransitionManager.sol

74:     function createNewChain(

84:     function setNewVersionUpgrade(


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/IStateTransitionManager.sol#L74-L74) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/IStateTransitionManager.sol#L84-L84)


```solidity

File: contracts/state-transition/chain-interfaces/IExecutor.sol

137:     function commitBatches(

143:     function commitBatchesSharedBridge(

154:     function proveBatches(

161:     function proveBatchesSharedBridge(


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IExecutor.sol#L137-L137) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IExecutor.sol#L143-L143), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IExecutor.sol#L154-L154), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IExecutor.sol#L161-L161)


```solidity

File: contracts/state-transition/chain-interfaces/IMailbox.sol

18:     function proveL2MessageInclusion(

31:     function proveL2LogInclusion(

47:     function proveL1ToL2TransactionStatus(

62:     function finalizeEthWithdrawal(

88:     function requestL2Transaction(

98:     function bridgehubRequestL2Transaction(

107:     function l2TransactionBaseCost(


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IMailbox.sol#L18-L18) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IMailbox.sol#L31-L31), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IMailbox.sol#L47-L47), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IMailbox.sol#L62-L62), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IMailbox.sol#L88-L88), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IMailbox.sol#L98-L98), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IMailbox.sol#L107-L107)


```solidity

File: contracts/state-transition/chain-interfaces/IVerifier.sol

19:     function verify(


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IVerifier.sol#L19-L19) 


```solidity

File: contracts/bridge/L2SharedBridge.sol

49:     function initialize(

79:     function finalizeDeposit(

138:     function _getL1WithdrawMessage(


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L49-L49) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L79-L79), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L138-L138)


```solidity

File: contracts/bridge/L2StandardERC20.sol

111:     function reinitializeToken(


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2StandardERC20.sol#L111-L111) 


```solidity

File: contracts/bridge/interfaces/IL1ERC20Bridge.sol

9:     function finalizeWithdrawal(


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL1ERC20Bridge.sol#L9-L9) 


```solidity

File: contracts/bridge/interfaces/IL1SharedBridge.sol

9:     function finalizeWithdrawal(


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL1SharedBridge.sol#L9-L9) 


```solidity

File: contracts/bridge/interfaces/IL2SharedBridge.sol

24:     function finalizeDeposit(


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL2SharedBridge.sol#L24-L24) 


```solidity

File: contracts/interfaces/IPaymaster.sol

28:     function validateAndPayForPaymasterTransaction(

43:     function postTransaction(


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/interfaces/IPaymaster.sol#L28-L28) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/interfaces/IPaymaster.sol#L43-L43)


```solidity

File: contracts/L2ContractHelper.sol

101:     function computeCreate2Address(


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/L2ContractHelper.sol#L101-L101) 


```solidity

File: contracts/SystemContractsCaller.sol

76:     function systemCallWithReturndata(

95:     function getFarCallABI(

121:     function getFarCallABIWithEmptyFatPointer(


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/SystemContractsCaller.sol#L76-L76) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/SystemContractsCaller.sol#L95-L95), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/SystemContractsCaller.sol#L121-L121)


</details>


### [NC&#x2011;15] Default address(0) can be returned 
Allowing a function in Solidity to return the default address (address(0)) can be problematic as it can represent uninitialized or invalid addresses. If such an address is utilized in transfer operations or other sensitive actions, it could lead to loss of funds or unpredicted behavior. It's prudent to include checks in your functions to prevent the return of the zero address, enhancing contract security.


*There are 2 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/ContractDeployer.sol

173:         return newAddress;

193:         return newAddress;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L173-L173) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L193-L193)


</details>


### [NC&#x2011;16] Consider using `delete` rather than assigning `zero` to clear values 
The `delete` keyword more closely matches the semantics of what is being done, and draws more attention to the changing of state, which may lead to a more thorough audit of its associated logic


*There are 3 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/L1Messenger.sol

330:         numberOfLogsToProcess = 0;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L330-L330) 


```solidity

File: contracts/SystemContext.sol

487:         txNumberInBlock = 0;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L487-L487) 


```solidity

File: contracts/bridgehub/Bridgehub.sol

276:                 baseTokenMsgValue = 0;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L276-L276) 


</details>


### [NC&#x2011;17] Use EIP-5627 to describe EIP-712 domains 
EIP-5267 is a standard which allows for the retrieval and description of EIP-712 hash domains.This enable external tools to allow users to view the fields and values that describe their domain.
This is especially useful when a project may exist on multiple chains and or in multiple contracts, and allows users / tools to verify that the signature is for the right fork, chain, version, contract, etc.


*There are 1 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/libraries/TransactionHelper.sol

82:     bytes32 constant EIP712_DOMAIN_TYPEHASH = keccak256("EIP712Domain(string name,string version,uint256 chainId)");


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L82-L82) 


</details>


### [NC&#x2011;18] `else`-block not required 
One level of nesting can be removed by not having an `else` block when the `if`-block returns:


*There are 3 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/governance/Governance.sol

107:         if (timestamp == 0) {

109:         } else if (timestamp == EXECUTED_PROPOSAL_TIMESTAMP) {

111:         } else if (timestamp > block.timestamp) {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/Governance.sol#L107-L107) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/Governance.sol#L109-L109), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/Governance.sol#L111-L111)


</details>


### [NC&#x2011;19] Empty bytes check is missing 
When developing smart contracts in Solidity, it's crucial to validate the inputs of your functions. This includes ensuring that the bytes parameters are not empty, especially when they represent crucial data such as addresses, identifiers, or raw data that the contract needs to process.
Missing empty bytes checks can lead to unexpected behaviour in your contract.For instance, certain operations might fail, produce incorrect results, or consume unnecessary gas when performed with empty bytes.Moreover, missing input validation can potentially expose your contract to malicious activity, including exploitation of unhandled edge cases.
To mitigate these issues, always validate that bytes parameters are not empty when the logic of your contract requires it.


*There are 113 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/AccountCodeStorage.sol

//@audit  ,_hash are not checked
35:     function storeAccountConstructingCodeHash(address _address, bytes32 _hash) external override onlyDeployer {
36:         // Check that code hash corresponds to the deploying smart contract

//@audit  ,_hash are not checked
46:     function storeAccountConstructedCodeHash(address _address, bytes32 _hash) external override onlyDeployer {
47:         // Check that code hash corresponds to the deploying smart contract

//@audit  ,_hash are not checked
68:     function _storeCodeHash(address _address, bytes32 _hash) internal {
69:         uint256 addressAsKey = uint256(uint160(_address));


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/AccountCodeStorage.sol#L35-L36) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/AccountCodeStorage.sol#L46-L47), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/AccountCodeStorage.sol#L68-L69)


```solidity

File: contracts/ComplexUpgrader.sol

//@audit  ,_calldata are not checked
21:     function upgrade(address _delegateTo, bytes calldata _calldata) external payable {
22:         require(msg.sender == FORCE_DEPLOYER, "Can only be called by FORCE_DEPLOYER");


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ComplexUpgrader.sol#L21-L22) 


```solidity

File: contracts/Compressor.sol

//@audit  ,_rawCompressedData are not checked
44:     function publishCompressedBytecode(
45:         bytes calldata _bytecode,
46:         bytes calldata _rawCompressedData
47:     ) external payable onlyCallFromBootloader returns (bytes32 bytecodeHash) {

//@audit  ,_stateDiffs are not checked
110:     function verifyCompressedStateDiffs(
111:         uint256 _numberOfStateDiffs,
112:         uint256 _enumerationIndexSize,
113:         bytes calldata _stateDiffs,
114:         bytes calldata _compressedStateDiffs
115:     ) external payable onlyCallFrom(address(L1_MESSENGER_CONTRACT)) returns (bytes32 stateDiffHash) {

//@audit  ,_rawCompressedData are not checked
197:     function _decodeRawBytecode(
198:         bytes calldata _rawCompressedData
199:     ) internal pure returns (bytes calldata dictionary, bytes calldata encodedData) {

//@audit  ,_compressedValue are not checked
220:     function _verifyValueCompression(
221:         uint256 _initialValue,
222:         uint256 _finalValue,
223:         uint256 _operation,
224:         bytes calldata _compressedValue
225:     ) internal pure {

//@audit  ,_calldataSlice are not checked
251:     function _sliceToUint256(bytes calldata _calldataSlice) internal pure returns (uint256 number) {
252:         number = uint256(bytes32(_calldataSlice));


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Compressor.sol#L44-L47) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Compressor.sol#L110-L115), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Compressor.sol#L197-L199), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Compressor.sol#L220-L225), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Compressor.sol#L251-L252)


```solidity

File: contracts/ContractDeployer.sol

//@audit  ,_bytecodeHash ,_salt ,_input are not checked
095:     function getNewAddressCreate2(
096:         address _sender,
097:         bytes32 _bytecodeHash,
098:         bytes32 _salt,
099:         bytes calldata _input
100:     ) public view override returns (address newAddress) {

//@audit  ,_salt ,_bytecodeHash ,_input are not checked
132:     function create2(
133:         bytes32 _salt,
134:         bytes32 _bytecodeHash,
135:         bytes calldata _input
136:     ) external payable override returns (address) {

//@audit  ,_salt ,_bytecodeHash ,_input are not checked
147:     function create(
148:         bytes32 _salt,
149:         bytes32 _bytecodeHash,
150:         bytes calldata _input
151:     ) external payable override returns (address) {

//@audit  ,_salt ,_bytecodeHash ,_input are not checked
162:     function create2Account(
163:         bytes32 _salt,
164:         bytes32 _bytecodeHash,
165:         bytes calldata _input,
166:         AccountAbstractionVersion _aaVersion
167:     ) public payable override onlySystemCall returns (address) {

//@audit  ,_bytecodeHash ,_input are not checked
182:     function createAccount(
183:         bytes32, // salt
184:         bytes32 _bytecodeHash,
185:         bytes calldata _input,
186:         AccountAbstractionVersion _aaVersion
187:     ) public payable override onlySystemCall returns (address) {

//@audit  ,_input are not checked
258:     function _nonSystemDeployOnAddress(
259:         bytes32 _bytecodeHash,
260:         address _newAddress,
261:         AccountAbstractionVersion _aaVersion,
262:         bytes calldata _input
263:     ) internal {

//@audit  ,_bytecodeHash ,_input are not checked
283:     function _performDeployOnAddress(
284:         bytes32 _bytecodeHash,
285:         address _newAddress,
286:         AccountAbstractionVersion _aaVersion,
287:         bytes calldata _input
288:     ) internal {

//@audit  ,_bytecodeHash are not checked
301:     function _ensureBytecodeIsKnown(bytes32 _bytecodeHash) internal view {
302:         uint256 knownCodeMarker = KNOWN_CODE_STORAGE_CONTRACT.getMarker(_bytecodeHash);

//@audit  ,_bytecodeHash are not checked
309:     function _storeConstructingByteCodeHashOnAddress(address _newAddress, bytes32 _bytecodeHash) internal {
310:         // Set the "isConstructor" flag to the bytecode hash

//@audit  ,_bytecodeHash ,_input are not checked
321:     function _constructContract(
322:         address _sender,
323:         address _newAddress,
324:         bytes32 _bytecodeHash,
325:         bytes calldata _input,
326:         bool _isSystem,
327:         bool _callConstructor
328:     ) internal {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L95-L100) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L132-L136), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L147-L151), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L162-L167), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L182-L187), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L258-L263), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L283-L288), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L301-L302), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L309-L310), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L321-L328)


```solidity

File: contracts/DefaultAccount.sol

//@audit  ,_suggestedSignedHash are not checked
67:     function validateTransaction(
68:         bytes32, // _txHash
69:         bytes32 _suggestedSignedHash,
70:         Transaction calldata _transaction
71:     ) external payable override ignoreNonBootloader ignoreInDelegateCall returns (bytes4 magic) {

//@audit  ,_hash are not checked
159:     function _isValidSignature(bytes32 _hash, bytes memory _signature) internal view returns (bool) {
160:         require(_signature.length == 65, "Signature length is incorrect");


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/DefaultAccount.sol#L67-L71) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/DefaultAccount.sol#L159-L160)


```solidity

File: contracts/KnownCodesStorage.sol

//@audit  ,_bytecodeHash are not checked
39:     function markBytecodeAsPublished(bytes32 _bytecodeHash) external onlyCompressor {
40:         _markBytecodeAsPublished(_bytecodeHash, false);

//@audit  ,_hash are not checked
65:     function getMarker(bytes32 _hash) public view override returns (uint256 marker) {
66:         assembly {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/KnownCodesStorage.sol#L39-L40) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/KnownCodesStorage.sol#L65-L66)


```solidity

File: contracts/L1Messenger.sol

//@audit  ,_key ,_value are not checked
70:     function sendL2ToL1Log(
71:         bool _isService,
72:         bytes32 _key,
73:         bytes32 _value
74:     ) external onlyCallFromSystemContract returns (uint256 logIdInMerkleTree) {

//@audit  ,_message are not checked
116:     function sendToL1(bytes calldata _message) external override returns (bytes32 hash) {
117:         uint256 gasBeforeMessageHashing = gasleft();

//@audit  ,_bytecodeHash are not checked
161:     function requestBytecodeL1Publication(
162:         bytes32 _bytecodeHash
163:     ) external override onlyCallFrom(address(KNOWN_CODE_STORAGE_CONTRACT)) {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L70-L74) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L116-L117), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L161-L163)


```solidity

File: contracts/L2BaseToken.sol

//@audit  ,_additionalData are not checked
85:     function withdrawWithMessage(address _l1Receiver, bytes memory _additionalData) external payable override {
86:         uint256 amount = _burnMsgValue();

//@audit  ,_additionalData are not checked
117:     function _getExtendedWithdrawMessage(
118:         address _to,
119:         uint256 _amount,
120:         address _sender,
121:         bytes memory _additionalData
122:     ) internal pure returns (bytes memory) {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L2BaseToken.sol#L85-L86) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L2BaseToken.sol#L117-L122)


```solidity

File: contracts/MsgValueSimulator.sol

//@audit  ,_data are not checked
47:     fallback(bytes calldata _data) external onlySystemCall returns (bytes memory) {
48:         // Firstly we calculate how much gas has been actually provided by the user to the inner call.


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/MsgValueSimulator.sol#L47-L48) 


```solidity

File: contracts/SystemContext.sol

//@audit  ,_hash are not checked
212:     function _setL2BlockHash(uint256 _block, bytes32 _hash) internal {
213:         l2BlockHash[_block % MINIBLOCK_HASHES_TO_STORE] = _hash;

//@audit  ,_prevL2BlockHash ,_blockTxsRollingHash are not checked
221:     function _calculateL2BlockHash(
222:         uint128 _blockNumber,
223:         uint128 _blockTimestamp,
224:         bytes32 _prevL2BlockHash,
225:         bytes32 _blockTxsRollingHash
226:     ) internal pure returns (bytes32) {

//@audit  ,_prevL2BlockHash are not checked
314:     function _setNewL2BlockData(uint128 _l2BlockNumber, uint128 _l2BlockTimestamp, bytes32 _prevL2BlockHash) internal {
315:         // In the unsafe version we do not check that the block data is correct

//@audit  ,_txHash are not checked
402:     function appendTransactionToCurrentL2Block(bytes32 _txHash) external onlyCallFromBootloader {
403:         currentL2BlockTxsRollingHash = keccak256(abi.encode(currentL2BlockTxsRollingHash, _txHash));

//@audit  ,_prevBatchHash are not checked
444:     function setNewBatch(
445:         bytes32 _prevBatchHash,
446:         uint128 _newTimestamp,
447:         uint128 _expectedNewNumber,
448:         uint256 _baseFee
449:     ) external onlyCallFromBootloader {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L212-L213) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L221-L226), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L314-L315), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L402-L403), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L444-L449)


```solidity

File: contracts/libraries/EfficientCall.sol

//@audit  ,_data are not checked
36:     function keccak(bytes calldata _data) internal view returns (bytes32) {
37:         bytes memory returnData = staticCall(gasleft(), KECCAK256_SYSTEM_CONTRACT, _data);

//@audit  ,_data are not checked
45:     function sha(bytes calldata _data) internal view returns (bytes32) {
46:         bytes memory returnData = staticCall(gasleft(), SHA256_SYSTEM_CONTRACT, _data);

//@audit  ,_data are not checked
58:     function call(
59:         uint256 _gas,
60:         address _address,
61:         uint256 _value,
62:         bytes calldata _data,
63:         bool _isSystem
64:     ) internal returns (bytes memory returnData) {

//@audit  ,_data are not checked
74:     function staticCall(
75:         uint256 _gas,
76:         address _address,
77:         bytes calldata _data
78:     ) internal view returns (bytes memory returnData) {

//@audit  ,_data are not checked
88:     function delegateCall(
89:         uint256 _gas,
90:         address _address,
91:         bytes calldata _data
92:     ) internal returns (bytes memory returnData) {

//@audit  ,_data are not checked
105:     function mimicCall(
106:         uint256 _gas,
107:         address _address,
108:         bytes calldata _data,
109:         address _whoToMimic,
110:         bool _isConstructor,
111:         bool _isSystem
112:     ) internal returns (bytes memory returnData) {

//@audit  ,_data are not checked
124:     function rawCall(
125:         uint256 _gas,
126:         address _address,
127:         uint256 _value,
128:         bytes calldata _data,
129:         bool _isSystem
130:     ) internal returns (bool success) {

//@audit  ,_data are not checked
159:     function rawStaticCall(uint256 _gas, address _address, bytes calldata _data) internal view returns (bool success) {
160:         _loadFarCallABIIntoActivePtr(_gas, _data, false, false);

//@audit  ,_data are not checked
173:     function rawDelegateCall(uint256 _gas, address _address, bytes calldata _data) internal returns (bool success) {
174:         _loadFarCallABIIntoActivePtr(_gas, _data, false, false);

//@audit  ,_data are not checked
191:     function rawMimicCall(
192:         uint256 _gas,
193:         address _address,
194:         bytes calldata _data,
195:         address _whoToMimic,
196:         bool _isConstructor,
197:         bool _isSystem
198:     ) internal returns (bool success) {

//@audit  ,_data are not checked
245:     function _loadFarCallABIIntoActivePtr(
246:         uint256 _gas,
247:         bytes calldata _data,
248:         bool _isConstructor,
249:         bool _isSystem
250:     ) private view {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L36-L37) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L45-L46), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L58-L64), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L74-L78), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L88-L92), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L105-L112), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L124-L130), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L159-L160), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L173-L174), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L191-L198), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L245-L250)


```solidity

File: contracts/libraries/SystemContractHelper.sol

//@audit  ,_key ,_value are not checked
48:     function toL1(bool _isService, bytes32 _key, bytes32 _value) internal {
49:         address callAddr = TO_L1_CALL_ADDRESS;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L48-L49) 


```solidity

File: contracts/libraries/SystemContractsCaller.sol

//@audit  ,data are not checked
76:     function systemCall(uint32 gasLimit, address to, uint256 value, bytes memory data) internal returns (bool success) {
77:         address callAddr = SYSTEM_CALL_CALL_ADDRESS;

//@audit  ,data are not checked
123:     function systemCallWithReturndata(
124:         uint32 gasLimit,
125:         address to,
126:         uint128 value,
127:         bytes memory data
128:     ) internal returns (bool success, bytes memory returnData) {

//@audit  ,data are not checked
150:     function systemCallWithPropagatedRevert(
151:         uint32 gasLimit,
152:         address to,
153:         uint128 value,
154:         bytes memory data
155:     ) internal returns (bytes memory returnData) {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractsCaller.sol#L76-L77) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractsCaller.sol#L123-L128), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractsCaller.sol#L150-L155)


```solidity

File: contracts/libraries/UnsafeBytesCalldata.sol

//@audit  ,_bytes are not checked
19:     function readUint16(bytes calldata _bytes, uint256 _start) internal pure returns (uint16 result) {
20:         assembly {

//@audit  ,_bytes are not checked
26:     function readUint32(bytes calldata _bytes, uint256 _start) internal pure returns (uint32 result) {
27:         assembly {

//@audit  ,_bytes are not checked
33:     function readUint64(bytes calldata _bytes, uint256 _start) internal pure returns (uint64 result) {
34:         assembly {

//@audit  ,_bytes are not checked
40:     function readBytes32(bytes calldata _bytes, uint256 _start) internal pure returns (bytes32 result) {
41:         assembly {

//@audit  ,_bytes are not checked
46:     function readUint256(bytes calldata _bytes, uint256 _start) internal pure returns (uint256 result) {
47:         assembly {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/UnsafeBytesCalldata.sol#L19-L20) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/UnsafeBytesCalldata.sol#L26-L27), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/UnsafeBytesCalldata.sol#L33-L34), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/UnsafeBytesCalldata.sol#L40-L41), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/UnsafeBytesCalldata.sol#L46-L47)


```solidity

File: contracts/libraries/Utils.sol

//@audit  ,_bytecodeHash are not checked
39:     function bytecodeLenInBytes(bytes32 _bytecodeHash) internal pure returns (uint256 codeLength) {
40:         codeLength = bytecodeLenInWords(_bytecodeHash) << 5; // _bytecodeHash * 32

//@audit  ,_bytecodeHash are not checked
44:     function bytecodeLenInWords(bytes32 _bytecodeHash) internal pure returns (uint256 codeLengthInWords) {
45:         unchecked {

//@audit  ,_bytecodeHash are not checked
63:     function constructingBytecodeHash(bytes32 _bytecodeHash) internal pure returns (bytes32) {
64:         // Clear the "isConstructor" marker and set it to 0x01.

//@audit  ,_bytecodeHash are not checked
71:     function constructedBytecodeHash(bytes32 _bytecodeHash) internal pure returns (bytes32) {
72:         return _bytecodeHash & ~IS_CONSTRUCTOR_BYTECODE_HASH_BIT_MASK;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L39-L40) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L44-L45), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L63-L64), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L71-L72)


```solidity

File: contracts/bridge/L1ERC20Bridge.sol

//@audit  ,_l2TxHash are not checked
176:     function claimFailedDeposit(
177:         address _depositSender,
178:         address _l1Token,
179:         bytes32 _l2TxHash,
180:         uint256 _l2BatchNumber,
181:         uint256 _l2MessageIndex,
182:         uint16 _l2TxNumberInBatch,
183:         bytes32[] calldata _merkleProof
184:     ) external nonReentrant {

//@audit  ,_message are not checked
208:     function finalizeWithdrawal(
209:         uint256 _l2BatchNumber,
210:         uint256 _l2MessageIndex,
211:         uint16 _l2TxNumberInBatch,
212:         bytes calldata _message,
213:         bytes32[] calldata _merkleProof
214:     ) external nonReentrant {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1ERC20Bridge.sol#L176-L184) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1ERC20Bridge.sol#L208-L214)


```solidity

File: contracts/bridge/L1SharedBridge.sol

//@audit  ,_data are not checked
182:     function bridgehubDeposit(
183:         uint256 _chainId,
184:         address _prevMsgSender,
185:         uint256, // l2Value, needed for Weth deposits in the future
186:         bytes calldata _data
187:     ) external payable override onlyBridgehub returns (L2TransactionRequestTwoBridgesInner memory request) {

//@audit  ,_txDataHash are not checked
232:     function bridgehubConfirmL2Transaction(
233:         uint256 _chainId,
234:         bytes32 _txDataHash,
235:         bytes32 _txHash
236:     ) external override onlyBridgehub {

//@audit  ,_l2TxHash are not checked
277:     function claimFailedDeposit(
278:         uint256 _chainId,
279:         address _depositSender,
280:         address _l1Token,
281:         uint256 _amount,
282:         bytes32 _l2TxHash,
283:         uint256 _l2BatchNumber,
284:         uint256 _l2MessageIndex,
285:         uint16 _l2TxNumberInBatch,
286:         bytes32[] calldata _merkleProof
287:     ) external override {

//@audit  ,_l2TxHash are not checked
303:     function _claimFailedDeposit(
304:         bool _checkedInLegacyBridge,
305:         uint256 _chainId,
306:         address _depositSender,
307:         address _l1Token,
308:         uint256 _amount,
309:         bytes32 _l2TxHash,
310:         uint256 _l2BatchNumber,
311:         uint256 _l2MessageIndex,
312:         uint16 _l2TxNumberInBatch,
313:         bytes32[] calldata _merkleProof
314:     ) internal nonReentrant {

//@audit  ,_message are not checked
385:     function finalizeWithdrawal(
386:         uint256 _chainId,
387:         uint256 _l2BatchNumber,
388:         uint256 _l2MessageIndex,
389:         uint16 _l2TxNumberInBatch,
390:         bytes calldata _message,
391:         bytes32[] calldata _merkleProof
392:     ) external override {

//@audit  ,_message are not checked
409:     function _finalizeWithdrawal(
410:         uint256 _chainId,
411:         uint256 _l2BatchNumber,
412:         uint256 _l2MessageIndex,
413:         uint16 _l2TxNumberInBatch,
414:         bytes calldata _message,
415:         bytes32[] calldata _merkleProof
416:     ) internal nonReentrant returns (address l1Receiver, address l1Token, uint256 amount) {

//@audit  ,_message are not checked
458:     function _checkWithdrawal(
459:         uint256 _chainId,
460:         MessageParams memory _messageParams,
461:         bytes calldata _message,
462:         bytes32[] calldata _merkleProof
463:     ) internal view returns (address l1Receiver, address l1Token, uint256 amount) {

//@audit  ,_message are not checked
615:     function finalizeWithdrawalLegacyErc20Bridge(
616:         uint256 _l2BatchNumber,
617:         uint256 _l2MessageIndex,
618:         uint16 _l2TxNumberInBatch,
619:         bytes calldata _message,
620:         bytes32[] calldata _merkleProof
621:     ) external override onlyLegacyBridge returns (address l1Receiver, address l1Token, uint256 amount) {

//@audit  ,_l2TxHash are not checked
644:     function claimFailedDepositLegacyErc20Bridge(
645:         address _depositSender,
646:         address _l1Token,
647:         uint256 _amount,
648:         bytes32 _l2TxHash,
649:         uint256 _l2BatchNumber,
650:         uint256 _l2MessageIndex,
651:         uint16 _l2TxNumberInBatch,
652:         bytes32[] calldata _merkleProof
653:     ) external override onlyLegacyBridge {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L182-L187) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L232-L236), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L277-L287), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L303-L314), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L385-L392), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L409-L416), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L458-L463), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L615-L621), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L644-L653)


```solidity

File: contracts/bridgehub/Bridgehub.sol

//@audit  ,_initData are not checked
114:     function createNewChain(
115:         uint256 _chainId,
116:         address _stateTransitionManager,
117:         address _baseToken,
118:         uint256, //_salt
119:         address _admin,
120:         bytes calldata _initData
121:     ) external onlyOwnerOrAdmin nonReentrant returns (uint256 chainId) {

//@audit  ,_l2TxHash are not checked
176:     function proveL1ToL2TransactionStatus(
177:         uint256 _chainId,
178:         bytes32 _l2TxHash,
179:         uint256 _l2BatchNumber,
180:         uint256 _l2MessageIndex,
181:         uint16 _l2TxNumberInBatch,
182:         bytes32[] calldata _merkleProof,
183:         TxStatus _status
184:     ) external view override returns (bool) {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L114-L121) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L176-L184)


```solidity

File: contracts/governance/Governance.sol

//@audit  ,_id are not checked
89:     function isOperationPending(bytes32 _id) public view returns (bool) {
90:         OperationState state = getOperationState(_id);

//@audit  ,_id are not checked
105:     function getOperationState(bytes32 _id) public view returns (OperationState) {
106:         uint256 timestamp = timestamps[_id];

//@audit  ,_id are not checked
142:     function scheduleShadow(bytes32 _id, uint256 _delay) external onlyOwner {
143:         _schedule(_id, _delay);

//@audit  ,_id are not checked
154:     function cancel(bytes32 _id) external onlyOwner {
155:         require(isOperationPending(_id), "Operation must be pending");

//@audit  ,_id are not checked
215:     function _schedule(bytes32 _id, uint256 _delay) internal {
216:         require(!isOperation(_id), "Operation with this proposal id already exists");


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/Governance.sol#L89-L90) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/Governance.sol#L105-L106), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/Governance.sol#L142-L143), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/Governance.sol#L154-L155), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/Governance.sol#L215-L216)


```solidity

File: contracts/state-transition/StateTransitionManager.sol

//@audit  ,_diamondCut are not checked
239:     function createNewChain(
240:         uint256 _chainId,
241:         address _baseToken,
242:         address _sharedBridge,
243:         address _admin,
244:         bytes calldata _diamondCut
245:     ) external onlyBridgehub {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L239-L245) 


```solidity

File: contracts/state-transition/chain-deps/facets/Executor.sol

//@audit  ,_expectedSystemContractUpgradeTxHash are not checked
32:     function _commitOneBatch(
33:         StoredBatchInfo memory _previousBatch,
34:         CommitBatchInfo calldata _newBatch,
35:         bytes32 _expectedSystemContractUpgradeTxHash
36:     ) internal view returns (StoredBatchInfo memory) {

//@audit  ,_systemContractUpgradeTxHash are not checked
273:     function _commitBatchesWithSystemContractsUpgrade(
274:         StoredBatchInfo memory _lastCommittedBatchData,
275:         CommitBatchInfo[] calldata _newBatchesData,
276:         bytes32 _systemContractUpgradeTxHash
277:     ) internal {

//@audit  ,_prevBatchCommitment ,_currentBatchCommitment are not checked
453:     function _getBatchProofPublicInput(
454:         bytes32 _prevBatchCommitment,
455:         bytes32 _currentBatchCommitment,
456:         VerifierParams memory _verifierParams
457:     ) internal pure returns (uint256) {

//@audit  ,_stateDiffHash are not checked
500:     function _createBatchCommitment(
501:         CommitBatchInfo calldata _newBatchData,
502:         bytes32 _stateDiffHash,
503:         bytes32[] memory _blobCommitments,
504:         bytes32[] memory _blobHashes
505:     ) internal view returns (bytes32) {

//@audit  ,_stateDiffHash are not checked
537:     function _batchAuxiliaryOutput(
538:         CommitBatchInfo calldata _batch,
539:         bytes32 _stateDiffHash,
540:         bytes32[] memory _blobCommitments,
541:         bytes32[] memory _blobHashes
542:     ) internal pure returns (bytes memory) {

//@audit  ,_versionedHash ,_openingPoint ,_openingValueCommitmentProof are not checked
605:     function _pointEvaluationPrecompile(
606:         bytes32 _versionedHash,
607:         bytes32 _openingPoint,
608:         bytes calldata _openingValueCommitmentProof
609:     ) internal view {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L32-L36) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L273-L277), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L453-L457), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L500-L505), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L537-L542), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L605-L609)


```solidity

File: contracts/state-transition/chain-deps/facets/Getters.sol

//@audit  ,_selector are not checked
229:     function facetAddress(bytes4 _selector) external view returns (address) {
230:         Diamond.DiamondStorage storage ds = Diamond.getDiamondStorage();


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L229-L230) 


```solidity

File: contracts/state-transition/chain-deps/facets/Mailbox.sol

//@audit  ,_l2TxHash are not checked
74:     function proveL1ToL2TransactionStatus(
75:         bytes32 _l2TxHash,
76:         uint256 _l2BatchNumber,
77:         uint256 _l2MessageIndex,
78:         uint16 _l2TxNumberInBatch,
79:         bytes32[] calldata _merkleProof,
80:         TxStatus _status
81:     ) public view returns (bool) {

//@audit  ,_message are not checked
178:     function finalizeEthWithdrawal(
179:         uint256 _l2BatchNumber,
180:         uint256 _l2MessageIndex,
181:         uint16 _l2TxNumberInBatch,
182:         bytes calldata _message,
183:         bytes32[] calldata _merkleProof
184:     ) external nonReentrant {

//@audit  ,_calldata are not checked
197:     function requestL2Transaction(
198:         address _contractL2,
199:         uint256 _l2Value,
200:         bytes calldata _calldata,
201:         uint256 _l2GasLimit,
202:         uint256 _l2GasPerPubdataByteLimit,
203:         bytes[] calldata _factoryDeps,
204:         address _refundRecipient
205:     ) external payable returns (bytes32 canonicalTxHash) {

//@audit  ,_calldata are not checked
258:     function _requestL2Transaction(
259:         uint256 _mintValue,
260:         WritePriorityOpParams memory _params,
261:         bytes memory _calldata,
262:         bytes[] memory _factoryDeps
263:     ) internal returns (bytes32 canonicalTxHash) {

//@audit  ,_calldata are not checked
289:     function _serializeL2Transaction(
290:         WritePriorityOpParams memory _priorityOpParams,
291:         bytes memory _calldata,
292:         bytes[] memory _factoryDeps
293:     ) internal pure returns (L2CanonicalTransaction memory transaction) {

//@audit  ,_calldata are not checked
316:     function _writePriorityOp(
317:         WritePriorityOpParams memory _priorityOpParams,
318:         bytes memory _calldata,
319:         bytes[] memory _factoryDeps
320:     ) internal returns (bytes32 canonicalTxHash) {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L74-L81) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L178-L184), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L197-L205), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L258-L263), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L289-L293), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L316-L320)


```solidity

File: contracts/upgrades/BaseZkSyncUpgrade.sol

//@audit  ,_bootloaderHash ,_defaultAccountHash are not checked
171:     function _setBaseSystemContracts(bytes32 _bootloaderHash, bytes32 _defaultAccountHash) internal {
172:         _setL2BootloaderBytecodeHash(_bootloaderHash);

//@audit  ,_customCallDataForUpgrade are not checked
263:     function _upgradeL1Contract(bytes calldata _customCallDataForUpgrade) internal virtual {}
264: 

//@audit  ,_customCallDataForUpgrade are not checked
269:     function _postUpgrade(bytes calldata _customCallDataForUpgrade) internal virtual {}
270: }


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgrade.sol#L171-L172) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgrade.sol#L263-L264), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgrade.sol#L269-L270)


```solidity

File: contracts/common/libraries/L2ContractHelper.sol

//@audit  ,_bytecodeHash are not checked
49:     function bytecodeLen(bytes32 _bytecodeHash) internal pure returns (uint256 codeLengthInWords) {
50:         codeLengthInWords = uint256(uint8(_bytecodeHash[2])) * 256 + uint256(uint8(_bytecodeHash[3]));

//@audit  ,_salt ,_bytecodeHash ,_constructorInputHash are not checked
60:     function computeCreate2Address(
61:         address _sender,
62:         bytes32 _salt,
63:         bytes32 _bytecodeHash,
64:         bytes32 _constructorInputHash
65:     ) internal pure returns (address) {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/L2ContractHelper.sol#L49-L50) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/L2ContractHelper.sol#L60-L65)


```solidity

File: contracts/common/libraries/UnsafeBytes.sol

//@audit  ,_bytes are not checked
19:     function readUint32(bytes memory _bytes, uint256 _start) internal pure returns (uint32 result, uint256 offset) {
20:         assembly {

//@audit  ,_bytes are not checked
26:     function readAddress(bytes memory _bytes, uint256 _start) internal pure returns (address result, uint256 offset) {
27:         assembly {

//@audit  ,_bytes are not checked
33:     function readUint256(bytes memory _bytes, uint256 _start) internal pure returns (uint256 result, uint256 offset) {
34:         assembly {

//@audit  ,_bytes are not checked
40:     function readBytes32(bytes memory _bytes, uint256 _start) internal pure returns (bytes32 result, uint256 offset) {
41:         assembly {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/UnsafeBytes.sol#L19-L20) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/UnsafeBytes.sol#L26-L27), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/UnsafeBytes.sol#L33-L34), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/UnsafeBytes.sol#L40-L41)


```solidity

File: contracts/state-transition/libraries/Diamond.sol

//@audit  ,_selector are not checked
205:     function _addOneFunction(address _facet, bytes4 _selector, bool _isSelectorFreezable) private {
206:         DiamondStorage storage ds = getDiamondStorage();

//@audit  ,_selector are not checked
228:     function _removeOneFunction(address _facet, bytes4 _selector) private {
229:         DiamondStorage storage ds = getDiamondStorage();


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L205-L206) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L228-L229)


```solidity

File: contracts/state-transition/libraries/Merkle.sol

//@audit  ,_itemHash are not checked
18:     function calculateRoot(
19:         bytes32[] calldata _path,
20:         uint256 _index,
21:         bytes32 _itemHash
22:     ) internal pure returns (bytes32) {

//@audit  ,_lhs ,_rhs are not checked
40:     function _efficientHash(bytes32 _lhs, bytes32 _rhs) private pure returns (bytes32 result) {
41:         assembly {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Merkle.sol#L18-L22) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Merkle.sol#L40-L41)


```solidity

File: contracts/bridge/L2SharedBridge.sol

//@audit  ,_data are not checked
79:     function finalizeDeposit(
80:         address _l1Sender,
81:         address _l2Receiver,
82:         address _l1Token,
83:         uint256 _amount,
84:         bytes calldata _data
85:     ) external payable override {

//@audit  ,_data are not checked
109:     function _deployL2Token(address _l1Token, bytes calldata _data) internal returns (address) {
110:         bytes32 salt = _getCreate2Salt(_l1Token);

//@audit  ,salt are not checked
164:     function _deployBeaconProxy(bytes32 salt) internal returns (BeaconProxy proxy) {
165:         (bool success, bytes memory returndata) = SystemContractsCaller.systemCallWithReturndata(


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L79-L85) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L109-L110), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L164-L165)


```solidity

File: contracts/bridge/L2StandardERC20.sol

//@audit  ,_data are not checked
50:     function bridgeInitialize(address _l1Address, bytes memory _data) external initializer {
51:         require(_l1Address != address(0), "in6"); // Should be non-zero address

//@audit  ,_input are not checked
178:     function decodeString(bytes memory _input) external pure returns (string memory result) {
179:         (result) = abi.decode(_input, (string));

//@audit  ,_input are not checked
183:     function decodeUint8(bytes memory _input) external pure returns (uint8 result) {
184:         (result) = abi.decode(_input, (uint8));


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2StandardERC20.sol#L50-L51) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2StandardERC20.sol#L178-L179), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2StandardERC20.sol#L183-L184)


```solidity

File: contracts/L2ContractHelper.sol

//@audit  ,_message are not checked
90:     function sendMessageToL1(bytes memory _message) internal returns (bytes32) {
91:         return L2_MESSENGER.sendToL1(_message);

//@audit  ,_salt ,_bytecodeHash ,_constructorInputHash are not checked
101:     function computeCreate2Address(
102:         address _sender,
103:         bytes32 _salt,
104:         bytes32 _bytecodeHash,
105:         bytes32 _constructorInputHash
106:     ) internal pure returns (address) {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/L2ContractHelper.sol#L90-L91) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/L2ContractHelper.sol#L101-L106)


```solidity

File: contracts/SystemContractsCaller.sol

//@audit  ,data are not checked
37:     function systemCall(uint32 gasLimit, address to, uint256 value, bytes memory data) internal returns (bool success) {
38:         address callAddr = SYSTEM_CALL_CALL_ADDRESS;

//@audit  ,data are not checked
76:     function systemCallWithReturndata(
77:         uint32 gasLimit,
78:         address to,
79:         uint128 value,
80:         bytes memory data
81:     ) internal returns (bool success, bytes memory returnData) {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/SystemContractsCaller.sol#L37-L38) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/SystemContractsCaller.sol#L76-L81)


</details>


### [NC&#x2011;20] Events are missing sender information 
When an action is triggered based on a user's action, not being able to filter based on who triggered the action makes event processing a lot more cumbersome. Including the `msg.sender` the events of these types of action will make events much more useful to end users, especially when `msg.sender` is not `tx.origin`.


*There are 69 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/ContractDeployer.sol

355:         emit ContractDeployed(_sender, _bytecodeHash, _newAddress);


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L355-L355) 


```solidity

File: contracts/KnownCodesStorage.sol

59:             emit MarkedAsKnown(_bytecodeHash, _shouldSendToL1);


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/KnownCodesStorage.sol#L59-L59) 


```solidity

File: contracts/L1Messenger.sol

111:         emit L2ToL1LogSent(_l2ToL1Log);

181:         emit BytecodeL1PublicationRequested(_bytecodeHash);


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L111-L111) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L181-L181)


```solidity

File: contracts/L2BaseToken.sol

49:         emit Transfer(_from, _to, _amount);

67:         emit Mint(_account, _amount);


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L2BaseToken.sol#L49-L49) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L2BaseToken.sol#L67-L67)


```solidity

File: contracts/bridge/L1ERC20Bridge.sol

199:         emit ClaimedFailedDeposit(_depositSender, _l1Token, amount);

225:         emit WithdrawalFinalized(l1Receiver, l1Token, amount);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1ERC20Bridge.sol#L199-L199) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1ERC20Bridge.sol#L225-L225)


```solidity

File: contracts/bridge/L1SharedBridge.sol

168:         emit BridgehubDepositBaseTokenInitiated(_chainId, _prevMsgSender, _l1Token, _amount);

227:         emit BridgehubDepositInitiated(_chainId, txDataHash, _prevMsgSender, _l2Receiver, _l1Token, amount);

239:         emit BridgehubDepositFinalized(_chainId, _txDataHash, _txHash);

367:         emit ClaimedFailedDepositSharedBridge(_chainId, _depositSender, _l1Token, _amount);

454:         emit WithdrawalFinalizedSharedBridge(_chainId, l1Receiver, l1Token, amount);

602:         emit LegacyDepositInitiated(ERA_CHAIN_ID, l2TxHash, _prevMsgSender, _l2Receiver, _l1Token, _amount);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L168-L168) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L227-L227), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L239-L239), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L367-L367), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L454-L454), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L602-L602)


```solidity

File: contracts/bridgehub/Bridgehub.sol

56:         emit NewPendingAdmin(oldPendingAdmin, _newPendingAdmin);

68:         emit NewPendingAdmin(currentPendingAdmin, address(0));

69:         emit NewAdmin(previousAdmin, pendingAdmin);

145:         emit NewChain(_chainId, _stateTransitionManager, _admin);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L56-L56) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L68-L68), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L69-L69), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L145-L145)


```solidity

File: contracts/governance/Governance.sol

47:         emit ChangeSecurityCouncil(address(0), _securityCouncil);

50:         emit ChangeMinDelay(0, _minDelay);

132:         emit TransparentOperationScheduled(id, _delay, _operation);

144:         emit ShadowOperationScheduled(_id, _delay);

157:         emit OperationCancelled(_id);

180:         emit OperationExecuted(id);

199:         emit OperationExecuted(id);

250:         emit ChangeMinDelay(minDelay, _newDelay);

257:         emit ChangeSecurityCouncil(securityCouncil, _newSecurityCouncil);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/Governance.sol#L47-L47) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/Governance.sol#L50-L50), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/Governance.sol#L132-L132), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/Governance.sol#L144-L144), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/Governance.sol#L157-L157), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/Governance.sol#L180-L180), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/Governance.sol#L199-L199), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/Governance.sol#L250-L250), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/Governance.sol#L257-L257)


```solidity

File: contracts/state-transition/StateTransitionManager.sol

115:         emit NewPendingAdmin(oldPendingAdmin, _newPendingAdmin);

127:         emit NewPendingAdmin(currentPendingAdmin, address(0));

128:         emit NewAdmin(previousAdmin, pendingAdmin);

227:         emit SetChainIdUpgrade(_chainContract, l2ProtocolUpgradeTx, protocolVersion);

235:         emit StateTransitionNewChain(_chainId, _stateTransitionContract);

287:         emit StateTransitionNewChain(_chainId, stateTransitionAddress);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L115-L115) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L127-L127), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L128-L128), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L227-L227), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L235-L235), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L287-L287)


```solidity

File: contracts/state-transition/ValidatorTimelock.sol

83:         emit ValidatorAdded(_chainId, _newValidator);

92:         emit ValidatorRemoved(_chainId, _validator);

98:         emit NewExecutionDelay(_executionDelay);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L83-L83) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L92-L92), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L98-L98)


```solidity

File: contracts/state-transition/chain-deps/facets/Admin.sol

28:         emit NewPendingAdmin(oldPendingAdmin, _newPendingAdmin);

40:         emit NewPendingAdmin(pendingAdmin, address(0));

41:         emit NewAdmin(previousAdmin, pendingAdmin);

47:         emit ValidatorStatusUpdate(_validator, _active);

54:         emit IsPorterAvailableStatusUpdate(_zkPorterIsAvailable);

63:         emit NewPriorityTxMaxGasLimit(oldPriorityTxMaxGasLimit, _newPriorityTxMaxGasLimit);

75:         emit NewFeeParams(oldFeeParams, _newFeeParams);

86:         emit NewBaseTokenMultiplier(oldNominator, oldDenominator, _nominator, _denominator);

92:         emit ValidiumModeStatusUpdate(_validiumMode);

115:         emit ExecuteUpgrade(_diamondCut);

125:         emit ExecuteUpgrade(_diamondCut);

139:         emit Freeze();

149:         emit Unfreeze();


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Admin.sol#L28-L28) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Admin.sol#L40-L40), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Admin.sol#L41-L41), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Admin.sol#L47-L47), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Admin.sol#L54-L54), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Admin.sol#L63-L63), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Admin.sol#L75-L75), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Admin.sol#L86-L86), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Admin.sol#L92-L92), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Admin.sol#L115-L115), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Admin.sol#L125-L125), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Admin.sol#L139-L139), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Admin.sol#L149-L149)


```solidity

File: contracts/state-transition/chain-deps/facets/Executor.sol

261:             emit BlockCommit(
262:                 _lastCommittedBatchData.batchNumber,
263:                 _lastCommittedBatchData.batchHash,
264:                 _lastCommittedBatchData.commitment
265:             );

299:             emit BlockCommit(
300:                 _lastCommittedBatchData.batchNumber,
301:                 _lastCommittedBatchData.batchHash,
302:                 _lastCommittedBatchData.commitment
303:             );

353:             emit BlockExecution(_batchesData[i].batchNumber, _batchesData[i].batchHash, _batchesData[i].commitment);

436:         emit BlocksVerification(s.totalBatchesVerified, currentTotalBatchesVerified);

496:         emit BlocksRevert(s.totalBatchesCommitted, s.totalBatchesVerified, s.totalBatchesExecuted);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L261-L265) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L299-L303), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L353-L353), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L436-L436), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L496-L496)


```solidity

File: contracts/state-transition/chain-deps/facets/Mailbox.sol

343:         emit NewPriorityRequest(
344:             _priorityOpParams.txId,
345:             canonicalTxHash,
346:             _priorityOpParams.expirationTimestamp,
347:             transaction,
348:             _factoryDeps
349:         );


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L343-L349) 


```solidity

File: contracts/upgrades/BaseZkSyncUpgrade.sol

87:         emit UpgradeComplete(_proposedUpgrade.newProtocolVersion, txHash, _proposedUpgrade);

104:         emit NewL2DefaultAccountBytecodeHash(previousDefaultAccountBytecodeHash, _l2DefaultAccountBytecodeHash);

121:         emit NewL2BootloaderBytecodeHash(previousBootloaderBytecodeHash, _l2BootloaderBytecodeHash);

137:         emit NewVerifier(address(oldVerifier), address(_newVerifier));

157:         emit NewVerifierParams(oldVerifierParams, _newVerifierParams);

256:         emit NewProtocolVersion(previousProtocolVersion, _newProtocolVersion);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgrade.sol#L87-L87) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgrade.sol#L104-L104), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgrade.sol#L121-L121), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgrade.sol#L137-L137), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgrade.sol#L157-L157), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgrade.sol#L256-L256)


```solidity

File: contracts/upgrades/BaseZkSyncUpgradeGenesis.sol

40:         emit NewProtocolVersion(previousProtocolVersion, _newProtocolVersion);

67:         emit UpgradeComplete(_proposedUpgrade.newProtocolVersion, txHash, _proposedUpgrade);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L40-L40) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L67-L67)


```solidity

File: contracts/state-transition/libraries/Diamond.sol

121:         emit DiamondCut(facetCuts, initAddress, initCalldata);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L121-L121) 


```solidity

File: contracts/bridge/L2SharedBridge.sol

105:         emit FinalizeDeposit(_l1Sender, _l2Receiver, expectedL2Token, _amount);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L105-L105) 


```solidity

File: contracts/bridge/L2StandardERC20.sol

101:         emit BridgeInitialize(_l1Address, decodedName, decodedSymbol, decimals_);

126:         emit BridgeInitialize(l1Address, _newName, _newSymbol, decimals_);

147:         emit BridgeMint(_to, _amount);

156:         emit BridgeBurn(_from, _amount);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2StandardERC20.sol#L101-L101) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2StandardERC20.sol#L126-L126), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2StandardERC20.sol#L147-L147), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2StandardERC20.sol#L156-L156)


</details>


### [NC&#x2011;21] Events may be emitted out of order due to reentrancy 
Ensure that events follow the best practice of check-effects-interaction, and are emitted before external calls


*There are 19 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/L1Messenger.sol

111:         emit L2ToL1LogSent(_l2ToL1Log);

156:         emit L1MessageSent(msg.sender, hash, _message);

181:         emit BytecodeL1PublicationRequested(_bytecodeHash);


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L111-L111) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L156-L156), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L181-L181)


```solidity

File: contracts/L2BaseToken.sol

79:         emit Withdrawal(msg.sender, _l1Receiver, amount);

92:         emit WithdrawalWithMessage(msg.sender, _l1Receiver, amount, _additionalData);


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L2BaseToken.sol#L79-L79) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L2BaseToken.sol#L92-L92)


```solidity

File: contracts/bridge/L1SharedBridge.sol

227:         emit BridgehubDepositInitiated(_chainId, txDataHash, _prevMsgSender, _l2Receiver, _l1Token, amount);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L227-L227) 


```solidity

File: contracts/state-transition/StateTransitionManager.sol

227:         emit SetChainIdUpgrade(_chainContract, l2ProtocolUpgradeTx, protocolVersion);

287:         emit StateTransitionNewChain(_chainId, stateTransitionAddress);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L227-L227) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L287-L287)


```solidity

File: contracts/state-transition/chain-deps/facets/Admin.sol

115:         emit ExecuteUpgrade(_diamondCut);

125:         emit ExecuteUpgrade(_diamondCut);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Admin.sol#L115-L115) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Admin.sol#L125-L125)


```solidity

File: contracts/state-transition/chain-deps/facets/Executor.sol

261:             emit BlockCommit(

299:             emit BlockCommit(

353:             emit BlockExecution(_batchesData[i].batchNumber, _batchesData[i].batchHash, _batchesData[i].commitment);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L261-L261) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L299-L299), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L353-L353)


```solidity

File: contracts/state-transition/chain-deps/facets/Mailbox.sol

343:         emit NewPriorityRequest(


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L343-L343) 


```solidity

File: contracts/upgrades/BaseZkSyncUpgrade.sol

104:         emit NewL2DefaultAccountBytecodeHash(previousDefaultAccountBytecodeHash, _l2DefaultAccountBytecodeHash);

121:         emit NewL2BootloaderBytecodeHash(previousBootloaderBytecodeHash, _l2BootloaderBytecodeHash);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgrade.sol#L104-L104) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgrade.sol#L121-L121)


```solidity

File: contracts/bridge/L2SharedBridge.sol

105:         emit FinalizeDeposit(_l1Sender, _l2Receiver, expectedL2Token, _amount);

134:         emit WithdrawalInitiated(msg.sender, _l1Receiver, _l2Token, _amount);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L105-L105) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L134-L134)


```solidity

File: contracts/bridge/L2StandardERC20.sol

126:         emit BridgeInitialize(l1Address, _newName, _newSymbol, decimals_);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2StandardERC20.sol#L126-L126) 


</details>


### [NC&#x2011;22] Explicitly define visibility of state variables to prevent misconceptions on what can access the variable 
Such state variables should be marked as private as this is the default visibility


*There are 13 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/AccountCodeStorage.sol

23:     bytes32 constant EMPTY_STRING_KECCAK = 0xc5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/AccountCodeStorage.sol#L23-L23) 


```solidity

File: contracts/MsgValueSimulator.sol

36:     uint256 constant GAS_TO_PASS = 2300;

41:     uint256 constant MSG_VALUE_SIMULATOR_STIPEND_GAS = 27000;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/MsgValueSimulator.sol#L36-L36) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/MsgValueSimulator.sol#L41-L41)


```solidity

File: contracts/libraries/TransactionHelper.sol

82:     bytes32 constant EIP712_DOMAIN_TYPEHASH = keccak256("EIP712Domain(string name,string version,uint256 chainId)");

84:     bytes32 constant EIP712_TRANSACTION_TYPE_HASH =


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L82-L82) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L84-L84)


```solidity

File: contracts/libraries/Utils.sol

13:     bytes32 constant IS_CONSTRUCTOR_BYTECODE_HASH_BIT_MASK =

17:     bytes32 constant SET_IS_CONSTRUCTOR_MARKER_BIT_MASK =


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L13-L13) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L17-L17)


```solidity

File: contracts/bridge/L1ERC20Bridge.sol

27:     mapping(uint256 l2BatchNumber => mapping(uint256 l2ToL1MessageNumber => bool isFinalized))

32:     mapping(address account => mapping(address l1Token => mapping(bytes32 depositL2TxHash => uint256 amount)))


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1ERC20Bridge.sol#L27-L27) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1ERC20Bridge.sol#L32-L32)


```solidity

File: contracts/bridge/L1SharedBridge.sol

52:     mapping(uint256 chainId => mapping(bytes32 l2DepositTxHash => bytes32 depositDataHash))

57:     mapping(uint256 chainId => mapping(uint256 l2BatchNumber => mapping(uint256 l2ToL1MessageNumber => bool isFinalized)))


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L52-L52) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L57-L57)


```solidity

File: contracts/vendor/AddressAliasHelper.sol

22:     uint160 constant offset = uint160(0x1111000000000000000000000000000000001111);

22:     uint160 constant offset = uint160(0x1111000000000000000000000000000000001111);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/vendor/AddressAliasHelper.sol#L22-L22) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/vendor/AddressAliasHelper.sol#L22-L22)


</details>


### [NC&#x2011;23] Defining All External/Public Functions in Contract Interfaces 
It is preferable to have all the external and public function in an interface to make using them easier by developers. This helps ensure the whole API is extracted in a interface.


*There are 29 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/ContractDeployer.sol

40:     function extendedAccountVersion(address _address) public view returns (AccountAbstractionVersion) {
41:         AccountInfo memory info = accountInfo[_address];

213:     function forceDeployOnAddress(ForceDeployment calldata _deployment, address _sender) external payable onlySelf {
214:         _ensureBytecodeIsKnown(_deployment.bytecodeHash);

238:     function forceDeployOnAddresses(ForceDeployment[] calldata _deployments) external payable {
239:         require(


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L40-L41) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L213-L214), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L238-L239)


```solidity

File: contracts/L1Messenger.sol

194:     function publishPubdataAndClearState(
195:         bytes calldata _totalL2ToL1PubdataAndStateDiffs
196:     ) external onlyCallFromBootloader {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L194-L196) 


```solidity

File: contracts/SystemContext.sol

84:     function setChainId(uint256 _newChainId) external onlyCallFromForceDeployer {
85:         chainId = _newChainId;

099:     function setTxOrigin(address _newOrigin) external onlyCallFromBootloader {
100:         origin = _newOrigin;

105:     function setGasPrice(uint256 _gasPrice) external onlyCallFromBootloader {
106:         gasPrice = _gasPrice;

112:     function setPubdataInfo(uint256 _gasPerPubdataByte, uint256 _basePubdataSpent) external onlyCallFromBootloader {
113:         basePubdataSpent = _basePubdataSpent;

122:     function getCurrentPubdataCost() external view returns (uint256) {
123:         return gasPerPubdataByte * getCurrentPubdataSpent();

341:     function setL2Block(
342:         uint128 _l2BlockNumber,
343:         uint128 _l2BlockTimestamp,
344:         bytes32 _expectedPrevL2BlockHash,
345:         bool _isFirstInBatch,
346:         uint128 _maxVirtualBlocksToCreate
347:     ) external onlyCallFromBootloader {

402:     function appendTransactionToCurrentL2Block(bytes32 _txHash) external onlyCallFromBootloader {
403:         currentL2BlockTxsRollingHash = keccak256(abi.encode(currentL2BlockTxsRollingHash, _txHash));

408:     function publishTimestampDataToL1() external onlyCallFromBootloader {
409:         (uint128 currentBatchNumber, uint128 currentBatchTimestamp) = getBatchNumberAndTimestamp();

444:     function setNewBatch(
445:         bytes32 _prevBatchHash,
446:         uint128 _newTimestamp,
447:         uint128 _expectedNewNumber,
448:         uint256 _baseFee
449:     ) external onlyCallFromBootloader {

471:     function unsafeOverrideBatch(
472:         uint256 _newTimestamp,
473:         uint256 _number,
474:         uint256 _baseFee
475:     ) external onlyCallFromBootloader {

482:     function incrementTxNumberInBatch() external onlyCallFromBootloader {
483:         txNumberInBlock += 1;

486:     function resetTxNumberInBatch() external onlyCallFromBootloader {
487:         txNumberInBlock = 0;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L84-L85) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L99-L100), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L105-L106), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L112-L113), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L122-L123), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L341-L347), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L402-L403), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L408-L409), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L444-L449), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L471-L475), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L482-L483), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L486-L487)


```solidity

File: contracts/bridge/L1SharedBridge.sol

116:     function transferFundsFromLegacy(address _token, address _target, uint256 _targetChainId) external onlyOwner {
117:         if (_token == ETH_TOKEN_ADDRESS) {

142:     function initializeChainGovernance(uint256 _chainId, address _l2BridgeAddress) external onlyOwner {
143:         l2BridgeAddress[_chainId] = _l2BridgeAddress;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L116-L117) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L142-L143)


```solidity

File: contracts/state-transition/ValidatorTimelock.sol

73:     function setStateTransitionManager(IStateTransitionManager _stateTransitionManager) external onlyOwner {
74:         stateTransitionManager = _stateTransitionManager;

78:     function addValidator(uint256 _chainId, address _newValidator) external onlyChainAdmin(_chainId) {
79:         if (validators[_chainId][_newValidator]) {

87:     function removeValidator(uint256 _chainId, address _validator) external onlyChainAdmin(_chainId) {
88:         if (!validators[_chainId][_validator]) {

96:     function setExecutionDelay(uint32 _executionDelay) external onlyOwner {
97:         executionDelay = _executionDelay;

102:     function getCommittedBatchTimestamp(uint256 _chainId, uint256 _l2BatchNumber) external view returns (uint256) {
103:         return committedBatchTimestamp[_chainId].get(_l2BatchNumber);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L73-L74) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L78-L79), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L87-L88), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L96-L97), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L102-L103)


```solidity

File: contracts/bridge/L2SharedBridge.sol

49:     function initialize(
50:         address _l1Bridge,
51:         address _l1LegecyBridge,
52:         bytes32 _l2TokenProxyBytecodeHash,
53:         address _aliasedOwner
54:     ) external reinitializer(2) {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L49-L54) 


```solidity

File: contracts/bridge/L2StandardERC20.sol

50:     function bridgeInitialize(address _l1Address, bytes memory _data) external initializer {
51:         require(_l1Address != address(0), "in6"); // Should be non-zero address

111:     function reinitializeToken(
112:         ERC20Getters calldata _availableGetters,
113:         string memory _newName,
114:         string memory _newSymbol,
115:         uint8 _version
116:     ) external onlyNextVersion(_version) reinitializer(_version) {

178:     function decodeString(bytes memory _input) external pure returns (string memory result) {
179:         (result) = abi.decode(_input, (string));

183:     function decodeUint8(bytes memory _input) external pure returns (uint8 result) {
184:         (result) = abi.decode(_input, (uint8));


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2StandardERC20.sol#L50-L51) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2StandardERC20.sol#L111-L116), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2StandardERC20.sol#L178-L179), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2StandardERC20.sol#L183-L184)


```solidity

File: contracts/ForceDeployUpgrader.sol

13:     function forceDeploy(IContractDeployer.ForceDeployment[] calldata _forceDeployments) external payable {
14:         IContractDeployer(DEPLOYER_SYSTEM_CONTRACT).forceDeployOnAddresses{value: msg.value}(_forceDeployments);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/ForceDeployUpgrader.sol#L13-L14) 


</details>


### [NC&#x2011;24] Function ordering does not follow the Solidity style guide 
According to the [Solidity style guide](https://docs.soliditylang.org/en/v0.8.17/style-guide.html#order-of-functions), functions should be laid out in the following order :`constructor()`, `receive()`, `fallback()`, `external`, `public`, `internal`, `private`, but the cases below do not follow this pattern


*There are 30 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/AccountCodeStorage.sol

78:     function getRawCodeHash(address _address) public view override returns (bytes32 codeHash) {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/AccountCodeStorage.sol#L78-L78) 


```solidity

File: contracts/ContractDeployer.sol

65:     function updateAccountVersion(AccountAbstractionVersion _version) external onlySystemCall {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L65-L65) 


```solidity

File: contracts/DefaultAccount.sol

112:     function executeTransaction(


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/DefaultAccount.sol#L112-L112) 


```solidity

File: contracts/EmptyContract.sol

13:     receive() external payable {}


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/EmptyContract.sol#L13-L13) 


```solidity

File: contracts/KnownCodesStorage.sol

65:     function getMarker(bytes32 _hash) public view override returns (uint256 marker) {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/KnownCodesStorage.sol#L65-L65) 


```solidity

File: contracts/L1Messenger.sol

70:     function sendL2ToL1Log(


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L70-L70) 


```solidity

File: contracts/L2BaseToken.sol

128:     function name() external pure override returns (string memory) {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L2BaseToken.sol#L128-L128) 


```solidity

File: contracts/MsgValueSimulator.sol

47:     fallback(bytes calldata _data) external onlySystemCall returns (bytes memory) {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/MsgValueSimulator.sol#L47-L47) 


```solidity

File: contracts/NonceHolder.sol

110:     function incrementMinNonceIfEquals(uint256 _expectedNonce) external onlySystemCall {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/NonceHolder.sol#L110-L110) 


```solidity

File: contracts/PubdataChunkPublisher.sol

21:     function chunkAndPublishPubdata(bytes calldata _pubdata) external onlyCallFrom(address(L1_MESSENGER_CONTRACT)) {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/PubdataChunkPublisher.sol#L21-L21) 


```solidity

File: contracts/SystemContext.sol

84:     function setChainId(uint256 _newChainId) external onlyCallFromForceDeployer {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L84-L84) 


```solidity

File: contracts/libraries/EfficientCall.sol

232:     function propagateRevert() internal pure {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L232-L232) 


```solidity

File: contracts/libraries/TransactionHelper.sol

362:     function processPaymasterInput(Transaction calldata _transaction) internal {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L362-L362) 


```solidity

File: contracts/bridge/L1ERC20Bridge.sol

176:     function claimFailedDeposit(


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1ERC20Bridge.sol#L176-L176) 


```solidity

File: contracts/bridge/L1SharedBridge.sol

182:     function bridgehubDeposit(


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L182-L182) 


```solidity

File: contracts/bridgehub/Bridgehub.sol

82:     function addStateTransitionManager(address _stateTransitionManager) external onlyOwner {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L82-L82) 


```solidity

File: contracts/governance/Governance.sol

129:     function scheduleTransparent(Operation calldata _operation, uint256 _delay) external onlyOwner {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/Governance.sol#L129-L129) 


```solidity

File: contracts/state-transition/StateTransitionManager.sol

230:     function registerAlreadyDeployedStateTransition(


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L230-L230) 


```solidity

File: contracts/state-transition/chain-deps/facets/Executor.sol

199:     function commitBatches(


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L199-L199) 


```solidity

File: contracts/state-transition/chain-deps/facets/Mailbox.sol

64:     function proveL2LogInclusion(


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L64-L64) 


```solidity

File: contracts/upgrades/BaseZkSyncUpgrade.sol

163:     function _upgradeVerifier(address _newVerifier, VerifierParams calldata _verifierParams) internal {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgrade.sol#L163-L163) 


```solidity

File: contracts/upgrades/BaseZkSyncUpgradeGenesis.sol

47:     function upgrade(ProposedUpgrade calldata _proposedUpgrade) public virtual override returns (bytes32) {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L47-L47) 


```solidity

File: contracts/bridge/L2SharedBridge.sol

123:     function withdraw(address _l1Receiver, address _l2Token, uint256 _amount) external override {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L123-L123) 


```solidity

File: contracts/bridge/L2StandardERC20.sol

178:     function decodeString(bytes memory _input) external pure returns (string memory result) {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2StandardERC20.sol#L178-L178) 


```solidity

File: contracts/bridge/interfaces/IL1ERC20Bridge.sol

9:     function finalizeWithdrawal(


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL1ERC20Bridge.sol#L9-L9) 


```solidity

File: contracts/bridge/interfaces/IL1SharedBridge.sol

9:     function finalizeWithdrawal(


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL1SharedBridge.sol#L9-L9) 


```solidity

File: contracts/bridge/interfaces/IL2SharedBridge.sol

24:     function finalizeDeposit(


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL2SharedBridge.sol#L24-L24) 


```solidity

File: contracts/bridge/interfaces/IL2StandardToken.sol

12:     function bridgeMint(address _account, uint256 _amount) external;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL2StandardToken.sol#L12-L12) 


```solidity

File: contracts/interfaces/IPaymaster.sol

28:     function validateAndPayForPaymasterTransaction(


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/interfaces/IPaymaster.sol#L28-L28) 


```solidity

File: contracts/interfaces/IPaymasterFlow.sol

14:     function general(bytes calldata input) external;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/interfaces/IPaymasterFlow.sol#L14-L14) 


</details>


### [NC&#x2011;25] `address`s shouldn't be hard-coded 
It is often better to declare `address`es as `immutable`, and assign them via constructor arguments. This allows the code to remain the same across deployments on different networks, and avoids recompilation when addresses need to change.


*There are 2 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/vendor/AddressAliasHelper.sol

//@audit hardcoded address : 0x1111000000000000000000000000000000001111
22:     uint160 constant offset = uint160(0x1111000000000000000000000000000000001111);

//@audit hardcoded address : 0x1111000000000000000000000000000000001111
22:     uint160 constant offset = uint160(0x1111000000000000000000000000000000001111);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/vendor/AddressAliasHelper.sol#L22-L22) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/vendor/AddressAliasHelper.sol#L22-L22)


</details>


### [NC&#x2011;26] Array indicies should be referenced via `enum`s rather than via numeric literals 
Consider using an enum instead of hardcoding an index access to make the code easier to understand.


*There are 22 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/KnownCodesStorage.sol

//@audit `_bytecodeHash`
75:         uint8 version = uint8(_bytecodeHash[0]);

//@audit `_bytecodeHash`
76:         require(version == 1 && _bytecodeHash[1] == bytes1(0), "Incorrectly formatted bytecodeHash");


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/KnownCodesStorage.sol#L75-L75) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/KnownCodesStorage.sol#L76-L76)


```solidity

File: contracts/L1Messenger.sol

//@audit `l2ToL1LogsTreeArray`
230:         bytes32 l2ToL1LogsTreeRoot = l2ToL1LogsTreeArray[0];


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L230-L230) 


```solidity

File: contracts/PubdataChunkPublisher.sol

//@audit `blobHashes`
55:         SystemContractHelper.toL1(true, bytes32(uint256(SystemLogKey.BLOB_ONE_HASH_KEY)), blobHashes[0]);

//@audit `blobHashes`
56:         SystemContractHelper.toL1(true, bytes32(uint256(SystemLogKey.BLOB_TWO_HASH_KEY)), blobHashes[1]);


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/PubdataChunkPublisher.sol#L55-L55) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/PubdataChunkPublisher.sol#L56-L56)


```solidity

File: contracts/libraries/RLPEncoder.sol

//@audit `encoded`
34:                 encoded[0] = bytes1(uint8(hbs + 0x81));

//@audit `encoded`
29:                 encoded[0] = (_val == 0) ? bytes1(uint8(128)) : bytes1(uint8(_val));

//@audit `encoded`
69:                 encoded[0] = bytes1(uint8(_offset + hbs + 56));

//@audit `encoded`
64:                 encoded[0] = bytes1(uint8(_len + _offset));


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/RLPEncoder.sol#L34-L34) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/RLPEncoder.sol#L29-L29), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/RLPEncoder.sol#L69-L69), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/RLPEncoder.sol#L64-L64)


```solidity

File: contracts/libraries/Utils.sol

//@audit `_bytecodeHash`
52:         return _bytecodeHash[1] == 0x00;

//@audit `_bytecodeHash`
57:         return _bytecodeHash[1] == 0x01;

//@audit `_bytecodeHash`
46:             codeLengthInWords = uint256(uint8(_bytecodeHash[2])) * 256 + uint256(uint8(_bytecodeHash[3]));

//@audit `_bytecodeHash`
46:             codeLengthInWords = uint256(uint8(_bytecodeHash[2])) * 256 + uint256(uint8(_bytecodeHash[3]));


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L52-L52) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L57-L57), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L46-L46), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L46-L46)


```solidity

File: contracts/state-transition/chain-deps/facets/Executor.sol

//@audit `_newBatchesData`
287:         s.l2SystemContractsUpgradeBatchNumber = _newBatchesData[0].batchNumber;

//@audit `blobHashes`
55:             blobHashes[0] = logOutput.blob1Hash;

//@audit `blobHashes`
56:             blobHashes[1] = logOutput.blob2Hash;

//@audit `blobHashes`
66:             blobHashes[0] = logOutput.blob1Hash;

//@audit `blobCommitments`
67:             blobCommitments[0] = bytes32(


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L287-L287) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L55-L55), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L56-L56), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L66-L66), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L67-L67)


```solidity

File: contracts/common/libraries/L2ContractHelper.sol

//@audit `_bytecodeHash`
40:         uint8 version = uint8(_bytecodeHash[0]);

//@audit `_bytecodeHash`
41:         require(version == 1 && _bytecodeHash[1] == bytes1(0), "zf"); // Incorrectly formatted bytecodeHash

//@audit `_bytecodeHash`
50:         codeLengthInWords = uint256(uint8(_bytecodeHash[2])) * 256 + uint256(uint8(_bytecodeHash[3]));

//@audit `_bytecodeHash`
50:         codeLengthInWords = uint256(uint8(_bytecodeHash[2])) * 256 + uint256(uint8(_bytecodeHash[3]));


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/L2ContractHelper.sol#L40-L40) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/L2ContractHelper.sol#L41-L41), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/L2ContractHelper.sol#L50-L50), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/L2ContractHelper.sol#L50-L50)


</details>


### [NC&#x2011;27] Hardcoded string that is repeatedly used can be replaced with a constant 
For better maintainability, please consider creating and using a constant for those strings instead of hardcoding 


*There are 5 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/AccountCodeStorage.sol

//@audit `Code hash is not for a contract on constructor` is used multiple time consider using a constant for it.
37:         require(Utils.isContractConstructing(_hash), "Code hash is not for a contract on constructor");


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/AccountCodeStorage.sol#L37-L37) 


```solidity

File: contracts/BootloaderUtilities.sol

//@audit `Invalid v value` is used multiple time consider using a constant for it.
92:             require(vInt == 27 || vInt == 28, "Invalid v value");


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L92-L92) 


```solidity

File: contracts/libraries/Utils.sol

//@audit `Overflow` is used multiple time consider using a constant for it.
21:         require(_x <= type(uint128).max, "Overflow");


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L21-L21) 


```solidity

File: contracts/state-transition/ValidatorTimelock.sol

//@audit `5c` is used multiple time consider using a constant for it.
195:                 require(block.timestamp >= commitBatchTimestamp + delay, "5c"); // The delay is not passed


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L195-L195) 


```solidity

File: contracts/bridge/L2SharedBridge.sol

//@audit `df` is used multiple time consider using a constant for it.
56:         require(_l2TokenProxyBytecodeHash != bytes32(0), "df");


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L56-L56) 


</details>


### [NC&#x2011;28] Duplicated `require()` checks should be refactored to a modifier or function 
The compiler will inline the function, which will avoid `JUMP` instructions usually associated with functions


*There are 7 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/BootloaderUtilities.sol

92:             require(vInt == 27 || vInt == 28, "Invalid v value");


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L92-L92) 


```solidity

File: contracts/bridge/L1ERC20Bridge.sol

143:         require(amount == _amount, "3T"); // The token has non-standard transfer logic


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1ERC20Bridge.sol#L143-L143) 


```solidity

File: contracts/bridgehub/Bridgehub.sol

62:         require(msg.sender == currentPendingAdmin, "n42"); // Only proposed by current admin address can claim the admin rights


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L62-L62) 


```solidity

File: contracts/state-transition/ValidatorTimelock.sol

195:                 require(block.timestamp >= commitBatchTimestamp + delay, "5c"); // The delay is not passed


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L195-L195) 


```solidity

File: contracts/upgrades/BaseZkSyncUpgrade.sol

72:         require(block.timestamp >= _proposedUpgrade.upgradeTimestamp, "Upgrade is not ready yet");

249:         require(s.l2SystemContractsUpgradeTxHash == bytes32(0), "Previous upgrade has not been finalized");


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgrade.sol#L72-L72) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgrade.sol#L249-L249)


```solidity

File: contracts/bridge/L2SharedBridge.sol

56:         require(_l2TokenProxyBytecodeHash != bytes32(0), "df");


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L56-L56) 


</details>


### [NC&#x2011;29] Some if-statement can be converted to a ternary 
Improving code readability and compactness is an integral part of optimal programming practices. The use of ternary operators in place of if-else conditions is one such measure. Ternary operators allow us to write conditional statements in a more concise manner, thereby enhancing readability and simplicity. They follow the syntax `condition ? exprIfTrue : exprIfFalse`, which interprets as "if the condition is true, evaluate to `exprIfTrue`, else evaluate to `exprIfFalse`". By adopting this approach, we make our code more streamlined and intuitive, which could potentially aid in better understanding and maintenance of the codebase.


*There are 11 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/BootloaderUtilities.sol

34:         } else if (_transaction.txType == EIP_2930_TX_TYPE) {
35:             txHash = encodeEIP2930TransactionHash(_transaction);
36:         } else {
37:             revert("Unsupported tx type");
38:         }


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L34-L38) 


```solidity

File: contracts/Compressor.sol

236:             } else if (_operation == 2) {
237:                 require(
238:                     _initialValue - convertedValue == _finalValue,
239:                     "sub: initial minus converted not equal to final"
240:                 );
241:             } else {
242:                 revert("unsupported operation");
243:             }


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Compressor.sol#L236-L243) 


```solidity

File: contracts/SystemContext.sol

150:         } else if (
151:             _block >= currentVirtualBlockUpgradeInfo.virtualBlockFinishL2Block &&
152:             currentVirtualBlockUpgradeInfo.virtualBlockFinishL2Block > 0
153:         ) {
154:             hash = _getLatest257L2blockHash(_block);
155:         } else {
156:             // Important: we do not want this number to ever collide with the L2 block hash (either new or old one) and so
157:             // that's why the legacy L2 blocks' hashes are keccak256(abi.encodePacked(uint32(_block))), while these are equivalent to
158:             // keccak256(abi.encodePacked(_block))
159:             hash = keccak256(abi.encode(_block));
160:         }


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L150-L160) 


```solidity

File: contracts/libraries/TransactionHelper.sol

406:         if (address(uint160(_transaction.paymaster)) != address(0)) {
407:             // Paymaster pays for the fee
408:             requiredBalance = _transaction.value;
409:         } else {
410:             // The user should have enough balance for both the fee and the value of the transaction
411:             requiredBalance = _transaction.maxFeePerGas * _transaction.gasLimit + _transaction.value;
412:         }

107:         } else if (_transaction.txType == EIP_2930_TX_TYPE) {
108:             resultHash = _encodeHashEIP2930Transaction(_transaction);
109:         } else {
110:             // Currently no other transaction types are supported.
111:             // Any new transaction types will be processed in a similar manner.
112:             revert("Encoding unsupported tx");
113:         }


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L406-L412) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L107-L113)


```solidity

File: contracts/bridgehub/Bridgehub.sol

222:             if (token == ETH_TOKEN_ADDRESS) {
223:                 require(msg.value == _request.mintValue, "Bridgehub: msg.value mismatch 1");
224:             } else {
225:                 require(msg.value == 0, "Bridgehub: non-eth bridge with msg.value");
226:             }

329:         } else if (_refundRecipient.code.length > 0) {
330:             // If the `_refundRecipient` is a smart contract, we apply the L1 to L2 alias to prevent foot guns.
331:             _recipient = AddressAliasHelper.applyL1ToL2Alias(_refundRecipient);
332:         } else {
333:             _recipient = _refundRecipient;
334:         }


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L222-L226) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L329-L334)


```solidity

File: contracts/governance/Governance.sol

111:         } else if (timestamp > block.timestamp) {
112:             return OperationState.Waiting;
113:         } else {
114:             return OperationState.Ready;
115:         }


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/Governance.sol#L111-L115) 


```solidity

File: contracts/state-transition/chain-deps/facets/Executor.sol

191:         if (_expectedSystemContractUpgradeTxHash == bytes32(0)) {
192:             require(processedLogs == 511, "b7");
193:         } else {
194:             require(processedLogs == 1023, "b8");
195:         }

237:         if (systemContractsUpgradeTxHash == bytes32(0) || s.l2SystemContractsUpgradeBatchNumber != 0) {
238:             _commitBatchesWithoutSystemContractsUpgrade(_lastCommittedBatchData, _newBatchesData);
239:         } else {
240:             _commitBatchesWithSystemContractsUpgrade(
241:                 _lastCommittedBatchData,
242:                 _newBatchesData,
243:                 systemContractsUpgradeTxHash
244:             );
245:         }


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L191-L195) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L237-L245)


```solidity

File: contracts/state-transition/libraries/Diamond.sol

113:             } else if (action == Action.Remove) {
114:                 _removeFunctions(facet, selectors);
115:             } else {
116:                 revert("C"); // undefined diamond cut action
117:             }


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L113-L117) 


</details>


### [NC&#x2011;30] Imports could be organized more systematically 
The contract used interfaces should be imported first, followed by all other files. The examples below do not follow this layout.


*There are 19 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/SystemContext.sol

7: import {ISystemContextDeprecated} from "./interfaces/ISystemContextDeprecated.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L7-L7) 


```solidity

File: contracts/libraries/TransactionHelper.sol

8: import "../interfaces/IPaymasterFlow.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L8-L8) 


```solidity

File: contracts/bridge/L1ERC20Bridge.sol

8: import {IL1ERC20Bridge} from "./interfaces/IL1ERC20Bridge.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1ERC20Bridge.sol#L8-L8) 


```solidity

File: contracts/bridge/L1SharedBridge.sol

8: import {IERC20Metadata} from "@openzeppelin/contracts/token/ERC20/extensions/IERC20Metadata.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L8-L8) 


```solidity

File: contracts/bridgehub/Bridgehub.sol

7: import "./IBridgehub.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L7-L7) 


```solidity

File: contracts/governance/Governance.sol

6: import {IGovernance} from "./IGovernance.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/Governance.sol#L6-L6) 


```solidity

File: contracts/state-transition/StateTransitionManager.sol

7: import {IAdmin} from "./chain-interfaces/IAdmin.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L7-L7) 


```solidity

File: contracts/state-transition/ValidatorTimelock.sol

7: import {IExecutor} from "./chain-interfaces/IExecutor.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L7-L7) 


```solidity

File: contracts/state-transition/chain-deps/facets/Admin.sol

10: import {IStateTransitionManager} from "../../IStateTransitionManager.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Admin.sol#L10-L10) 


```solidity

File: contracts/state-transition/chain-deps/facets/Executor.sol

11: import {VerifierParams} from "../../chain-interfaces/IVerifier.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L11-L11) 


```solidity

File: contracts/state-transition/chain-deps/facets/Getters.sol

11: import {IGetters} from "../../chain-interfaces/IGetters.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L11-L11) 


```solidity

File: contracts/state-transition/chain-deps/facets/Mailbox.sol

7: import {IMailbox} from "../../chain-interfaces/IMailbox.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L7-L7) 


```solidity

File: contracts/upgrades/BaseZkSyncUpgrade.sol

6: import {IMailbox} from "../state-transition/chain-interfaces/IMailbox.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgrade.sol#L6-L6) 


```solidity

File: contracts/upgrades/BaseZkSyncUpgradeGenesis.sol

6: import "../state-transition/chain-interfaces/IMailbox.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L6-L6) 


```solidity

File: contracts/upgrades/GenesisUpgrade.sol

7: import "./IDefaultUpgrade.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/GenesisUpgrade.sol#L7-L7) 


```solidity

File: contracts/state-transition/chain-interfaces/IGetters.sol

6: import {VerifierParams} from "../chain-interfaces/IVerifier.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IGetters.sol#L6-L6) 


```solidity

File: contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol

10: import {VerifierParams} from "./IVerifier.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol#L10-L10) 


```solidity

File: contracts/bridge/L2SharedBridge.sol

9: import {IL1ERC20Bridge} from "./interfaces/IL1ERC20Bridge.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L9-L9) 


```solidity

File: contracts/bridge/L2StandardERC20.sol

9: import {IL2StandardToken} from "./interfaces/IL2StandardToken.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2StandardERC20.sol#L9-L9) 


</details>


### [NC&#x2011;31] Import declarations should import specific identifiers, rather than the whole file 
Using import declarations of the form `import {<identifier_name>} from "some/ file.sol"` avoids polluting the symbol namespace making flattened files smaller, and speeds up compilation


*There are 41 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/AccountCodeStorage.sol

5: import "./interfaces/IAccountCodeStorage.sol";

6: import "./libraries/Utils.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/AccountCodeStorage.sol#L5-L5) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/AccountCodeStorage.sol#L6-L6)


```solidity

File: contracts/DefaultAccount.sol

5: import "./interfaces/IAccount.sol";

6: import "./libraries/TransactionHelper.sol";

7: import "./libraries/SystemContractHelper.sol";

8: import "./libraries/EfficientCall.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/DefaultAccount.sol#L5-L5) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/DefaultAccount.sol#L6-L6), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/DefaultAccount.sol#L7-L7), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/DefaultAccount.sol#L8-L8)


```solidity

File: contracts/libraries/EfficientCall.sol

5: import "./SystemContractHelper.sol";

6: import "./Utils.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L5-L5) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L6-L6)


```solidity

File: contracts/libraries/SystemContractsCaller.sol

6: import "./Utils.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractsCaller.sol#L6-L6) 


```solidity

File: contracts/libraries/TransactionHelper.sol

5: import "../openzeppelin/token/ERC20/IERC20.sol";

6: import "../openzeppelin/token/ERC20/utils/SafeERC20.sol";

8: import "../interfaces/IPaymasterFlow.sol";

9: import "../interfaces/IContractDeployer.sol";

11: import "./RLPEncoder.sol";

12: import "./EfficientCall.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L5-L5) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L6-L6), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L8-L8), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L9-L9), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L11-L11), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L12-L12)


```solidity

File: contracts/libraries/Utils.sol

4: import "./EfficientCall.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L4-L4) 


```solidity

File: contracts/interfaces/IAccount.sol

5: import "../libraries/TransactionHelper.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IAccount.sol#L5-L5) 


```solidity

File: contracts/interfaces/IBootloaderUtilities.sol

5: import "../libraries/TransactionHelper.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IBootloaderUtilities.sol#L5-L5) 


```solidity

File: contracts/interfaces/IPaymaster.sol

5: import "../libraries/TransactionHelper.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IPaymaster.sol#L5-L5) 


```solidity

File: contracts/bridgehub/Bridgehub.sol

7: import "./IBridgehub.sol";

8: import "../bridge/interfaces/IL1SharedBridge.sol";

9: import "../state-transition/IStateTransitionManager.sol";

10: import "../common/ReentrancyGuard.sol";

11: import "../state-transition/chain-interfaces/IZkSyncStateTransition.sol";

14: import "../vendor/AddressAliasHelper.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L7-L7) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L8-L8), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L9-L9), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L10-L10), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L11-L11), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L14-L14)


```solidity

File: contracts/state-transition/chain-deps/DiamondInit.sol

12: import "../l2-deps/ISystemContext.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/DiamondInit.sol#L12-L12) 


```solidity

File: contracts/upgrades/BaseZkSyncUpgradeGenesis.sol

5: import "../state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol";

6: import "../state-transition/chain-interfaces/IMailbox.sol";

7: import "../state-transition/chain-interfaces/IVerifier.sol";

8: import "../common/libraries/L2ContractHelper.sol";

9: import "../common/Messaging.sol";

10: import "../state-transition/libraries/TransactionValidator.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L5-L5) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L6-L6), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L7-L7), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L8-L8), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L9-L9), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L10-L10)


```solidity

File: contracts/upgrades/GenesisUpgrade.sol

5: import "../state-transition/libraries/Diamond.sol";

6: import "./BaseZkSyncUpgradeGenesis.sol";

7: import "./IDefaultUpgrade.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/GenesisUpgrade.sol#L5-L5) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/GenesisUpgrade.sol#L6-L6), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/GenesisUpgrade.sol#L7-L7)


```solidity

File: contracts/bridge/interfaces/IL1ERC20Bridge.sol

5: import "./IL1SharedBridge.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1ERC20Bridge.sol#L5-L5) 


```solidity

File: contracts/bridgehub/IBridgehub.sol

6: import "../common/Messaging.sol";

7: import "../state-transition/IStateTransitionManager.sol";

8: import "../state-transition/libraries/Diamond.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L6-L6) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L7-L7), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L8-L8)


```solidity

File: contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol

13: import "../libraries/Diamond.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol#L13-L13) 


```solidity

File: contracts/interfaces/IPaymaster.sol

5: import "../L2ContractHelper.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/interfaces/IPaymaster.sol#L5-L5) 


</details>


### [NC&#x2011;32] Inconsistent spacing in comments 
Some lines use `// x` and some use `//x`. The instances below point out the usages that don't follow the majority, within each file


*There are 16 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/Constants.sol

20: uint160 constant SYSTEM_CONTRACTS_OFFSET = 123456;//{{SYSTEM_CONTRACTS_OFFSET}}; // 2^15


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Constants.sol#L20-L20) 


```solidity

File: contracts/bridgehub/Bridgehub.sol

118:         uint256, //_salt


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L118-L118) 


```solidity

File: contracts/state-transition/StateTransitionManager.sol

186:             gasLimit: 1,//$(PRIORITY_TX_MAX_GAS_LIMIT),


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L186-L186) 


```solidity

File: contracts/common/Config.sol

50: uint256 constant MAX_GAS_PER_TRANSACTION = 1;//$(MAX_GAS_PER_TRANSACTION);

54: uint256 constant L1_GAS_PER_PUBDATA_BYTE = 1;//$(L1_GAS_PER_PUBDATA_BYTE);

57: uint256 constant L1_TX_INTRINSIC_L2_GAS = 1;//$(L1_TX_INTRINSIC_L2_GAS);

60: uint256 constant L1_TX_INTRINSIC_PUBDATA = 1;//$(L1_TX_INTRINSIC_PUBDATA);

63: uint256 constant L1_TX_MIN_L2_GAS_BASE = 1;//$(L1_TX_MIN_L2_GAS_BASE);

66: uint256 constant L1_TX_DELTA_544_ENCODING_BYTES = 1;//$(L1_TX_DELTA_544_ENCODING_BYTES);

69: uint256 constant L1_TX_DELTA_FACTORY_DEPS_L2_GAS = 1;//$(L1_TX_DELTA_FACTORY_DEPS_L2_GAS);

72: uint256 constant L1_TX_DELTA_FACTORY_DEPS_PUBDATA = 1;//$(L1_TX_DELTA_FACTORY_DEPS_PUBDATA);

75: uint256 constant MAX_NEW_FACTORY_DEPS = 1;//$(MAX_NEW_FACTORY_DEPS);

78: uint256 constant REQUIRED_L2_GAS_PRICE_PER_PUBDATA = 1;//$(REQUIRED_L2_GAS_PRICE_PER_PUBDATA);

104: uint256 constant ERA_CHAIN_ID = 1;//$(ERA_CHAIN_ID);

107: address constant ERA_ERC20_BRIDGE_ADDRESS = address(1);//$(ERA_ERC20_BRIDGE_ADDRESS);

110: address constant ERA_DIAMOND_PROXY = address(1);//$(ERA_DIAMOND_PROXY);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/Config.sol#L50-L50) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/Config.sol#L54-L54), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/Config.sol#L57-L57), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/Config.sol#L60-L60), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/Config.sol#L63-L63), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/Config.sol#L66-L66), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/Config.sol#L69-L69), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/Config.sol#L72-L72), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/Config.sol#L75-L75), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/Config.sol#L78-L78), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/Config.sol#L104-L104), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/Config.sol#L107-L107), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/Config.sol#L110-L110)


</details>


### [NC&#x2011;33] Inconsistent usage of `require`/`error` 
Some parts of the codebase use `require` statements, while others use custom `error`s. Consider refactoring the code to use the same approach: the following findings represent the minority of `require` vs `error`, and they show the first occurance in each file, for brevity.


*There are 2 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/state-transition/ValidatorTimelock.sol

80:             revert AddressAlreadyValidator(_chainId);

89:             revert ValidatorDoesNotExist(_chainId);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L80-L80) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L89-L89)


</details>


### [NC&#x2011;34] `internal` functions not called by the contract should be removed 
If the functions are required by an interface, the contract should inherit from that interface and use the `override` keyword


*There are 10 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/libraries/EfficientCall.sol

88:     function delegateCall(


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L88-L88) 


```solidity

File: contracts/libraries/SystemContractHelper.sol

124:     function packPrecompileParams(

181:     function eventInitialize(uint256 initializer, uint256 value1) internal {

191:     function eventWrite(uint256 value1, uint256 value2) internal {

307:     function getCalldataPtr() internal view returns (uint256 ptr) {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L124-L124) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L181-L181), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L191-L191), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L307-L307)


```solidity

File: contracts/libraries/TransactionHelper.sol

94:     function isEthToken(uint256 _addr) internal pure returns (bool) {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L94-L94) 


```solidity

File: contracts/libraries/UnsafeBytesCalldata.sol

26:     function readUint32(bytes calldata _bytes, uint256 _start) internal pure returns (uint32 result) {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/UnsafeBytesCalldata.sol#L26-L26) 


```solidity

File: contracts/libraries/Utils.sol

32:     function safeCastToU24(uint256 _x) internal pure returns (uint24) {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L32-L32) 


```solidity

File: contracts/vendor/AddressAliasHelper.sol

38:     function undoL1ToL2Alias(address l2Address) internal pure returns (address l1Address) {

28:     function applyL1ToL2Alias(address l1Address) internal pure returns (address l2Address) {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/vendor/AddressAliasHelper.sol#L38-L38) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/vendor/AddressAliasHelper.sol#L28-L28)


</details>


### [NC&#x2011;35] Large numeric literals should use underscores for readability 



*There are 8 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/Constants.sol

20: uint160 constant SYSTEM_CONTRACTS_OFFSET = 123456;//{{SYSTEM_CONTRACTS_OFFSET}}; // 2^15

108: uint256 constant MAX_ALLOWED_PUBDATA_PER_BATCH = 520000;

125: uint256 constant L2_TO_L1_LOGS_MERKLE_TREE_LEAVES = 4096;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Constants.sol#L20-L20) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Constants.sol#L108-L108), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Constants.sol#L125-L125)


```solidity

File: contracts/MsgValueSimulator.sol

36:     uint256 constant GAS_TO_PASS = 2300;

41:     uint256 constant MSG_VALUE_SIMULATOR_STIPEND_GAS = 27000;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/MsgValueSimulator.sol#L36-L36) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/MsgValueSimulator.sol#L41-L41)


```solidity

File: contracts/state-transition/chain-deps/facets/Executor.sol

194:             require(processedLogs == 1023, "b8");


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L194-L194) 


```solidity

File: contracts/state-transition/chain-interfaces/IExecutor.sol

50: uint256 constant BLS_MODULUS = 52435875175126190479447740508185965837690552500527637822603658699938581184513;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IExecutor.sol#L50-L50) 


```solidity

File: contracts/common/Config.sol

92: uint256 constant TX_SLOT_OVERHEAD_L2_GAS = 10000;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/Config.sol#L92-L92) 


</details>


### [NC&#x2011;36] Long functions should be refactored into multiple, smaller, functions 



*There are 29 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/BootloaderUtilities.sol

44:     function encodeLegacyTransactionHash(Transaction calldata _transaction) internal view returns (bytes32 txHash) {

139:     function encodeEIP2930TransactionHash(Transaction calldata _transaction) internal view returns (bytes32) {

229:     function encodeEIP1559TransactionHash(Transaction calldata _transaction) internal view returns (bytes32) {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L44-L44) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L139-L139), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L229-L229)


```solidity

File: contracts/Compressor.sol

44:     function publishCompressedBytecode(

110:     function verifyCompressedStateDiffs(


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Compressor.sol#L44-L44) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Compressor.sol#L110-L110)


```solidity

File: contracts/L1Messenger.sol

194:     function publishPubdataAndClearState(


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L194-L194) 


```solidity

File: contracts/MsgValueSimulator.sol

25:     function _getAbiParams() internal view returns (uint256 value, bool isSystemCall, address to) {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/MsgValueSimulator.sol#L25-L25) 


```solidity

File: contracts/SystemContext.sol

263:     function _setVirtualBlock(

341:     function setL2Block(


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L263-L263) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L341-L341)


```solidity

File: contracts/libraries/SystemContractsCaller.sol

76:     function systemCall(uint32 gasLimit, address to, uint256 value, bytes memory data) internal returns (bool success) {

150:     function systemCallWithPropagatedRevert(


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractsCaller.sol#L76-L76) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractsCaller.sol#L150-L150)


```solidity

File: contracts/libraries/TransactionHelper.sol

147:     function _encodeHashLegacyTransaction(Transaction calldata _transaction) private view returns (bytes32) {

219:     function _encodeHashEIP2930Transaction(Transaction calldata _transaction) private view returns (bytes32) {

289:     function _encodeHashEIP1559Transaction(Transaction calldata _transaction) private view returns (bytes32) {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L147-L147) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L219-L219), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L289-L289)


```solidity

File: contracts/bridge/L1SharedBridge.sol

182:     function bridgehubDeposit(

303:     function _claimFailedDeposit(

409:     function _finalizeWithdrawal(

487:     function _parseL2WithdrawalMessage(

554:     function depositLegacyErc20Bridge(


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L182-L182) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L303-L303), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L409-L409), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L487-L487), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L554-L554)


```solidity

File: contracts/bridgehub/Bridgehub.sol

217:     function requestL2TransactionDirect(

262:     function requestL2TransactionTwoBridges(


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L217-L217) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L262-L262)


```solidity

File: contracts/state-transition/StateTransitionManager.sol

177:     function _setChainIdUpgrade(uint256 _chainId, address _chainContract) internal {

239:     function createNewChain(


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L177-L177) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L239-L239)


```solidity

File: contracts/state-transition/chain-deps/facets/Executor.sol

32:     function _commitOneBatch(

130:     function _processL2Logs(

386:     function _proveBatches(

625:     function _verifyBlobInformation(


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L32-L32) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L130-L130), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L386-L386), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L625-L625)


```solidity

File: contracts/bridge/L2StandardERC20.sol

50:     function bridgeInitialize(address _l1Address, bytes memory _data) external initializer {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2StandardERC20.sol#L50-L50) 


```solidity

File: contracts/L2ContractHelper.sol

101:     function computeCreate2Address(


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/L2ContractHelper.sol#L101-L101) 


</details>


### [NC&#x2011;37] Long lines of code 
Usually lines in source code are limited to [80](https://softwareengineering.stackexchange.com/questions/148677/why-is-80-characters-the-standard-limit-for-code-width) characters. Today's screens are much larger so it's reasonable to stretch this in some cases. The solidity style guide recommends a maximumum line length of [120 characters](https://docs.soliditylang.org/en/v0.8.17/style-guide.html#maximum-line-length), so the lines below should be split when they reach that length.


*There are 164 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/AccountCodeStorage.sol

14:  * the second byte denotes whether the contract is constructed, and the next two bytes denote the length in 32-byte words.

17:  * @dev The length of each bytecode MUST be odd.  It's internal code format requirements, due to padding of SHA256 function.


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/AccountCodeStorage.sol#L14-L14) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/AccountCodeStorage.sol#L17-L17)


```solidity

File: contracts/BootloaderUtilities.sol

6: import {Transaction, TransactionHelper, EIP_712_TX_TYPE, LEGACY_TX_TYPE, EIP_2930_TX_TYPE, EIP_1559_TX_TYPE} from "./libraries/TransactionHelper.sol";

21:     /// @return txHash and signedTxHash of the transaction, i.e. the transaction hash to be used in the explorer and commits to all


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L6-L6) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L21-L21)


```solidity

File: contracts/ComplexUpgrader.sol

11:  * @notice Upgrader which should be used to perform complex multistep upgrades on L2. In case some custom logic for an upgrade is needed


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ComplexUpgrader.sol#L11-L11) 


```solidity

File: contracts/Compressor.sol

5: import {ICompressor, OPERATION_BITMASK, LENGTH_BITS_OFFSET, MAX_ENUMERATION_INDEX_SIZE} from "./interfaces/ICompressor.sol";

10: import {L1_MESSENGER_CONTRACT, INITIAL_WRITE_STARTING_POSITION, COMPRESSED_INITIAL_WRITE_SIZE, STATE_DIFF_ENTRY_SIZE, STATE_DIFF_ENUM_INDEX_OFFSET, STATE_DIFF_FINAL_VALUE_OFFSET, STATE_DIFF_DERIVED_KEY_OFFSET, DERIVED_KEY_LENGTH, VALUE_LENGTH, ENUM_INDEX_LENGTH, KNOWN_CODE_STORAGE_CONTRACT} from "./Constants.sol";

17:  * @dev Every deployed bytecode/published state diffs in zkEVM should be publicly restorable from the L1 data availability.

41:     /// @dev Currently, the method may be called only from the bootloader because the server is not ready to publish bytecodes

43:     /// @dev Read more about the compression: https://github.com/matter-labs/zksync-era/blob/main/docs/guides/advanced/compression.md

82:     /// @dev We don't verify that the size of {_stateDiffs} is equivalent to {_numberOfStateDiffs} * STATE_DIFF_ENTRY_SIZE since that check is

85:     /// @dev This check assumes that the ordering of state diffs are sorted by (address, key) for the encoded state diffs and

87:     /// @dev state diff:   [20bytes address][32bytes key][32bytes derived key][8bytes enum index][32bytes initial value][32bytes final value]

208:     /// @notice Verify value compression was done correct given initial value, final value, operation, and compressed value

213:     /// value or difference between initial and final value. It should be of arbitrary length less than or equal to 32 bytes.

214:     /// @dev It is the responsibility of the caller of this function to ensure that the `_compressedValue` has length no longer than 32 bytes.


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Compressor.sol#L5-L5) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Compressor.sol#L10-L10), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Compressor.sol#L17-L17), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Compressor.sol#L41-L41), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Compressor.sol#L43-L43), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Compressor.sol#L82-L82), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Compressor.sol#L85-L85), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Compressor.sol#L87-L87), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Compressor.sol#L208-L208), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Compressor.sol#L213-L213), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Compressor.sol#L214-L214)


```solidity

File: contracts/Constants.sol

40: /// - That it is not possible that the pubdata counter grows too high without spending proportional amount of computation.

74: ISystemContext constant REAL_SYSTEM_CONTEXT_CONTRACT = ISystemContext(payable(address(REAL_SYSTEM_CONTRACTS_OFFSET + 0x0b)));

78: // It will be a different value for tests, while shouldn't. But for now, this constant is not used by other contracts, so that's fine.

103: /// @dev Each state diff consists of 156 bytes of actual data and 116 bytes of unused padding, needed for circuit efficiency.

106: /// @dev While the "real" amount of pubdata that can be sent rarely exceeds the BLOB_SIZE_BYTES * MAX_NUMBER_OF_BLOBS, it is better to


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Constants.sol#L40-L40) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Constants.sol#L74-L74), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Constants.sol#L78-L78), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Constants.sol#L103-L103), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Constants.sol#L106-L106)


```solidity

File: contracts/ContractDeployer.sol

7: import {CREATE2_PREFIX, CREATE_PREFIX, NONCE_HOLDER_SYSTEM_CONTRACT, ACCOUNT_CODE_STORAGE_SYSTEM_CONTRACT, FORCE_DEPLOYER, MAX_SYSTEM_CONTRACT_ADDRESS, KNOWN_CODE_STORAGE_CONTRACT, BASE_TOKEN_SYSTEM_CONTRACT, IMMUTABLE_SIMULATOR_SYSTEM_CONTRACT, COMPLEX_UPGRADER_CONTRACT, KECCAK256_SYSTEM_CONTRACT} from "./Constants.sol";

216:         // Since the `forceDeployOnAddress` function is called only during upgrades, the Governance is trusted to correctly select

217:         // the addresses to deploy the new bytecodes to and to assess whether overriding the AccountInfo for the "force-deployed"


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L7-L7) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L216-L216), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L217-L217)


```solidity

File: contracts/DefaultAccount.sol

9: import {BOOTLOADER_FORMAL_ADDRESS, NONCE_HOLDER_SYSTEM_CONTRACT, DEPLOYER_SYSTEM_CONTRACT, INonceHolder} from "./Constants.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/DefaultAccount.sol#L9-L9) 


```solidity

File: contracts/KnownCodesStorage.sol

15:  * the second byte denotes whether the contract is constructed, and the next two bytes denote the length in 32-byte words.


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/KnownCodesStorage.sol#L15-L15) 


```solidity

File: contracts/L1Messenger.sol

5: import {IL1Messenger, L2ToL1Log, L2_L1_LOGS_TREE_DEFAULT_LEAF_HASH, L2_TO_L1_LOG_SERIALIZE_SIZE, STATE_DIFF_COMPRESSION_VERSION_NUMBER} from "./interfaces/IL1Messenger.sol";

10: import {SystemLogKey, SYSTEM_CONTEXT_CONTRACT, KNOWN_CODE_STORAGE_CONTRACT, COMPRESSOR_CONTRACT, STATE_DIFF_ENTRY_SIZE, MAX_ALLOWED_PUBDATA_PER_BATCH, L2_TO_L1_LOGS_MERKLE_TREE_LEAVES, PUBDATA_CHUNK_PUBLISHER, COMPUTATIONAL_PRICE_FOR_PUBDATA} from "./Constants.sol";

187:     ///        processed in the current L1 Batch. Pubdata consists of L2 to L1 Logs, messages, deployed bytecode, and state diffs.

190:     /// @dev The data passed in also contains the encoded state diffs to be checked again, however this is aux data that is not

277:         /// body (`compressedStateDiffSize` bytes, 4 bytes number of state diffs, `numberOfStateDiffs` * `STATE_DIFF_ENTRY_SIZE` bytes for the uncompressed state diffs)

278:         /// encoded state diffs: [20bytes address][32bytes key][32bytes derived key][8bytes enum index][32bytes initial value][32bytes final value]


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L5-L5) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L10-L10), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L187-L187), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L190-L190), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L277-L277), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L278-L278)


```solidity

File: contracts/L2BaseToken.sol

7: import {MSG_VALUE_SYSTEM_CONTRACT, DEPLOYER_SYSTEM_CONTRACT, BOOTLOADER_FORMAL_ADDRESS, L1_MESSENGER_CONTRACT} from "./Constants.sol";

14:  * @dev It does NOT provide interfaces for personal interaction with tokens like `transfer`, `approve`, and `transferFrom`.

82:     /// @notice Initiate the ETH withdrawal, with the sent message. The funds will be available to claim on L1 `finalizeEthWithdrawal` method.


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L2BaseToken.sol#L7-L7) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L2BaseToken.sol#L14-L14), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L2BaseToken.sol#L82-L82)


```solidity

File: contracts/MsgValueSimulator.sol

40:     /// It is equal to the following constant: https://github.com/matter-labs/era-zkevm_opcode_defs/blob/7bf8016f5bb13a73289f321ad6ea8f614540ece9/src/system_params.rs#L96.


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/MsgValueSimulator.sol#L40-L40) 


```solidity

File: contracts/NonceHolder.sol

24:  * @dev The behavior of some of the methods depends on the nonce ordering of the account. Nonce ordering is a mere suggestion and all the checks that are present


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/NonceHolder.sol#L24-L24) 


```solidity

File: contracts/PubdataChunkPublisher.sol

20:     /// @dev We always publish 2 system logs even if our pubdata fits into a single blob. This makes processing logs on L1 easier.


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/PubdataChunkPublisher.sol#L20-L20) 


```solidity

File: contracts/SystemContext.sol

21:     /// - Store the latest 256 hashes (and strictly rely that we do not accidentally override the hash of the block 256 blocks ago)

65:     /// of the miniblocks cheaper, we only store the previous MINIBLOCK_HASHES_TO_STORE ones. Since whenever we need to publish a state

67:     /// By having this data in a cyclic array of MINIBLOCK_HASHES_TO_STORE blocks, we bring the costs down by 40% (i.e. 40 bytes per miniblock instead of 64 bytes).

69:     /// @dev Hashes of the blocks older than the ones which are stored here can be calculated as _calculateLegacyL2BlockHash(blockNumber).

74:     /// - Their number will start from being equal to the number of the batch and it will increase until it reaches the L2 block number.

79:     /// @notice The information about the virtual blocks upgrade, which tracks when the migration to the L2 blocks has started and finished.

139:         // 2. If the block was created before the upgrade for the virtual blocks (i.e. there we used to use hashes of the batches),

142:         // all the information which is returned for users should be for L2 blocks, we return the hash of the corresponding L2 block.

156:             // Important: we do not want this number to ever collide with the L2 block hash (either new or old one) and so

157:             // that's why the legacy L2 blocks' hashes are keccak256(abi.encodePacked(uint32(_block))), while these are equivalent to

281:             // Note, that when setting the virtual block number we use the batch number to make a smoother upgrade from batch number to

299:         // We do not use a `require` here, since the virtual blocks are a temporary solution to let the Solidity's `block.number`

340:     /// @dev It is also enforced that the number of the current virtual L2 block can not exceed the number of the L2 block.


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L21-L21) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L65-L65), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L67-L67), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L69-L69), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L74-L74), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L79-L79), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L139-L139), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L142-L142), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L156-L156), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L157-L157), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L281-L281), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L299-L299), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L340-L340)


```solidity

File: contracts/libraries/EfficientCall.sol

16:  * In turn, zkEVM operates over a fat pointer, which is a set of (memory page, offset, start, length) in the memory/calldata/returndata.

25:  * 3. `ptr.pack` - Do the concatenation between the lowest 128 bits of the pointer itself and the highest 128 bits of `_value`. It is typically used to prepare the ABI for external calls.


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L16-L16) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L25-L25)


```solidity

File: contracts/libraries/SystemContractHelper.sol

7: import {SystemContractsCaller, CalldataForwardingMode, CALLFLAGS_CALL_ADDRESS, CODE_ADDRESS_CALL_ADDRESS, EVENT_WRITE_ADDRESS, EVENT_INITIALIZE_ADDRESS, GET_EXTRA_ABI_DATA_ADDRESS, LOAD_CALLDATA_INTO_ACTIVE_PTR_CALL_ADDRESS, META_CODE_SHARD_ID_OFFSET, META_CALLER_SHARD_ID_OFFSET, META_SHARD_ID_OFFSET, META_AUX_HEAP_SIZE_OFFSET, META_HEAP_SIZE_OFFSET, META_GAS_PER_PUBDATA_BYTE_OFFSET, MIMIC_CALL_BY_REF_CALL_ADDRESS, META_CALL_ADDRESS, MSG_VALUE_SIMULATOR_IS_SYSTEM_BIT, PTR_CALLDATA_CALL_ADDRESS, PTR_ADD_INTO_ACTIVE_CALL_ADDRESS, PTR_SHRINK_INTO_ACTIVE_CALL_ADDRESS, PTR_PACK_INTO_ACTIVE_CALL_ADDRESS, RAW_FAR_CALL_BY_REF_CALL_ADDRESS, PRECOMPILE_CALL_ADDRESS, SET_CONTEXT_VALUE_CALL_ADDRESS, SYSTEM_CALL_BY_REF_CALL_ADDRESS, TO_L1_CALL_ADDRESS} from "./SystemContractsCaller.sol";

105:     /// @dev Transforms `ACTIVE_PTR.length` into `ACTIVE_PTR.length - u32(_shrink)`. If underflow happens then it panics.


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L7-L7) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L105-L105)


```solidity

File: contracts/libraries/TransactionHelper.sol

86:             "Transaction(uint256 txType,uint256 from,uint256 to,uint256 gasLimit,uint256 gasPerPubdataByteLimit,uint256 maxFeePerGas,uint256 maxPriorityFeePerGas,uint256 paymaster,uint256 nonce,uint256 value,bytes data,bytes32[] factoryDeps,bytes paymasterInput)"

291:         // H(0x02 || RLP(chain_id, nonce, max_priority_fee_per_gas, max_fee_per_gas, gas_limit, destination, amount, data, access_list))


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L86-L86) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L291-L291)


```solidity

File: contracts/libraries/UnsafeBytesCalldata.sol

9:  * @dev Each of the functions accepts the `bytes calldata` and the offset where data should be read and returns a value of a certain type.


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/UnsafeBytesCalldata.sol#L9-L9) 


```solidity

File: contracts/libraries/Utils.sol

55:     /// @notice Denotes whether bytecode hash corresponds to a contract that is on constructor or has already been constructed


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L55-L55) 


```solidity

File: contracts/interfaces/IL1Messenger.sol

6: /// @param l2ShardId The shard identifier, 0 - rollup, 1 - porter. All other values are not used but are reserved for the future

24: /// @dev Equal to the bytes size of the tuple - (uint8 ShardId, bool isService, uint16 txNumberInBlock, address sender, bytes32 key, bytes32 value)


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IL1Messenger.sol#L6-L6) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IL1Messenger.sol#L24-L24)


```solidity

File: contracts/interfaces/ISystemContext.sol

25:         /// all the information returned to users for block.timestamp/number, etc should be the information about the L2 blocks and


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ISystemContext.sol#L25-L25) 


```solidity

File: contracts/interfaces/ISystemContextDeprecated.sol

8:  * @notice The interface with deprecated functions of the SystemContext contract. It is aimed for backward compatibility.


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ISystemContextDeprecated.sol#L8-L8) 


```solidity

File: contracts/bridge/L1ERC20Bridge.sol

31:     /// @dev Used for saving the number of deposited funds, to claim them in case the deposit transaction will fail in zkSync Era.


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1ERC20Bridge.sol#L31-L31) 


```solidity

File: contracts/bridge/L1SharedBridge.sol

21: import {ERA_CHAIN_ID, ERA_ERC20_BRIDGE_ADDRESS, ETH_TOKEN_ADDRESS, ERA_DIAMOND_PROXY, TWO_BRIDGES_MAGIC_VALUE} from "../common/Config.sol";

43:     /// This variable is used to differentiate between pre-upgrade and post-upgrade withdrawals. Withdrawals from batches older

47:     /// @dev A mapping chainId => bridgeProxy. Used to store the bridge proxy's address, and to see if it has been deployed yet.

57:     mapping(uint256 chainId => mapping(uint256 l2BatchNumber => mapping(uint256 l2ToL1MessageNumber => bool isFinalized)))

103:     /// implementation. The owner is the Governor and separate from the ProxyAdmin from now on, so that the Governor can call the bridge.

160:             uint256 amount = _depositFunds(_prevMsgSender, IERC20(_l1Token), _amount); // note if _prevMsgSender is this contract, this will return 0. This does not happen.

167:         // Note that we don't save the deposited amount, as this is for the base token, which gets sent to the refundRecipient if the tx fails

230:     /// @notice Confirms the acceptance of a transaction by the Mailbox, as part of the L2 transaction process within Bridgehub.

332:                 // Deposits that happened before the upgrade cannot be checked here, they have to be claimed and checked in the legacyBridge

494:         // It should be equal to the length of the bytes4 function signature + address l1Receiver + uint256 amount = 4 + 20 + 32 = 56 (bytes).

515:             // It should be equal to the length of the function signature + address + address + uint256 = 4 + 20 + 20 + 32 =

587:                 mintValue: msg.value, // l2 gas + l2 msg.Value the bridgehub will withdraw the mintValue from the base token bridge for gas

588:                 l2Value: 0, // L2 msg.value, this contract doesn't support base token deposits or wrapping functionality, for direct deposits use bridgehub


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L21-L21) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L43-L43), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L47-L47), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L57-L57), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L103-L103), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L160-L160), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L167-L167), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L230-L230), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L332-L332), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L494-L494), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L515-L515), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L587-L587), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L588-L588)


```solidity

File: contracts/bridgehub/Bridgehub.sol

62:         require(msg.sender == currentPendingAdmin, "n42"); // Only proposed by current admin address can claim the admin rights

216:     /// This means this is not ideal for contract calls, as the contract would have to handle token allowance of the base Token


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L62-L62) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L216-L216)


```solidity

File: contracts/state-transition/StateTransitionManager.sol

19: import {REQUIRED_L2_GAS_PRICE_PER_PUBDATA, L2_TO_L1_LOG_SERIALIZE_SIZE, DEFAULT_L2_LOGS_TREE_ROOT_HASH, EMPTY_STRING_KECCAK, SYSTEM_UPGRADE_L2_TX_TYPE, ERA_DIAMOND_PROXY, ERA_CHAIN_ID} from "../common/Config.sol";

121:         require(msg.sender == currentPendingAdmin, "n42"); // Only proposed by current admin address can claim the admin rights


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L19-L19) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L121-L121)


```solidity

File: contracts/state-transition/ValidatorTimelock.sol

13: /// @notice Intermediate smart contract between the validator EOA account and the hyperchains state transition diamond smart contract.

15: /// modifying the main hyperchain diamond contract. As such, even if this contract is compromised, it will not impact the main


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L13-L13) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L15-L15)


```solidity

File: contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol

69:     /// @notice Address which will exercise critical changes to the Diamond Proxy (upgrades, freezing & unfreezing). Replaced by STM

149:     /// @notice gasPriceMultiplier for each baseToken, so that each L1->L2 transaction pays for its transaction on the destination


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L69-L69) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L149-L149)


```solidity

File: contracts/state-transition/chain-deps/facets/Admin.sol

90:         require(s.totalBatchesCommitted == 0, "AdminFacet: set validium only after genesis"); // Validium mode can be set only before the first batch is committed


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Admin.sol#L90-L90) 


```solidity

File: contracts/state-transition/chain-deps/facets/Executor.sol

6: import {COMMIT_TIMESTAMP_NOT_OLDER, COMMIT_TIMESTAMP_APPROXIMATION_DELTA, EMPTY_STRING_KECCAK, L2_TO_L1_LOG_SERIALIZE_SIZE, MAX_L2_TO_L1_LOGS_COMMITMENT_BYTES, PACKED_L2_BLOCK_TIMESTAMP_MASK, PUBLIC_INPUT_SHIFT, POINT_EVALUATION_PRECOMPILE_ADDR} from "../../../common/Config.sol";

7: import {IExecutor, L2_LOG_ADDRESS_OFFSET, L2_LOG_KEY_OFFSET, L2_LOG_VALUE_OFFSET, SystemLogKey, LogProcessingOutput, PubdataSource, BLS_MODULUS, PUBDATA_COMMITMENT_SIZE, PUBDATA_COMMITMENT_CLAIMED_VALUE_OFFSET, PUBDATA_COMMITMENT_COMMITMENT_OFFSET, MAX_NUMBER_OF_BLOBS, TOTAL_BLOBS_IN_COMMITMENT} from "../../chain-interfaces/IExecutor.sol";

12: import {L2_BOOTLOADER_ADDRESS, L2_TO_L1_MESSENGER_SYSTEM_CONTRACT_ADDR, L2_SYSTEM_CONTEXT_SYSTEM_CONTRACT_ADDR, L2_PUBDATA_CHUNK_PUBLISHER_ADDR} from "../../../common/L2ContractAddresses.sol";

57:             // In this scenario, pubdataCommitments is a list of: opening point (16 bytes) || claimed value (32 bytes) || commitment (48 bytes) || proof (48 bytes)) = 144 bytes

60:             // In this scenario pubdataCommitments is actual pubdata consisting of l2 to l1 logs, l2 to l1 message, compressed smart contract bytecode, and compressed state diffs

100:     /// @param _packedBatchAndL2BlockTimestamp - packed batch and L2 block timestamp in a format of batchTimestamp * 2**128 + l2BatchTimestamp

122:         require(block.timestamp - COMMIT_TIMESTAMP_NOT_OLDER <= batchTimestamp, "h1"); // New batch timestamp is too small

123:         require(lastL2BlockTimestamp <= block.timestamp + COMMIT_TIMESTAMP_APPROXIMATION_DELTA, "h2"); // The last L2 block timestamp is too big

221:         // 1. A chain has to keep their protocol version up to date, as processing a block requires the latest or previous protocol version

222:         // to solve this we will need to add the feature to create batches with only the protocol upgrade tx, without any other txs.

223:         // 2. A chain might become out of sync if it launches while we are in the middle of a protocol upgrade. This would mean they cannot process their genesis upgrade

224:         // as thier protocolversion would be outdated, and they also cannot process the protocol upgrade tx as they have a pending upgrade.

225:         // 3. The protocol upgrade is increased in the BaseZkSyncUpgrade, in the executor only the systemContractsUpgradeTxHash is checked

230:         // With the new changes for EIP-4844, namely the restriction on number of blobs per block, we only allow for a single batch to be committed at a time.

233:         require(s.storedBatchHashes[s.totalBatchesCommitted] == _hashStoredBatchInfo(_lastCommittedBatchData), "i"); // incorrect previous batch data

282:         // While the logic of the contract ensures that the s.l2SystemContractsUpgradeBatchNumber is 0 when this function is called,

330:         require(priorityOperationsHash == _storedBatch.priorityOperationsHash, "x"); // priority operations hash does not match to expected

358:         require(newTotalBatchesExecuted <= s.totalBatchesVerified, "n"); // Can't execute batches more than committed and proven currently.

532:                 // VM 1.5.0 requires us to pass the EVM simulator code hash. For now it is the same as the default account.

615:         // response is equal to BLS_MODULUS as defined in https://eips.ethereum.org/EIPS/eip-4844#point-evaluation-precompile

621:     /// @dev Verifies that the blobs contain the correct data by calling the point evaluation precompile. For the precompile we need:

624:     /// pubdataCommitments is a list of: opening point (16 bytes) || claimed value (32 bytes) || commitment (48 bytes) || proof (48 bytes)) = 144 bytes


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L6-L6) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L7-L7), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L12-L12), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L57-L57), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L60-L60), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L100-L100), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L122-L122), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L123-L123), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L221-L221), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L222-L222), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L223-L223), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L224-L224), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L225-L225), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L230-L230), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L233-L233), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L282-L282), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L330-L330), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L358-L358), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L532-L532), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L615-L615), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L621-L621), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L624-L624)


```solidity

File: contracts/state-transition/chain-deps/facets/Mailbox.sol

11: import {WritePriorityOpParams, L2CanonicalTransaction, L2Message, L2Log, TxStatus, BridgehubL2TransactionRequest} from "../../../common/Messaging.sol";

18: import {REQUIRED_L2_GAS_PRICE_PER_PUBDATA, L1_GAS_PER_PUBDATA_BYTE, L2_L1_LOGS_TREE_DEFAULT_LEAF_HASH, PRIORITY_OPERATION_L2_TX_TYPE, PRIORITY_EXPIRATION, MAX_NEW_FACTORY_DEPS, ETH_TOKEN_ADDRESS, ERA_CHAIN_ID} from "../../../common/Config.sol";

19: import {L2_BOOTLOADER_ADDRESS, L2_TO_L1_MESSENGER_SYSTEM_CONTRACT_ADDR, L2_BASE_TOKEN_SYSTEM_CONTRACT_ADDR} from "../../../common/L2ContractAddresses.sol";

90:         // - l2ShardId = 0 (means that L1 -> L2 transaction was processed in a rollup shard, other shards are not available yet anyway)

232:         // Please note, currently zkSync address derivation is different from Ethereum one, but it may be changed in the future.

239:         // to ensure that users do not get used to using "exotic" numbers for _request.l2GasPerPubdataByteLimit, e.g. 1-2, etc.

240:         // VERY IMPORTANT: nobody should rely on this constant to be fixed and every contract should give their users the ability to provide the


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L11-L11) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L18-L18), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L19-L19), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L90-L90), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L232-L232), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L239-L239), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L240-L240)


```solidity

File: contracts/upgrades/BaseZkSyncUpgrade.sol

11: import {MAX_NEW_FACTORY_DEPS, SYSTEM_UPGRADE_L2_TX_TYPE, MAX_ALLOWED_PROTOCOL_VERSION_DELTA} from "../common/Config.sol";

143:         // An upgrade to the verifier params must be done carefully to ensure there aren't batches in the committed state

145:         // Batches committed expecting the old verifier params will fail. Ensure all commited batches are finalized before the


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgrade.sol#L11-L11) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgrade.sol#L143-L143), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgrade.sol#L145-L145)


```solidity

File: contracts/upgrades/BaseZkSyncUpgradeGenesis.sol

11: import {MAX_NEW_FACTORY_DEPS, SYSTEM_UPGRADE_L2_TX_TYPE, MAX_ALLOWED_PROTOCOL_VERSION_DELTA} from "../common/Config.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L11-L11) 


```solidity

File: contracts/common/libraries/UnsafeBytes.sol

9:  * @dev Each of the functions accepts the `bytes memory` and the offset where data should be read and returns a value of a certain type.


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/UnsafeBytes.sol#L9-L9) 


```solidity

File: contracts/state-transition/libraries/Diamond.sol

16:     /// @dev Used to distinguish calls to contracts that were supposed to be used as diamond initializer from other contracts.

22:         0xc8fcad8db84d3cc18b4c41d551ea0ee66dd599cde068d998e57d5e09332c131b; // keccak256("diamond.standard.diamond.storage") - 1;

161:             require(oldFacet.facetAddress != address(0), "L"); // it is impossible to replace the facet with zero address


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L16-L16) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L22-L22), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L161-L161)


```solidity

File: contracts/state-transition/libraries/LibMap.sol

6: /// @dev This library is an adaptation of the corresponding Solady library (https://github.com/vectorized/solady/blob/main/src/utils/LibMap.sol)

60:             // shifted to its proper position. The XOR operation will effectively replace the old value with the new value.


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/LibMap.sol#L6-L6) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/LibMap.sol#L60-L60)


```solidity

File: contracts/state-transition/libraries/Merkle.sol

13:     /// NOTE: When using this function, check that the _path length is equal to the tree height to prevent shorter/longer paths attack


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Merkle.sol#L13-L13) 


```solidity

File: contracts/state-transition/libraries/PriorityQueue.sol

39:     /// @return The total number of priority operations that were added to the priority queue, including all processed ones


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/PriorityQueue.sol#L39-L39) 


```solidity

File: contracts/state-transition/libraries/TransactionValidator.sol

8: import {TX_SLOT_OVERHEAD_L2_GAS, MEMORY_OVERHEAD_GAS, L1_TX_INTRINSIC_L2_GAS, L1_TX_DELTA_544_ENCODING_BYTES, L1_TX_DELTA_FACTORY_DEPS_L2_GAS, L1_TX_MIN_L2_GAS_BASE, L1_TX_INTRINSIC_PUBDATA, L1_TX_DELTA_FACTORY_DEPS_PUBDATA} from "../../common/Config.sol";

68:     /// Note: The calculation includes the main cost of the priority transaction, however, in reality, the operator can spend a little more gas on overheads.

107:     /// and the L2 gas needed to process the transaction itself (i.e. the actual l2GasLimit that will be used for the transaction).


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/TransactionValidator.sol#L8-L8) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/TransactionValidator.sol#L68-L68), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/TransactionValidator.sol#L107-L107)


```solidity

File: contracts/state-transition/chain-interfaces/IExecutor.sol

21: /// @dev Enum used to determine the source of pubdata. At first we will support calldata and blobs but this can be extended.

45: /// @dev Offset used to pull Value From Log. Equal to 4 (bytes for isService) + 20 (bytes for address) + 32 (bytes for key)

53: /// @dev Format: list of: opening point (16 bytes) || claimed value (32 bytes) || commitment (48 bytes) || proof (48 bytes)) = 144 bytes

77:     /// @param indexRepeatedStorageChanges The serial number of the shortcut index that's used as a unique identifier for storage keys that were used twice or more

97:     /// @param indexRepeatedStorageChanges The serial number of the shortcut index that's used as a unique identifier for storage keys that were used twice or more

101:     /// @param bootloaderHeapInitialContentsHash Hash of the initial contents of the bootloader heap. In practice it serves as the commitment to the transactions in the batch.

102:     /// @param eventsQueueStateHash Hash of the events queue state. In practice it serves as the commitment to the events in the batch.

105:     /// @dev pubdataCommitments format: This will always start with a 1 byte pubdataSource flag. Current allowed values are 0 (calldata) or 1 (blobs)

106:     ///                             kzg: list of: opening point (16 bytes) || claimed value (32 bytes) || commitment (48 bytes) || proof (48 bytes) = 144 bytes

108:     ///                                       and 32 bytes appended to serve as the blob commitment part for the aux output part of the batch commitment

110:     /// @dev When using calldata, we only need to send one blob commitment since the max number of bytes in calldata fits in a single blob and we can pull the

196:     /// @dev It has the name "BlocksVerification" and not "BatchesVerification" due to backward compatibility considerations


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IExecutor.sol#L21-L21) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IExecutor.sol#L45-L45), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IExecutor.sol#L53-L53), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IExecutor.sol#L77-L77), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IExecutor.sol#L97-L97), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IExecutor.sol#L101-L101), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IExecutor.sol#L102-L102), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IExecutor.sol#L105-L105), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IExecutor.sol#L106-L106), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IExecutor.sol#L108-L108), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IExecutor.sol#L110-L110), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IExecutor.sol#L196-L196)


```solidity

File: contracts/state-transition/chain-interfaces/IGetters.sol

10: /// @title The interface of the Getters Contract that implements functions for getting contract state from outside the blockchain.

48:     /// @return The total number of priority operations that were added to the priority queue, including all processed ones

54:     /// in case exactly *unprocessed* transactions are needed, one should check that getPriorityQueueSize() is greater than 0.

111:     /// @return the baseTokenGasPriceMultiplierNominator, used to compare the baseTokenPrice to ether for L1->L2 transactions

114:     /// @return the baseTokenGasPriceMultiplierDenominator, used to compare the baseTokenPrice to ether for L1->L2 transactions


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IGetters.sol#L10-L10) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IGetters.sol#L48-L48), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IGetters.sol#L54-L54), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IGetters.sol#L111-L111), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IGetters.sol#L114-L114)


```solidity

File: contracts/state-transition/chain-interfaces/IMailbox.sol

6: import {L2CanonicalTransaction, L2Log, L2Message, TxStatus, BridgehubL2TransactionRequest} from "../../common/Messaging.sol";

15:     /// @param _message Information about the sent message: sender address, the message itself, tx index in the L2 batch where the message was sent

46:     /// NOTE: It may return `false` for incorrect proof, but it doesn't mean that the L1 -> L2 transaction has an opposite status!

75:     /// @param _l2GasPerPubdataByteLimit The maximum amount L2 gas that the operator may charge the user for single byte of pubdata.

79:     /// Please note, the contract may change the refund recipient's address to eliminate sending funds to addresses out of control.

81:     /// - If `_refundRecipient` is set to `address(0)` and the sender has NO deployed bytecode on L1, the refund will be sent to the `msg.sender` address.

82:     /// - If `_refundRecipient` is set to `address(0)` and the sender has deployed bytecode on L1, the refund will be sent to the aliased `msg.sender` address.

83:     /// @dev The address aliasing of L1 contracts as refund recipient on L2 is necessary to guarantee that the funds are controllable,

85:     /// Without address aliasing for L1 contracts as refund recipients they would not be able to make proper L2 tx requests

87:     /// @return canonicalTxHash The hash of the requested L2 transaction. This hash can be used to follow the transaction status

105:     /// @param _l2GasPerPubdataByteLimit The maximum amount of L2 gas that the operator may charge the user for a single byte of pubdata.


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IMailbox.sol#L6-L6) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IMailbox.sol#L15-L15), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IMailbox.sol#L46-L46), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IMailbox.sol#L75-L75), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IMailbox.sol#L79-L79), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IMailbox.sol#L81-L81), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IMailbox.sol#L82-L82), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IMailbox.sol#L83-L83), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IMailbox.sol#L85-L85), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IMailbox.sol#L87-L87), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IMailbox.sol#L105-L105)


```solidity

File: contracts/common/ReentrancyGuard.sol

32:     // https://github.com/OpenZeppelin/openzeppelin-contracts/blob/566a774222707e424896c0c390a84dc3c13bdcb2/contracts/security/ReentrancyGuard.sol


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/ReentrancyGuard.sol#L32-L32) 


```solidity

File: contracts/bridge/L2SharedBridge.sol

15: import {L2ContractHelper, DEPLOYER_SYSTEM_CONTRACT, L2_BASE_TOKEN_ADDRESS, IContractDeployer} from "../L2ContractHelper.sol";

143:         // note we use the IL1ERC20Bridge.finalizeWithdrawal function selector to specify the selector for L1<>L2 messages,

162:     /// @dev This function uses raw call to ContractDeployer to make sure that exactly `l2TokenProxyBytecodeHash` is used


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L15-L15) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L143-L143), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L162-L162)


```solidity

File: contracts/bridge/L2StandardERC20.sol

5: import {ERC20PermitUpgradeable} from "@openzeppelin/contracts-upgradeable/token/ERC20/extensions/draft-ERC20PermitUpgradeable.sol";

19:     /// @notice Our goal is to store all the getters that L1 token implements, and for others, we keep it as an unimplemented method.


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2StandardERC20.sol#L5-L5) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2StandardERC20.sol#L19-L19)


</details>


### [NC&#x2011;38] Missing event and or timelock for critical parameter change 
Events help non-contract tools to track changes, and events prevent users from being surprised by changes


*There are 11 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/SystemContext.sol

84:     function setChainId(uint256 _newChainId) external onlyCallFromForceDeployer {
85:         chainId = _newChainId;
86:     }

099:     function setTxOrigin(address _newOrigin) external onlyCallFromBootloader {
100:         origin = _newOrigin;
101:     }

105:     function setGasPrice(uint256 _gasPrice) external onlyCallFromBootloader {
106:         gasPrice = _gasPrice;
107:     }

112:     function setPubdataInfo(uint256 _gasPerPubdataByte, uint256 _basePubdataSpent) external onlyCallFromBootloader {
113:         basePubdataSpent = _basePubdataSpent;
114:         gasPerPubdataByte = _gasPerPubdataByte;
115:     }

486:     function resetTxNumberInBatch() external onlyCallFromBootloader {
487:         txNumberInBlock = 0;
488:     }


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L84-L86) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L99-L101), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L105-L107), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L112-L115), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L486-L488)


```solidity

File: contracts/bridgehub/Bridgehub.sol

82:     function addStateTransitionManager(address _stateTransitionManager) external onlyOwner {
83:         require(
84:             !stateTransitionManagerIsRegistered[_stateTransitionManager],
85:             "Bridgehub: state transition already registered"
86:         );
87:         stateTransitionManagerIsRegistered[_stateTransitionManager] = true;
88:     }

92:     function removeStateTransitionManager(address _stateTransitionManager) external onlyOwner {
93:         require(
94:             stateTransitionManagerIsRegistered[_stateTransitionManager],
95:             "Bridgehub: state transition not registered yet"
96:         );
97:         stateTransitionManagerIsRegistered[_stateTransitionManager] = false;
98:     }

101:     function addToken(address _token) external onlyOwner {
102:         require(!tokenIsRegistered[_token], "Bridgehub: token already registered");
103:         tokenIsRegistered[_token] = true;
104:     }

108:     function setSharedBridge(address _sharedBridge) external onlyOwner {
109:         sharedBridge = IL1SharedBridge(_sharedBridge);
110:     }


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L82-L88) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L92-L98), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L101-L104), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L108-L110)


```solidity

File: contracts/state-transition/StateTransitionManager.sol

132:     function setValidatorTimelock(address _validatorTimelock) external onlyOwnerOrAdmin {
133:         validatorTimelock = _validatorTimelock;
134:     }


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L132-L134) 


```solidity

File: contracts/state-transition/ValidatorTimelock.sol

73:     function setStateTransitionManager(IStateTransitionManager _stateTransitionManager) external onlyOwner {
74:         stateTransitionManager = _stateTransitionManager;
75:     }


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L73-L75) 


</details>


### [NC&#x2011;39] File is missing NatSpec 



*There are 11 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/interfaces/IAccountCodeStorage.sol

0: 


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IAccountCodeStorage.sol#L0-L0) 


```solidity

File: contracts/interfaces/IBaseToken.sol

0: 


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IBaseToken.sol#L0-L0) 


```solidity

File: contracts/interfaces/IBootloaderUtilities.sol

0: 


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IBootloaderUtilities.sol#L0-L0) 


```solidity

File: contracts/interfaces/IImmutableSimulator.sol

0: 


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IImmutableSimulator.sol#L0-L0) 


```solidity

File: contracts/interfaces/IL2StandardToken.sol

0: 


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IL2StandardToken.sol#L0-L0) 


```solidity

File: contracts/interfaces/IMailbox.sol

0: 


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IMailbox.sol#L0-L0) 


```solidity

File: contracts/bridge/interfaces/IWETH9.sol

0: 


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IWETH9.sol#L0-L0) 


```solidity

File: contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol

0: 


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol#L0-L0) 


```solidity

File: contracts/state-transition/l2-deps/ISystemContext.sol

0: 


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/l2-deps/ISystemContext.sol#L0-L0) 


```solidity

File: contracts/upgrades/IDefaultUpgrade.sol

0: 


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/IDefaultUpgrade.sol#L0-L0) 


```solidity

File: contracts/bridge/interfaces/IL2StandardToken.sol

0: 


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL2StandardToken.sol#L0-L0) 


</details>


### [NC&#x2011;40] Mixed usage of `int`/`uint` with `int256`/`uint256` 
`int256`/`uint256` are the preferred type names (they're what are used for function signatures), so they should be used consistently


*There are 1 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/state-transition/chain-deps/facets/Executor.sol

580:         for (uint i = 0; i < MAX_NUMBER_OF_BLOBS; i++) {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L580-L580) 


</details>


### [NC&#x2011;41] Consider using named mappings 
Consider using [named mappings](https://ethereum.stackexchange.com/a/145555) to make it easier to understand the purpose of each mapping


*There are 9 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/ContractDeployer.sol

26:     mapping(address => AccountInfo) internal accountInfo;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L26-L26) 


```solidity

File: contracts/bridge/L1ERC20Bridge.sol

45:     mapping(address => uint256) private __DEPRECATED_lastWithdrawalLimitReset;

48:     mapping(address => uint256) private __DEPRECATED_withdrawnAmountInWindow;

51:     mapping(address => mapping(address => uint256)) private __DEPRECATED_totalDepositedAmountPerUser;

51:     mapping(address => mapping(address => uint256)) private __DEPRECATED_totalDepositedAmountPerUser;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1ERC20Bridge.sol#L45-L45) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1ERC20Bridge.sol#L48-L48), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1ERC20Bridge.sol#L51-L51), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1ERC20Bridge.sol#L51-L51)


```solidity

File: contracts/state-transition/StateTransitionManager.sol

30:     mapping(uint256 => address) public stateTransition;

48:     mapping(uint256 => bytes32) public upgradeCutHash;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L30-L30) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L48-L48)


```solidity

File: contracts/state-transition/ValidatorTimelock.sol

47:     mapping(uint256 => LibMap.Uint32Map) internal committedBatchTimestamp;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L47-L47) 


```solidity

File: contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol

120:     mapping(address => uint256) __DEPRECATED_totalDepositedAmountPerUser;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L120-L120) 


</details>


### [NC&#x2011;42] Consider using later versions of solidity for more cappabilities 
Consider using solidity 0.8.18 or later to benefit from multiple things including the named mappings [named mappings](https://ethereum.stackexchange.com/a/145555) to make it easier to understand the purpose of each mapping


*There are 1 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/state-transition/l2-deps/ISystemContext.sol

2: pragma solidity ^0.8.0;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/l2-deps/ISystemContext.sol#L2-L2) 


</details>


### [NC&#x2011;43] Some error strings are not descriptive 
Consider adding more detail to these error strings


*There are 152 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/BootloaderUtilities.sol

//@audit This message need more details : Invalid v value
92:             require(vInt == 27 || vInt == 28, "Invalid v value");

//@audit This message need more details : Invalid v value
191:             require(vInt == 27 || vInt == 28, "Invalid v value");

//@audit This message need more details : Invalid v value
286:             require(vInt == 27 || vInt == 28, "Invalid v value");


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L92-L92) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L191-L191), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L286-L286)


```solidity

File: contracts/DefaultAccount.sol

//@audit This message need more details : Invalid s
184:         require(uint256(s) <= 0x7FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF5D576E7357A4501DDFE92F46681B20A0, "Invalid s");


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/DefaultAccount.sol#L184-L184) 


```solidity

File: contracts/NonceHolder.sol

//@audit This message need more details : Incorrect nonce
115:         require(oldMinNonce == _expectedNonce, "Incorrect nonce");


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/NonceHolder.sol#L115-L115) 


```solidity

File: contracts/libraries/Utils.sol

//@audit This message need more details : Overflow
21:         require(_x <= type(uint128).max, "Overflow");

//@audit This message need more details : Overflow
27:         require(_x <= type(uint32).max, "Overflow");

//@audit This message need more details : Overflow
33:         require(_x <= type(uint24).max, "Overflow");

//@audit This message need more details : po
84:         require(_bytecode.length % 32 == 0, "po");

//@audit This message need more details : pp
87:         require(lengthInWords < 2 ** 16, "pp"); // bytecode length must be less than 2^16 words

//@audit This message need more details : pr
88:         require(lengthInWords % 2 == 1, "pr"); // bytecode length in words must be odd


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L21-L21) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L27-L27), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L33-L33), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L84-L84), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L87-L87), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L88-L88)


```solidity

File: contracts/bridge/L1ERC20Bridge.sol

//@audit This message need more details : 0T
141:         require(_amount != 0, "0T"); // empty deposit

//@audit This message need more details : 3T
143:         require(amount == _amount, "3T"); // The token has non-standard transfer logic

//@audit This message need more details : 2T
186:         require(amount != 0, "2T"); // empty deposit

//@audit This message need more details : pw
215:         require(!isWithdrawalFinalized[_l2BatchNumber][_l2MessageIndex], "pw");


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1ERC20Bridge.sol#L141-L141) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1ERC20Bridge.sol#L143-L143), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1ERC20Bridge.sol#L186-L186), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1ERC20Bridge.sol#L215-L215)


```solidity

File: contracts/bridge/L1SharedBridge.sol

//@audit This message need more details : ShB not BH
69:         require(msg.sender == address(bridgehub), "ShB not BH");

//@audit This message need more details : ShB owner 0
108:         require(_owner != address(0), "ShB owner 0");

//@audit This message need more details : 6T
208:         require(amount != 0, "6T"); // empty deposit amount

//@audit This message need more details : ShB tx hap
237:         require(depositHappened[_chainId][_txHash] == 0x00, "ShB tx hap");

//@audit This message need more details : y1
327:         require(_amount > 0, "y1");

//@audit This message need more details : ShB b. n dep
563:         require(l2BridgeAddress[ERA_CHAIN_ID] != address(0), "ShB b. n dep");

//@audit This message need more details : yn
325:             require(proofValid, "yn");

//@audit This message need more details : 3T
161:             require(amount == _amount, "3T"); // The token has non-standard transfer logic

//@audit This message need more details : 5T
206:             require(withdrawAmount == _depositAmount, "5T"); // The token has non-standard transfer logic

//@audit This message need more details : ShB n funds
349:             require(chainBalance[_chainId][_l1Token] >= _amount, "ShB n funds");


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L69-L69) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L108-L108), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L208-L208), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L237-L237), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L327-L327), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L563-L563), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L325-L325), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L161-L161), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L206-L206), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L349-L349)


```solidity

File: contracts/bridgehub/Bridgehub.sol

//@audit This message need more details : n42
62:         require(msg.sender == currentPendingAdmin, "n42"); // Only proposed by current admin address can claim the admin rights


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L62-L62) 


```solidity

File: contracts/state-transition/StateTransitionManager.sol

//@audit This message need more details : n42
121:         require(msg.sender == currentPendingAdmin, "n42"); // Only proposed by current admin address can claim the admin rights


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L121-L121) 


```solidity

File: contracts/state-transition/ValidatorTimelock.sol

//@audit This message need more details : 5c
195:                 require(block.timestamp >= commitBatchTimestamp + delay, "5c"); // The delay is not passed

//@audit This message need more details : 5c
217:                 require(block.timestamp >= commitBatchTimestamp + delay, "5c"); // The delay is not passed


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L195-L195) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L217-L217)


```solidity

File: contracts/state-transition/chain-deps/DiamondInit.sol

//@audit This message need more details : vt
25:         require(address(_initializeData.verifier) != address(0), "vt");

//@audit This message need more details : vy
26:         require(_initializeData.admin != address(0), "vy");

//@audit This message need more details : hc
27:         require(_initializeData.validatorTimelock != address(0), "hc");

//@audit This message need more details : vu
28:         require(_initializeData.priorityTxMaxGasLimit <= MAX_GAS_PER_TRANSACTION, "vu");


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/DiamondInit.sol#L25-L25) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/DiamondInit.sol#L26-L26), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/DiamondInit.sol#L27-L27), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/DiamondInit.sol#L28-L28)


```solidity

File: contracts/state-transition/chain-deps/DiamondProxy.sol

//@audit This message need more details : pr
14:         require(_chainId == block.chainid, "pr");

//@audit This message need more details : Ut
25:         require(msg.data.length >= 4 || msg.data.length == 0, "Ut");

//@audit This message need more details : F
30:         require(facetAddress != address(0), "F"); // Proxy has no facet for this selector

//@audit This message need more details : q1
31:         require(!diamondStorage.isFrozen || !facet.isFreezable, "q1"); // Facet is frozen


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/DiamondProxy.sol#L14-L14) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/DiamondProxy.sol#L25-L25), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/DiamondProxy.sol#L30-L30), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/DiamondProxy.sol#L31-L31)


```solidity

File: contracts/state-transition/chain-deps/facets/Admin.sol

//@audit This message need more details : n4
34:         require(msg.sender == pendingAdmin, "n4"); // Only proposed by current admin address can claim the admin rights

//@audit This message need more details : n5
59:         require(_newPriorityTxMaxGasLimit <= MAX_GAS_PER_TRANSACTION, "n5");

//@audit This message need more details : n6
70:         require(_newFeeParams.maxPubdataPerBatch >= _newFeeParams.priorityTxMaxPubdata, "n6");

//@audit This message need more details : a9
136:         require(!diamondStorage.isFrozen, "a9"); // diamond proxy is frozen already

//@audit This message need more details : a7
146:         require(diamondStorage.isFrozen, "a7"); // diamond proxy is not frozen


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Admin.sol#L34-L34) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Admin.sol#L59-L59), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Admin.sol#L70-L70), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Admin.sol#L136-L136), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Admin.sol#L146-L146)


```solidity

File: contracts/state-transition/chain-deps/facets/Executor.sol

//@audit This message need more details : f
37:         require(_newBatch.batchNumber == _previousBatch.batchNumber + 1, "f"); // only commit next batch

//@audit This message need more details : us
40:         require(pubdataSource == uint8(PubdataSource.Calldata) || pubdataSource == uint8(PubdataSource.Blob), "us");

//@audit This message need more details : l
74:         require(_previousBatch.batchHash == logOutput.previousBatchHash, "l");

//@audit This message need more details : t
76:         require(logOutput.chainedPriorityTxsHash == _newBatch.priorityOperationsHash, "t");

//@audit This message need more details : ta
78:         require(logOutput.numberOfLayer1Txs == _newBatch.numberOfLayer1Txs, "ta");

//@audit This message need more details : tb
110:         require(batchTimestamp == _expectedBatchTimestamp, "tb");

//@audit This message need more details : h3
114:         require(_previousBatchTimestamp < batchTimestamp, "h3");

//@audit This message need more details : h1
122:         require(block.timestamp - COMMIT_TIMESTAMP_NOT_OLDER <= batchTimestamp, "h1"); // New batch timestamp is too small

//@audit This message need more details : h2
123:         require(lastL2BlockTimestamp <= block.timestamp + COMMIT_TIMESTAMP_APPROXIMATION_DELTA, "h2"); // The last L2 block timestamp is too big

//@audit This message need more details : e4
231:         require(_newBatchesData.length == 1, "e4");

//@audit This message need more details : i
233:         require(s.storedBatchHashes[s.totalBatchesCommitted] == _hashStoredBatchInfo(_lastCommittedBatchData), "i"); // incorrect previous batch data

//@audit This message need more details : ik
284:         require(s.l2SystemContractsUpgradeBatchNumber == 0, "ik");

//@audit This message need more details : k
323:         require(currentBatchNumber == s.totalBatchesExecuted + _executedBatchIdx + 1, "k"); // Execute batches in order

//@audit This message need more details : exe10
324:         require(

//@audit This message need more details : x
330:         require(priorityOperationsHash == _storedBatch.priorityOperationsHash, "x"); // priority operations hash does not match to expected

//@audit This message need more details : n
358:         require(newTotalBatchesExecuted <= s.totalBatchesVerified, "n"); // Can't execute batches more than committed and proven currently.

//@audit This message need more details : t1
402:         require(_hashStoredBatchInfo(_prevBatch) == s.storedBatchHashes[currentTotalBatchesVerified], "t1");

//@audit This message need more details : q
421:         require(currentTotalBatchesVerified <= s.totalBatchesCommitted, "q");

//@audit This message need more details : t4
442:         require(proofPublicInput.length == 1, "t4");

//@audit This message need more details : p
449:         require(successVerifyProof, "p"); // Proof verification fail

//@audit This message need more details : v1
482:         require(s.totalBatchesCommitted > _newLastBatch, "v1"); // The last committed batch is less than new last batch

//@audit This message need more details : v2
483:         require(_newLastBatch >= s.totalBatchesExecuted, "v2"); // Already executed batches cannot be reverted

//@audit This message need more details : pu
543:         require(_batch.systemLogs.length <= MAX_L2_TO_L1_LOGS_COMMITMENT_BYTES, "pu");

//@audit This message need more details : b10
567:         require(_blobCommitments.length == MAX_NUMBER_OF_BLOBS, "b10");

//@audit This message need more details : b11
568:         require(_blobHashes.length == MAX_NUMBER_OF_BLOBS, "b11");

//@audit This message need more details : pl
631:         require(_pubdataCommitments.length > 0, "pl");

//@audit This message need more details : bd
632:         require(_pubdataCommitments.length <= PUBDATA_COMMITMENT_SIZE * MAX_NUMBER_OF_BLOBS, "bd");

//@audit This message need more details : bs
633:         require(_pubdataCommitments.length % PUBDATA_COMMITMENT_SIZE == 0, "bs");

//@audit This message need more details : lh
663:         require(versionedHash == bytes32(0), "lh");

//@audit This message need more details : vc
681:         require(success, "vc");

//@audit This message need more details : v0h
50:             require(logOutput.pubdataHash == 0x00, "v0h");

//@audit This message need more details : kp
149:             require(!_checkBit(processedLogs, uint8(logKey)), "kp");

//@audit This message need more details : b8
194:             require(processedLogs == 1023, "b8");

//@audit This message need more details : b7
192:             require(processedLogs == 511, "b7");

//@audit This message need more details : o1
407:             require(

//@audit This message need more details : vh
639:             require(blobVersionedHash != bytes32(0), "vh");

//@audit This message need more details : bh
668:             require(

//@audit This message need more details : wp
61:             require(

//@audit This message need more details : lm
154:                 require(logSender == L2_TO_L1_MESSENGER_SYSTEM_CONTRACT_ADDR, "lm");

//@audit This message need more details : ln
157:                 require(logSender == L2_TO_L1_MESSENGER_SYSTEM_CONTRACT_ADDR, "ln");

//@audit This message need more details : lb
160:                 require(logSender == L2_TO_L1_MESSENGER_SYSTEM_CONTRACT_ADDR, "lb");

//@audit This message need more details : sc
163:                 require(logSender == L2_SYSTEM_CONTEXT_SYSTEM_CONTRACT_ADDR, "sc");

//@audit This message need more details : sv
166:                 require(logSender == L2_SYSTEM_CONTEXT_SYSTEM_CONTRACT_ADDR, "sv");

//@audit This message need more details : bl
169:                 require(logSender == L2_BOOTLOADER_ADDRESS, "bl");

//@audit This message need more details : bk
172:                 require(logSender == L2_BOOTLOADER_ADDRESS, "bk");

//@audit This message need more details : pc
175:                 require(logSender == L2_PUBDATA_CHUNK_PUBLISHER_ADDR, "pc");

//@audit This message need more details : pd
178:                 require(logSender == L2_PUBDATA_CHUNK_PUBLISHER_ADDR, "pd");

//@audit This message need more details : bu
181:                 require(logSender == L2_BOOTLOADER_ADDRESS, "bu");

//@audit This message need more details : ut
182:                 require(_expectedSystemContractUpgradeTxHash == logValue, "ut");


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L37-L37) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L40-L40), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L74-L74), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L76-L76), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L78-L78), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L110-L110), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L114-L114), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L122-L122), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L123-L123), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L231-L231), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L233-L233), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L284-L284), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L323-L323), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L324-L324), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L330-L330), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L358-L358), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L402-L402), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L421-L421), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L442-L442), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L449-L449), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L482-L482), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L483-L483), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L543-L543), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L567-L567), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L568-L568), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L631-L631), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L632-L632), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L633-L633), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L663-L663), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L681-L681), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L50-L50), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L149-L149), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L194-L194), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L192-L192), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L407-L407), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L639-L639), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L668-L668), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L61-L61), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L154-L154), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L157-L157), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L160-L160), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L163-L163), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L166-L166), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L169-L169), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L172-L172), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L175-L175), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L178-L178), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L181-L181), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L182-L182)


```solidity

File: contracts/state-transition/chain-deps/facets/Getters.sol

//@audit This message need more details : g2
183:         require(ds.selectorToFacet[_selector].facetAddress != address(0), "g2");


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L183-L183) 


```solidity

File: contracts/state-transition/chain-deps/facets/Mailbox.sol

//@audit This message need more details : xx
110:         require(_batchNumber <= s.totalBatchesExecuted, "xx");

//@audit This message need more details : tw
117:         require(hashedLog != L2_L1_LOGS_TREE_DEFAULT_LEAF_HASH, "tw");

//@audit This message need more details : qp
243:         require(_request.l2GasPerPubdataByteLimit == REQUIRED_L2_GAS_PRICE_PER_PUBDATA, "qp");

//@audit This message need more details : uj
264:         require(_factoryDeps.length <= MAX_NEW_FACTORY_DEPS, "uj");

//@audit This message need more details : mv
272:         require(_mintValue >= baseCost + _params.l2Value, "mv"); // The `msg.value` doesn't cover the transaction cost


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L110-L110) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L117-L117), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L243-L243), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L264-L264), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L272-L272)


```solidity

File: contracts/common/libraries/L2ContractHelper.sol

//@audit This message need more details : pq
23:         require(_bytecode.length % 32 == 0, "pq");

//@audit This message need more details : pp
26:         require(bytecodeLenInWords < 2 ** 16, "pp"); // bytecode length must be less than 2^16 words

//@audit This message need more details : ps
27:         require(bytecodeLenInWords % 2 == 1, "ps"); // bytecode length in words must be odd

//@audit This message need more details : zf
41:         require(version == 1 && _bytecodeHash[1] == bytes1(0), "zf"); // Incorrectly formatted bytecodeHash

//@audit This message need more details : uy
43:         require(bytecodeLen(_bytecodeHash) % 2 == 1, "uy"); // Code length in words must be odd


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/L2ContractHelper.sol#L23-L23) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/L2ContractHelper.sol#L26-L26), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/L2ContractHelper.sol#L27-L27), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/L2ContractHelper.sol#L41-L41), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/L2ContractHelper.sol#L43-L43)


```solidity

File: contracts/state-transition/libraries/Diamond.sol

//@audit This message need more details : G
132:         require(_facet.code.length > 0, "G");

//@audit This message need more details : K
155:         require(_facet.code.length > 0, "K");

//@audit This message need more details : a1
175:         require(_facet == address(0), "a1"); // facet address must be zero

//@audit This message need more details : B
107:             require(selectors.length > 0, "B"); // no functions for diamond cut

//@audit This message need more details : J
141:             require(oldFacet.facetAddress == address(0), "J"); // facet for this selector already exists

//@audit This message need more details : L
161:             require(oldFacet.facetAddress != address(0), "L"); // it is impossible to replace the facet with zero address

//@audit This message need more details : a2
181:             require(oldFacet.facetAddress != address(0), "a2"); // Can't delete a non-existent facet

//@audit This message need more details : J1
215:             require(_isSelectorFreezable == ds.selectorToFacet[selector0].isFreezable, "J1");

//@audit This message need more details : lp
297:             require(data.length == 32, "lp");

//@audit This message need more details : lp1
298:             require(abi.decode(data, (bytes32)) == DIAMOND_INIT_SUCCESS_RETURN_VALUE, "lp1");

//@audit This message need more details : H
280:             require(_calldata.length == 0, "H"); // Non-empty calldata for zero address


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L132-L132) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L155-L155), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L175-L175), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L107-L107), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L141-L141), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L161-L161), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L181-L181), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L215-L215), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L297-L297), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L298-L298), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L280-L280)


```solidity

File: contracts/state-transition/libraries/Merkle.sol

//@audit This message need more details : xc
24:         require(pathLength > 0, "xc");

//@audit This message need more details : bt
25:         require(pathLength < 256, "bt");

//@audit This message need more details : px
26:         require(_index < (1 << pathLength), "px");


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Merkle.sol#L24-L24) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Merkle.sol#L25-L25), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Merkle.sol#L26-L26)


```solidity

File: contracts/state-transition/libraries/PriorityQueue.sol

//@audit This message need more details : D
65:         require(!_queue.isEmpty(), "D"); // priority queue is empty

//@audit This message need more details : s
73:         require(!_queue.isEmpty(), "s"); // priority queue is empty


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/PriorityQueue.sol#L65-L65) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/PriorityQueue.sol#L73-L73)


```solidity

File: contracts/state-transition/libraries/TransactionValidator.sol

//@audit This message need more details : ui
28:         require(l2GasForTxBody <= _priorityTxMaxGasLimit, "ui");

//@audit This message need more details : uk
30:         require(l2GasForTxBody / _transaction.gasPerPubdataByteLimit <= _priorityTxMaxPubdata, "uk");

//@audit This message need more details : up
34:         require(

//@audit This message need more details : ua
48:         require(_transaction.from <= type(uint16).max, "ua");

//@audit This message need more details : ub
49:         require(_transaction.to <= type(uint160).max, "ub");

//@audit This message need more details : uc
50:         require(_transaction.paymaster == 0, "uc");

//@audit This message need more details : ud
51:         require(_transaction.value == 0, "ud");

//@audit This message need more details : uq
52:         require(_transaction.maxFeePerGas == 0, "uq");

//@audit This message need more details : ux
53:         require(_transaction.maxPriorityFeePerGas == 0, "ux");

//@audit This message need more details : ue
54:         require(_transaction.reserved[0] == 0, "ue");

//@audit This message need more details : uf
55:         require(_transaction.reserved[1] <= type(uint160).max, "uf");

//@audit This message need more details : ug
56:         require(_transaction.reserved[2] == 0, "ug");

//@audit This message need more details : uo
57:         require(_transaction.reserved[3] == 0, "uo");

//@audit This message need more details : uh
58:         require(_transaction.signature.length == 0, "uh");

//@audit This message need more details : ul1
59:         require(_transaction.paymasterInput.length == 0, "ul1");

//@audit This message need more details : um
60:         require(_transaction.reservedDynamic.length == 0, "um");

//@audit This message need more details : my
115:         require(_totalGasLimit >= overhead, "my"); // provided gas limit doesn't cover transaction overhead


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/TransactionValidator.sol#L28-L28) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/TransactionValidator.sol#L30-L30), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/TransactionValidator.sol#L34-L34), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/TransactionValidator.sol#L48-L48), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/TransactionValidator.sol#L49-L49), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/TransactionValidator.sol#L50-L50), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/TransactionValidator.sol#L51-L51), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/TransactionValidator.sol#L52-L52), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/TransactionValidator.sol#L53-L53), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/TransactionValidator.sol#L54-L54), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/TransactionValidator.sol#L55-L55), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/TransactionValidator.sol#L56-L56), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/TransactionValidator.sol#L57-L57), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/TransactionValidator.sol#L58-L58), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/TransactionValidator.sol#L59-L59), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/TransactionValidator.sol#L60-L60), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/TransactionValidator.sol#L115-L115)


```solidity

File: contracts/common/ReentrancyGuard.sol

//@audit This message need more details : 1B
58:         require(lockSlotOldValue == 0, "1B");

//@audit This message need more details : r1
75:         require(_status == _NOT_ENTERED, "r1");


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/ReentrancyGuard.sol#L58-L58) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/ReentrancyGuard.sol#L75-L75)


```solidity

File: contracts/bridge/L2SharedBridge.sol

//@audit This message need more details : bf
55:         require(_l1Bridge != address(0), "bf");

//@audit This message need more details : df
56:         require(_l2TokenProxyBytecodeHash != bytes32(0), "df");

//@audit This message need more details : sf
57:         require(_aliasedOwner != address(0), "sf");

//@audit This message need more details : df
58:         require(_l2TokenProxyBytecodeHash != bytes32(0), "df");

//@audit This message need more details : mq
87:         require(

//@audit This message need more details : yh
129:         require(l1Token != address(0), "yh");

//@audit This message need more details : mk
176:         require(success, "mk");

//@audit This message need more details : bf2
68:             require(_l1LegecyBridge != address(0), "bf2");

//@audit This message need more details : gg
101:             require(currentL1Token == _l1Token, "gg"); // Double check that the expected value equal to real one

//@audit This message need more details : mt
98:             require(deployedToken == expectedL2Token, "mt");


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L55-L55) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L56-L56), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L57-L57), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L58-L58), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L87-L87), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L129-L129), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L176-L176), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L68-L68), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L101-L101), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L98-L98)


```solidity

File: contracts/bridge/L2StandardERC20.sol

//@audit This message need more details : in6
51:         require(_l1Address != address(0), "in6"); // Should be non-zero address

//@audit This message need more details : tt
120:         require(msg.sender == UpgradeableBeacon(beaconAddress).owner(), "tt");

//@audit This message need more details : xnt
130:         require(msg.sender == l2Bridge, "xnt"); // Only L2 bridge can call this method

//@audit This message need more details : v
137:         require(_version == _getInitializedVersion() + 1, "v");


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2StandardERC20.sol#L51-L51) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2StandardERC20.sol#L120-L120), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2StandardERC20.sol#L130-L130), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2StandardERC20.sol#L137-L137)


```solidity

File: contracts/SystemContractsCaller.sol

//@audit This message need more details : Overflow
28:         require(_x <= type(uint32).max, "Overflow");


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/SystemContractsCaller.sol#L28-L28) 


</details>


### [NC&#x2011;44] The `nonReentrant` `modifier` should occur before all other modifiers 
This is a best-practice to protect against reentrancy in other modifiers


*There are 2 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/bridge/L1SharedBridge.sol

554:     function depositLegacyErc20Bridge(


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L554-L554) 


```solidity

File: contracts/bridgehub/Bridgehub.sol

114:     function createNewChain(


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L114-L114) 


</details>


### [NC&#x2011;45] Events that mark critical parameter changes should contain both the old and the new value 
This should especially be done if the new value is not required to be different from the old value


*There are 22 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/interfaces/IContractDeployer.sol

39:     event AccountNonceOrderingUpdated(address indexed accountAddress, AccountNonceOrdering nonceOrdering);

41:     event AccountVersionUpdated(address indexed accountAddress, AccountAbstractionVersion aaVersion);


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IContractDeployer.sol#L39-L39) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IContractDeployer.sol#L41-L41)


```solidity

File: contracts/interfaces/INonceHolder.sol

14:     event ValueSetUnderNonce(address indexed accountAddress, uint256 indexed key, uint256 value);


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/INonceHolder.sol#L14-L14) 


```solidity

File: contracts/state-transition/ValidatorTimelock.sol

29:     event NewExecutionDelay(uint256 _newExecutionDelay);

32:     event ValidatorAdded(uint256 _chainId, address _addedValidator);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L29-L29) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L32-L32)


```solidity

File: contracts/upgrades/BaseZkSyncUpgrade.sol

46:     event NewProtocolVersion(uint256 indexed previousProtocolVersion, uint256 indexed newProtocolVersion);

49:     event NewL2BootloaderBytecodeHash(bytes32 indexed previousBytecodeHash, bytes32 indexed newBytecodeHash);

52:     event NewL2DefaultAccountBytecodeHash(bytes32 indexed previousBytecodeHash, bytes32 indexed newBytecodeHash);

61:     event UpgradeComplete(uint256 indexed newProtocolVersion, bytes32 indexed l2UpgradeTxHash, ProposedUpgrade upgrade);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgrade.sol#L46-L46) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgrade.sol#L49-L49), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgrade.sol#L52-L52), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgrade.sol#L61-L61)


```solidity

File: contracts/bridge/interfaces/IL1SharedBridge.sol

31:     event BridgehubDepositBaseTokenInitiated(
32:         uint256 indexed chainId,
33:         address indexed from,
34:         address l1Token,
35:         uint256 amount
36:     );


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L31-L36) 


```solidity

File: contracts/bridgehub/IBridgehub.sol

133:     event NewChain(uint256 indexed chainId, address stateTransitionManager, address indexed chainGovernance);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L133-L133) 


```solidity

File: contracts/governance/IGovernance.sol

77:     event ChangeSecurityCouncil(address _securityCouncilBefore, address _securityCouncilAfter);

80:     event ChangeMinDelay(uint256 _delayBefore, uint256 _delayAfter);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/IGovernance.sol#L77-L77) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/IGovernance.sol#L80-L80)


```solidity

File: contracts/state-transition/IStateTransitionManager.sol

28:     event StateTransitionNewChain(uint256 indexed _chainId, address indexed _stateTransitionContract);

30:     event SetChainIdUpgrade(
31:         address indexed _stateTransitionChain,
32:         L2CanonicalTransaction _l2Transaction,
33:         uint256 indexed _protocolVersion
34:     );


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/IStateTransitionManager.sol#L28-L28) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/IStateTransitionManager.sol#L30-L34)


```solidity

File: contracts/state-transition/chain-interfaces/IAdmin.sol

61:     event IsPorterAvailableStatusUpdate(bool isPorterAvailable);

64:     event ValidatorStatusUpdate(address indexed validatorAddress, bool isActive);

80:     event ValidiumModeStatusUpdate(PubdataPricingMode validiumMode);

91:     event ExecuteUpgrade(Diamond.DiamondCutData diamondCut);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IAdmin.sol#L61-L61) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IAdmin.sol#L64-L64), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IAdmin.sol#L80-L80), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IAdmin.sol#L91-L91)


```solidity

File: contracts/state-transition/chain-interfaces/IMailbox.sol

123:     event NewPriorityRequest(
124:         uint256 txId,
125:         bytes32 txHash,
126:         uint64 expirationTimestamp,
127:         L2CanonicalTransaction transaction,
128:         bytes[] factoryDeps
129:     );


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IMailbox.sol#L123-L129) 


```solidity

File: contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol

17:     event ProposeTransparentUpgrade(
18:         Diamond.DiamondCutData diamondCut,
19:         uint256 indexed proposalId,
20:         bytes32 proposalSalt
21:     );


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol#L17-L21) 


```solidity

File: contracts/bridge/interfaces/IL2SharedBridge.sol

22:     event BaseTokenReceived(uint256 amount);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL2SharedBridge.sol#L22-L22) 


</details>


### [NC&#x2011;46] `override` function arguments that are unused should have the variable name removed or commented out to avoid compiler warnings 



*There are 2 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/DefaultAccount.sol

//@audit _transaction is not used
125:     function executeTransactionFromOutside(Transaction calldata _transaction) external payable override {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/DefaultAccount.sol#L125-L125) 


```solidity

File: contracts/KnownCodesStorage.sol

//@audit _hash is not used
65:     function getMarker(bytes32 _hash) public view override returns (uint256 marker) {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/KnownCodesStorage.sol#L65-L65) 


</details>


### [NC&#x2011;47] Use of `override` is unnecessary 
Starting with Solidity version [0.8.8](https://docs.soliditylang.org/en/v0.8.20/contracts.html#function-overriding), using the `override` keyword when the function solely overrides an interface function, and the function doesn't exist in multiple base contracts, is unnecessary.


*There are 50 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/AccountCodeStorage.sol

35:     function storeAccountConstructingCodeHash(address _address, bytes32 _hash) external override onlyDeployer {

46:     function storeAccountConstructedCodeHash(address _address, bytes32 _hash) external override onlyDeployer {

54:     function markAccountCodeHashAsConstructed(address _address) external override onlyDeployer {

78:     function getRawCodeHash(address _address) public view override returns (bytes32 codeHash) {

89:     function getCodeHash(uint256 _input) external view override returns (bytes32) {

117:     function getCodeSize(uint256 _input) external view override returns (uint256 codeSize) {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/AccountCodeStorage.sol#L35-L35) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/AccountCodeStorage.sol#L46-L46), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/AccountCodeStorage.sol#L54-L54), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/AccountCodeStorage.sol#L78-L78), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/AccountCodeStorage.sol#L89-L89), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/AccountCodeStorage.sol#L117-L117)


```solidity

File: contracts/BootloaderUtilities.sol

24:     function getTransactionHashes(
25:         Transaction calldata _transaction
26:     ) external view override returns (bytes32 txHash, bytes32 signedTxHash) {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L24-L26) 


```solidity

File: contracts/ContractDeployer.sol

095:     function getNewAddressCreate2(
096:         address _sender,
097:         bytes32 _bytecodeHash,
098:         bytes32 _salt,
099:         bytes calldata _input
100:     ) public view override returns (address newAddress) {

115:     function getNewAddressCreate(
116:         address _sender,
117:         uint256 _senderNonce
118:     ) public pure override returns (address newAddress) {

132:     function create2(
133:         bytes32 _salt,
134:         bytes32 _bytecodeHash,
135:         bytes calldata _input
136:     ) external payable override returns (address) {

147:     function create(
148:         bytes32 _salt,
149:         bytes32 _bytecodeHash,
150:         bytes calldata _input
151:     ) external payable override returns (address) {

162:     function create2Account(
163:         bytes32 _salt,
164:         bytes32 _bytecodeHash,
165:         bytes calldata _input,
166:         AccountAbstractionVersion _aaVersion
167:     ) public payable override onlySystemCall returns (address) {

182:     function createAccount(
183:         bytes32, // salt
184:         bytes32 _bytecodeHash,
185:         bytes calldata _input,
186:         AccountAbstractionVersion _aaVersion
187:     ) public payable override onlySystemCall returns (address) {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L95-L100) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L115-L118), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L132-L136), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L147-L151), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L162-L167), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L182-L187)


```solidity

File: contracts/DefaultAccount.sol

67:     function validateTransaction(
68:         bytes32, // _txHash
69:         bytes32 _suggestedSignedHash,
70:         Transaction calldata _transaction
71:     ) external payable override ignoreNonBootloader ignoreInDelegateCall returns (bytes4 magic) {

112:     function executeTransaction(
113:         bytes32, // _txHash
114:         bytes32, // _suggestedSignedHash
115:         Transaction calldata _transaction
116:     ) external payable override ignoreNonBootloader ignoreInDelegateCall {

125:     function executeTransactionFromOutside(Transaction calldata _transaction) external payable override {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/DefaultAccount.sol#L67-L71) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/DefaultAccount.sol#L112-L116), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/DefaultAccount.sol#L125-L125)


```solidity

File: contracts/ImmutableSimulator.sol

27:     function getImmutable(address _dest, uint256 _index) external view override returns (bytes32) {

34:     function setImmutables(address _dest, ImmutableData[] calldata _immutables) external override {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ImmutableSimulator.sol#L27-L27) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ImmutableSimulator.sol#L34-L34)


```solidity

File: contracts/KnownCodesStorage.sol

65:     function getMarker(bytes32 _hash) public view override returns (uint256 marker) {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/KnownCodesStorage.sol#L65-L65) 


```solidity

File: contracts/L1Messenger.sol

116:     function sendToL1(bytes calldata _message) external override returns (bytes32 hash) {

161:     function requestBytecodeL1Publication(
162:         bytes32 _bytecodeHash
163:     ) external override onlyCallFrom(address(KNOWN_CODE_STORAGE_CONTRACT)) {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L116-L116) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L161-L163)


```solidity

File: contracts/L2BaseToken.sol

32:     function transferFromTo(address _from, address _to, uint256 _amount) external override {

56:     function balanceOf(uint256 _account) external view override returns (uint256) {

64:     function mint(address _account, uint256 _amount) external override onlyCallFromBootloader {

72:     function withdraw(address _l1Receiver) external payable override {

85:     function withdrawWithMessage(address _l1Receiver, bytes memory _additionalData) external payable override {

128:     function name() external pure override returns (string memory) {

134:     function symbol() external pure override returns (string memory) {

140:     function decimals() external pure override returns (uint8) {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L2BaseToken.sol#L32-L32) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L2BaseToken.sol#L56-L56), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L2BaseToken.sol#L64-L64), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L2BaseToken.sol#L72-L72), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L2BaseToken.sol#L85-L85), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L2BaseToken.sol#L128-L128), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L2BaseToken.sol#L134-L134), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L2BaseToken.sol#L140-L140)


```solidity

File: contracts/bridge/L1SharedBridge.sol

182:     function bridgehubDeposit(
183:         uint256 _chainId,
184:         address _prevMsgSender,
185:         uint256, // l2Value, needed for Weth deposits in the future
186:         bytes calldata _data
187:     ) external payable override onlyBridgehub returns (L2TransactionRequestTwoBridgesInner memory request) {

232:     function bridgehubConfirmL2Transaction(
233:         uint256 _chainId,
234:         bytes32 _txDataHash,
235:         bytes32 _txHash
236:     ) external override onlyBridgehub {

277:     function claimFailedDeposit(
278:         uint256 _chainId,
279:         address _depositSender,
280:         address _l1Token,
281:         uint256 _amount,
282:         bytes32 _l2TxHash,
283:         uint256 _l2BatchNumber,
284:         uint256 _l2MessageIndex,
285:         uint16 _l2TxNumberInBatch,
286:         bytes32[] calldata _merkleProof
287:     ) external override {

385:     function finalizeWithdrawal(
386:         uint256 _chainId,
387:         uint256 _l2BatchNumber,
388:         uint256 _l2MessageIndex,
389:         uint16 _l2TxNumberInBatch,
390:         bytes calldata _message,
391:         bytes32[] calldata _merkleProof
392:     ) external override {

554:     function depositLegacyErc20Bridge(
555:         address _prevMsgSender,
556:         address _l2Receiver,
557:         address _l1Token,
558:         uint256 _amount,
559:         uint256 _l2TxGasLimit,
560:         uint256 _l2TxGasPerPubdataByte,
561:         address _refundRecipient
562:     ) external payable override onlyLegacyBridge nonReentrant returns (bytes32 l2TxHash) {

615:     function finalizeWithdrawalLegacyErc20Bridge(
616:         uint256 _l2BatchNumber,
617:         uint256 _l2MessageIndex,
618:         uint16 _l2TxNumberInBatch,
619:         bytes calldata _message,
620:         bytes32[] calldata _merkleProof
621:     ) external override onlyLegacyBridge returns (address l1Receiver, address l1Token, uint256 amount) {

644:     function claimFailedDepositLegacyErc20Bridge(
645:         address _depositSender,
646:         address _l1Token,
647:         uint256 _amount,
648:         bytes32 _l2TxHash,
649:         uint256 _l2BatchNumber,
650:         uint256 _l2MessageIndex,
651:         uint16 _l2TxNumberInBatch,
652:         bytes32[] calldata _merkleProof
653:     ) external override onlyLegacyBridge {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L182-L187) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L232-L236), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L277-L287), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L385-L392), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L554-L562), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L615-L621), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L644-L653)


```solidity

File: contracts/bridgehub/Bridgehub.sol

152:     function proveL2MessageInclusion(
153:         uint256 _chainId,
154:         uint256 _batchNumber,
155:         uint256 _index,
156:         L2Message calldata _message,
157:         bytes32[] calldata _proof
158:     ) external view override returns (bool) {

164:     function proveL2LogInclusion(
165:         uint256 _chainId,
166:         uint256 _batchNumber,
167:         uint256 _index,
168:         L2Log memory _log,
169:         bytes32[] calldata _proof
170:     ) external view override returns (bool) {

176:     function proveL1ToL2TransactionStatus(
177:         uint256 _chainId,
178:         bytes32 _l2TxHash,
179:         uint256 _l2BatchNumber,
180:         uint256 _l2MessageIndex,
181:         uint16 _l2TxNumberInBatch,
182:         bytes32[] calldata _merkleProof,
183:         TxStatus _status
184:     ) external view override returns (bool) {

217:     function requestL2TransactionDirect(
218:         L2TransactionRequestDirect calldata _request
219:     ) external payable override nonReentrant returns (bytes32 canonicalTxHash) {

262:     function requestL2TransactionTwoBridges(
263:         L2TransactionRequestTwoBridgesOuter calldata _request
264:     ) external payable override nonReentrant returns (bytes32 canonicalTxHash) {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L152-L158) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L164-L170), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L176-L184), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L217-L219), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L262-L264)


```solidity

File: contracts/state-transition/StateTransitionManager.sol

74:     function getChainAdmin(uint256 _chainId) external view override returns (address) {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L74-L74) 


```solidity

File: contracts/upgrades/BaseZkSyncUpgradeGenesis.sol

20:     function _setNewProtocolVersion(uint256 _newProtocolVersion) internal override {

47:     function upgrade(ProposedUpgrade calldata _proposedUpgrade) public virtual override returns (bytes32) {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L20-L20) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L47-L47)


```solidity

File: contracts/upgrades/DefaultUpgrade.sol

13:     function upgrade(ProposedUpgrade calldata _proposedUpgrade) public override returns (bytes32) {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/DefaultUpgrade.sol#L13-L13) 


```solidity

File: contracts/bridge/L2SharedBridge.sol

79:     function finalizeDeposit(
80:         address _l1Sender,
81:         address _l2Receiver,
82:         address _l1Token,
83:         uint256 _amount,
84:         bytes calldata _data
85:     ) external payable override {

123:     function withdraw(address _l1Receiver, address _l2Token, uint256 _amount) external override {

149:     function l2TokenAddress(address _l1Token) public view override returns (address) {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L79-L85) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L123-L123), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L149-L149)


```solidity

File: contracts/bridge/L2StandardERC20.sol

145:     function bridgeMint(address _to, uint256 _amount) external override onlyBridge {

154:     function bridgeBurn(address _from, uint256 _amount) external override onlyBridge {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2StandardERC20.sol#L145-L145) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2StandardERC20.sol#L154-L154)


</details>


### [NC&#x2011;48] Use OpenZeppelin's `MerkleProof` rather than rolling your own 
Use [MerkleProof](https://github.com/OpenZeppelin/openzeppelin-contracts/blob/8b2ed0f5706fe1a7ab6ade84b27bf875dc611fda/contracts/utils/cryptography/MerkleProof.sol#L6-L20) for handling Merkle tree proofs, since the general advice is don't roll your own crypto


*There are 1 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/state-transition/libraries/Merkle.sol

1: // SPDX-License-Identifier: MIT


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Merkle.sol#L1-L1) 


</details>


### [NC&#x2011;49] Functions which are either private or internal should have a preceding _ in their name 
Add a preceding underscore to the function name, take care to refactor where there functions are called 


*There are 109 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/BootloaderUtilities.sol

44:     function encodeLegacyTransactionHash(Transaction calldata _transaction) internal view returns (bytes32 txHash) {

139:     function encodeEIP2930TransactionHash(Transaction calldata _transaction) internal view returns (bytes32) {

229:     function encodeEIP1559TransactionHash(Transaction calldata _transaction) internal view returns (bytes32) {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L44-L44) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L139-L139), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L229-L229)


```solidity

File: contracts/L1Messenger.sol

50:     function keccakGasCost(uint256 _length) internal pure returns (uint256) {

61:     function sha256GasCost(uint256 _length) internal pure returns (uint256) {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L50-L50) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L61-L61)


```solidity

File: contracts/libraries/EfficientCall.sol

36:     function keccak(bytes calldata _data) internal view returns (bytes32) {

45:     function sha(bytes calldata _data) internal view returns (bytes32) {

58:     function call(
59:         uint256 _gas,
60:         address _address,
61:         uint256 _value,
62:         bytes calldata _data,
63:         bool _isSystem
64:     ) internal returns (bytes memory returnData) {

74:     function staticCall(
75:         uint256 _gas,
76:         address _address,
77:         bytes calldata _data
78:     ) internal view returns (bytes memory returnData) {

88:     function delegateCall(
89:         uint256 _gas,
90:         address _address,
91:         bytes calldata _data
92:     ) internal returns (bytes memory returnData) {

105:     function mimicCall(
106:         uint256 _gas,
107:         address _address,
108:         bytes calldata _data,
109:         address _whoToMimic,
110:         bool _isConstructor,
111:         bool _isSystem
112:     ) internal returns (bytes memory returnData) {

124:     function rawCall(
125:         uint256 _gas,
126:         address _address,
127:         uint256 _value,
128:         bytes calldata _data,
129:         bool _isSystem
130:     ) internal returns (bool success) {

159:     function rawStaticCall(uint256 _gas, address _address, bytes calldata _data) internal view returns (bool success) {

173:     function rawDelegateCall(uint256 _gas, address _address, bytes calldata _data) internal returns (bool success) {

191:     function rawMimicCall(
192:         uint256 _gas,
193:         address _address,
194:         bytes calldata _data,
195:         address _whoToMimic,
196:         bool _isConstructor,
197:         bool _isSystem
198:     ) internal returns (bool success) {

232:     function propagateRevert() internal pure {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L36-L36) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L45-L45), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L58-L64), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L74-L78), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L88-L92), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L105-L112), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L124-L130), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L159-L159), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L173-L173), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L191-L198), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L232-L232)


```solidity

File: contracts/libraries/RLPEncoder.sol

11:     function encodeAddress(address _val) internal pure returns (bytes memory encoded) {

24:     function encodeUint256(uint256 _val) internal pure returns (bytes memory encoded) {

49:     function encodeNonSingleBytesLen(uint64 _len) internal pure returns (bytes memory) {

56:     function encodeListLen(uint64 _len) internal pure returns (bytes memory) {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/RLPEncoder.sol#L11-L11) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/RLPEncoder.sol#L24-L24), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/RLPEncoder.sol#L49-L49), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/RLPEncoder.sol#L56-L56)


```solidity

File: contracts/libraries/SystemContractHelper.sol

48:     function toL1(bool _isService, bytes32 _key, bytes32 _value) internal {

63:     function getCodeAddress() internal view returns (address addr) {

74:     function loadCalldataIntoActivePtr() internal view {

85:     function ptrPackIntoActivePtr(uint256 _farCallAbi) internal view {

94:     function ptrAddIntoActive(uint32 _value) internal view {

106:     function ptrShrinkIntoActive(uint32 _shrink) internal view {

124:     function packPrecompileParams(
125:         uint32 _inputMemoryOffset,
126:         uint32 _inputMemoryLength,
127:         uint32 _outputMemoryOffset,
128:         uint32 _outputMemoryLength,
129:         uint64 _perPrecompileInterpreted
130:     ) internal pure returns (uint256 rawParams) {

148:     function unsafePrecompileCall(
149:         uint256 _rawParams,
150:         uint32 _gasToBurn,
151:         uint32 _pubdataToSpend
152:     ) internal view returns (bool success) {

168:     function setValueForNextFarCall(uint128 _value) internal returns (bool success) {

181:     function eventInitialize(uint256 initializer, uint256 value1) internal {

191:     function eventWrite(uint256 value1, uint256 value2) internal {

203:     function getZkSyncMetaBytes() internal view returns (uint256 meta) {

215:     function extractNumberFromMeta(uint256 meta, uint256 offset, uint256 size) internal pure returns (uint256 result) {

227:     function getPubdataPublishedFromMeta(uint256 meta) internal pure returns (uint32 pubdataPublished) {

237:     function getHeapSizeFromMeta(uint256 meta) internal pure returns (uint32 heapSize) {

246:     function getAuxHeapSizeFromMeta(uint256 meta) internal pure returns (uint32 auxHeapSize) {

254:     function getShardIdFromMeta(uint256 meta) internal pure returns (uint8 shardId) {

263:     function getCallerShardIdFromMeta(uint256 meta) internal pure returns (uint8 callerShardId) {

272:     function getCodeShardIdFromMeta(uint256 meta) internal pure returns (uint8 codeShardId) {

279:     function getZkSyncMeta() internal view returns (ZkSyncMeta memory meta) {

296:     function getCallFlags() internal view returns (uint256 callFlags) {

307:     function getCalldataPtr() internal view returns (uint256 ptr) {

318:     function getExtraAbiData(uint256 index) internal view returns (uint256 extraAbiData) {

329:     function isSystemCall() internal view returns (bool) {

338:     function isSystemContract(address _address) internal pure returns (bool) {

344:     function burnGas(uint32 _gasToPay, uint32 _pubdataToSpend) internal view {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L48-L48) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L63-L63), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L74-L74), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L85-L85), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L94-L94), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L106-L106), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L124-L130), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L148-L152), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L168-L168), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L181-L181), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L191-L191), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L203-L203), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L215-L215), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L227-L227), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L237-L237), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L246-L246), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L254-L254), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L263-L263), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L272-L272), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L279-L279), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L296-L296), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L307-L307), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L318-L318), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L329-L329), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L338-L338), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L344-L344)


```solidity

File: contracts/libraries/SystemContractsCaller.sol

76:     function systemCall(uint32 gasLimit, address to, uint256 value, bytes memory data) internal returns (bool success) {

123:     function systemCallWithReturndata(
124:         uint32 gasLimit,
125:         address to,
126:         uint128 value,
127:         bytes memory data
128:     ) internal returns (bool success, bytes memory returnData) {

150:     function systemCallWithPropagatedRevert(
151:         uint32 gasLimit,
152:         address to,
153:         uint128 value,
154:         bytes memory data
155:     ) internal returns (bytes memory returnData) {

214:     function getFarCallABI(
215:         uint32 dataOffset,
216:         uint32 memoryPage,
217:         uint32 dataStart,
218:         uint32 dataLength,
219:         uint32 gasPassed,
220:         uint8 shardId,
221:         CalldataForwardingMode forwardingMode,
222:         bool isConstructorCall,
223:         bool isSystemCall
224:     ) internal pure returns (uint256 farCallAbi) {

250:     function getFarCallABIWithEmptyFatPointer(
251:         uint32 gasPassed,
252:         uint8 shardId,
253:         CalldataForwardingMode forwardingMode,
254:         bool isConstructorCall,
255:         bool isSystemCall
256:     ) internal pure returns (uint256 farCallAbiWithEmptyFatPtr) {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractsCaller.sol#L76-L76) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractsCaller.sol#L123-L128), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractsCaller.sol#L150-L155), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractsCaller.sol#L214-L224), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractsCaller.sol#L250-L256)


```solidity

File: contracts/libraries/TransactionHelper.sol

94:     function isEthToken(uint256 _addr) internal pure returns (bool) {

100:     function encodeHash(Transaction calldata _transaction) internal view returns (bytes32 resultHash) {

362:     function processPaymasterInput(Transaction calldata _transaction) internal {

395:     function payToTheBootloader(Transaction calldata _transaction) internal returns (bool success) {

405:     function totalRequiredBalance(Transaction calldata _transaction) internal pure returns (uint256 requiredBalance) {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L94-L94) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L100-L100), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L362-L362), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L395-L395), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L405-L405)


```solidity

File: contracts/libraries/UnsafeBytesCalldata.sol

19:     function readUint16(bytes calldata _bytes, uint256 _start) internal pure returns (uint16 result) {

26:     function readUint32(bytes calldata _bytes, uint256 _start) internal pure returns (uint32 result) {

33:     function readUint64(bytes calldata _bytes, uint256 _start) internal pure returns (uint64 result) {

40:     function readBytes32(bytes calldata _bytes, uint256 _start) internal pure returns (bytes32 result) {

46:     function readUint256(bytes calldata _bytes, uint256 _start) internal pure returns (uint256 result) {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/UnsafeBytesCalldata.sol#L19-L19) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/UnsafeBytesCalldata.sol#L26-L26), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/UnsafeBytesCalldata.sol#L33-L33), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/UnsafeBytesCalldata.sol#L40-L40), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/UnsafeBytesCalldata.sol#L46-L46)


```solidity

File: contracts/libraries/Utils.sol

20:     function safeCastToU128(uint256 _x) internal pure returns (uint128) {

26:     function safeCastToU32(uint256 _x) internal pure returns (uint32) {

32:     function safeCastToU24(uint256 _x) internal pure returns (uint24) {

39:     function bytecodeLenInBytes(bytes32 _bytecodeHash) internal pure returns (uint256 codeLength) {

44:     function bytecodeLenInWords(bytes32 _bytecodeHash) internal pure returns (uint256 codeLengthInWords) {

51:     function isContractConstructed(bytes32 _bytecodeHash) internal pure returns (bool) {

56:     function isContractConstructing(bytes32 _bytecodeHash) internal pure returns (bool) {

63:     function constructingBytecodeHash(bytes32 _bytecodeHash) internal pure returns (bytes32) {

71:     function constructedBytecodeHash(bytes32 _bytecodeHash) internal pure returns (bytes32) {

82:     function hashL2Bytecode(bytes calldata _bytecode) internal view returns (bytes32 hashedBytecode) {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L20-L20) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L26-L26), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L32-L32), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L39-L39), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L44-L44), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L51-L51), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L56-L56), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L63-L63), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L71-L71), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L82-L82)


```solidity

File: contracts/common/libraries/L2ContractHelper.sol

21:     function hashL2Bytecode(bytes memory _bytecode) internal pure returns (bytes32 hashedBytecode) {

39:     function validateBytecodeHash(bytes32 _bytecodeHash) internal pure {

49:     function bytecodeLen(bytes32 _bytecodeHash) internal pure returns (uint256 codeLengthInWords) {

60:     function computeCreate2Address(
61:         address _sender,
62:         bytes32 _salt,
63:         bytes32 _bytecodeHash,
64:         bytes32 _constructorInputHash
65:     ) internal pure returns (address) {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/L2ContractHelper.sol#L21-L21) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/L2ContractHelper.sol#L39-L39), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/L2ContractHelper.sol#L49-L49), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/L2ContractHelper.sol#L60-L65)


```solidity

File: contracts/common/libraries/UncheckedMath.sol

11:     function uncheckedInc(uint256 _number) internal pure returns (uint256) {

17:     function uncheckedAdd(uint256 _lhs, uint256 _rhs) internal pure returns (uint256) {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/UncheckedMath.sol#L11-L11) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/UncheckedMath.sol#L17-L17)


```solidity

File: contracts/common/libraries/UnsafeBytes.sol

19:     function readUint32(bytes memory _bytes, uint256 _start) internal pure returns (uint32 result, uint256 offset) {

26:     function readAddress(bytes memory _bytes, uint256 _start) internal pure returns (address result, uint256 offset) {

33:     function readUint256(bytes memory _bytes, uint256 _start) internal pure returns (uint256 result, uint256 offset) {

40:     function readBytes32(bytes memory _bytes, uint256 _start) internal pure returns (bytes32 result, uint256 offset) {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/UnsafeBytes.sol#L19-L19) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/UnsafeBytes.sol#L26-L26), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/UnsafeBytes.sol#L33-L33), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/UnsafeBytes.sol#L40-L40)


```solidity

File: contracts/state-transition/libraries/Diamond.sol

87:     function getDiamondStorage() internal pure returns (DiamondStorage storage diamondStorage) {

96:     function diamondCut(DiamondCutData memory _diamondCut) internal {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L87-L87) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L96-L96)


```solidity

File: contracts/state-transition/libraries/LibMap.sol

18:     function get(Uint32Map storage _map, uint256 _index) internal view returns (uint32 result) {

38:     function set(Uint32Map storage _map, uint256 _index, uint32 _value) internal {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/LibMap.sol#L18-L18) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/LibMap.sol#L38-L38)


```solidity

File: contracts/state-transition/libraries/Merkle.sol

18:     function calculateRoot(
19:         bytes32[] calldata _path,
20:         uint256 _index,
21:         bytes32 _itemHash
22:     ) internal pure returns (bytes32) {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Merkle.sol#L18-L22) 


```solidity

File: contracts/state-transition/libraries/PriorityQueue.sol

35:     function getFirstUnprocessedPriorityTx(Queue storage _queue) internal view returns (uint256) {

40:     function getTotalPriorityTxs(Queue storage _queue) internal view returns (uint256) {

45:     function getSize(Queue storage _queue) internal view returns (uint256) {

50:     function isEmpty(Queue storage _queue) internal view returns (bool) {

55:     function pushBack(Queue storage _queue, PriorityOperation memory _operation) internal {

64:     function front(Queue storage _queue) internal view returns (PriorityOperation memory) {

72:     function popFront(Queue storage _queue) internal returns (PriorityOperation memory priorityOperation) {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/PriorityQueue.sol#L35-L35) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/PriorityQueue.sol#L40-L40), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/PriorityQueue.sol#L45-L45), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/PriorityQueue.sol#L50-L50), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/PriorityQueue.sol#L55-L55), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/PriorityQueue.sol#L64-L64), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/PriorityQueue.sol#L72-L72)


```solidity

File: contracts/state-transition/libraries/TransactionValidator.sol

19:     function validateL1ToL2Transaction(
20:         L2CanonicalTransaction memory _transaction,
21:         bytes memory _encoded,
22:         uint256 _priorityTxMaxGasLimit,
23:         uint256 _priorityTxMaxPubdata
24:     ) internal pure {

46:     function validateUpgradeTransaction(L2CanonicalTransaction memory _transaction) internal pure {

69:     function getMinimalPriorityTransactionGasLimit(
70:         uint256 _encodingLength,
71:         uint256 _numberOfFactoryDependencies,
72:         uint256 _l2GasPricePerPubdata
73:     ) internal pure returns (uint256) {

109:     function getTransactionBodyGasLimit(
110:         uint256 _totalGasLimit,
111:         uint256 _encodingLength
112:     ) internal pure returns (uint256 txBodyGasLimit) {

128:     function getOverheadForTransaction(
129:         uint256 _encodingLength
130:     ) internal pure returns (uint256 batchOverheadForTransaction) {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/TransactionValidator.sol#L19-L24) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/TransactionValidator.sol#L46-L46), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/TransactionValidator.sol#L69-L73), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/TransactionValidator.sol#L109-L112), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/TransactionValidator.sol#L128-L130)


```solidity

File: contracts/vendor/AddressAliasHelper.sol

28:     function applyL1ToL2Alias(address l1Address) internal pure returns (address l2Address) {

38:     function undoL1ToL2Alias(address l2Address) internal pure returns (address l1Address) {

28:     function applyL1ToL2Alias(address l1Address) internal pure returns (address l2Address) {

38:     function undoL1ToL2Alias(address l2Address) internal pure returns (address l1Address) {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/vendor/AddressAliasHelper.sol#L28-L28) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/vendor/AddressAliasHelper.sol#L38-L38), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/vendor/AddressAliasHelper.sol#L28-L28), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/vendor/AddressAliasHelper.sol#L38-L38)


```solidity

File: contracts/L2ContractHelper.sol

90:     function sendMessageToL1(bytes memory _message) internal returns (bytes32) {

101:     function computeCreate2Address(
102:         address _sender,
103:         bytes32 _salt,
104:         bytes32 _bytecodeHash,
105:         bytes32 _constructorInputHash
106:     ) internal pure returns (address) {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/L2ContractHelper.sol#L90-L90) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/L2ContractHelper.sol#L101-L106)


```solidity

File: contracts/SystemContractsCaller.sol

27:     function safeCastToU32(uint256 _x) internal pure returns (uint32) {

37:     function systemCall(uint32 gasLimit, address to, uint256 value, bytes memory data) internal returns (bool success) {

76:     function systemCallWithReturndata(
77:         uint32 gasLimit,
78:         address to,
79:         uint128 value,
80:         bytes memory data
81:     ) internal returns (bool success, bytes memory returnData) {

095:     function getFarCallABI(
096:         uint32 dataOffset,
097:         uint32 memoryPage,
098:         uint32 dataStart,
099:         uint32 dataLength,
100:         uint32 gasPassed,
101:         uint8 shardId,
102:         CalldataForwardingMode forwardingMode,
103:         bool isConstructorCall,
104:         bool isSystemCall
105:     ) internal pure returns (uint256 farCallAbi) {

121:     function getFarCallABIWithEmptyFatPointer(
122:         uint32 gasPassed,
123:         uint8 shardId,
124:         CalldataForwardingMode forwardingMode,
125:         bool isConstructorCall,
126:         bool isSystemCall
127:     ) internal pure returns (uint256 farCallAbiWithEmptyFatPtr) {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/SystemContractsCaller.sol#L27-L27) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/SystemContractsCaller.sol#L37-L37), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/SystemContractsCaller.sol#L76-L81), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/SystemContractsCaller.sol#L95-L105), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/SystemContractsCaller.sol#L121-L127)


</details>


### [NC&#x2011;50] Private and internal state variables should have a preceding _ in their name unless they are constants 
Add a preceding underscore to the state variable name, take care to refactor where there variables are read/wrote


*There are 28 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/ContractDeployer.sol

26:     mapping(address => AccountInfo) internal accountInfo;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L26-L26) 


```solidity

File: contracts/ImmutableSimulator.sol

21:     mapping(uint256 contractAddress => mapping(uint256 index => bytes32 value)) internal immutableDataStorage;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ImmutableSimulator.sol#L21-L21) 


```solidity

File: contracts/L1Messenger.sol

28:     bytes32 internal chainedLogsHash;

32:     uint256 internal numberOfLogsToProcess;

36:     bytes32 internal chainedMessagesHash;

41:     bytes32 internal chainedL1BytecodesRevealDataHash;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L28-L28) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L32-L32), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L36-L36), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L41-L41)


```solidity

File: contracts/L2BaseToken.sol

20:     mapping(address account => uint256 balance) internal balance;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L2BaseToken.sol#L20-L20) 


```solidity

File: contracts/NonceHolder.sol

36:     mapping(uint256 account => uint256 packedMinAndDeploymentNonce) internal rawNonces;

41:     mapping(uint256 account => mapping(uint256 nonceKey => uint256 value)) internal nonceValues;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/NonceHolder.sol#L36-L36) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/NonceHolder.sol#L41-L41)


```solidity

File: contracts/SystemContext.sol

51:     BlockInfo internal currentBatchInfo;

55:     mapping(uint256 batchNumber => bytes32 batchHash) internal batchHashes;

58:     BlockInfo internal currentL2BlockInfo;

61:     bytes32 internal currentL2BlockTxsRollingHash;

70:     bytes32[MINIBLOCK_HASHES_TO_STORE] internal l2BlockHash;

77:     BlockInfo internal currentVirtualL2BlockInfo;

80:     VirtualBlockUpgradeInfo internal virtualBlockUpgradeInfo;

95:     uint256 internal basePubdataSpent;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L51-L51) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L55-L55), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L58-L58), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L61-L61), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L70-L70), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L77-L77), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L80-L80), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L95-L95)


```solidity

File: contracts/bridge/L1SharedBridge.sol

45:     uint256 internal eraFirstPostUpgradeBatch;

61:     mapping(uint256 chainId => bool enabled) internal hyperbridgingEnabled;

65:     mapping(uint256 chainId => mapping(address l1Token => uint256 balance)) internal chainBalance;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L45-L45) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L61-L61), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L65-L65)


```solidity

File: contracts/bridgehub/Bridgehub.sol

35:     address private pendingAdmin;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L35-L35) 


```solidity

File: contracts/state-transition/StateTransitionManager.sol

54:     address private pendingAdmin;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L54-L54) 


```solidity

File: contracts/state-transition/ValidatorTimelock.sol

47:     mapping(uint256 => LibMap.Uint32Map) internal committedBatchTimestamp;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L47-L47) 


```solidity

File: contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol

12:     ZkSyncStateTransitionStorage internal s;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L12-L12) 


```solidity

File: contracts/bridge/L2SharedBridge.sol

32:     bytes32 internal l2TokenProxyBytecodeHash;

37:     address private l1LegacyBridge;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L32-L32) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L37-L37)


```solidity

File: contracts/bridge/L2StandardERC20.sol

26:     ERC20Getters private availableGetters;

31:     uint8 private decimals_;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2StandardERC20.sol#L26-L26) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2StandardERC20.sol#L31-L31)


</details>


### [NC&#x2011;51] `public` functions not called by the contract should be declared `external` instead 
Contracts [are allowed](https://docs.soliditylang.org/en/latest/contracts.html#function-overriding) to override their parents' functions and change the visibility from `external` to `public`.


*There are 11 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/ContractDeployer.sol

40:     function extendedAccountVersion(address _address) public view returns (AccountAbstractionVersion) {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L40-L40) 


```solidity

File: contracts/NonceHolder.sol

57:     function getRawNonce(address _address) public view returns (uint256) {

65:     function increaseMinNonce(uint256 _value) public onlySystemCall returns (uint256 oldMinNonce) {

82:     function setValueUnderNonce(uint256 _key, uint256 _value) public onlySystemCall {

102:     function getValueUnderNonce(uint256 _key) public view returns (uint256) {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/NonceHolder.sol#L57-L57) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/NonceHolder.sol#L65-L65), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/NonceHolder.sol#L82-L82), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/NonceHolder.sol#L102-L102)


```solidity

File: contracts/SystemContext.sol

190:     function getBlockNumber() public view returns (uint128) {

198:     function getBlockTimestamp() public view returns (uint128) {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L190-L190) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L198-L198)


```solidity

File: contracts/state-transition/chain-deps/facets/Mailbox.sol

54:     function proveL2MessageInclusion(

74:     function proveL1ToL2TransactionStatus(

143:     function l2TransactionBaseCost(


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L54-L54) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L74-L74), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L143-L143)


```solidity

File: contracts/upgrades/BaseZkSyncUpgrade.sol

67:     function upgrade(ProposedUpgrade calldata _proposedUpgrade) public virtual returns (bytes32 txHash) {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgrade.sol#L67-L67) 


</details>


### [NC&#x2011;52] Adding a `return` statement when the function defines a named return variable, is redundant 
Once the return variable has been assigned (or has its default value), there is no need to explicitly return it at the end of the function, since it's returned automatically.


*There are 1 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/NonceHolder.sol

129:         return deploymentNonce;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/NonceHolder.sol#L129-L129) 


</details>


### [NC&#x2011;53] `require()` / `revert()` statements should have descriptive reason strings 



*There are 16 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/BootloaderUtilities.sol

37:             revert("Unsupported tx type");


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L37-L37) 


```solidity

File: contracts/Compressor.sol

242:                 revert("unsupported operation");


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Compressor.sol#L242-L242) 


```solidity

File: contracts/NonceHolder.sol

170:             revert("Reusing the same nonce twice");

172:             revert("The nonce was not set as used");


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/NonceHolder.sol#L170-L170) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/NonceHolder.sol#L172-L172)


```solidity

File: contracts/SystemContext.sol

394:             revert("Invalid new L2 block number");


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L394-L394) 


```solidity

File: contracts/libraries/TransactionHelper.sol

388:             revert("Unsupported paymaster flow");

112:             revert("Encoding unsupported tx");


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L388-L388) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L112-L112)


```solidity

File: contracts/interfaces/ISystemContract.sol

55:         require(msg.sender == FORCE_DEPLOYER);


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ISystemContract.sol#L55-L55) 


```solidity

File: contracts/bridge/L1SharedBridge.sol

522:             revert("ShB Incorrect message function selector");


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L522-L522) 


```solidity

File: contracts/state-transition/chain-deps/facets/Executor.sol

51:             require(_newBatch.pubdataCommitments.length == 1);

184:                 revert("ul");


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L51-L51) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L184-L184)


```solidity

File: contracts/state-transition/libraries/Diamond.sol

116:                 revert("C"); // undefined diamond cut action

287:                     revert("I"); // delegatecall failed


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L116-L116) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L287-L287)


```solidity

File: contracts/bridge/L2StandardERC20.sol

161:         if (availableGetters.ignoreName) revert();

167:         if (availableGetters.ignoreSymbol) revert();

173:         if (availableGetters.ignoreDecimals) revert();


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2StandardERC20.sol#L161-L161) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2StandardERC20.sol#L167-L167), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2StandardERC20.sol#L173-L173)


</details>


### [NC&#x2011;54] Setters should prevent re-setting of the same value 
This especially problematic when the setter also emits the same value, which may be confusing to offline parsers


*There are 15 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/SystemContext.sol

//@audit `chainId` and `_newChainId` are never checked for the same value setting
84:     function setChainId(uint256 _newChainId) external onlyCallFromForceDeployer {
85:         chainId = _newChainId;

//@audit `origin` and `_newOrigin` are never checked for the same value setting
099:     function setTxOrigin(address _newOrigin) external onlyCallFromBootloader {
100:         origin = _newOrigin;

//@audit `gasPrice` and `_gasPrice` are never checked for the same value setting
105:     function setGasPrice(uint256 _gasPrice) external onlyCallFromBootloader {
106:         gasPrice = _gasPrice;

//@audit `basePubdataSpent` and `_basePubdataSpent` are never checked for the same value setting
112:     function setPubdataInfo(uint256 _gasPerPubdataByte, uint256 _basePubdataSpent) external onlyCallFromBootloader {
113:         basePubdataSpent = _basePubdataSpent;

//@audit `gasPerPubdataByte` and `_gasPerPubdataByte` are never checked for the same value setting
112:     function setPubdataInfo(uint256 _gasPerPubdataByte, uint256 _basePubdataSpent) external onlyCallFromBootloader {
113:         basePubdataSpent = _basePubdataSpent;
114:         gasPerPubdataByte = _gasPerPubdataByte;

//@audit `currentVirtualL2BlockInfo` and `virtualBlockInfo` are never checked for the same value setting
263:     function _setVirtualBlock(
264:         uint128 _l2BlockNumber,
265:         uint128 _maxVirtualBlocksToCreate,
266:         uint128 _newTimestamp
267:     ) internal {
268:         if (virtualBlockUpgradeInfo.virtualBlockFinishL2Block != 0) {
269:             // No need to to do anything about virtual blocks anymore
270:             // All the info is the same as for L2 blocks.
271:             currentVirtualL2BlockInfo = currentL2BlockInfo;
272:             return;
273:         }
274: 
275:         BlockInfo memory virtualBlockInfo = currentVirtualL2BlockInfo;
276: 
277:         if (currentVirtualL2BlockInfo.number == 0 && virtualBlockInfo.timestamp == 0) {
278:             uint128 currentBatchNumber = currentBatchInfo.number;
279: 
280:             // The virtual block is set for the first time. We can count it as 1 creation of a virtual block.
281:             // Note, that when setting the virtual block number we use the batch number to make a smoother upgrade from batch number to
282:             // the L2 block number.
283:             virtualBlockInfo.number = currentBatchNumber;
284:             // Remembering the batch number on which the upgrade to the virtual blocks has been done.
285:             virtualBlockUpgradeInfo.virtualBlockStartBatch = currentBatchNumber;
286: 
287:             require(_maxVirtualBlocksToCreate > 0, "Can't initialize the first virtual block");
288:             _maxVirtualBlocksToCreate -= 1;
289:         } else if (_maxVirtualBlocksToCreate == 0) {
290:             // The virtual blocks have been already initialized, but the operator didn't ask to create
291:             // any new virtual blocks. So we can just return.
292:             return;
293:         }
294: 
295:         virtualBlockInfo.number += _maxVirtualBlocksToCreate;
296:         virtualBlockInfo.timestamp = _newTimestamp;
297: 
298:         // The virtual block number must never exceed the L2 block number.
299:         // We do not use a `require` here, since the virtual blocks are a temporary solution to let the Solidity's `block.number`
300:         // catch up with the L2 block number and so the situation where virtualBlockInfo.number starts getting larger
301:         // than _l2BlockNumber is expected once virtual blocks have caught up the L2 blocks.
302:         if (virtualBlockInfo.number >= _l2BlockNumber) {
303:             virtualBlockUpgradeInfo.virtualBlockFinishL2Block = _l2BlockNumber;
304:             virtualBlockInfo.number = _l2BlockNumber;
305:         }
306: 
307:         currentVirtualL2BlockInfo = virtualBlockInfo;

//@audit `currentVirtualL2BlockInfo` and `currentL2BlockInfo` are never checked for the same value setting
263:     function _setVirtualBlock(
264:         uint128 _l2BlockNumber,
265:         uint128 _maxVirtualBlocksToCreate,
266:         uint128 _newTimestamp
267:     ) internal {
268:         if (virtualBlockUpgradeInfo.virtualBlockFinishL2Block != 0) {
269:             // No need to to do anything about virtual blocks anymore
270:             // All the info is the same as for L2 blocks.
271:             currentVirtualL2BlockInfo = currentL2BlockInfo;

//@audit `currentBatchInfo` and `newBlockInfo` are never checked for the same value setting
444:     function setNewBatch(
445:         bytes32 _prevBatchHash,
446:         uint128 _newTimestamp,
447:         uint128 _expectedNewNumber,
448:         uint256 _baseFee
449:     ) external onlyCallFromBootloader {
450:         (uint128 previousBatchNumber, uint128 previousBatchTimestamp) = getBatchNumberAndTimestamp();
451:         require(_newTimestamp > previousBatchTimestamp, "Timestamps should be incremental");
452:         require(previousBatchNumber + 1 == _expectedNewNumber, "The provided block number is not correct");
453: 
454:         _ensureBatchConsistentWithL2Block(_newTimestamp);
455: 
456:         batchHashes[previousBatchNumber] = _prevBatchHash;
457: 
458:         // Setting new block number and timestamp
459:         BlockInfo memory newBlockInfo = BlockInfo({number: previousBatchNumber + 1, timestamp: _newTimestamp});
460: 
461:         currentBatchInfo = newBlockInfo;

//@audit `baseFee` and `_baseFee` are never checked for the same value setting
444:     function setNewBatch(
445:         bytes32 _prevBatchHash,
446:         uint128 _newTimestamp,
447:         uint128 _expectedNewNumber,
448:         uint256 _baseFee
449:     ) external onlyCallFromBootloader {
450:         (uint128 previousBatchNumber, uint128 previousBatchTimestamp) = getBatchNumberAndTimestamp();
451:         require(_newTimestamp > previousBatchTimestamp, "Timestamps should be incremental");
452:         require(previousBatchNumber + 1 == _expectedNewNumber, "The provided block number is not correct");
453: 
454:         _ensureBatchConsistentWithL2Block(_newTimestamp);
455: 
456:         batchHashes[previousBatchNumber] = _prevBatchHash;
457: 
458:         // Setting new block number and timestamp
459:         BlockInfo memory newBlockInfo = BlockInfo({number: previousBatchNumber + 1, timestamp: _newTimestamp});
460: 
461:         currentBatchInfo = newBlockInfo;
462: 
463:         baseFee = _baseFee;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L84-L85) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L99-L100), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L105-L106), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L112-L113), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L112-L114), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L263-L307), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L263-L271), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L444-L461), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L444-L463)


```solidity

File: contracts/bridgehub/Bridgehub.sol

//@audit `pendingAdmin` and `_newPendingAdmin` are never checked for the same value setting
51:     function setPendingAdmin(address _newPendingAdmin) external onlyOwnerOrAdmin {
52:         // Save previous value into the stack to put it into the event later
53:         address oldPendingAdmin = pendingAdmin;
54:         // Change pending admin
55:         pendingAdmin = _newPendingAdmin;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L51-L55) 


```solidity

File: contracts/state-transition/StateTransitionManager.sol

//@audit `pendingAdmin` and `_newPendingAdmin` are never checked for the same value setting
110:     function setPendingAdmin(address _newPendingAdmin) external onlyOwnerOrAdmin {
111:         // Save previous value into the stack to put it into the event later
112:         address oldPendingAdmin = pendingAdmin;
113:         // Change pending admin
114:         pendingAdmin = _newPendingAdmin;

//@audit `validatorTimelock` and `_validatorTimelock` are never checked for the same value setting
132:     function setValidatorTimelock(address _validatorTimelock) external onlyOwnerOrAdmin {
133:         validatorTimelock = _validatorTimelock;

//@audit `protocolVersion` and `_newProtocolVersion` are never checked for the same value setting
142:     function setNewVersionUpgrade(
143:         Diamond.DiamondCutData calldata _cutData,
144:         uint256 _oldProtocolVersion,
145:         uint256 _newProtocolVersion
146:     ) external onlyOwner {
147:         upgradeCutHash[_oldProtocolVersion] = keccak256(abi.encode(_cutData));
148:         protocolVersion = _newProtocolVersion;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L110-L114) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L132-L133), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L142-L148)


```solidity

File: contracts/state-transition/ValidatorTimelock.sol

//@audit `stateTransitionManager` and `_stateTransitionManager` are never checked for the same value setting
73:     function setStateTransitionManager(IStateTransitionManager _stateTransitionManager) external onlyOwner {
74:         stateTransitionManager = _stateTransitionManager;

//@audit `executionDelay` and `_executionDelay` are never checked for the same value setting
96:     function setExecutionDelay(uint32 _executionDelay) external onlyOwner {
97:         executionDelay = _executionDelay;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L73-L74) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L96-L97)


</details>


### [NC&#x2011;55] NatSpec `@return` argument is missing 



*There are 100 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/Compressor.sol

// @audit the @return is missing
@notice Decode the raw compressed data into the dictionary and the encoded data.
 @param _rawCompressedData The compressed bytecode in a format of:
    - 2 bytes: the bytes length of the dictionary
    - N bytes: the dictionary
    - M bytes: the encoded data


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Compressor.sol#L197-L1) 


```solidity

File: contracts/ContractDeployer.sol

// @audit the @return is missing
@notice Returns information about a certain account.

// @audit the @return is missing
@notice Returns the account abstraction version if `_address` is a deployed contract.
 Returns the latest supported account abstraction version if `_address` is an EOA.

// @audit the @return is missing
@notice Calculates the address of a deployed contract via create
 @param _sender The account that deploys the contract.
 @param _senderNonce The deploy nonce of the sender's account.

// @audit the @return is missing
@notice Deploys a contract with similar address derivation rules to the EVM's `CREATE2` opcode.
 @param _salt The CREATE2 salt
 @param _bytecodeHash The correctly formatted hash of the bytecode.
 @param _input The constructor calldata

// @audit the @return is missing
@notice Deploys a contract with similar address derivation rules to the EVM's `CREATE` opcode.
 @param _bytecodeHash The correctly formatted hash of the bytecode.
 @param _input The constructor calldata
 @dev This method also accepts nonce as one of its parameters.
 It is not used anywhere and it needed simply for the consistency for the compiler
 Note: this method may be callable only in system mode,
 that is checked in the `createAccount` by `onlySystemCall` modifier.

// @audit the @return is missing
@notice Deploys a contract account with similar address derivation rules to the EVM's `CREATE2` opcode.
 @param _salt The CREATE2 salt
 @param _bytecodeHash The correctly formatted hash of the bytecode.
 @param _input The constructor calldata.
 @param _aaVersion The account abstraction version to use.
 Note: this method may be callable only in system mode,
 that is checked in the `createAccount` by `onlySystemCall` modifier.

// @audit the @return is missing
@notice Deploys a contract account with similar address derivation rules to the EVM's `CREATE` opcode.
 @param _bytecodeHash The correctly formatted hash of the bytecode.
 @param _input The constructor calldata.
 @param _aaVersion The account abstraction version to use.
 @dev This method also accepts salt as one of its parameters.
 It is not used anywhere and it needed simply for the consistency for the compiler


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L34-L1) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L40-L1), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L115-L1), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L132-L1), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L147-L1), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L162-L1), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L182-L1)


```solidity

File: contracts/DefaultAccount.sol

// @audit the @return is missing
@notice Validates the transaction & increments nonce.
 @dev The transaction is considered accepted by the account if
 the call to this function by the bootloader does not revert
 and the nonce has been set as used.
 @param _suggestedSignedHash The suggested hash of the transaction to be signed by the user.
 This is the hash that is signed by the EOA by default.
 @param _transaction The transaction structure itself.
 @dev Besides the params above, it also accepts unused first paramter "_txHash", which
 is the unique (canonical) hash of the transaction.

// @audit the @return is missing
@notice Inner method for validating transaction and increasing the nonce
 @param _suggestedSignedHash The hash of the transaction signed by the EOA
 @param _transaction The transaction.


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/DefaultAccount.sol#L67-L1) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/DefaultAccount.sol#L78-L1)


```solidity

File: contracts/KnownCodesStorage.sol

// @audit the @return is missing
@notice Returns the marker stored for a bytecode hash. 1 means that the bytecode hash is known
 and can be used for deploying contracts. 0 otherwise.


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/KnownCodesStorage.sol#L65-L1) 


```solidity

File: contracts/L1Messenger.sol

// @audit the @return is missing
The gas cost of calculation of keccak256 of bytes array of such length.

// @audit the @return is missing
The gas cost of calculation of sha256 of bytes array of such length.

// @audit the @return is missing
@notice Sends L2ToL1Log.
 @param _isService The `isService` flag.
 @param _key The `key` part of the L2Log.
 @param _value The `value` part of the L2Log.
 @dev Can be called only by a system contract.

// @audit the @return is missing
@notice Internal function to send L2ToL1Log.

// @audit the @return is missing
@notice Public functionality to send messages to L1.
 @param _message The message intended to be sent to L1.


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L50-L1) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L61-L1), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L70-L1), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L94-L1), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L116-L1)


```solidity

File: contracts/L2BaseToken.sol

// @audit the @return is missing
@notice Returns ETH balance of an account
 @dev It takes `uint256` as an argument to be able to properly simulate the behaviour of the
 Ethereum's `BALANCE` opcode that accepts uint256 as an argument and truncates any upper bits
 @param _account The address of the account to return the balance of.

// @audit the @return is missing
@dev The function burn the sent `msg.value`.
 NOTE: Since this contract holds the mapping of all ether balances of the system,
 the sent `msg.value` is added to the `this` balance before the call.
 So the balance of `address(this)` is always bigger or equal to the `msg.value`!

// @audit the @return is missing
@dev Get the message to be sent to L1 to initiate a withdrawal.

// @audit the @return is missing
@dev Get the message to be sent to L1 to initiate a withdrawal.

// @audit the @return is missing
@dev This method has not been stabilized and might be
 removed later on.

// @audit the @return is missing
@dev This method has not been stabilized and might be
 removed later on.

// @audit the @return is missing
@dev This method has not been stabilized and might be
 removed later on.


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L2BaseToken.sol#L56-L1) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L2BaseToken.sol#L99-L1), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L2BaseToken.sol#L112-L1), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L2BaseToken.sol#L117-L1), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L2BaseToken.sol#L128-L1), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L2BaseToken.sol#L134-L1), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L2BaseToken.sol#L140-L1)


```solidity

File: contracts/MsgValueSimulator.sol

// @audit the @return is missing
@notice Extract value, isSystemCall and to from the extraAbi params.
 @dev The contract accepts value, the callee and whether the call should be a system one via its ABI params.
 @dev The first ABI param contains the value in the [0..127] bits. The 128th contains
 the flag whether or not the call should be a system one.
 The second ABI params contains the callee.


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/MsgValueSimulator.sol#L25-L1) 


```solidity

File: contracts/SystemContext.sol

// @audit the @return is missing
@notice Calculates the hash of an L2 block.
 @param _blockNumber The number of the L2 block.
 @param _blockTimestamp The timestamp of the L2 block.
 @param _prevL2BlockHash The hash of the previous L2 block.
 @param _blockTxsRollingHash The rolling hash of the transactions in the L2 block.

// @audit the @return is missing
@notice Calculates the legacy block hash of L2 block, which were used before the upgrade where
 the advanced block hashes were introduced.
 @param _blockNumber The number of the L2 block.

// @audit the @return is missing
@notice Returns the current batch's number and timestamp.
 @dev Deprecated in favor of getBatchNumberAndTimestamp.

// @audit the @return is missing
@notice Returns the current batch's number and timestamp.
 @dev Deprecated in favor of getBatchNumberAndTimestamp.

// @audit the @return is missing
@notice Returns the hash of the given batch.
 @dev Deprecated in favor of getBatchHash.


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L221-L1) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L233-L1), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L496-L1), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L503-L1), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L509-L1)


```solidity

File: contracts/libraries/RLPEncoder.sol

// @audit the @return is missing
@notice Encodes the size of bytes in RLP format.
 @param _len The length of the bytes to encode. It has a `uint64` type since as larger values are not supported.
 NOTE: panics if the length is 1 since the length encoding is ambiguous in this case.

// @audit the @return is missing
@notice Encodes the size of list items in RLP format.
 @param _len The length of the bytes to encode. It has a `uint64` type since as larger values are not supported.

// @audit the @return is missing
@notice Computes the index of the highest byte set in number.
 @notice Uses little endian ordering (The least significant byte has index `0`).
 NOTE: returns `0` for `0`


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/RLPEncoder.sol#L49-L1) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/RLPEncoder.sol#L56-L1), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/RLPEncoder.sol#L84-L1)


```solidity

File: contracts/libraries/SystemContractHelper.sol

// @audit the @return is missing
@notice Get address of the currently executed code.
 @dev This allows differentiating between `call` and `delegatecall`.
 During the former `this` and `codeAddress` are the same, while
 during the latter they are not.

// @audit the @return is missing
@notice packs precompile parameters into one word
 @param _inputMemoryOffset The memory offset in 32-byte words for the input data for calling the precompile.
 @param _inputMemoryLength The length of the input data in words.
 @param _outputMemoryOffset The memory offset in 32-byte words for the output data.
 @param _outputMemoryLength The length of the output data in words.
 @param _perPrecompileInterpreted The constant, the meaning of which is defined separately for
 each precompile. For information, please read the documentation of the precompilecall log in
 the VM.

// @audit the @return is missing
@notice Set `msg.value` to next far call.
 @param _value The msg.value that will be used for the *next* call.
 @dev If called not in kernel mode, it will result in a revert (enforced by the VM)


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L63-L1) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L124-L1), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L168-L1)


```solidity

File: contracts/libraries/TransactionHelper.sol

// @audit the @return is missing
@notice Calculate the suggested signed hash of the transaction,
 i.e. the hash that is signed by EOAs and is recommended to be signed by other accounts.

// @audit the @return is missing
@notice Pays the required fee for the transaction to the bootloader.
 @dev Currently it pays the maximum amount "_transaction.maxFeePerGas * _transaction.gasLimit",
 it will change in the future.


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L100-L1) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L395-L1)


```solidity

File: contracts/libraries/Utils.sol

// @audit the @return is missing
@notice Denotes whether bytecode hash corresponds to a contract that already constructed

// @audit the @return is missing
@notice Denotes whether bytecode hash corresponds to a contract that is on constructor or has already been constructed


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L51-L1) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L56-L1)


```solidity

File: contracts/interfaces/IContractDeployer.sol

// @audit the @return is missing
@dev While the `_salt` parameter is not used anywhere here,
 it is still needed for consistency between `create` and
 `create2` functions (required by the compiler).

// @audit the @return is missing
@dev While `_salt` is never used here, we leave it here as a parameter
 for the consistency with the `create` function.

// @audit the @return is missing
@notice Returns the information about a certain AA.


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IContractDeployer.sol#L68-L1) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IContractDeployer.sol#L76-L1), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IContractDeployer.sol#L84-L1)


```solidity

File: contracts/interfaces/INonceHolder.sol

// @audit the @return is missing
@dev Returns the current minimal nonce for account.

// @audit the @return is missing
@dev Returns the raw version of the current minimal nonce
 (equal to minNonce + 2^128 * deployment nonce).

// @audit the @return is missing
@dev Increases the minimal nonce for the msg.sender.

// @audit the @return is missing
@dev Gets the value stored inside a custom nonce.

// @audit the @return is missing
@dev Returns the deployment nonce for the accounts used for CREATE opcode.

// @audit the @return is missing
@dev Increments the deployment nonce for the account and returns the previous one.

// @audit the @return is missing
@dev Returns whether a nonce has been used for an account.


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/INonceHolder.sol#L17-L1) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/INonceHolder.sol#L21-L1), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/INonceHolder.sol#L24-L1), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/INonceHolder.sol#L30-L1), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/INonceHolder.sol#L37-L1), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/INonceHolder.sol#L40-L1), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/INonceHolder.sol#L46-L1)


```solidity

File: contracts/bridge/L1SharedBridge.sol

// @audit the @return is missing
@notice Initiates a deposit transaction within Bridgehub, used by `requestL2TransactionTwoBridges`.

// @audit the @return is missing
@dev Generate a calldata for calling the deposit finalization on the L2 bridge contract

// @audit the @return is missing
@dev Receives and parses (name, symbol, decimals) from the token contract

// @audit the @return is missing
@dev Internal function that handles the logic for finalizing withdrawals,
 serving both the current bridge system and the legacy ERC20 bridge.

// @audit the @return is missing
@dev Verifies the validity of a withdrawal message from L2 and returns details of the withdrawal.


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L182-L1) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L243-L1), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L254-L1), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L409-L1), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L458-L1)


```solidity

File: contracts/bridgehub/Bridgehub.sol

// @audit the @return is missing
@notice return the state transition chain contract for a chainId

// @audit the @return is missing
@notice register new chain
 @notice for Eth the baseToken address is 1

// @audit the @return is missing
@notice forwards function call to Mailbox based on ChainId

// @audit the @return is missing
@notice forwards function call to Mailbox based on ChainId

// @audit the @return is missing
@notice forwards function call to Mailbox based on ChainId

// @audit the @return is missing
@notice forwards function call to Mailbox based on ChainId

// @audit the @return is missing
@notice the mailbox is called directly after the sharedBridge received the deposit
 this assumes that either ether is the base token or
 the msg.sender has approved mintValue allowance for the sharedBridge.
 This means this is not ideal for contract calls, as the contract would have to handle token allowance of the base Token

// @audit the @return is missing
@notice After depositing funds to the sharedBridge, the secondBridge is called
  to return the actual L2 message which is sent to the Mailbox.
  This assumes that either ether is the base token or
  the msg.sender has approved the sharedBridge with the mintValue,
  and also the necessary approvals are given for the second bridge.
 @notice The logic of this bridge is to allow easy depositing for bridges.
 Each contract that handles the users ERC20 tokens needs approvals from the user, this contract allows
 the user to approve for each token only its respective bridge
 @notice This function is great for contract calls to L2, the secondBridge can be any contract.


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L75-L1) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L114-L1), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L152-L1), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L164-L1), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L176-L1), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L198-L1), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L217-L1), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L262-L1)


```solidity

File: contracts/governance/Governance.sol

// @audit the @return is missing
@dev Returns whether an id corresponds to a registered operation. This
 includes Waiting, Ready, and Done operations.

// @audit the @return is missing
@dev Returns whether an operation is pending or not. Note that a "pending" operation may also be "ready".

// @audit the @return is missing
@dev Returns whether an operation is ready for execution. Note that a "ready" operation is also "pending".

// @audit the @return is missing
@dev Returns whether an operation is done or not.

// @audit the @return is missing
@dev Returns operation state.

// @audit the @return is missing
@dev Returns the identifier of an operation.
 @param _operation The operation object to compute the identifier for.


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/Governance.sol#L84-L1) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/Governance.sol#L89-L1), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/Governance.sol#L95-L1), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/Governance.sol#L100-L1), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/Governance.sol#L105-L1), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/Governance.sol#L204-L1)


```solidity

File: contracts/state-transition/ValidatorTimelock.sol

// @audit the @return is missing
@dev Returns the timestamp when `_l2BatchNumber` was committed.


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L102-L1) 


```solidity

File: contracts/state-transition/chain-deps/facets/Executor.sol

// @audit the @return is missing
@dev Process one batch commit using the previous batch StoredBatchInfo
 @dev returns new batch StoredBatchInfo
 @notice Does not change storage

// @audit the @return is missing
@dev Check that L2 logs are proper and batch contain all meta information for them
 @dev The logs processed here should line up such that only one log for each key from the
      SystemLogKey enum in Constants.sol is processed per new batch.
 @dev Data returned from here will be used to form the batch commitment.

// @audit the @return is missing
@dev Pops the priority operations from the priority queue and returns a rolling hash of operations

// @audit the @return is missing
@dev Gets zk proof public input

// @audit the @return is missing
@dev Creates batch commitment from its data

// @audit the @return is missing
@dev Encodes the commitment to blobs to be used in the auxiliary output of the batch commitment
 @param _blobCommitments - the commitments to the blobs
 @param _blobHashes - the hashes of the blobs
 @param blobAuxOutputWords - The circuit commitment to the blobs split into 32-byte words

// @audit the @return is missing
@notice Returns the keccak hash of the ABI-encoded StoredBatchInfo

// @audit the @return is missing
@notice Returns true if the bit at index {_index} is 1

// @audit the @return is missing
@notice Sets the given bit in {_num} at index {_index} to 1.

// @audit the @return is missing
@dev Verifies that the blobs contain the correct data by calling the point evaluation precompile. For the precompile we need:
 versioned hash || opening point || opening value || commitment || proof
 the _pubdataCommitments will contain the last 4 values, the versioned hash is pulled from the BLOBHASH opcode
 pubdataCommitments is a list of: opening point (16 bytes) || claimed value (32 bytes) || commitment (48 bytes) || proof (48 bytes)) = 144 bytes

// @audit the @return is missing
@dev Since we don't have access to the new BLOBHASH opecode we need to leverage a static call to a yul contract
 that calls the opcode via a verbatim call. This should be swapped out once there is solidity support for the
 new opcode.


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L32-L1) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L130-L1), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L308-L1), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L453-L1), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L500-L1), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L561-L1), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L587-L1), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L592-L1), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L597-L1), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L625-L1), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L679-L1)


```solidity

File: contracts/state-transition/chain-deps/facets/Mailbox.sol

// @audit the @return is missing
@notice when requesting transactions through the bridgehub

// @audit the @return is missing
@dev Prove that a specific L2 log was sent in a specific L2 batch number

// @audit the @return is missing
@dev Convert arbitrary-length message to the raw l2 log

// @audit the @return is missing
@notice Stores a transaction record in storage & send event about that

// @audit the @return is missing
@notice Hashes the L2 bytecodes and returns them in the format in which they are processed by the bootloader


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L47-L1) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L104-L1), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L130-L1), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L316-L1), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L353-L1)


```solidity

File: contracts/upgrades/DefaultUpgrade.sol

// @audit the @return is missing
@notice The main function that will be called by the upgrade proxy.
 @param _proposedUpgrade The upgrade to be executed.


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/DefaultUpgrade.sol#L13-L1) 


```solidity

File: contracts/upgrades/GenesisUpgrade.sol

// @audit the @return is missing
@notice The main function that will be called by the upgrade proxy.
 @param _proposedUpgrade The upgrade to be executed.


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/GenesisUpgrade.sol#L14-L1) 


```solidity

File: contracts/state-transition/libraries/Merkle.sol

// @audit the @return is missing
@dev Keccak hash of the concatenation of two 32-byte words


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Merkle.sol#L40-L1) 


```solidity

File: contracts/state-transition/libraries/TransactionValidator.sol

// @audit the @return is missing
@notice Based on the full L2 gas limit (that includes the batch overhead) and other
 properties of the transaction, returns the l2GasLimit for the body of the transaction (the actual execution).
 @param _totalGasLimit The L2 gas limit that includes both the overhead for processing the batch
 and the L2 gas needed to process the transaction itself (i.e. the actual l2GasLimit that will be used for the transaction).
 @param _encodingLength The length of the ABI-encoding of the transaction.

// @audit the @return is missing
@notice Based on the total L2 gas limit and several other parameters of the transaction
 returns the part of the L2 gas that will be spent on the batch's overhead.
 @dev The details of how this function works can be checked in the documentation
 of the fee model of zkSync. The appropriate comments are also present
 in the Rust implementation description of function `get_maximal_allowed_overhead`.
 @param _encodingLength The length of the binary encoding of the transaction in bytes


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/TransactionValidator.sol#L109-L1) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/TransactionValidator.sol#L128-L1)


```solidity

File: contracts/bridge/interfaces/IL1SharedBridge.sol

// @audit the @return is missing
data is abi encoded :
 address _l1Token,
 uint256 _amount,
 address _l2Receiver


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L128-L1) 


```solidity

File: contracts/bridgehub/IBridgehub.sol

// @audit the @return is missing
Getters

// @audit the @return is missing
Mailbox forwarder


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L59-L1) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L73-L1)


```solidity

File: contracts/bridge/L2SharedBridge.sol

// @audit the @return is missing
@dev Deploy and initialize the L2 token for the L1 counterpart

// @audit the @return is missing
@dev Encode the message for l2ToL1log sent with withdraw initialization

// @audit the @return is missing
@dev Convert the L1 token address to the create2 salt of deployed L2 token

// @audit the @return is missing
@dev Deploy the beacon proxy for the L2 token, while using ContractDeployer system contract.
 @dev This function uses raw call to ContractDeployer to make sure that exactly `l2TokenProxyBytecodeHash` is used
 for the code of the proxy.


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L109-L1) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L138-L1), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L157-L1), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L164-L1)


```solidity

File: contracts/bridge/L2StandardERC20.sol

// @audit the @return is missing
@dev External function to decode a string from bytes.

// @audit the @return is missing
@dev External function to decode a uint8 from bytes.


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2StandardERC20.sol#L178-L1) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2StandardERC20.sol#L183-L1)


```solidity

File: contracts/L2ContractHelper.sol

// @audit the @return is missing
@notice Creates a new contract at a determined address using the `CREATE2` salt on L2
 @param _salt a unique value to create the deterministic address of the new contract
 @param _bytecodeHash the bytecodehash of the new contract to be deployed
 @param _input the calldata to be sent to the constructor of the new contract


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/L2ContractHelper.sol#L53-L1) 


</details>


### [NC&#x2011;56] Consider using `SafeTransferLib.safeTransferETH()` or `Address.sendValue()` for clearer semantic meaning 
These Functions indicate their purpose with their name more clearly than using low-level calls.


*There are 2 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/MsgValueSimulator.sol

63:             (bool success, ) = address(REAL_BASE_TOKEN_SYSTEM_CONTRACT).call(


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/MsgValueSimulator.sol#L63-L63) 


```solidity

File: contracts/governance/Governance.sol

226:             (bool success, bytes memory returnData) = _calls[i].target.call{value: _calls[i].value}(_calls[i].data);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/Governance.sol#L226-L226) 


</details>


### [NC&#x2011;57] Polymorphic functions make security audits more time-consuming and error-prone 
The instances below point to one of two functions with the same name. Consider naming each function differently, in order to make code navigation and analysis easier.


*There are 2 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/bridge/L1ERC20Bridge.sol

133:     function deposit(


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1ERC20Bridge.sol#L133-L133) 


```solidity

File: contracts/bridge/interfaces/IL1ERC20Bridge.sol

35:     function deposit(


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1ERC20Bridge.sol#L35-L35) 


</details>


### [NC&#x2011;58] Large multiples of ten should use scientific notation (e.g. `1e6`) rather than decimal literals (e.g. `1000000`), for readability 
While the compiler knows to optimize away the exponentiation, it's still better coding practice to use idioms that do not require compiler optimization, if they exist


*There are 1 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/common/Config.sol

//@audit `10000`
92: uint256 constant TX_SLOT_OVERHEAD_L2_GAS = 10000;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/Config.sol#L92-L92) 


</details>


### [NC&#x2011;59] Consider moving `msg.sender` checks to a common authorization `modifier` 



*There are 9 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/ComplexUpgrader.sol

22:         require(msg.sender == FORCE_DEPLOYER, "Can only be called by FORCE_DEPLOYER");


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ComplexUpgrader.sol#L22-L22) 


```solidity

File: contracts/ImmutableSimulator.sol

35:         require(msg.sender == address(DEPLOYER_SYSTEM_CONTRACT), "Callable only by the deployer system contract");


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ImmutableSimulator.sol#L35-L35) 


```solidity

File: contracts/NonceHolder.sol

137:             msg.sender == address(DEPLOYER_SYSTEM_CONTRACT),


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/NonceHolder.sol#L137-L137) 


```solidity

File: contracts/bridge/L1ERC20Bridge.sol

64:         require(msg.sender == address(sharedBridge), "Not shared bridge");


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1ERC20Bridge.sol#L64-L64) 


```solidity

File: contracts/bridge/L1SharedBridge.sol

138:         require(bridgehub.getStateTransition(_chainId) == msg.sender, "receiveEth not state transition");


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L138-L138) 


```solidity

File: contracts/bridgehub/Bridgehub.sol

62:         require(msg.sender == currentPendingAdmin, "n42"); // Only proposed by current admin address can claim the admin rights


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L62-L62) 


```solidity

File: contracts/state-transition/StateTransitionManager.sol

121:         require(msg.sender == currentPendingAdmin, "n42"); // Only proposed by current admin address can claim the admin rights


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L121-L121) 


```solidity

File: contracts/state-transition/chain-deps/facets/Admin.sol

34:         require(msg.sender == pendingAdmin, "n4"); // Only proposed by current admin address can claim the admin rights


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Admin.sol#L34-L34) 


```solidity

File: contracts/bridge/L2StandardERC20.sol

120:         require(msg.sender == UpgradeableBeacon(beaconAddress).owner(), "tt");


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2StandardERC20.sol#L120-L120) 


</details>


### [NC&#x2011;60] Empty `receive()`/`payable fallback()` function does not authorize requests 
If the intention is for the Ether to be used, the function should call another function, otherwise it should revert (e.g. `require(msg.sender == address(weth))`). Having no access control on the function means that someone may send Ether to the contract, and have no way to get anything back out, which is a loss of funds. If the concern is having to spend a small amount of gas to check the sender against an immutable address, the code should at least have a function to rescue unused Ether.


*There are 4 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/DefaultAccount.sol

227:     receive() external payable {
228:         // If the contract is called directly, behave like an EOA
229:     }


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/DefaultAccount.sol#L227-L229) 


```solidity

File: contracts/EmptyContract.sol

11:     fallback() external payable {}
12: 

13:     receive() external payable {}
14: }


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/EmptyContract.sol#L11-L12) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/EmptyContract.sol#L13-L14)


```solidity

File: contracts/governance/Governance.sol

262:     receive() external payable {}
263: }


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/Governance.sol#L262-L263) 


</details>


### [NC&#x2011;61] State variables should have `Natspec` comments 
Consider adding some `Natspec` comments on critical state variables to explain what they are supposed to do: this will help for future code reviews.


*There are 10 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/AccountCodeStorage.sol

//@audit EMPTY_STRING_KECCAK need comments
23:     bytes32 constant EMPTY_STRING_KECCAK = 0xc5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/AccountCodeStorage.sol#L23-L23) 


```solidity

File: contracts/NonceHolder.sol

//@audit DEPLOY_NONCE_MULTIPLIER need comments
28:     uint256 private constant DEPLOY_NONCE_MULTIPLIER = 2 ** 128;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/NonceHolder.sol#L28-L28) 


```solidity

File: contracts/libraries/TransactionHelper.sol

//@audit EIP712_TRANSACTION_TYPE_HASH need comments
84:     bytes32 constant EIP712_TRANSACTION_TYPE_HASH =


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L84-L84) 


```solidity

File: contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol

//@audit s need comments
12:     ZkSyncStateTransitionStorage internal s;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L12-L12) 


```solidity

File: contracts/common/ReentrancyGuard.sol

//@audit _NOT_ENTERED need comments
38:     uint256 private constant _NOT_ENTERED = 1;

//@audit _ENTERED need comments
39:     uint256 private constant _ENTERED = 2;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/ReentrancyGuard.sol#L38-L38) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/ReentrancyGuard.sol#L39-L39)


```solidity

File: contracts/vendor/AddressAliasHelper.sol

//@audit offset need comments
22:     uint160 constant offset = uint160(0x1111000000000000000000000000000000001111);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/vendor/AddressAliasHelper.sol#L22-L22) 


```solidity

File: contracts/bridge/L2SharedBridge.sol

//@audit l1LegacyBridge need comments
37:     address private l1LegacyBridge;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L37-L37) 


```solidity

File: contracts/bridge/L2StandardERC20.sol

//@audit availableGetters need comments
26:     ERC20Getters private availableGetters;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2StandardERC20.sol#L26-L26) 


```solidity

File: contracts/vendor/AddressAliasHelper.sol

//@audit offset need comments
22:     uint160 constant offset = uint160(0x1111000000000000000000000000000000001111);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/vendor/AddressAliasHelper.sol#L22-L22) 


</details>


### [NC&#x2011;62] Contracts should have full test coverage 
While 100% code coverage does not guarantee that there are no bugs, it often will catch easy-to-find bugs, and will ensure that there are fewer regressions when the code invariably has to be modified. Furthermore, in order to get full coverage, code authors will often have to re-organize their code so that it is more modular, so that each component can be tested separately, which reduces interdependencies between modules and layers, and makes for code that is easier to reason about and audit.


*There are 3 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/AccountCodeStorage.sol

@audit Multiple files
1: 


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/AccountCodeStorage.sol#L1-L1) 


```solidity

File: contracts/bridge/L1ERC20Bridge.sol

@audit Multiple files
1: 


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1ERC20Bridge.sol#L1-L1) 


```solidity

File: contracts/bridge/L2SharedBridge.sol

@audit Multiple files
1: 


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L1-L1) 


</details>


### [NC&#x2011;63] [NatSpec] Natspec `@title` is missing from `contract` 



*There are 85 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/AccountCodeStorage.sol

09: /**
10:  * @author Matter Labs
11:  * @custom:security-contact security@matterlabs.dev
12:  * @notice The storage of this contract serves as a mapping for the code hashes of the 32-byte account addresses.
13:  * @dev Code hash is not strictly a hash, it's a structure where the first byte denotes the version of the hash,
14:  * the second byte denotes whether the contract is constructed, and the next two bytes denote the length in 32-byte words.
15:  * And then the next 28 bytes are the truncated hash.
16:  * @dev In this version of zkSync, the first byte of the hash MUST be 1.
17:  * @dev The length of each bytecode MUST be odd.  It's internal code format requirements, due to padding of SHA256 function.
18:  * @dev It is also assumed that all the bytecode hashes are *known*, i.e. the full bytecodes
19:  * were published on L1 as calldata. This contract trusts the ContractDeployer and the KnownCodesStorage
20:  * system contracts to enforce the invariants mentioned above.
21:  */


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/AccountCodeStorage.sol#L9-L21) 


```solidity

File: contracts/BootloaderUtilities.sol

10: /**
11:  * @author Matter Labs
12:  * @custom:security-contact security@matterlabs.dev
13:  * @notice A contract that provides some utility methods for the bootloader
14:  * that is very hard to write in Yul.
15:  */


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L10-L15) 


```solidity

File: contracts/ComplexUpgrader.sol

08: /**
09:  * @author Matter Labs
10:  * @custom:security-contact security@matterlabs.dev
11:  * @notice Upgrader which should be used to perform complex multistep upgrades on L2. In case some custom logic for an upgrade is needed
12:  * this logic should be deployed into the user space and then this contract will delegatecall to the deployed contract.
13:  */


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ComplexUpgrader.sol#L8-L13) 


```solidity

File: contracts/Compressor.sol

12: /**
13:  * @author Matter Labs
14:  * @custom:security-contact security@matterlabs.dev
15:  * @notice Contract with code pertaining to compression for zkEVM; at the moment this is used for bytecode compression
16:  * and state diff compression validation.
17:  * @dev Every deployed bytecode/published state diffs in zkEVM should be publicly restorable from the L1 data availability.
18:  * For this reason, the user may request the sequencer to publish the original bytecode and mark it as known.
19:  * Or the user may compress the bytecode and publish it instead (fewer data onchain!). At the end of every L1 Batch
20:  * we publish pubdata, part of which contains the state diffs that occurred within the batch.
21:  */


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Compressor.sol#L12-L21) 


```solidity

File: contracts/ContractDeployer.sol

14: /**
15:  * @author Matter Labs
16:  * @custom:security-contact security@matterlabs.dev
17:  * @notice System smart contract that is responsible for deploying other smart contracts on zkSync.
18:  * @dev The contract is responsible for generating the address of the deployed smart contract,
19:  * incrementing the deployment nonce and making sure that the constructor is never called twice in a contract.
20:  * Note, contracts with bytecode that have already been published to L1 once
21:  * do not need to be published anymore.
22:  */


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L14-L22) 


```solidity

File: contracts/DefaultAccount.sol

11: /**
12:  * @author Matter Labs
13:  * @custom:security-contact security@matterlabs.dev
14:  * @notice The default implementation of account.
15:  * @dev The bytecode of the contract is set by default for all addresses for which no other bytecodes are deployed.
16:  * @notice If the caller is not a bootloader always returns empty data on call, just like EOA does.
17:  * @notice If it is delegate called always returns empty data, just like EOA does.
18:  */


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/DefaultAccount.sol#L11-L18) 


```solidity

File: contracts/EmptyContract.sol

5: /**
6:  * @author Matter Labs
7:  * @custom:security-contact security@matterlabs.dev
8:  * @notice The "empty" contract that is put into some system contracts by default.
9:  */


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/EmptyContract.sol#L5-L9) 


```solidity

File: contracts/ImmutableSimulator.sol

08: /**
09:  * @author Matter Labs
10:  * @custom:security-contact security@matterlabs.dev
11:  * @notice System smart contract that simulates the behavior of immutable variables in Solidity.
12:  * @dev The contract stores the immutable variables created during deployment by other contracts on his storage.
13:  * @dev This simulator is needed so that smart contracts with the same Solidity code but different
14:  * constructor parameters have the same bytecode.
15:  * @dev The users are not expected to call this contract directly, only indirectly via the compiler simulations
16:  * for the immutable variables in Solidity.
17:  */


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ImmutableSimulator.sol#L8-L17) 


```solidity

File: contracts/KnownCodesStorage.sol

10: /**
11:  * @author Matter Labs
12:  * @custom:security-contact security@matterlabs.dev
13:  * @notice The storage of this contract will basically serve as a mapping for the known code hashes.
14:  * @dev Code hash is not strictly a hash, it's a structure where the first byte denotes the version of the hash,
15:  * the second byte denotes whether the contract is constructed, and the next two bytes denote the length in 32-byte words.
16:  * And then the next 28 bytes is the truncated hash.
17:  */


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/KnownCodesStorage.sol#L10-L17) 


```solidity

File: contracts/L1Messenger.sol

12: /**
13:  * @author Matter Labs
14:  * @custom:security-contact security@matterlabs.dev
15:  * @notice Smart contract for sending arbitrary length messages to L1
16:  * @dev by default ZkSync can send fixed length messages on L1.
17:  * A fixed length message has 4 parameters `senderAddress` `isService`, `key`, `value`,
18:  * the first one is taken from the context, the other three are chosen by the sender.
19:  * @dev To send a variable length message we use this trick:
20:  * - This system contract accepts a arbitrary length message and sends a fixed length message with
21:  * parameters `senderAddress == this`, `marker == true`, `key == msg.sender`, `value == keccak256(message)`.
22:  * - The contract on L1 accepts all sent messages and if the message came from this system contract
23:  * it requires that the preimage of `value` be provided.
24:  */


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L12-L24) 


```solidity

File: contracts/L2BaseToken.sol

10: /**
11:  * @author Matter Labs
12:  * @custom:security-contact security@matterlabs.dev
13:  * @notice Native ETH contract.
14:  * @dev It does NOT provide interfaces for personal interaction with tokens like `transfer`, `approve`, and `transferFrom`.
15:  * Instead, this contract is used by the bootloader and `MsgValueSimulator`/`ContractDeployer` system contracts
16:  * to perform the balance changes while simulating the `msg.value` Ethereum behavior.
17:  */


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L2BaseToken.sol#L10-L17) 


```solidity

File: contracts/MsgValueSimulator.sol

11: /**
12:  * @author Matter Labs
13:  * @custom:security-contact security@matterlabs.dev
14:  * @notice The contract responsible for simulating transactions with `msg.value` inside zkEVM.
15:  * @dev It accepts value and whether the call should be system in the first extraAbi param and
16:  * the address to call in the second extraAbi param, transfers the funds and uses `mimicCall` to continue the
17:  * call with the same msg.sender.
18:  */


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/MsgValueSimulator.sol#L11-L18) 


```solidity

File: contracts/NonceHolder.sol

10: /**
11:  * @author Matter Labs
12:  * @custom:security-contact security@matterlabs.dev
13:  * @notice A contract used for managing nonces for accounts. Together with bootloader,
14:  * this contract ensures that the pair (sender, nonce) is always unique, ensuring
15:  * unique transaction hashes.
16:  * @dev The account allows for both ascending growth in nonces and mapping nonces to specific
17:  * stored values in them.
18:  * The users can mark a range of nonces by increasing the `minNonce`. This way all the nonces
19:  * less than `minNonce` will become used. The other way to mark a certain 256-bit key as nonce is to set
20:  * some value under it in this contract.
21:  * @dev Apart from transaction nonces, this contract also stores the deployment nonce for accounts, that
22:  * will be used for address derivation using CREATE. For the economy of space, this nonce is stored tightly
23:  * packed with the `minNonce`.
24:  * @dev The behavior of some of the methods depends on the nonce ordering of the account. Nonce ordering is a mere suggestion and all the checks that are present
25:  * here serve more as a help to users to prevent from doing mistakes, rather than any invariants.
26:  */


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/NonceHolder.sol#L10-L26) 


```solidity

File: contracts/PubdataChunkPublisher.sol

11: /**
12:  * @author Matter Labs
13:  * @custom:security-contact security@matterlabs.dev
14:  * @notice Smart contract for chunking pubdata into the appropriate size for EIP-4844 blobs.
15:  */


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/PubdataChunkPublisher.sol#L11-L15) 


```solidity

File: contracts/SystemContext.sol

11: /**
12:  * @author Matter Labs
13:  * @custom:security-contact security@matterlabs.dev
14:  * @notice Contract that stores some of the context variables, that may be either
15:  * block-scoped, tx-scoped or system-wide.
16:  */


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L11-L16) 


```solidity

File: contracts/libraries/EfficientCall.sol

09: /**
10:  * @author Matter Labs
11:  * @custom:security-contact security@matterlabs.dev
12:  * @notice This library is used to perform ultra-efficient calls using zkEVM-specific features.
13:  * @dev EVM calls always accept a memory slice as input and return a memory slice as output.
14:  * Therefore, even if the user has a ready-made calldata slice, they still need to copy it to memory
15:  * before calling. This is especially inefficient for large inputs (proxies, multi-calls, etc.).
16:  * In turn, zkEVM operates over a fat pointer, which is a set of (memory page, offset, start, length) in the memory/calldata/returndata.
17:  * This allows forwarding the calldata slice as is, without copying it to memory.
18:  * @dev Fat pointer is not just an integer, it is an extended data type supported on the VM level.
19:  * zkEVM creates the wellformed fat pointers for all the calldata/returndata regions, later
20:  * the contract may manipulate the already created fat pointers to forward a slice of the data, but not
21:  * to create new fat pointers!
22:  * @dev The allowed operation on fat pointers are:
23:  * 1. `ptr.add` - Transforms `ptr.offset` into `ptr.offset + u32(_value)`. If overflow happens then it panics.
24:  * 2. `ptr.sub` - Transforms `ptr.offset` into `ptr.offset - u32(_value)`. If underflow happens then it panics.
25:  * 3. `ptr.pack` - Do the concatenation between the lowest 128 bits of the pointer itself and the highest 128 bits of `_value`. It is typically used to prepare the ABI for external calls.
26:  * 4. `ptr.shrink` - Transforms `ptr.length` into `ptr.length - u32(_shrink)`. If underflow happens then it panics.
27:  * @dev The call opcodes accept the fat pointer and change it to its canonical form before passing it to the child call
28:  * 1. `ptr.start` is transformed into `ptr.offset + ptr.start`
29:  * 2. `ptr.length` is transformed into `ptr.length - ptr.offset`
30:  * 3. `ptr.offset` is transformed into `0`
31:  */


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L9-L31) 


```solidity

File: contracts/libraries/RLPEncoder.sol

5: /**
6:  * @author Matter Labs
7:  * @custom:security-contact security@matterlabs.dev
8:  * @notice This library provides RLP encoding functionality.
9:  */


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/RLPEncoder.sol#L5-L9) 


```solidity

File: contracts/libraries/SystemContractHelper.sol

32: /**
33:  * @author Matter Labs
34:  * @custom:security-contact security@matterlabs.dev
35:  * @notice Library used for accessing zkEVM-specific opcodes, needed for the development
36:  * of system contracts.
37:  * @dev While this library will be eventually available to public, some of the provided
38:  * methods won't work for non-system contracts and also breaking changes at short notice are possilbe.
39:  * We do not recommend this library for external use.
40:  */


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L32-L40) 


```solidity

File: contracts/libraries/SystemContractsCaller.sol

62: /**
63:  * @author Matter Labs
64:  * @custom:security-contact security@matterlabs.dev
65:  * @notice A library that allows calling contracts with the `isSystem` flag.
66:  * @dev It is needed to call ContractDeployer and NonceHolder.
67:  */


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractsCaller.sol#L62-L67) 


```solidity

File: contracts/libraries/TransactionHelper.sol

73: /**
74:  * @author Matter Labs
75:  * @custom:security-contact security@matterlabs.dev
76:  * @notice Library is used to help custom accounts to work with common methods for the Transaction type.
77:  */


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L73-L77) 


```solidity

File: contracts/libraries/UnsafeBytesCalldata.sol

05: /**
06:  * @author Matter Labs
07:  * @custom:security-contact security@matterlabs.dev
08:  * @dev The library provides a set of functions that help read data from calldata bytes.
09:  * @dev Each of the functions accepts the `bytes calldata` and the offset where data should be read and returns a value of a certain type.
10:  *
11:  * @dev WARNING!
12:  * 1) Functions don't check the length of the bytes array, so it can go out of bounds.
13:  * The user of the library must check for bytes length before using any functions from the library!
14:  *
15:  * 2) Read variables are not cleaned up - https://docs.soliditylang.org/en/v0.8.16/internals/variable_cleanup.html.
16:  * Using data in inline assembly can lead to unexpected behavior!
17:  */


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/UnsafeBytesCalldata.sol#L5-L17) 


```solidity

File: contracts/libraries/Utils.sol

06: /**
07:  * @author Matter Labs
08:  * @custom:security-contact security@matterlabs.dev
09:  * @dev Common utilities used in zkSync system contracts
10:  */


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L6-L10) 


```solidity

File: contracts/interfaces/IAccount.sol

9: interface IAccount {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IAccount.sol#L9-L9) 


```solidity

File: contracts/interfaces/IAccountCodeStorage.sol

5: interface IAccountCodeStorage {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IAccountCodeStorage.sol#L5-L5) 


```solidity

File: contracts/interfaces/IBaseToken.sol

5: interface IBaseToken {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IBaseToken.sol#L5-L5) 


```solidity

File: contracts/interfaces/IBootloaderUtilities.sol

7: interface IBootloaderUtilities {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IBootloaderUtilities.sol#L7-L7) 


```solidity

File: contracts/interfaces/IComplexUpgrader.sol

5: /**
6:  * @author Matter Labs
7:  * @custom:security-contact security@matterlabs.dev
8:  * @notice The interface for the ComplexUpgrader contract.
9:  */


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IComplexUpgrader.sol#L5-L9) 


```solidity

File: contracts/interfaces/ICompressor.sol

12: /**
13:  * @author Matter Labs
14:  * @custom:security-contact security@matterlabs.dev
15:  * @notice The interface for the Compressor contract, responsible for verifying the correctness of
16:  * the compression of the state diffs and bytecodes.
17:  */


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ICompressor.sol#L12-L17) 


```solidity

File: contracts/interfaces/IContractDeployer.sol

5: interface IContractDeployer {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IContractDeployer.sol#L5-L5) 


```solidity

File: contracts/interfaces/IImmutableSimulator.sol

10: interface IImmutableSimulator {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IImmutableSimulator.sol#L10-L10) 


```solidity

File: contracts/interfaces/IKnownCodesStorage.sol

05: /**
06:  * @author Matter Labs
07:  * @custom:security-contact security@matterlabs.dev
08:  * @notice The interface for the KnownCodesStorage contract, which is responsible
09:  * for storing the hashes of the bytecodes that have been published to the network.
10:  */


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IKnownCodesStorage.sol#L5-L10) 


```solidity

File: contracts/interfaces/IL1Messenger.sol

35: /**
36:  * @author Matter Labs
37:  * @custom:security-contact security@matterlabs.dev
38:  * @notice The interface of the L1 Messenger contract, responsible for sending messages to L1.
39:  */


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IL1Messenger.sol#L35-L39) 


```solidity

File: contracts/interfaces/IL2StandardToken.sol

5: interface IL2StandardToken {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IL2StandardToken.sol#L5-L5) 


```solidity

File: contracts/interfaces/IMailbox.sol

5: interface IMailbox {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IMailbox.sol#L5-L5) 


```solidity

File: contracts/interfaces/INonceHolder.sol

05: /**
06:  * @author Matter Labs
07:  * @dev Interface of the nonce holder contract -- a contract used by the system to ensure
08:  * that there is always a unique identifier for a transaction with a particular account (we call it nonce).
09:  * In other words, the pair of (address, nonce) should always be unique.
10:  * @dev Custom accounts should use methods of this contract to store nonces or other possible unique identifiers
11:  * for the transaction.
12:  */


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/INonceHolder.sol#L5-L12) 


```solidity

File: contracts/interfaces/IPaymaster.sol

14: interface IPaymaster {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IPaymaster.sol#L14-L14) 


```solidity

File: contracts/interfaces/IPaymasterFlow.sol

05: /**
06:  * @author Matter Labs
07:  * @dev The interface that is used for encoding/decoding of
08:  * different types of paymaster flows.
09:  * @notice This is NOT an interface to be implementated
10:  * by contracts. It is just used for encoding.
11:  */


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IPaymasterFlow.sol#L5-L11) 


```solidity

File: contracts/interfaces/IPubdataChunkPublisher.sol

4: /**
5:  * @author Matter Labs
6:  * @custom:security-contact security@matterlabs.dev
7:  * @notice Interface for contract responsible chunking pubdata into the appropriate size for EIP-4844 blobs.
8:  */


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IPubdataChunkPublisher.sol#L4-L8) 


```solidity

File: contracts/interfaces/ISystemContext.sol

05: /**
06:  * @author Matter Labs
07:  * @custom:security-contact security@matterlabs.dev
08:  * @notice Contract that stores some of the context variables, that may be either
09:  * block-scoped, tx-scoped or system-wide.
10:  */


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ISystemContext.sol#L5-L10) 


```solidity

File: contracts/interfaces/ISystemContextDeprecated.sol

5: /**
6:  * @author Matter Labs
7:  * @custom:security-contact security@matterlabs.dev
8:  * @notice The interface with deprecated functions of the SystemContext contract. It is aimed for backward compatibility.
9:  */


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ISystemContextDeprecated.sol#L5-L9) 


```solidity

File: contracts/interfaces/ISystemContract.sol

08: /**
09:  * @author Matter Labs
10:  * @custom:security-contact security@matterlabs.dev
11:  * @notice An abstract contract that is used to reuse modifiers across the system contracts.
12:  * @dev Solidity does not allow exporting modifiers via libraries, so
13:  * the only way to do reuse modifiers is to have a base contract
14:  * @dev Never add storage variables into this contract as some
15:  * system contracts rely on this abstract contract as on interface!
16:  */


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ISystemContract.sol#L8-L16) 


```solidity

File: contracts/bridge/L1ERC20Bridge.sol

14: /// @author Matter Labs
15: /// @custom:security-contact security@matterlabs.dev
16: /// @notice Smart contract that allows depositing ERC20 tokens from Ethereum to hyperchains
17: /// @dev It is a legacy bridge from zkSync Era, that was deprecated in favour of shared bridge.
18: /// It is needed for backward compatibility with already integrated projects.
19: contract L1ERC20Bridge is IL1ERC20Bridge, ReentrancyGuard {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1ERC20Bridge.sol#L14-L19) 


```solidity

File: contracts/bridge/L1SharedBridge.sol

26: /// @author Matter Labs
27: /// @custom:security-contact security@matterlabs.dev
28: /// @dev Bridges assets between L1 and hyperchains, supporting both ETH and ERC20 tokens.
29: /// @dev Designed for use with a proxy for upgradability.
30: contract L1SharedBridge is IL1SharedBridge, ReentrancyGuard, Initializable, Ownable2Step {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L26-L30) 


```solidity

File: contracts/bridgehub/Bridgehub.sol

16: contract Bridgehub is IBridgehub, ReentrancyGuard, Ownable2Step {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L16-L16) 


```solidity

File: contracts/governance/Governance.sol

08: /// @author Matter Labs
09: /// @custom:security-contact security@matterlabs.dev
10: /// @dev Contract design is inspired by OpenZeppelin TimelockController and in-house Diamond Proxy upgrade mechanism.
11: /// @notice This contract manages operations (calls with preconditions) for governance tasks.
12: /// The contract allows for operations to be scheduled, executed, and canceled with
13: /// appropriate permissions and delays. It is used for managing and coordinating upgrades
14: /// and changes in all zkSync hyperchain governed contracts.
15: ///
16: /// Operations can be proposed as either fully transparent upgrades with on-chain data,
17: /// or "shadow" upgrades where upgrade data is not published on-chain before execution. Proposed operations
18: /// are subject to a delay before they can be executed, but they can be executed instantly
19: /// with the security councilbï¿½s permission.
20: contract Governance is IGovernance, Ownable2Step {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/Governance.sol#L8-L20) 


```solidity

File: contracts/state-transition/ValidatorTimelock.sol

11: /// @author Matter Labs
12: /// @custom:security-contact security@matterlabs.dev
13: /// @notice Intermediate smart contract between the validator EOA account and the hyperchains state transition diamond smart contract.
14: /// @dev The primary purpose of this contract is to provide a trustless means of delaying batch execution without
15: /// modifying the main hyperchain diamond contract. As such, even if this contract is compromised, it will not impact the main
16: /// contract.
17: /// @dev zkSync actively monitors the chain activity and reacts to any suspicious activity by freezing the chain.
18: /// This allows time for investigation and mitigation before resuming normal operations.
19: /// @dev The contract overloads all of the 4 methods, that are used in state transition. When the batch is committed,
20: /// the timestamp is stored for it. Later, when the owner calls the batch execution, the contract checks that batch
21: /// was committed not earlier than X time ago.
22: contract ValidatorTimelock is IExecutor, Ownable2Step {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L11-L22) 


```solidity

File: contracts/state-transition/chain-deps/DiamondInit.sol

14: /// @author Matter Labs
15: /// @dev The contract is used only once to initialize the diamond proxy.
16: /// @dev The deployment process takes care of this contract's initialization.
17: contract DiamondInit is ZkSyncStateTransitionBase, IDiamondInit {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/DiamondInit.sol#L14-L17) 


```solidity

File: contracts/upgrades/BaseZkSyncUpgrade.sol

41: /// @author Matter Labs
42: /// @custom:security-contact security@matterlabs.dev
43: /// @notice Interface to which all the upgrade implementations should adhere
44: abstract contract BaseZkSyncUpgrade is ZkSyncStateTransitionBase {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgrade.sol#L41-L44) 


```solidity

File: contracts/upgrades/BaseZkSyncUpgradeGenesis.sol

14: /// @author Matter Labs
15: /// @custom:security-contact security@matterlabs.dev
16: /// @notice Interface to which all the upgrade implementations should adhere
17: abstract contract BaseZkSyncUpgradeGenesis is BaseZkSyncUpgrade {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L14-L17) 


```solidity

File: contracts/upgrades/DefaultUpgrade.sol

08: /// @author Matter Labs
09: /// @custom:security-contact security@matterlabs.dev
10: contract DefaultUpgrade is BaseZkSyncUpgrade {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/DefaultUpgrade.sol#L8-L10) 


```solidity

File: contracts/upgrades/GenesisUpgrade.sol

09: /// @author Matter Labs
10: /// @custom:security-contact security@matterlabs.dev
11: contract GenesisUpgrade is BaseZkSyncUpgradeGenesis {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/GenesisUpgrade.sol#L9-L11) 


```solidity

File: contracts/common/libraries/L2ContractHelper.sol

5: /**
6:  * @author Matter Labs
7:  * @custom:security-contact security@matterlabs.dev
8:  * @notice Helper library for working with L2 contracts on L1.
9:  */


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/L2ContractHelper.sol#L5-L9) 


```solidity

File: contracts/common/libraries/UncheckedMath.sol

5: /**
6:  * @author Matter Labs
7:  * @custom:security-contact security@matterlabs.dev
8:  * @notice The library for unchecked math.
9:  */


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/UncheckedMath.sol#L5-L9) 


```solidity

File: contracts/common/libraries/UnsafeBytes.sol

05: /**
06:  * @author Matter Labs
07:  * @custom:security-contact security@matterlabs.dev
08:  * @dev The library provides a set of functions that help read data from an "abi.encodePacked" byte array.
09:  * @dev Each of the functions accepts the `bytes memory` and the offset where data should be read and returns a value of a certain type.
10:  *
11:  * @dev WARNING!
12:  * 1) Functions don't check the length of the bytes array, so it can go out of bounds.
13:  * The user of the library must check for bytes length before using any functions from the library!
14:  *
15:  * 2) Read variables are not cleaned up - https://docs.soliditylang.org/en/v0.8.16/internals/variable_cleanup.html.
16:  * Using data in inline assembly can lead to unexpected behavior!
17:  */


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/UnsafeBytes.sol#L5-L17) 


```solidity

File: contracts/state-transition/libraries/Diamond.sol

08: /// @author Matter Labs
09: /// @custom:security-contact security@matterlabs.dev
10: /// @notice The helper library for managing the EIP-2535 diamond proxy.
11: library Diamond {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L8-L11) 


```solidity

File: contracts/state-transition/libraries/LibMap.sol

4: /// @notice Library for storage of packed unsigned integers.
5: /// @author Matter Labs
6: /// @dev This library is an adaptation of the corresponding Solady library (https://github.com/vectorized/solady/blob/main/src/utils/LibMap.sol)
7: /// @custom:security-contact security@matterlabs.dev
8: library LibMap {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/LibMap.sol#L4-L8) 


```solidity

File: contracts/state-transition/libraries/Merkle.sol

7: /// @author Matter Labs
8: /// @custom:security-contact security@matterlabs.dev
9: library Merkle {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Merkle.sol#L7-L9) 


```solidity

File: contracts/state-transition/libraries/PriorityQueue.sol

16: /// @author Matter Labs
17: /// @custom:security-contact security@matterlabs.dev
18: /// @dev The library provides the API to interact with the priority queue container
19: /// @dev Order of processing operations from queue - FIFO (Fist in - first out)
20: library PriorityQueue {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/PriorityQueue.sol#L16-L20) 


```solidity

File: contracts/bridge/interfaces/IL2Bridge.sol

5: /// @author Matter Labs
6: interface IL2Bridge {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL2Bridge.sol#L5-L6) 


```solidity

File: contracts/bridge/interfaces/IWETH9.sol

4: interface IWETH9 {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IWETH9.sol#L4-L4) 


```solidity

File: contracts/bridgehub/IBridgehub.sol

42: interface IBridgehub {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L42-L42) 


```solidity

File: contracts/common/interfaces/IL2ContractDeployer.sol

5: /**
6:  * @author Matter Labs
7:  * @notice System smart contract that is responsible for deploying other smart contracts on a zkSync hyperchain.
8:  */


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/interfaces/IL2ContractDeployer.sol#L5-L8) 


```solidity

File: contracts/state-transition/IStateTransitionManager.sol

26: interface IStateTransitionManager {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/IStateTransitionManager.sol#L26-L26) 


```solidity

File: contracts/state-transition/chain-interfaces/IDiamondInit.sol

61: interface IDiamondInit {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IDiamondInit.sol#L61-L61) 


```solidity

File: contracts/state-transition/chain-interfaces/ILegacyGetters.sol

07: /// @author Matter Labs
08: /// @dev This interface contains getters for the zkSync contract that should not be used,
09: /// but still are kept for backward compatibility.
10: /// @custom:security-contact security@matterlabs.dev
11: interface ILegacyGetters is IZkSyncStateTransitionBase {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/ILegacyGetters.sol#L7-L11) 


```solidity

File: contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol

15: interface IZkSyncStateTransition is IAdmin, IExecutor, IGetters, IMailbox {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol#L15-L15) 


```solidity

File: contracts/state-transition/l2-deps/ISystemContext.sol

4: interface ISystemContext {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/l2-deps/ISystemContext.sol#L4-L4) 


```solidity

File: contracts/upgrades/IDefaultUpgrade.sol

7: interface IDefaultUpgrade {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/IDefaultUpgrade.sol#L7-L7) 


```solidity

File: contracts/common/ReentrancyGuard.sol

05: /**
06:  * @custom:security-contact security@matterlabs.dev
07:  * @dev Contract module that helps prevent reentrant calls to a function.
08:  *
09:  * Inheriting from `ReentrancyGuard` will make the {nonReentrant} modifier
10:  * available, which can be applied to functions to make sure there are no nested
11:  * (reentrant) calls to them.
12:  *
13:  * Note that because there is a single `nonReentrant` guard, functions marked as
14:  * `nonReentrant` may not call one another. This can be worked around by making
15:  * those functions `private`, and then adding `external` `nonReentrant` entry
16:  * points to them.
17:  *
18:  * TIP: If you would like to learn more about reentrancy and alternative ways
19:  * to protect against it, check out our blog post
20:  * https://blog.openzeppelin.com/reentrancy-after-istanbul/[Reentrancy After Istanbul].
21:  *
22:  * _Since v2.5.0:_ this module is now much more gas efficient, given net gas
23:  * metering changes introduced in the Istanbul hardfork.
24:  */


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/ReentrancyGuard.sol#L5-L24) 


```solidity

File: contracts/vendor/AddressAliasHelper.sol

21: library AddressAliasHelper {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/vendor/AddressAliasHelper.sol#L21-L21) 


```solidity

File: contracts/bridge/L2SharedBridge.sol

19: /// @author Matter Labs
20: /// @custom:security-contact security@matterlabs.dev
21: /// @notice The "default" bridge implementation for the ERC20 tokens. Note, that it does not
22: /// support any custom token logic, i.e. rebase tokens' functionality is not supported.
23: contract L2SharedBridge is IL2SharedBridge, Initializable {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L19-L23) 


```solidity

File: contracts/bridge/L2StandardERC20.sol

11: /// @author Matter Labs
12: /// @custom:security-contact security@matterlabs.dev
13: /// @notice The ERC20 token implementation, that is used in the "default" ERC20 bridge. Note, that it does not
14: /// support any custom token logic, i.e. rebase tokens' functionality is not supported.
15: contract L2StandardERC20 is ERC20PermitUpgradeable, IL2StandardToken, ERC1967Upgrade {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2StandardERC20.sol#L11-L15) 


```solidity

File: contracts/bridge/interfaces/IL1ERC20Bridge.sol

5: /// @author Matter Labs
6: // note we use the IL1ERC20Bridge only to send L1<>L2 messages,


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL1ERC20Bridge.sol#L5-L6) 


```solidity

File: contracts/bridge/interfaces/IL2SharedBridge.sol

5: /// @author Matter Labs
6: interface IL2SharedBridge {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL2SharedBridge.sol#L5-L6) 


```solidity

File: contracts/bridge/interfaces/IL2StandardToken.sol

5: interface IL2StandardToken {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL2StandardToken.sol#L5-L5) 


```solidity

File: contracts/interfaces/IPaymaster.sol

14: interface IPaymaster {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/interfaces/IPaymaster.sol#L14-L14) 


```solidity

File: contracts/interfaces/IPaymasterFlow.sol

05: /**
06:  * @author Matter Labs
07:  * @custom:security-contact security@matterlabs.dev
08:  * @dev The interface that is used for encoding/decoding of
09:  * different types of paymaster flows.
10:  * @notice This is NOT an interface to be implementated
11:  * by contracts. It is just used for encoding.
12:  */


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/interfaces/IPaymasterFlow.sol#L5-L12) 


```solidity

File: contracts/vendor/AddressAliasHelper.sol

21: library AddressAliasHelper {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/vendor/AddressAliasHelper.sol#L21-L21) 


```solidity

File: contracts/ForceDeployUpgrader.sol

07: /// @custom:security-contact security@matterlabs.dev
08: /// @notice The contract that calls force deployment during the L2 system contract upgrade.
09: /// @notice It is supposed to be used as an implementation of the ComplexUpgrader.
10: contract ForceDeployUpgrader {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/ForceDeployUpgrader.sol#L7-L10) 


```solidity

File: contracts/L2ContractHelper.sol

05: /**
06:  * @author Matter Labs
07:  * @custom:security-contact security@matterlabs.dev
08:  * @notice Smart contract for sending arbitrary length messages to L1
09:  * @dev by default ZkSync can send fixed-length messages on L1.
10:  * A fixed length message has 4 parameters `senderAddress`, `isService`, `key`, `value`,
11:  * the first one is taken from the context, the other three are chosen by the sender.
12:  * @dev To send a variable-length message we use this trick:
13:  * - This system contract accepts an arbitrary length message and sends a fixed length message with
14:  * parameters `senderAddress == this`, `isService == true`, `key == msg.sender`, `value == keccak256(message)`.
15:  * - The contract on L1 accepts all sent messages and if the message came from this system contract
16:  * it requires that the preimage of `value` be provided.
17:  */

25: /**
26:  * @author Matter Labs
27:  * @custom:security-contact security@matterlabs.dev
28:  * @notice Interface for the contract that is used to deploy contracts on L2.
29:  */

56: /**
57:  * @author Matter Labs
58:  * @custom:security-contact security@matterlabs.dev
59:  * @notice Interface for the contract that is used to simulate ETH on L2.
60:  */

78: /**
79:  * @author Matter Labs
80:  * @custom:security-contact security@matterlabs.dev
81:  * @notice Helper library for working with L2 contracts on L1.
82:  */


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/L2ContractHelper.sol#L5-L17) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/L2ContractHelper.sol#L25-L29), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/L2ContractHelper.sol#L56-L60), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/L2ContractHelper.sol#L78-L82)


```solidity

File: contracts/SystemContractsCaller.sol

26: library Utils {

34: /// @notice The library contains the functions to make system calls.
35: /// @dev A more detailed description of the library and its methods can be found in the `system-contracts` repo.
36: library SystemContractsCaller {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/SystemContractsCaller.sol#L26-L26) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/SystemContractsCaller.sol#L34-L36)


</details>


### [NC&#x2011;64] Open TODOs 
TODOs may signal that a feature is missing or not ready for audit, consider resolving the issue and removing the TODO comment


*There are 3 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/state-transition/chain-deps/facets/Mailbox.sol

338:                 layer2Tip: uint192(0) // TODO: Restore after fee modeling will be stable. (SMA-1230)


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L338-L338) 


```solidity

File: contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol

16:     // KL todo: need this in the server for now


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol#L16-L16) 


```solidity

File: contracts/common/Config.sol

21: // TODO: change constant to the real root hash of empty Merkle tree (SMA-184)


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/Config.sol#L21-L21) 


</details>


### [NC&#x2011;65] Top level pragma declarations should be separated by two blank lines 



*There are 76 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/AccountCodeStorage.sol

3: pragma solidity 0.8.20;
4: 
5: import "./interfaces/IAccountCodeStorage.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/AccountCodeStorage.sol#L3-L5) 


```solidity

File: contracts/BootloaderUtilities.sol

3: pragma solidity 0.8.20;
4: 
5: import {IBootloaderUtilities} from "./interfaces/IBootloaderUtilities.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L3-L5) 


```solidity

File: contracts/ComplexUpgrader.sol

3: pragma solidity 0.8.20;
4: 
5: import {IComplexUpgrader} from "./interfaces/IComplexUpgrader.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ComplexUpgrader.sol#L3-L5) 


```solidity

File: contracts/Compressor.sol

3: pragma solidity 0.8.20;
4: 
5: import {ICompressor, OPERATION_BITMASK, LENGTH_BITS_OFFSET, MAX_ENUMERATION_INDEX_SIZE} from "./interfaces/ICompressor.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Compressor.sol#L3-L5) 


```solidity

File: contracts/Constants.sol

3: pragma solidity 0.8.20;
4: 
5: import {IAccountCodeStorage} from "./interfaces/IAccountCodeStorage.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Constants.sol#L3-L5) 


```solidity

File: contracts/ContractDeployer.sol

3: pragma solidity 0.8.20;
4: 
5: import {ImmutableData} from "./interfaces/IImmutableSimulator.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L3-L5) 


```solidity

File: contracts/DefaultAccount.sol

3: pragma solidity 0.8.20;
4: 
5: import "./interfaces/IAccount.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/DefaultAccount.sol#L3-L5) 


```solidity

File: contracts/ImmutableSimulator.sol

3: pragma solidity 0.8.20;
4: 
5: import {IImmutableSimulator, ImmutableData} from "./interfaces/IImmutableSimulator.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ImmutableSimulator.sol#L3-L5) 


```solidity

File: contracts/KnownCodesStorage.sol

3: pragma solidity 0.8.20;
4: 
5: import {IKnownCodesStorage} from "./interfaces/IKnownCodesStorage.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/KnownCodesStorage.sol#L3-L5) 


```solidity

File: contracts/L1Messenger.sol

3: pragma solidity 0.8.20;
4: 
5: import {IL1Messenger, L2ToL1Log, L2_L1_LOGS_TREE_DEFAULT_LEAF_HASH, L2_TO_L1_LOG_SERIALIZE_SIZE, STATE_DIFF_COMPRESSION_VERSION_NUMBER} from "./interfaces/IL1Messenger.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L3-L5) 


```solidity

File: contracts/L2BaseToken.sol

3: pragma solidity 0.8.20;
4: 
5: import {IBaseToken} from "./interfaces/IBaseToken.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L2BaseToken.sol#L3-L5) 


```solidity

File: contracts/MsgValueSimulator.sol

3: pragma solidity 0.8.20;
4: 
5: import {Utils} from "./libraries/Utils.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/MsgValueSimulator.sol#L3-L5) 


```solidity

File: contracts/NonceHolder.sol

3: pragma solidity 0.8.20;
4: 
5: import {INonceHolder} from "./interfaces/INonceHolder.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/NonceHolder.sol#L3-L5) 


```solidity

File: contracts/PubdataChunkPublisher.sol

2: pragma solidity 0.8.20;
3: 
4: import {IPubdataChunkPublisher} from "./interfaces/IPubdataChunkPublisher.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/PubdataChunkPublisher.sol#L2-L4) 


```solidity

File: contracts/SystemContext.sol

3: pragma solidity 0.8.20;
4: 
5: import {ISystemContext} from "./interfaces/ISystemContext.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L3-L5) 


```solidity

File: contracts/libraries/EfficientCall.sol

3: pragma solidity 0.8.20;
4: 
5: import "./SystemContractHelper.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L3-L5) 


```solidity

File: contracts/libraries/SystemContractHelper.sol

3: pragma solidity 0.8.20;
4: 
5: import {MAX_SYSTEM_CONTRACT_ADDRESS} from "../Constants.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L3-L5) 


```solidity

File: contracts/libraries/SystemContractsCaller.sol

3: pragma solidity 0.8.20;
4: 
5: import {MSG_VALUE_SYSTEM_CONTRACT, MSG_VALUE_SIMULATOR_IS_SYSTEM_BIT} from "../Constants.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractsCaller.sol#L3-L5) 


```solidity

File: contracts/libraries/TransactionHelper.sol

3: pragma solidity 0.8.20;
4: 
5: import "../openzeppelin/token/ERC20/IERC20.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L3-L5) 


```solidity

File: contracts/libraries/Utils.sol

2: pragma solidity 0.8.20;
3: 
4: import "./EfficientCall.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L2-L4) 


```solidity

File: contracts/interfaces/IAccount.sol

3: pragma solidity 0.8.20;
4: 
5: import "../libraries/TransactionHelper.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IAccount.sol#L3-L5) 


```solidity

File: contracts/interfaces/IAccountCodeStorage.sol

3: pragma solidity 0.8.20;
4: 
5: interface IAccountCodeStorage {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IAccountCodeStorage.sol#L3-L5) 


```solidity

File: contracts/interfaces/IBaseToken.sol

3: pragma solidity 0.8.20;
4: 
5: interface IBaseToken {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IBaseToken.sol#L3-L5) 


```solidity

File: contracts/interfaces/IBootloaderUtilities.sol

3: pragma solidity 0.8.20;
4: 
5: import "../libraries/TransactionHelper.sol";

5: import "../libraries/TransactionHelper.sol";
6: 
7: interface IBootloaderUtilities {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IBootloaderUtilities.sol#L3-L5) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IBootloaderUtilities.sol#L5-L7)


```solidity

File: contracts/interfaces/IContractDeployer.sol

3: pragma solidity 0.8.20;
4: 
5: interface IContractDeployer {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IContractDeployer.sol#L3-L5) 


```solidity

File: contracts/interfaces/IL2StandardToken.sol

3: pragma solidity 0.8.20;
4: 
5: interface IL2StandardToken {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IL2StandardToken.sol#L3-L5) 


```solidity

File: contracts/interfaces/IMailbox.sol

3: pragma solidity 0.8.20;
4: 
5: interface IMailbox {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IMailbox.sol#L3-L5) 


```solidity

File: contracts/interfaces/IPaymaster.sol

3: pragma solidity 0.8.20;
4: 
5: import "../libraries/TransactionHelper.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IPaymaster.sol#L3-L5) 


```solidity

File: contracts/interfaces/ISystemContract.sol

3: pragma solidity 0.8.20;
4: 
5: import {SystemContractHelper} from "../libraries/SystemContractHelper.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ISystemContract.sol#L3-L5) 


```solidity

File: contracts/bridge/L1ERC20Bridge.sol

3: pragma solidity 0.8.20;
4: 
5: import {IERC20} from "@openzeppelin/contracts/token/ERC20/IERC20.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1ERC20Bridge.sol#L3-L5) 


```solidity

File: contracts/bridge/L1SharedBridge.sol

3: pragma solidity 0.8.20;
4: 
5: import {Initializable} from "@openzeppelin/contracts/proxy/utils/Initializable.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L3-L5) 


```solidity

File: contracts/bridgehub/Bridgehub.sol

3: pragma solidity 0.8.20;
4: 
5: import {Ownable2Step} from "@openzeppelin/contracts/access/Ownable2Step.sol";

14: import "../vendor/AddressAliasHelper.sol";
15: 
16: contract Bridgehub is IBridgehub, ReentrancyGuard, Ownable2Step {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L3-L5) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L14-L16)


```solidity

File: contracts/governance/Governance.sol

3: pragma solidity 0.8.20;
4: 
5: import {Ownable2Step} from "@openzeppelin/contracts/access/Ownable2Step.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/Governance.sol#L3-L5) 


```solidity

File: contracts/state-transition/StateTransitionManager.sol

3: pragma solidity 0.8.20;
4: 
5: import {Diamond} from "./libraries/Diamond.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L3-L5) 


```solidity

File: contracts/state-transition/ValidatorTimelock.sol

3: pragma solidity 0.8.20;
4: 
5: import {Ownable2Step} from "@openzeppelin/contracts/access/Ownable2Step.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L3-L5) 


```solidity

File: contracts/state-transition/chain-deps/DiamondInit.sol

3: pragma solidity 0.8.20;
4: 
5: import {Diamond} from "../libraries/Diamond.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/DiamondInit.sol#L3-L5) 


```solidity

File: contracts/state-transition/chain-deps/DiamondProxy.sol

3: pragma solidity 0.8.20;
4: 
5: import {Diamond} from "../libraries/Diamond.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/DiamondProxy.sol#L3-L5) 


```solidity

File: contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol

3: pragma solidity 0.8.20;
4: 
5: import {IVerifier, VerifierParams} from "../chain-interfaces/IVerifier.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L3-L5) 


```solidity

File: contracts/state-transition/chain-deps/facets/Admin.sol

3: pragma solidity 0.8.20;
4: 
5: import {IAdmin} from "../../chain-interfaces/IAdmin.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Admin.sol#L3-L5) 


```solidity

File: contracts/state-transition/chain-deps/facets/Executor.sol

3: pragma solidity 0.8.20;
4: 
5: import {ZkSyncStateTransitionBase} from "./ZkSyncStateTransitionBase.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L3-L5) 


```solidity

File: contracts/state-transition/chain-deps/facets/Getters.sol

3: pragma solidity 0.8.20;
4: 
5: import {ZkSyncStateTransitionBase} from "./ZkSyncStateTransitionBase.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L3-L5) 


```solidity

File: contracts/state-transition/chain-deps/facets/Mailbox.sol

3: pragma solidity 0.8.20;
4: 
5: import {Math} from "@openzeppelin/contracts/utils/math/Math.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L3-L5) 


```solidity

File: contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol

3: pragma solidity 0.8.20;
4: 
5: import {ZkSyncStateTransitionStorage} from "../ZkSyncStateTransitionStorage.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L3-L5) 


```solidity

File: contracts/upgrades/BaseZkSyncUpgrade.sol

3: pragma solidity 0.8.20;
4: 
5: import {ZkSyncStateTransitionBase} from "../state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgrade.sol#L3-L5) 


```solidity

File: contracts/upgrades/BaseZkSyncUpgradeGenesis.sol

3: pragma solidity 0.8.20;
4: 
5: import "../state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L3-L5) 


```solidity

File: contracts/upgrades/DefaultUpgrade.sol

3: pragma solidity 0.8.20;
4: 
5: import {Diamond} from "../state-transition/libraries/Diamond.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/DefaultUpgrade.sol#L3-L5) 


```solidity

File: contracts/upgrades/GenesisUpgrade.sol

3: pragma solidity 0.8.20;
4: 
5: import "../state-transition/libraries/Diamond.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/GenesisUpgrade.sol#L3-L5) 


```solidity

File: contracts/state-transition/libraries/Diamond.sol

3: pragma solidity 0.8.20;
4: 
5: import {SafeCast} from "@openzeppelin/contracts/utils/math/SafeCast.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L3-L5) 


```solidity

File: contracts/state-transition/libraries/Merkle.sol

3: pragma solidity 0.8.20;
4: 
5: import {UncheckedMath} from "../../common/libraries/UncheckedMath.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Merkle.sol#L3-L5) 


```solidity

File: contracts/state-transition/libraries/TransactionValidator.sol

3: pragma solidity 0.8.20;
4: 
5: import {Math} from "@openzeppelin/contracts/utils/math/Math.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/TransactionValidator.sol#L3-L5) 


```solidity

File: contracts/bridge/interfaces/IL1ERC20Bridge.sol

3: pragma solidity 0.8.20;
4: 
5: import "./IL1SharedBridge.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1ERC20Bridge.sol#L3-L5) 


```solidity

File: contracts/bridge/interfaces/IL1SharedBridge.sol

3: pragma solidity 0.8.20;
4: 
5: import {L2TransactionRequestTwoBridgesInner} from "../../bridgehub/IBridgehub.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L3-L5) 


```solidity

File: contracts/bridge/interfaces/IWETH9.sol

2: pragma solidity 0.8.20;
3: 
4: interface IWETH9 {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IWETH9.sol#L2-L4) 


```solidity

File: contracts/bridgehub/IBridgehub.sol

3: pragma solidity 0.8.20;
4: 
5: import {IL1SharedBridge} from "../bridge/interfaces/IL1SharedBridge.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L3-L5) 


```solidity

File: contracts/state-transition/IStateTransitionManager.sol

3: pragma solidity 0.8.20;
4: 
5: import {Diamond} from "./libraries/Diamond.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/IStateTransitionManager.sol#L3-L5) 


```solidity

File: contracts/state-transition/chain-interfaces/IAdmin.sol

3: pragma solidity 0.8.20;
4: 
5: import {IZkSyncStateTransitionBase} from "../chain-interfaces/IZkSyncStateTransitionBase.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IAdmin.sol#L3-L5) 


```solidity

File: contracts/state-transition/chain-interfaces/IDiamondInit.sol

3: pragma solidity 0.8.20;
4: 
5: import {L2CanonicalTransaction} from "../../common/Messaging.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IDiamondInit.sol#L3-L5) 


```solidity

File: contracts/state-transition/chain-interfaces/IExecutor.sol

3: pragma solidity 0.8.20;
4: 
5: import {IZkSyncStateTransitionBase} from "./IZkSyncStateTransitionBase.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IExecutor.sol#L3-L5) 


```solidity

File: contracts/state-transition/chain-interfaces/IGetters.sol

3: pragma solidity 0.8.20;
4: 
5: import {PriorityOperation} from "../libraries/PriorityQueue.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IGetters.sol#L3-L5) 


```solidity

File: contracts/state-transition/chain-interfaces/ILegacyGetters.sol

3: pragma solidity 0.8.20;
4: 
5: import {IZkSyncStateTransitionBase} from "./IZkSyncStateTransitionBase.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/ILegacyGetters.sol#L3-L5) 


```solidity

File: contracts/state-transition/chain-interfaces/IMailbox.sol

3: pragma solidity 0.8.20;
4: 
5: import {IZkSyncStateTransitionBase} from "./IZkSyncStateTransitionBase.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IMailbox.sol#L3-L5) 


```solidity

File: contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol

3: pragma solidity 0.8.20;
4: 
5: import {IAdmin} from "./IAdmin.sol";

13: import "../libraries/Diamond.sol";
14: 
15: interface IZkSyncStateTransition is IAdmin, IExecutor, IGetters, IMailbox {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol#L3-L5) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol#L13-L15)


```solidity

File: contracts/state-transition/l2-deps/ISystemContext.sol

2: pragma solidity ^0.8.0;
3: 
4: interface ISystemContext {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/l2-deps/ISystemContext.sol#L2-L4) 


```solidity

File: contracts/upgrades/IDefaultUpgrade.sol

3: pragma solidity 0.8.20;
4: 
5: import {ProposedUpgrade} from "./BaseZkSyncUpgrade.sol";

5: import {ProposedUpgrade} from "./BaseZkSyncUpgrade.sol";
6: 
7: interface IDefaultUpgrade {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/IDefaultUpgrade.sol#L3-L5) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/IDefaultUpgrade.sol#L5-L7)


```solidity

File: contracts/vendor/AddressAliasHelper.sol

19: pragma solidity 0.8.20;
20: 
21: library AddressAliasHelper {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/vendor/AddressAliasHelper.sol#L19-L21) 


```solidity

File: contracts/bridge/L2SharedBridge.sol

3: pragma solidity 0.8.20;
4: 
5: import {Initializable} from "@openzeppelin/contracts/proxy/utils/Initializable.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L3-L5) 


```solidity

File: contracts/bridge/L2StandardERC20.sol

3: pragma solidity 0.8.20;
4: 
5: import {ERC20PermitUpgradeable} from "@openzeppelin/contracts-upgradeable/token/ERC20/extensions/draft-ERC20PermitUpgradeable.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2StandardERC20.sol#L3-L5) 


```solidity

File: contracts/bridge/interfaces/IL2StandardToken.sol

3: pragma solidity 0.8.20;
4: 
5: interface IL2StandardToken {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL2StandardToken.sol#L3-L5) 


```solidity

File: contracts/interfaces/IPaymaster.sol

3: pragma solidity 0.8.20;
4: 
5: import "../L2ContractHelper.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/interfaces/IPaymaster.sol#L3-L5) 


```solidity

File: contracts/vendor/AddressAliasHelper.sol

19: pragma solidity 0.8.20;
20: 
21: library AddressAliasHelper {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/vendor/AddressAliasHelper.sol#L19-L21) 


```solidity

File: contracts/ForceDeployUpgrader.sol

3: pragma solidity 0.8.20;
4: 
5: import {IContractDeployer, DEPLOYER_SYSTEM_CONTRACT} from "./L2ContractHelper.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/ForceDeployUpgrader.sol#L3-L5) 


```solidity

File: contracts/SystemContractsCaller.sol

3: pragma solidity 0.8.20;
4: 
5: import {MSG_VALUE_SYSTEM_CONTRACT} from "./L2ContractHelper.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/SystemContractsCaller.sol#L3-L5) 


</details>


### [NC&#x2011;66] Critical functions should be a two step procedure 
Critical functions in Solidity contracts should follow a two-step procedure to enhance security, minimize human error, and ensure proper access control. By dividing sensitive operations into distinct phases, such as initiation and confirmation, developers can introduce a safeguard against unintended actions or unauthorized access.


*There are 36 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/ContractDeployer.sol

65:     function updateAccountVersion(AccountAbstractionVersion _version) external onlySystemCall {

74:     function updateNonceOrdering(AccountNonceOrdering _nonceOrdering) external onlySystemCall {

213:     function forceDeployOnAddress(ForceDeployment calldata _deployment, address _sender) external payable onlySelf {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L65-L65) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L74-L74), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L213-L213)


```solidity

File: contracts/NonceHolder.sol

65:     function increaseMinNonce(uint256 _value) public onlySystemCall returns (uint256 oldMinNonce) {

82:     function setValueUnderNonce(uint256 _key, uint256 _value) public onlySystemCall {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/NonceHolder.sol#L65-L65) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/NonceHolder.sol#L82-L82)


```solidity

File: contracts/SystemContext.sol

84:     function setChainId(uint256 _newChainId) external onlyCallFromForceDeployer {

99:     function setTxOrigin(address _newOrigin) external onlyCallFromBootloader {

105:     function setGasPrice(uint256 _gasPrice) external onlyCallFromBootloader {

112:     function setPubdataInfo(uint256 _gasPerPubdataByte, uint256 _basePubdataSpent) external onlyCallFromBootloader {

341:     function setL2Block(

444:     function setNewBatch(

486:     function resetTxNumberInBatch() external onlyCallFromBootloader {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L84-L84) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L99-L99), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L105-L105), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L112-L112), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L341-L341), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L444-L444), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L486-L486)


```solidity

File: contracts/bridge/L1SharedBridge.sol

148:     function bridgehubDepositBaseToken(


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L148-L148) 


```solidity

File: contracts/bridgehub/Bridgehub.sol

51:     function setPendingAdmin(address _newPendingAdmin) external onlyOwnerOrAdmin {

82:     function addStateTransitionManager(address _stateTransitionManager) external onlyOwner {

92:     function removeStateTransitionManager(address _stateTransitionManager) external onlyOwner {

101:     function addToken(address _token) external onlyOwner {

108:     function setSharedBridge(address _sharedBridge) external onlyOwner {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L51-L51) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L82-L82), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L92-L92), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L101-L101), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L108-L108)


```solidity

File: contracts/governance/Governance.sol

249:     function updateDelay(uint256 _newDelay) external onlySelf {

256:     function updateSecurityCouncil(address _newSecurityCouncil) external onlySelf {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/Governance.sol#L249-L249) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/Governance.sol#L256-L256)


```solidity

File: contracts/state-transition/StateTransitionManager.sol

110:     function setPendingAdmin(address _newPendingAdmin) external onlyOwnerOrAdmin {

132:     function setValidatorTimelock(address _validatorTimelock) external onlyOwnerOrAdmin {

137:     function setInitialCutHash(Diamond.DiamondCutData calldata _diamondCut) external onlyOwner {

142:     function setNewVersionUpgrade(

152:     function setUpgradeDiamondCut(


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L110-L110) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L132-L132), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L137-L137), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L142-L142), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L152-L152)


```solidity

File: contracts/state-transition/ValidatorTimelock.sol

73:     function setStateTransitionManager(IStateTransitionManager _stateTransitionManager) external onlyOwner {

78:     function addValidator(uint256 _chainId, address _newValidator) external onlyChainAdmin(_chainId) {

87:     function removeValidator(uint256 _chainId, address _validator) external onlyChainAdmin(_chainId) {

96:     function setExecutionDelay(uint32 _executionDelay) external onlyOwner {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L73-L73) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L78-L78), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L87-L87), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L96-L96)


```solidity

File: contracts/state-transition/chain-deps/facets/Admin.sol

23:     function setPendingAdmin(address _newPendingAdmin) external onlyAdmin {

45:     function setValidator(address _validator, bool _active) external onlyStateTransitionManager {

51:     function setPorterAvailability(bool _zkPorterIsAvailable) external onlyStateTransitionManager {

58:     function setPriorityTxMaxGasLimit(uint256 _newPriorityTxMaxGasLimit) external onlyStateTransitionManager {

67:     function changeFeeParams(FeeParams calldata _newFeeParams) external onlyAdminOrStateTransitionManager {

79:     function setTokenMultiplier(uint128 _nominator, uint128 _denominator) external onlyAdminOrStateTransitionManager {

89:     function setValidiumMode(PubdataPricingMode _validiumMode) external onlyAdmin {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Admin.sol#L23-L23) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Admin.sol#L45-L45), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Admin.sol#L51-L51), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Admin.sol#L58-L58), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Admin.sol#L67-L67), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Admin.sol#L79-L79), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Admin.sol#L89-L89)


</details>


### [NC&#x2011;67] Typos 
Modifiers in Solidity can improve code readability and modularity by encapsulating repetitive checks, such as address validity checks, into a reusable construct. For example, an `onlyOwner` modifier can be used to replace repetitive `require(msg.sender == owner)` checks across several functions, reducing code redundancy and enhancing maintainability. To implement, define a modifier with the check, then apply the modifier to relevant functions.


*There are 1 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/DefaultAccount.sol

//@audit `signaure` is misspelled
155:     /// @notice Validation that the ECDSA signature of the transaction is correct.
156:     /// @param _hash The hash of the transaction to be signed.
157:     /// @param _signature The signature of the transaction.
158:     /// @return EIP1271_SUCCESS_RETURN_VALUE if the signaure is correct. It reverts otherwise.


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/DefaultAccount.sol#L155-L158) 


</details>


### [NC&#x2011;68] `2**<n> - 1` should be re-written as `type(uint<n>).max` 
Earlier versions of solidity can use `uint<n>(-1)` instead. Expressions not including the `- 1` can often be re-written to accomodate the change (e.g. by using a `>` rather than a `>=`, which will also save some gas)


*There are 5 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/Constants.sol

94: uint256 constant MAX_MSG_VALUE = 2 ** 128 - 1;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Constants.sol#L94-L94) 


```solidity

File: contracts/NonceHolder.sol

28:     uint256 private constant DEPLOY_NONCE_MULTIPLIER = 2 ** 128;

31:     uint256 private constant MAXIMAL_MIN_NONCE_INCREMENT = 2 ** 32;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/NonceHolder.sol#L28-L28) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/NonceHolder.sol#L31-L31)


```solidity

File: contracts/libraries/Utils.sol

87:         require(lengthInWords < 2 ** 16, "pp"); // bytecode length must be less than 2^16 words


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L87-L87) 


```solidity

File: contracts/common/libraries/L2ContractHelper.sol

26:         require(bytecodeLenInWords < 2 ** 16, "pp"); // bytecode length must be less than 2^16 words


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/L2ContractHelper.sol#L26-L26) 


</details>


### [NC&#x2011;69] Uncommented fields in a struct 
Consider adding comments for all the fields in a struct to improve the readability of the codebase.


*There are 18 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/ContractDeployer.sol

//@audit Add explanational comments to the following items `callConstructor`, 
197:     struct ForceDeployment {
198:         // The bytecode hash to put on an address
199:         bytes32 bytecodeHash;
200:         // The address on which to deploy the bytecodehash to
201:         address newAddress;
202:         // Whether to run the constructor on the force deployment
203:         bool callConstructor;
204:         // The value with which to initialize a contract
205:         uint256 value;
206:         // The constructor calldata
207:         bytes input;
208:     }


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L197-L208) 


```solidity

File: contracts/libraries/TransactionHelper.sol

//@audit Add explanational comments to the following items `txType`, `from`, `gasPerPubdataByteLimit`, `maxPriorityFeePerGas`, `nonce`, `value`, `reserved`, `data`, `signature`, `factoryDeps`, `paymasterInput`, `reservedDynamic`, 
25: struct Transaction {
26:     // The type of the transaction.
27:     uint256 txType;
28:     // The caller.
29:     uint256 from;
30:     // The callee.
31:     uint256 to;
32:     // The gasLimit to pass with the transaction.
33:     // It has the same meaning as Ethereum's gasLimit.
34:     uint256 gasLimit;
35:     // The maximum amount of gas the user is willing to pay for a byte of pubdata.
36:     uint256 gasPerPubdataByteLimit;
37:     // The maximum fee per gas that the user is willing to pay.
38:     // It is akin to EIP1559's maxFeePerGas.
39:     uint256 maxFeePerGas;
40:     // The maximum priority fee per gas that the user is willing to pay.
41:     // It is akin to EIP1559's maxPriorityFeePerGas.
42:     uint256 maxPriorityFeePerGas;
43:     // The transaction's paymaster. If there is no paymaster, it is equal to 0.
44:     uint256 paymaster;
45:     // The nonce of the transaction.
46:     uint256 nonce;
47:     // The value to pass with the transaction.
48:     uint256 value;
49:     // In the future, we might want to add some
50:     // new fields to the struct. The `txData` struct
51:     // is to be passed to account and any changes to its structure
52:     // would mean a breaking change to these accounts. In order to prevent this,
53:     // we should keep some fields as "reserved".
54:     // It is also recommended that their length is fixed, since
55:     // it would allow easier proof integration (in case we will need
56:     // some special circuit for preprocessing transactions).
57:     uint256[4] reserved;
58:     // The transaction's calldata.
59:     bytes data;
60:     // The signature of the transaction.
61:     bytes signature;
62:     // The properly formatted hashes of bytecodes that must be published on L1
63:     // with the inclusion of this transaction. Note, that a bytecode has been published
64:     // before, the user won't pay fees for its republishing.
65:     bytes32[] factoryDeps;
66:     // The input to the paymaster.
67:     bytes paymasterInput;
68:     // Reserved dynamic type for the future use-case. Using it should be avoided,
69:     // But it is still here, just in case we want to enable some additional functionality.
70:     bytes reservedDynamic;
71: }


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L25-L71) 


```solidity

File: contracts/interfaces/IContractDeployer.sol

//@audit Add explanational comments to the following items `supportedAAVersion`, `nonceOrdering`, 
28:     struct AccountInfo {
29:         AccountAbstractionVersion supportedAAVersion;
30:         AccountNonceOrdering nonceOrdering;
31:     }


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IContractDeployer.sol#L28-L31) 


```solidity

File: contracts/interfaces/IImmutableSimulator.sol

//@audit Add explanational comments to the following items `index`, `value`, 
5: struct ImmutableData {
6:     uint256 index;
7:     bytes32 value;
8: }


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IImmutableSimulator.sol#L5-L8) 


```solidity

File: contracts/interfaces/ISystemContext.sol

//@audit Add explanational comments to the following items `timestamp`, 
12:     struct BlockInfo {
13:         uint128 timestamp;
14:         uint128 number;
15:     }

//@audit Add explanational comments to the following items `virtualBlockStartBatch`, `virtualBlockFinishL2Block`, 
19:     struct VirtualBlockUpgradeInfo {
20:         /// @notice In order to maintain consistent results for `blockhash` requests, we'll
21:         /// have to remember the number of the batch when the upgrade to the virtual blocks has been done.
22:         /// The hashes for virtual blocks before the upgrade are identical to the hashes of the corresponding batches.
23:         uint128 virtualBlockStartBatch;
24:         /// @notice L2 block when the virtual blocks have caught up with the L2 blocks. Starting from this block,
25:         /// all the information returned to users for block.timestamp/number, etc should be the information about the L2 blocks and
26:         /// not virtual blocks.
27:         uint128 virtualBlockFinishL2Block;
28:     }


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ISystemContext.sol#L12-L15) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ISystemContext.sol#L19-L28)


```solidity

File: contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol

//@audit Add explanational comments to the following items `maxL2GasPerBatch`, 
52: struct FeeParams {
53:     PubdataPricingMode pubdataPricingMode;
54:     uint32 batchOverheadL1Gas;
55:     uint32 maxPubdataPerBatch;
56:     uint32 maxL2GasPerBatch;
57:     uint32 priorityTxMaxPubdata;
58:     uint64 minimalL2GasPrice;
59: }

//@audit Add explanational comments to the following items `__DEPRECATED_diamondCutStorage`, `__DEPRECATED_governor`, `__DEPRECATED_pendingGovernor`, `validators`, `verifier`, `totalBatchesExecuted`, `totalBatchesVerified`, `totalBatchesCommitted`, `storedBatchHashes`, `l2LogsRootHashes`, `priorityQueue`, `__DEPRECATED_allowList`, `verifierParams`, `l2BootloaderBytecodeHash`, `l2DefaultAccountBytecodeHash`, `zkPorterIsAvailable`, `priorityTxMaxGasLimit`, `__DEPRECATED_upgrades`, `isEthWithdrawalFinalized`, `__DEPRECATED_lastWithdrawalLimitReset`, `__DEPRECATED_withdrawnAmountInWindow`, `__DEPRECATED_totalDepositedAmountPerUser`, `protocolVersion`, `l2SystemContractsUpgradeTxHash`, `l2SystemContractsUpgradeBatchNumber`, `admin`, `pendingAdmin`, `feeParams`, `blobVersionedHashRetriever`, `chainId`, `bridgehub`, `stateTransitionManager`, `baseToken`, `baseTokenBridge`, `baseTokenGasPriceMultiplierNominator`, `baseTokenGasPriceMultiplierDenominator`, 
066: struct ZkSyncStateTransitionStorage {
067:     /// @dev Storage of variables needed for deprecated diamond cut facet
068:     uint256[7] __DEPRECATED_diamondCutStorage;
069:     /// @notice Address which will exercise critical changes to the Diamond Proxy (upgrades, freezing & unfreezing). Replaced by STM
070:     address __DEPRECATED_governor;
071:     /// @notice Address that the governor proposed as one that will replace it
072:     address __DEPRECATED_pendingGovernor;
073:     /// @notice List of permitted validators
074:     mapping(address validatorAddress => bool isValidator) validators;
075:     /// @dev Verifier contract. Used to verify aggregated proof for batches
076:     IVerifier verifier;
077:     /// @notice Total number of executed batches i.e. batches[totalBatchesExecuted] points at the latest executed batch
078:     /// (batch 0 is genesis)
079:     uint256 totalBatchesExecuted;
080:     /// @notice Total number of proved batches i.e. batches[totalBatchesProved] points at the latest proved batch
081:     uint256 totalBatchesVerified;
082:     /// @notice Total number of committed batches i.e. batches[totalBatchesCommitted] points at the latest committed
083:     /// batch
084:     uint256 totalBatchesCommitted;
085:     /// @dev Stored hashed StoredBatch for batch number
086:     mapping(uint256 batchNumber => bytes32 batchHash) storedBatchHashes;
087:     /// @dev Stored root hashes of L2 -> L1 logs
088:     mapping(uint256 batchNumber => bytes32 l2LogsRootHash) l2LogsRootHashes;
089:     /// @dev Container that stores transactions requested from L1
090:     PriorityQueue.Queue priorityQueue;
091:     /// @dev The smart contract that manages the list with permission to call contract functions
092:     address __DEPRECATED_allowList;
093:     /// @notice Part of the configuration parameters of ZKP circuits. Used as an input for the verifier smart contract
094:     VerifierParams verifierParams;
095:     /// @notice Bytecode hash of bootloader program.
096:     /// @dev Used as an input to zkp-circuit.
097:     bytes32 l2BootloaderBytecodeHash;
098:     /// @notice Bytecode hash of default account (bytecode for EOA).
099:     /// @dev Used as an input to zkp-circuit.
100:     bytes32 l2DefaultAccountBytecodeHash;
101:     /// @dev Indicates that the porter may be touched on L2 transactions.
102:     /// @dev Used as an input to zkp-circuit.
103:     bool zkPorterIsAvailable;
104:     /// @dev The maximum number of the L2 gas that a user can request for L1 -> L2 transactions
105:     /// @dev This is the maximum number of L2 gas that is available for the "body" of the transaction, i.e.
106:     /// without overhead for proving the batch.
107:     uint256 priorityTxMaxGasLimit;
108:     /// @dev Storage of variables needed for upgrade facet
109:     UpgradeStorage __DEPRECATED_upgrades;
110:     /// @dev A mapping L2 batch number => message number => flag.
111:     /// @dev The L2 -> L1 log is sent for every withdrawal, so this mapping is serving as
112:     /// a flag to indicate that the message was already processed.
113:     /// @dev Used to indicate that eth withdrawal was already processed
114:     mapping(uint256 l2BatchNumber => mapping(uint256 l2ToL1MessageNumber => bool isFinalized)) isEthWithdrawalFinalized;
115:     /// @dev The most recent withdrawal time and amount reset
116:     uint256 __DEPRECATED_lastWithdrawalLimitReset;
117:     /// @dev The accumulated withdrawn amount during the withdrawal limit window
118:     uint256 __DEPRECATED_withdrawnAmountInWindow;
119:     /// @dev A mapping user address => the total deposited amount by the user
120:     mapping(address => uint256) __DEPRECATED_totalDepositedAmountPerUser;
121:     /// @dev Stores the protocol version. Note, that the protocol version may not only encompass changes to the
122:     /// smart contracts, but also to the node behavior.
123:     uint256 protocolVersion;
124:     /// @dev Hash of the system contract upgrade transaction. If 0, then no upgrade transaction needs to be done.
125:     bytes32 l2SystemContractsUpgradeTxHash;
126:     /// @dev Batch number where the upgrade transaction has happened. If 0, then no upgrade transaction has happened
127:     /// yet.
128:     uint256 l2SystemContractsUpgradeBatchNumber;
129:     /// @dev Address which will exercise non-critical changes to the Diamond Proxy (changing validator set & unfreezing)
130:     address admin;
131:     /// @notice Address that the admin proposed as one that will replace admin role
132:     address pendingAdmin;
133:     /// @dev Fee params used to derive gasPrice for the L1->L2 transactions. For L2 transactions,
134:     /// the bootloader gives enough freedom to the operator.
135:     FeeParams feeParams;
136:     /// @dev Address of the blob versioned hash getter smart contract used for EIP-4844 versioned hashes.
137:     address blobVersionedHashRetriever;
138:     /// new fields
139:     /// @dev The chainId of the chain
140:     uint256 chainId;
141:     /// @dev The address of the bridgehub
142:     address bridgehub;
143:     /// @dev The address of the StateTransitionManager
144:     address stateTransitionManager;
145:     /// @dev The address of the baseToken contract. Eth is address(1)
146:     address baseToken;
147:     /// @dev The address of the baseTokenbridge. Eth also uses the shared bridge
148:     address baseTokenBridge;
149:     /// @notice gasPriceMultiplier for each baseToken, so that each L1->L2 transaction pays for its transaction on the destination
150:     /// we multiply by the nominator, and divide by the denominator
151:     uint128 baseTokenGasPriceMultiplierNominator;
152:     uint128 baseTokenGasPriceMultiplierDenominator;
153: }


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L52-L59) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L66-L153)


```solidity

File: contracts/bridgehub/IBridgehub.sol

//@audit Add explanational comments to the following items `chainId`, `mintValue`, `l2Contract`, `l2Value`, `l2Calldata`, `l2GasLimit`, `l2GasPerPubdataByteLimit`, `factoryDeps`, `refundRecipient`, 
10: struct L2TransactionRequestDirect {
11:     uint256 chainId;
12:     uint256 mintValue;
13:     address l2Contract;
14:     uint256 l2Value;
15:     bytes l2Calldata;
16:     uint256 l2GasLimit;
17:     uint256 l2GasPerPubdataByteLimit;
18:     bytes[] factoryDeps;
19:     address refundRecipient;
20: }

//@audit Add explanational comments to the following items `chainId`, `mintValue`, `l2Value`, `l2GasLimit`, `l2GasPerPubdataByteLimit`, `refundRecipient`, `secondBridgeAddress`, `secondBridgeValue`, `secondBridgeCalldata`, 
22: struct L2TransactionRequestTwoBridgesOuter {
23:     uint256 chainId;
24:     uint256 mintValue;
25:     uint256 l2Value;
26:     uint256 l2GasLimit;
27:     uint256 l2GasPerPubdataByteLimit;
28:     address refundRecipient;
29:     address secondBridgeAddress;
30:     uint256 secondBridgeValue;
31:     bytes secondBridgeCalldata;
32: }

//@audit Add explanational comments to the following items `magicValue`, `l2Contract`, `l2Calldata`, `factoryDeps`, `txDataHash`, 
34: struct L2TransactionRequestTwoBridgesInner {
35:     bytes32 magicValue;
36:     address l2Contract;
37:     bytes l2Calldata;
38:     bytes[] factoryDeps;
39:     bytes32 txDataHash;
40: }


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L10-L20) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L22-L32), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L34-L40)


```solidity

File: contracts/state-transition/IStateTransitionManager.sol

//@audit Add explanational comments to the following items `genesisUpgrade`, `diamondCut`, `protocolVersion`, 
15: struct StateTransitionManagerInitializeData {
16:     address governor;
17:     address validatorTimelock;
18:     address genesisUpgrade;
19:     bytes32 genesisBatchHash;
20:     uint64 genesisIndexRepeatedStorageChanges;
21:     bytes32 genesisBatchCommitment;
22:     Diamond.DiamondCutData diamondCut;
23:     uint256 protocolVersion;
24: }


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/IStateTransitionManager.sol#L15-L24) 


```solidity

File: contracts/state-transition/chain-interfaces/IExecutor.sol

//@audit Add explanational comments to the following items `chainedPriorityTxsHash`, `previousBatchHash`, `pubdataHash`, `stateDiffHash`, `packedBatchAndL2BlockTimestamp`, `blob1Hash`, `blob2Hash`, 
27: struct LogProcessingOutput {
28:     uint256 numberOfLayer1Txs;
29:     bytes32 chainedPriorityTxsHash;
30:     bytes32 previousBatchHash;
31:     bytes32 pubdataHash;
32:     bytes32 stateDiffHash;
33:     bytes32 l2LogsTreeRoot;
34:     uint256 packedBatchAndL2BlockTimestamp;
35:     bytes32 blob1Hash;
36:     bytes32 blob2Hash;
37: }

//@audit Add explanational comments to the following items `recursiveAggregationInput`, `serializedProof`, 
126:     struct ProofInput {
127:         uint256[] recursiveAggregationInput;
128:         uint256[] serializedProof;
129:     }


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IExecutor.sol#L27-L37) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IExecutor.sol#L126-L129)


```solidity

File: contracts/state-transition/chain-interfaces/IVerifier.sol

//@audit Add explanational comments to the following items `recursionNodeLevelVkHash`, `recursionLeafLevelVkHash`, `recursionCircuitsSetVksHash`, 
06: struct VerifierParams {
07:     bytes32 recursionNodeLevelVkHash;
08:     bytes32 recursionLeafLevelVkHash;
09:     bytes32 recursionCircuitsSetVksHash;
10: }


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IVerifier.sol#L6-L10) 


```solidity

File: contracts/common/Messaging.sol

//@audit Add explanational comments to the following items `contractL2`, `mintValue`, `l2Calldata`, `l2GasPerPubdataByteLimit`, 
127: struct BridgehubL2TransactionRequest {
128:     address sender;
129:     address contractL2;
130:     uint256 mintValue;
131:     uint256 l2Value;
132:     bytes l2Calldata;
133:     uint256 l2GasLimit;
134:     uint256 l2GasPerPubdataByteLimit;
135:     bytes[] factoryDeps;
136:     address refundRecipient;
137: }


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/Messaging.sol#L127-L137) 


```solidity

File: contracts/bridge/L2StandardERC20.sol

//@audit Add explanational comments to the following items `ignoreName`, `ignoreSymbol`, `ignoreDecimals`, 
20:     struct ERC20Getters {
21:         bool ignoreName;
22:         bool ignoreSymbol;
23:         bool ignoreDecimals;
24:     }


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2StandardERC20.sol#L20-L24) 


```solidity

File: contracts/L2ContractHelper.sol

//@audit Add explanational comments to the following items `txType`, `gasLimit`, `gasPerPubdataByteLimit`, `maxFeePerGas`, `maxPriorityFeePerGas`, `paymaster`, `nonce`, `reserved`, `signature`, `factoryDeps`, `paymasterInput`, `reservedDynamic`, 
117: struct Transaction {
118:     // The type of the transaction.
119:     uint256 txType;
120:     // The caller.
121:     uint256 from;
122:     // The callee.
123:     uint256 to;
124:     // The gasLimit to pass with the transaction.
125:     // It has the same meaning as Ethereum's gasLimit.
126:     uint256 gasLimit;
127:     // The maximum amount of gas the user is willing to pay for a byte of pubdata.
128:     uint256 gasPerPubdataByteLimit;
129:     // The maximum fee per gas that the user is willing to pay.
130:     // It is akin to EIP1559's maxFeePerGas.
131:     uint256 maxFeePerGas;
132:     // The maximum priority fee per gas that the user is willing to pay.
133:     // It is akin to EIP1559's maxPriorityFeePerGas.
134:     uint256 maxPriorityFeePerGas;
135:     // The transaction's paymaster. If there is no paymaster, it is equal to 0.
136:     uint256 paymaster;
137:     // The nonce of the transaction.
138:     uint256 nonce;
139:     // The value to pass with the transaction.
140:     uint256 value;
141:     // In the future, we might want to add some
142:     // new fields to the struct. The `txData` struct
143:     // is to be passed to account and any changes to its structure
144:     // would mean a breaking change to these accounts. In order to prevent this,
145:     // we should keep some fields as "reserved".
146:     // It is also recommended that their length is fixed, since
147:     // it would allow easier proof integration (in case we will need
148:     // some special circuit for preprocessing transactions).
149:     uint256[4] reserved;
150:     // The transaction's calldata.
151:     bytes data;
152:     // The signature of the transaction.
153:     bytes signature;
154:     // The properly formatted hashes of bytecodes that must be published on L1
155:     // with the inclusion of this transaction. Note, that a bytecode has been published
156:     // before, the user won't pay fees for its republishing.
157:     bytes32[] factoryDeps;
158:     // The input to the paymaster.
159:     bytes paymasterInput;
160:     // Reserved dynamic type for the future use-case. Using it should be avoided,
161:     // But it is still here, just in case we want to enable some additional functionality.
162:     bytes reservedDynamic;
163: }


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/L2ContractHelper.sol#L117-L163) 


</details>


### [NC&#x2011;70] Using underscore at the end of variable name 
The use of underscore at the end of the variable name is uncommon and also suggests that the variable name was not completely changed. Consider refactoring variableName_ to variableName.


*There are 1 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/bridge/L2StandardERC20.sol

31:     uint8 private decimals_;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2StandardERC20.sol#L31-L31) 


</details>


### [NC&#x2011;71] Event is missing `indexed` fields 
Index event fields make the field more quickly accessible to off-chain tools that parse events. However, note that each index field costs extra gas during emission, so it's not necessarily best to index the maximum allowed per event (three fields). Each event should use three indexed fields if there are three or more fields, and gas usage is not particularly of concern for the events in question. If there are fewer than three fields, all of the fields should be indexed.


*There are 42 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/interfaces/IBaseToken.sol

24:     event Mint(address indexed account, uint256 amount);

26:     event Transfer(address indexed from, address indexed to, uint256 value);

28:     event Withdrawal(address indexed _l2Sender, address indexed _l1Receiver, uint256 _amount);

30:     event WithdrawalWithMessage(


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IBaseToken.sol#L24-L24) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IBaseToken.sol#L26-L26), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IBaseToken.sol#L28-L28), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IBaseToken.sol#L30-L30)


```solidity

File: contracts/interfaces/IContractDeployer.sol

39:     event AccountNonceOrderingUpdated(address indexed accountAddress, AccountNonceOrdering nonceOrdering);

41:     event AccountVersionUpdated(address indexed accountAddress, AccountAbstractionVersion aaVersion);


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IContractDeployer.sol#L39-L39) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IContractDeployer.sol#L41-L41)


```solidity

File: contracts/interfaces/IL1Messenger.sol

43:     event L1MessageSent(address indexed _sender, bytes32 indexed _hash, bytes _message);

45:     event L2ToL1LogSent(L2ToL1Log _l2log);

47:     event BytecodeL1PublicationRequested(bytes32 _bytecodeHash);


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IL1Messenger.sol#L43-L43) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IL1Messenger.sol#L45-L45), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IL1Messenger.sol#L47-L47)


```solidity

File: contracts/interfaces/IL2StandardToken.sol

6:     event BridgeMint(address indexed _account, uint256 _amount);

8:     event BridgeBurn(address indexed _account, uint256 _amount);


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IL2StandardToken.sol#L6-L6) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IL2StandardToken.sol#L8-L8)


```solidity

File: contracts/interfaces/INonceHolder.sol

14:     event ValueSetUnderNonce(address indexed accountAddress, uint256 indexed key, uint256 value);


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/INonceHolder.sol#L14-L14) 


```solidity

File: contracts/state-transition/ValidatorTimelock.sol

29:     event NewExecutionDelay(uint256 _newExecutionDelay);

32:     event ValidatorAdded(uint256 _chainId, address _addedValidator);

35:     event ValidatorRemoved(uint256 _chainId, address _removedValidator);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L29-L29) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L32-L32), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L35-L35)


```solidity

File: contracts/upgrades/BaseZkSyncUpgrade.sol

58:     event NewVerifierParams(VerifierParams oldVerifierParams, VerifierParams newVerifierParams);

61:     event UpgradeComplete(uint256 indexed newProtocolVersion, bytes32 indexed l2UpgradeTxHash, ProposedUpgrade upgrade);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgrade.sol#L58-L58) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgrade.sol#L61-L61)


```solidity

File: contracts/state-transition/libraries/Diamond.sol

24:     event DiamondCut(FacetCut[] facetCuts, address initAddress, bytes initCalldata);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L24-L24) 


```solidity

File: contracts/bridge/interfaces/IL1ERC20Bridge.sol

20:     event WithdrawalFinalized(address indexed to, address indexed l1Token, uint256 amount);

22:     event ClaimedFailedDeposit(address indexed to, address indexed l1Token, uint256 amount);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1ERC20Bridge.sol#L20-L20) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1ERC20Bridge.sol#L22-L22)


```solidity

File: contracts/bridge/interfaces/IL1SharedBridge.sol

31:     event BridgehubDepositBaseTokenInitiated(


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L31-L31) 


```solidity

File: contracts/bridgehub/IBridgehub.sol

133:     event NewChain(uint256 indexed chainId, address stateTransitionManager, address indexed chainGovernance);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L133-L133) 


```solidity

File: contracts/governance/IGovernance.sol

68:     event TransparentOperationScheduled(bytes32 indexed _id, uint256 delay, Operation _operation);

71:     event ShadowOperationScheduled(bytes32 indexed _id, uint256 delay);

77:     event ChangeSecurityCouncil(address _securityCouncilBefore, address _securityCouncilAfter);

80:     event ChangeMinDelay(uint256 _delayBefore, uint256 _delayAfter);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/IGovernance.sol#L68-L68) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/IGovernance.sol#L71-L71), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/IGovernance.sol#L77-L77), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/IGovernance.sol#L80-L80)


```solidity

File: contracts/state-transition/IStateTransitionManager.sol

30:     event SetChainIdUpgrade(


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/IStateTransitionManager.sol#L30-L30) 


```solidity

File: contracts/state-transition/chain-interfaces/IAdmin.sol

61:     event IsPorterAvailableStatusUpdate(bool isPorterAvailable);

64:     event ValidatorStatusUpdate(address indexed validatorAddress, bool isActive);

74:     event NewPriorityTxMaxGasLimit(uint256 oldPriorityTxMaxGasLimit, uint256 newPriorityTxMaxGasLimit);

77:     event NewFeeParams(FeeParams oldFeeParams, FeeParams newFeeParams);

80:     event ValidiumModeStatusUpdate(PubdataPricingMode validiumMode);

83:     event NewBaseTokenMultiplier(

91:     event ExecuteUpgrade(Diamond.DiamondCutData diamondCut);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IAdmin.sol#L61-L61) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IAdmin.sol#L64-L64), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IAdmin.sol#L74-L74), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IAdmin.sol#L77-L77), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IAdmin.sol#L80-L80), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IAdmin.sol#L83-L83), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IAdmin.sol#L91-L91)


```solidity

File: contracts/state-transition/chain-interfaces/IExecutor.sol

211:     event BlocksRevert(uint256 totalBatchesCommitted, uint256 totalBatchesVerified, uint256 totalBatchesExecuted);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IExecutor.sol#L211-L211) 


```solidity

File: contracts/state-transition/chain-interfaces/IMailbox.sol

123:     event NewPriorityRequest(

134:     event EthWithdrawalFinalized(address indexed to, uint256 amount);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IMailbox.sol#L123-L123) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IMailbox.sol#L134-L134)


```solidity

File: contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol

17:     event ProposeTransparentUpgrade(


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol#L17-L17) 


```solidity

File: contracts/bridge/interfaces/IL2SharedBridge.sol

22:     event BaseTokenReceived(uint256 amount);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL2SharedBridge.sol#L22-L22) 


```solidity

File: contracts/bridge/interfaces/IL2StandardToken.sol

6:     event BridgeInitialize(address indexed l1Token, string name, string symbol, uint8 decimals);

8:     event BridgeMint(address indexed _account, uint256 _amount);

10:     event BridgeBurn(address indexed _account, uint256 _amount);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL2StandardToken.sol#L6-L6) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL2StandardToken.sol#L8-L8), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL2StandardToken.sol#L10-L10)


</details>


### [NC&#x2011;72] Unused Import 
Some files/Items are imported but never used


*There are 69 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/Compressor.sol

//@audit `INITIAL_WRITE_STARTING_POSITION` is not used
10: import {L1_MESSENGER_CONTRACT, INITIAL_WRITE_STARTING_POSITION, COMPRESSED_INITIAL_WRITE_SIZE, STATE_DIFF_ENTRY_SIZE, STATE_DIFF_ENUM_INDEX_OFFSET, STATE_DIFF_FINAL_VALUE_OFFSET, STATE_DIFF_DERIVED_KEY_OFFSET, DERIVED_KEY_LENGTH, VALUE_LENGTH, ENUM_INDEX_LENGTH, KNOWN_CODE_STORAGE_CONTRACT} from "./Constants.sol";

//@audit `COMPRESSED_INITIAL_WRITE_SIZE` is not used
10: import {L1_MESSENGER_CONTRACT, INITIAL_WRITE_STARTING_POSITION, COMPRESSED_INITIAL_WRITE_SIZE, STATE_DIFF_ENTRY_SIZE, STATE_DIFF_ENUM_INDEX_OFFSET, STATE_DIFF_FINAL_VALUE_OFFSET, STATE_DIFF_DERIVED_KEY_OFFSET, DERIVED_KEY_LENGTH, VALUE_LENGTH, ENUM_INDEX_LENGTH, KNOWN_CODE_STORAGE_CONTRACT} from "./Constants.sol";

//@audit `STATE_DIFF_ENUM_INDEX_OFFSET` is not used
10: import {L1_MESSENGER_CONTRACT, INITIAL_WRITE_STARTING_POSITION, COMPRESSED_INITIAL_WRITE_SIZE, STATE_DIFF_ENTRY_SIZE, STATE_DIFF_ENUM_INDEX_OFFSET, STATE_DIFF_FINAL_VALUE_OFFSET, STATE_DIFF_DERIVED_KEY_OFFSET, DERIVED_KEY_LENGTH, VALUE_LENGTH, ENUM_INDEX_LENGTH, KNOWN_CODE_STORAGE_CONTRACT} from "./Constants.sol";

//@audit `STATE_DIFF_FINAL_VALUE_OFFSET` is not used
10: import {L1_MESSENGER_CONTRACT, INITIAL_WRITE_STARTING_POSITION, COMPRESSED_INITIAL_WRITE_SIZE, STATE_DIFF_ENTRY_SIZE, STATE_DIFF_ENUM_INDEX_OFFSET, STATE_DIFF_FINAL_VALUE_OFFSET, STATE_DIFF_DERIVED_KEY_OFFSET, DERIVED_KEY_LENGTH, VALUE_LENGTH, ENUM_INDEX_LENGTH, KNOWN_CODE_STORAGE_CONTRACT} from "./Constants.sol";

//@audit `STATE_DIFF_DERIVED_KEY_OFFSET` is not used
10: import {L1_MESSENGER_CONTRACT, INITIAL_WRITE_STARTING_POSITION, COMPRESSED_INITIAL_WRITE_SIZE, STATE_DIFF_ENTRY_SIZE, STATE_DIFF_ENUM_INDEX_OFFSET, STATE_DIFF_FINAL_VALUE_OFFSET, STATE_DIFF_DERIVED_KEY_OFFSET, DERIVED_KEY_LENGTH, VALUE_LENGTH, ENUM_INDEX_LENGTH, KNOWN_CODE_STORAGE_CONTRACT} from "./Constants.sol";

//@audit `DERIVED_KEY_LENGTH` is not used
10: import {L1_MESSENGER_CONTRACT, INITIAL_WRITE_STARTING_POSITION, COMPRESSED_INITIAL_WRITE_SIZE, STATE_DIFF_ENTRY_SIZE, STATE_DIFF_ENUM_INDEX_OFFSET, STATE_DIFF_FINAL_VALUE_OFFSET, STATE_DIFF_DERIVED_KEY_OFFSET, DERIVED_KEY_LENGTH, VALUE_LENGTH, ENUM_INDEX_LENGTH, KNOWN_CODE_STORAGE_CONTRACT} from "./Constants.sol";

//@audit `VALUE_LENGTH` is not used
10: import {L1_MESSENGER_CONTRACT, INITIAL_WRITE_STARTING_POSITION, COMPRESSED_INITIAL_WRITE_SIZE, STATE_DIFF_ENTRY_SIZE, STATE_DIFF_ENUM_INDEX_OFFSET, STATE_DIFF_FINAL_VALUE_OFFSET, STATE_DIFF_DERIVED_KEY_OFFSET, DERIVED_KEY_LENGTH, VALUE_LENGTH, ENUM_INDEX_LENGTH, KNOWN_CODE_STORAGE_CONTRACT} from "./Constants.sol";

//@audit `ENUM_INDEX_LENGTH` is not used
10: import {L1_MESSENGER_CONTRACT, INITIAL_WRITE_STARTING_POSITION, COMPRESSED_INITIAL_WRITE_SIZE, STATE_DIFF_ENTRY_SIZE, STATE_DIFF_ENUM_INDEX_OFFSET, STATE_DIFF_FINAL_VALUE_OFFSET, STATE_DIFF_DERIVED_KEY_OFFSET, DERIVED_KEY_LENGTH, VALUE_LENGTH, ENUM_INDEX_LENGTH, KNOWN_CODE_STORAGE_CONTRACT} from "./Constants.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Compressor.sol#L10-L10) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Compressor.sol#L10-L10), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Compressor.sol#L10-L10), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Compressor.sol#L10-L10), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Compressor.sol#L10-L10), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Compressor.sol#L10-L10), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Compressor.sol#L10-L10), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Compressor.sol#L10-L10)


```solidity

File: contracts/Constants.sol

//@audit `IAccountCodeStorage` is not used
5: import {IAccountCodeStorage} from "./interfaces/IAccountCodeStorage.sol";

//@audit `INonceHolder` is not used
6: import {INonceHolder} from "./interfaces/INonceHolder.sol";

//@audit `IContractDeployer` is not used
7: import {IContractDeployer} from "./interfaces/IContractDeployer.sol";

//@audit `IKnownCodesStorage` is not used
8: import {IKnownCodesStorage} from "./interfaces/IKnownCodesStorage.sol";

//@audit `IImmutableSimulator` is not used
9: import {IImmutableSimulator} from "./interfaces/IImmutableSimulator.sol";

//@audit `IBaseToken` is not used
10: import {IBaseToken} from "./interfaces/IBaseToken.sol";

//@audit `IL1Messenger` is not used
11: import {IL1Messenger} from "./interfaces/IL1Messenger.sol";

//@audit `ISystemContext` is not used
12: import {ISystemContext} from "./interfaces/ISystemContext.sol";

//@audit `ICompressor` is not used
13: import {ICompressor} from "./interfaces/ICompressor.sol";

//@audit `IComplexUpgrader` is not used
14: import {IComplexUpgrader} from "./interfaces/IComplexUpgrader.sol";

//@audit `IBootloaderUtilities` is not used
15: import {IBootloaderUtilities} from "./interfaces/IBootloaderUtilities.sol";

//@audit `IPubdataChunkPublisher` is not used
16: import {IPubdataChunkPublisher} from "./interfaces/IPubdataChunkPublisher.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Constants.sol#L5-L5) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Constants.sol#L6-L6), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Constants.sol#L7-L7), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Constants.sol#L8-L8), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Constants.sol#L9-L9), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Constants.sol#L10-L10), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Constants.sol#L11-L11), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Constants.sol#L12-L12), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Constants.sol#L13-L13), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Constants.sol#L14-L14), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Constants.sol#L15-L15), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Constants.sol#L16-L16)


```solidity

File: contracts/ContractDeployer.sol

//@audit `KECCAK256_SYSTEM_CONTRACT` is not used
7: import {CREATE2_PREFIX, CREATE_PREFIX, NONCE_HOLDER_SYSTEM_CONTRACT, ACCOUNT_CODE_STORAGE_SYSTEM_CONTRACT, FORCE_DEPLOYER, MAX_SYSTEM_CONTRACT_ADDRESS, KNOWN_CODE_STORAGE_CONTRACT, BASE_TOKEN_SYSTEM_CONTRACT, IMMUTABLE_SIMULATOR_SYSTEM_CONTRACT, COMPLEX_UPGRADER_CONTRACT, KECCAK256_SYSTEM_CONTRACT} from "./Constants.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L7-L7) 


```solidity

File: contracts/PubdataChunkPublisher.sol

//@audit `EfficientCall` is not used
7: import {EfficientCall} from "./libraries/EfficientCall.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/PubdataChunkPublisher.sol#L7-L7) 


```solidity

File: contracts/libraries/SystemContractHelper.sol

//@audit `SystemContractsCaller` is not used
7: import {SystemContractsCaller, CalldataForwardingMode, CALLFLAGS_CALL_ADDRESS, CODE_ADDRESS_CALL_ADDRESS, EVENT_WRITE_ADDRESS, EVENT_INITIALIZE_ADDRESS, GET_EXTRA_ABI_DATA_ADDRESS, LOAD_CALLDATA_INTO_ACTIVE_PTR_CALL_ADDRESS, META_CODE_SHARD_ID_OFFSET, META_CALLER_SHARD_ID_OFFSET, META_SHARD_ID_OFFSET, META_AUX_HEAP_SIZE_OFFSET, META_HEAP_SIZE_OFFSET, META_GAS_PER_PUBDATA_BYTE_OFFSET, MIMIC_CALL_BY_REF_CALL_ADDRESS, META_CALL_ADDRESS, MSG_VALUE_SIMULATOR_IS_SYSTEM_BIT, PTR_CALLDATA_CALL_ADDRESS, PTR_ADD_INTO_ACTIVE_CALL_ADDRESS, PTR_SHRINK_INTO_ACTIVE_CALL_ADDRESS, PTR_PACK_INTO_ACTIVE_CALL_ADDRESS, RAW_FAR_CALL_BY_REF_CALL_ADDRESS, PRECOMPILE_CALL_ADDRESS, SET_CONTEXT_VALUE_CALL_ADDRESS, SYSTEM_CALL_BY_REF_CALL_ADDRESS, TO_L1_CALL_ADDRESS} from "./SystemContractsCaller.sol";

//@audit `CalldataForwardingMode` is not used
7: import {SystemContractsCaller, CalldataForwardingMode, CALLFLAGS_CALL_ADDRESS, CODE_ADDRESS_CALL_ADDRESS, EVENT_WRITE_ADDRESS, EVENT_INITIALIZE_ADDRESS, GET_EXTRA_ABI_DATA_ADDRESS, LOAD_CALLDATA_INTO_ACTIVE_PTR_CALL_ADDRESS, META_CODE_SHARD_ID_OFFSET, META_CALLER_SHARD_ID_OFFSET, META_SHARD_ID_OFFSET, META_AUX_HEAP_SIZE_OFFSET, META_HEAP_SIZE_OFFSET, META_GAS_PER_PUBDATA_BYTE_OFFSET, MIMIC_CALL_BY_REF_CALL_ADDRESS, META_CALL_ADDRESS, MSG_VALUE_SIMULATOR_IS_SYSTEM_BIT, PTR_CALLDATA_CALL_ADDRESS, PTR_ADD_INTO_ACTIVE_CALL_ADDRESS, PTR_SHRINK_INTO_ACTIVE_CALL_ADDRESS, PTR_PACK_INTO_ACTIVE_CALL_ADDRESS, RAW_FAR_CALL_BY_REF_CALL_ADDRESS, PRECOMPILE_CALL_ADDRESS, SET_CONTEXT_VALUE_CALL_ADDRESS, SYSTEM_CALL_BY_REF_CALL_ADDRESS, TO_L1_CALL_ADDRESS} from "./SystemContractsCaller.sol";

//@audit `MIMIC_CALL_BY_REF_CALL_ADDRESS` is not used
7: import {SystemContractsCaller, CalldataForwardingMode, CALLFLAGS_CALL_ADDRESS, CODE_ADDRESS_CALL_ADDRESS, EVENT_WRITE_ADDRESS, EVENT_INITIALIZE_ADDRESS, GET_EXTRA_ABI_DATA_ADDRESS, LOAD_CALLDATA_INTO_ACTIVE_PTR_CALL_ADDRESS, META_CODE_SHARD_ID_OFFSET, META_CALLER_SHARD_ID_OFFSET, META_SHARD_ID_OFFSET, META_AUX_HEAP_SIZE_OFFSET, META_HEAP_SIZE_OFFSET, META_GAS_PER_PUBDATA_BYTE_OFFSET, MIMIC_CALL_BY_REF_CALL_ADDRESS, META_CALL_ADDRESS, MSG_VALUE_SIMULATOR_IS_SYSTEM_BIT, PTR_CALLDATA_CALL_ADDRESS, PTR_ADD_INTO_ACTIVE_CALL_ADDRESS, PTR_SHRINK_INTO_ACTIVE_CALL_ADDRESS, PTR_PACK_INTO_ACTIVE_CALL_ADDRESS, RAW_FAR_CALL_BY_REF_CALL_ADDRESS, PRECOMPILE_CALL_ADDRESS, SET_CONTEXT_VALUE_CALL_ADDRESS, SYSTEM_CALL_BY_REF_CALL_ADDRESS, TO_L1_CALL_ADDRESS} from "./SystemContractsCaller.sol";

//@audit `MSG_VALUE_SIMULATOR_IS_SYSTEM_BIT` is not used
7: import {SystemContractsCaller, CalldataForwardingMode, CALLFLAGS_CALL_ADDRESS, CODE_ADDRESS_CALL_ADDRESS, EVENT_WRITE_ADDRESS, EVENT_INITIALIZE_ADDRESS, GET_EXTRA_ABI_DATA_ADDRESS, LOAD_CALLDATA_INTO_ACTIVE_PTR_CALL_ADDRESS, META_CODE_SHARD_ID_OFFSET, META_CALLER_SHARD_ID_OFFSET, META_SHARD_ID_OFFSET, META_AUX_HEAP_SIZE_OFFSET, META_HEAP_SIZE_OFFSET, META_GAS_PER_PUBDATA_BYTE_OFFSET, MIMIC_CALL_BY_REF_CALL_ADDRESS, META_CALL_ADDRESS, MSG_VALUE_SIMULATOR_IS_SYSTEM_BIT, PTR_CALLDATA_CALL_ADDRESS, PTR_ADD_INTO_ACTIVE_CALL_ADDRESS, PTR_SHRINK_INTO_ACTIVE_CALL_ADDRESS, PTR_PACK_INTO_ACTIVE_CALL_ADDRESS, RAW_FAR_CALL_BY_REF_CALL_ADDRESS, PRECOMPILE_CALL_ADDRESS, SET_CONTEXT_VALUE_CALL_ADDRESS, SYSTEM_CALL_BY_REF_CALL_ADDRESS, TO_L1_CALL_ADDRESS} from "./SystemContractsCaller.sol";

//@audit `RAW_FAR_CALL_BY_REF_CALL_ADDRESS` is not used
7: import {SystemContractsCaller, CalldataForwardingMode, CALLFLAGS_CALL_ADDRESS, CODE_ADDRESS_CALL_ADDRESS, EVENT_WRITE_ADDRESS, EVENT_INITIALIZE_ADDRESS, GET_EXTRA_ABI_DATA_ADDRESS, LOAD_CALLDATA_INTO_ACTIVE_PTR_CALL_ADDRESS, META_CODE_SHARD_ID_OFFSET, META_CALLER_SHARD_ID_OFFSET, META_SHARD_ID_OFFSET, META_AUX_HEAP_SIZE_OFFSET, META_HEAP_SIZE_OFFSET, META_GAS_PER_PUBDATA_BYTE_OFFSET, MIMIC_CALL_BY_REF_CALL_ADDRESS, META_CALL_ADDRESS, MSG_VALUE_SIMULATOR_IS_SYSTEM_BIT, PTR_CALLDATA_CALL_ADDRESS, PTR_ADD_INTO_ACTIVE_CALL_ADDRESS, PTR_SHRINK_INTO_ACTIVE_CALL_ADDRESS, PTR_PACK_INTO_ACTIVE_CALL_ADDRESS, RAW_FAR_CALL_BY_REF_CALL_ADDRESS, PRECOMPILE_CALL_ADDRESS, SET_CONTEXT_VALUE_CALL_ADDRESS, SYSTEM_CALL_BY_REF_CALL_ADDRESS, TO_L1_CALL_ADDRESS} from "./SystemContractsCaller.sol";

//@audit `SYSTEM_CALL_BY_REF_CALL_ADDRESS` is not used
7: import {SystemContractsCaller, CalldataForwardingMode, CALLFLAGS_CALL_ADDRESS, CODE_ADDRESS_CALL_ADDRESS, EVENT_WRITE_ADDRESS, EVENT_INITIALIZE_ADDRESS, GET_EXTRA_ABI_DATA_ADDRESS, LOAD_CALLDATA_INTO_ACTIVE_PTR_CALL_ADDRESS, META_CODE_SHARD_ID_OFFSET, META_CALLER_SHARD_ID_OFFSET, META_SHARD_ID_OFFSET, META_AUX_HEAP_SIZE_OFFSET, META_HEAP_SIZE_OFFSET, META_GAS_PER_PUBDATA_BYTE_OFFSET, MIMIC_CALL_BY_REF_CALL_ADDRESS, META_CALL_ADDRESS, MSG_VALUE_SIMULATOR_IS_SYSTEM_BIT, PTR_CALLDATA_CALL_ADDRESS, PTR_ADD_INTO_ACTIVE_CALL_ADDRESS, PTR_SHRINK_INTO_ACTIVE_CALL_ADDRESS, PTR_PACK_INTO_ACTIVE_CALL_ADDRESS, RAW_FAR_CALL_BY_REF_CALL_ADDRESS, PRECOMPILE_CALL_ADDRESS, SET_CONTEXT_VALUE_CALL_ADDRESS, SYSTEM_CALL_BY_REF_CALL_ADDRESS, TO_L1_CALL_ADDRESS} from "./SystemContractsCaller.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L7-L7) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L7-L7), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L7-L7), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L7-L7), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L7-L7), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L7-L7)


```solidity

File: contracts/libraries/TransactionHelper.sol

//@audit `IContractDeployer` is not used
9: import "../interfaces/IContractDeployer.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L9-L9) 


```solidity

File: contracts/interfaces/IAccount.sol

//@audit `TransactionHelper` is not used
5: import "../libraries/TransactionHelper.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IAccount.sol#L5-L5) 


```solidity

File: contracts/interfaces/IBootloaderUtilities.sol

//@audit `TransactionHelper` is not used
5: import "../libraries/TransactionHelper.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IBootloaderUtilities.sol#L5-L5) 


```solidity

File: contracts/interfaces/IPaymaster.sol

//@audit `TransactionHelper` is not used
5: import "../libraries/TransactionHelper.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IPaymaster.sol#L5-L5) 


```solidity

File: contracts/state-transition/StateTransitionManager.sol

//@audit `ERA_DIAMOND_PROXY` is not used
19: import {REQUIRED_L2_GAS_PRICE_PER_PUBDATA, L2_TO_L1_LOG_SERIALIZE_SIZE, DEFAULT_L2_LOGS_TREE_ROOT_HASH, EMPTY_STRING_KECCAK, SYSTEM_UPGRADE_L2_TX_TYPE, ERA_DIAMOND_PROXY, ERA_CHAIN_ID} from "../common/Config.sol";

//@audit `ERA_CHAIN_ID` is not used
19: import {REQUIRED_L2_GAS_PRICE_PER_PUBDATA, L2_TO_L1_LOG_SERIALIZE_SIZE, DEFAULT_L2_LOGS_TREE_ROOT_HASH, EMPTY_STRING_KECCAK, SYSTEM_UPGRADE_L2_TX_TYPE, ERA_DIAMOND_PROXY, ERA_CHAIN_ID} from "../common/Config.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L19-L19) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L19-L19)


```solidity

File: contracts/state-transition/chain-deps/DiamondInit.sol

//@audit `FeeParams` is not used
7: import {FeeParams} from "./ZkSyncStateTransitionStorage.sol";

//@audit `VerifierParams` is not used
10: import {VerifierParams} from "../chain-interfaces/IVerifier.sol";

//@audit `ISystemContext` is not used
12: import "../l2-deps/ISystemContext.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/DiamondInit.sol#L7-L7) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/DiamondInit.sol#L10-L10), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/DiamondInit.sol#L12-L12)


```solidity

File: contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol

//@audit `IVerifier` is not used
5: import {IVerifier, VerifierParams} from "../chain-interfaces/IVerifier.sol";

//@audit `VerifierParams` is not used
5: import {IVerifier, VerifierParams} from "../chain-interfaces/IVerifier.sol";

//@audit `PriorityQueue` is not used
6: import {PriorityQueue} from "../../state-transition/libraries/PriorityQueue.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L5-L5) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L5-L5), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L6-L6)


```solidity

File: contracts/state-transition/chain-deps/facets/Admin.sol

//@audit `IZkSyncStateTransitionBase` is not used
13: import {IZkSyncStateTransitionBase} from "../../chain-interfaces/IZkSyncStateTransitionBase.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Admin.sol#L13-L13) 


```solidity

File: contracts/state-transition/chain-deps/facets/Executor.sol

//@audit `IZkSyncStateTransitionBase` is not used
17: import {IZkSyncStateTransitionBase} from "../../chain-interfaces/IZkSyncStateTransitionBase.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L17-L17) 


```solidity

File: contracts/state-transition/chain-deps/facets/Getters.sol

//@audit `IZkSyncStateTransitionBase` is not used
15: import {IZkSyncStateTransitionBase} from "../../chain-interfaces/IZkSyncStateTransitionBase.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L15-L15) 


```solidity

File: contracts/state-transition/chain-deps/facets/Mailbox.sol

//@audit `UnsafeBytes` is not used
14: import {UnsafeBytes} from "../../../common/libraries/UnsafeBytes.sol";

//@audit `L2_BASE_TOKEN_SYSTEM_CONTRACT_ADDR` is not used
19: import {L2_BOOTLOADER_ADDRESS, L2_TO_L1_MESSENGER_SYSTEM_CONTRACT_ADDR, L2_BASE_TOKEN_SYSTEM_CONTRACT_ADDR} from "../../../common/L2ContractAddresses.sol";

//@audit `IBridgehub` is not used
21: import {IBridgehub} from "../../../bridgehub/IBridgehub.sol";

//@audit `IZkSyncStateTransitionBase` is not used
25: import {IZkSyncStateTransitionBase} from "../../chain-interfaces/IZkSyncStateTransitionBase.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L14-L14) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L19-L19), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L21-L21), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L25-L25)


```solidity

File: contracts/upgrades/BaseZkSyncUpgrade.sol

//@audit `IMailbox` is not used
6: import {IMailbox} from "../state-transition/chain-interfaces/IMailbox.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgrade.sol#L6-L6) 


```solidity

File: contracts/upgrades/BaseZkSyncUpgradeGenesis.sol

//@audit `ZkSyncStateTransitionBase` is not used
5: import "../state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol";

//@audit `IMailbox` is not used
6: import "../state-transition/chain-interfaces/IMailbox.sol";

//@audit `IVerifier` is not used
7: import "../state-transition/chain-interfaces/IVerifier.sol";

//@audit `L2ContractHelper` is not used
8: import "../common/libraries/L2ContractHelper.sol";

//@audit `Messaging` is not used
9: import "../common/Messaging.sol";

//@audit `TransactionValidator` is not used
10: import "../state-transition/libraries/TransactionValidator.sol";

//@audit `MAX_NEW_FACTORY_DEPS` is not used
11: import {MAX_NEW_FACTORY_DEPS, SYSTEM_UPGRADE_L2_TX_TYPE, MAX_ALLOWED_PROTOCOL_VERSION_DELTA} from "../common/Config.sol";

//@audit `SYSTEM_UPGRADE_L2_TX_TYPE` is not used
11: import {MAX_NEW_FACTORY_DEPS, SYSTEM_UPGRADE_L2_TX_TYPE, MAX_ALLOWED_PROTOCOL_VERSION_DELTA} from "../common/Config.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L5-L5) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L6-L6), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L7-L7), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L8-L8), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L9-L9), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L10-L10), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L11-L11), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L11-L11)


```solidity

File: contracts/upgrades/GenesisUpgrade.sol

//@audit `IDefaultUpgrade` is not used
7: import "./IDefaultUpgrade.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/GenesisUpgrade.sol#L7-L7) 


```solidity

File: contracts/bridgehub/IBridgehub.sol

//@audit `Messaging` is not used
6: import "../common/Messaging.sol";

//@audit `IStateTransitionManager` is not used
7: import "../state-transition/IStateTransitionManager.sol";

//@audit `Diamond` is not used
8: import "../state-transition/libraries/Diamond.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L6-L6) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L7-L7), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L8-L8)


```solidity

File: contracts/state-transition/chain-interfaces/IDiamondInit.sol

//@audit `L2CanonicalTransaction` is not used
5: import {L2CanonicalTransaction} from "../../common/Messaging.sol";

//@audit `IVerifier` is not used
6: import {IVerifier, VerifierParams} from "./IVerifier.sol";

//@audit `VerifierParams` is not used
6: import {IVerifier, VerifierParams} from "./IVerifier.sol";

//@audit `FeeParams` is not used
7: import {FeeParams} from "../chain-deps/ZkSyncStateTransitionStorage.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IDiamondInit.sol#L5-L5) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IDiamondInit.sol#L6-L6), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IDiamondInit.sol#L6-L6), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IDiamondInit.sol#L7-L7)


```solidity

File: contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol

//@audit `Verifier` is not used
9: import {Verifier} from "../Verifier.sol";

//@audit `VerifierParams` is not used
10: import {VerifierParams} from "./IVerifier.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol#L9-L9) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol#L10-L10)


```solidity

File: contracts/bridge/L2SharedBridge.sol

//@audit `L2_BASE_TOKEN_ADDRESS` is not used
15: import {L2ContractHelper, DEPLOYER_SYSTEM_CONTRACT, L2_BASE_TOKEN_ADDRESS, IContractDeployer} from "../L2ContractHelper.sol";

//@audit `ERA_WETH_ADDRESS` is not used
17: import {ERA_CHAIN_ID, ERA_WETH_ADDRESS} from "../Config.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L15-L15) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L17-L17)


```solidity

File: contracts/interfaces/IPaymaster.sol

//@audit `L2ContractHelper` is not used
5: import "../L2ContractHelper.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/interfaces/IPaymaster.sol#L5-L5) 


</details>


### [NC&#x2011;73] Unused `internal`/`private` contract variable 
If these serve no purpose, they should be safely removed


*There are 3 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/bridge/L1ERC20Bridge.sol

//@audit the variable `__DEPRECATED_lastWithdrawalLimitReset` is declared but never used
45:     mapping(address => uint256) private __DEPRECATED_lastWithdrawalLimitReset;

//@audit the variable `__DEPRECATED_withdrawnAmountInWindow` is declared but never used
48:     mapping(address => uint256) private __DEPRECATED_withdrawnAmountInWindow;

//@audit the variable `__DEPRECATED_totalDepositedAmountPerUser` is declared but never used
51:     mapping(address => mapping(address => uint256)) private __DEPRECATED_totalDepositedAmountPerUser;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1ERC20Bridge.sol#L45-L45) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1ERC20Bridge.sol#L48-L48), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1ERC20Bridge.sol#L51-L51)


</details>


### [NC&#x2011;74] Unused `struct` definition 
Note that there may be cases where a struct superficially appears to be used, but this is only because there are multiple definitions of the struct in different files. In such cases, the struct definition should be moved into a separate file. The instances below are the unused definitions.


*There are 1 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/state-transition/chain-interfaces/IDiamondInit.sol

51: struct InitializeDataNewChain {
52:     IVerifier verifier;
53:     VerifierParams verifierParams;
54:     bytes32 l2BootloaderBytecodeHash;
55:     bytes32 l2DefaultAccountBytecodeHash;
56:     uint256 priorityTxMaxGasLimit;
57:     FeeParams feeParams;
58:     address blobVersionedHashRetriever;
59: }


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IDiamondInit.sol#L51-L59) 


</details>


### [NC&#x2011;75] Missing upgradability functionality 
At the begining of a project, there is always the need to modify of add something to the source code especialy if any vulnerability is discovered. Therefore, having such system is crusial at least at the first stages of the project


*There are 42 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/AccountCodeStorage.sol

22: contract AccountCodeStorage is IAccountCodeStorage {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/AccountCodeStorage.sol#L22-L22) 


```solidity

File: contracts/BootloaderUtilities.sol

16: contract BootloaderUtilities is IBootloaderUtilities {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L16-L16) 


```solidity

File: contracts/ComplexUpgrader.sol

14: contract ComplexUpgrader is IComplexUpgrader {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ComplexUpgrader.sol#L14-L14) 


```solidity

File: contracts/Compressor.sol

22: contract Compressor is ICompressor, ISystemContract {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Compressor.sol#L22-L22) 


```solidity

File: contracts/ContractDeployer.sol

23: contract ContractDeployer is IContractDeployer, ISystemContract {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L23-L23) 


```solidity

File: contracts/DefaultAccount.sol

19: contract DefaultAccount is IAccount {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/DefaultAccount.sol#L19-L19) 


```solidity

File: contracts/EmptyContract.sol

10: contract EmptyContract {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/EmptyContract.sol#L10-L10) 


```solidity

File: contracts/ImmutableSimulator.sol

18: contract ImmutableSimulator is IImmutableSimulator {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ImmutableSimulator.sol#L18-L18) 


```solidity

File: contracts/KnownCodesStorage.sol

18: contract KnownCodesStorage is IKnownCodesStorage, ISystemContract {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/KnownCodesStorage.sol#L18-L18) 


```solidity

File: contracts/L1Messenger.sol

25: contract L1Messenger is IL1Messenger, ISystemContract {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L25-L25) 


```solidity

File: contracts/L2BaseToken.sol

18: contract L2BaseToken is IBaseToken, ISystemContract {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L2BaseToken.sol#L18-L18) 


```solidity

File: contracts/MsgValueSimulator.sol

19: contract MsgValueSimulator is ISystemContract {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/MsgValueSimulator.sol#L19-L19) 


```solidity

File: contracts/NonceHolder.sol

27: contract NonceHolder is INonceHolder, ISystemContract {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/NonceHolder.sol#L27-L27) 


```solidity

File: contracts/PubdataChunkPublisher.sol

16: contract PubdataChunkPublisher is IPubdataChunkPublisher, ISystemContract {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/PubdataChunkPublisher.sol#L16-L16) 


```solidity

File: contracts/SystemContext.sol

17: contract SystemContext is ISystemContext, ISystemContextDeprecated, ISystemContract {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L17-L17) 


```solidity

File: contracts/libraries/EfficientCall.sol

32: library EfficientCall {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L32-L32) 


```solidity

File: contracts/libraries/RLPEncoder.sol

10: library RLPEncoder {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/RLPEncoder.sol#L10-L10) 


```solidity

File: contracts/libraries/SystemContractHelper.sol

41: library SystemContractHelper {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L41-L41) 


```solidity

File: contracts/libraries/SystemContractsCaller.sol

68: library SystemContractsCaller {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractsCaller.sol#L68-L68) 


```solidity

File: contracts/libraries/TransactionHelper.sol

78: library TransactionHelper {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L78-L78) 


```solidity

File: contracts/libraries/UnsafeBytesCalldata.sol

18: library UnsafeBytesCalldata {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/UnsafeBytesCalldata.sol#L18-L18) 


```solidity

File: contracts/libraries/Utils.sol

11: library Utils {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L11-L11) 


```solidity

File: contracts/interfaces/IAccount.sol

9: interface IAccount {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IAccount.sol#L9-L9) 


```solidity

File: contracts/interfaces/IAccountCodeStorage.sol

5: interface IAccountCodeStorage {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IAccountCodeStorage.sol#L5-L5) 


```solidity

File: contracts/interfaces/IBaseToken.sol

5: interface IBaseToken {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IBaseToken.sol#L5-L5) 


```solidity

File: contracts/interfaces/IBootloaderUtilities.sol

7: interface IBootloaderUtilities {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IBootloaderUtilities.sol#L7-L7) 


```solidity

File: contracts/interfaces/IComplexUpgrader.sol

10: interface IComplexUpgrader {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IComplexUpgrader.sol#L10-L10) 


```solidity

File: contracts/interfaces/ICompressor.sol

18: interface ICompressor {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ICompressor.sol#L18-L18) 


```solidity

File: contracts/interfaces/IContractDeployer.sol

5: interface IContractDeployer {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IContractDeployer.sol#L5-L5) 


```solidity

File: contracts/interfaces/IImmutableSimulator.sol

10: interface IImmutableSimulator {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IImmutableSimulator.sol#L10-L10) 


```solidity

File: contracts/interfaces/IKnownCodesStorage.sol

11: interface IKnownCodesStorage {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IKnownCodesStorage.sol#L11-L11) 


```solidity

File: contracts/interfaces/IL1Messenger.sol

40: interface IL1Messenger {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IL1Messenger.sol#L40-L40) 


```solidity

File: contracts/interfaces/IL2StandardToken.sol

5: interface IL2StandardToken {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IL2StandardToken.sol#L5-L5) 


```solidity

File: contracts/interfaces/IMailbox.sol

5: interface IMailbox {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IMailbox.sol#L5-L5) 


```solidity

File: contracts/interfaces/INonceHolder.sol

13: interface INonceHolder {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/INonceHolder.sol#L13-L13) 


```solidity

File: contracts/interfaces/IPaymaster.sol

14: interface IPaymaster {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IPaymaster.sol#L14-L14) 


```solidity

File: contracts/interfaces/IPaymasterFlow.sol

12: interface IPaymasterFlow {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IPaymasterFlow.sol#L12-L12) 


```solidity

File: contracts/interfaces/IPubdataChunkPublisher.sol

9: interface IPubdataChunkPublisher {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IPubdataChunkPublisher.sol#L9-L9) 


```solidity

File: contracts/interfaces/ISystemContext.sol

11: interface ISystemContext {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ISystemContext.sol#L11-L11) 


```solidity

File: contracts/interfaces/ISystemContextDeprecated.sol

10: interface ISystemContextDeprecated {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ISystemContextDeprecated.sol#L10-L10) 


```solidity

File: contracts/interfaces/ISystemContract.sol

17: abstract contract ISystemContract {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ISystemContract.sol#L17-L17) 


```solidity

File: contracts/bridge/L1ERC20Bridge.sol

19: contract L1ERC20Bridge is IL1ERC20Bridge, ReentrancyGuard {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1ERC20Bridge.sol#L19-L19) 


</details>


### [NC&#x2011;76] Cast to `bytes` or `bytes32` for clearer semantic meaning 
Using a [cast](https://ethereum.stackexchange.com/questions/30912/how-to-compare-strings-in-solidity#answer-82739) on a single argument, rather than `abi.encodePacked()` makes the intended operation more clear, leading to less reviewer confusion.


*There are 2 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/SystemContext.sol

234:         return keccak256(abi.encodePacked(uint32(_blockNumber)));


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L234-L234) 


```solidity

File: contracts/libraries/TransactionHelper.sol

133:                 keccak256(abi.encodePacked(_transaction.factoryDeps)),


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L133-L133) 


</details>


### [NC&#x2011;77] Use `bytes.concat()` on bytes instead of `abi.encodePacked()` for clearer semantic meaning 
Starting with version 0.8.4, Solidity has the `bytes.concat()` function, which allows one to concatenate a list of bytes/strings, without extra padding. Using this function rather than `abi.encodePacked()` makes the intended operation more clear, leading to less reviewer confusion.


*There are 9 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/L1Messenger.sol

96:             abi.encodePacked(


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L96-L96) 


```solidity

File: contracts/libraries/TransactionHelper.sol

142:         return keccak256(abi.encodePacked("\x19\x01", domainSeparator, structHash));


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L142-L142) 


```solidity

File: contracts/state-transition/chain-deps/facets/Executor.sol

517:             abi.encodePacked(

528:             abi.encodePacked(

548:             abi.encodePacked(

610:         bytes memory precompileInput = abi.encodePacked(_versionedHash, _openingPoint, _openingValueCommitmentProof);

461:                     abi.encodePacked(

655:                 abi.encodePacked(blobVersionedHash, _pubdataCommitments[i:i + PUBDATA_COMMITMENT_COMMITMENT_OFFSET])


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L517-L517) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L528-L528), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L548-L548), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L610-L610), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L461-L461), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L655-L655)


```solidity

File: contracts/state-transition/chain-deps/facets/Mailbox.sol

113:             abi.encodePacked(_log.l2ShardId, _log.isService, _log.txNumberInBatch, _log.sender, _log.key, _log.value)


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L113-L113) 


</details>


### [NC&#x2011;78] Constants should be defined rather than using magic numbers 
Even [assembly](https://github.com/code-423n4/2022-05-opensea-seaport/blob/9d7ce4d08bf3c3010304a0476a785c70c0e90ae7/contracts/lib/TokenTransferrer.sol#L35-L39) can benefit from using readable constants instead of hex/numeric literals


*There are 172 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/BootloaderUtilities.sol

//@audit Try to make a `constant` with `0x80` value
72:             } else if (_transaction.data[0] >= 0x80) {

//@audit Try to make a `constant` with `32` value
81:             uint256 rInt = uint256(bytes32(_transaction.signature[0:32]));

//@audit Try to make a `constant` with `64` value
86:             uint256 sInt = uint256(bytes32(_transaction.signature[32:64]));

//@audit Try to make a `constant` with `32` value
86:             uint256 sInt = uint256(bytes32(_transaction.signature[32:64]));

//@audit Try to make a `constant` with `27` value
92:             require(vInt == 27 || vInt == 28, "Invalid v value");

//@audit Try to make a `constant` with `28` value
92:             require(vInt == 27 || vInt == 28, "Invalid v value");

//@audit Try to make a `constant` with `8` value
97:                 vInt += 8 + block.chainid * 2;

//@audit Try to make a `constant` with `0x80` value
168:             } else if (_transaction.data[0] >= 0x80) {

//@audit Try to make a `constant` with `32` value
180:             uint256 rInt = uint256(bytes32(_transaction.signature[0:32]));

//@audit Try to make a `constant` with `64` value
185:             uint256 sInt = uint256(bytes32(_transaction.signature[32:64]));

//@audit Try to make a `constant` with `32` value
185:             uint256 sInt = uint256(bytes32(_transaction.signature[32:64]));

//@audit Try to make a `constant` with `27` value
191:             require(vInt == 27 || vInt == 28, "Invalid v value");

//@audit Try to make a `constant` with `28` value
191:             require(vInt == 27 || vInt == 28, "Invalid v value");

//@audit Try to make a `constant` with `27` value
193:             vEncoded = RLPEncoder.encodeUint256(vInt - 27);

//@audit Try to make a `constant` with `0x80` value
263:             } else if (_transaction.data[0] >= 0x80) {

//@audit Try to make a `constant` with `32` value
275:             uint256 rInt = uint256(bytes32(_transaction.signature[0:32]));

//@audit Try to make a `constant` with `64` value
280:             uint256 sInt = uint256(bytes32(_transaction.signature[32:64]));

//@audit Try to make a `constant` with `32` value
280:             uint256 sInt = uint256(bytes32(_transaction.signature[32:64]));

//@audit Try to make a `constant` with `27` value
286:             require(vInt == 27 || vInt == 28, "Invalid v value");

//@audit Try to make a `constant` with `28` value
286:             require(vInt == 27 || vInt == 28, "Invalid v value");

//@audit Try to make a `constant` with `27` value
288:             vEncoded = RLPEncoder.encodeUint256(vInt - 27);


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L72-L72) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L81-L81), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L86-L86), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L86-L86), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L92-L92), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L92-L92), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L97-L97), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L168-L168), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L180-L180), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L185-L185), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L185-L185), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L191-L191), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L191-L191), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L193-L193), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L263-L263), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L275-L275), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L280-L280), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L280-L280), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L286-L286), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L286-L286), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L288-L288)


```solidity

File: contracts/Compressor.sol

//@audit Try to make a `constant` with `4` value
52:                 encodedData.length * 4 == _bytecode.length,

//@audit Try to make a `constant` with `8` value
57:                 dictionary.length / 8 <= encodedData.length / 2,

//@audit Try to make a `constant` with `8` value
62:                 uint256 indexOfEncodedChunk = uint256(encodedData.readUint16(encodedDataPointer)) * 8;

//@audit Try to make a `constant` with `4` value
66:                 uint64 realChunk = _bytecode.readUint64(encodedDataPointer * 4);

//@audit Try to make a `constant` with `84` value
129:             uint64 enumIndex = stateDiff.readUint64(84);

//@audit Try to make a `constant` with `52` value
137:             bytes32 derivedKey = stateDiff.readBytes32(52);

//@audit Try to make a `constant` with `92` value
138:             uint256 initValue = stateDiff.readUint256(92);

//@audit Try to make a `constant` with `124` value
139:             uint256 finalValue = stateDiff.readUint256(124);

//@audit Try to make a `constant` with `32` value
141:             stateDiffPtr += 32;

//@audit Try to make a `constant` with `32` value
146:             uint8 len = operation == 0 ? 32 : metadata >> LENGTH_BITS_OFFSET;

//@audit Try to make a `constant` with `84` value
161:             uint64 enumIndex = stateDiff.readUint64(84);

//@audit Try to make a `constant` with `92` value
166:             uint256 initValue = stateDiff.readUint256(92);

//@audit Try to make a `constant` with `124` value
167:             uint256 finalValue = stateDiff.readUint256(124);

//@audit Try to make a `constant` with `32` value
177:             uint8 len = operation == 0 ? 32 : metadata >> LENGTH_BITS_OFFSET;

//@audit Try to make a `constant` with `8` value
203:             dictionary = _rawCompressedData[2:2 + dictionaryLen * 8];

//@audit Try to make a `constant` with `8` value
204:             encodedData = _rawCompressedData[2 + dictionaryLen * 8:];

//@audit Try to make a `constant` with `3` value
229:             if (_operation == 0 || _operation == 3) {

//@audit Try to make a `constant` with `256` value
253:         number >>= (256 - (_calldataSlice.length * 8));

//@audit Try to make a `constant` with `8` value
253:         number >>= (256 - (_calldataSlice.length * 8));


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Compressor.sol#L52-L52) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Compressor.sol#L57-L57), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Compressor.sol#L62-L62), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Compressor.sol#L66-L66), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Compressor.sol#L129-L129), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Compressor.sol#L137-L137), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Compressor.sol#L138-L138), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Compressor.sol#L139-L139), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Compressor.sol#L141-L141), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Compressor.sol#L146-L146), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Compressor.sol#L161-L161), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Compressor.sol#L166-L166), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Compressor.sol#L167-L167), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Compressor.sol#L177-L177), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Compressor.sol#L203-L203), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Compressor.sol#L204-L204), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Compressor.sol#L229-L229), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Compressor.sol#L253-L253), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Compressor.sol#L253-L253)


```solidity

File: contracts/DefaultAccount.sol

//@audit Try to make a `constant` with `4` value
139:         if (to == address(DEPLOYER_SYSTEM_CONTRACT) && data.length >= 4) {

//@audit Try to make a `constant` with `4` value
140:             bytes4 selector = bytes4(data[:4]);

//@audit Try to make a `constant` with `65` value
160:         require(_signature.length == 65, "Signature length is incorrect");

//@audit Try to make a `constant` with `0x7FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF5D576E7357A4501DDFE92F46681B20A0` value
184:         require(uint256(s) <= 0x7FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF5D576E7357A4501DDFE92F46681B20A0, "Invalid s");

//@audit Try to make a `constant` with `27` value
173:         require(v == 27 || v == 28, "v is neither 27 nor 28");

//@audit Try to make a `constant` with `28` value
173:         require(v == 27 || v == 28, "v is neither 27 nor 28");


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/DefaultAccount.sol#L139-L139) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/DefaultAccount.sol#L140-L140), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/DefaultAccount.sol#L160-L160), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/DefaultAccount.sol#L184-L184), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/DefaultAccount.sol#L173-L173), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/DefaultAccount.sol#L173-L173)


```solidity

File: contracts/L1Messenger.sol

//@audit Try to make a `constant` with `8` value
62:         return SHA256_ROUND_GAS_COST * ((_length + 8) / SHA256_ROUND_NUMBER_OF_BYTES + 1);

//@audit Try to make a `constant` with `64` value
89:         uint256 gasToPay = keccakGasCost(L2_TO_L1_LOG_SERIALIZE_SIZE) + 2 * keccakGasCost(64);

//@audit Try to make a `constant` with `4` value
140:             pubdataLen = 4 + _message.length + L2_TO_L1_LOG_SERIALIZE_SIZE;

//@audit Try to make a `constant` with `3` value
149:             3 *

//@audit Try to make a `constant` with `64` value
150:             keccakGasCost(64) +

//@audit Try to make a `constant` with `4` value
171:             pubdataLen = 4 + bytecodeLen;

//@audit Try to make a `constant` with `64` value
176:             keccakGasCost(64) +

//@audit Try to make a `constant` with `4` value
202:         calldataPtr += 4;

//@audit Try to make a `constant` with `4` value
234:         calldataPtr += 4;

//@audit Try to make a `constant` with `4` value
252:         calldataPtr += 4;

//@audit Try to make a `constant` with `3` value
287:         calldataPtr += 3;

//@audit Try to make a `constant` with `4` value
301:         calldataPtr += 4;

//@audit Try to make a `constant` with `4` value
238:             calldataPtr += 4;

//@audit Try to make a `constant` with `4` value
258:             calldataPtr += 4;

//@audit Try to make a `constant` with `4` value
200:         uint32 numberOfL2ToL1Logs = uint32(bytes4(_totalL2ToL1PubdataAndStateDiffs[calldataPtr:calldataPtr + 4]));

//@audit Try to make a `constant` with `4` value
233:         uint32 numberOfMessages = uint32(bytes4(_totalL2ToL1PubdataAndStateDiffs[calldataPtr:calldataPtr + 4]));

//@audit Try to make a `constant` with `4` value
251:         uint32 numberOfBytecodes = uint32(bytes4(_totalL2ToL1PubdataAndStateDiffs[calldataPtr:calldataPtr + 4]));

//@audit Try to make a `constant` with `3` value
286:         uint24 compressedStateDiffSize = uint24(bytes3(_totalL2ToL1PubdataAndStateDiffs[calldataPtr:calldataPtr + 3]));

//@audit Try to make a `constant` with `4` value
300:         uint32 numberOfStateDiffs = uint32(bytes4(_totalL2ToL1PubdataAndStateDiffs[calldataPtr:calldataPtr + 4]));

//@audit Try to make a `constant` with `4` value
237:             uint32 currentMessageLength = uint32(bytes4(_totalL2ToL1PubdataAndStateDiffs[calldataPtr:calldataPtr + 4]));

//@audit Try to make a `constant` with `4` value
256:                 bytes4(_totalL2ToL1PubdataAndStateDiffs[calldataPtr:calldataPtr + 4])


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L62-L62) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L89-L89), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L140-L140), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L149-L149), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L150-L150), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L171-L171), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L176-L176), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L202-L202), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L234-L234), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L252-L252), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L287-L287), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L301-L301), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L238-L238), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L258-L258), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L200-L200), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L233-L233), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L251-L251), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L286-L286), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L300-L300), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L237-L237), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L256-L256)


```solidity

File: contracts/L2BaseToken.sol

//@audit Try to make a `constant` with `18` value
141:         return 18;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L2BaseToken.sol#L141-L141) 


```solidity

File: contracts/SystemContext.sol

//@audit Try to make a `constant` with `256` value
144:         if (blockNumber <= _block || blockNumber - _block > 256) {

//@audit Try to make a `constant` with `128` value
416:         uint256 packedTimestamps = (uint256(currentBatchTimestamp) << 128) | currentL2BlockTimestamp;

//@audit Try to make a `constant` with `128` value
498:         blockInfo = (uint256(blockNumber) << 128) | uint256(blockTimestamp);


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L144-L144) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L416-L416), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L498-L498)


```solidity

File: contracts/libraries/EfficientCall.sol

//@audit Try to make a `constant` with `32` value
38:         require(returnData.length == 32, "keccak256 returned invalid data");

//@audit Try to make a `constant` with `32` value
47:         require(returnData.length == 32, "sha returned invalid data");


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L38-L38) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L47-L47)


```solidity

File: contracts/libraries/RLPEncoder.sol

//@audit Try to make a `constant` with `0x15` value
13:         encoded = new bytes(0x15);

//@audit Try to make a `constant` with `128` value
26:             if (_val < 128) {

//@audit Try to make a `constant` with `31` value
36:                 uint256 lbs = 31 - hbs;

//@audit Try to make a `constant` with `8` value
37:                 uint256 shiftedVal = _val << (lbs * 8);

//@audit Try to make a `constant` with `0x81` value
34:                 encoded[0] = bytes1(uint8(hbs + 0x81));

//@audit Try to make a `constant` with `128` value
29:                 encoded[0] = (_val == 0) ? bytes1(uint8(128)) : bytes1(uint8(_val));

//@audit Try to make a `constant` with `0x80` value
51:         return _encodeLength(_len, 0x80);

//@audit Try to make a `constant` with `0xc0` value
57:         return _encodeLength(_len, 0xc0);

//@audit Try to make a `constant` with `56` value
62:             if (_len < 56) {

//@audit Try to make a `constant` with `31` value
71:                 uint256 lbs = 31 - hbs;

//@audit Try to make a `constant` with `8` value
72:                 uint256 shiftedVal = uint256(_len) << (lbs * 8);

//@audit Try to make a `constant` with `56` value
69:                 encoded[0] = bytes1(uint8(_offset + hbs + 56));

//@audit Try to make a `constant` with `128` value
87:                 _number >>= 128;

//@audit Try to make a `constant` with `16` value
88:                 hbs += 16;

//@audit Try to make a `constant` with `64` value
91:                 _number >>= 64;

//@audit Try to make a `constant` with `8` value
92:                 hbs += 8;

//@audit Try to make a `constant` with `32` value
95:                 _number >>= 32;

//@audit Try to make a `constant` with `4` value
96:                 hbs += 4;

//@audit Try to make a `constant` with `16` value
99:                 _number >>= 16;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/RLPEncoder.sol#L13-L13) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/RLPEncoder.sol#L26-L26), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/RLPEncoder.sol#L36-L36), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/RLPEncoder.sol#L37-L37), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/RLPEncoder.sol#L34-L34), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/RLPEncoder.sol#L29-L29), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/RLPEncoder.sol#L51-L51), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/RLPEncoder.sol#L57-L57), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/RLPEncoder.sol#L62-L62), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/RLPEncoder.sol#L71-L71), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/RLPEncoder.sol#L72-L72), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/RLPEncoder.sol#L69-L69), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/RLPEncoder.sol#L87-L87), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/RLPEncoder.sol#L88-L88), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/RLPEncoder.sol#L91-L91), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/RLPEncoder.sol#L92-L92), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/RLPEncoder.sol#L95-L95), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/RLPEncoder.sol#L96-L96), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/RLPEncoder.sol#L99-L99)


```solidity

File: contracts/libraries/SystemContractHelper.sol

//@audit Try to make a `constant` with `32` value
132:         rawParams |= uint256(_inputMemoryLength) << 32;

//@audit Try to make a `constant` with `64` value
133:         rawParams |= uint256(_outputMemoryOffset) << 64;

//@audit Try to make a `constant` with `96` value
134:         rawParams |= uint256(_outputMemoryLength) << 96;

//@audit Try to make a `constant` with `192` value
135:         rawParams |= uint256(_perPrecompileInterpreted) << 192;

//@audit Try to make a `constant` with `32` value
155:         uint256 params = uint256(_gasToBurn) + (uint256(_pubdataToSpend) << 32);

//@audit Try to make a `constant` with `256` value
217:         uint256 shifted = (meta << (256 - size - offset));

//@audit Try to make a `constant` with `256` value
219:         result = (shifted >> (256 - size));

//@audit Try to make a `constant` with `32` value
228:         pubdataPublished = uint32(extractNumberFromMeta(meta, META_GAS_PER_PUBDATA_BYTE_OFFSET, 32));

//@audit Try to make a `constant` with `32` value
238:         heapSize = uint32(extractNumberFromMeta(meta, META_HEAP_SIZE_OFFSET, 32));

//@audit Try to make a `constant` with `32` value
247:         auxHeapSize = uint32(extractNumberFromMeta(meta, META_AUX_HEAP_SIZE_OFFSET, 32));

//@audit Try to make a `constant` with `8` value
255:         shardId = uint8(extractNumberFromMeta(meta, META_SHARD_ID_OFFSET, 8));

//@audit Try to make a `constant` with `8` value
264:         callerShardId = uint8(extractNumberFromMeta(meta, META_CALLER_SHARD_ID_OFFSET, 8));

//@audit Try to make a `constant` with `8` value
273:         codeShardId = uint8(extractNumberFromMeta(meta, META_CODE_SHARD_ID_OFFSET, 8));

//@audit Try to make a `constant` with `10` value
319:         require(index < 10, "There are only 10 accessible registers");


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L132-L132) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L133-L133), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L134-L134), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L135-L135), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L155-L155), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L217-L217), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L219-L219), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L228-L228), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L238-L238), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L247-L247), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L255-L255), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L264-L264), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L273-L273), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L319-L319)


```solidity

File: contracts/libraries/SystemContractsCaller.sol

//@audit Try to make a `constant` with `32` value
235:         farCallAbi |= (uint256(memoryPage) << 32);

//@audit Try to make a `constant` with `64` value
236:         farCallAbi |= (uint256(dataStart) << 64);

//@audit Try to make a `constant` with `96` value
237:         farCallAbi |= (uint256(dataLength) << 96);

//@audit Try to make a `constant` with `192` value
257:         farCallAbiWithEmptyFatPtr |= (uint256(gasPassed) << 192);

//@audit Try to make a `constant` with `224` value
258:         farCallAbiWithEmptyFatPtr |= (uint256(forwardingMode) << 224);

//@audit Try to make a `constant` with `232` value
259:         farCallAbiWithEmptyFatPtr |= (uint256(shardId) << 232);

//@audit Try to make a `constant` with `240` value
261:             farCallAbiWithEmptyFatPtr |= (1 << 240);

//@audit Try to make a `constant` with `248` value
264:             farCallAbiWithEmptyFatPtr |= (1 << 248);


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractsCaller.sol#L235-L235) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractsCaller.sol#L236-L236), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractsCaller.sol#L237-L237), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractsCaller.sol#L257-L257), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractsCaller.sol#L258-L258), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractsCaller.sol#L259-L259), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractsCaller.sol#L261-L261), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractsCaller.sol#L264-L264)


```solidity

File: contracts/libraries/TransactionHelper.sol

//@audit Try to make a `constant` with `0x80` value
175:             } else if (_transaction.data[0] >= 0x80) {

//@audit Try to make a `constant` with `0x80` value
253:             } else if (_transaction.data[0] >= 0x80) {

//@audit Try to make a `constant` with `0x80` value
325:             } else if (_transaction.data[0] >= 0x80) {

//@audit Try to make a `constant` with `4` value
363:         require(_transaction.paymasterInput.length >= 4, "The standard paymaster input must be at least 4 bytes long");

//@audit Try to make a `constant` with `4` value
365:         bytes4 paymasterInputSelector = bytes4(_transaction.paymasterInput[0:4]);

//@audit Try to make a `constant` with `68` value
368:                 _transaction.paymasterInput.length >= 68,

//@audit Try to make a `constant` with `68` value
374:             (address token, uint256 minAllowance) = abi.decode(_transaction.paymasterInput[4:68], (address, uint256));

//@audit Try to make a `constant` with `4` value
374:             (address token, uint256 minAllowance) = abi.decode(_transaction.paymasterInput[4:68], (address, uint256));


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L175-L175) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L253-L253), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L325-L325), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L363-L363), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L365-L365), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L368-L368), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L374-L374), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L374-L374)


```solidity

File: contracts/libraries/Utils.sol

//@audit Try to make a `constant` with `5` value
40:         codeLength = bytecodeLenInWords(_bytecodeHash) << 5; // _bytecodeHash * 32

//@audit Try to make a `constant` with `256` value
46:             codeLengthInWords = uint256(uint8(_bytecodeHash[2])) * 256 + uint256(uint8(_bytecodeHash[3]));

//@audit Try to make a `constant` with `32` value
86:         uint256 lengthInWords = _bytecode.length / 32;

//@audit Try to make a `constant` with `0x00000000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF` value
91:             0x00000000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF;

//@audit Try to make a `constant` with `32` value
84:         require(_bytecode.length % 32 == 0, "po");

//@audit Try to make a `constant` with `16` value
87:         require(lengthInWords < 2 ** 16, "pp"); // bytecode length must be less than 2^16 words

//@audit Try to make a `constant` with `224` value
95:         hashedBytecode = hashedBytecode | bytes32(lengthInWords << 224);

//@audit Try to make a `constant` with `248` value
93:         hashedBytecode = (hashedBytecode | bytes32(uint256(1 << 248)));


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L40-L40) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L46-L46), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L86-L86), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L91-L91), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L84-L84), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L87-L87), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L95-L95), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L93-L93)


```solidity

File: contracts/bridge/L1ERC20Bridge.sol

//@audit Try to make a `constant` with `3T` value
143:         require(amount == _amount, "3T"); // The token has non-standard transfer logic


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1ERC20Bridge.sol#L143-L143) 


```solidity

File: contracts/bridge/L1SharedBridge.sol

//@audit Try to make a `constant` with `3T` value
161:             require(amount == _amount, "3T"); // The token has non-standard transfer logic

//@audit Try to make a `constant` with `6T` value
208:         require(amount != 0, "6T"); // empty deposit amount

//@audit Try to make a `constant` with `5T` value
206:             require(withdrawAmount == _depositAmount, "5T"); // The token has non-standard transfer logic

//@audit Try to make a `constant` with `18` value
258:             bytes memory decimals = abi.encode(uint8(18));

//@audit Try to make a `constant` with `56` value
501:         require(_l2ToL1message.length >= 56, "ShB wrong msg len"); // wrong messsage length

//@audit Try to make a `constant` with `76` value
517:             require(_l2ToL1message.length == 76, "ShB wrong msg len 2");


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L161-L161) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L208-L208), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L206-L206), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L258-L258), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L501-L501), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L517-L517)


```solidity

File: contracts/state-transition/StateTransitionManager.sol

//@audit Try to make a `constant` with `32` value
106:         assert(L2_TO_L1_LOG_SERIALIZE_SIZE != 2 * 32);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L106-L106) 


```solidity

File: contracts/state-transition/ValidatorTimelock.sol

//@audit Try to make a `constant` with `5c` value
195:                 require(block.timestamp >= commitBatchTimestamp + delay, "5c"); // The delay is not passed

//@audit Try to make a `constant` with `5c` value
217:                 require(block.timestamp >= commitBatchTimestamp + delay, "5c"); // The delay is not passed


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L195-L195) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L217-L217)


```solidity

File: contracts/state-transition/chain-deps/DiamondInit.sol

//@audit Try to make a `constant` with `32` value
51:         assert(L2_TO_L1_LOG_SERIALIZE_SIZE != 2 * 32);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/DiamondInit.sol#L51-L51) 


```solidity

File: contracts/state-transition/chain-deps/DiamondProxy.sol

//@audit Try to make a `constant` with `4` value
25:         require(msg.data.length >= 4 || msg.data.length == 0, "Ut");


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/DiamondProxy.sol#L25-L25) 


```solidity

File: contracts/state-transition/chain-deps/facets/Executor.sol

//@audit Try to make a `constant` with `32` value
68:                 _newBatch.pubdataCommitments[_newBatch.pubdataCommitments.length - 32:_newBatch

//@audit Try to make a `constant` with `32` value
63:                     keccak256(_newBatch.pubdataCommitments[1:_newBatch.pubdataCommitments.length - 32]),

//@audit Try to make a `constant` with `128` value
109:         uint256 batchTimestamp = _packedBatchAndL2BlockTimestamp >> 128;

//@audit Try to make a `constant` with `1023` value
194:             require(processedLogs == 1023, "b8");

//@audit Try to make a `constant` with `511` value
192:             require(processedLogs == 511, "b7");


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L68-L68) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L63-L63), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L109-L109), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L194-L194), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L192-L192)


```solidity

File: contracts/common/libraries/L2ContractHelper.sol

//@audit Try to make a `constant` with `32` value
25:         uint256 bytecodeLenInWords = _bytecode.length / 32;

//@audit Try to make a `constant` with `0x00000000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF` value
28:         hashedBytecode = sha256(_bytecode) & 0x00000000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF;

//@audit Try to make a `constant` with `32` value
23:         require(_bytecode.length % 32 == 0, "pq");

//@audit Try to make a `constant` with `16` value
26:         require(bytecodeLenInWords < 2 ** 16, "pp"); // bytecode length must be less than 2^16 words

//@audit Try to make a `constant` with `224` value
32:         hashedBytecode = hashedBytecode | bytes32(bytecodeLenInWords << 224);

//@audit Try to make a `constant` with `248` value
30:         hashedBytecode = (hashedBytecode | bytes32(uint256(1 << 248)));

//@audit Try to make a `constant` with `256` value
50:         codeLengthInWords = uint256(uint8(_bytecodeHash[2])) * 256 + uint256(uint8(_bytecodeHash[3]));


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/L2ContractHelper.sol#L25-L25) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/L2ContractHelper.sol#L28-L28), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/L2ContractHelper.sol#L23-L23), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/L2ContractHelper.sol#L26-L26), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/L2ContractHelper.sol#L32-L32), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/L2ContractHelper.sol#L30-L30), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/L2ContractHelper.sol#L50-L50)


```solidity

File: contracts/state-transition/libraries/Diamond.sol

//@audit Try to make a `constant` with `32` value
297:             require(data.length == 32, "lp");

//@audit Try to make a `constant` with `4` value
286:                 if (data.length <= 4) {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L297-L297) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L286-L286)


```solidity

File: contracts/state-transition/libraries/LibMap.sol

//@audit Try to make a `constant` with `32` value
27:             uint256 bitOffset = (_index & 7) * 32;

//@audit Try to make a `constant` with `8` value
23:             uint256 mapValue = _map.map[_index / 8];

//@audit Try to make a `constant` with `7` value
27:             uint256 bitOffset = (_index & 7) * 32;

//@audit Try to make a `constant` with `8` value
43:             uint256 mapIndex = _index / 8;

//@audit Try to make a `constant` with `32` value
48:             uint256 bitOffset = (_index & 7) * 32;

//@audit Try to make a `constant` with `7` value
48:             uint256 bitOffset = (_index & 7) * 32;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/LibMap.sol#L27-L27) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/LibMap.sol#L23-L23), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/LibMap.sol#L27-L27), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/LibMap.sol#L43-L43), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/LibMap.sol#L48-L48), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/LibMap.sol#L48-L48)


```solidity

File: contracts/state-transition/libraries/Merkle.sol

//@audit Try to make a `constant` with `256` value
25:         require(pathLength < 256, "bt");


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Merkle.sol#L25-L25) 


```solidity

File: contracts/state-transition/libraries/TransactionValidator.sol

//@audit Try to make a `constant` with `544` value
83:             costForComputation += Math.ceilDiv(_encodingLength * L1_TX_DELTA_544_ENCODING_BYTES, 544);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/TransactionValidator.sol#L83-L83) 


```solidity

File: contracts/SystemContractsCaller.sol

//@audit Try to make a `constant` with `32` value
116:         farCallAbi |= (uint256(memoryPage) << 32);

//@audit Try to make a `constant` with `64` value
117:         farCallAbi |= (uint256(dataStart) << 64);

//@audit Try to make a `constant` with `96` value
118:         farCallAbi |= (uint256(dataLength) << 96);

//@audit Try to make a `constant` with `192` value
128:         farCallAbiWithEmptyFatPtr |= (uint256(gasPassed) << 192);

//@audit Try to make a `constant` with `224` value
129:         farCallAbiWithEmptyFatPtr |= (uint256(forwardingMode) << 224);

//@audit Try to make a `constant` with `232` value
130:         farCallAbiWithEmptyFatPtr |= (uint256(shardId) << 232);

//@audit Try to make a `constant` with `240` value
132:             farCallAbiWithEmptyFatPtr |= (1 << 240);

//@audit Try to make a `constant` with `248` value
135:             farCallAbiWithEmptyFatPtr |= (1 << 248);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/SystemContractsCaller.sol#L116-L116) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/SystemContractsCaller.sol#L117-L117), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/SystemContractsCaller.sol#L118-L118), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/SystemContractsCaller.sol#L128-L128), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/SystemContractsCaller.sol#L129-L129), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/SystemContractsCaller.sol#L130-L130), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/SystemContractsCaller.sol#L132-L132), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/SystemContractsCaller.sol#L135-L135)


</details>


### [NC&#x2011;79] Use the latest solidity (prior to 0.8.20 if on L2s) for deployment 
```
When deploying contracts, you should use the latest released version of Solidity.Apart from exceptional cases, only the latest version receives security fixes.
```
https://docs.soliditylang.org/en/v0.8.20/


*There are 1 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/state-transition/l2-deps/ISystemContext.sol

2: pragma solidity ^0.8.0;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/l2-deps/ISystemContext.sol#L2-L2) 


</details>


### [NC&#x2011;80] Use OpenZeppelin's `ReentrancyGuard` / `ReentrancyGuardUpgradeable` rather than writing your own 
The OpenZeppelin version has been gas-optimized, and thoroughly test, so consider using it rather than writing your own


*There are 1 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/common/ReentrancyGuard.sol

68:     modifier nonReentrant() {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/ReentrancyGuard.sol#L68-L68) 


</details>


### [NC&#x2011;81] Use a single file for system wide constants 
Consider grouping all the system constants under a single file. This finding shows only the first constant for each file.


*There are 19 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/AccountCodeStorage.sol

23:     bytes32 constant EMPTY_STRING_KECCAK = 0xc5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/AccountCodeStorage.sol#L23-L23) 


```solidity

File: contracts/L1Messenger.sol

44:     uint256 internal constant KECCAK_ROUND_GAS_COST = 40;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L44-L44) 


```solidity

File: contracts/MsgValueSimulator.sol

36:     uint256 constant GAS_TO_PASS = 2300;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/MsgValueSimulator.sol#L36-L36) 


```solidity

File: contracts/NonceHolder.sol

28:     uint256 private constant DEPLOY_NONCE_MULTIPLIER = 2 ** 128;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/NonceHolder.sol#L28-L28) 


```solidity

File: contracts/SystemContext.sol

23:     uint256 internal constant MINIBLOCK_HASHES_TO_STORE = 257;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L23-L23) 


```solidity

File: contracts/libraries/TransactionHelper.sol

82:     bytes32 constant EIP712_DOMAIN_TYPEHASH = keccak256("EIP712Domain(string name,string version,uint256 chainId)");


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L82-L82) 


```solidity

File: contracts/libraries/Utils.sol

13:     bytes32 constant IS_CONSTRUCTOR_BYTECODE_HASH_BIT_MASK =


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L13-L13) 


```solidity

File: contracts/governance/Governance.sol

22:     uint256 internal constant EXECUTED_PROPOSAL_TIMESTAMP = uint256(1);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/Governance.sol#L22-L22) 


```solidity

File: contracts/state-transition/ValidatorTimelock.sol

26:     string public constant override getName = "ValidatorTimelock";


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L26-L26) 


```solidity

File: contracts/state-transition/chain-deps/facets/Admin.sol

20:     string public constant override getName = "AdminFacet";


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Admin.sol#L20-L20) 


```solidity

File: contracts/state-transition/chain-deps/facets/Executor.sol

27:     string public constant override getName = "ExecutorFacet";


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L27-L27) 


```solidity

File: contracts/state-transition/chain-deps/facets/Getters.sol

25:     string public constant override getName = "GettersFacet";


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L25-L25) 


```solidity

File: contracts/state-transition/chain-deps/facets/Mailbox.sol

35:     string public constant override getName = "MailboxFacet";


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L35-L35) 


```solidity

File: contracts/common/libraries/L2ContractHelper.sol

12:     bytes32 private constant CREATE2_PREFIX = keccak256("zksyncCreate2");


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/L2ContractHelper.sol#L12-L12) 


```solidity

File: contracts/state-transition/libraries/Diamond.sol

17:     bytes32 internal constant DIAMOND_INIT_SUCCESS_RETURN_VALUE =


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L17-L17) 


```solidity

File: contracts/common/ReentrancyGuard.sol

29:     uint256 private constant LOCK_FLAG_ADDRESS = 0x8e94fed44239eb2314ab7a406345e6c5a8f0ccedf3b600de3d004e672c33abf4;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/ReentrancyGuard.sol#L29-L29) 


```solidity

File: contracts/vendor/AddressAliasHelper.sol

22:     uint160 constant offset = uint160(0x1111000000000000000000000000000000001111);

22:     uint160 constant offset = uint160(0x1111000000000000000000000000000000001111);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/vendor/AddressAliasHelper.sol#L22-L22) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/vendor/AddressAliasHelper.sol#L22-L22)


```solidity

File: contracts/L2ContractHelper.sol

85:     bytes32 private constant CREATE2_PREFIX = keccak256("zksyncCreate2");


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/L2ContractHelper.sol#L85-L85) 


</details>


### [NC&#x2011;82] Consider using SMTChecker 
The SMTChecker is a valuable tool for Solidity developers as it helps detect potential vulnerabilities and logical errors in the contract's code. By utilizing Satisfiability Modulo Theories (SMT) solvers, it can reason about the potential states a contract can be in, and therefore, identify conditions that could lead to undesirable behavior. This automatic formal verification can catch issues that might otherwise be missed in manual code reviews or standard testing, enhancing the overall contract's security and reliability.


*There are 104 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/AccountCodeStorage.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/AccountCodeStorage.sol#L3-L3) 


```solidity

File: contracts/BootloaderUtilities.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L3-L3) 


```solidity

File: contracts/ComplexUpgrader.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ComplexUpgrader.sol#L3-L3) 


```solidity

File: contracts/Compressor.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Compressor.sol#L3-L3) 


```solidity

File: contracts/Constants.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Constants.sol#L3-L3) 


```solidity

File: contracts/ContractDeployer.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L3-L3) 


```solidity

File: contracts/DefaultAccount.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/DefaultAccount.sol#L3-L3) 


```solidity

File: contracts/EmptyContract.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/EmptyContract.sol#L3-L3) 


```solidity

File: contracts/ImmutableSimulator.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ImmutableSimulator.sol#L3-L3) 


```solidity

File: contracts/KnownCodesStorage.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/KnownCodesStorage.sol#L3-L3) 


```solidity

File: contracts/L1Messenger.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L3-L3) 


```solidity

File: contracts/L2BaseToken.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L2BaseToken.sol#L3-L3) 


```solidity

File: contracts/MsgValueSimulator.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/MsgValueSimulator.sol#L3-L3) 


```solidity

File: contracts/NonceHolder.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/NonceHolder.sol#L3-L3) 


```solidity

File: contracts/PubdataChunkPublisher.sol

2: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/PubdataChunkPublisher.sol#L2-L2) 


```solidity

File: contracts/SystemContext.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L3-L3) 


```solidity

File: contracts/libraries/EfficientCall.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L3-L3) 


```solidity

File: contracts/libraries/RLPEncoder.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/RLPEncoder.sol#L3-L3) 


```solidity

File: contracts/libraries/SystemContractHelper.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L3-L3) 


```solidity

File: contracts/libraries/SystemContractsCaller.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractsCaller.sol#L3-L3) 


```solidity

File: contracts/libraries/TransactionHelper.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L3-L3) 


```solidity

File: contracts/libraries/UnsafeBytesCalldata.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/UnsafeBytesCalldata.sol#L3-L3) 


```solidity

File: contracts/libraries/Utils.sol

2: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L2-L2) 


```solidity

File: contracts/interfaces/IAccount.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IAccount.sol#L3-L3) 


```solidity

File: contracts/interfaces/IAccountCodeStorage.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IAccountCodeStorage.sol#L3-L3) 


```solidity

File: contracts/interfaces/IBaseToken.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IBaseToken.sol#L3-L3) 


```solidity

File: contracts/interfaces/IBootloaderUtilities.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IBootloaderUtilities.sol#L3-L3) 


```solidity

File: contracts/interfaces/IComplexUpgrader.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IComplexUpgrader.sol#L3-L3) 


```solidity

File: contracts/interfaces/ICompressor.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ICompressor.sol#L3-L3) 


```solidity

File: contracts/interfaces/IContractDeployer.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IContractDeployer.sol#L3-L3) 


```solidity

File: contracts/interfaces/IImmutableSimulator.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IImmutableSimulator.sol#L3-L3) 


```solidity

File: contracts/interfaces/IKnownCodesStorage.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IKnownCodesStorage.sol#L3-L3) 


```solidity

File: contracts/interfaces/IL1Messenger.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IL1Messenger.sol#L3-L3) 


```solidity

File: contracts/interfaces/IL2StandardToken.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IL2StandardToken.sol#L3-L3) 


```solidity

File: contracts/interfaces/IMailbox.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IMailbox.sol#L3-L3) 


```solidity

File: contracts/interfaces/INonceHolder.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/INonceHolder.sol#L3-L3) 


```solidity

File: contracts/interfaces/IPaymaster.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IPaymaster.sol#L3-L3) 


```solidity

File: contracts/interfaces/IPaymasterFlow.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IPaymasterFlow.sol#L3-L3) 


```solidity

File: contracts/interfaces/IPubdataChunkPublisher.sol

2: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IPubdataChunkPublisher.sol#L2-L2) 


```solidity

File: contracts/interfaces/ISystemContext.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ISystemContext.sol#L3-L3) 


```solidity

File: contracts/interfaces/ISystemContextDeprecated.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ISystemContextDeprecated.sol#L3-L3) 


```solidity

File: contracts/interfaces/ISystemContract.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ISystemContract.sol#L3-L3) 


```solidity

File: contracts/bridge/L1ERC20Bridge.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1ERC20Bridge.sol#L3-L3) 


```solidity

File: contracts/bridge/L1SharedBridge.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L3-L3) 


```solidity

File: contracts/bridgehub/Bridgehub.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L3-L3) 


```solidity

File: contracts/governance/Governance.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/Governance.sol#L3-L3) 


```solidity

File: contracts/state-transition/StateTransitionManager.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L3-L3) 


```solidity

File: contracts/state-transition/ValidatorTimelock.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L3-L3) 


```solidity

File: contracts/state-transition/chain-deps/DiamondInit.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/DiamondInit.sol#L3-L3) 


```solidity

File: contracts/state-transition/chain-deps/DiamondProxy.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/DiamondProxy.sol#L3-L3) 


```solidity

File: contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L3-L3) 


```solidity

File: contracts/state-transition/chain-deps/facets/Admin.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Admin.sol#L3-L3) 


```solidity

File: contracts/state-transition/chain-deps/facets/Executor.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L3-L3) 


```solidity

File: contracts/state-transition/chain-deps/facets/Getters.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L3-L3) 


```solidity

File: contracts/state-transition/chain-deps/facets/Mailbox.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L3-L3) 


```solidity

File: contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L3-L3) 


```solidity

File: contracts/upgrades/BaseZkSyncUpgrade.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgrade.sol#L3-L3) 


```solidity

File: contracts/upgrades/BaseZkSyncUpgradeGenesis.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L3-L3) 


```solidity

File: contracts/upgrades/DefaultUpgrade.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/DefaultUpgrade.sol#L3-L3) 


```solidity

File: contracts/upgrades/GenesisUpgrade.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/GenesisUpgrade.sol#L3-L3) 


```solidity

File: contracts/common/libraries/L2ContractHelper.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/L2ContractHelper.sol#L3-L3) 


```solidity

File: contracts/common/libraries/UncheckedMath.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/UncheckedMath.sol#L3-L3) 


```solidity

File: contracts/common/libraries/UnsafeBytes.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/UnsafeBytes.sol#L3-L3) 


```solidity

File: contracts/state-transition/libraries/Diamond.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L3-L3) 


```solidity

File: contracts/state-transition/libraries/LibMap.sol

2: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/LibMap.sol#L2-L2) 


```solidity

File: contracts/state-transition/libraries/Merkle.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Merkle.sol#L3-L3) 


```solidity

File: contracts/state-transition/libraries/PriorityQueue.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/PriorityQueue.sol#L3-L3) 


```solidity

File: contracts/state-transition/libraries/TransactionValidator.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/TransactionValidator.sol#L3-L3) 


```solidity

File: contracts/bridge/interfaces/IL1ERC20Bridge.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1ERC20Bridge.sol#L3-L3) 


```solidity

File: contracts/bridge/interfaces/IL1SharedBridge.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L3-L3) 


```solidity

File: contracts/bridge/interfaces/IL2Bridge.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL2Bridge.sol#L3-L3) 


```solidity

File: contracts/bridge/interfaces/IWETH9.sol

2: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IWETH9.sol#L2-L2) 


```solidity

File: contracts/bridgehub/IBridgehub.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L3-L3) 


```solidity

File: contracts/common/interfaces/IL2ContractDeployer.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/interfaces/IL2ContractDeployer.sol#L3-L3) 


```solidity

File: contracts/governance/IGovernance.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/IGovernance.sol#L3-L3) 


```solidity

File: contracts/state-transition/IStateTransitionManager.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/IStateTransitionManager.sol#L3-L3) 


```solidity

File: contracts/state-transition/chain-interfaces/IAdmin.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IAdmin.sol#L3-L3) 


```solidity

File: contracts/state-transition/chain-interfaces/IDiamondInit.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IDiamondInit.sol#L3-L3) 


```solidity

File: contracts/state-transition/chain-interfaces/IExecutor.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IExecutor.sol#L3-L3) 


```solidity

File: contracts/state-transition/chain-interfaces/IGetters.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IGetters.sol#L3-L3) 


```solidity

File: contracts/state-transition/chain-interfaces/ILegacyGetters.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/ILegacyGetters.sol#L3-L3) 


```solidity

File: contracts/state-transition/chain-interfaces/IMailbox.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IMailbox.sol#L3-L3) 


```solidity

File: contracts/state-transition/chain-interfaces/IVerifier.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IVerifier.sol#L3-L3) 


```solidity

File: contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol#L3-L3) 


```solidity

File: contracts/state-transition/chain-interfaces/IZkSyncStateTransitionBase.sol

2: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IZkSyncStateTransitionBase.sol#L2-L2) 


```solidity

File: contracts/state-transition/l2-deps/ISystemContext.sol

2: pragma solidity ^0.8.0;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/l2-deps/ISystemContext.sol#L2-L2) 


```solidity

File: contracts/upgrades/IDefaultUpgrade.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/IDefaultUpgrade.sol#L3-L3) 


```solidity

File: contracts/common/Config.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/Config.sol#L3-L3) 


```solidity

File: contracts/common/L2ContractAddresses.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/L2ContractAddresses.sol#L3-L3) 


```solidity

File: contracts/common/Messaging.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/Messaging.sol#L3-L3) 


```solidity

File: contracts/common/ReentrancyGuard.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/ReentrancyGuard.sol#L3-L3) 


```solidity

File: contracts/vendor/AddressAliasHelper.sol

19: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/vendor/AddressAliasHelper.sol#L19-L19) 


```solidity

File: contracts/bridge/L2SharedBridge.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L3-L3) 


```solidity

File: contracts/bridge/L2StandardERC20.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2StandardERC20.sol#L3-L3) 


```solidity

File: contracts/bridge/interfaces/IL1ERC20Bridge.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL1ERC20Bridge.sol#L3-L3) 


```solidity

File: contracts/bridge/interfaces/IL1SharedBridge.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL1SharedBridge.sol#L3-L3) 


```solidity

File: contracts/bridge/interfaces/IL2SharedBridge.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL2SharedBridge.sol#L3-L3) 


```solidity

File: contracts/bridge/interfaces/IL2StandardToken.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL2StandardToken.sol#L3-L3) 


```solidity

File: contracts/interfaces/IPaymaster.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/interfaces/IPaymaster.sol#L3-L3) 


```solidity

File: contracts/interfaces/IPaymasterFlow.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/interfaces/IPaymasterFlow.sol#L3-L3) 


```solidity

File: contracts/vendor/AddressAliasHelper.sol

19: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/vendor/AddressAliasHelper.sol#L19-L19) 


```solidity

File: contracts/ForceDeployUpgrader.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/ForceDeployUpgrader.sol#L3-L3) 


```solidity

File: contracts/L2ContractHelper.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/L2ContractHelper.sol#L3-L3) 


```solidity

File: contracts/SystemContractsCaller.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/SystemContractsCaller.sol#L3-L3) 


</details>


### [NC&#x2011;83] Variable name must be in mixedCase 
Avoid using underscore for variable Names or parameters


*There are 11 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/bridge/L1ERC20Bridge.sol

// @audit __DEPRECATED_lastWithdrawalLimitReset
45:     mapping(address => uint256) private __DEPRECATED_lastWithdrawalLimitReset;

// @audit __DEPRECATED_withdrawnAmountInWindow
48:     mapping(address => uint256) private __DEPRECATED_withdrawnAmountInWindow;

// @audit __DEPRECATED_totalDepositedAmountPerUser
51:     mapping(address => mapping(address => uint256)) private __DEPRECATED_totalDepositedAmountPerUser;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1ERC20Bridge.sol#L45-L45) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1ERC20Bridge.sol#L48-L48), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1ERC20Bridge.sol#L51-L51)


```solidity

File: contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol

// @audit __DEPRECATED_diamondCutStorage
68:     uint256[7] __DEPRECATED_diamondCutStorage;

// @audit __DEPRECATED_governor
70:     address __DEPRECATED_governor;

// @audit __DEPRECATED_pendingGovernor
72:     address __DEPRECATED_pendingGovernor;

// @audit __DEPRECATED_allowList
92:     address __DEPRECATED_allowList;

// @audit __DEPRECATED_upgrades
109:     UpgradeStorage __DEPRECATED_upgrades;

// @audit __DEPRECATED_lastWithdrawalLimitReset
116:     uint256 __DEPRECATED_lastWithdrawalLimitReset;

// @audit __DEPRECATED_withdrawnAmountInWindow
118:     uint256 __DEPRECATED_withdrawnAmountInWindow;

// @audit __DEPRECATED_totalDepositedAmountPerUser
120:     mapping(address => uint256) __DEPRECATED_totalDepositedAmountPerUser;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L68-L68) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L70-L70), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L72-L72), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L92-L92), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L109-L109), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L116-L116), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L118-L118), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L120-L120)


</details>


### [NC&#x2011;84] Whitespace in Expressions 
See the [Whitespace in Expressions](https://docs.soliditylang.org/en/latest/style-guide.html#whitespace-in-expressions) section of the Solidity Style Guide


*There are 6 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/MsgValueSimulator.sol

//@audit remove the whiteSpace before the ')' char
63:             (bool success, ) = address(REAL_BASE_TOKEN_SYSTEM_CONTRACT).call(
64:                 abi.encodeCall(REAL_BASE_TOKEN_SYSTEM_CONTRACT.transferFromTo, (msg.sender, to, value))


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/MsgValueSimulator.sol#L63-L64) 


```solidity

File: contracts/NonceHolder.sol

//@audit remove the whiteSpace before the ')' char
127:         (deploymentNonce, ) = _splitRawNonce(rawNonces[addressAsKey]);
128: 

//@audit remove the whiteSpace before the ')' char
147:         (prevDeploymentNonce, ) = _splitRawNonce(oldRawNonce);
148:     }


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/NonceHolder.sol#L127-L128) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/NonceHolder.sol#L147-L148)


```solidity

File: contracts/state-transition/chain-deps/facets/Executor.sol

//@audit remove the whiteSpace before the ')' char
144:             (address logSender, ) = UnsafeBytes.readAddress(emittedL2Logs, i + L2_LOG_ADDRESS_OFFSET);
145:             (uint256 logKey, ) = UnsafeBytes.readUint256(emittedL2Logs, i + L2_LOG_KEY_OFFSET);

//@audit remove the whiteSpace before the ')' char
145:             (uint256 logKey, ) = UnsafeBytes.readUint256(emittedL2Logs, i + L2_LOG_KEY_OFFSET);
146:             (bytes32 logValue, ) = UnsafeBytes.readBytes32(emittedL2Logs, i + L2_LOG_VALUE_OFFSET);

//@audit remove the whiteSpace before the ')' char
146:             (bytes32 logValue, ) = UnsafeBytes.readBytes32(emittedL2Logs, i + L2_LOG_VALUE_OFFSET);
147: 


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L144-L145) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L145-L146), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L146-L147)


</details>


### [NC&#x2011;85] Complex function controle flow 
Due to multiple if, loop and conditions the following functions has a very complex controle flow that could make auditing very difficult to cover all possible path\nTherefore, consider breaking down these blocks into more manageable units, by splitting things into utility functions, by reducing nesting, and by using early returns


*There are 1 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/state-transition/chain-deps/facets/Executor.sol

130:     function _processL2Logs(
131:         CommitBatchInfo calldata _newBatch,
132:         bytes32 _expectedSystemContractUpgradeTxHash
133:     ) internal pure returns (LogProcessingOutput memory logOutput) {
134:         // Copy L2 to L1 logs into memory.
135:         bytes memory emittedL2Logs = _newBatch.systemLogs;
136: 
137:         // Used as bitmap to set/check log processing happens exactly once.
138:         // See SystemLogKey enum in Constants.sol for ordering.
139:         uint256 processedLogs;
140: 
141:         // linear traversal of the logs
142:         for (uint256 i = 0; i < emittedL2Logs.length; i = i.uncheckedAdd(L2_TO_L1_LOG_SERIALIZE_SIZE)) {
143:             // Extract the values to be compared to/used such as the log sender, key, and value
144:             (address logSender, ) = UnsafeBytes.readAddress(emittedL2Logs, i + L2_LOG_ADDRESS_OFFSET);
145:             (uint256 logKey, ) = UnsafeBytes.readUint256(emittedL2Logs, i + L2_LOG_KEY_OFFSET);
146:             (bytes32 logValue, ) = UnsafeBytes.readBytes32(emittedL2Logs, i + L2_LOG_VALUE_OFFSET);
147: 
148:             // Ensure that the log hasn't been processed already
149:             require(!_checkBit(processedLogs, uint8(logKey)), "kp");
150:             processedLogs = _setBit(processedLogs, uint8(logKey));
151: 
152:             // Need to check that each log was sent by the correct address.
153:             if (logKey == uint256(SystemLogKey.L2_TO_L1_LOGS_TREE_ROOT_KEY)) {
154:                 require(logSender == L2_TO_L1_MESSENGER_SYSTEM_CONTRACT_ADDR, "lm");
155:                 logOutput.l2LogsTreeRoot = logValue;
156:             } else if (logKey == uint256(SystemLogKey.TOTAL_L2_TO_L1_PUBDATA_KEY)) {
157:                 require(logSender == L2_TO_L1_MESSENGER_SYSTEM_CONTRACT_ADDR, "ln");
158:                 logOutput.pubdataHash = logValue;
159:             } else if (logKey == uint256(SystemLogKey.STATE_DIFF_HASH_KEY)) {
160:                 require(logSender == L2_TO_L1_MESSENGER_SYSTEM_CONTRACT_ADDR, "lb");
161:                 logOutput.stateDiffHash = logValue;
162:             } else if (logKey == uint256(SystemLogKey.PACKED_BATCH_AND_L2_BLOCK_TIMESTAMP_KEY)) {
163:                 require(logSender == L2_SYSTEM_CONTEXT_SYSTEM_CONTRACT_ADDR, "sc");
164:                 logOutput.packedBatchAndL2BlockTimestamp = uint256(logValue);
165:             } else if (logKey == uint256(SystemLogKey.PREV_BATCH_HASH_KEY)) {
166:                 require(logSender == L2_SYSTEM_CONTEXT_SYSTEM_CONTRACT_ADDR, "sv");
167:                 logOutput.previousBatchHash = logValue;
168:             } else if (logKey == uint256(SystemLogKey.CHAINED_PRIORITY_TXN_HASH_KEY)) {
169:                 require(logSender == L2_BOOTLOADER_ADDRESS, "bl");
170:                 logOutput.chainedPriorityTxsHash = logValue;
171:             } else if (logKey == uint256(SystemLogKey.NUMBER_OF_LAYER_1_TXS_KEY)) {
172:                 require(logSender == L2_BOOTLOADER_ADDRESS, "bk");
173:                 logOutput.numberOfLayer1Txs = uint256(logValue);
174:             } else if (logKey == uint256(SystemLogKey.BLOB_ONE_HASH_KEY)) {
175:                 require(logSender == L2_PUBDATA_CHUNK_PUBLISHER_ADDR, "pc");
176:                 logOutput.blob1Hash = logValue;
177:             } else if (logKey == uint256(SystemLogKey.BLOB_TWO_HASH_KEY)) {
178:                 require(logSender == L2_PUBDATA_CHUNK_PUBLISHER_ADDR, "pd");
179:                 logOutput.blob2Hash = logValue;
180:             } else if (logKey == uint256(SystemLogKey.EXPECTED_SYSTEM_CONTRACT_UPGRADE_TX_HASH_KEY)) {
181:                 require(logSender == L2_BOOTLOADER_ADDRESS, "bu");
182:                 require(_expectedSystemContractUpgradeTxHash == logValue, "ut");
183:             } else {
184:                 revert("ul");
185:             }
186:         }
187: 
188:         // We only require 9 logs to be checked, the 10th is if we are expecting a protocol upgrade
189:         // Without the protocol upgrade we expect 9 logs: 2^9 - 1 = 511
190:         // With the protocol upgrade we expect 8 logs: 2^10 - 1 = 1023
191:         if (_expectedSystemContractUpgradeTxHash == bytes32(0)) {
192:             require(processedLogs == 511, "b7");
193:         } else {
194:             require(processedLogs == 1023, "b8");
195:         }
196:     }


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L130-L196) 


</details>


### [NC&#x2011;86] Consider bounding input array length 
The functions below take in an unbounded array, and make function calls for entries in the array. While the function will revert if it eventually runs out of gas, it may be a nicer user experience to `require()` that the length of the array is below some reasonable maximum, so that the user doesn't have to use up a full transaction's gas only to see that the transaction reverts.


*There are 10 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/ContractDeployer.sol

//@audit array name _deployments
238:     function forceDeployOnAddresses(ForceDeployment[] calldata _deployments) external payable {
239:         require(
240:             msg.sender == FORCE_DEPLOYER || msg.sender == address(COMPLEX_UPGRADER_CONTRACT),
241:             "Can only be called by FORCE_DEPLOYER or COMPLEX_UPGRADER_CONTRACT"
242:         );
243: 
244:         uint256 deploymentsLength = _deployments.length;
245:         // We need to ensure that the `value` provided by the call is enough to provide `value`
246:         // for all of the deployments
247:         uint256 sumOfValues = 0;
248:         for (uint256 i = 0; i < deploymentsLength; ++i) {
249:             sumOfValues += _deployments[i].value;
250:         }
251:         require(msg.value == sumOfValues, "`value` provided is not equal to the combined `value`s of deployments");
252: 
253:         for (uint256 i = 0; i < deploymentsLength; ++i) {
254:             this.forceDeployOnAddress{value: _deployments[i].value}(_deployments[i], msg.sender);
255:         }
256:     }


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L238-L256) 


```solidity

File: contracts/ImmutableSimulator.sol

//@audit array name _immutables
34:     function setImmutables(address _dest, ImmutableData[] calldata _immutables) external override {
35:         require(msg.sender == address(DEPLOYER_SYSTEM_CONTRACT), "Callable only by the deployer system contract");
36:         unchecked {
37:             uint256 immutablesLength = _immutables.length;
38:             for (uint256 i = 0; i < immutablesLength; ++i) {
39:                 uint256 index = _immutables[i].index;
40:                 bytes32 value = _immutables[i].value;
41:                 immutableDataStorage[uint256(uint160(_dest))][index] = value;
42:             }
43:         }
44:     }


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ImmutableSimulator.sol#L34-L44) 


```solidity

File: contracts/KnownCodesStorage.sol

//@audit array name _hashes
27:     function markFactoryDeps(bool _shouldSendToL1, bytes32[] calldata _hashes) external onlyCallFromBootloader {
28:         unchecked {
29:             uint256 hashesLen = _hashes.length;
30:             for (uint256 i = 0; i < hashesLen; ++i) {
31:                 _markBytecodeAsPublished(_hashes[i], _shouldSendToL1);
32:             }
33:         }
34:     }


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/KnownCodesStorage.sol#L27-L34) 


```solidity

File: contracts/state-transition/ValidatorTimelock.sol

//@audit array name _newBatchesData
108:     function commitBatches(
109:         StoredBatchInfo calldata,
110:         CommitBatchInfo[] calldata _newBatchesData
111:     ) external onlyValidator(ERA_CHAIN_ID) {
112:         unchecked {
113:             // This contract is only a temporary solution, that hopefully will be disabled until 2106 year, so...
114:             // It is safe to cast.
115:             uint32 timestamp = uint32(block.timestamp);
116:             for (uint256 i = 0; i < _newBatchesData.length; ++i) {
117:                 committedBatchTimestamp[ERA_CHAIN_ID].set(_newBatchesData[i].batchNumber, timestamp);
118:             }
119:         }
120: 
121:         _propagateToZkSyncStateTransition(ERA_CHAIN_ID);
122:     }

//@audit array name _newBatchesData
126:     function commitBatchesSharedBridge(
127:         uint256 _chainId,
128:         StoredBatchInfo calldata,
129:         CommitBatchInfo[] calldata _newBatchesData
130:     ) external onlyValidator(_chainId) {
131:         unchecked {
132:             // This contract is only a temporary solution, that hopefully will be disabled until 2106 year, so...
133:             // It is safe to cast.
134:             uint32 timestamp = uint32(block.timestamp);
135:             for (uint256 i = 0; i < _newBatchesData.length; ++i) {
136:                 committedBatchTimestamp[_chainId].set(_newBatchesData[i].batchNumber, timestamp);
137:             }
138:         }
139: 
140:         _propagateToZkSyncStateTransition(_chainId);
141:     }

//@audit array name _newBatchesData
182:     function executeBatches(StoredBatchInfo[] calldata _newBatchesData) external onlyValidator(ERA_CHAIN_ID) {
183:         uint256 delay = executionDelay; // uint32
184:         unchecked {
185:             for (uint256 i = 0; i < _newBatchesData.length; ++i) {
186:                 uint256 commitBatchTimestamp = committedBatchTimestamp[ERA_CHAIN_ID].get(
187:                     _newBatchesData[i].batchNumber
188:                 );
189: 
190:                 // Note: if the `commitBatchTimestamp` is zero, that means either:
191:                 // * The batch was committed, but not through this contract.
192:                 // * The batch wasn't committed at all, so execution will fail in the zkSync contract.
193:                 // We allow executing such batches.
194: 
195:                 require(block.timestamp >= commitBatchTimestamp + delay, "5c"); // The delay is not passed
196:             }
197:         }
198:         _propagateToZkSyncStateTransition(ERA_CHAIN_ID);
199:     }

//@audit array name _newBatchesData
203:     function executeBatchesSharedBridge(
204:         uint256 _chainId,
205:         StoredBatchInfo[] calldata _newBatchesData
206:     ) external onlyValidator(_chainId) {
207:         uint256 delay = executionDelay; // uint32
208:         unchecked {
209:             for (uint256 i = 0; i < _newBatchesData.length; ++i) {
210:                 uint256 commitBatchTimestamp = committedBatchTimestamp[_chainId].get(_newBatchesData[i].batchNumber);
211: 
212:                 // Note: if the `commitBatchTimestamp` is zero, that means either:
213:                 // * The batch was committed, but not through this contract.
214:                 // * The batch wasn't committed at all, so execution will fail in the zkSync contract.
215:                 // We allow executing such batches.
216: 
217:                 require(block.timestamp >= commitBatchTimestamp + delay, "5c"); // The delay is not passed
218:             }
219:         }
220:         _propagateToZkSyncStateTransition(_chainId);
221:     }


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L108-L122) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L126-L141), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L182-L199), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L203-L221)


```solidity

File: contracts/state-transition/libraries/Diamond.sol

//@audit array name _selectors
126:     function _addFunctions(address _facet, bytes4[] memory _selectors, bool _isFacetFreezable) private {
127:         DiamondStorage storage ds = getDiamondStorage();
128: 
129:         // Facet with no code cannot be added.
130:         // This check also verifies that the facet does not have zero address, since it is the
131:         // address with which 0x00000000 selector is associated.
132:         require(_facet.code.length > 0, "G");
133: 
134:         // Add facet to the list of facets if the facet address is new one
135:         _saveFacetIfNew(_facet);
136: 
137:         uint256 selectorsLength = _selectors.length;
138:         for (uint256 i = 0; i < selectorsLength; i = i.uncheckedInc()) {
139:             bytes4 selector = _selectors[i];
140:             SelectorToFacet memory oldFacet = ds.selectorToFacet[selector];
141:             require(oldFacet.facetAddress == address(0), "J"); // facet for this selector already exists
142: 
143:             _addOneFunction(_facet, selector, _isFacetFreezable);
144:         }
145:     }

//@audit array name _selectors
149:     function _replaceFunctions(address _facet, bytes4[] memory _selectors, bool _isFacetFreezable) private {
150:         DiamondStorage storage ds = getDiamondStorage();
151: 
152:         // Facet with no code cannot be added.
153:         // This check also verifies that the facet does not have zero address, since it is the
154:         // address with which 0x00000000 selector is associated.
155:         require(_facet.code.length > 0, "K");
156: 
157:         uint256 selectorsLength = _selectors.length;
158:         for (uint256 i = 0; i < selectorsLength; i = i.uncheckedInc()) {
159:             bytes4 selector = _selectors[i];
160:             SelectorToFacet memory oldFacet = ds.selectorToFacet[selector];
161:             require(oldFacet.facetAddress != address(0), "L"); // it is impossible to replace the facet with zero address
162: 
163:             _removeOneFunction(oldFacet.facetAddress, selector);
164:             // Add facet to the list of facets if the facet address is a new one
165:             _saveFacetIfNew(_facet);
166:             _addOneFunction(_facet, selector, _isFacetFreezable);
167:         }
168:     }

//@audit array name _selectors
172:     function _removeFunctions(address _facet, bytes4[] memory _selectors) private {
173:         DiamondStorage storage ds = getDiamondStorage();
174: 
175:         require(_facet == address(0), "a1"); // facet address must be zero
176: 
177:         uint256 selectorsLength = _selectors.length;
178:         for (uint256 i = 0; i < selectorsLength; i = i.uncheckedInc()) {
179:             bytes4 selector = _selectors[i];
180:             SelectorToFacet memory oldFacet = ds.selectorToFacet[selector];
181:             require(oldFacet.facetAddress != address(0), "a2"); // Can't delete a non-existent facet
182: 
183:             _removeOneFunction(oldFacet.facetAddress, selector);
184:         }
185:     }


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L126-L145) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L149-L168), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L172-L185)


</details>


### [NC&#x2011;87] A function which defines named returns in it's declaration doesn't need to use return 
Remove the return statement once ensuring it is safe to do so


*There are 4 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/BootloaderUtilities.sol

044:     function encodeLegacyTransactionHash(Transaction calldata _transaction) internal view returns (bytes32 txHash) {
045:         // Hash of legacy transactions are encoded as one of the:
046:         // - RLP(nonce, gasPrice, gasLimit, to, value, data, chainId, 0, 0)
047:         // - RLP(nonce, gasPrice, gasLimit, to, value, data)
048:         //
049:         // In this RLP encoding, only the first one above list appears, so we encode each element
050:         // inside list and then concatenate the length of all elements with them.
051: 
052:         bytes memory encodedNonce = RLPEncoder.encodeUint256(_transaction.nonce);
053:         // Encode `gasPrice` and `gasLimit` together to prevent "stack too deep error".
054:         bytes memory encodedGasParam;
055:         {
056:             bytes memory encodedGasPrice = RLPEncoder.encodeUint256(_transaction.maxFeePerGas);
057:             bytes memory encodedGasLimit = RLPEncoder.encodeUint256(_transaction.gasLimit);
058:             encodedGasParam = bytes.concat(encodedGasPrice, encodedGasLimit);
059:         }
060: 
061:         bytes memory encodedTo = RLPEncoder.encodeAddress(address(uint160(_transaction.to)));
062:         bytes memory encodedValue = RLPEncoder.encodeUint256(_transaction.value);
063:         // Encode only the length of the transaction data, and not the data itself,
064:         // so as not to copy to memory a potentially huge transaction data twice.
065:         bytes memory encodedDataLength;
066:         {
067:             // Safe cast, because the length of the transaction data can't be so large.
068:             uint64 txDataLen = uint64(_transaction.data.length);
069:             if (txDataLen != 1) {
070:                 // If the length is not equal to one, then only using the length can it be encoded definitely.
071:                 encodedDataLength = RLPEncoder.encodeNonSingleBytesLen(txDataLen);
072:             } else if (_transaction.data[0] >= 0x80) {
073:                 // If input is a byte in [0x80, 0xff] range, RLP encoding will concatenates 0x81 with the byte.
074:                 encodedDataLength = hex"81";
075:             }
076:             // Otherwise the length is not encoded at all.
077:         }
078: 
079:         bytes memory rEncoded;
080:         {
081:             uint256 rInt = uint256(bytes32(_transaction.signature[0:32]));
082:             rEncoded = RLPEncoder.encodeUint256(rInt);
083:         }
084:         bytes memory sEncoded;
085:         {
086:             uint256 sInt = uint256(bytes32(_transaction.signature[32:64]));
087:             sEncoded = RLPEncoder.encodeUint256(sInt);
088:         }
089:         bytes memory vEncoded;
090:         {
091:             uint256 vInt = uint256(uint8(_transaction.signature[64]));
092:             require(vInt == 27 || vInt == 28, "Invalid v value");
093: 
094:             // If the `chainId` is specified in the transaction, then the `v` value is encoded as
095:             // `35 + y + 2 * chainId == vInt + 8 + 2 * chainId`, where y - parity bit (see EIP-155).
096:             if (_transaction.reserved[0] != 0) {
097:                 vInt += 8 + block.chainid * 2;
098:             }
099: 
100:             vEncoded = RLPEncoder.encodeUint256(vInt);
101:         }
102: 
103:         bytes memory encodedListLength;
104:         unchecked {
105:             uint256 listLength = encodedNonce.length +
106:                 encodedGasParam.length +
107:                 encodedTo.length +
108:                 encodedValue.length +
109:                 encodedDataLength.length +
110:                 _transaction.data.length +
111:                 rEncoded.length +
112:                 sEncoded.length +
113:                 vEncoded.length;
114: 
115:             // Safe cast, because the length of the list can't be so large.
116:             encodedListLength = RLPEncoder.encodeListLen(uint64(listLength));
117:         }
118: 
119:         return
120:             keccak256(
121:                 bytes.concat(
122:                     encodedListLength,
123:                     encodedNonce,
124:                     encodedGasParam,
125:                     encodedTo,
126:                     encodedValue,
127:                     encodedDataLength,
128:                     _transaction.data,
129:                     vEncoded,
130:                     rEncoded,
131:                     sEncoded
132:                 )
133:             );
134:     }


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L44-L134) 


```solidity

File: contracts/ContractDeployer.sol

34:     function getAccountInfo(address _address) external view returns (AccountInfo memory info) {
35:         return accountInfo[_address];
36:     }


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L34-L36) 


```solidity

File: contracts/NonceHolder.sol

125:     function getDeploymentNonce(address _address) external view returns (uint256 deploymentNonce) {
126:         uint256 addressAsKey = uint256(uint160(_address));
127:         (deploymentNonce, ) = _splitRawNonce(rawNonces[addressAsKey]);
128: 
129:         return deploymentNonce;
130:     }


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/NonceHolder.sol#L125-L130) 


```solidity

File: contracts/bridgehub/Bridgehub.sol

114:     function createNewChain(
115:         uint256 _chainId,
116:         address _stateTransitionManager,
117:         address _baseToken,
118:         uint256, //_salt
119:         address _admin,
120:         bytes calldata _initData
121:     ) external onlyOwnerOrAdmin nonReentrant returns (uint256 chainId) {
122:         require(_chainId != 0, "Bridgehub: chainId cannot be 0");
123:         require(_chainId <= type(uint48).max, "Bridgehub: chainId too large");
124: 
125:         require(
126:             stateTransitionManagerIsRegistered[_stateTransitionManager],
127:             "Bridgehub: state transition not registered"
128:         );
129:         require(tokenIsRegistered[_baseToken], "Bridgehub: token not registered");
130:         require(address(sharedBridge) != address(0), "Bridgehub: weth bridge not set");
131: 
132:         require(stateTransitionManager[_chainId] == address(0), "Bridgehub: chainId already registered");
133: 
134:         stateTransitionManager[_chainId] = _stateTransitionManager;
135:         baseToken[_chainId] = _baseToken;
136: 
137:         IStateTransitionManager(_stateTransitionManager).createNewChain(
138:             _chainId,
139:             _baseToken,
140:             address(sharedBridge),
141:             _admin,
142:             _initData
143:         );
144: 
145:         emit NewChain(_chainId, _stateTransitionManager, _admin);
146:         return _chainId;
147:     }


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L114-L147) 


</details>


### [NC&#x2011;88] [NatSpec] Natspec `@dev` is missing from `contract` 



*There are 705 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/AccountCodeStorage.sol

25:     modifier onlyDeployer() {

52:     /// @notice Marks the account bytecodeHash as constructed.
53:     /// @param _address The address of the account to mark as constructed

75:     /// @notice Get the codehash stored for an address.
76:     /// @param _address The address of the account of which the codehash to return
77:     /// @return codeHash The codehash stored for this account.

86:     /// @notice Simulate the behavior of the `extcodehash` EVM opcode.
87:     /// @param _input The 256-bit account address.
88:     /// @return codeHash - hash of the bytecode according to the EIP-1052 specification.

114:     /// @notice Simulate the behavior of the `extcodesize` EVM opcode.
115:     /// @param _input The 256-bit account address.
116:     /// @return codeSize - the size of the deployed smart contract in bytes.


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/AccountCodeStorage.sol#L25-L25) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/AccountCodeStorage.sol#L52-L53), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/AccountCodeStorage.sol#L75-L77), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/AccountCodeStorage.sol#L86-L88), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/AccountCodeStorage.sol#L114-L116)


```solidity

File: contracts/BootloaderUtilities.sol

10: /**
11:  * @author Matter Labs
12:  * @custom:security-contact security@matterlabs.dev
13:  * @notice A contract that provides some utility methods for the bootloader
14:  * that is very hard to write in Yul.
15:  */

41:     /// @notice Calculates the hash for a legacy transaction.
42:     /// @param _transaction The legacy transaction.
43:     /// @return txHash The hash of the transaction.

136:     /// @notice Calculates the hash for an EIP2930 transaction.
137:     /// @param _transaction The EIP2930 transaction.
138:     /// @return txHash The hash of the transaction.

226:     /// @notice Calculates the hash for an EIP1559 transaction.
227:     /// @param _transaction The legacy transaction.
228:     /// @return txHash The hash of the transaction.


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L10-L15) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L41-L43), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L136-L138), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L226-L228)


```solidity

File: contracts/ComplexUpgrader.sol

08: /**
09:  * @author Matter Labs
10:  * @custom:security-contact security@matterlabs.dev
11:  * @notice Upgrader which should be used to perform complex multistep upgrades on L2. In case some custom logic for an upgrade is needed
12:  * this logic should be deployed into the user space and then this contract will delegatecall to the deployed contract.
13:  */


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ComplexUpgrader.sol#L8-L13) 


```solidity

File: contracts/Compressor.sol

192:     /// @notice Decode the raw compressed data into the dictionary and the encoded data.
193:     /// @param _rawCompressedData The compressed bytecode in a format of:
194:     ///    - 2 bytes: the bytes length of the dictionary
195:     ///    - N bytes: the dictionary
196:     ///    - M bytes: the encoded data

247:     /// @notice Converts a calldata slice into uint256. It is the responsibility of the caller to ensure that
248:     /// the _calldataSlice has length no longer than 32 bytes
249:     /// @param _calldataSlice The calldata slice to convert to uint256
250:     /// @return number The uint256 representation of the calldata slice


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Compressor.sol#L192-L196) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Compressor.sol#L247-L250)


```solidity

File: contracts/ContractDeployer.sol

28:     modifier onlySelf() {

33:     /// @notice Returns information about a certain account.

38:     /// @notice Returns the account abstraction version if `_address` is a deployed contract.
39:     /// Returns the latest supported account abstraction version if `_address` is an EOA.

57:     /// @notice Stores the new account information

71:     /// @notice Updates the nonce ordering of the account. Currently,
72:     /// it only allows changes from sequential to arbitrary ordering.
73:     /// @param _nonceOrdering The new nonce ordering to use.

89:     /// @notice Calculates the address of a deployed contract via create2
90:     /// @param _sender The account that deploys the contract.
91:     /// @param _bytecodeHash The correctly formatted hash of the bytecode.
92:     /// @param _salt The create2 salt.
93:     /// @param _input The constructor data.
94:     /// @return newAddress The derived address of the account.

112:     /// @notice Calculates the address of a deployed contract via create
113:     /// @param _sender The account that deploys the contract.
114:     /// @param _senderNonce The deploy nonce of the sender's account.

128:     /// @notice Deploys a contract with similar address derivation rules to the EVM's `CREATE2` opcode.
129:     /// @param _salt The CREATE2 salt
130:     /// @param _bytecodeHash The correctly formatted hash of the bytecode.
131:     /// @param _input The constructor calldata

155:     /// @notice Deploys a contract account with similar address derivation rules to the EVM's `CREATE2` opcode.
156:     /// @param _salt The CREATE2 salt
157:     /// @param _bytecodeHash The correctly formatted hash of the bytecode.
158:     /// @param _input The constructor calldata.
159:     /// @param _aaVersion The account abstraction version to use.
160:     /// Note: this method may be callable only in system mode,
161:     /// that is checked in the `createAccount` by `onlySystemCall` modifier.

196:     /// @notice A struct that describes a forced deployment on an address

210:     /// @notice The method that can be used to forcefully deploy a contract.
211:     /// @param _deployment Information about the forced deployment.
212:     /// @param _sender The `msg.sender` inside the constructor call.

258:     function _nonSystemDeployOnAddress(

278:     /// @notice Deploy a certain bytecode on the address.
279:     /// @param _bytecodeHash The correctly formatted hash of the bytecode.
280:     /// @param _newAddress The address of the contract to be deployed.
281:     /// @param _aaVersion The version of the account abstraction protocol to use.
282:     /// @param _input The constructor calldata.

300:     /// @notice Check that bytecode hash is marked as known on the `KnownCodeStorage` system contracts

306:     /// @notice Ensures that the _newAddress and assigns a new contract hash to it
307:     /// @param _newAddress The address of the deployed contract
308:     /// @param _bytecodeHash The correctly formatted hash of the bytecode.

315:     /// @notice Transfers the `msg.value` ETH to the deployed account & invokes its constructor.
316:     /// This function must revert in case the deployment fails.
317:     /// @param _sender The msg.sender to be used in the constructor
318:     /// @param _newAddress The address of the deployed contract
319:     /// @param _input The constructor calldata
320:     /// @param _isSystem Whether the call should be a system call (could be possibly required in the future).


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L28-L28) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L33-L33), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L38-L39), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L57-L57), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L71-L73), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L89-L94), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L112-L114), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L128-L131), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L155-L161), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L196-L196), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L210-L212), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L258-L258), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L278-L282), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L300-L300), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L306-L308), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L315-L320)


```solidity

File: contracts/DefaultAccount.sol

75:     /// @notice Inner method for validating transaction and increasing the nonce
76:     /// @param _suggestedSignedHash The hash of the transaction signed by the EOA
77:     /// @param _transaction The transaction.

129:     /// @notice Inner method for executing a transaction.
130:     /// @param _transaction The transaction to execute.

155:     /// @notice Validation that the ECDSA signature of the transaction is correct.
156:     /// @param _hash The hash of the transaction to be signed.
157:     /// @param _signature The signature of the transaction.
158:     /// @return EIP1271_SUCCESS_RETURN_VALUE if the signaure is correct. It reverts otherwise.

220:     fallback() external payable ignoreInDelegateCall {

227:     receive() external payable {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/DefaultAccount.sol#L75-L77) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/DefaultAccount.sol#L129-L130), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/DefaultAccount.sol#L155-L158), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/DefaultAccount.sol#L220-L220), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/DefaultAccount.sol#L227-L227)


```solidity

File: contracts/EmptyContract.sol

5: /**
6:  * @author Matter Labs
7:  * @custom:security-contact security@matterlabs.dev
8:  * @notice The "empty" contract that is put into some system contracts by default.
9:  */

11:     fallback() external payable {}

13:     receive() external payable {}


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/EmptyContract.sol#L5-L9) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/EmptyContract.sol#L11-L11), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/EmptyContract.sol#L13-L13)


```solidity

File: contracts/ImmutableSimulator.sol

23:     /// @notice Method that returns the immutable with a certain index for a user.
24:     /// @param _dest The address which the immutable belongs to.
25:     /// @param _index The index of the immutable.
26:     /// @return The value of the immutables.

31:     /// @notice Method used by the contract deployer to store the immutables for an account
32:     /// @param _dest The address which to store the immutables for.
33:     /// @param _immutables The list of the immutables.


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ImmutableSimulator.sol#L23-L26) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ImmutableSimulator.sol#L31-L33)


```solidity

File: contracts/KnownCodesStorage.sol

19:     modifier onlyCompressor() {

24:     /// @notice The method that is used by the bootloader to mark several bytecode hashes as known.
25:     /// @param _shouldSendToL1 Whether the bytecode should be sent on L1.
26:     /// @param _hashes Hashes of the bytecodes to be marked as known.

43:     /// @notice The method used to mark a single bytecode hash as known
44:     /// @param _bytecodeHash The hash of the bytecode that is marked as known
45:     /// @param _shouldSendToL1 Whether the bytecode should be sent on L1

63:     /// @notice Returns the marker stored for a bytecode hash. 1 means that the bytecode hash is known
64:     /// and can be used for deploying contracts. 0 otherwise.


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/KnownCodesStorage.sol#L19-L19) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/KnownCodesStorage.sol#L24-L26), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/KnownCodesStorage.sol#L43-L45), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/KnownCodesStorage.sol#L63-L64)


```solidity

File: contracts/L1Messenger.sol

49:     /// The gas cost of calculation of keccak256 of bytes array of such length.

60:     /// The gas cost of calculation of sha256 of bytes array of such length.

93:     /// @notice Internal function to send L2ToL1Log.

114:     /// @notice Public functionality to send messages to L1.
115:     /// @param _message The message intended to be sent to L1.


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L49-L49) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L60-L60), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L93-L93), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L114-L115)


```solidity

File: contracts/L2BaseToken.sol

70:     /// @notice Initiate the ETH withdrawal, funds will be available to claim on L1 `finalizeEthWithdrawal` method.
71:     /// @param _l1Receiver The address on L1 to receive the funds.

82:     /// @notice Initiate the ETH withdrawal, with the sent message. The funds will be available to claim on L1 `finalizeEthWithdrawal` method.
83:     /// @param _l1Receiver The address on L1 to receive the funds.
84:     /// @param _additionalData Additional data to be sent to L1 with the withdrawal.


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L2BaseToken.sol#L70-L71) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L2BaseToken.sol#L82-L84)


```solidity

File: contracts/NonceHolder.sol

43:     /// @notice Returns the current minimal nonce for account.
44:     /// @param _address The account to return the minimal nonce for
45:     /// @return The current minimal nonce for this account.

62:     /// @notice Increases the minimal nonce for the msg.sender and returns the previous one.
63:     /// @param _value The number by which to increase the minimal nonce for msg.sender.
64:     /// @return oldMinNonce The value of the minimal nonce for msg.sender before the increase.

099:     /// @notice Gets the value stored under a custom nonce for msg.sender.
100:     /// @param _key The key under which to get the stored value.
101:     /// @return The value stored under the `_key` for the msg.sender.

107:     /// @notice A convenience method to increment the minimal nonce if it is equal
108:     /// to the `_expectedNonce`.
109:     /// @param _expectedNonce The expected minimal nonce for the account.

122:     /// @notice Returns the deployment nonce for the accounts used for CREATE opcode.
123:     /// @param _address The address to return the deploy nonce of.
124:     /// @return deploymentNonce The deployment nonce of the account.

132:     /// @notice Increments the deployment nonce for the account and returns the previous one.
133:     /// @param _address The address of the account which to return the deploy nonce for.
134:     /// @return prevDeploymentNonce The deployment nonce at the time this function is called.

150:     /// @notice A method that checks whether the nonce has been used before.
151:     /// @param _address The address the nonce of which is being checked.
152:     /// @param _nonce The nonce value which is checked.
153:     /// @return `true` if the nonce has been used, `false` otherwise.

176:     /// @notice Splits the raw nonce value into the deployment nonce and the minimal nonce.
177:     /// @param _rawMinNonce The value of the raw minimal nonce (equal to minNonce + deploymentNonce* 2**128).
178:     /// @return deploymentNonce and minNonce.


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/NonceHolder.sol#L43-L45) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/NonceHolder.sol#L62-L64), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/NonceHolder.sol#L99-L101), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/NonceHolder.sol#L107-L109), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/NonceHolder.sol#L122-L124), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/NonceHolder.sol#L132-L134), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/NonceHolder.sol#L150-L153), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/NonceHolder.sol#L176-L178)


```solidity

File: contracts/PubdataChunkPublisher.sol

11: /**
12:  * @author Matter Labs
13:  * @custom:security-contact security@matterlabs.dev
14:  * @notice Smart contract for chunking pubdata into the appropriate size for EIP-4844 blobs.
15:  */


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/PubdataChunkPublisher.sol#L11-L15) 


```solidity

File: contracts/SystemContext.sol

11: /**
12:  * @author Matter Labs
13:  * @custom:security-contact security@matterlabs.dev
14:  * @notice Contract that stores some of the context variables, that may be either
15:  * block-scoped, tx-scoped or system-wide.
16:  */

82:     /// @notice Set the chainId origin.
83:     /// @param _newChainId The chainId

97:     /// @notice Set the current tx origin.
98:     /// @param _newOrigin The new tx origin.

103:     /// @notice Set the the current gas price.
104:     /// @param _gasPrice The new tx gasPrice.

117:     function getCurrentPubdataSpent() public view returns (uint256) {

122:     function getCurrentPubdataCost() external view returns (uint256) {

163:     /// @notice Returns the hash of the given batch.
164:     /// @param _batchNumber The number of the batch.
165:     /// @return hash The hash of the batch.

170:     /// @notice Returns the current batch's number and timestamp.
171:     /// @return batchNumber and batchTimestamp tuple of the current batch's number and the current batch's timestamp

178:     /// @notice Returns the current block's number and timestamp.
179:     /// @return blockNumber and blockTimestamp tuple of the current L2 block's number and the current block's timestamp

202:     /// @notice Assuming that block is one of the last MINIBLOCK_HASHES_TO_STORE ones, returns its hash.
203:     /// @param _block The number of the block.
204:     /// @return hash The hash of the block.

209:     /// @notice Assuming that the block is one of the last MINIBLOCK_HASHES_TO_STORE ones, sets its hash.
210:     /// @param _block The number of the block.
211:     /// @param _hash The hash of the block.

216:     /// @notice Calculates the hash of an L2 block.
217:     /// @param _blockNumber The number of the L2 block.
218:     /// @param _blockTimestamp The timestamp of the L2 block.
219:     /// @param _prevL2BlockHash The hash of the previous L2 block.
220:     /// @param _blockTxsRollingHash The rolling hash of the transactions in the L2 block.

230:     /// @notice Calculates the legacy block hash of L2 block, which were used before the upgrade where
231:     /// the advanced block hashes were introduced.
232:     /// @param _blockNumber The number of the L2 block.

237:     /// @notice Performs the upgrade where we transition to the L2 blocks.
238:     /// @param _l2BlockNumber The number of the new L2 block.
239:     /// @param _expectedPrevL2BlockHash The expected hash of the previous L2 block.
240:     /// @param _isFirstInBatch Whether this method is called for the first time in the batch.

259:     /// @notice Creates new virtual blocks, while ensuring they don't exceed the L2 block number.
260:     /// @param _l2BlockNumber The number of the new L2 block.
261:     /// @param _maxVirtualBlocksToCreate The maximum number of virtual blocks to create with this L2 block.
262:     /// @param _newTimestamp The timestamp of the new L2 block, which is also the timestamp of the new virtual block.

310:     /// @notice Sets the current block number and timestamp of the L2 block.
311:     /// @param _l2BlockNumber The number of the new L2 block.
312:     /// @param _l2BlockTimestamp The timestamp of the new L2 block.
313:     /// @param _prevL2BlockHash The hash of the previous L2 block.

400:     /// @notice Appends the transaction hash to the rolling hash of the current L2 block.
401:     /// @param _txHash The hash of the transaction.

425:     /// @notice Ensures that the timestamp of the batch is greater than the timestamp of the last L2 block.
426:     /// @param _newTimestamp The timestamp of the new batch.

482:     function incrementTxNumberInBatch() external onlyCallFromBootloader {

486:     function resetTxNumberInBatch() external onlyCallFromBootloader {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L11-L16) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L82-L83), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L97-L98), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L103-L104), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L117-L117), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L122-L122), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L163-L165), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L170-L171), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L178-L179), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L202-L204), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L209-L211), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L216-L220), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L230-L232), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L237-L240), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L259-L262), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L310-L313), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L400-L401), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L425-L426), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L482-L482), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L486-L486)


```solidity

File: contracts/libraries/EfficientCall.sol

33:     /// @notice Call the `keccak256` without copying calldata to memory.
34:     /// @param _data The preimage data.
35:     /// @return The `keccak256` hash.

42:     /// @notice Call the `sha256` precompile without copying calldata to memory.
43:     /// @param _data The preimage data.
44:     /// @return The `sha256` hash.

51:     /// @notice Perform a `call` without copying calldata to memory.
52:     /// @param _gas The gas to use for the call.
53:     /// @param _address The address to call.
54:     /// @param _value The `msg.value` to send.
55:     /// @param _data The calldata to use for the call.
56:     /// @param _isSystem Whether the call should contain the `isSystem` flag.
57:     /// @return returnData The copied to memory return data.

69:     /// @notice Perform a `staticCall` without copying calldata to memory.
70:     /// @param _gas The gas to use for the call.
71:     /// @param _address The address to call.
72:     /// @param _data The calldata to use for the call.
73:     /// @return returnData The copied to memory return data.

83:     /// @notice Perform a `delegateCall` without copying calldata to memory.
84:     /// @param _gas The gas to use for the call.
85:     /// @param _address The address to call.
86:     /// @param _data The calldata to use for the call.
87:     /// @return returnData The copied to memory return data.

097:     /// @notice Perform a `mimicCall` (a call with custom msg.sender) without copying calldata to memory.
098:     /// @param _gas The gas to use for the call.
099:     /// @param _address The address to call.
100:     /// @param _data The calldata to use for the call.
101:     /// @param _whoToMimic The `msg.sender` for the next call.
102:     /// @param _isConstructor Whether the call should contain the `isConstructor` flag.
103:     /// @param _isSystem Whether the call should contain the `isSystem` flag.
104:     /// @return returnData The copied to memory return data.

117:     /// @notice Perform a `call` without copying calldata to memory.
118:     /// @param _gas The gas to use for the call.
119:     /// @param _address The address to call.
120:     /// @param _value The `msg.value` to send.
121:     /// @param _data The calldata to use for the call.
122:     /// @param _isSystem Whether the call should contain the `isSystem` flag.
123:     /// @return success whether the call was successful.

154:     /// @notice Perform a `staticCall` without copying calldata to memory.
155:     /// @param _gas The gas to use for the call.
156:     /// @param _address The address to call.
157:     /// @param _data The calldata to use for the call.
158:     /// @return success whether the call was successful.

168:     /// @notice Perform a `delegatecall` without copying calldata to memory.
169:     /// @param _gas The gas to use for the call.
170:     /// @param _address The address to call.
171:     /// @param _data The calldata to use for the call.
172:     /// @return success whether the call was successful.


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L33-L35) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L42-L44), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L51-L57), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L69-L73), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L83-L87), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L97-L104), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L117-L123), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L154-L158), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L168-L172)


```solidity

File: contracts/libraries/RLPEncoder.sol

5: /**
6:  * @author Matter Labs
7:  * @custom:security-contact security@matterlabs.dev
8:  * @notice This library provides RLP encoding functionality.
9:  */

11:     function encodeAddress(address _val) internal pure returns (bytes memory encoded) {

24:     function encodeUint256(uint256 _val) internal pure returns (bytes memory encoded) {

46:     /// @notice Encodes the size of bytes in RLP format.
47:     /// @param _len The length of the bytes to encode. It has a `uint64` type since as larger values are not supported.
48:     /// NOTE: panics if the length is 1 since the length encoding is ambiguous in this case.

54:     /// @notice Encodes the size of list items in RLP format.
55:     /// @param _len The length of the bytes to encode. It has a `uint64` type since as larger values are not supported.

60:     function _encodeLength(uint64 _len, uint256 _offset) private pure returns (bytes memory encoded) {

81:     /// @notice Computes the index of the highest byte set in number.
82:     /// @notice Uses little endian ordering (The least significant byte has index `0`).
83:     /// NOTE: returns `0` for `0`


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/RLPEncoder.sol#L5-L9) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/RLPEncoder.sol#L11-L11), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/RLPEncoder.sol#L24-L24), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/RLPEncoder.sol#L46-L48), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/RLPEncoder.sol#L54-L55), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/RLPEncoder.sol#L60-L60), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/RLPEncoder.sol#L81-L83)


```solidity

File: contracts/libraries/SystemContractHelper.sol

14: /// @notice NOTE: The `getZkSyncMeta` that is used to obtain this struct will experience a breaking change in 2024.
15: struct ZkSyncMeta {

116:     /// @notice packs precompile parameters into one word
117:     /// @param _inputMemoryOffset The memory offset in 32-byte words for the input data for calling the precompile.
118:     /// @param _inputMemoryLength The length of the input data in words.
119:     /// @param _outputMemoryOffset The memory offset in 32-byte words for the output data.
120:     /// @param _outputMemoryLength The length of the output data in words.
121:     /// @param _perPrecompileInterpreted The constant, the meaning of which is defined separately for
122:     /// each precompile. For information, please read the documentation of the precompilecall log in
123:     /// the VM.

178:     /// @notice Initialize a new event.
179:     /// @param initializer The event initializing value.
180:     /// @param value1 The first topic or data chunk.

188:     /// @notice Continue writing the previously initialized event.
189:     /// @param value1 The first topic or data chunk.
190:     /// @param value2 The second topic or data chunk.

210:     /// @notice Returns the bits [offset..offset+size-1] of the meta.
211:     /// @param meta Packed representation of the ZkSyncMeta.
212:     /// @param offset The offset of the bits.
213:     /// @param size The size of the extracted number in bits.
214:     /// @return result The extracted number.

222:     /// @notice Given the packed representation of `ZkSyncMeta`, retrieves the number of gas
223:     /// that a single byte sent to L1 as pubdata costs.
224:     /// @notice NOTE: The behavior of this function will experience a breaking change in 2024.
225:     /// @param meta Packed representation of the ZkSyncMeta.
226:     /// @return pubdataPublished The current price in gas per pubdata byte.

276:     /// @notice Retrieves the ZkSyncMeta structure.
277:     /// @notice NOTE: The behavior of this function will experience a breaking change in 2024.
278:     /// @return meta The ZkSyncMeta execution context parameters.

327:     /// @notice Retuns whether the current call is a system call.
328:     /// @return `true` or `false` based on whether the current call is a system call.

335:     /// @notice Returns whether the address is a system contract.
336:     /// @param _address The address to test
337:     /// @return `true` or `false` based on whether the `_address` is a system contract.

342:     /// @notice Method used for burning a certain amount of gas.
343:     /// @param _gasToPay The number of gas to burn.


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L14-L15) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L116-L123), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L178-L180), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L188-L190), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L210-L214), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L222-L226), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L276-L278), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L327-L328), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L335-L337), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L342-L343)


```solidity

File: contracts/libraries/SystemContractsCaller.sol

240:     /// @notice Calculates the packed representation of the FarCallABI with zero fat pointer fields.
241:     /// @param gasPassed The gas to pass with the call.
242:     /// @param shardId Of the account to call. Currently only 0 is supported.
243:     /// @param forwardingMode The forwarding mode to use:
244:     /// - provide CalldataForwardingMode.UseHeap when using your current memory
245:     /// - provide CalldataForwardingMode.ForwardFatPointer when using custom pointer.
246:     /// @param isConstructorCall Whether the call will be a call to the constructor
247:     /// (ignored when the caller is not a system contract).
248:     /// @param isSystemCall Whether the call will have the `isSystem` flag.
249:     /// @return farCallAbiWithEmptyFatPtr The far call ABI with zero fat pointer fields.


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractsCaller.sol#L240-L249) 


```solidity

File: contracts/libraries/TransactionHelper.sol

24: /// @notice Structure used to represent a zkSync transaction.
25: struct Transaction {

73: /**
74:  * @author Matter Labs
75:  * @custom:security-contact security@matterlabs.dev
76:  * @notice Library is used to help custom accounts to work with common methods for the Transaction type.
77:  */

98:     /// @notice Calculate the suggested signed hash of the transaction,
99:     /// i.e. the hash that is signed by EOAs and is recommended to be signed by other accounts.

116:     /// @notice Encode hash of the zkSync native transaction type.
117:     /// @return keccak256 hash of the EIP-712 encoded representation of transaction

145:     /// @notice Encode hash of the legacy transaction type.
146:     /// @return keccak256 of the serialized RLP encoded representation of transaction

217:     /// @notice Encode hash of the EIP2930 transaction type.
218:     /// @return keccak256 of the serialized RLP encoded representation of transaction

287:     /// @notice Encode hash of the EIP1559 transaction type.
288:     /// @return keccak256 of the serialized RLP encoded representation of transaction

359:     /// @notice Processes the common paymaster flows, e.g. setting proper allowance
360:     /// for tokens, etc. For more information on the expected behavior, check out
361:     /// the "Paymaster flows" section in the documentation.

405:     function totalRequiredBalance(Transaction calldata _transaction) internal pure returns (uint256 requiredBalance) {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L24-L25) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L73-L77), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L98-L99), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L116-L117), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L145-L146), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L217-L218), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L287-L288), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L359-L361), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L405-L405)


```solidity

File: contracts/libraries/UnsafeBytesCalldata.sol

19:     function readUint16(bytes calldata _bytes, uint256 _start) internal pure returns (uint16 result) {

26:     function readUint32(bytes calldata _bytes, uint256 _start) internal pure returns (uint32 result) {

33:     function readUint64(bytes calldata _bytes, uint256 _start) internal pure returns (uint64 result) {

40:     function readBytes32(bytes calldata _bytes, uint256 _start) internal pure returns (bytes32 result) {

46:     function readUint256(bytes calldata _bytes, uint256 _start) internal pure returns (uint256 result) {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/UnsafeBytesCalldata.sol#L19-L19) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/UnsafeBytesCalldata.sol#L26-L26), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/UnsafeBytesCalldata.sol#L33-L33), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/UnsafeBytesCalldata.sol#L40-L40), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/UnsafeBytesCalldata.sol#L46-L46)


```solidity

File: contracts/libraries/Utils.sol

20:     function safeCastToU128(uint256 _x) internal pure returns (uint128) {

26:     function safeCastToU32(uint256 _x) internal pure returns (uint32) {

32:     function safeCastToU24(uint256 _x) internal pure returns (uint24) {

38:     /// @return codeLength The bytecode length in bytes

43:     /// @return codeLengthInWords The bytecode length in machine words

50:     /// @notice Denotes whether bytecode hash corresponds to a contract that already constructed

55:     /// @notice Denotes whether bytecode hash corresponds to a contract that is on constructor or has already been constructed

60:     /// @notice Sets "isConstructor" flag to TRUE for the bytecode hash
61:     /// @param _bytecodeHash The bytecode hash for which it is needed to set the constructing flag
62:     /// @return The bytecode hash with "isConstructor" flag set to TRUE

68:     /// @notice Sets "isConstructor" flag to FALSE for the bytecode hash
69:     /// @param _bytecodeHash The bytecode hash for which it is needed to set the constructing flag
70:     /// @return The bytecode hash with "isConstructor" flag set to FALSE

75:     /// @notice Validate the bytecode format and calculate its hash.
76:     /// @param _bytecode The bytecode to hash.
77:     /// @return hashedBytecode The 32-byte hash of the bytecode.
78:     /// Note: The function reverts the execution if the bytecode has non expected format:
79:     /// - Bytecode bytes length is not a multiple of 32
80:     /// - Bytecode bytes length is not less than 2^21 bytes (2^16 words)
81:     /// - Bytecode words length is not odd


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L20-L20) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L26-L26), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L32-L32), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L38-L38), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L43-L43), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L50-L50), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L55-L55), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L60-L62), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L68-L70), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L75-L81)


```solidity

File: contracts/interfaces/IAccount.sol

9: interface IAccount {

26:     function executeTransaction(

34:     function executeTransactionFromOutside(Transaction calldata _transaction) external payable;

36:     function payForTransaction(

42:     function prepareForPaymaster(


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IAccount.sol#L9-L9) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IAccount.sol#L26-L26), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IAccount.sol#L34-L34), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IAccount.sol#L36-L36), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IAccount.sol#L42-L42)


```solidity

File: contracts/interfaces/IAccountCodeStorage.sol

5: interface IAccountCodeStorage {

6:     function storeAccountConstructingCodeHash(address _address, bytes32 _hash) external;

8:     function storeAccountConstructedCodeHash(address _address, bytes32 _hash) external;

10:     function markAccountCodeHashAsConstructed(address _address) external;

12:     function getRawCodeHash(address _address) external view returns (bytes32 codeHash);

14:     function getCodeHash(uint256 _input) external view returns (bytes32 codeHash);

16:     function getCodeSize(uint256 _input) external view returns (uint256 codeSize);


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IAccountCodeStorage.sol#L5-L5) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IAccountCodeStorage.sol#L6-L6), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IAccountCodeStorage.sol#L8-L8), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IAccountCodeStorage.sol#L10-L10), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IAccountCodeStorage.sol#L12-L12), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IAccountCodeStorage.sol#L14-L14), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IAccountCodeStorage.sol#L16-L16)


```solidity

File: contracts/interfaces/IBaseToken.sol

5: interface IBaseToken {

6:     function balanceOf(uint256) external view returns (uint256);

8:     function transferFromTo(address _from, address _to, uint256 _amount) external;

10:     function totalSupply() external view returns (uint256);

12:     function name() external pure returns (string memory);

14:     function symbol() external pure returns (string memory);

16:     function decimals() external pure returns (uint8);

18:     function mint(address _account, uint256 _amount) external;

20:     function withdraw(address _l1Receiver) external payable;

22:     function withdrawWithMessage(address _l1Receiver, bytes calldata _additionalData) external payable;

24:     event Mint(address indexed account, uint256 amount);

26:     event Transfer(address indexed from, address indexed to, uint256 value);

28:     event Withdrawal(address indexed _l2Sender, address indexed _l1Receiver, uint256 _amount);

30:     event WithdrawalWithMessage(


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IBaseToken.sol#L5-L5) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IBaseToken.sol#L6-L6), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IBaseToken.sol#L8-L8), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IBaseToken.sol#L10-L10), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IBaseToken.sol#L12-L12), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IBaseToken.sol#L14-L14), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IBaseToken.sol#L16-L16), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IBaseToken.sol#L18-L18), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IBaseToken.sol#L20-L20), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IBaseToken.sol#L22-L22), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IBaseToken.sol#L24-L24), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IBaseToken.sol#L26-L26), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IBaseToken.sol#L28-L28), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IBaseToken.sol#L30-L30)


```solidity

File: contracts/interfaces/IBootloaderUtilities.sol

7: interface IBootloaderUtilities {

8:     function getTransactionHashes(


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IBootloaderUtilities.sol#L7-L7) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IBootloaderUtilities.sol#L8-L8)


```solidity

File: contracts/interfaces/IComplexUpgrader.sol

5: /**
6:  * @author Matter Labs
7:  * @custom:security-contact security@matterlabs.dev
8:  * @notice The interface for the ComplexUpgrader contract.
9:  */

11:     function upgrade(address _delegateTo, bytes calldata _calldata) external payable;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IComplexUpgrader.sol#L5-L9) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IComplexUpgrader.sol#L11-L11)


```solidity

File: contracts/interfaces/ICompressor.sol

12: /**
13:  * @author Matter Labs
14:  * @custom:security-contact security@matterlabs.dev
15:  * @notice The interface for the Compressor contract, responsible for verifying the correctness of
16:  * the compression of the state diffs and bytecodes.
17:  */

19:     function publishCompressedBytecode(

24:     function verifyCompressedStateDiffs(


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ICompressor.sol#L12-L17) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ICompressor.sol#L19-L19), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ICompressor.sol#L24-L24)


```solidity

File: contracts/interfaces/IContractDeployer.sol

5: interface IContractDeployer {

28:     struct AccountInfo {

33:     event ContractDeployed(

39:     event AccountNonceOrderingUpdated(address indexed accountAddress, AccountNonceOrdering nonceOrdering);

41:     event AccountVersionUpdated(address indexed accountAddress, AccountAbstractionVersion aaVersion);

43:     function getNewAddressCreate2(

50:     function getNewAddressCreate(address _sender, uint256 _senderNonce) external pure returns (address newAddress);

52:     function create2(

58:     function create2Account(

83:     /// @notice Returns the information about a certain AA.

86:     /// @notice Can be called by an account to update its account version

89:     /// @notice Can be called by an account to update its nonce ordering


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IContractDeployer.sol#L5-L5) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IContractDeployer.sol#L28-L28), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IContractDeployer.sol#L33-L33), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IContractDeployer.sol#L39-L39), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IContractDeployer.sol#L41-L41), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IContractDeployer.sol#L43-L43), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IContractDeployer.sol#L50-L50), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IContractDeployer.sol#L52-L52), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IContractDeployer.sol#L58-L58), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IContractDeployer.sol#L83-L83), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IContractDeployer.sol#L86-L86), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IContractDeployer.sol#L89-L89)


```solidity

File: contracts/interfaces/IImmutableSimulator.sol

5: struct ImmutableData {

10: interface IImmutableSimulator {

11:     function getImmutable(address _dest, uint256 _index) external view returns (bytes32);

13:     function setImmutables(address _dest, ImmutableData[] calldata _immutables) external;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IImmutableSimulator.sol#L5-L5) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IImmutableSimulator.sol#L10-L10), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IImmutableSimulator.sol#L11-L11), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IImmutableSimulator.sol#L13-L13)


```solidity

File: contracts/interfaces/IKnownCodesStorage.sol

05: /**
06:  * @author Matter Labs
07:  * @custom:security-contact security@matterlabs.dev
08:  * @notice The interface for the KnownCodesStorage contract, which is responsible
09:  * for storing the hashes of the bytecodes that have been published to the network.
10:  */

12:     event MarkedAsKnown(bytes32 indexed bytecodeHash, bool indexed sendBytecodeToL1);

14:     function markFactoryDeps(bool _shouldSendToL1, bytes32[] calldata _hashes) external;

16:     function markBytecodeAsPublished(bytes32 _bytecodeHash) external;

18:     function getMarker(bytes32 _hash) external view returns (uint256);


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IKnownCodesStorage.sol#L5-L10) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IKnownCodesStorage.sol#L12-L12), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IKnownCodesStorage.sol#L14-L14), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IKnownCodesStorage.sol#L16-L16), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IKnownCodesStorage.sol#L18-L18)


```solidity

File: contracts/interfaces/IL1Messenger.sol

35: /**
36:  * @author Matter Labs
37:  * @custom:security-contact security@matterlabs.dev
38:  * @notice The interface of the L1 Messenger contract, responsible for sending messages to L1.
39:  */

43:     event L1MessageSent(address indexed _sender, bytes32 indexed _hash, bytes _message);

45:     event L2ToL1LogSent(L2ToL1Log _l2log);

47:     event BytecodeL1PublicationRequested(bytes32 _bytecodeHash);

49:     function sendToL1(bytes memory _message) external returns (bytes32);

51:     function sendL2ToL1Log(bool _isService, bytes32 _key, bytes32 _value) external returns (uint256 logIdInMerkleTree);

54:     function requestBytecodeL1Publication(bytes32 _bytecodeHash) external;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IL1Messenger.sol#L35-L39) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IL1Messenger.sol#L43-L43), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IL1Messenger.sol#L45-L45), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IL1Messenger.sol#L47-L47), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IL1Messenger.sol#L49-L49), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IL1Messenger.sol#L51-L51), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IL1Messenger.sol#L54-L54)


```solidity

File: contracts/interfaces/IL2StandardToken.sol

5: interface IL2StandardToken {

6:     event BridgeMint(address indexed _account, uint256 _amount);

8:     event BridgeBurn(address indexed _account, uint256 _amount);

10:     function bridgeMint(address _account, uint256 _amount) external;

12:     function bridgeBurn(address _account, uint256 _amount) external;

14:     function l1Address() external view returns (address);

16:     function l2Bridge() external view returns (address);


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IL2StandardToken.sol#L5-L5) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IL2StandardToken.sol#L6-L6), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IL2StandardToken.sol#L8-L8), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IL2StandardToken.sol#L10-L10), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IL2StandardToken.sol#L12-L12), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IL2StandardToken.sol#L14-L14), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IL2StandardToken.sol#L16-L16)


```solidity

File: contracts/interfaces/IMailbox.sol

5: interface IMailbox {

6:     function finalizeEthWithdrawal(


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IMailbox.sol#L5-L5) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IMailbox.sol#L6-L6)


```solidity

File: contracts/interfaces/INonceHolder.sol

14:     event ValueSetUnderNonce(address indexed accountAddress, uint256 indexed key, uint256 value);


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/INonceHolder.sol#L14-L14) 


```solidity

File: contracts/interfaces/IPaymaster.sol

14: interface IPaymaster {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IPaymaster.sol#L14-L14) 


```solidity

File: contracts/interfaces/IPaymasterFlow.sol

13:     function general(bytes calldata input) external;

15:     function approvalBased(address _token, uint256 _minAllowance, bytes calldata _innerInput) external;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IPaymasterFlow.sol#L13-L13) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IPaymasterFlow.sol#L15-L15)


```solidity

File: contracts/interfaces/IPubdataChunkPublisher.sol

4: /**
5:  * @author Matter Labs
6:  * @custom:security-contact security@matterlabs.dev
7:  * @notice Interface for contract responsible chunking pubdata into the appropriate size for EIP-4844 blobs.
8:  */

10:     /// @notice Chunks pubdata into pieces that can fit into blobs.
11:     /// @param _pubdata The total l2 to l1 pubdata that will be sent via L1 blobs.


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IPubdataChunkPublisher.sol#L4-L8) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IPubdataChunkPublisher.sol#L10-L11)


```solidity

File: contracts/interfaces/ISystemContext.sol

05: /**
06:  * @author Matter Labs
07:  * @custom:security-contact security@matterlabs.dev
08:  * @notice Contract that stores some of the context variables, that may be either
09:  * block-scoped, tx-scoped or system-wide.
10:  */

12:     struct BlockInfo {

30:     function chainId() external view returns (uint256);

32:     function origin() external view returns (address);

34:     function gasPrice() external view returns (uint256);

36:     function blockGasLimit() external view returns (uint256);

38:     function coinbase() external view returns (address);

40:     function difficulty() external view returns (uint256);

42:     function baseFee() external view returns (uint256);

44:     function txNumberInBlock() external view returns (uint16);

46:     function getBlockHashEVM(uint256 _block) external view returns (bytes32);

48:     function getBatchHash(uint256 _batchNumber) external view returns (bytes32 hash);

50:     function getBlockNumber() external view returns (uint128);

52:     function getBlockTimestamp() external view returns (uint128);

54:     function getBatchNumberAndTimestamp() external view returns (uint128 blockNumber, uint128 blockTimestamp);

56:     function getL2BlockNumberAndTimestamp() external view returns (uint128 blockNumber, uint128 blockTimestamp);

58:     function gasPerPubdataByte() external view returns (uint256 gasPerPubdataByte);

60:     function getCurrentPubdataSpent() external view returns (uint256 currentPubdataSpent);


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ISystemContext.sol#L5-L10) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ISystemContext.sol#L12-L12), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ISystemContext.sol#L30-L30), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ISystemContext.sol#L32-L32), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ISystemContext.sol#L34-L34), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ISystemContext.sol#L36-L36), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ISystemContext.sol#L38-L38), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ISystemContext.sol#L40-L40), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ISystemContext.sol#L42-L42), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ISystemContext.sol#L44-L44), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ISystemContext.sol#L46-L46), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ISystemContext.sol#L48-L48), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ISystemContext.sol#L50-L50), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ISystemContext.sol#L52-L52), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ISystemContext.sol#L54-L54), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ISystemContext.sol#L56-L56), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ISystemContext.sol#L58-L58), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ISystemContext.sol#L60-L60)


```solidity

File: contracts/interfaces/ISystemContextDeprecated.sol

5: /**
6:  * @author Matter Labs
7:  * @custom:security-contact security@matterlabs.dev
8:  * @notice The interface with deprecated functions of the SystemContext contract. It is aimed for backward compatibility.
9:  */

11:     function currentBlockInfo() external view returns (uint256);

13:     function getBlockNumberAndTimestamp() external view returns (uint256 blockNumber, uint256 blockTimestamp);

15:     function blockHash(uint256 _blockNumber) external view returns (bytes32 hash);


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ISystemContextDeprecated.sol#L5-L9) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ISystemContextDeprecated.sol#L11-L11), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ISystemContextDeprecated.sol#L13-L13), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ISystemContextDeprecated.sol#L15-L15)


```solidity

File: contracts/interfaces/ISystemContract.sol

18:     /// @notice Modifier that makes sure that the method
19:     /// can only be called via a system call.

28:     /// @notice Modifier that makes sure that the method
29:     /// can only be called from a system contract.

38:     /// @notice Modifier that makes sure that the method
39:     /// can only be called from a special given address.

45:     /// @notice Modifier that makes sure that the method
46:     /// can only be called from the bootloader.

52:     /// @notice Modifier that makes sure that the method
53:     /// can only be called from the L1 force deployer.


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ISystemContract.sol#L18-L19) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ISystemContract.sol#L28-L29), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ISystemContract.sol#L38-L39), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ISystemContract.sol#L45-L46), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ISystemContract.sol#L52-L53)


```solidity

File: contracts/bridge/L1ERC20Bridge.sol

74:     /// @return The L2 token address that would be minted for deposit of the given L1 token on zkSync Era.

202:     /// @notice Finalize the withdrawal and release funds
203:     /// @param _l2BatchNumber The L2 batch number where the withdrawal was processed
204:     /// @param _l2MessageIndex The position in the L2 logs Merkle tree of the l2Log that was sent with the message
205:     /// @param _l2TxNumberInBatch The L2 transaction number in the batch, in which the log was sent
206:     /// @param _message The L2 withdraw data, stored in an L2 -> L1 message
207:     /// @param _merkleProof The Merkle proof of the inclusion L2 -> L1 message about withdrawal initialization


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1ERC20Bridge.sol#L74-L74) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1ERC20Bridge.sol#L202-L207)


```solidity

File: contracts/bridge/L1SharedBridge.sol

67:     /// @notice Checks that the message sender is the bridgehub.

73:     /// @notice Checks that the message sender is the bridgehub or zkSync Era Diamond Proxy.

82:     /// @notice Checks that the message sender is the legacy bridge.

137:     function receiveEth(uint256 _chainId) external payable {

181:     /// @notice Initiates a deposit transaction within Bridgehub, used by `requestL2TransactionTwoBridges`.

230:     /// @notice Confirms the acceptance of a transaction by the Mailbox, as part of the L2 transaction process within Bridgehub.
231:     /// This function is utilized by `requestL2TransactionTwoBridges` to validate the execution of a transaction.

378:     /// @notice Finalize the withdrawal and release funds
379:     /// @param _chainId The chain ID of the transaction to check
380:     /// @param _l2BatchNumber The L2 batch number where the withdrawal was processed
381:     /// @param _l2MessageIndex The position in the L2 logs Merkle tree of the l2Log that was sent with the message
382:     /// @param _l2TxNumberInBatch The L2 transaction number in the batch, in which the log was sent
383:     /// @param _message The L2 withdraw data, stored in an L2 -> L1 message
384:     /// @param _merkleProof The Merkle proof of the inclusion L2 -> L1 message about withdrawal initialization

401:     struct MessageParams {

487:     function _parseL2WithdrawalMessage(

605:     /// @notice Finalizes the withdrawal for transactions initiated via the legacy ERC20 bridge.
606:     /// @param _l2BatchNumber The L2 batch number where the withdrawal was processed
607:     /// @param _l2MessageIndex The position in the L2 logs Merkle tree of the l2Log that was sent with the message
608:     /// @param _l2TxNumberInBatch The L2 transaction number in the batch, in which the log was sent
609:     /// @param _message The L2 withdraw data, stored in an L2 -> L1 message
610:     /// @param _merkleProof The Merkle proof of the inclusion L2 -> L1 message about withdrawal initialization
611:     ///
612:     /// @return l1Receiver The address on L1 that will receive the withdrawn funds
613:     /// @return l1Token The address of the L1 token being withdrawn
614:     /// @return amount The amount of the token being withdrawns

632:     /// @notice Withdraw funds from the initiated deposit, that failed when finalizing on zkSync Era chain.
633:     /// This function is specifically designed for maintaining backward-compatibility with legacy `claimFailedDeposit`
634:     /// method in `L1ERC20Bridge`.
635:     ///
636:     /// @param _depositSender The address of the deposit initiator
637:     /// @param _l1Token The address of the deposited L1 ERC20 token
638:     /// @param _amount The amount of the deposit that failed.
639:     /// @param _l2TxHash The L2 transaction hash of the failed deposit finalization
640:     /// @param _l2BatchNumber The L2 batch number where the deposit finalization was processed
641:     /// @param _l2MessageIndex The position in the L2 logs Merkle tree of the l2Log that was sent with the message
642:     /// @param _l2TxNumberInBatch The L2 transaction number in a batch, in which the log was sent
643:     /// @param _merkleProof The Merkle proof of the processing L1 -> L2 transaction with deposit finalization


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L67-L67) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L73-L73), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L82-L82), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L137-L137), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L181-L181), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L230-L231), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L378-L384), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L401-L401), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L487-L487), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L605-L614), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L632-L643)


```solidity

File: contracts/bridgehub/Bridgehub.sol

16: contract Bridgehub is IBridgehub, ReentrancyGuard, Ownable2Step {

37:     /// @notice to avoid parity hack

40:     /// @notice used to initialize the contract

45:     modifier onlyOwnerOrAdmin() {

50:     /// @inheritdoc IBridgehub

59:     /// @inheritdoc IBridgehub

74:     /// @notice return the state transition chain contract for a chainId

81:     /// @notice State Transition can be any contract with the appropriate interface/functionality

90:     /// @notice State Transition can be any contract with the appropriate interface/functionality
91:     /// @notice this stops new Chains from using the STF, old chains are not affected

100:     /// @notice token can be any contract with the appropriate interface/functionality

106:     /// @notice To set shared bridge, only Owner. Not done in initialize, as
107:     /// the order of deployment is Bridgehub, Shared bridge, and then we call this

112:     /// @notice register new chain
113:     /// @notice for Eth the baseToken address is 1

151:     /// @notice forwards function call to Mailbox based on ChainId

163:     /// @notice forwards function call to Mailbox based on ChainId

175:     /// @notice forwards function call to Mailbox based on ChainId

197:     /// @notice forwards function call to Mailbox based on ChainId

213:     /// @notice the mailbox is called directly after the sharedBridge received the deposit
214:     /// this assumes that either ether is the base token or
215:     /// the msg.sender has approved mintValue allowance for the sharedBridge.
216:     /// This means this is not ideal for contract calls, as the contract would have to handle token allowance of the base Token

253:     /// @notice After depositing funds to the sharedBridge, the secondBridge is called
254:     ///  to return the actual L2 message which is sent to the Mailbox.
255:     ///  This assumes that either ether is the base token or
256:     ///  the msg.sender has approved the sharedBridge with the mintValue,
257:     ///  and also the necessary approvals are given for the second bridge.
258:     /// @notice The logic of this bridge is to allow easy depositing for bridges.
259:     /// Each contract that handles the users ERC20 tokens needs approvals from the user, this contract allows
260:     /// the user to approve for each token only its respective bridge
261:     /// @notice This function is great for contract calls to L2, the secondBridge can be any contract.

325:     function _actualRefundRecipient(address _refundRecipient) internal view returns (address _recipient) {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L16-L16) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L37-L37), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L40-L40), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L45-L45), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L50-L50), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L59-L59), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L74-L74), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L81-L81), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L90-L91), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L100-L100), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L106-L107), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L112-L113), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L151-L151), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L163-L163), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L175-L175), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L197-L197), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L213-L216), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L253-L261), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L325-L325)


```solidity

File: contracts/governance/Governance.sol

37:     /// @notice Initializes the contract with the admin address, security council address, and minimum delay.
38:     /// @param _admin The address to be assigned as the admin of the contract.
39:     /// @param _securityCouncil The address to be assigned as the security council of the contract.
40:     /// @param _minDelay The initial minimum delay (in seconds) to be set for operations.

57:     /// @notice Checks that the message sender is contract itself.

63:     /// @notice Checks that the message sender is an active security council.

69:     /// @notice Checks that the message sender is an active owner or an active security council.


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/Governance.sol#L37-L40) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/Governance.sol#L57-L57), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/Governance.sol#L63-L63), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/Governance.sol#L69-L69)


```solidity

File: contracts/state-transition/StateTransitionManager.sol

22: /// @title StateTransition contract
23: /// @author Matter Labs
24: /// @custom:security-contact security@matterlabs.dev
25: contract StateTransitionManager is IStateTransitionManager, ReentrancyGuard, Ownable2Step {

62:     /// @notice only the bridgehub can call

68:     /// @notice the admin can call, for non-critical updates

74:     function getChainAdmin(uint256 _chainId) external view override returns (address) {

109:     /// @inheritdoc IStateTransitionManager

118:     /// @inheritdoc IStateTransitionManager

230:     function registerAlreadyDeployedStateTransition(

238:     /// @notice called by Bridgehub when a chain registers


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L22-L25) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L62-L62), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L68-L68), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L74-L74), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L109-L109), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L118-L118), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L230-L230), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L238-L238)


```solidity

File: contracts/state-transition/ValidatorTimelock.sol

28:     /// @notice The delay between committing and executing batches is changed.

31:     /// @notice A new validator has been added.

34:     /// @notice A validator has been removed.

37:     /// @notice Error for when an address is already a validator.

40:     /// @notice Error for when an address is not a validator.

55:     constructor(address _initialOwner, uint32 _executionDelay) {

60:     /// @notice Checks if the caller is the admin of the chain.

66:     /// @notice Checks if the caller is a validator.


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L28-L28) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L31-L31), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L34-L34), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L37-L37), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L40-L40), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L55-L55), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L60-L60), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L66-L66)


```solidity

File: contracts/state-transition/chain-deps/DiamondInit.sol

21:     /// @notice hyperchain diamond contract initialization
22:     /// @return Magic 32 bytes, which indicates that the contract logic is expected to be used as a diamond proxy
23:     /// initializer


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/DiamondInit.sol#L21-L23) 


```solidity

File: contracts/state-transition/chain-deps/DiamondProxy.sol

07: /// @title Diamond Proxy Contract (EIP-2535)
08: /// @author Matter Labs
09: /// @custom:security-contact security@matterlabs.dev
10: contract DiamondProxy {

11:     constructor(uint256 _chainId, Diamond.DiamondCutData memory _diamondCut) {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/DiamondProxy.sol#L7-L10) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/DiamondProxy.sol#L11-L11)


```solidity

File: contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol

44: /// @notice The fee params for L1->L2 transactions for the network.
45: /// @param pubdataPricingMode How the users will charged for pubdata in L1->L2 transactions.
46: /// @param batchOverheadL1Gas The amount of L1 gas required to process the batch (except for the calldata).
47: /// @param maxPubdataPerBatch The maximal number of pubdata that can be emitted per batch.
48: /// @param priorityTxMaxPubdata The maximal amount of pubdata a priority transaction is allowed to publish.
49: /// It can be slightly less than maxPubdataPerBatch in order to have some margin for the bootloader execution.
50: /// @param minimalL2GasPrice The minimal L2 gas price to be used by L1->L2 transactions. It should represent
51: /// the price that a single unit of compute costs.
52: struct FeeParams {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L44-L52) 


```solidity

File: contracts/state-transition/chain-deps/facets/Admin.sol

15: /// @title Admin Contract controls access rights for contract management.
16: /// @author Matter Labs
17: /// @custom:security-contact security@matterlabs.dev
18: contract AdminFacet is ZkSyncStateTransitionBase, IAdmin {

22:     /// @inheritdoc IAdmin

31:     /// @inheritdoc IAdmin

44:     /// @inheritdoc IAdmin

50:     /// @inheritdoc IAdmin

57:     /// @inheritdoc IAdmin

66:     /// @inheritdoc IAdmin

78:     /// @inheritdoc IAdmin

89:     function setValidiumMode(PubdataPricingMode _validiumMode) external onlyAdmin {

99:     /// upgrade a specific chain

122:     /// @inheritdoc IAdmin

132:     /// @inheritdoc IAdmin

142:     /// @inheritdoc IAdmin


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Admin.sol#L15-L18) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Admin.sol#L22-L22), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Admin.sol#L31-L31), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Admin.sol#L44-L44), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Admin.sol#L50-L50), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Admin.sol#L57-L57), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Admin.sol#L66-L66), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Admin.sol#L78-L78), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Admin.sol#L89-L89), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Admin.sol#L99-L99), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Admin.sol#L122-L122), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Admin.sol#L132-L132), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Admin.sol#L142-L142)


```solidity

File: contracts/state-transition/chain-deps/facets/Executor.sol

19: /// @title zkSync hyperchain Executor contract capable of processing events emitted in the zkSync hyperchain protocol.
20: /// @author Matter Labs
21: /// @custom:security-contact security@matterlabs.dev
22: contract ExecutorFacet is ZkSyncStateTransitionBase, IExecutor {

099:     /// @notice checks that the timestamps of both the new batch and the new L2 block are correct.
100:     /// @param _packedBatchAndL2BlockTimestamp - packed batch and L2 block timestamp in a format of batchTimestamp * 2**128 + l2BatchTimestamp
101:     /// @param _expectedBatchTimestamp - expected batch timestamp
102:     /// @param _previousBatchTimestamp - the timestamp of the previous batch

198:     /// @inheritdoc IExecutor

206:     /// @inheritdoc IExecutor

215:     function _commitBatches(

336:     /// @inheritdoc IExecutor

344:     /// @inheritdoc IExecutor

349:     function _executeBatches(StoredBatchInfo[] calldata _batchesData) internal {

367:     /// @inheritdoc IExecutor

376:     /// @inheritdoc IExecutor

386:     function _proveBatches(

440:     function _verifyProof(uint256[] memory proofPublicInput, ProofInput calldata _proof) internal view {

471:     /// @inheritdoc IExecutor

476:     /// @inheritdoc IExecutor

481:     function _revertBatches(uint256 _newLastBatch) internal {

515:     function _batchPassThroughData(CommitBatchInfo calldata _batch) internal pure returns (bytes memory) {

525:     function _batchMetaParameters() internal view returns (bytes memory) {

537:     function _batchAuxiliaryOutput(

586:     /// @notice Returns the keccak hash of the ABI-encoded StoredBatchInfo

591:     /// @notice Returns true if the bit at index {_index} is 1

596:     /// @notice Sets the given bit in {_num} at index {_index} to 1.

601:     /// @notice Calls the point evaluation precompile and verifies the output
602:     /// Verify p(z) = y given commitment that corresponds to the polynomial p(x) and a KZG proof.
603:     /// Also verify that the provided commitment matches the provided versioned_hash.
604:     ///


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L19-L22) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L99-L102), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L198-L198), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L206-L206), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L215-L215), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L336-L336), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L344-L344), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L349-L349), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L367-L367), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L376-L376), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L386-L386), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L440-L440), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L471-L471), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L476-L476), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L481-L481), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L515-L515), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L525-L525), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L537-L537), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L586-L586), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L591-L591), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L596-L596), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L601-L604)


```solidity

File: contracts/state-transition/chain-deps/facets/Getters.sol

17: /// @title Getters Contract implements functions for getting contract state from outside the blockchain.
18: /// @author Matter Labs
19: /// @custom:security-contact security@matterlabs.dev
20: contract GettersFacet is ZkSyncStateTransitionBase, IGetters, ILegacyGetters {

31:     /// @inheritdoc IGetters

36:     /// @inheritdoc IGetters

41:     /// @inheritdoc IGetters

46:     /// @inheritdoc IGetters

51:     /// @inheritdoc IGetters

56:     /// @inheritdoc IGetters

61:     /// @inheritdoc IGetters

66:     /// @inheritdoc IGetters

71:     /// @inheritdoc IGetters

76:     /// @inheritdoc IGetters

81:     /// @inheritdoc IGetters

86:     /// @inheritdoc IGetters

91:     /// @inheritdoc IGetters

96:     /// @inheritdoc IGetters

101:     /// @inheritdoc IGetters

106:     /// @inheritdoc IGetters

111:     /// @inheritdoc IGetters

116:     /// @inheritdoc IGetters

121:     /// @inheritdoc IGetters

126:     /// @inheritdoc IGetters

131:     /// @inheritdoc IGetters

136:     /// @inheritdoc IGetters

141:     /// @inheritdoc IGetters

146:     /// @inheritdoc IGetters

151:     /// @inheritdoc IGetters

156:     /// @inheritdoc IGetters

162:     /// @inheritdoc IGetters

175:     /// @inheritdoc IGetters

180:     /// @inheritdoc IGetters

187:     /// @inheritdoc IGetters

192:     /// @inheritdoc IGetters

201:     /// @inheritdoc IGetters

216:     /// @inheritdoc IGetters

222:     /// @inheritdoc IGetters

228:     /// @inheritdoc IGetters

238:     /// @inheritdoc ILegacyGetters

243:     /// @inheritdoc ILegacyGetters

248:     /// @inheritdoc ILegacyGetters

253:     /// @inheritdoc ILegacyGetters

258:     /// @inheritdoc ILegacyGetters


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L17-L20) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L31-L31), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L36-L36), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L41-L41), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L46-L46), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L51-L51), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L56-L56), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L61-L61), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L66-L66), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L71-L71), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L76-L76), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L81-L81), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L86-L86), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L91-L91), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L96-L96), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L101-L101), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L106-L106), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L111-L111), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L116-L116), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L121-L121), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L126-L126), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L131-L131), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L136-L136), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L141-L141), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L146-L146), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L151-L151), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L156-L156), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L162-L162), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L175-L175), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L180-L180), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L187-L187), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L192-L192), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L201-L201), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L216-L216), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L222-L222), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L228-L228), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L238-L238), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L243-L243), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L248-L248), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L253-L253), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L258-L258)


```solidity

File: contracts/state-transition/chain-deps/facets/Mailbox.sol

27: /// @title zkSync Mailbox contract providing interfaces for L1 <-> L2 interaction.
28: /// @author Matter Labs
29: /// @custom:security-contact security@matterlabs.dev
30: contract MailboxFacet is ZkSyncStateTransitionBase, IMailbox {

37:     /// @inheritdoc IMailbox

46:     /// @notice when requesting transactions through the bridgehub

53:     /// @inheritdoc IMailbox

63:     /// @inheritdoc IMailbox

73:     /// @inheritdoc IMailbox

142:     /// @inheritdoc IMailbox

152:     /// @notice Derives the price for L2 gas in ETH to be paid.
153:     /// @param _l1GasPrice The gas price on L1
154:     /// @param _gasPerPubdata The price for each pubdata byte in L2 gas
155:     /// @return The price of L2 gas in ETH

177:     /// @inheritdoc IMailbox

196:     ///  @inheritdoc IMailbox

228:     function _requestL2TransactionSender(

258:     function _requestL2Transaction(

289:     function _serializeL2Transaction(

315:     /// @notice Stores a transaction record in storage & send event about that

352:     /// @notice Hashes the L2 bytecodes and returns them in the format in which they are processed by the bootloader


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L27-L30) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L37-L37), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L46-L46), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L53-L53), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L63-L63), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L73-L73), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L142-L142), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L152-L155), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L177-L177), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L196-L196), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L228-L228), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L258-L258), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L289-L289), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L315-L315), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L352-L352)


```solidity

File: contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol

08: /// @title Base contract containing functions accessible to the other facets.
09: /// @author Matter Labs
10: /// @custom:security-contact security@matterlabs.dev
11: contract ZkSyncStateTransitionBase is ReentrancyGuard {

14:     /// @notice Checks that the message sender is an active admin

20:     /// @notice Checks if validator is active

26:     modifier onlyStateTransitionManager() {

31:     modifier onlyBridgehub() {

36:     modifier onlyAdminOrStateTransitionManager() {

44:     modifier onlyValidatorOrStateTransitionManager() {

52:     modifier onlyBaseTokenBridge() {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L8-L11) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L14-L14), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L20-L20), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L26-L26), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L31-L31), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L36-L36), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L44-L44), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L52-L52)


```solidity

File: contracts/upgrades/BaseZkSyncUpgrade.sol

14: /// @notice The struct that represents the upgrade proposal.
15: /// @param l2ProtocolUpgradeTx The system upgrade transaction.
16: /// @param factoryDeps The list of factory deps for the l2ProtocolUpgradeTx.
17: /// @param bootloaderHash The hash of the new bootloader bytecode. If zero, it will not be updated.
18: /// @param defaultAccountHash The hash of the new default account bytecode. If zero, it will not be updated.
19: /// @param verifier The address of the new verifier. If zero, the verifier will not be updated.
20: /// @param verifierParams The new verifier params. If all of its fields are 0, the params will not be updated.
21: /// @param l1ContractsUpgradeCalldata Custom calldata for L1 contracts upgrade, it may be interpreted differently
22: /// in each upgrade. Usually empty.
23: /// @param postUpgradeCalldata Custom calldata for post upgrade hook, it may be interpreted differently in each
24: /// upgrade. Usually empty.
25: /// @param upgradeTimestamp The timestamp after which the upgrade can be executed.
26: /// @param newProtocolVersion The new version number for the protocol after this upgrade. Should be greater than
27: /// the previous protocol version.
28: struct ProposedUpgrade {

41: /// @author Matter Labs
42: /// @custom:security-contact security@matterlabs.dev
43: /// @notice Interface to which all the upgrade implementations should adhere
44: abstract contract BaseZkSyncUpgrade is ZkSyncStateTransitionBase {

45:     /// @notice Changes the protocol version

48:     /// @notice P!hanges to the bytecode that is used in L2 as a bootloader (start program)

51:     /// @notice P!hanges to the bytecode that is used in L2 as a default account

54:     /// @notice Verifier address changed

57:     /// @notice Verifier parameters changed

60:     /// @notice Notifies about complete upgrade

90:     /// @notice Change default account bytecode hash, that is used on L2
91:     /// @param _l2DefaultAccountBytecodeHash The hash of default account L2 bytecode

107:     /// @notice Change bootloader bytecode hash, that is used on L2
108:     /// @param _l2BootloaderBytecodeHash The hash of bootloader L2 bytecode

124:     /// @notice Change the address of the verifier smart contract
125:     /// @param _newVerifier Verifier smart contract address

140:     /// @notice Change the verifier parameters
141:     /// @param _newVerifierParams New parameters for the verifier

160:     /// @notice Updates the verifier and the verifier params
161:     /// @param _newVerifier The address of the new verifier. If 0, the verifier will not be updated.
162:     /// @param _verifierParams The new verifier params. If all of the fields are 0, the params will not be updated.

168:     /// @notice Updates the bootloader hash and the hash of the default account
169:     /// @param _bootloaderHash The hash of the new bootloader bytecode. If zero, it will not be updated.
170:     /// @param _defaultAccountHash The hash of the new default account bytecode. If zero, it will not be updated.

219:     /// @notice Verifies that the factory deps correspond to the proper hashes
220:     /// @param _factoryDeps The list of factory deps
221:     /// @param _expectedHashes The list of expected bytecode hashes

234:     /// @notice Changes the protocol version
235:     /// @param _newProtocolVersion The new protocol version

259:     /// @notice Placeholder function for custom logic for upgrading L1 contract.
260:     /// Typically this function will never be used.
261:     /// @param _customCallDataForUpgrade Custom data for an upgrade, which may be interpreted differently for each
262:     /// upgrade.

265:     /// @notice placeholder function for custom logic for post-upgrade logic.
266:     /// Typically this function will never be used.
267:     /// @param _customCallDataForUpgrade Custom data for an upgrade, which may be interpreted differently for each
268:     /// upgrade.


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgrade.sol#L14-L28) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgrade.sol#L41-L44), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgrade.sol#L45-L45), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgrade.sol#L48-L48), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgrade.sol#L51-L51), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgrade.sol#L54-L54), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgrade.sol#L57-L57), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgrade.sol#L60-L60), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgrade.sol#L90-L91), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgrade.sol#L107-L108), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgrade.sol#L124-L125), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgrade.sol#L140-L141), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgrade.sol#L160-L162), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgrade.sol#L168-L170), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgrade.sol#L219-L221), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgrade.sol#L234-L235), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgrade.sol#L259-L262), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgrade.sol#L265-L268)


```solidity

File: contracts/upgrades/BaseZkSyncUpgradeGenesis.sol

14: /// @author Matter Labs
15: /// @custom:security-contact security@matterlabs.dev
16: /// @notice Interface to which all the upgrade implementations should adhere
17: abstract contract BaseZkSyncUpgradeGenesis is BaseZkSyncUpgrade {

18:     /// @notice Changes the protocol version
19:     /// @param _newProtocolVersion The new protocol version


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L14-L17) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L18-L19)


```solidity

File: contracts/upgrades/DefaultUpgrade.sol

08: /// @author Matter Labs
09: /// @custom:security-contact security@matterlabs.dev
10: contract DefaultUpgrade is BaseZkSyncUpgrade {

11:     /// @notice The main function that will be called by the upgrade proxy.
12:     /// @param _proposedUpgrade The upgrade to be executed.


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/DefaultUpgrade.sol#L8-L10) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/DefaultUpgrade.sol#L11-L12)


```solidity

File: contracts/upgrades/GenesisUpgrade.sol

09: /// @author Matter Labs
10: /// @custom:security-contact security@matterlabs.dev
11: contract GenesisUpgrade is BaseZkSyncUpgradeGenesis {

12:     /// @notice The main function that will be called by the upgrade proxy.
13:     /// @param _proposedUpgrade The upgrade to be executed.


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/GenesisUpgrade.sol#L9-L11) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/GenesisUpgrade.sol#L12-L13)


```solidity

File: contracts/common/libraries/L2ContractHelper.sol

5: /**
6:  * @author Matter Labs
7:  * @custom:security-contact security@matterlabs.dev
8:  * @notice Helper library for working with L2 contracts on L1.
9:  */

14:     /// @notice Validate the bytecode format and calculate its hash.
15:     /// @param _bytecode The bytecode to hash.
16:     /// @return hashedBytecode The 32-byte hash of the bytecode.
17:     /// Note: The function reverts the execution if the bytecode has non expected format:
18:     /// - Bytecode bytes length is not a multiple of 32
19:     /// - Bytecode bytes length is not less than 2^21 bytes (2^16 words)
20:     /// - Bytecode words length is not odd

46:     /// @notice Returns the length of the bytecode associated with the given hash.
47:     /// @param _bytecodeHash The hash of the bytecode.
48:     /// @return codeLengthInWords The length of the bytecode in words.

53:     /// @notice Computes the create2 address for a Layer 2 contract.
54:     /// @param _sender The address of the sender.
55:     /// @param _salt The salt value to use in the create2 address computation.
56:     /// @param _bytecodeHash The contract bytecode hash.
57:     /// @param _constructorInputHash The hash of the constructor input data.
58:     /// @return The create2 address of the contract.
59:     /// NOTE: L2 create2 derivation is different from L1 derivation!


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/L2ContractHelper.sol#L5-L9) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/L2ContractHelper.sol#L14-L20), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/L2ContractHelper.sol#L46-L48), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/L2ContractHelper.sol#L53-L59)


```solidity

File: contracts/common/libraries/UncheckedMath.sol

5: /**
6:  * @author Matter Labs
7:  * @custom:security-contact security@matterlabs.dev
8:  * @notice The library for unchecked math.
9:  */

11:     function uncheckedInc(uint256 _number) internal pure returns (uint256) {

17:     function uncheckedAdd(uint256 _lhs, uint256 _rhs) internal pure returns (uint256) {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/UncheckedMath.sol#L5-L9) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/UncheckedMath.sol#L11-L11), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/UncheckedMath.sol#L17-L17)


```solidity

File: contracts/common/libraries/UnsafeBytes.sol

19:     function readUint32(bytes memory _bytes, uint256 _start) internal pure returns (uint32 result, uint256 offset) {

26:     function readAddress(bytes memory _bytes, uint256 _start) internal pure returns (address result, uint256 offset) {

33:     function readUint256(bytes memory _bytes, uint256 _start) internal pure returns (uint256 result, uint256 offset) {

40:     function readBytes32(bytes memory _bytes, uint256 _start) internal pure returns (bytes32 result, uint256 offset) {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/UnsafeBytes.sol#L19-L19) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/UnsafeBytes.sol#L26-L26), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/UnsafeBytes.sol#L33-L33), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/UnsafeBytes.sol#L40-L40)


```solidity

File: contracts/state-transition/libraries/Diamond.sol

08: /// @author Matter Labs
09: /// @custom:security-contact security@matterlabs.dev
10: /// @notice The helper library for managing the EIP-2535 diamond proxy.
11: library Diamond {

24:     event DiamondCut(FacetCut[] facetCuts, address initAddress, bytes initCalldata);

86:     /// @return diamondStorage The pointer to the storage where all specific diamond proxy parameters stored


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L8-L11) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L24-L24), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L86-L86)


```solidity

File: contracts/state-transition/libraries/Merkle.sol

7: /// @author Matter Labs
8: /// @custom:security-contact security@matterlabs.dev
9: library Merkle {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Merkle.sol#L7-L9) 


```solidity

File: contracts/state-transition/libraries/PriorityQueue.sol

23:     /// @notice Container that stores priority operations
24:     /// @param data The inner mapping that saves priority operation by its index
25:     /// @param head The pointer to the first unprocessed priority operation, equal to the tail if the queue is empty
26:     /// @param tail The pointer to the free slot

33:     /// @notice Returns zero if and only if no operations were processed from the queue
34:     /// @return Index of the oldest priority operation that wasn't processed yet

39:     /// @return The total number of priority operations that were added to the priority queue, including all processed ones

44:     /// @return The total number of unprocessed priority operations in a priority queue

49:     /// @return Whether the priority queue contains no operations

54:     /// @notice Add the priority operation to the end of the priority queue

63:     /// @return The first unprocessed priority operation from the queue

70:     /// @notice Remove the first unprocessed priority operation from the queue
71:     /// @return priorityOperation that was popped from the priority queue


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/PriorityQueue.sol#L23-L26) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/PriorityQueue.sol#L33-L34), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/PriorityQueue.sol#L39-L39), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/PriorityQueue.sol#L44-L44), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/PriorityQueue.sol#L49-L49), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/PriorityQueue.sol#L54-L54), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/PriorityQueue.sol#L63-L63), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/PriorityQueue.sol#L70-L71)


```solidity

File: contracts/state-transition/libraries/TransactionValidator.sol

10: /// @title zkSync Library for validating L1 -> L2 transactions
11: /// @author Matter Labs
12: /// @custom:security-contact security@matterlabs.dev
13: library TransactionValidator {

104:     /// @notice Based on the full L2 gas limit (that includes the batch overhead) and other
105:     /// properties of the transaction, returns the l2GasLimit for the body of the transaction (the actual execution).
106:     /// @param _totalGasLimit The L2 gas limit that includes both the overhead for processing the batch
107:     /// and the L2 gas needed to process the transaction itself (i.e. the actual l2GasLimit that will be used for the transaction).
108:     /// @param _encodingLength The length of the ABI-encoding of the transaction.


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/TransactionValidator.sol#L10-L13) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/TransactionValidator.sol#L104-L108)


```solidity

File: contracts/bridge/interfaces/IL1ERC20Bridge.sol

07: /// @title L1 Bridge contract legacy interface
08: /// @author Matter Labs
09: /// @custom:security-contact security@matterlabs.dev
10: /// @notice Legacy Bridge interface before hyperchain migration, used for backward compatibility with zkSync Era
11: interface IL1ERC20Bridge {

12:     event DepositInitiated(

20:     event WithdrawalFinalized(address indexed to, address indexed l1Token, uint256 amount);

22:     event ClaimedFailedDeposit(address indexed to, address indexed l1Token, uint256 amount);

24:     function isWithdrawalFinalized(uint256 _l2BatchNumber, uint256 _l2MessageIndex) external view returns (bool);

26:     function deposit(

35:     function deposit(

43:     function claimFailedDeposit(

53:     function finalizeWithdrawal(

61:     function l2TokenAddress(address _l1Token) external view returns (address);

63:     function sharedBridge() external view returns (IL1SharedBridge);

65:     function l2TokenBeacon() external view returns (address);

67:     function l2Bridge() external view returns (address);

69:     function depositAmount(

75:     function tranferTokenToSharedBridge(address _token, uint256 _amount) external;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1ERC20Bridge.sol#L7-L11) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1ERC20Bridge.sol#L12-L12), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1ERC20Bridge.sol#L20-L20), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1ERC20Bridge.sol#L22-L22), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1ERC20Bridge.sol#L24-L24), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1ERC20Bridge.sol#L26-L26), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1ERC20Bridge.sol#L35-L35), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1ERC20Bridge.sol#L43-L43), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1ERC20Bridge.sol#L53-L53), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1ERC20Bridge.sol#L61-L61), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1ERC20Bridge.sol#L63-L63), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1ERC20Bridge.sol#L65-L65), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1ERC20Bridge.sol#L67-L67), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1ERC20Bridge.sol#L69-L69), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1ERC20Bridge.sol#L75-L75)


```solidity

File: contracts/bridge/interfaces/IL1SharedBridge.sol

09: /// @title L1 Bridge contract interface
10: /// @author Matter Labs
11: /// @custom:security-contact security@matterlabs.dev
12: interface IL1SharedBridge {

13:     event LegacyDepositInitiated(

22:     event BridgehubDepositInitiated(

31:     event BridgehubDepositBaseTokenInitiated(

38:     event BridgehubDepositFinalized(

44:     event WithdrawalFinalizedSharedBridge(

51:     event ClaimedFailedDepositSharedBridge(

58:     function isWithdrawalFinalized(

64:     function depositLegacyErc20Bridge(

74:     function claimFailedDepositLegacyErc20Bridge(

85:     function claimFailedDeposit(

97:     function finalizeWithdrawalLegacyErc20Bridge(

105:     function finalizeWithdrawal(

114:     function l1WethAddress() external view returns (address);

116:     function bridgehub() external view returns (IBridgehub);

118:     function legacyBridge() external view returns (IL1ERC20Bridge);

120:     function l2BridgeAddress(uint256 _chainId) external view returns (address);

122:     function depositHappened(uint256 _chainId, bytes32 _l2TxHash) external view returns (bytes32);

124:     /// data is abi encoded :
125:     /// address _l1Token,
126:     /// uint256 _amount,
127:     /// address _l2Receiver

135:     function bridgehubDepositBaseToken(

142:     function bridgehubConfirmL2Transaction(uint256 _chainId, bytes32 _txDataHash, bytes32 _txHash) external;

144:     function receiveEth(uint256 _chainId) external payable;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L9-L12) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L13-L13), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L22-L22), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L31-L31), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L38-L38), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L44-L44), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L51-L51), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L58-L58), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L64-L64), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L74-L74), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L85-L85), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L97-L97), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L105-L105), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L114-L114), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L116-L116), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L118-L118), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L120-L120), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L122-L122), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L124-L127), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L135-L135), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L142-L142), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L144-L144)


```solidity

File: contracts/bridge/interfaces/IL2Bridge.sol

5: /// @author Matter Labs
6: interface IL2Bridge {

7:     function finalizeDeposit(

15:     function withdraw(address _l1Receiver, address _l2Token, uint256 _amount) external;

17:     function l1TokenAddress(address _l2Token) external view returns (address);

19:     function l2TokenAddress(address _l1Token) external view returns (address);

21:     function l1Bridge() external view returns (address);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL2Bridge.sol#L5-L6) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL2Bridge.sol#L7-L7), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL2Bridge.sol#L15-L15), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL2Bridge.sol#L17-L17), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL2Bridge.sol#L19-L19), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL2Bridge.sol#L21-L21)


```solidity

File: contracts/bridge/interfaces/IWETH9.sol

4: interface IWETH9 {

5:     function deposit() external payable;

7:     function withdraw(uint256 wad) external;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IWETH9.sol#L4-L4) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IWETH9.sol#L5-L5), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IWETH9.sol#L7-L7)


```solidity

File: contracts/bridgehub/IBridgehub.sol

10: struct L2TransactionRequestDirect {

22: struct L2TransactionRequestTwoBridgesOuter {

34: struct L2TransactionRequestTwoBridgesInner {

42: interface IBridgehub {

47:     /// @notice Admin changed

50:     /// @notice Starts the transfer of admin rights. Only the current admin can propose a new pending one.
51:     /// @notice New admin can accept admin rights by calling `acceptAdmin` function.
52:     /// @param _newPendingAdmin Address of the new admin

55:     /// @notice Accepts transfer of admin rights. Only pending admin can accept the role.

58:     /// Getters

61:     function stateTransitionManager(uint256 _chainId) external view returns (address);

63:     function tokenIsRegistered(address _baseToken) external view returns (bool);

65:     function baseToken(uint256 _chainId) external view returns (address);

67:     function sharedBridge() external view returns (IL1SharedBridge);

69:     function getStateTransition(uint256 _chainId) external view returns (address);

71:     /// Mailbox forwarder
72: 

81:     function proveL2LogInclusion(

89:     function proveL1ToL2TransactionStatus(

99:     function requestL2TransactionDirect(

103:     function requestL2TransactionTwoBridges(

107:     function l2TransactionBaseCost(

116:     function createNewChain(

125:     function addStateTransitionManager(address _stateTransitionManager) external;

127:     function removeStateTransitionManager(address _stateTransitionManager) external;

129:     function addToken(address _token) external;

131:     function setSharedBridge(address _sharedBridge) external;

133:     event NewChain(uint256 indexed chainId, address stateTransitionManager, address indexed chainGovernance);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L10-L10) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L22-L22), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L34-L34), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L42-L42), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L47-L47), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L50-L52), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L55-L55), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L58-L58), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L61-L61), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L63-L63), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L65-L65), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L67-L67), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L69-L69), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L71-L72), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L81-L81), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L89-L89), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L99-L99), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L103-L103), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L107-L107), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L116-L116), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L125-L125), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L127-L127), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L129-L129), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L131-L131), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L133-L133)


```solidity

File: contracts/common/interfaces/IL2ContractDeployer.sol

5: /**
6:  * @author Matter Labs
7:  * @notice System smart contract that is responsible for deploying other smart contracts on a zkSync hyperchain.
8:  */

10:     /// @notice A struct that describes a forced deployment on an address.
11:     /// @param bytecodeHash The bytecode hash to put on an address.
12:     /// @param newAddress The address on which to deploy the bytecodehash to.
13:     /// @param callConstructor Whether to run the constructor on the force deployment.
14:     /// @param value The `msg.value` with which to initialize a contract.
15:     /// @param input The constructor calldata.

24:     /// @notice This method is to be used only during an upgrade to set bytecodes on specific addresses.

27:     /// @notice Deploys a contract with similar address derivation rules to the EVM's `CREATE2` opcode.
28:     /// @param _salt The create2 salt.
29:     /// @param _bytecodeHash The correctly formatted hash of the bytecode.
30:     /// @param _input The constructor calldata.


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/interfaces/IL2ContractDeployer.sol#L5-L8) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/interfaces/IL2ContractDeployer.sol#L10-L15), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/interfaces/IL2ContractDeployer.sol#L24-L24), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/interfaces/IL2ContractDeployer.sol#L27-L30)


```solidity

File: contracts/governance/IGovernance.sol

5: /// @title Governance contract interface
6: /// @author Matter Labs
7: /// @custom:security-contact security@matterlabs.dev
8: interface IGovernance {

41:     function isOperation(bytes32 _id) external view returns (bool);

43:     function isOperationPending(bytes32 _id) external view returns (bool);

45:     function isOperationReady(bytes32 _id) external view returns (bool);

47:     function isOperationDone(bytes32 _id) external view returns (bool);

49:     function getOperationState(bytes32 _id) external view returns (OperationState);

51:     function scheduleTransparent(Operation calldata _operation, uint256 _delay) external;

53:     function scheduleShadow(bytes32 _id, uint256 _delay) external;

55:     function cancel(bytes32 _id) external;

57:     function execute(Operation calldata _operation) external payable;

59:     function executeInstant(Operation calldata _operation) external payable;

61:     function hashOperation(Operation calldata _operation) external pure returns (bytes32);

63:     function updateDelay(uint256 _newDelay) external;

65:     function updateSecurityCouncil(address _newSecurityCouncil) external;

67:     /// @notice Emitted when transparent operation is scheduled.

70:     /// @notice Emitted when shadow operation is scheduled.

73:     /// @notice Emitted when the operation is executed with delay or instantly.

76:     /// @notice Emitted when the security council address is changed.

79:     /// @notice Emitted when the minimum delay for future operations is modified.

82:     /// @notice Emitted when the operation with specified id is cancelled.


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/IGovernance.sol#L5-L8) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/IGovernance.sol#L41-L41), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/IGovernance.sol#L43-L43), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/IGovernance.sol#L45-L45), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/IGovernance.sol#L47-L47), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/IGovernance.sol#L49-L49), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/IGovernance.sol#L51-L51), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/IGovernance.sol#L53-L53), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/IGovernance.sol#L55-L55), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/IGovernance.sol#L57-L57), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/IGovernance.sol#L59-L59), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/IGovernance.sol#L61-L61), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/IGovernance.sol#L63-L63), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/IGovernance.sol#L65-L65), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/IGovernance.sol#L67-L67), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/IGovernance.sol#L70-L70), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/IGovernance.sol#L73-L73), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/IGovernance.sol#L76-L76), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/IGovernance.sol#L79-L79), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/IGovernance.sol#L82-L82)


```solidity

File: contracts/state-transition/IStateTransitionManager.sol

26: interface IStateTransitionManager {

28:     event StateTransitionNewChain(uint256 indexed _chainId, address indexed _stateTransitionContract);

30:     event SetChainIdUpgrade(

40:     /// @notice Admin changed

43:     function bridgehub() external view returns (address);

45:     /// @notice Starts the transfer of admin rights. Only the current admin can propose a new pending one.
46:     /// @notice New admin can accept admin rights by calling `acceptAdmin` function.
47:     /// @param _newPendingAdmin Address of the new admin

50:     /// @notice Accepts transfer of admin rights. Only pending admin can accept the role.

53:     function stateTransition(uint256 _chainId) external view returns (address);

55:     function storedBatchZero() external view returns (bytes32);

57:     function initialCutHash() external view returns (bytes32);

59:     function genesisUpgrade() external view returns (address);

61:     function upgradeCutHash(uint256 _protocolVersion) external view returns (bytes32);

63:     function protocolVersion() external view returns (uint256);

65:     function initialize(StateTransitionManagerInitializeData calldata _initalizeData) external;

67:     function setInitialCutHash(Diamond.DiamondCutData calldata _diamondCut) external;

69:     function setValidatorTimelock(address _validatorTimelock) external;

71:     function getChainAdmin(uint256 _chainId) external view returns (address);

73:     /// @notice

82:     function registerAlreadyDeployedStateTransition(uint256 _chainId, address _stateTransitionContract) external;

84:     function setNewVersionUpgrade(

90:     function setUpgradeDiamondCut(Diamond.DiamondCutData calldata _cutData, uint256 _oldProtocolVersion) external;

92:     function freezeChain(uint256 _chainId) external;

94:     function unfreezeChain(uint256 _chainId) external;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/IStateTransitionManager.sol#L26-L26) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/IStateTransitionManager.sol#L28-L28), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/IStateTransitionManager.sol#L30-L30), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/IStateTransitionManager.sol#L40-L40), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/IStateTransitionManager.sol#L43-L43), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/IStateTransitionManager.sol#L45-L47), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/IStateTransitionManager.sol#L50-L50), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/IStateTransitionManager.sol#L53-L53), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/IStateTransitionManager.sol#L55-L55), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/IStateTransitionManager.sol#L57-L57), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/IStateTransitionManager.sol#L59-L59), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/IStateTransitionManager.sol#L61-L61), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/IStateTransitionManager.sol#L63-L63), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/IStateTransitionManager.sol#L65-L65), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/IStateTransitionManager.sol#L67-L67), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/IStateTransitionManager.sol#L69-L69), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/IStateTransitionManager.sol#L71-L71), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/IStateTransitionManager.sol#L73-L73), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/IStateTransitionManager.sol#L82-L82), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/IStateTransitionManager.sol#L84-L84), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/IStateTransitionManager.sol#L90-L90), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/IStateTransitionManager.sol#L92-L92), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/IStateTransitionManager.sol#L94-L94)


```solidity

File: contracts/state-transition/chain-interfaces/IAdmin.sol

10: /// @title The interface of the Admin Contract that controls access rights for contract management.
11: /// @author Matter Labs
12: /// @custom:security-contact security@matterlabs.dev
13: interface IAdmin is IZkSyncStateTransitionBase {

14:     /// @notice Starts the transfer of admin rights. Only the current admin can propose a new pending one.
15:     /// @notice New admin can accept admin rights by calling `acceptAdmin` function.
16:     /// @param _newPendingAdmin Address of the new admin

19:     /// @notice Accepts transfer of admin rights. Only pending admin can accept the role.

22:     /// @notice Change validator status (active or not active)
23:     /// @param _validator Validator address
24:     /// @param _active Active flag

27:     /// @notice Change zk porter availability
28:     /// @param _zkPorterIsAvailable The availability of zk porter shard

31:     /// @notice Change the max L2 gas limit for L1 -> L2 transactions
32:     /// @param _newPriorityTxMaxGasLimit The maximum number of L2 gas that a user can request for L1 -> L2 transactions

35:     /// @notice Change the fee params for L1->L2 transactions
36:     /// @param _newFeeParams The new fee params

39:     /// @notice Change the token multiplier for L1->L2 transactions

42:     /// @notice Used to set to validium directly after genesis

45:     function upgradeChainFromVersion(uint256 _protocolVersion, Diamond.DiamondCutData calldata _cutData) external;

60:     /// @notice Porter availability status changes

63:     /// @notice Validator's status changed

70:     /// @notice Admin changed

73:     /// @notice Priority transaction max L2 gas limit changed

76:     /// @notice Fee params for L1->L2 transactions changed

79:     /// @notice Validium mode status changed

82:     /// @notice BaseToken multiplier for L1->L2 transactions changed

90:     /// @notice Emitted when an upgrade is executed.

93:     /// @notice Emitted when the contract is frozen.

96:     /// @notice Emitted when the contract is unfrozen.


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IAdmin.sol#L10-L13) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IAdmin.sol#L14-L16), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IAdmin.sol#L19-L19), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IAdmin.sol#L22-L24), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IAdmin.sol#L27-L28), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IAdmin.sol#L31-L32), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IAdmin.sol#L35-L36), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IAdmin.sol#L39-L39), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IAdmin.sol#L42-L42), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IAdmin.sol#L45-L45), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IAdmin.sol#L60-L60), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IAdmin.sol#L63-L63), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IAdmin.sol#L70-L70), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IAdmin.sol#L73-L73), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IAdmin.sol#L76-L76), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IAdmin.sol#L79-L79), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IAdmin.sol#L82-L82), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IAdmin.sol#L90-L90), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IAdmin.sol#L93-L93), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IAdmin.sol#L96-L96)


```solidity

File: contracts/state-transition/chain-interfaces/IDiamondInit.sol

09: /// @param chainId the id of the chain
10: /// @param bridgehub the address of the bridgehub contract
11: /// @param stateTransitionManager contract's address
12: /// @param protocolVersion initial protocol version
13: /// @param validatorTimelock address of the validator timelock that delays execution
14: /// @param admin address who can manage the contract
15: /// @param baseToken address of the base token of the chain
16: /// @param baseTokenBridge address of the L1 shared bridge contract
17: /// @param storedBatchZero hash of the initial genesis batch
18: /// @param verifier address of Verifier contract
19: /// @param verifierParams Verifier config parameters that describes the circuit to be verified
20: /// @param l2BootloaderBytecodeHash The hash of bootloader L2 bytecode
21: /// @param l2DefaultAccountBytecodeHash The hash of default account L2 bytecode
22: /// @param priorityTxMaxGasLimit maximum number of the L2 gas that a user can request for L1 -> L2 transactions
23: /// @param feeParams Fee parameters to be used for L1->L2 transactions
24: /// @param blobVersionedHashRetriever Address of contract used to pull the blob versioned hash for a transaction.
25: struct InitializeData {

44: /// @param verifier address of Verifier contract
45: /// @param verifierParams Verifier config parameters that describes the circuit to be verified
46: /// @param l2BootloaderBytecodeHash The hash of bootloader L2 bytecode
47: /// @param l2DefaultAccountBytecodeHash The hash of default account L2 bytecode
48: /// @param priorityTxMaxGasLimit maximum number of the L2 gas that a user can request for L1 -> L2 transactions
49: /// @param feeParams Fee parameters to be used for L1->L2 transactions
50: /// @param blobVersionedHashRetriever Address of contract used to pull the blob versioned hash for a transaction.
51: struct InitializeDataNewChain {

61: interface IDiamondInit {

62:     function initialize(InitializeData calldata _initData) external returns (bytes32);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IDiamondInit.sol#L9-L25) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IDiamondInit.sol#L44-L51), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IDiamondInit.sol#L61-L61), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IDiamondInit.sol#L62-L62)


```solidity

File: contracts/state-transition/chain-interfaces/IExecutor.sol

27: struct LogProcessingOutput {

70: /// @title The interface of the zkSync Executor contract capable of processing events emitted in the zkSync protocol.
71: /// @author Matter Labs
72: /// @custom:security-contact security@matterlabs.dev
73: interface IExecutor is IZkSyncStateTransitionBase {

74:     /// @notice Rollup batch stored data
75:     /// @param batchNumber Rollup batch number
76:     /// @param batchHash Hash of L2 batch
77:     /// @param indexRepeatedStorageChanges The serial number of the shortcut index that's used as a unique identifier for storage keys that were used twice or more
78:     /// @param numberOfLayer1Txs Number of priority operations to be processed
79:     /// @param priorityOperationsHash Hash of all priority operations from this batch
80:     /// @param l2LogsTreeRoot Root hash of tree that contains L2 -> L1 messages from this batch
81:     /// @param timestamp Rollup batch timestamp, have the same format as Ethereum batch constant
82:     /// @param commitment Verified input for the zkSync circuit

125:     /// @notice Recursive proof input data (individual commitments are constructed onchain)

131:     /// @notice Function called by the operator to commit new batches. It is responsible for:
132:     /// - Verifying the correctness of their timestamps.
133:     /// - Processing their L2->L1 logs.
134:     /// - Storing batch commitments.
135:     /// @param _lastCommittedBatchData Stored data of the last committed batch.
136:     /// @param _newBatchesData Data of the new batches to be committed.

142:     /// @notice same as `commitBatches` but with the chainId so ValidatorTimelock can sort the inputs.

160:     /// @notice same as `proveBatches` but with the chainId so ValidatorTimelock can sort the inputs.

168:     /// @notice The function called by the operator to finalize (execute) batches. It is responsible for:
169:     /// - Processing all pending operations (commpleting priority requests).
170:     /// - Finalizing this batch (i.e. allowing to withdraw funds from the system)
171:     /// @param _batchesData Data of the batches to be executed.

174:     /// @notice same as `executeBatches` but with the chainId so ValidatorTimelock can sort the inputs.

177:     /// @notice Reverts unexecuted batches
178:     /// @param _newLastBatch batch number after which batches should be reverted
179:     /// NOTE: Doesn't delete the stored data about batches, but only decreases
180:     /// counters that are responsible for the number of batches

183:     /// @notice same as `revertBatches` but with the chainId so ValidatorTimelock can sort the inputs.


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IExecutor.sol#L27-L27) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IExecutor.sol#L70-L73), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IExecutor.sol#L74-L82), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IExecutor.sol#L125-L125), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IExecutor.sol#L131-L136), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IExecutor.sol#L142-L142), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IExecutor.sol#L160-L160), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IExecutor.sol#L168-L171), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IExecutor.sol#L174-L174), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IExecutor.sol#L177-L180), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IExecutor.sol#L183-L183)


```solidity

File: contracts/state-transition/chain-interfaces/IGetters.sol

10: /// @title The interface of the Getters Contract that implements functions for getting contract state from outside the blockchain.
11: /// @author Matter Labs
12: /// @custom:security-contact security@matterlabs.dev
13: interface IGetters is IZkSyncStateTransitionBase {

18:     /// @return The address of the verifier smart contract

21:     /// @return The address of the current admin

24:     /// @return The address of the pending admin

27:     /// @return The address of the bridgehub

30:     /// @return The address of the state transition

33:     /// @return The address of the base token

36:     /// @return The address of the base token bridge

39:     /// @return The total number of batches that were committed

42:     /// @return The total number of batches that were committed & verified

45:     /// @return The total number of batches that were committed & verified & executed

48:     /// @return The total number of priority operations that were added to the priority queue, including all processed ones

58:     /// @return The number of priority operations currently in the queue

61:     /// @return The first unprocessed priority operation from the queue

64:     /// @return Whether the address has a validator access

67:     /// @return merkleRoot Merkle root of the tree with L2 logs for the selected batch

75:     /// @return Bytecode hash of bootloader program.

78:     /// @return Bytecode hash of default account (bytecode for EOA).

81:     /// @return Verifier parameters.

84:     /// @return Whether the diamond is frozen or not

87:     /// @return The current protocol version

90:     /// @return The upgrade system contract transaction hash, 0 if the upgrade is not initialized

100:     /// @return The maximum number of L2 gas that a user can request for L1 -> L2 transactions

103:     /// @return Whether a withdrawal has been finalized.
104:     /// @param _l2BatchNumber The L2 batch number within which the withdrawal happened.
105:     /// @param _l2MessageIndex The index of the L2->L1 message denoting the withdrawal.

108:     /// @return The pubdata pricing mode.

111:     /// @return the baseTokenGasPriceMultiplierNominator, used to compare the baseTokenPrice to ether for L1->L2 transactions

114:     /// @return the baseTokenGasPriceMultiplierDenominator, used to compare the baseTokenPrice to ether for L1->L2 transactions

121:     /// @notice FaQet structure compatible with the EIP-2535 diamond loupe
122:     /// @param addr The address of the facet contract
123:     /// @param selectors The NON-sorted array with selectors associated with facet

129:     /// @return result All facet addresses and their function selectors

132:     /// @return NON-sorted array with function selectors supported by a specific facet

135:     /// @return facets NON-sorted array of facet addresses supported on diamond

138:     /// @return facet The facet address associated with a selector. Zero if the selector is not added to the diamond

141:     /// @return Whether the selector can be frozen by the admin or always accessible

144:     /// @return isFreezable Whether the facet can be frozen by the admin or always accessible


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IGetters.sol#L10-L13) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IGetters.sol#L18-L18), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IGetters.sol#L21-L21), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IGetters.sol#L24-L24), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IGetters.sol#L27-L27), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IGetters.sol#L30-L30), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IGetters.sol#L33-L33), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IGetters.sol#L36-L36), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IGetters.sol#L39-L39), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IGetters.sol#L42-L42), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IGetters.sol#L45-L45), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IGetters.sol#L48-L48), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IGetters.sol#L58-L58), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IGetters.sol#L61-L61), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IGetters.sol#L64-L64), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IGetters.sol#L67-L67), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IGetters.sol#L75-L75), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IGetters.sol#L78-L78), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IGetters.sol#L81-L81), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IGetters.sol#L84-L84), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IGetters.sol#L87-L87), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IGetters.sol#L90-L90), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IGetters.sol#L100-L100), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IGetters.sol#L103-L105), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IGetters.sol#L108-L108), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IGetters.sol#L111-L111), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IGetters.sol#L114-L114), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IGetters.sol#L121-L123), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IGetters.sol#L129-L129), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IGetters.sol#L132-L132), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IGetters.sol#L135-L135), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IGetters.sol#L138-L138), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IGetters.sol#L141-L141), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IGetters.sol#L144-L144)


```solidity

File: contracts/state-transition/chain-interfaces/IMailbox.sol

08: /// @title The interface of the zkSync Mailbox contract that provides interfaces for L1 <-> L2 interaction.
09: /// @author Matter Labs
10: /// @custom:security-contact security@matterlabs.dev
11: interface IMailbox is IZkSyncStateTransitionBase {

12:     /// @notice Prove that a specific arbitrary-length message was sent in a specific L2 batch number
13:     /// @param _batchNumber The executed L2 batch number in which the message appeared
14:     /// @param _index The position in the L2 logs Merkle tree of the l2Log that was sent with the message
15:     /// @param _message Information about the sent message: sender address, the message itself, tx index in the L2 batch where the message was sent
16:     /// @param _proof Merkle proof for inclusion of L2 log that was sent with the message
17:     /// @return Whether the proof is valid

25:     /// @notice Prove that a specific L2 log was sent in a specific L2 batch
26:     /// @param _batchNumber The executed L2 batch number in which the log appeared
27:     /// @param _index The position of the l2log in the L2 logs Merkle tree
28:     /// @param _log Information about the sent log
29:     /// @param _proof Merkle proof for inclusion of the L2 log
30:     /// @return Whether the proof is correct and L2 log is included in batch

38:     /// @notice Prove that the L1 -> L2 transaction was processed with the specified status.
39:     /// @param _l2TxHash The L2 canonical transaction hash
40:     /// @param _l2BatchNumber The L2 batch number where the transaction was processed
41:     /// @param _l2MessageIndex The position in the L2 logs Merkle tree of the l2Log that was sent with the message
42:     /// @param _l2TxNumberInBatch The L2 transaction number in the batch, in which the log was sent
43:     /// @param _merkleProof The Merkle proof of the processing L1 -> L2 transaction
44:     /// @param _status The execution status of the L1 -> L2 transaction (true - success & 0 - fail)
45:     /// @return Whether the proof is correct and the transaction was actually executed with provided status
46:     /// NOTE: It may return `false` for incorrect proof, but it doesn't mean that the L1 -> L2 transaction has an opposite status!

56:     /// @notice Finalize the withdrawal and release funds
57:     /// @param _l2BatchNumber The L2 batch number where the withdrawal was processed
58:     /// @param _l2MessageIndex The position in the L2 logs Merkle tree of the l2Log that was sent with the message
59:     /// @param _l2TxNumberInBatch The L2 transaction number in a batch, in which the log was sent
60:     /// @param _message The L2 withdraw data, stored in an L2 -> L1 message
61:     /// @param _merkleProof The Merkle proof of the inclusion L2 -> L1 message about withdrawal initialization

98:     function bridgehubRequestL2Transaction(

102:     /// @notice Estimates the cost in Ether of requesting execution of an L2 transaction from L1
103:     /// @param _gasPrice expected L1 gas price at which the user requests the transaction execution
104:     /// @param _l2GasLimit Maximum amount of L2 gas that transaction can consume during execution on L2
105:     /// @param _l2GasPerPubdataByteLimit The maximum amount of L2 gas that the operator may charge the user for a single byte of pubdata.
106:     /// @return The estimated ETH spent on L2 gas for the transaction

113:     /// @notice tranfer Eth to shared bridge as part of migration process

116:     /// @notice New priority request event. Emitted when a request is placed into the priority queue
117:     /// @param txId Serial number of the priority operation
118:     /// @param txHash keccak256 hash of encoded transaction representation
119:     /// @param expirationTimestamp Timestamp up to which priority request should be processed
120:     /// @param transaction The whole transaction structure that is requested to be executed on L2
121:     /// @param factoryDeps An array of bytecodes that were shown in the L1 public data.
122:     /// Will be marked as known bytecodes in L2

131:     /// @notice Emitted when the withdrawal is finalized on L1 and funds are released.
132:     /// @param to The address to which the funds were sent
133:     /// @param amount The amount of funds that were sent


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IMailbox.sol#L8-L11) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IMailbox.sol#L12-L17), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IMailbox.sol#L25-L30), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IMailbox.sol#L38-L46), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IMailbox.sol#L56-L61), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IMailbox.sol#L98-L98), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IMailbox.sol#L102-L106), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IMailbox.sol#L113-L113), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IMailbox.sol#L116-L122), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IMailbox.sol#L131-L133)


```solidity

File: contracts/state-transition/chain-interfaces/IVerifier.sol

5: /// @notice Part of the configuration parameters of ZKP circuits
6: struct VerifierParams {

12: /// @title The interface of the Verifier contract, responsible for the zero knowledge proof verification.
13: /// @author Matter Labs
14: /// @custom:security-contact security@matterlabs.dev
15: interface IVerifier {

25:     /// @notice Calculates a keccak256 hash of the runtime loaded verification keys.
26:     /// @return vkHash The keccak256 hash of the loaded verification keys.


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IVerifier.sol#L5-L6) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IVerifier.sol#L12-L15), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IVerifier.sol#L25-L26)


```solidity

File: contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol

15: interface IZkSyncStateTransition is IAdmin, IExecutor, IGetters, IMailbox {

17:     event ProposeTransparentUpgrade(


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol#L15-L15) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol#L17-L17)


```solidity

File: contracts/state-transition/chain-interfaces/IZkSyncStateTransitionBase.sol

4: /// @title The interface of the zkSync contract, responsible for the main zkSync logic.
5: /// @author Matter Labs
6: /// @custom:security-contact security@matterlabs.dev
7: interface IZkSyncStateTransitionBase {

8:     /// @return Returns facet name.


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IZkSyncStateTransitionBase.sol#L4-L7) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IZkSyncStateTransitionBase.sol#L8-L8)


```solidity

File: contracts/state-transition/l2-deps/ISystemContext.sol

4: interface ISystemContext {

5:     function setChainId(uint256 _newChainId) external;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/l2-deps/ISystemContext.sol#L4-L4) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/l2-deps/ISystemContext.sol#L5-L5)


```solidity

File: contracts/upgrades/IDefaultUpgrade.sol

7: interface IDefaultUpgrade {

8:     function upgrade(ProposedUpgrade calldata _upgrade) external returns (bytes32);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/IDefaultUpgrade.sol#L7-L7) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/IDefaultUpgrade.sol#L8-L8)


```solidity

File: contracts/common/Messaging.sol

127: struct BridgehubL2TransactionRequest {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/Messaging.sol#L127-L127) 


```solidity

File: contracts/common/ReentrancyGuard.sol

41:     modifier reentrancyGuardInitializer() {

46:     function _initializeReentrancyGuard() private {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/ReentrancyGuard.sol#L41-L41) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/ReentrancyGuard.sol#L46-L46)


```solidity

File: contracts/vendor/AddressAliasHelper.sol

21: library AddressAliasHelper {

24:     /// @notice Utility function converts the address that submitted a tx
25:     /// to the inbox on L1 to the msg.sender viewed on L2
26:     /// @param l1Address the address in the L1 that triggered the tx to L2
27:     /// @return l2Address L2 address as viewed in msg.sender

34:     /// @notice Utility function that converts the msg.sender viewed on L2 to the
35:     /// address that submitted a tx to the inbox on L1
36:     /// @param l2Address L2 address as viewed in msg.sender
37:     /// @return l1Address the address in the L1 that triggered the tx to L2


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/vendor/AddressAliasHelper.sol#L21-L21) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/vendor/AddressAliasHelper.sol#L24-L27), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/vendor/AddressAliasHelper.sol#L34-L37)


```solidity

File: contracts/bridge/L2SharedBridge.sol

19: /// @author Matter Labs
20: /// @custom:security-contact security@matterlabs.dev
21: /// @notice The "default" bridge implementation for the ERC20 tokens. Note, that it does not
22: /// support any custom token logic, i.e. rebase tokens' functionality is not supported.
23: contract L2SharedBridge is IL2SharedBridge, Initializable {

45:     /// @notice Initializes the bridge contract for later use. Expected to be used in the proxy.
46:     /// @param _l1Bridge The address of the L1 Bridge contract.
47:     /// @param _l2TokenProxyBytecodeHash The bytecode hash of the proxy for tokens deployed by the bridge.
48:     /// @param _aliasedOwner The address of the governor contract.

73:     /// @notice Finalize the deposit and mint funds
74:     /// @param _l1Sender The account address that initiated the deposit on L1
75:     /// @param _l2Receiver The account address that would receive minted ether
76:     /// @param _l1Token The address of the token that was locked on the L1
77:     /// @param _amount Total amount of tokens deposited from L1
78:     /// @param _data The additional data that user can pass with the deposit

118:     /// @notice Initiates a withdrawal by burning funds on the contract and sending the message to L1
119:     /// where tokens would be unlocked
120:     /// @param _l1Receiver The account address that should receive funds on L1
121:     /// @param _l2Token The L2 token address which is withdrawn
122:     /// @param _amount The total amount of tokens to be withdrawn

148:     /// @return Address of an L2 token counterpart


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L19-L23) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L45-L48), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L73-L78), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L118-L122), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L148-L148)


```solidity

File: contracts/bridge/L2StandardERC20.sol

11: /// @author Matter Labs
12: /// @custom:security-contact security@matterlabs.dev
13: /// @notice The ERC20 token implementation, that is used in the "default" ERC20 bridge. Note, that it does not
14: /// support any custom token logic, i.e. rebase tokens' functionality is not supported.
15: contract L2StandardERC20 is ERC20PermitUpgradeable, IL2StandardToken, ERC1967Upgrade {

129:     modifier onlyBridge() {

134:     modifier onlyNextVersion(uint8 _version) {

159:     function name() public view override returns (string memory) {

165:     function symbol() public view override returns (string memory) {

171:     function decimals() public view override returns (uint8) {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2StandardERC20.sol#L11-L15) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2StandardERC20.sol#L129-L129), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2StandardERC20.sol#L134-L134), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2StandardERC20.sol#L159-L159), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2StandardERC20.sol#L165-L165), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2StandardERC20.sol#L171-L171)


```solidity

File: contracts/bridge/interfaces/IL1ERC20Bridge.sol

5: /// @author Matter Labs
6: // note we use the IL1ERC20Bridge only to send L1<>L2 messages,

9:     function finalizeWithdrawal(


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL1ERC20Bridge.sol#L5-L6) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL1ERC20Bridge.sol#L9-L9)


```solidity

File: contracts/bridge/interfaces/IL1SharedBridge.sol

5: /// @title L1 Bridge contract interface
6: /// @author Matter Labs
7: /// @custom:security-contact security@matterlabs.dev
8: interface IL1SharedBridge {

9:     function finalizeWithdrawal(


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL1SharedBridge.sol#L5-L8) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL1SharedBridge.sol#L9-L9)


```solidity

File: contracts/bridge/interfaces/IL2SharedBridge.sol

5: /// @author Matter Labs
6: interface IL2SharedBridge {

7:     event FinalizeDeposit(

14:     event WithdrawalInitiated(

24:     function finalizeDeposit(

32:     function withdraw(address _l1Receiver, address _l2Token, uint256 _amount) external;

34:     function l1TokenAddress(address _l2Token) external view returns (address);

36:     function l2TokenAddress(address _l1Token) external view returns (address);

38:     function l1Bridge() external view returns (address);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL2SharedBridge.sol#L5-L6) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL2SharedBridge.sol#L7-L7), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL2SharedBridge.sol#L14-L14), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL2SharedBridge.sol#L24-L24), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL2SharedBridge.sol#L32-L32), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL2SharedBridge.sol#L34-L34), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL2SharedBridge.sol#L36-L36), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL2SharedBridge.sol#L38-L38)


```solidity

File: contracts/bridge/interfaces/IL2StandardToken.sol

5: interface IL2StandardToken {

6:     event BridgeInitialize(address indexed l1Token, string name, string symbol, uint8 decimals);

8:     event BridgeMint(address indexed _account, uint256 _amount);

10:     event BridgeBurn(address indexed _account, uint256 _amount);

12:     function bridgeMint(address _account, uint256 _amount) external;

14:     function bridgeBurn(address _account, uint256 _amount) external;

16:     function l1Address() external view returns (address);

18:     function l2Bridge() external view returns (address);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL2StandardToken.sol#L5-L5) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL2StandardToken.sol#L6-L6), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL2StandardToken.sol#L8-L8), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL2StandardToken.sol#L10-L10), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL2StandardToken.sol#L12-L12), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL2StandardToken.sol#L14-L14), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL2StandardToken.sol#L16-L16), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL2StandardToken.sol#L18-L18)


```solidity

File: contracts/interfaces/IPaymaster.sol

14: interface IPaymaster {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/interfaces/IPaymaster.sol#L14-L14) 


```solidity

File: contracts/interfaces/IPaymasterFlow.sol

14:     function general(bytes calldata input) external;

16:     function approvalBased(address _token, uint256 _minAllowance, bytes calldata _innerInput) external;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/interfaces/IPaymasterFlow.sol#L14-L14) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/interfaces/IPaymasterFlow.sol#L16-L16)


```solidity

File: contracts/vendor/AddressAliasHelper.sol

21: library AddressAliasHelper {

24:     /// @notice Utility function converts the address that submitted a tx
25:     /// to the inbox on L1 to the msg.sender viewed on L2
26:     /// @param l1Address the address in the L1 that triggered the tx to L2
27:     /// @return l2Address L2 address as viewed in msg.sender

34:     /// @notice Utility function that converts the msg.sender viewed on L2 to the
35:     /// address that submitted a tx to the inbox on L1
36:     /// @param l2Address L2 address as viewed in msg.sender
37:     /// @return l1Address the address in the L1 that triggered the tx to L2


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/vendor/AddressAliasHelper.sol#L21-L21) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/vendor/AddressAliasHelper.sol#L24-L27), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/vendor/AddressAliasHelper.sol#L34-L37)


```solidity

File: contracts/ForceDeployUpgrader.sol

07: /// @custom:security-contact security@matterlabs.dev
08: /// @notice The contract that calls force deployment during the L2 system contract upgrade.
09: /// @notice It is supposed to be used as an implementation of the ComplexUpgrader.
10: contract ForceDeployUpgrader {

11:     /// @notice A function that performs force deploy
12:     /// @param _forceDeployments The force deployments to perform.


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/ForceDeployUpgrader.sol#L7-L10) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/ForceDeployUpgrader.sol#L11-L12)


```solidity

File: contracts/L2ContractHelper.sol

25: /**
26:  * @author Matter Labs
27:  * @custom:security-contact security@matterlabs.dev
28:  * @notice Interface for the contract that is used to deploy contracts on L2.
29:  */

56: /**
57:  * @author Matter Labs
58:  * @custom:security-contact security@matterlabs.dev
59:  * @notice Interface for the contract that is used to simulate ETH on L2.
60:  */

78: /**
79:  * @author Matter Labs
80:  * @custom:security-contact security@matterlabs.dev
81:  * @notice Helper library for working with L2 contracts on L1.
82:  */

116: /// @notice Structure used to represent a zkSync transaction.
117: struct Transaction {

19:     /// @notice Sends an arbitrary length message to L1.
20:     /// @param _message The variable length message to be sent to L1.
21:     /// @return Returns the keccak256 hashed value of the message.

31:     /// @notice A struct that describes a forced deployment on an address.
32:     /// @param bytecodeHash The bytecode hash to put on an address.
33:     /// @param newAddress The address on which to deploy the bytecodehash to.
34:     /// @param callConstructor Whether to run the constructor on the force deployment.
35:     /// @param value The `msg.value` with which to initialize a contract.
36:     /// @param input The constructor calldata.

45:     /// @notice This method is to be used only during an upgrade to set bytecodes on specific addresses.
46:     /// @param _deployParams A set of parameters describing force deployment.

49:     /// @notice Creates a new contract at a determined address using the `CREATE2` salt on L2
50:     /// @param _salt a unique value to create the deterministic address of the new contract
51:     /// @param _bytecodeHash the bytecodehash of the new contract to be deployed
52:     /// @param _input the calldata to be sent to the constructor of the new contract

62:     /// @notice Allows the withdrawal of ETH to a given L1 receiver along with an additional message.
63:     /// @param _l1Receiver The address on L1 to receive the withdrawn ETH.
64:     /// @param _additionalData Additional message or data to be sent alongside the withdrawal.

87:     /// @notice Sends L2 -> L1 arbitrary-long message through the system contract messenger.
88:     /// @param _message Data to be sent to L1.
89:     /// @return keccak256 hash of the sent message.

094:     /// @notice Computes the create2 address for a Layer 2 contract.
095:     /// @param _sender The address of the contract creator.
096:     /// @param _salt The salt value to use in the create2 address computation.
097:     /// @param _bytecodeHash The contract bytecode hash.
098:     /// @param _constructorInputHash The keccak256 hash of the constructor input data.
099:     /// @return The create2 address of the contract.
100:     /// NOTE: L2 create2 derivation is different from L1 derivation!


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/L2ContractHelper.sol#L25-L29) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/L2ContractHelper.sol#L56-L60), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/L2ContractHelper.sol#L78-L82), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/L2ContractHelper.sol#L116-L117), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/L2ContractHelper.sol#L19-L21), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/L2ContractHelper.sol#L31-L36), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/L2ContractHelper.sol#L45-L46), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/L2ContractHelper.sol#L49-L52), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/L2ContractHelper.sol#L62-L64), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/L2ContractHelper.sol#L87-L89), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/L2ContractHelper.sol#L94-L100)


```solidity

File: contracts/SystemContractsCaller.sol

26: library Utils {

27:     function safeCastToU32(uint256 _x) internal pure returns (uint32) {

37:     function systemCall(uint32 gasLimit, address to, uint256 value, bytes memory data) internal returns (bool success) {

76:     function systemCallWithReturndata(

95:     function getFarCallABI(

121:     function getFarCallABIWithEmptyFatPointer(


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/SystemContractsCaller.sol#L26-L26) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/SystemContractsCaller.sol#L27-L27), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/SystemContractsCaller.sol#L37-L37), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/SystemContractsCaller.sol#L76-L76), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/SystemContractsCaller.sol#L95-L95), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/SystemContractsCaller.sol#L121-L121)


</details>


### [NC&#x2011;89] Add inline comments for unnamed variables 
`function foo(address x, address)` -> `function foo(address x, address /* y */)`


*There are 6 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/ContractDeployer.sol

//@audit parameters 1, need comment
182:     function createAccount(
183:         bytes32, // salt
184:         bytes32 _bytecodeHash,
185:         bytes calldata _input,
186:         AccountAbstractionVersion _aaVersion


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L182-L186) 


```solidity

File: contracts/DefaultAccount.sol

//@audit parameters 1, need comment
67:     function validateTransaction(
68:         bytes32, // _txHash
69:         bytes32 _suggestedSignedHash,
70:         Transaction calldata _transaction

//@audit parameters 1,2, need comment
112:     function executeTransaction(
113:         bytes32, // _txHash
114:         bytes32, // _suggestedSignedHash
115:         Transaction calldata _transaction


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/DefaultAccount.sol#L67-L70) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/DefaultAccount.sol#L112-L115)


```solidity

File: contracts/L2BaseToken.sol

//@audit parameters 3, need comment
32:     function transferFromTo(address _from, address _to, uint256 _amount) external override {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L2BaseToken.sol#L32-L32) 


```solidity

File: contracts/bridge/L1SharedBridge.sol

//@audit parameters 3, need comment
182:     function bridgehubDeposit(
183:         uint256 _chainId,
184:         address _prevMsgSender,
185:         uint256, // l2Value, needed for Weth deposits in the future
186:         bytes calldata _data


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L182-L186) 


```solidity

File: contracts/bridge/L2SharedBridge.sol

//@audit parameters 3, need comment
123:     function withdraw(address _l1Receiver, address _l2Token, uint256 _amount) external override {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L123-L123) 


</details>


### [NC&#x2011;90] Contract should expose an `interface` 
The `contract`s should expose an `interface` so that other projects can more easily integrate with it, without having to develop their own non-standard variants.


*There are 28 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/ContractDeployer.sol

40:     function extendedAccountVersion(address _address) public view returns (AccountAbstractionVersion) {

213:     function forceDeployOnAddress(ForceDeployment calldata _deployment, address _sender) external payable onlySelf {

238:     function forceDeployOnAddresses(ForceDeployment[] calldata _deployments) external payable {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L40-L40) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L213-L213), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L238-L238)


```solidity

File: contracts/L1Messenger.sol

194:     function publishPubdataAndClearState(


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L194-L194) 


```solidity

File: contracts/SystemContext.sol

84:     function setChainId(uint256 _newChainId) external onlyCallFromForceDeployer {

99:     function setTxOrigin(address _newOrigin) external onlyCallFromBootloader {

105:     function setGasPrice(uint256 _gasPrice) external onlyCallFromBootloader {

112:     function setPubdataInfo(uint256 _gasPerPubdataByte, uint256 _basePubdataSpent) external onlyCallFromBootloader {

122:     function getCurrentPubdataCost() external view returns (uint256) {

341:     function setL2Block(

402:     function appendTransactionToCurrentL2Block(bytes32 _txHash) external onlyCallFromBootloader {

408:     function publishTimestampDataToL1() external onlyCallFromBootloader {

444:     function setNewBatch(

471:     function unsafeOverrideBatch(

482:     function incrementTxNumberInBatch() external onlyCallFromBootloader {

486:     function resetTxNumberInBatch() external onlyCallFromBootloader {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L84-L84) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L99-L99), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L105-L105), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L112-L112), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L122-L122), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L341-L341), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L402-L402), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L408-L408), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L444-L444), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L471-L471), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L482-L482), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L486-L486)


```solidity

File: contracts/bridge/L1SharedBridge.sol

116:     function transferFundsFromLegacy(address _token, address _target, uint256 _targetChainId) external onlyOwner {

142:     function initializeChainGovernance(uint256 _chainId, address _l2BridgeAddress) external onlyOwner {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L116-L116) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L142-L142)


```solidity

File: contracts/state-transition/ValidatorTimelock.sol

73:     function setStateTransitionManager(IStateTransitionManager _stateTransitionManager) external onlyOwner {

78:     function addValidator(uint256 _chainId, address _newValidator) external onlyChainAdmin(_chainId) {

87:     function removeValidator(uint256 _chainId, address _validator) external onlyChainAdmin(_chainId) {

96:     function setExecutionDelay(uint32 _executionDelay) external onlyOwner {

102:     function getCommittedBatchTimestamp(uint256 _chainId, uint256 _l2BatchNumber) external view returns (uint256) {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L73-L73) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L78-L78), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L87-L87), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L96-L96), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L102-L102)


```solidity

File: contracts/bridge/L2StandardERC20.sol

50:     function bridgeInitialize(address _l1Address, bytes memory _data) external initializer {

111:     function reinitializeToken(

178:     function decodeString(bytes memory _input) external pure returns (string memory result) {

183:     function decodeUint8(bytes memory _input) external pure returns (uint8 result) {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2StandardERC20.sol#L50-L50) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2StandardERC20.sol#L111-L111), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2StandardERC20.sol#L178-L178), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2StandardERC20.sol#L183-L183)


```solidity

File: contracts/ForceDeployUpgrader.sol

13:     function forceDeploy(IContractDeployer.ForceDeployment[] calldata _forceDeployments) external payable {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/ForceDeployUpgrader.sol#L13-L13) 


</details>


### [NC&#x2011;91] Named imports of parent contracts are missing 



*There are 5 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/AccountCodeStorage.sol

//@audit `IAccountCodeStorage`
22: contract AccountCodeStorage is IAccountCodeStorage {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/AccountCodeStorage.sol#L22-L22) 


```solidity

File: contracts/DefaultAccount.sol

//@audit `IAccount`
19: contract DefaultAccount is IAccount {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/DefaultAccount.sol#L19-L19) 


```solidity

File: contracts/bridgehub/Bridgehub.sol

//@audit `IBridgehub`
16: contract Bridgehub is IBridgehub, ReentrancyGuard, Ownable2Step {

//@audit `ReentrancyGuard`
16: contract Bridgehub is IBridgehub, ReentrancyGuard, Ownable2Step {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L16-L16) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L16-L16)


```solidity

File: contracts/upgrades/GenesisUpgrade.sol

//@audit `BaseZkSyncUpgradeGenesis`
11: contract GenesisUpgrade is BaseZkSyncUpgradeGenesis {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/GenesisUpgrade.sol#L11-L11) 


</details>


### [NC&#x2011;92] [NatSpec] Natspec `@notice` is missing from `contract` 



*There are 578 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/AccountCodeStorage.sol

25:     modifier onlyDeployer() {

65:     /// @dev Store the codehash of the account without any checks.
66:     /// @param _address The address of the account to set the codehash to.
67:     /// @param _hash The new account bytecode hash.


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/AccountCodeStorage.sol#L25-L25) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/AccountCodeStorage.sol#L65-L67)


```solidity

File: contracts/ContractDeployer.sol

28:     modifier onlySelf() {

258:     function _nonSystemDeployOnAddress(


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L28-L28) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L258-L258)


```solidity

File: contracts/DefaultAccount.sol

22:     /**
23:      * @dev Simulate the behavior of the EOA if the caller is not the bootloader.
24:      * Essentially, for all non-bootloader callers halt the execution with empty return data.
25:      * If all functions will use this modifier AND the contract will implement an empty payable fallback()
26:      * then the contract will be indistinguishable from the EOA when called.
27:      */

39:     /**
40:      * @dev Simulate the behavior of the EOA if it is called via `delegatecall`.
41:      * Thus, the default account on a delegate call behaves the same as EOA on Ethereum.
42:      * If all functions will use this modifier AND the contract will implement an empty payable fallback()
43:      * then the contract will be indistinguishable from the EOA when called.
44:      */

220:     fallback() external payable ignoreInDelegateCall {

227:     receive() external payable {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/DefaultAccount.sol#L22-L27) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/DefaultAccount.sol#L39-L44), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/DefaultAccount.sol#L220-L220), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/DefaultAccount.sol#L227-L227)


```solidity

File: contracts/EmptyContract.sol

11:     fallback() external payable {}

13:     receive() external payable {}


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/EmptyContract.sol#L11-L11) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/EmptyContract.sol#L13-L13)


```solidity

File: contracts/KnownCodesStorage.sol

19:     modifier onlyCompressor() {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/KnownCodesStorage.sol#L19-L19) 


```solidity

File: contracts/L1Messenger.sol

49:     /// The gas cost of calculation of keccak256 of bytes array of such length.

60:     /// The gas cost of calculation of sha256 of bytes array of such length.

159:     /// @dev Can be called only by KnownCodesStorage system contract.
160:     /// @param _bytecodeHash Hash of bytecode being published to L1.


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L49-L49) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L60-L60), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L159-L160)


```solidity

File: contracts/L2BaseToken.sol

95:     /// @dev The function burn the sent `msg.value`.
96:     /// NOTE: Since this contract holds the mapping of all ether balances of the system,
97:     /// the sent `msg.value` is added to the `this` balance before the call.
98:     /// So the balance of `address(this)` is always bigger or equal to the `msg.value`!

111:     /// @dev Get the message to be sent to L1 to initiate a withdrawal.

116:     /// @dev Get the message to be sent to L1 to initiate a withdrawal.

126:     /// @dev This method has not been stabilized and might be
127:     /// removed later on.

132:     /// @dev This method has not been stabilized and might be
133:     /// removed later on.

138:     /// @dev This method has not been stabilized and might be
139:     /// removed later on.


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L2BaseToken.sol#L95-L98) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L2BaseToken.sol#L111-L111), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L2BaseToken.sol#L116-L116), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L2BaseToken.sol#L126-L127), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L2BaseToken.sol#L132-L133), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L2BaseToken.sol#L138-L139)


```solidity

File: contracts/SystemContext.sol

117:     function getCurrentPubdataSpent() public view returns (uint256) {

122:     function getCurrentPubdataCost() external view returns (uint256) {

482:     function incrementTxNumberInBatch() external onlyCallFromBootloader {

486:     function resetTxNumberInBatch() external onlyCallFromBootloader {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L117-L117) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L122-L122), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L482-L482), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L486-L486)


```solidity

File: contracts/libraries/EfficientCall.sol

212:     /// @dev Verify that a low-level call was successful, and revert if it wasn't, by bubbling the revert reason.
213:     /// @param _success Whether the call was successful.
214:     /// @return returnData The copied to memory return data.

231:     /// @dev Propagate the revert reason from the current call to the caller.

240:     /// @dev Load the far call ABI into active ptr, that will be used for the next call by reference.
241:     /// @param _gas The gas to be passed to the call.
242:     /// @param _data The calldata to be passed to the call.
243:     /// @param _isConstructor Whether the call is a constructor call.
244:     /// @param _isSystem Whether the call is a system call.


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L212-L214) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L231-L231), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L240-L244)


```solidity

File: contracts/libraries/RLPEncoder.sol

11:     function encodeAddress(address _val) internal pure returns (bytes memory encoded) {

24:     function encodeUint256(uint256 _val) internal pure returns (bytes memory encoded) {

60:     function _encodeLength(uint64 _len, uint256 _offset) private pure returns (bytes memory encoded) {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/RLPEncoder.sol#L11-L11) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/RLPEncoder.sol#L24-L24), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/RLPEncoder.sol#L60-L60)


```solidity

File: contracts/libraries/TransactionHelper.sol

405:     function totalRequiredBalance(Transaction calldata _transaction) internal pure returns (uint256 requiredBalance) {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L405-L405) 


```solidity

File: contracts/libraries/UnsafeBytesCalldata.sol

05: /**
06:  * @author Matter Labs
07:  * @custom:security-contact security@matterlabs.dev
08:  * @dev The library provides a set of functions that help read data from calldata bytes.
09:  * @dev Each of the functions accepts the `bytes calldata` and the offset where data should be read and returns a value of a certain type.
10:  *
11:  * @dev WARNING!
12:  * 1) Functions don't check the length of the bytes array, so it can go out of bounds.
13:  * The user of the library must check for bytes length before using any functions from the library!
14:  *
15:  * 2) Read variables are not cleaned up - https://docs.soliditylang.org/en/v0.8.16/internals/variable_cleanup.html.
16:  * Using data in inline assembly can lead to unexpected behavior!
17:  */

19:     function readUint16(bytes calldata _bytes, uint256 _start) internal pure returns (uint16 result) {

26:     function readUint32(bytes calldata _bytes, uint256 _start) internal pure returns (uint32 result) {

33:     function readUint64(bytes calldata _bytes, uint256 _start) internal pure returns (uint64 result) {

40:     function readBytes32(bytes calldata _bytes, uint256 _start) internal pure returns (bytes32 result) {

46:     function readUint256(bytes calldata _bytes, uint256 _start) internal pure returns (uint256 result) {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/UnsafeBytesCalldata.sol#L5-L17) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/UnsafeBytesCalldata.sol#L19-L19), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/UnsafeBytesCalldata.sol#L26-L26), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/UnsafeBytesCalldata.sol#L33-L33), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/UnsafeBytesCalldata.sol#L40-L40), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/UnsafeBytesCalldata.sol#L46-L46)


```solidity

File: contracts/libraries/Utils.sol

06: /**
07:  * @author Matter Labs
08:  * @custom:security-contact security@matterlabs.dev
09:  * @dev Common utilities used in zkSync system contracts
10:  */

20:     function safeCastToU128(uint256 _x) internal pure returns (uint128) {

26:     function safeCastToU32(uint256 _x) internal pure returns (uint32) {

32:     function safeCastToU24(uint256 _x) internal pure returns (uint24) {

38:     /// @return codeLength The bytecode length in bytes

43:     /// @return codeLengthInWords The bytecode length in machine words


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L6-L10) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L20-L20), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L26-L26), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L32-L32), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L38-L38), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L43-L43)


```solidity

File: contracts/interfaces/IAccount.sol

9: interface IAccount {

26:     function executeTransaction(

34:     function executeTransactionFromOutside(Transaction calldata _transaction) external payable;

36:     function payForTransaction(

42:     function prepareForPaymaster(


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IAccount.sol#L9-L9) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IAccount.sol#L26-L26), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IAccount.sol#L34-L34), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IAccount.sol#L36-L36), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IAccount.sol#L42-L42)


```solidity

File: contracts/interfaces/IAccountCodeStorage.sol

5: interface IAccountCodeStorage {

6:     function storeAccountConstructingCodeHash(address _address, bytes32 _hash) external;

8:     function storeAccountConstructedCodeHash(address _address, bytes32 _hash) external;

10:     function markAccountCodeHashAsConstructed(address _address) external;

12:     function getRawCodeHash(address _address) external view returns (bytes32 codeHash);

14:     function getCodeHash(uint256 _input) external view returns (bytes32 codeHash);

16:     function getCodeSize(uint256 _input) external view returns (uint256 codeSize);


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IAccountCodeStorage.sol#L5-L5) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IAccountCodeStorage.sol#L6-L6), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IAccountCodeStorage.sol#L8-L8), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IAccountCodeStorage.sol#L10-L10), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IAccountCodeStorage.sol#L12-L12), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IAccountCodeStorage.sol#L14-L14), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IAccountCodeStorage.sol#L16-L16)


```solidity

File: contracts/interfaces/IBaseToken.sol

5: interface IBaseToken {

6:     function balanceOf(uint256) external view returns (uint256);

8:     function transferFromTo(address _from, address _to, uint256 _amount) external;

10:     function totalSupply() external view returns (uint256);

12:     function name() external pure returns (string memory);

14:     function symbol() external pure returns (string memory);

16:     function decimals() external pure returns (uint8);

18:     function mint(address _account, uint256 _amount) external;

20:     function withdraw(address _l1Receiver) external payable;

22:     function withdrawWithMessage(address _l1Receiver, bytes calldata _additionalData) external payable;

24:     event Mint(address indexed account, uint256 amount);

26:     event Transfer(address indexed from, address indexed to, uint256 value);

28:     event Withdrawal(address indexed _l2Sender, address indexed _l1Receiver, uint256 _amount);

30:     event WithdrawalWithMessage(


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IBaseToken.sol#L5-L5) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IBaseToken.sol#L6-L6), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IBaseToken.sol#L8-L8), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IBaseToken.sol#L10-L10), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IBaseToken.sol#L12-L12), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IBaseToken.sol#L14-L14), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IBaseToken.sol#L16-L16), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IBaseToken.sol#L18-L18), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IBaseToken.sol#L20-L20), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IBaseToken.sol#L22-L22), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IBaseToken.sol#L24-L24), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IBaseToken.sol#L26-L26), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IBaseToken.sol#L28-L28), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IBaseToken.sol#L30-L30)


```solidity

File: contracts/interfaces/IBootloaderUtilities.sol

7: interface IBootloaderUtilities {

8:     function getTransactionHashes(


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IBootloaderUtilities.sol#L7-L7) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IBootloaderUtilities.sol#L8-L8)


```solidity

File: contracts/interfaces/IComplexUpgrader.sol

11:     function upgrade(address _delegateTo, bytes calldata _calldata) external payable;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IComplexUpgrader.sol#L11-L11) 


```solidity

File: contracts/interfaces/ICompressor.sol

19:     function publishCompressedBytecode(

24:     function verifyCompressedStateDiffs(


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ICompressor.sol#L19-L19) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ICompressor.sol#L24-L24)


```solidity

File: contracts/interfaces/IContractDeployer.sol

5: interface IContractDeployer {

28:     struct AccountInfo {

33:     event ContractDeployed(

39:     event AccountNonceOrderingUpdated(address indexed accountAddress, AccountNonceOrdering nonceOrdering);

41:     event AccountVersionUpdated(address indexed accountAddress, AccountAbstractionVersion aaVersion);

43:     function getNewAddressCreate2(

50:     function getNewAddressCreate(address _sender, uint256 _senderNonce) external pure returns (address newAddress);

52:     function create2(

58:     function create2Account(

65:     /// @dev While the `_salt` parameter is not used anywhere here,
66:     /// it is still needed for consistency between `create` and
67:     /// `create2` functions (required by the compiler).

74:     /// @dev While `_salt` is never used here, we leave it here as a parameter
75:     /// for the consistency with the `create` function.


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IContractDeployer.sol#L5-L5) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IContractDeployer.sol#L28-L28), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IContractDeployer.sol#L33-L33), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IContractDeployer.sol#L39-L39), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IContractDeployer.sol#L41-L41), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IContractDeployer.sol#L43-L43), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IContractDeployer.sol#L50-L50), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IContractDeployer.sol#L52-L52), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IContractDeployer.sol#L58-L58), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IContractDeployer.sol#L65-L67), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IContractDeployer.sol#L74-L75)


```solidity

File: contracts/interfaces/IImmutableSimulator.sol

5: struct ImmutableData {

10: interface IImmutableSimulator {

11:     function getImmutable(address _dest, uint256 _index) external view returns (bytes32);

13:     function setImmutables(address _dest, ImmutableData[] calldata _immutables) external;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IImmutableSimulator.sol#L5-L5) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IImmutableSimulator.sol#L10-L10), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IImmutableSimulator.sol#L11-L11), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IImmutableSimulator.sol#L13-L13)


```solidity

File: contracts/interfaces/IKnownCodesStorage.sol

12:     event MarkedAsKnown(bytes32 indexed bytecodeHash, bool indexed sendBytecodeToL1);

14:     function markFactoryDeps(bool _shouldSendToL1, bytes32[] calldata _hashes) external;

16:     function markBytecodeAsPublished(bytes32 _bytecodeHash) external;

18:     function getMarker(bytes32 _hash) external view returns (uint256);


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IKnownCodesStorage.sol#L12-L12) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IKnownCodesStorage.sol#L14-L14), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IKnownCodesStorage.sol#L16-L16), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IKnownCodesStorage.sol#L18-L18)


```solidity

File: contracts/interfaces/IL1Messenger.sol

05: /// @dev The log passed from L2
06: /// @param l2ShardId The shard identifier, 0 - rollup, 1 - porter. All other values are not used but are reserved for the future
07: /// @param isService A boolean flag that is part of the log along with `key`, `value`, and `sender` address.
08: /// This field is required formally but does not have any special meaning.
09: /// @param txNumberInBlock The L2 transaction number in a block, in which the log was sent
10: /// @param sender The L2 address which sent the log
11: /// @param key The 32 bytes of information that was sent in the log
12: /// @param value The 32 bytes of information that was sent in the log
13: // Both `key` and `value` are arbitrary 32-bytes selected by the log sender

43:     event L1MessageSent(address indexed _sender, bytes32 indexed _hash, bytes _message);

45:     event L2ToL1LogSent(L2ToL1Log _l2log);

47:     event BytecodeL1PublicationRequested(bytes32 _bytecodeHash);

49:     function sendToL1(bytes memory _message) external returns (bytes32);

51:     function sendL2ToL1Log(bool _isService, bytes32 _key, bytes32 _value) external returns (uint256 logIdInMerkleTree);

54:     function requestBytecodeL1Publication(bytes32 _bytecodeHash) external;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IL1Messenger.sol#L5-L13) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IL1Messenger.sol#L43-L43), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IL1Messenger.sol#L45-L45), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IL1Messenger.sol#L47-L47), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IL1Messenger.sol#L49-L49), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IL1Messenger.sol#L51-L51), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IL1Messenger.sol#L54-L54)


```solidity

File: contracts/interfaces/IL2StandardToken.sol

5: interface IL2StandardToken {

6:     event BridgeMint(address indexed _account, uint256 _amount);

8:     event BridgeBurn(address indexed _account, uint256 _amount);

10:     function bridgeMint(address _account, uint256 _amount) external;

12:     function bridgeBurn(address _account, uint256 _amount) external;

14:     function l1Address() external view returns (address);

16:     function l2Bridge() external view returns (address);


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IL2StandardToken.sol#L5-L5) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IL2StandardToken.sol#L6-L6), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IL2StandardToken.sol#L8-L8), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IL2StandardToken.sol#L10-L10), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IL2StandardToken.sol#L12-L12), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IL2StandardToken.sol#L14-L14), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IL2StandardToken.sol#L16-L16)


```solidity

File: contracts/interfaces/IMailbox.sol

5: interface IMailbox {

6:     function finalizeEthWithdrawal(


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IMailbox.sol#L5-L5) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IMailbox.sol#L6-L6)


```solidity

File: contracts/interfaces/INonceHolder.sol

05: /**
06:  * @author Matter Labs
07:  * @dev Interface of the nonce holder contract -- a contract used by the system to ensure
08:  * that there is always a unique identifier for a transaction with a particular account (we call it nonce).
09:  * In other words, the pair of (address, nonce) should always be unique.
10:  * @dev Custom accounts should use methods of this contract to store nonces or other possible unique identifiers
11:  * for the transaction.
12:  */

14:     event ValueSetUnderNonce(address indexed accountAddress, uint256 indexed key, uint256 value);

16:     /// @dev Returns the current minimal nonce for account.

19:     /// @dev Returns the raw version of the current minimal nonce
20:     /// (equal to minNonce + 2^128 * deployment nonce).

23:     /// @dev Increases the minimal nonce for the msg.sender.

26:     /// @dev Sets the nonce value `key` as used.

29:     /// @dev Gets the value stored inside a custom nonce.

32:     /// @dev A convenience method to increment the minimal nonce if it is equal
33:     /// to the `_expectedNonce`.

36:     /// @dev Returns the deployment nonce for the accounts used for CREATE opcode.

39:     /// @dev Increments the deployment nonce for the account and returns the previous one.

42:     /// @dev Determines whether a certain nonce has been already used for an account.

45:     /// @dev Returns whether a nonce has been used for an account.


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/INonceHolder.sol#L5-L12) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/INonceHolder.sol#L14-L14), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/INonceHolder.sol#L16-L16), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/INonceHolder.sol#L19-L20), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/INonceHolder.sol#L23-L23), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/INonceHolder.sol#L26-L26), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/INonceHolder.sol#L29-L29), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/INonceHolder.sol#L32-L33), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/INonceHolder.sol#L36-L36), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/INonceHolder.sol#L39-L39), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/INonceHolder.sol#L42-L42), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/INonceHolder.sol#L45-L45)


```solidity

File: contracts/interfaces/IPaymaster.sol

14: interface IPaymaster {

15:     /// @dev Called by the bootloader to verify that the paymaster agrees to pay for the
16:     /// fee for the transaction. This transaction should also send the necessary amount of funds onto the bootloader
17:     /// address.
18:     /// @param _txHash The hash of the transaction
19:     /// @param _suggestedSignedHash The hash of the transaction that is signed by an EOA
20:     /// @param _transaction The transaction itself.
21:     /// @return magic The value that should be equal to the signature of the validateAndPayForPaymasterTransaction
22:     /// if the paymaster agrees to pay for the transaction.
23:     /// @return context The "context" of the transaction: an array of bytes of length at most 1024 bytes, which will be
24:     /// passed to the `postTransaction` method of the account.
25:     /// @dev The developer should strive to preserve as many steps as possible both for valid
26:     /// and invalid transactions as this very method is also used during the gas fee estimation
27:     /// (without some of the necessary data, e.g. signature).

34:     /// @dev Called by the bootloader after the execution of the transaction. Please note that
35:     /// there is no guarantee that this method will be called at all. Unlike the original EIP4337,
36:     /// this method won't be called if the transaction execution results in out-of-gas.
37:     /// @param _context, the context of the execution, returned by the "validateAndPayForPaymasterTransaction" method.
38:     /// @param  _transaction, the users' transaction.
39:     /// @param _txResult, the result of the transaction execution (success or failure).
40:     /// @param _maxRefundedGas, the upper bound on the amout of gas that could be refunded to the paymaster.
41:     /// @dev The exact amount refunded depends on the gas spent by the "postOp" itself and so the developers should
42:     /// take that into account.


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IPaymaster.sol#L14-L14) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IPaymaster.sol#L15-L27), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IPaymaster.sol#L34-L42)


```solidity

File: contracts/interfaces/IPaymasterFlow.sol

13:     function general(bytes calldata input) external;

15:     function approvalBased(address _token, uint256 _minAllowance, bytes calldata _innerInput) external;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IPaymasterFlow.sol#L13-L13) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IPaymasterFlow.sol#L15-L15)


```solidity

File: contracts/interfaces/ISystemContext.sol

12:     struct BlockInfo {

30:     function chainId() external view returns (uint256);

32:     function origin() external view returns (address);

34:     function gasPrice() external view returns (uint256);

36:     function blockGasLimit() external view returns (uint256);

38:     function coinbase() external view returns (address);

40:     function difficulty() external view returns (uint256);

42:     function baseFee() external view returns (uint256);

44:     function txNumberInBlock() external view returns (uint16);

46:     function getBlockHashEVM(uint256 _block) external view returns (bytes32);

48:     function getBatchHash(uint256 _batchNumber) external view returns (bytes32 hash);

50:     function getBlockNumber() external view returns (uint128);

52:     function getBlockTimestamp() external view returns (uint128);

54:     function getBatchNumberAndTimestamp() external view returns (uint128 blockNumber, uint128 blockTimestamp);

56:     function getL2BlockNumberAndTimestamp() external view returns (uint128 blockNumber, uint128 blockTimestamp);

58:     function gasPerPubdataByte() external view returns (uint256 gasPerPubdataByte);

60:     function getCurrentPubdataSpent() external view returns (uint256 currentPubdataSpent);


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ISystemContext.sol#L12-L12) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ISystemContext.sol#L30-L30), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ISystemContext.sol#L32-L32), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ISystemContext.sol#L34-L34), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ISystemContext.sol#L36-L36), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ISystemContext.sol#L38-L38), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ISystemContext.sol#L40-L40), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ISystemContext.sol#L42-L42), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ISystemContext.sol#L44-L44), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ISystemContext.sol#L46-L46), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ISystemContext.sol#L48-L48), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ISystemContext.sol#L50-L50), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ISystemContext.sol#L52-L52), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ISystemContext.sol#L54-L54), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ISystemContext.sol#L56-L56), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ISystemContext.sol#L58-L58), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ISystemContext.sol#L60-L60)


```solidity

File: contracts/interfaces/ISystemContextDeprecated.sol

11:     function currentBlockInfo() external view returns (uint256);

13:     function getBlockNumberAndTimestamp() external view returns (uint256 blockNumber, uint256 blockTimestamp);

15:     function blockHash(uint256 _blockNumber) external view returns (bytes32 hash);


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ISystemContextDeprecated.sol#L11-L11) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ISystemContextDeprecated.sol#L13-L13), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ISystemContextDeprecated.sol#L15-L15)


```solidity

File: contracts/bridge/L1ERC20Bridge.sol

53:     /// @dev Contract is expected to be used as proxy implementation.
54:     /// @dev Initialize the implementation to prevent Parity hack.

59:     /// @dev Initializes the reentrancy guard. Expected to be used in the proxy.

62:     /// @dev transfer token to shared bridge as part of upgrade

74:     /// @return The L2 token address that would be minted for deposit of the given L1 token on zkSync Era.

158:     /// @dev Transfers tokens from the depositor address to the shared bridge address.
159:     /// @return The difference between the contract balance before and after the transferring of funds.

168:     /// @dev Withdraw funds from the initiated deposit, that failed when finalizing on L2.
169:     /// @param _depositSender The address of the deposit initiator
170:     /// @param _l1Token The address of the deposited L1 ERC20 token
171:     /// @param _l2TxHash The L2 transaction hash of the failed deposit finalization
172:     /// @param _l2BatchNumber The L2 batch number where the deposit finalization was processed
173:     /// @param _l2MessageIndex The position in the L2 logs Merkle tree of the l2Log that was sent with the message
174:     /// @param _l2TxNumberInBatch The L2 transaction number in a batch, in which the log was sent
175:     /// @param _merkleProof The Merkle proof of the processing L1 -> L2 transaction with deposit finalization


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1ERC20Bridge.sol#L53-L54) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1ERC20Bridge.sol#L59-L59), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1ERC20Bridge.sol#L62-L62), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1ERC20Bridge.sol#L74-L74), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1ERC20Bridge.sol#L158-L159), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1ERC20Bridge.sol#L168-L175)


```solidity

File: contracts/bridge/L1SharedBridge.sol

26: /// @author Matter Labs
27: /// @custom:security-contact security@matterlabs.dev
28: /// @dev Bridges assets between L1 and hyperchains, supporting both ETH and ERC20 tokens.
29: /// @dev Designed for use with a proxy for upgradability.
30: contract L1SharedBridge is IL1SharedBridge, ReentrancyGuard, Initializable, Ownable2Step {

88:     /// @dev Contract is expected to be used as proxy implementation.
89:     /// @dev Initialize the implementation to prevent Parity hack.

101:     /// @dev Initializes a contract bridge for later use. Expected to be used in the proxy
102:     /// @param _owner Address which can change L2 token implementation and upgrade the bridge
103:     /// implementation. The owner is the Governor and separate from the ProxyAdmin from now on, so that the Governor can call the bridge.

115:     /// @dev tranfer tokens from legacy erc20 bridge or mailbox and set chainBalance as part of migration process

137:     function receiveEth(uint256 _chainId) external payable {

141:     /// @dev Initializes the l2Bridge address by governance for a specific chain.

171:     /// @dev Transfers tokens from the depositor address to the smart contract address.
172:     /// @return The difference between the contract balance before and after the transferring of funds.

242:     /// @dev Generate a calldata for calling the deposit finalization on the L2 bridge contract

253:     /// @dev Receives and parses (name, symbol, decimals) from the token contract

268:     /// @dev Withdraw funds from the initiated deposit, that failed when finalizing on L2
269:     /// @param _depositSender The address of the deposit initiator
270:     /// @param _l1Token The address of the deposited L1 ERC20 token
271:     /// @param _amount The amount of the deposit that failed.
272:     /// @param _l2TxHash The L2 transaction hash of the failed deposit finalization
273:     /// @param _l2BatchNumber The L2 batch number where the deposit finalization was processed
274:     /// @param _l2MessageIndex The position in the L2 logs Merkle tree of the l2Log that was sent with the message
275:     /// @param _l2TxNumberInBatch The L2 transaction number in a batch, in which the log was sent
276:     /// @param _merkleProof The Merkle proof of the processing L1 -> L2 transaction with deposit finalization

302:     /// @dev Processes claims of failed deposit, whether they originated from the legacy bridge or the current system.

370:     /// @dev Determines if a withdrawal was initiated on zkSync Era before the upgrade to the Shared Bridge.
371:     /// @param _chainId The chain ID of the transaction to check.
372:     /// @param _l2BatchNumber The L2 batch number for the withdrawal.
373:     /// @return Whether withdrawal was initiated on zkSync Era before Shared Bridge upgrade.

401:     struct MessageParams {

407:     /// @dev Internal function that handles the logic for finalizing withdrawals,
408:     /// serving both the current bridge system and the legacy ERC20 bridge.

457:     /// @dev Verifies the validity of a withdrawal message from L2 and returns details of the withdrawal.

487:     function _parseL2WithdrawalMessage(


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L26-L30) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L88-L89), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L101-L103), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L115-L115), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L137-L137), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L141-L141), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L171-L172), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L242-L242), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L253-L253), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L268-L276), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L302-L302), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L370-L373), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L401-L401), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L407-L408), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L457-L457), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L487-L487)


```solidity

File: contracts/bridgehub/Bridgehub.sol

16: contract Bridgehub is IBridgehub, ReentrancyGuard, Ownable2Step {

45:     modifier onlyOwnerOrAdmin() {

50:     /// @inheritdoc IBridgehub

59:     /// @inheritdoc IBridgehub

325:     function _actualRefundRecipient(address _refundRecipient) internal view returns (address _recipient) {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L16-L16) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L45-L45), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L50-L50), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L59-L59), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L325-L325)


```solidity

File: contracts/governance/Governance.sol

82:     /// @dev Returns whether an id corresponds to a registered operation. This
83:     /// includes Waiting, Ready, and Done operations.

88:     /// @dev Returns whether an operation is pending or not. Note that a "pending" operation may also be "ready".

94:     /// @dev Returns whether an operation is ready for execution. Note that a "ready" operation is also "pending".

99:     /// @dev Returns whether an operation is done or not.

104:     /// @dev Returns operation state.

151:     /// @dev Cancel the scheduled operation.
152:     /// @dev Only owner can call this function.
153:     /// @param _id Proposal id value (see `hashOperation`)

202:     /// @dev Returns the identifier of an operation.
203:     /// @param _operation The operation object to compute the identifier for.

212:     /// @dev Schedule an operation that is to become valid after a given delay.
213:     /// @param _id The operation hash (see `hashOperation` function)
214:     /// @param _delay The delay time (in seconds) after which the proposed upgrade can be executed by the owner.

222:     /// @dev Execute an operation's calls.
223:     /// @param _calls The array of calls to be executed.

247:     /// @dev Changes the minimum timelock duration for future operations.
248:     /// @param _newDelay The new minimum delay time (in seconds) for future operations.

254:     /// @dev Updates the address of the security council.
255:     /// @param _newSecurityCouncil The address of the new security council.

261:     /// @dev Contract might receive/hold ETH as part of the maintenance process.


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/Governance.sol#L82-L83) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/Governance.sol#L88-L88), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/Governance.sol#L94-L94), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/Governance.sol#L99-L99), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/Governance.sol#L104-L104), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/Governance.sol#L151-L153), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/Governance.sol#L202-L203), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/Governance.sol#L212-L214), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/Governance.sol#L222-L223), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/Governance.sol#L247-L248), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/Governance.sol#L254-L255), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/Governance.sol#L261-L261)


```solidity

File: contracts/state-transition/StateTransitionManager.sol

22: /// @title StateTransition contract
23: /// @author Matter Labs
24: /// @custom:security-contact security@matterlabs.dev
25: contract StateTransitionManager is IStateTransitionManager, ReentrancyGuard, Ownable2Step {

56:     /// @dev Contract is expected to be used as proxy implementation.
57:     /// @dev Initialize the implementation to prevent Parity hack.

74:     function getChainAdmin(uint256 _chainId) external view override returns (address) {

78:     /// @dev initialize

109:     /// @inheritdoc IStateTransitionManager

118:     /// @inheritdoc IStateTransitionManager

131:     /// @dev set validatorTimelock. Cannot do it an initialization, as validatorTimelock is deployed after STM

136:     /// @dev set initial cutHash

141:     /// @dev set New Version with upgrade from old version

151:     /// @dev set upgrade for some protocolVersion

159:     /// @dev freezes the specified chain

164:     /// @dev freezes the specified chain

169:     /// @dev reverts batches on the specified chain

176:     /// @dev we have to set the chainId at genesis, as blockhashzero is the same for all chains with the same chainId

230:     function registerAlreadyDeployedStateTransition(


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L22-L25) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L56-L57), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L74-L74), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L78-L78), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L109-L109), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L118-L118), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L131-L131), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L136-L136), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L141-L141), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L151-L151), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L159-L159), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L164-L164), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L169-L169), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L176-L176), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L230-L230)


```solidity

File: contracts/state-transition/ValidatorTimelock.sol

55:     constructor(address _initialOwner, uint32 _executionDelay) {

72:     /// @dev Set new validator address.

77:     /// @dev Sets an address as a validator.

86:     /// @dev Removes an address as a validator.

95:     /// @dev Set the delay between committing and executing batches.

101:     /// @dev Returns the timestamp when `_l2BatchNumber` was committed.

106:     /// @dev Records the timestamp for all provided committed batches and make
107:     /// a call to the hyperchain diamond contract with the same calldata.

124:     /// @dev Records the timestamp for all provided committed batches and make
125:     /// a call to the hyperchain diamond contract with the same calldata.

143:     /// @dev Make a call to the hyperchain diamond contract with the same calldata.
144:     /// Note: If the batch is reverted, it needs to be committed first before the execution.
145:     /// So it's safe to not override the committed batches.

150:     /// @dev Make a call to the hyperchain diamond contract with the same calldata.
151:     /// Note: If the batch is reverted, it needs to be committed first before the execution.
152:     /// So it's safe to not override the committed batches.

157:     /// @dev Make a call to the hyperchain diamond contract with the same calldata.
158:     /// Note: We don't track the time when batches are proven, since all information about
159:     /// the batch is known on the commit stage and the proved is not finalized (may be reverted).

168:     /// @dev Make a call to the hyperchain diamond contract with the same calldata.
169:     /// Note: We don't track the time when batches are proven, since all information about
170:     /// the batch is known on the commit stage and the proved is not finalized (may be reverted).

180:     /// @dev Check that batches were committed at least X time ago and
181:     /// make a call to the hyperchain diamond contract with the same calldata.

201:     /// @dev Check that batches were committed at least X time ago and
202:     /// make a call to the hyperchain diamond contract with the same calldata.

223:     /// @dev Call the hyperchain diamond contract with the same calldata as this contract was called.
224:     /// Note: it is called the hyperchain diamond contract, not delegatecalled!


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L55-L55) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L72-L72), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L77-L77), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L86-L86), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L95-L95), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L101-L101), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L106-L107), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L124-L125), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L143-L145), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L150-L152), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L157-L159), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L168-L170), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L180-L181), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L201-L202), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L223-L224)


```solidity

File: contracts/state-transition/chain-deps/DiamondInit.sol

14: /// @author Matter Labs
15: /// @dev The contract is used only once to initialize the diamond proxy.
16: /// @dev The deployment process takes care of this contract's initialization.
17: contract DiamondInit is ZkSyncStateTransitionBase, IDiamondInit {

18:     /// @dev Initialize the implementation to prevent any possibility of a Parity hack.


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/DiamondInit.sol#L14-L17) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/DiamondInit.sol#L18-L18)


```solidity

File: contracts/state-transition/chain-deps/DiamondProxy.sol

07: /// @title Diamond Proxy Contract (EIP-2535)
08: /// @author Matter Labs
09: /// @custom:security-contact security@matterlabs.dev
10: contract DiamondProxy {

11:     constructor(uint256 _chainId, Diamond.DiamondCutData memory _diamondCut) {

18:     /// @dev 1. Find the facet for the function that is called.
19:     /// @dev 2. Delegate the execution to the found facet via `delegatecall`.


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/DiamondProxy.sol#L7-L10) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/DiamondProxy.sol#L11-L11), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/DiamondProxy.sol#L18-L19)


```solidity

File: contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol

18: /// @dev Logically separated part of the storage structure, which is responsible for everything related to proxy
19: /// upgrades and diamond cuts
20: /// @param proposedUpgradeHash The hash of the current upgrade proposal, zero if there is no active proposal
21: /// @param state Indicates whether an upgrade is initiated and if yes what type
22: /// @param securityCouncil Address which has the permission to approve instant upgrades (expected to be a Gnosis
23: /// multisig)
24: /// @param approvedBySecurityCouncil Indicates whether the security council has approved the upgrade
25: /// @param proposedUpgradeTimestamp The timestamp when the upgrade was proposed, zero if there are no active proposals
26: /// @param currentProposalId The serial number of proposed upgrades, increments when proposing a new one
27: struct UpgradeStorage {

61: /// @dev storing all storage variables for hyperchain diamond facets
62: /// NOTE: It is used in a proxy, so it is possible to add new variables to the end
63: /// but NOT to modify already existing variables or change their order.
64: /// NOTE: variables prefixed with '__DEPRECATED_' are deprecated and shouldn't be used.
65: /// Their presence is maintained for compatibility and to prevent storage collision.
66: struct ZkSyncStateTransitionStorage {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L18-L27) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L61-L66)


```solidity

File: contracts/state-transition/chain-deps/facets/Admin.sol

15: /// @title Admin Contract controls access rights for contract management.
16: /// @author Matter Labs
17: /// @custom:security-contact security@matterlabs.dev
18: contract AdminFacet is ZkSyncStateTransitionBase, IAdmin {

22:     /// @inheritdoc IAdmin

31:     /// @inheritdoc IAdmin

44:     /// @inheritdoc IAdmin

50:     /// @inheritdoc IAdmin

57:     /// @inheritdoc IAdmin

66:     /// @inheritdoc IAdmin

78:     /// @inheritdoc IAdmin

89:     function setValidiumMode(PubdataPricingMode _validiumMode) external onlyAdmin {

99:     /// upgrade a specific chain

122:     /// @inheritdoc IAdmin

132:     /// @inheritdoc IAdmin

142:     /// @inheritdoc IAdmin


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Admin.sol#L15-L18) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Admin.sol#L22-L22), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Admin.sol#L31-L31), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Admin.sol#L44-L44), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Admin.sol#L50-L50), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Admin.sol#L57-L57), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Admin.sol#L66-L66), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Admin.sol#L78-L78), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Admin.sol#L89-L89), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Admin.sol#L99-L99), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Admin.sol#L122-L122), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Admin.sol#L132-L132), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Admin.sol#L142-L142)


```solidity

File: contracts/state-transition/chain-deps/facets/Executor.sol

19: /// @title zkSync hyperchain Executor contract capable of processing events emitted in the zkSync hyperchain protocol.
20: /// @author Matter Labs
21: /// @custom:security-contact security@matterlabs.dev
22: contract ExecutorFacet is ZkSyncStateTransitionBase, IExecutor {

126:     /// @dev Check that L2 logs are proper and batch contain all meta information for them
127:     /// @dev The logs processed here should line up such that only one log for each key from the
128:     ///      SystemLogKey enum in Constants.sol is processed per new batch.
129:     /// @dev Data returned from here will be used to form the batch commitment.

198:     /// @inheritdoc IExecutor

206:     /// @inheritdoc IExecutor

215:     function _commitBatches(

250:     /// @dev Commits new batches without any system contracts upgrade.
251:     /// @param _lastCommittedBatchData The data of the last committed batch.
252:     /// @param _newBatchesData An array of batch data that needs to be committed.

269:     /// @dev Commits new batches with a system contracts upgrade transaction.
270:     /// @param _lastCommittedBatchData The data of the last committed batch.
271:     /// @param _newBatchesData An array of batch data that needs to be committed.
272:     /// @param _systemContractUpgradeTxHash The transaction hash of the system contract upgrade.

307:     /// @dev Pops the priority operations from the priority queue and returns a rolling hash of operations

317:     /// @dev Executes one batch
318:     /// @dev 1. Processes all pending operations (Complete priority requests)
319:     /// @dev 2. Finalizes batch on Ethereum
320:     /// @dev _executedBatchIdx is an index in the array of the batches that we want to execute together

336:     /// @inheritdoc IExecutor

344:     /// @inheritdoc IExecutor

349:     function _executeBatches(StoredBatchInfo[] calldata _batchesData) internal {

367:     /// @inheritdoc IExecutor

376:     /// @inheritdoc IExecutor

386:     function _proveBatches(

440:     function _verifyProof(uint256[] memory proofPublicInput, ProofInput calldata _proof) internal view {

452:     /// @dev Gets zk proof public input

471:     /// @inheritdoc IExecutor

476:     /// @inheritdoc IExecutor

481:     function _revertBatches(uint256 _newLastBatch) internal {

499:     /// @dev Creates batch commitment from its data

515:     function _batchPassThroughData(CommitBatchInfo calldata _batch) internal pure returns (bytes memory) {

525:     function _batchMetaParameters() internal view returns (bytes memory) {

537:     function _batchAuxiliaryOutput(

557:     /// @dev Encodes the commitment to blobs to be used in the auxiliary output of the batch commitment
558:     /// @param _blobCommitments - the commitments to the blobs
559:     /// @param _blobHashes - the hashes of the blobs
560:     /// @param blobAuxOutputWords - The circuit commitment to the blobs split into 32-byte words

621:     /// @dev Verifies that the blobs contain the correct data by calling the point evaluation precompile. For the precompile we need:
622:     /// versioned hash || opening point || opening value || commitment || proof
623:     /// the _pubdataCommitments will contain the last 4 values, the versioned hash is pulled from the BLOBHASH opcode
624:     /// pubdataCommitments is a list of: opening point (16 bytes) || claimed value (32 bytes) || commitment (48 bytes) || proof (48 bytes)) = 144 bytes

676:     /// @dev Since we don't have access to the new BLOBHASH opecode we need to leverage a static call to a yul contract
677:     /// that calls the opcode via a verbatim call. This should be swapped out once there is solidity support for the
678:     /// new opcode.


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L19-L22) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L126-L129), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L198-L198), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L206-L206), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L215-L215), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L250-L252), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L269-L272), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L307-L307), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L317-L320), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L336-L336), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L344-L344), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L349-L349), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L367-L367), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L376-L376), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L386-L386), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L440-L440), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L452-L452), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L471-L471), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L476-L476), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L481-L481), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L499-L499), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L515-L515), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L525-L525), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L537-L537), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L557-L560), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L621-L624), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L676-L678)


```solidity

File: contracts/state-transition/chain-deps/facets/Getters.sol

17: /// @title Getters Contract implements functions for getting contract state from outside the blockchain.
18: /// @author Matter Labs
19: /// @custom:security-contact security@matterlabs.dev
20: contract GettersFacet is ZkSyncStateTransitionBase, IGetters, ILegacyGetters {

31:     /// @inheritdoc IGetters

36:     /// @inheritdoc IGetters

41:     /// @inheritdoc IGetters

46:     /// @inheritdoc IGetters

51:     /// @inheritdoc IGetters

56:     /// @inheritdoc IGetters

61:     /// @inheritdoc IGetters

66:     /// @inheritdoc IGetters

71:     /// @inheritdoc IGetters

76:     /// @inheritdoc IGetters

81:     /// @inheritdoc IGetters

86:     /// @inheritdoc IGetters

91:     /// @inheritdoc IGetters

96:     /// @inheritdoc IGetters

101:     /// @inheritdoc IGetters

106:     /// @inheritdoc IGetters

111:     /// @inheritdoc IGetters

116:     /// @inheritdoc IGetters

121:     /// @inheritdoc IGetters

126:     /// @inheritdoc IGetters

131:     /// @inheritdoc IGetters

136:     /// @inheritdoc IGetters

141:     /// @inheritdoc IGetters

146:     /// @inheritdoc IGetters

151:     /// @inheritdoc IGetters

156:     /// @inheritdoc IGetters

162:     /// @inheritdoc IGetters

175:     /// @inheritdoc IGetters

180:     /// @inheritdoc IGetters

187:     /// @inheritdoc IGetters

192:     /// @inheritdoc IGetters

201:     /// @inheritdoc IGetters

216:     /// @inheritdoc IGetters

222:     /// @inheritdoc IGetters

228:     /// @inheritdoc IGetters

238:     /// @inheritdoc ILegacyGetters

243:     /// @inheritdoc ILegacyGetters

248:     /// @inheritdoc ILegacyGetters

253:     /// @inheritdoc ILegacyGetters

258:     /// @inheritdoc ILegacyGetters


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L17-L20) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L31-L31), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L36-L36), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L41-L41), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L46-L46), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L51-L51), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L56-L56), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L61-L61), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L66-L66), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L71-L71), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L76-L76), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L81-L81), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L86-L86), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L91-L91), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L96-L96), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L101-L101), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L106-L106), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L111-L111), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L116-L116), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L121-L121), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L126-L126), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L131-L131), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L136-L136), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L141-L141), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L146-L146), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L151-L151), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L156-L156), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L162-L162), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L175-L175), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L180-L180), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L187-L187), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L192-L192), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L201-L201), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L216-L216), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L222-L222), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L228-L228), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L238-L238), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L243-L243), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L248-L248), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L253-L253), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L258-L258)


```solidity

File: contracts/state-transition/chain-deps/facets/Mailbox.sol

27: /// @title zkSync Mailbox contract providing interfaces for L1 <-> L2 interaction.
28: /// @author Matter Labs
29: /// @custom:security-contact security@matterlabs.dev
30: contract MailboxFacet is ZkSyncStateTransitionBase, IMailbox {

37:     /// @inheritdoc IMailbox

53:     /// @inheritdoc IMailbox

63:     /// @inheritdoc IMailbox

73:     /// @inheritdoc IMailbox

103:     /// @dev Prove that a specific L2 log was sent in a specific L2 batch number

129:     /// @dev Convert arbitrary-length message to the raw l2 log

142:     /// @inheritdoc IMailbox

177:     /// @inheritdoc IMailbox

196:     ///  @inheritdoc IMailbox

228:     function _requestL2TransactionSender(

258:     function _requestL2Transaction(

289:     function _serializeL2Transaction(


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L27-L30) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L37-L37), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L53-L53), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L63-L63), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L73-L73), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L103-L103), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L129-L129), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L142-L142), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L177-L177), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L196-L196), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L228-L228), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L258-L258), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L289-L289)


```solidity

File: contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol

08: /// @title Base contract containing functions accessible to the other facets.
09: /// @author Matter Labs
10: /// @custom:security-contact security@matterlabs.dev
11: contract ZkSyncStateTransitionBase is ReentrancyGuard {

26:     modifier onlyStateTransitionManager() {

31:     modifier onlyBridgehub() {

36:     modifier onlyAdminOrStateTransitionManager() {

44:     modifier onlyValidatorOrStateTransitionManager() {

52:     modifier onlyBaseTokenBridge() {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L8-L11) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L26-L26), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L31-L31), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L36-L36), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L44-L44), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L52-L52)


```solidity

File: contracts/upgrades/DefaultUpgrade.sol

08: /// @author Matter Labs
09: /// @custom:security-contact security@matterlabs.dev
10: contract DefaultUpgrade is BaseZkSyncUpgrade {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/DefaultUpgrade.sol#L8-L10) 


```solidity

File: contracts/upgrades/GenesisUpgrade.sol

09: /// @author Matter Labs
10: /// @custom:security-contact security@matterlabs.dev
11: contract GenesisUpgrade is BaseZkSyncUpgradeGenesis {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/GenesisUpgrade.sol#L9-L11) 


```solidity

File: contracts/common/libraries/UncheckedMath.sol

11:     function uncheckedInc(uint256 _number) internal pure returns (uint256) {

17:     function uncheckedAdd(uint256 _lhs, uint256 _rhs) internal pure returns (uint256) {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/UncheckedMath.sol#L11-L11) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/UncheckedMath.sol#L17-L17)


```solidity

File: contracts/common/libraries/UnsafeBytes.sol

05: /**
06:  * @author Matter Labs
07:  * @custom:security-contact security@matterlabs.dev
08:  * @dev The library provides a set of functions that help read data from an "abi.encodePacked" byte array.
09:  * @dev Each of the functions accepts the `bytes memory` and the offset where data should be read and returns a value of a certain type.
10:  *
11:  * @dev WARNING!
12:  * 1) Functions don't check the length of the bytes array, so it can go out of bounds.
13:  * The user of the library must check for bytes length before using any functions from the library!
14:  *
15:  * 2) Read variables are not cleaned up - https://docs.soliditylang.org/en/v0.8.16/internals/variable_cleanup.html.
16:  * Using data in inline assembly can lead to unexpected behavior!
17:  */

19:     function readUint32(bytes memory _bytes, uint256 _start) internal pure returns (uint32 result, uint256 offset) {

26:     function readAddress(bytes memory _bytes, uint256 _start) internal pure returns (address result, uint256 offset) {

33:     function readUint256(bytes memory _bytes, uint256 _start) internal pure returns (uint256 result, uint256 offset) {

40:     function readBytes32(bytes memory _bytes, uint256 _start) internal pure returns (bytes32 result, uint256 offset) {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/UnsafeBytes.sol#L5-L17) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/UnsafeBytes.sol#L19-L19), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/UnsafeBytes.sol#L26-L26), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/UnsafeBytes.sol#L33-L33), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/UnsafeBytes.sol#L40-L40)


```solidity

File: contracts/state-transition/libraries/Diamond.sol

24:     event DiamondCut(FacetCut[] facetCuts, address initAddress, bytes initCalldata);

26:     /// @dev Utility struct that contains associated facet & meta information of selector
27:     /// @param facetAddress address of the facet which is connected with selector
28:     /// @param selectorPosition index in `FacetToSelectors.selectors` array, where is selector stored
29:     /// @param isFreezable denotes whether the selector can be frozen.

36:     /// @dev Utility struct that contains associated selectors & meta information of facet
37:     /// @param selectors list of all selectors that belong to the facet
38:     /// @param facetPosition index in `DiamondStorage.facets` array, where is facet stored

57:     /// @dev Parameters for diamond changes that touch one of the facets
58:     /// @param facet The address of facet that's affected by the cut
59:     /// @param action The action that is made on the facet
60:     /// @param isFreezable Denotes whether the facet & all their selectors can be frozen
61:     /// @param selectors An array of unique selectors that belongs to the facet address

69:     /// @dev Structure of the diamond proxy changes
70:     /// @param facetCuts The set of changes (adding/removing/replacement) of implementation contracts
71:     /// @param initAddress The address that's delegate called after setting up new facet changes
72:     /// @param initCalldata Calldata for the delegate call to `initAddress`

86:     /// @return diamondStorage The pointer to the storage where all specific diamond proxy parameters stored

94:     /// @dev Add/replace/remove any number of selectors and optionally execute a function with delegatecall
95:     /// @param _diamondCut Diamond's facet changes and the parameters to optional initialization delegatecall

124:     /// @dev Add new functions to the diamond proxy
125:     /// NOTE: expect but NOT enforce that `_selectors` is NON-EMPTY array

147:     /// @dev Change associated facets to already known function selectors
148:     /// NOTE: expect but NOT enforce that `_selectors` is NON-EMPTY array

170:     /// @dev Remove association with function and facet
171:     /// NOTE: expect but NOT enforce that `_selectors` is NON-EMPTY array

187:     /// @dev Add address to the list of known facets if it is not on the list yet
188:     /// NOTE: should be called ONLY before adding a new selector associated with the address

200:     /// @dev Add one function to the already known facet
201:     /// NOTE: It is expected but NOT enforced that:
202:     /// - `_facet` is NON-ZERO address
203:     /// - `_facet` is already stored address in `DiamondStorage.facets`
204:     /// - `_selector` is NOT associated by another facet

226:     /// @dev Remove one associated function with facet
227:     /// NOTE: It is expected but NOT enforced that `_facet` is NON-ZERO address

255:     /// @dev remove facet from the list of known facets
256:     /// NOTE: It is expected but NOT enforced that there are no selectors associated with `_facet`

276:     /// @dev Delegates call to the initialization address with provided calldata
277:     /// @dev Used as a final step of diamond cut to execute the logic of the initialization for changed facets


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L24-L24) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L26-L29), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L36-L38), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L57-L61), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L69-L72), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L86-L86), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L94-L95), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L124-L125), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L147-L148), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L170-L171), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L187-L188), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L200-L204), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L226-L227), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L255-L256), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L276-L277)


```solidity

File: contracts/state-transition/libraries/LibMap.sol

9:     /// @dev A uint32 map in storage.

14:     /// @dev Retrieves the uint32 value at a specific index from the Uint32Map.
15:     /// @param _map The Uint32Map instance containing the packed uint32 values.
16:     /// @param _index The index of the uint32 value to retrieve.
17:     /// @return result The uint32 value at the specified index.

34:     /// @dev Updates the uint32 value at `_index` in `map`.
35:     /// @param _map The Uint32Map instance containing the packed uint32 values.
36:     /// @param _index The index of the uint32 value to set.
37:     /// @param _value The new value at the specified index.


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/LibMap.sol#L9-L9) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/LibMap.sol#L14-L17), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/LibMap.sol#L34-L37)


```solidity

File: contracts/state-transition/libraries/Merkle.sol

7: /// @author Matter Labs
8: /// @custom:security-contact security@matterlabs.dev
9: library Merkle {

12:     /// @dev Calculate Merkle root by the provided Merkle proof.
13:     /// NOTE: When using this function, check that the _path length is equal to the tree height to prevent shorter/longer paths attack
14:     /// @param _path Merkle path from the leaf to the root
15:     /// @param _index Leaf index in the tree
16:     /// @param _itemHash Hash of leaf content
17:     /// @return The Merkle root

39:     /// @dev Keccak hash of the concatenation of two 32-byte words


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Merkle.sol#L7-L9) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Merkle.sol#L12-L17), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Merkle.sol#L39-L39)


```solidity

File: contracts/state-transition/libraries/PriorityQueue.sol

16: /// @author Matter Labs
17: /// @custom:security-contact security@matterlabs.dev
18: /// @dev The library provides the API to interact with the priority queue container
19: /// @dev Order of processing operations from queue - FIFO (Fist in - first out)
20: library PriorityQueue {

39:     /// @return The total number of priority operations that were added to the priority queue, including all processed ones

44:     /// @return The total number of unprocessed priority operations in a priority queue

49:     /// @return Whether the priority queue contains no operations

63:     /// @return The first unprocessed priority operation from the queue


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/PriorityQueue.sol#L16-L20) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/PriorityQueue.sol#L39-L39), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/PriorityQueue.sol#L44-L44), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/PriorityQueue.sol#L49-L49), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/PriorityQueue.sol#L63-L63)


```solidity

File: contracts/state-transition/libraries/TransactionValidator.sol

10: /// @title zkSync Library for validating L1 -> L2 transactions
11: /// @author Matter Labs
12: /// @custom:security-contact security@matterlabs.dev
13: library TransactionValidator {

14:     /// @dev Used to validate key properties of an L1->L2 transaction
15:     /// @param _transaction The transaction to validate
16:     /// @param _encoded The abi encoded bytes of the transaction
17:     /// @param _priorityTxMaxGasLimit The max gas limit, generally provided from Storage.sol
18:     /// @param _priorityTxMaxPubdata The maximal amount of pubdata that a single L1->L2 transaction can emit

44:     /// @dev Used to validate upgrade transactions
45:     /// @param _transaction The transaction to validate

63:     /// @dev Calculates the approximate minimum gas limit required for executing a priority transaction.
64:     /// @param _encodingLength The length of the priority transaction encoding in bytes.
65:     /// @param _numberOfFactoryDependencies The number of new factory dependencies that will be added.
66:     /// @param _l2GasPricePerPubdata The L2 gas price for publishing the priority transaction on L2.
67:     /// @return The minimum gas limit required to execute the priority transaction.
68:     /// Note: The calculation includes the main cost of the priority transaction, however, in reality, the operator can spend a little more gas on overheads.


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/TransactionValidator.sol#L10-L13) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/TransactionValidator.sol#L14-L18), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/TransactionValidator.sol#L44-L45), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/TransactionValidator.sol#L63-L68)


```solidity

File: contracts/bridge/interfaces/IL1ERC20Bridge.sol

12:     event DepositInitiated(

20:     event WithdrawalFinalized(address indexed to, address indexed l1Token, uint256 amount);

22:     event ClaimedFailedDeposit(address indexed to, address indexed l1Token, uint256 amount);

24:     function isWithdrawalFinalized(uint256 _l2BatchNumber, uint256 _l2MessageIndex) external view returns (bool);

26:     function deposit(

35:     function deposit(

43:     function claimFailedDeposit(

53:     function finalizeWithdrawal(

61:     function l2TokenAddress(address _l1Token) external view returns (address);

63:     function sharedBridge() external view returns (IL1SharedBridge);

65:     function l2TokenBeacon() external view returns (address);

67:     function l2Bridge() external view returns (address);

69:     function depositAmount(

75:     function tranferTokenToSharedBridge(address _token, uint256 _amount) external;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1ERC20Bridge.sol#L12-L12) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1ERC20Bridge.sol#L20-L20), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1ERC20Bridge.sol#L22-L22), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1ERC20Bridge.sol#L24-L24), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1ERC20Bridge.sol#L26-L26), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1ERC20Bridge.sol#L35-L35), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1ERC20Bridge.sol#L43-L43), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1ERC20Bridge.sol#L53-L53), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1ERC20Bridge.sol#L61-L61), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1ERC20Bridge.sol#L63-L63), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1ERC20Bridge.sol#L65-L65), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1ERC20Bridge.sol#L67-L67), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1ERC20Bridge.sol#L69-L69), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1ERC20Bridge.sol#L75-L75)


```solidity

File: contracts/bridge/interfaces/IL1SharedBridge.sol

09: /// @title L1 Bridge contract interface
10: /// @author Matter Labs
11: /// @custom:security-contact security@matterlabs.dev
12: interface IL1SharedBridge {

13:     event LegacyDepositInitiated(

22:     event BridgehubDepositInitiated(

31:     event BridgehubDepositBaseTokenInitiated(

38:     event BridgehubDepositFinalized(

44:     event WithdrawalFinalizedSharedBridge(

51:     event ClaimedFailedDepositSharedBridge(

58:     function isWithdrawalFinalized(

64:     function depositLegacyErc20Bridge(

74:     function claimFailedDepositLegacyErc20Bridge(

85:     function claimFailedDeposit(

97:     function finalizeWithdrawalLegacyErc20Bridge(

105:     function finalizeWithdrawal(

114:     function l1WethAddress() external view returns (address);

116:     function bridgehub() external view returns (IBridgehub);

118:     function legacyBridge() external view returns (IL1ERC20Bridge);

120:     function l2BridgeAddress(uint256 _chainId) external view returns (address);

122:     function depositHappened(uint256 _chainId, bytes32 _l2TxHash) external view returns (bytes32);

124:     /// data is abi encoded :
125:     /// address _l1Token,
126:     /// uint256 _amount,
127:     /// address _l2Receiver

135:     function bridgehubDepositBaseToken(

142:     function bridgehubConfirmL2Transaction(uint256 _chainId, bytes32 _txDataHash, bytes32 _txHash) external;

144:     function receiveEth(uint256 _chainId) external payable;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L9-L12) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L13-L13), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L22-L22), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L31-L31), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L38-L38), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L44-L44), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L51-L51), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L58-L58), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L64-L64), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L74-L74), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L85-L85), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L97-L97), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L105-L105), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L114-L114), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L116-L116), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L118-L118), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L120-L120), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L122-L122), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L124-L127), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L135-L135), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L142-L142), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L144-L144)


```solidity

File: contracts/bridge/interfaces/IL2Bridge.sol

5: /// @author Matter Labs
6: interface IL2Bridge {

7:     function finalizeDeposit(

15:     function withdraw(address _l1Receiver, address _l2Token, uint256 _amount) external;

17:     function l1TokenAddress(address _l2Token) external view returns (address);

19:     function l2TokenAddress(address _l1Token) external view returns (address);

21:     function l1Bridge() external view returns (address);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL2Bridge.sol#L5-L6) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL2Bridge.sol#L7-L7), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL2Bridge.sol#L15-L15), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL2Bridge.sol#L17-L17), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL2Bridge.sol#L19-L19), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL2Bridge.sol#L21-L21)


```solidity

File: contracts/bridge/interfaces/IWETH9.sol

4: interface IWETH9 {

5:     function deposit() external payable;

7:     function withdraw(uint256 wad) external;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IWETH9.sol#L4-L4) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IWETH9.sol#L5-L5), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IWETH9.sol#L7-L7)


```solidity

File: contracts/bridgehub/IBridgehub.sol

10: struct L2TransactionRequestDirect {

22: struct L2TransactionRequestTwoBridgesOuter {

34: struct L2TransactionRequestTwoBridgesInner {

42: interface IBridgehub {

58:     /// Getters

61:     function stateTransitionManager(uint256 _chainId) external view returns (address);

63:     function tokenIsRegistered(address _baseToken) external view returns (bool);

65:     function baseToken(uint256 _chainId) external view returns (address);

67:     function sharedBridge() external view returns (IL1SharedBridge);

69:     function getStateTransition(uint256 _chainId) external view returns (address);

71:     /// Mailbox forwarder
72: 

81:     function proveL2LogInclusion(

89:     function proveL1ToL2TransactionStatus(

99:     function requestL2TransactionDirect(

103:     function requestL2TransactionTwoBridges(

107:     function l2TransactionBaseCost(

116:     function createNewChain(

125:     function addStateTransitionManager(address _stateTransitionManager) external;

127:     function removeStateTransitionManager(address _stateTransitionManager) external;

129:     function addToken(address _token) external;

131:     function setSharedBridge(address _sharedBridge) external;

133:     event NewChain(uint256 indexed chainId, address stateTransitionManager, address indexed chainGovernance);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L10-L10) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L22-L22), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L34-L34), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L42-L42), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L58-L58), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L61-L61), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L63-L63), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L65-L65), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L67-L67), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L69-L69), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L71-L72), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L81-L81), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L89-L89), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L99-L99), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L103-L103), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L107-L107), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L116-L116), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L125-L125), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L127-L127), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L129-L129), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L131-L131), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L133-L133)


```solidity

File: contracts/governance/IGovernance.sol

5: /// @title Governance contract interface
6: /// @author Matter Labs
7: /// @custom:security-contact security@matterlabs.dev
8: interface IGovernance {

21:     /// @dev Represents a call to be made during an operation.
22:     /// @param target The address to which the call will be made.
23:     /// @param value The amount of Ether (in wei) to be sent along with the call.
24:     /// @param data The calldata to be executed on the `target` address.

31:     /// @dev Defines the structure of an operation that Governance executes.
32:     /// @param calls An array of `Call` structs, each representing a call to be made during the operation.
33:     /// @param predecessor The hash of the predecessor operation, that should be executed before this operation.
34:     /// @param salt A bytes32 value used for creating unique operation hashes.

41:     function isOperation(bytes32 _id) external view returns (bool);

43:     function isOperationPending(bytes32 _id) external view returns (bool);

45:     function isOperationReady(bytes32 _id) external view returns (bool);

47:     function isOperationDone(bytes32 _id) external view returns (bool);

49:     function getOperationState(bytes32 _id) external view returns (OperationState);

51:     function scheduleTransparent(Operation calldata _operation, uint256 _delay) external;

53:     function scheduleShadow(bytes32 _id, uint256 _delay) external;

55:     function cancel(bytes32 _id) external;

57:     function execute(Operation calldata _operation) external payable;

59:     function executeInstant(Operation calldata _operation) external payable;

61:     function hashOperation(Operation calldata _operation) external pure returns (bytes32);

63:     function updateDelay(uint256 _newDelay) external;

65:     function updateSecurityCouncil(address _newSecurityCouncil) external;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/IGovernance.sol#L5-L8) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/IGovernance.sol#L21-L24), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/IGovernance.sol#L31-L34), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/IGovernance.sol#L41-L41), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/IGovernance.sol#L43-L43), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/IGovernance.sol#L45-L45), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/IGovernance.sol#L47-L47), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/IGovernance.sol#L49-L49), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/IGovernance.sol#L51-L51), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/IGovernance.sol#L53-L53), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/IGovernance.sol#L55-L55), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/IGovernance.sol#L57-L57), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/IGovernance.sol#L59-L59), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/IGovernance.sol#L61-L61), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/IGovernance.sol#L63-L63), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/IGovernance.sol#L65-L65)


```solidity

File: contracts/state-transition/IStateTransitionManager.sol

26: interface IStateTransitionManager {

28:     event StateTransitionNewChain(uint256 indexed _chainId, address indexed _stateTransitionContract);

30:     event SetChainIdUpgrade(

43:     function bridgehub() external view returns (address);

53:     function stateTransition(uint256 _chainId) external view returns (address);

55:     function storedBatchZero() external view returns (bytes32);

57:     function initialCutHash() external view returns (bytes32);

59:     function genesisUpgrade() external view returns (address);

61:     function upgradeCutHash(uint256 _protocolVersion) external view returns (bytes32);

63:     function protocolVersion() external view returns (uint256);

65:     function initialize(StateTransitionManagerInitializeData calldata _initalizeData) external;

67:     function setInitialCutHash(Diamond.DiamondCutData calldata _diamondCut) external;

69:     function setValidatorTimelock(address _validatorTimelock) external;

71:     function getChainAdmin(uint256 _chainId) external view returns (address);

82:     function registerAlreadyDeployedStateTransition(uint256 _chainId, address _stateTransitionContract) external;

84:     function setNewVersionUpgrade(

90:     function setUpgradeDiamondCut(Diamond.DiamondCutData calldata _cutData, uint256 _oldProtocolVersion) external;

92:     function freezeChain(uint256 _chainId) external;

94:     function unfreezeChain(uint256 _chainId) external;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/IStateTransitionManager.sol#L26-L26) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/IStateTransitionManager.sol#L28-L28), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/IStateTransitionManager.sol#L30-L30), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/IStateTransitionManager.sol#L43-L43), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/IStateTransitionManager.sol#L53-L53), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/IStateTransitionManager.sol#L55-L55), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/IStateTransitionManager.sol#L57-L57), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/IStateTransitionManager.sol#L59-L59), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/IStateTransitionManager.sol#L61-L61), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/IStateTransitionManager.sol#L63-L63), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/IStateTransitionManager.sol#L65-L65), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/IStateTransitionManager.sol#L67-L67), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/IStateTransitionManager.sol#L69-L69), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/IStateTransitionManager.sol#L71-L71), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/IStateTransitionManager.sol#L82-L82), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/IStateTransitionManager.sol#L84-L84), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/IStateTransitionManager.sol#L90-L90), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/IStateTransitionManager.sol#L92-L92), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/IStateTransitionManager.sol#L94-L94)


```solidity

File: contracts/state-transition/chain-interfaces/IAdmin.sol

10: /// @title The interface of the Admin Contract that controls access rights for contract management.
11: /// @author Matter Labs
12: /// @custom:security-contact security@matterlabs.dev
13: interface IAdmin is IZkSyncStateTransitionBase {

45:     function upgradeChainFromVersion(uint256 _protocolVersion, Diamond.DiamondCutData calldata _cutData) external;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IAdmin.sol#L10-L13) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IAdmin.sol#L45-L45)


```solidity

File: contracts/state-transition/chain-interfaces/IDiamondInit.sol

09: /// @param chainId the id of the chain
10: /// @param bridgehub the address of the bridgehub contract
11: /// @param stateTransitionManager contract's address
12: /// @param protocolVersion initial protocol version
13: /// @param validatorTimelock address of the validator timelock that delays execution
14: /// @param admin address who can manage the contract
15: /// @param baseToken address of the base token of the chain
16: /// @param baseTokenBridge address of the L1 shared bridge contract
17: /// @param storedBatchZero hash of the initial genesis batch
18: /// @param verifier address of Verifier contract
19: /// @param verifierParams Verifier config parameters that describes the circuit to be verified
20: /// @param l2BootloaderBytecodeHash The hash of bootloader L2 bytecode
21: /// @param l2DefaultAccountBytecodeHash The hash of default account L2 bytecode
22: /// @param priorityTxMaxGasLimit maximum number of the L2 gas that a user can request for L1 -> L2 transactions
23: /// @param feeParams Fee parameters to be used for L1->L2 transactions
24: /// @param blobVersionedHashRetriever Address of contract used to pull the blob versioned hash for a transaction.
25: struct InitializeData {

44: /// @param verifier address of Verifier contract
45: /// @param verifierParams Verifier config parameters that describes the circuit to be verified
46: /// @param l2BootloaderBytecodeHash The hash of bootloader L2 bytecode
47: /// @param l2DefaultAccountBytecodeHash The hash of default account L2 bytecode
48: /// @param priorityTxMaxGasLimit maximum number of the L2 gas that a user can request for L1 -> L2 transactions
49: /// @param feeParams Fee parameters to be used for L1->L2 transactions
50: /// @param blobVersionedHashRetriever Address of contract used to pull the blob versioned hash for a transaction.
51: struct InitializeDataNewChain {

61: interface IDiamondInit {

62:     function initialize(InitializeData calldata _initData) external returns (bytes32);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IDiamondInit.sol#L9-L25) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IDiamondInit.sol#L44-L51), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IDiamondInit.sol#L61-L61), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IDiamondInit.sol#L62-L62)


```solidity

File: contracts/state-transition/chain-interfaces/IExecutor.sol

27: struct LogProcessingOutput {

70: /// @title The interface of the zkSync Executor contract capable of processing events emitted in the zkSync protocol.
71: /// @author Matter Labs
72: /// @custom:security-contact security@matterlabs.dev
73: interface IExecutor is IZkSyncStateTransitionBase {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IExecutor.sol#L27-L27) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IExecutor.sol#L70-L73)


```solidity

File: contracts/state-transition/chain-interfaces/IGetters.sol

10: /// @title The interface of the Getters Contract that implements functions for getting contract state from outside the blockchain.
11: /// @author Matter Labs
12: /// @custom:security-contact security@matterlabs.dev
13: interface IGetters is IZkSyncStateTransitionBase {

18:     /// @return The address of the verifier smart contract

21:     /// @return The address of the current admin

24:     /// @return The address of the pending admin

27:     /// @return The address of the bridgehub

30:     /// @return The address of the state transition

33:     /// @return The address of the base token

36:     /// @return The address of the base token bridge

39:     /// @return The total number of batches that were committed

42:     /// @return The total number of batches that were committed & verified

45:     /// @return The total number of batches that were committed & verified & executed

48:     /// @return The total number of priority operations that were added to the priority queue, including all processed ones

58:     /// @return The number of priority operations currently in the queue

61:     /// @return The first unprocessed priority operation from the queue

64:     /// @return Whether the address has a validator access

67:     /// @return merkleRoot Merkle root of the tree with L2 logs for the selected batch

75:     /// @return Bytecode hash of bootloader program.

78:     /// @return Bytecode hash of default account (bytecode for EOA).

81:     /// @return Verifier parameters.

84:     /// @return Whether the diamond is frozen or not

87:     /// @return The current protocol version

90:     /// @return The upgrade system contract transaction hash, 0 if the upgrade is not initialized

93:     /// @return The L2 batch number in which the upgrade transaction was processed.
94:     /// @dev It is equal to 0 in the following two cases:
95:     /// - No upgrade transaction has ever been processed.
96:     /// - The upgrade transaction has been processed and the batch with such transaction has been
97:     /// executed (i.e. finalized).

100:     /// @return The maximum number of L2 gas that a user can request for L1 -> L2 transactions

103:     /// @return Whether a withdrawal has been finalized.
104:     /// @param _l2BatchNumber The L2 batch number within which the withdrawal happened.
105:     /// @param _l2MessageIndex The index of the L2->L1 message denoting the withdrawal.

108:     /// @return The pubdata pricing mode.

111:     /// @return the baseTokenGasPriceMultiplierNominator, used to compare the baseTokenPrice to ether for L1->L2 transactions

114:     /// @return the baseTokenGasPriceMultiplierDenominator, used to compare the baseTokenPrice to ether for L1->L2 transactions

129:     /// @return result All facet addresses and their function selectors

132:     /// @return NON-sorted array with function selectors supported by a specific facet

135:     /// @return facets NON-sorted array of facet addresses supported on diamond

138:     /// @return facet The facet address associated with a selector. Zero if the selector is not added to the diamond

141:     /// @return Whether the selector can be frozen by the admin or always accessible

144:     /// @return isFreezable Whether the facet can be frozen by the admin or always accessible


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IGetters.sol#L10-L13) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IGetters.sol#L18-L18), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IGetters.sol#L21-L21), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IGetters.sol#L24-L24), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IGetters.sol#L27-L27), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IGetters.sol#L30-L30), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IGetters.sol#L33-L33), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IGetters.sol#L36-L36), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IGetters.sol#L39-L39), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IGetters.sol#L42-L42), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IGetters.sol#L45-L45), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IGetters.sol#L48-L48), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IGetters.sol#L58-L58), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IGetters.sol#L61-L61), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IGetters.sol#L64-L64), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IGetters.sol#L67-L67), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IGetters.sol#L75-L75), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IGetters.sol#L78-L78), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IGetters.sol#L81-L81), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IGetters.sol#L84-L84), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IGetters.sol#L87-L87), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IGetters.sol#L90-L90), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IGetters.sol#L93-L97), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IGetters.sol#L100-L100), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IGetters.sol#L103-L105), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IGetters.sol#L108-L108), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IGetters.sol#L111-L111), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IGetters.sol#L114-L114), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IGetters.sol#L129-L129), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IGetters.sol#L132-L132), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IGetters.sol#L135-L135), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IGetters.sol#L138-L138), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IGetters.sol#L141-L141), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IGetters.sol#L144-L144)


```solidity

File: contracts/state-transition/chain-interfaces/ILegacyGetters.sol

07: /// @author Matter Labs
08: /// @dev This interface contains getters for the zkSync contract that should not be used,
09: /// but still are kept for backward compatibility.
10: /// @custom:security-contact security@matterlabs.dev
11: interface ILegacyGetters is IZkSyncStateTransitionBase {

12:     /// @return The total number of batches that were committed
13:     /// @dev It is a *deprecated* method, please use `getTotalBatchesCommitted` instead

16:     /// @return The total number of batches that were committed & verified
17:     /// @dev It is a *deprecated* method, please use `getTotalBatchesVerified` instead.

20:     /// @return The total number of batches that were committed & verified & executed
21:     /// @dev It is a *deprecated* method, please use `getTotalBatchesExecuted` instead.

30:     /// @return The L2 batch number in which the upgrade transaction was processed.
31:     /// @dev It is a *deprecated* method, please use `getL2SystemContractsUpgradeBatchNumber` instead.
32:     /// @dev It is equal to 0 in the following two cases:
33:     /// - No upgrade transaction has ever been processed.
34:     /// - The upgrade transaction has been processed and the batch with such transaction has been
35:     /// executed (i.e. finalized).


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/ILegacyGetters.sol#L7-L11) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/ILegacyGetters.sol#L12-L13), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/ILegacyGetters.sol#L16-L17), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/ILegacyGetters.sol#L20-L21), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/ILegacyGetters.sol#L30-L35)


```solidity

File: contracts/state-transition/chain-interfaces/IMailbox.sol

08: /// @title The interface of the zkSync Mailbox contract that provides interfaces for L1 <-> L2 interaction.
09: /// @author Matter Labs
10: /// @custom:security-contact security@matterlabs.dev
11: interface IMailbox is IZkSyncStateTransitionBase {

98:     function bridgehubRequestL2Transaction(


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IMailbox.sol#L8-L11) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IMailbox.sol#L98-L98)


```solidity

File: contracts/state-transition/chain-interfaces/IVerifier.sol

12: /// @title The interface of the Verifier contract, responsible for the zero knowledge proof verification.
13: /// @author Matter Labs
14: /// @custom:security-contact security@matterlabs.dev
15: interface IVerifier {

16:     /// @dev Verifies a zk-SNARK proof.
17:     /// @return A boolean value indicating whether the zk-SNARK proof is valid.
18:     /// Note: The function may revert execution instead of returning false in some cases.


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IVerifier.sol#L12-L15) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IVerifier.sol#L16-L18)


```solidity

File: contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol

15: interface IZkSyncStateTransition is IAdmin, IExecutor, IGetters, IMailbox {

17:     event ProposeTransparentUpgrade(


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol#L15-L15) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol#L17-L17)


```solidity

File: contracts/state-transition/chain-interfaces/IZkSyncStateTransitionBase.sol

4: /// @title The interface of the zkSync contract, responsible for the main zkSync logic.
5: /// @author Matter Labs
6: /// @custom:security-contact security@matterlabs.dev
7: interface IZkSyncStateTransitionBase {

8:     /// @return Returns facet name.


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IZkSyncStateTransitionBase.sol#L4-L7) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IZkSyncStateTransitionBase.sol#L8-L8)


```solidity

File: contracts/state-transition/l2-deps/ISystemContext.sol

4: interface ISystemContext {

5:     function setChainId(uint256 _newChainId) external;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/l2-deps/ISystemContext.sol#L4-L4) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/l2-deps/ISystemContext.sol#L5-L5)


```solidity

File: contracts/upgrades/IDefaultUpgrade.sol

7: interface IDefaultUpgrade {

8:     function upgrade(ProposedUpgrade calldata _upgrade) external returns (bytes32);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/IDefaultUpgrade.sol#L7-L7) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/IDefaultUpgrade.sol#L8-L8)


```solidity

File: contracts/common/Messaging.sol

13: /// @dev The log passed from L2
14: /// @param l2ShardId The shard identifier, 0 - rollup, 1 - porter
15: /// All other values are not used but are reserved for the future
16: /// @param isService A boolean flag that is part of the log along with `key`, `value`, and `sender` address.
17: /// This field is required formally but does not have any special meaning
18: /// @param txNumberInBatch The L2 transaction number in a Batch, in which the log was sent
19: /// @param sender The L2 address which sent the log
20: /// @param key The 32 bytes of information that was sent in the log
21: /// @param value The 32 bytes of information that was sent in the log
22: // Both `key` and `value` are arbitrary 32-bytes selected by the log sender

43: /// @dev Internal structure that contains the parameters for the writePriorityOp
44: /// internal function.
45: /// @param sender The sender's address.
46: /// @param txId The id of the priority transaction.
47: /// @param l2Value The msg.value of the L2 transaction.
48: /// @param contractAddressL2 The address of the contract on L2 to call.
49: /// @param expirationTimestamp The timestamp by which the priority operation must be processed by the operator.
50: /// @param l2GasLimit The limit of the L2 gas for the L2 transaction
51: /// @param l2GasPricePerPubdata The price for a single pubdata byte in L2 gas.
52: /// @param valueToMint The amount of ether that should be minted on L2 as the result of this transaction.
53: /// @param refundRecipient The recipient of the refund for the transaction on L2. If the transaction fails, then
54: /// this address will receive the `l2Value`.
55: struct WritePriorityOpParams {

68: /// @dev Structure that includes all fields of the L2 transaction
69: /// @dev The hash of this structure is the "canonical L2 transaction hash" and can
70: /// be used as a unique identifier of a tx
71: /// @param txType The tx type number, depending on which the L2 transaction can be
72: /// interpreted differently
73: /// @param from The sender's address. `uint256` type for possible address format changes
74: /// and maintaining backward compatibility
75: /// @param to The recipient's address. `uint256` type for possible address format changes
76: /// and maintaining backward compatibility
77: /// @param gasLimit The L2 gas limit for L2 transaction. Analog to the `gasLimit` on an
78: /// L1 transactions
79: /// @param gasPerPubdataByteLimit Maximum number of L2 gas that will cost one byte of pubdata
80: /// (every piece of data that will be stored on L1 as calldata)
81: /// @param maxFeePerGas The absolute maximum sender willing to pay per unit of L2 gas to get
82: /// the transaction included in a Batch. Analog to the EIP-1559 `maxFeePerGas` on an L1 transactions
83: /// @param maxPriorityFeePerGas The additional fee that is paid directly to the validator
84: /// to incentivize them to include the transaction in a Batch. Analog to the EIP-1559
85: /// `maxPriorityFeePerGas` on an L1 transactions
86: /// @param paymaster The address of the EIP-4337 paymaster, that will pay fees for the
87: /// transaction. `uint256` type for possible address format changes and maintaining backward compatibility
88: /// @param nonce The nonce of the transaction. For L1->L2 transactions it is the priority
89: /// operation Id
90: /// @param value The value to pass with the transaction
91: /// @param reserved The fixed-length fields for usage in a future extension of transaction
92: /// formats
93: /// @param data The calldata that is transmitted for the transaction call
94: /// @param signature An abstract set of bytes that are used for transaction authorization
95: /// @param factoryDeps The set of L2 bytecode hashes whose preimages were shown on L1
96: /// @param paymasterInput The arbitrary-length data that is used as a calldata to the paymaster pre-call
97: /// @param reservedDynamic The arbitrary-length field for usage in a future extension of transaction formats
98: struct L2CanonicalTransaction {

127: struct BridgehubL2TransactionRequest {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/Messaging.sol#L13-L22) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/Messaging.sol#L43-L55), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/Messaging.sol#L68-L98), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/Messaging.sol#L127-L127)


```solidity

File: contracts/common/ReentrancyGuard.sol

05: /**
06:  * @custom:security-contact security@matterlabs.dev
07:  * @dev Contract module that helps prevent reentrant calls to a function.
08:  *
09:  * Inheriting from `ReentrancyGuard` will make the {nonReentrant} modifier
10:  * available, which can be applied to functions to make sure there are no nested
11:  * (reentrant) calls to them.
12:  *
13:  * Note that because there is a single `nonReentrant` guard, functions marked as
14:  * `nonReentrant` may not call one another. This can be worked around by making
15:  * those functions `private`, and then adding `external` `nonReentrant` entry
16:  * points to them.
17:  *
18:  * TIP: If you would like to learn more about reentrancy and alternative ways
19:  * to protect against it, check out our blog post
20:  * https://blog.openzeppelin.com/reentrancy-after-istanbul/[Reentrancy After Istanbul].
21:  *
22:  * _Since v2.5.0:_ this module is now much more gas efficient, given net gas
23:  * metering changes introduced in the Istanbul hardfork.
24:  */

41:     modifier reentrancyGuardInitializer() {

46:     function _initializeReentrancyGuard() private {

61:     /**
62:      * @dev Prevents a contract from calling itself, directly or indirectly.
63:      * Calling a `nonReentrant` function from another `nonReentrant`
64:      * function is not supported. It is possible to prevent this from happening
65:      * by making the `nonReentrant` function external, and make it call a
66:      * `private` function that does the actual work.
67:      */


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/ReentrancyGuard.sol#L5-L24) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/ReentrancyGuard.sol#L41-L41), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/ReentrancyGuard.sol#L46-L46), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/ReentrancyGuard.sol#L61-L67)


```solidity

File: contracts/vendor/AddressAliasHelper.sol

21: library AddressAliasHelper {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/vendor/AddressAliasHelper.sol#L21-L21) 


```solidity

File: contracts/bridge/L2SharedBridge.sol

39:     /// @dev Contract is expected to be used as proxy implementation.
40:     /// @dev Disable the initialization to prevent Parity hack.

108:     /// @dev Deploy and initialize the L2 token for the L1 counterpart

137:     /// @dev Encode the message for l2ToL1log sent with withdraw initialization

148:     /// @return Address of an L2 token counterpart

156:     /// @dev Convert the L1 token address to the create2 salt of deployed L2 token

161:     /// @dev Deploy the beacon proxy for the L2 token, while using ContractDeployer system contract.
162:     /// @dev This function uses raw call to ContractDeployer to make sure that exactly `l2TokenProxyBytecodeHash` is used
163:     /// for the code of the proxy.


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L39-L40) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L108-L108), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L137-L137), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L148-L148), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L156-L156), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L161-L163)


```solidity

File: contracts/bridge/L2StandardERC20.sol

39:     /// @dev Contract is expected to be used as proxy implementation.

129:     modifier onlyBridge() {

134:     modifier onlyNextVersion(uint8 _version) {

159:     function name() public view override returns (string memory) {

165:     function symbol() public view override returns (string memory) {

171:     function decimals() public view override returns (uint8) {

177:     /// @dev External function to decode a string from bytes.

182:     /// @dev External function to decode a uint8 from bytes.


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2StandardERC20.sol#L39-L39) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2StandardERC20.sol#L129-L129), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2StandardERC20.sol#L134-L134), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2StandardERC20.sol#L159-L159), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2StandardERC20.sol#L165-L165), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2StandardERC20.sol#L171-L171), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2StandardERC20.sol#L177-L177), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2StandardERC20.sol#L182-L182)


```solidity

File: contracts/bridge/interfaces/IL1ERC20Bridge.sol

5: /// @author Matter Labs
6: // note we use the IL1ERC20Bridge only to send L1<>L2 messages,

9:     function finalizeWithdrawal(


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL1ERC20Bridge.sol#L5-L6) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL1ERC20Bridge.sol#L9-L9)


```solidity

File: contracts/bridge/interfaces/IL1SharedBridge.sol

5: /// @title L1 Bridge contract interface
6: /// @author Matter Labs
7: /// @custom:security-contact security@matterlabs.dev
8: interface IL1SharedBridge {

9:     function finalizeWithdrawal(


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL1SharedBridge.sol#L5-L8) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL1SharedBridge.sol#L9-L9)


```solidity

File: contracts/bridge/interfaces/IL2SharedBridge.sol

5: /// @author Matter Labs
6: interface IL2SharedBridge {

7:     event FinalizeDeposit(

14:     event WithdrawalInitiated(

21:     /// @dev Event emitted when baseToken is received by the contract.

24:     function finalizeDeposit(

32:     function withdraw(address _l1Receiver, address _l2Token, uint256 _amount) external;

34:     function l1TokenAddress(address _l2Token) external view returns (address);

36:     function l2TokenAddress(address _l1Token) external view returns (address);

38:     function l1Bridge() external view returns (address);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL2SharedBridge.sol#L5-L6) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL2SharedBridge.sol#L7-L7), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL2SharedBridge.sol#L14-L14), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL2SharedBridge.sol#L21-L21), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL2SharedBridge.sol#L24-L24), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL2SharedBridge.sol#L32-L32), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL2SharedBridge.sol#L34-L34), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL2SharedBridge.sol#L36-L36), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL2SharedBridge.sol#L38-L38)


```solidity

File: contracts/bridge/interfaces/IL2StandardToken.sol

5: interface IL2StandardToken {

6:     event BridgeInitialize(address indexed l1Token, string name, string symbol, uint8 decimals);

8:     event BridgeMint(address indexed _account, uint256 _amount);

10:     event BridgeBurn(address indexed _account, uint256 _amount);

12:     function bridgeMint(address _account, uint256 _amount) external;

14:     function bridgeBurn(address _account, uint256 _amount) external;

16:     function l1Address() external view returns (address);

18:     function l2Bridge() external view returns (address);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL2StandardToken.sol#L5-L5) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL2StandardToken.sol#L6-L6), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL2StandardToken.sol#L8-L8), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL2StandardToken.sol#L10-L10), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL2StandardToken.sol#L12-L12), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL2StandardToken.sol#L14-L14), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL2StandardToken.sol#L16-L16), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL2StandardToken.sol#L18-L18)


```solidity

File: contracts/interfaces/IPaymaster.sol

14: interface IPaymaster {

15:     /// @dev Called by the bootloader to verify that the paymaster agrees to pay for the
16:     /// fee for the transaction. This transaction should also send the necessary amount of funds onto the bootloader
17:     /// address.
18:     /// @param _txHash The hash of the transaction
19:     /// @param _suggestedSignedHash The hash of the transaction that is signed by an EOA
20:     /// @param _transaction The transaction itself.
21:     /// @return magic The value that should be equal to the signature of the validateAndPayForPaymasterTransaction
22:     /// if the paymaster agrees to pay for the transaction.
23:     /// @return context The "context" of the transaction: an array of bytes of length at most 1024 bytes, which will be
24:     /// passed to the `postTransaction` method of the account.
25:     /// @dev The developer should strive to preserve as many steps as possible both for valid
26:     /// and invalid transactions as this very method is also used during the gas fee estimation
27:     /// (without some of the necessary data, e.g. signature).

34:     /// @dev Called by the bootloader after the execution of the transaction. Please note that
35:     /// there is no guarantee that this method will be called at all. Unlike the original EIP4337,
36:     /// this method won't be called if the transaction execution results in out-of-gas.
37:     /// @param _context, the context of the execution, returned by the "validateAndPayForPaymasterTransaction" method.
38:     /// @param  _transaction, the users' transaction.
39:     /// @param _txResult, the result of the transaction execution (success or failure).
40:     /// @param _maxRefundedGas, the upper bound on the amout of gas that could be refunded to the paymaster.
41:     /// @dev The exact amount refunded depends on the gas spent by the "postOp" itself and so the developers should
42:     /// take that into account.


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/interfaces/IPaymaster.sol#L14-L14) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/interfaces/IPaymaster.sol#L15-L27), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/interfaces/IPaymaster.sol#L34-L42)


```solidity

File: contracts/interfaces/IPaymasterFlow.sol

14:     function general(bytes calldata input) external;

16:     function approvalBased(address _token, uint256 _minAllowance, bytes calldata _innerInput) external;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/interfaces/IPaymasterFlow.sol#L14-L14) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/interfaces/IPaymasterFlow.sol#L16-L16)


```solidity

File: contracts/vendor/AddressAliasHelper.sol

21: library AddressAliasHelper {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/vendor/AddressAliasHelper.sol#L21-L21) 


```solidity

File: contracts/SystemContractsCaller.sol

26: library Utils {

27:     function safeCastToU32(uint256 _x) internal pure returns (uint32) {

37:     function systemCall(uint32 gasLimit, address to, uint256 value, bytes memory data) internal returns (bool success) {

76:     function systemCallWithReturndata(

95:     function getFarCallABI(

121:     function getFarCallABIWithEmptyFatPointer(


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/SystemContractsCaller.sol#L26-L26) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/SystemContractsCaller.sol#L27-L27), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/SystemContractsCaller.sol#L37-L37), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/SystemContractsCaller.sol#L76-L76), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/SystemContractsCaller.sol#L95-L95), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/SystemContractsCaller.sol#L121-L121)


</details>


### [NC&#x2011;93] Do not use UNDERSCORE in `struct` elements names 



*There are 1 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol

//@audit remove underscore from `__DEPRECATED_diamondCutStorage`, `__DEPRECATED_governor`, `__DEPRECATED_pendingGovernor`, `__DEPRECATED_allowList`, `__DEPRECATED_upgrades`, `__DEPRECATED_lastWithdrawalLimitReset`, `__DEPRECATED_withdrawnAmountInWindow`, `__DEPRECATED_totalDepositedAmountPerUser`, 
066: struct ZkSyncStateTransitionStorage {
067:     /// @dev Storage of variables needed for deprecated diamond cut facet
068:     uint256[7] __DEPRECATED_diamondCutStorage;
069:     /// @notice Address which will exercise critical changes to the Diamond Proxy (upgrades, freezing & unfreezing). Replaced by STM
070:     address __DEPRECATED_governor;
071:     /// @notice Address that the governor proposed as one that will replace it
072:     address __DEPRECATED_pendingGovernor;
073:     /// @notice List of permitted validators
074:     mapping(address validatorAddress => bool isValidator) validators;
075:     /// @dev Verifier contract. Used to verify aggregated proof for batches
076:     IVerifier verifier;
077:     /// @notice Total number of executed batches i.e. batches[totalBatchesExecuted] points at the latest executed batch
078:     /// (batch 0 is genesis)
079:     uint256 totalBatchesExecuted;
080:     /// @notice Total number of proved batches i.e. batches[totalBatchesProved] points at the latest proved batch
081:     uint256 totalBatchesVerified;
082:     /// @notice Total number of committed batches i.e. batches[totalBatchesCommitted] points at the latest committed
083:     /// batch
084:     uint256 totalBatchesCommitted;
085:     /// @dev Stored hashed StoredBatch for batch number
086:     mapping(uint256 batchNumber => bytes32 batchHash) storedBatchHashes;
087:     /// @dev Stored root hashes of L2 -> L1 logs
088:     mapping(uint256 batchNumber => bytes32 l2LogsRootHash) l2LogsRootHashes;
089:     /// @dev Container that stores transactions requested from L1
090:     PriorityQueue.Queue priorityQueue;
091:     /// @dev The smart contract that manages the list with permission to call contract functions
092:     address __DEPRECATED_allowList;
093:     /// @notice Part of the configuration parameters of ZKP circuits. Used as an input for the verifier smart contract
094:     VerifierParams verifierParams;
095:     /// @notice Bytecode hash of bootloader program.
096:     /// @dev Used as an input to zkp-circuit.
097:     bytes32 l2BootloaderBytecodeHash;
098:     /// @notice Bytecode hash of default account (bytecode for EOA).
099:     /// @dev Used as an input to zkp-circuit.
100:     bytes32 l2DefaultAccountBytecodeHash;
101:     /// @dev Indicates that the porter may be touched on L2 transactions.
102:     /// @dev Used as an input to zkp-circuit.
103:     bool zkPorterIsAvailable;
104:     /// @dev The maximum number of the L2 gas that a user can request for L1 -> L2 transactions
105:     /// @dev This is the maximum number of L2 gas that is available for the "body" of the transaction, i.e.
106:     /// without overhead for proving the batch.
107:     uint256 priorityTxMaxGasLimit;
108:     /// @dev Storage of variables needed for upgrade facet
109:     UpgradeStorage __DEPRECATED_upgrades;
110:     /// @dev A mapping L2 batch number => message number => flag.
111:     /// @dev The L2 -> L1 log is sent for every withdrawal, so this mapping is serving as
112:     /// a flag to indicate that the message was already processed.
113:     /// @dev Used to indicate that eth withdrawal was already processed
114:     mapping(uint256 l2BatchNumber => mapping(uint256 l2ToL1MessageNumber => bool isFinalized)) isEthWithdrawalFinalized;
115:     /// @dev The most recent withdrawal time and amount reset
116:     uint256 __DEPRECATED_lastWithdrawalLimitReset;
117:     /// @dev The accumulated withdrawn amount during the withdrawal limit window
118:     uint256 __DEPRECATED_withdrawnAmountInWindow;
119:     /// @dev A mapping user address => the total deposited amount by the user
120:     mapping(address => uint256) __DEPRECATED_totalDepositedAmountPerUser;
121:     /// @dev Stores the protocol version. Note, that the protocol version may not only encompass changes to the
122:     /// smart contracts, but also to the node behavior.
123:     uint256 protocolVersion;
124:     /// @dev Hash of the system contract upgrade transaction. If 0, then no upgrade transaction needs to be done.
125:     bytes32 l2SystemContractsUpgradeTxHash;
126:     /// @dev Batch number where the upgrade transaction has happened. If 0, then no upgrade transaction has happened
127:     /// yet.
128:     uint256 l2SystemContractsUpgradeBatchNumber;
129:     /// @dev Address which will exercise non-critical changes to the Diamond Proxy (changing validator set & unfreezing)
130:     address admin;
131:     /// @notice Address that the admin proposed as one that will replace admin role
132:     address pendingAdmin;
133:     /// @dev Fee params used to derive gasPrice for the L1->L2 transactions. For L2 transactions,
134:     /// the bootloader gives enough freedom to the operator.
135:     FeeParams feeParams;
136:     /// @dev Address of the blob versioned hash getter smart contract used for EIP-4844 versioned hashes.
137:     address blobVersionedHashRetriever;
138:     /// new fields
139:     /// @dev The chainId of the chain
140:     uint256 chainId;
141:     /// @dev The address of the bridgehub
142:     address bridgehub;
143:     /// @dev The address of the StateTransitionManager
144:     address stateTransitionManager;
145:     /// @dev The address of the baseToken contract. Eth is address(1)
146:     address baseToken;
147:     /// @dev The address of the baseTokenbridge. Eth also uses the shared bridge
148:     address baseTokenBridge;
149:     /// @notice gasPriceMultiplier for each baseToken, so that each L1->L2 transaction pays for its transaction on the destination
150:     /// we multiply by the nominator, and divide by the denominator
151:     uint128 baseTokenGasPriceMultiplierNominator;
152:     uint128 baseTokenGasPriceMultiplierDenominator;
153: }


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L66-L153) 


</details>


### [NC&#x2011;94] Events should use parameters to convey information 
For example, rather than using `event Paused()` and `event Unpaused()`, use `event PauseState(address indexed whoChangedIt, bool wasPaused, bool isNowPaused)`


*There are 2 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/state-transition/chain-interfaces/IAdmin.sol

94:     event Freeze();

97:     event Unfreeze();


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IAdmin.sol#L94-L94) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IAdmin.sol#L97-L97)


</details>


### [NC&#x2011;95] Expressions for constant values should use `immutable` rather than `constant` 
While it does not save gas for some simple binary expressions because the compiler knows that developers often make this mistake, it's still best to use the right tool for the task at hand. There is a difference between `constant` variables and `immutable` variables, and they should each be used in their appropriate contexts. `constants` should be used for literal values written into the code, and `immutable` variables should be used for expressions, or values calculated in, or passed into the constructor.


*There are 9 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/NonceHolder.sol

28:     uint256 private constant DEPLOY_NONCE_MULTIPLIER = 2 ** 128;

31:     uint256 private constant MAXIMAL_MIN_NONCE_INCREMENT = 2 ** 32;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/NonceHolder.sol#L28-L28) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/NonceHolder.sol#L31-L31)


```solidity

File: contracts/libraries/TransactionHelper.sol

82:     bytes32 constant EIP712_DOMAIN_TYPEHASH = keccak256("EIP712Domain(string name,string version,uint256 chainId)");

84:     bytes32 constant EIP712_TRANSACTION_TYPE_HASH =
85:         keccak256(
86:             "Transaction(uint256 txType,uint256 from,uint256 to,uint256 gasLimit,uint256 gasPerPubdataByteLimit,uint256 maxFeePerGas,uint256 maxPriorityFeePerGas,uint256 paymaster,uint256 nonce,uint256 value,bytes data,bytes32[] factoryDeps,bytes paymasterInput)"
87:         );


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L82-L82) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L84-L87)


```solidity

File: contracts/governance/Governance.sol

22:     uint256 internal constant EXECUTED_PROPOSAL_TIMESTAMP = uint256(1);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/Governance.sol#L22-L22) 


```solidity

File: contracts/common/libraries/L2ContractHelper.sol

12:     bytes32 private constant CREATE2_PREFIX = keccak256("zksyncCreate2");


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/L2ContractHelper.sol#L12-L12) 


```solidity

File: contracts/vendor/AddressAliasHelper.sol

22:     uint160 constant offset = uint160(0x1111000000000000000000000000000000001111);

22:     uint160 constant offset = uint160(0x1111000000000000000000000000000000001111);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/vendor/AddressAliasHelper.sol#L22-L22) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/vendor/AddressAliasHelper.sol#L22-L22)


```solidity

File: contracts/L2ContractHelper.sol

85:     bytes32 private constant CREATE2_PREFIX = keccak256("zksyncCreate2");


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/L2ContractHelper.sol#L85-L85) 


</details>


### [NC&#x2011;96] Contract uses both `require()`/`revert()` as well as custom errors 
Consider using just one method in a single file. The below instances represents the less used technique


*There are 2 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/state-transition/ValidatorTimelock.sol

80:             revert AddressAlreadyValidator(_chainId);

89:             revert ValidatorDoesNotExist(_chainId);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L80-L80) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L89-L89)


</details>


### [NC&#x2011;97] `immutable` variable names don\'t follow the Solidity style guide 
For `immutable` variable names, each word should use all capital letters, with underscores separating each word (CONSTANT_CASE)


*There are 5 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/bridge/L1ERC20Bridge.sol

23:     IL1SharedBridge public immutable override sharedBridge;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1ERC20Bridge.sol#L23-L23) 


```solidity

File: contracts/bridge/L1SharedBridge.sol

34:     address public immutable override l1WethAddress;

37:     IBridgehub public immutable override bridgehub;

40:     IL1ERC20Bridge public immutable override legacyBridge;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L34-L34) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L37-L37), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L40-L40)


```solidity

File: contracts/state-transition/StateTransitionManager.sol

27:     address public immutable bridgehub;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L27-L27) 


</details>


### [NC&#x2011;98] `private`/`public` function name should start with underscore 
According to solidity style guide, Private or Public function name should start with underscore.


*There are 109 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/BootloaderUtilities.sol

//@audit `encodeLegacyTransactionHash` is not in CamelCase
44:     function encodeLegacyTransactionHash(Transaction calldata _transaction) internal view returns (bytes32 txHash) {

//@audit `encodeEIP2930TransactionHash` is not in CamelCase
139:     function encodeEIP2930TransactionHash(Transaction calldata _transaction) internal view returns (bytes32) {

//@audit `encodeEIP1559TransactionHash` is not in CamelCase
229:     function encodeEIP1559TransactionHash(Transaction calldata _transaction) internal view returns (bytes32) {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L44-L44) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L139-L139), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L229-L229)


```solidity

File: contracts/L1Messenger.sol

//@audit `keccakGasCost` is not in CamelCase
50:     function keccakGasCost(uint256 _length) internal pure returns (uint256) {

//@audit `sha256GasCost` is not in CamelCase
61:     function sha256GasCost(uint256 _length) internal pure returns (uint256) {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L50-L50) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L61-L61)


```solidity

File: contracts/libraries/EfficientCall.sol

//@audit `keccak` is not in CamelCase
36:     function keccak(bytes calldata _data) internal view returns (bytes32) {

//@audit `sha` is not in CamelCase
45:     function sha(bytes calldata _data) internal view returns (bytes32) {

//@audit `call` is not in CamelCase
58:     function call(

//@audit `staticCall` is not in CamelCase
74:     function staticCall(

//@audit `delegateCall` is not in CamelCase
88:     function delegateCall(

//@audit `mimicCall` is not in CamelCase
105:     function mimicCall(

//@audit `rawCall` is not in CamelCase
124:     function rawCall(

//@audit `rawStaticCall` is not in CamelCase
159:     function rawStaticCall(uint256 _gas, address _address, bytes calldata _data) internal view returns (bool success) {

//@audit `rawDelegateCall` is not in CamelCase
173:     function rawDelegateCall(uint256 _gas, address _address, bytes calldata _data) internal returns (bool success) {

//@audit `rawMimicCall` is not in CamelCase
191:     function rawMimicCall(

//@audit `propagateRevert` is not in CamelCase
232:     function propagateRevert() internal pure {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L36-L36) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L45-L45), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L58-L58), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L74-L74), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L88-L88), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L105-L105), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L124-L124), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L159-L159), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L173-L173), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L191-L191), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L232-L232)


```solidity

File: contracts/libraries/RLPEncoder.sol

//@audit `encodeAddress` is not in CamelCase
11:     function encodeAddress(address _val) internal pure returns (bytes memory encoded) {

//@audit `encodeUint256` is not in CamelCase
24:     function encodeUint256(uint256 _val) internal pure returns (bytes memory encoded) {

//@audit `encodeNonSingleBytesLen` is not in CamelCase
49:     function encodeNonSingleBytesLen(uint64 _len) internal pure returns (bytes memory) {

//@audit `encodeListLen` is not in CamelCase
56:     function encodeListLen(uint64 _len) internal pure returns (bytes memory) {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/RLPEncoder.sol#L11-L11) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/RLPEncoder.sol#L24-L24), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/RLPEncoder.sol#L49-L49), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/RLPEncoder.sol#L56-L56)


```solidity

File: contracts/libraries/SystemContractHelper.sol

//@audit `toL1` is not in CamelCase
48:     function toL1(bool _isService, bytes32 _key, bytes32 _value) internal {

//@audit `getCodeAddress` is not in CamelCase
63:     function getCodeAddress() internal view returns (address addr) {

//@audit `loadCalldataIntoActivePtr` is not in CamelCase
74:     function loadCalldataIntoActivePtr() internal view {

//@audit `ptrPackIntoActivePtr` is not in CamelCase
85:     function ptrPackIntoActivePtr(uint256 _farCallAbi) internal view {

//@audit `ptrAddIntoActive` is not in CamelCase
94:     function ptrAddIntoActive(uint32 _value) internal view {

//@audit `ptrShrinkIntoActive` is not in CamelCase
106:     function ptrShrinkIntoActive(uint32 _shrink) internal view {

//@audit `packPrecompileParams` is not in CamelCase
124:     function packPrecompileParams(

//@audit `unsafePrecompileCall` is not in CamelCase
148:     function unsafePrecompileCall(

//@audit `setValueForNextFarCall` is not in CamelCase
168:     function setValueForNextFarCall(uint128 _value) internal returns (bool success) {

//@audit `eventInitialize` is not in CamelCase
181:     function eventInitialize(uint256 initializer, uint256 value1) internal {

//@audit `eventWrite` is not in CamelCase
191:     function eventWrite(uint256 value1, uint256 value2) internal {

//@audit `getZkSyncMetaBytes` is not in CamelCase
203:     function getZkSyncMetaBytes() internal view returns (uint256 meta) {

//@audit `extractNumberFromMeta` is not in CamelCase
215:     function extractNumberFromMeta(uint256 meta, uint256 offset, uint256 size) internal pure returns (uint256 result) {

//@audit `getPubdataPublishedFromMeta` is not in CamelCase
227:     function getPubdataPublishedFromMeta(uint256 meta) internal pure returns (uint32 pubdataPublished) {

//@audit `getHeapSizeFromMeta` is not in CamelCase
237:     function getHeapSizeFromMeta(uint256 meta) internal pure returns (uint32 heapSize) {

//@audit `getAuxHeapSizeFromMeta` is not in CamelCase
246:     function getAuxHeapSizeFromMeta(uint256 meta) internal pure returns (uint32 auxHeapSize) {

//@audit `getShardIdFromMeta` is not in CamelCase
254:     function getShardIdFromMeta(uint256 meta) internal pure returns (uint8 shardId) {

//@audit `getCallerShardIdFromMeta` is not in CamelCase
263:     function getCallerShardIdFromMeta(uint256 meta) internal pure returns (uint8 callerShardId) {

//@audit `getCodeShardIdFromMeta` is not in CamelCase
272:     function getCodeShardIdFromMeta(uint256 meta) internal pure returns (uint8 codeShardId) {

//@audit `getZkSyncMeta` is not in CamelCase
279:     function getZkSyncMeta() internal view returns (ZkSyncMeta memory meta) {

//@audit `getCallFlags` is not in CamelCase
296:     function getCallFlags() internal view returns (uint256 callFlags) {

//@audit `getCalldataPtr` is not in CamelCase
307:     function getCalldataPtr() internal view returns (uint256 ptr) {

//@audit `getExtraAbiData` is not in CamelCase
318:     function getExtraAbiData(uint256 index) internal view returns (uint256 extraAbiData) {

//@audit `isSystemCall` is not in CamelCase
329:     function isSystemCall() internal view returns (bool) {

//@audit `isSystemContract` is not in CamelCase
338:     function isSystemContract(address _address) internal pure returns (bool) {

//@audit `burnGas` is not in CamelCase
344:     function burnGas(uint32 _gasToPay, uint32 _pubdataToSpend) internal view {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L48-L48) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L63-L63), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L74-L74), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L85-L85), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L94-L94), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L106-L106), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L124-L124), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L148-L148), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L168-L168), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L181-L181), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L191-L191), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L203-L203), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L215-L215), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L227-L227), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L237-L237), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L246-L246), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L254-L254), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L263-L263), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L272-L272), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L279-L279), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L296-L296), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L307-L307), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L318-L318), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L329-L329), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L338-L338), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L344-L344)


```solidity

File: contracts/libraries/SystemContractsCaller.sol

//@audit `systemCall` is not in CamelCase
76:     function systemCall(uint32 gasLimit, address to, uint256 value, bytes memory data) internal returns (bool success) {

//@audit `systemCallWithReturndata` is not in CamelCase
123:     function systemCallWithReturndata(

//@audit `systemCallWithPropagatedRevert` is not in CamelCase
150:     function systemCallWithPropagatedRevert(

//@audit `getFarCallABI` is not in CamelCase
214:     function getFarCallABI(

//@audit `getFarCallABIWithEmptyFatPointer` is not in CamelCase
250:     function getFarCallABIWithEmptyFatPointer(


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractsCaller.sol#L76-L76) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractsCaller.sol#L123-L123), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractsCaller.sol#L150-L150), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractsCaller.sol#L214-L214), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractsCaller.sol#L250-L250)


```solidity

File: contracts/libraries/TransactionHelper.sol

//@audit `isEthToken` is not in CamelCase
94:     function isEthToken(uint256 _addr) internal pure returns (bool) {

//@audit `encodeHash` is not in CamelCase
100:     function encodeHash(Transaction calldata _transaction) internal view returns (bytes32 resultHash) {

//@audit `processPaymasterInput` is not in CamelCase
362:     function processPaymasterInput(Transaction calldata _transaction) internal {

//@audit `payToTheBootloader` is not in CamelCase
395:     function payToTheBootloader(Transaction calldata _transaction) internal returns (bool success) {

//@audit `totalRequiredBalance` is not in CamelCase
405:     function totalRequiredBalance(Transaction calldata _transaction) internal pure returns (uint256 requiredBalance) {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L94-L94) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L100-L100), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L362-L362), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L395-L395), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L405-L405)


```solidity

File: contracts/libraries/UnsafeBytesCalldata.sol

//@audit `readUint16` is not in CamelCase
19:     function readUint16(bytes calldata _bytes, uint256 _start) internal pure returns (uint16 result) {

//@audit `readUint32` is not in CamelCase
26:     function readUint32(bytes calldata _bytes, uint256 _start) internal pure returns (uint32 result) {

//@audit `readUint64` is not in CamelCase
33:     function readUint64(bytes calldata _bytes, uint256 _start) internal pure returns (uint64 result) {

//@audit `readBytes32` is not in CamelCase
40:     function readBytes32(bytes calldata _bytes, uint256 _start) internal pure returns (bytes32 result) {

//@audit `readUint256` is not in CamelCase
46:     function readUint256(bytes calldata _bytes, uint256 _start) internal pure returns (uint256 result) {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/UnsafeBytesCalldata.sol#L19-L19) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/UnsafeBytesCalldata.sol#L26-L26), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/UnsafeBytesCalldata.sol#L33-L33), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/UnsafeBytesCalldata.sol#L40-L40), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/UnsafeBytesCalldata.sol#L46-L46)


```solidity

File: contracts/libraries/Utils.sol

//@audit `safeCastToU128` is not in CamelCase
20:     function safeCastToU128(uint256 _x) internal pure returns (uint128) {

//@audit `safeCastToU32` is not in CamelCase
26:     function safeCastToU32(uint256 _x) internal pure returns (uint32) {

//@audit `safeCastToU24` is not in CamelCase
32:     function safeCastToU24(uint256 _x) internal pure returns (uint24) {

//@audit `bytecodeLenInBytes` is not in CamelCase
39:     function bytecodeLenInBytes(bytes32 _bytecodeHash) internal pure returns (uint256 codeLength) {

//@audit `bytecodeLenInWords` is not in CamelCase
44:     function bytecodeLenInWords(bytes32 _bytecodeHash) internal pure returns (uint256 codeLengthInWords) {

//@audit `isContractConstructed` is not in CamelCase
51:     function isContractConstructed(bytes32 _bytecodeHash) internal pure returns (bool) {

//@audit `isContractConstructing` is not in CamelCase
56:     function isContractConstructing(bytes32 _bytecodeHash) internal pure returns (bool) {

//@audit `constructingBytecodeHash` is not in CamelCase
63:     function constructingBytecodeHash(bytes32 _bytecodeHash) internal pure returns (bytes32) {

//@audit `constructedBytecodeHash` is not in CamelCase
71:     function constructedBytecodeHash(bytes32 _bytecodeHash) internal pure returns (bytes32) {

//@audit `hashL2Bytecode` is not in CamelCase
82:     function hashL2Bytecode(bytes calldata _bytecode) internal view returns (bytes32 hashedBytecode) {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L20-L20) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L26-L26), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L32-L32), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L39-L39), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L44-L44), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L51-L51), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L56-L56), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L63-L63), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L71-L71), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L82-L82)


```solidity

File: contracts/common/libraries/L2ContractHelper.sol

//@audit `hashL2Bytecode` is not in CamelCase
21:     function hashL2Bytecode(bytes memory _bytecode) internal pure returns (bytes32 hashedBytecode) {

//@audit `validateBytecodeHash` is not in CamelCase
39:     function validateBytecodeHash(bytes32 _bytecodeHash) internal pure {

//@audit `bytecodeLen` is not in CamelCase
49:     function bytecodeLen(bytes32 _bytecodeHash) internal pure returns (uint256 codeLengthInWords) {

//@audit `computeCreate2Address` is not in CamelCase
60:     function computeCreate2Address(


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/L2ContractHelper.sol#L21-L21) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/L2ContractHelper.sol#L39-L39), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/L2ContractHelper.sol#L49-L49), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/L2ContractHelper.sol#L60-L60)


```solidity

File: contracts/common/libraries/UncheckedMath.sol

//@audit `uncheckedInc` is not in CamelCase
11:     function uncheckedInc(uint256 _number) internal pure returns (uint256) {

//@audit `uncheckedAdd` is not in CamelCase
17:     function uncheckedAdd(uint256 _lhs, uint256 _rhs) internal pure returns (uint256) {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/UncheckedMath.sol#L11-L11) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/UncheckedMath.sol#L17-L17)


```solidity

File: contracts/common/libraries/UnsafeBytes.sol

//@audit `readUint32` is not in CamelCase
19:     function readUint32(bytes memory _bytes, uint256 _start) internal pure returns (uint32 result, uint256 offset) {

//@audit `readAddress` is not in CamelCase
26:     function readAddress(bytes memory _bytes, uint256 _start) internal pure returns (address result, uint256 offset) {

//@audit `readUint256` is not in CamelCase
33:     function readUint256(bytes memory _bytes, uint256 _start) internal pure returns (uint256 result, uint256 offset) {

//@audit `readBytes32` is not in CamelCase
40:     function readBytes32(bytes memory _bytes, uint256 _start) internal pure returns (bytes32 result, uint256 offset) {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/UnsafeBytes.sol#L19-L19) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/UnsafeBytes.sol#L26-L26), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/UnsafeBytes.sol#L33-L33), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/UnsafeBytes.sol#L40-L40)


```solidity

File: contracts/state-transition/libraries/Diamond.sol

//@audit `getDiamondStorage` is not in CamelCase
87:     function getDiamondStorage() internal pure returns (DiamondStorage storage diamondStorage) {

//@audit `diamondCut` is not in CamelCase
96:     function diamondCut(DiamondCutData memory _diamondCut) internal {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L87-L87) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L96-L96)


```solidity

File: contracts/state-transition/libraries/LibMap.sol

//@audit `get` is not in CamelCase
18:     function get(Uint32Map storage _map, uint256 _index) internal view returns (uint32 result) {

//@audit `set` is not in CamelCase
38:     function set(Uint32Map storage _map, uint256 _index, uint32 _value) internal {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/LibMap.sol#L18-L18) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/LibMap.sol#L38-L38)


```solidity

File: contracts/state-transition/libraries/Merkle.sol

//@audit `calculateRoot` is not in CamelCase
18:     function calculateRoot(


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Merkle.sol#L18-L18) 


```solidity

File: contracts/state-transition/libraries/PriorityQueue.sol

//@audit `getFirstUnprocessedPriorityTx` is not in CamelCase
35:     function getFirstUnprocessedPriorityTx(Queue storage _queue) internal view returns (uint256) {

//@audit `getTotalPriorityTxs` is not in CamelCase
40:     function getTotalPriorityTxs(Queue storage _queue) internal view returns (uint256) {

//@audit `getSize` is not in CamelCase
45:     function getSize(Queue storage _queue) internal view returns (uint256) {

//@audit `isEmpty` is not in CamelCase
50:     function isEmpty(Queue storage _queue) internal view returns (bool) {

//@audit `pushBack` is not in CamelCase
55:     function pushBack(Queue storage _queue, PriorityOperation memory _operation) internal {

//@audit `front` is not in CamelCase
64:     function front(Queue storage _queue) internal view returns (PriorityOperation memory) {

//@audit `popFront` is not in CamelCase
72:     function popFront(Queue storage _queue) internal returns (PriorityOperation memory priorityOperation) {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/PriorityQueue.sol#L35-L35) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/PriorityQueue.sol#L40-L40), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/PriorityQueue.sol#L45-L45), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/PriorityQueue.sol#L50-L50), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/PriorityQueue.sol#L55-L55), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/PriorityQueue.sol#L64-L64), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/PriorityQueue.sol#L72-L72)


```solidity

File: contracts/state-transition/libraries/TransactionValidator.sol

//@audit `validateL1ToL2Transaction` is not in CamelCase
19:     function validateL1ToL2Transaction(

//@audit `validateUpgradeTransaction` is not in CamelCase
46:     function validateUpgradeTransaction(L2CanonicalTransaction memory _transaction) internal pure {

//@audit `getMinimalPriorityTransactionGasLimit` is not in CamelCase
69:     function getMinimalPriorityTransactionGasLimit(

//@audit `getTransactionBodyGasLimit` is not in CamelCase
109:     function getTransactionBodyGasLimit(

//@audit `getOverheadForTransaction` is not in CamelCase
128:     function getOverheadForTransaction(


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/TransactionValidator.sol#L19-L19) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/TransactionValidator.sol#L46-L46), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/TransactionValidator.sol#L69-L69), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/TransactionValidator.sol#L109-L109), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/TransactionValidator.sol#L128-L128)


```solidity

File: contracts/vendor/AddressAliasHelper.sol

//@audit `applyL1ToL2Alias` is not in CamelCase
28:     function applyL1ToL2Alias(address l1Address) internal pure returns (address l2Address) {

//@audit `undoL1ToL2Alias` is not in CamelCase
38:     function undoL1ToL2Alias(address l2Address) internal pure returns (address l1Address) {

//@audit `applyL1ToL2Alias` is not in CamelCase
28:     function applyL1ToL2Alias(address l1Address) internal pure returns (address l2Address) {

//@audit `undoL1ToL2Alias` is not in CamelCase
38:     function undoL1ToL2Alias(address l2Address) internal pure returns (address l1Address) {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/vendor/AddressAliasHelper.sol#L28-L28) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/vendor/AddressAliasHelper.sol#L38-L38), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/vendor/AddressAliasHelper.sol#L28-L28), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/vendor/AddressAliasHelper.sol#L38-L38)


```solidity

File: contracts/L2ContractHelper.sol

//@audit `sendMessageToL1` is not in CamelCase
90:     function sendMessageToL1(bytes memory _message) internal returns (bytes32) {

//@audit `computeCreate2Address` is not in CamelCase
101:     function computeCreate2Address(


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/L2ContractHelper.sol#L90-L90) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/L2ContractHelper.sol#L101-L101)


```solidity

File: contracts/SystemContractsCaller.sol

//@audit `safeCastToU32` is not in CamelCase
27:     function safeCastToU32(uint256 _x) internal pure returns (uint32) {

//@audit `systemCall` is not in CamelCase
37:     function systemCall(uint32 gasLimit, address to, uint256 value, bytes memory data) internal returns (bool success) {

//@audit `systemCallWithReturndata` is not in CamelCase
76:     function systemCallWithReturndata(

//@audit `getFarCallABI` is not in CamelCase
95:     function getFarCallABI(

//@audit `getFarCallABIWithEmptyFatPointer` is not in CamelCase
121:     function getFarCallABIWithEmptyFatPointer(


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/SystemContractsCaller.sol#L27-L27) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/SystemContractsCaller.sol#L37-L37), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/SystemContractsCaller.sol#L76-L76), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/SystemContractsCaller.sol#L95-L95), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/SystemContractsCaller.sol#L121-L121)


</details>


### [NC&#x2011;99] `pure` function accesses storage 
While the compiler currently flags functions like these as being `pure`, this is a [bug](https://github.com/ethereum/solidity/issues/11573) which will be fixed in a future version, so it's best to not use `pure` visibility, in order to not break when this bug is fixed.


*There are 1 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/state-transition/libraries/Diamond.sol

87:     function getDiamondStorage() internal pure returns (DiamondStorage storage diamondStorage) {
88:         bytes32 position = DIAMOND_STORAGE_POSITION;
89:         assembly {
90:             diamondStorage.slot := position
91:         }
92:     }


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L87-L92) 


</details>


### [NC&#x2011;100] Assembly block creates dirty bits 
Writing data to the free memory pointer without later updating the free memory pointer will cause there to be dirty bits at that memory location. Not updating the free memory pointer will make it [harder](https://docs.soliditylang.org/en/latest/ir-breaking-changes.html#cleanup) for the optimizer to reason about whether the memory needs to be cleaned, which may lead to worse optimizations. Annotate the block with `assembly ("memory-safe") { ... }` if the memory's value can be discarded. If the memory needs to be saved, update the free memory pointer in addtion to using the annotation. See [this](https://docs.soliditylang.org/en/latest/assembly.html#memory-safety) link for other cases where the annotation can be used


*There are 5 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/DefaultAccount.sol

168:         assembly {
169:             r := mload(add(_signature, 0x20))
170:             s := mload(add(_signature, 0x40))
171:             v := and(mload(add(_signature, 0x41)), 0xff)
172:         }


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/DefaultAccount.sol#L168-L172) 


```solidity

File: contracts/common/libraries/UnsafeBytes.sol

20:         assembly {
21:             offset := add(_start, 4)
22:             result := mload(add(_bytes, offset))
23:         }

27:         assembly {
28:             offset := add(_start, 20)
29:             result := mload(add(_bytes, offset))
30:         }

34:         assembly {
35:             offset := add(_start, 32)
36:             result := mload(add(_bytes, offset))
37:         }

41:         assembly {
42:             offset := add(_start, 32)
43:             result := mload(add(_bytes, offset))
44:         }


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/UnsafeBytes.sol#L20-L23) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/UnsafeBytes.sol#L27-L30), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/UnsafeBytes.sol#L34-L37), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/UnsafeBytes.sol#L41-L44)


</details>


### [NC&#x2011;101] Add inline comments for unnamed parameters 
`function func(address a, address)` -> `function func(address a, address /* b */)`


*There are 51 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/Compressor.sol

//@audit parameter number 1 starting from left need inline comment
110:     function verifyCompressedStateDiffs(


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Compressor.sol#L110-L110) 


```solidity

File: contracts/ContractDeployer.sol

//@audit parameter number 0 starting from left need inline comment
74:     function updateNonceOrdering(AccountNonceOrdering _nonceOrdering) external onlySystemCall {

//@audit parameter number 0 starting from left need inline comment
182:     function createAccount(

//@audit parameter number 0 starting from left need inline comment
258:     function _nonSystemDeployOnAddress(


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L74-L74) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L182-L182), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L258-L258)


```solidity

File: contracts/DefaultAccount.sol

//@audit parameter number 0 starting from left need inline comment
67:     function validateTransaction(

//@audit parameter number 0 starting from left need inline comment
//@audit parameter number 1 starting from left need inline comment
112:     function executeTransaction(

//@audit parameter number 0 starting from left need inline comment
//@audit parameter number 1 starting from left need inline comment
196:     function payForTransaction(

//@audit parameter number 0 starting from left need inline comment
//@audit parameter number 1 starting from left need inline comment
212:     function prepareForPaymaster(


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/DefaultAccount.sol#L67-L67) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/DefaultAccount.sol#L112-L112), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/DefaultAccount.sol#L196-L196), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/DefaultAccount.sol#L212-L212)


```solidity

File: contracts/L2BaseToken.sol

//@audit parameter number 2 starting from left need inline comment
32:     function transferFromTo(address _from, address _to, uint256 _amount) external override {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L2BaseToken.sol#L32-L32) 


```solidity

File: contracts/NonceHolder.sol

//@audit parameter number 0 starting from left need inline comment
65:     function increaseMinNonce(uint256 _value) public onlySystemCall returns (uint256 oldMinNonce) {

//@audit parameter number 1 starting from left need inline comment
82:     function setValueUnderNonce(uint256 _key, uint256 _value) public onlySystemCall {

//@audit parameter number 0 starting from left need inline comment
110:     function incrementMinNonceIfEquals(uint256 _expectedNonce) external onlySystemCall {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/NonceHolder.sol#L65-L65) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/NonceHolder.sol#L82-L82), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/NonceHolder.sol#L110-L110)


```solidity

File: contracts/SystemContext.sol

//@audit parameter number 0 starting from left need inline comment
427:     function _ensureBatchConsistentWithL2Block(uint128 _newTimestamp) internal view {

//@audit parameter number 1 starting from left need inline comment
//@audit parameter number 2 starting from left need inline comment
444:     function setNewBatch(


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L427-L427) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L444-L444)


```solidity

File: contracts/libraries/SystemContractHelper.sol

//@audit parameter number 0 starting from left need inline comment
318:     function getExtraAbiData(uint256 index) internal view returns (uint256 extraAbiData) {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L318-L318) 


```solidity

File: contracts/libraries/Utils.sol

//@audit parameter number 0 starting from left need inline comment
20:     function safeCastToU128(uint256 _x) internal pure returns (uint128) {

//@audit parameter number 0 starting from left need inline comment
26:     function safeCastToU32(uint256 _x) internal pure returns (uint32) {

//@audit parameter number 0 starting from left need inline comment
32:     function safeCastToU24(uint256 _x) internal pure returns (uint24) {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L20-L20) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L26-L26), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L32-L32)


```solidity

File: contracts/interfaces/IBaseToken.sol

//@audit parameter number 0 starting from left need inline comment
6:     function balanceOf(uint256) external view returns (uint256);


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IBaseToken.sol#L6-L6) 


```solidity

File: contracts/bridge/L1ERC20Bridge.sol

//@audit parameter number 1 starting from left need inline comment
63:     function tranferTokenToSharedBridge(address _token, uint256 _amount) external {

//@audit parameter number 2 starting from left need inline comment
133:     function deposit(


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1ERC20Bridge.sol#L63-L63) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1ERC20Bridge.sol#L133-L133)


```solidity

File: contracts/bridge/L1SharedBridge.sol

//@audit parameter number 0 starting from left need inline comment
104:     function initialize(

//@audit parameter number 2 starting from left need inline comment
182:     function bridgehubDeposit(


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L104-L104) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L182-L182)


```solidity

File: contracts/bridgehub/Bridgehub.sol

//@audit parameter number 0 starting from left need inline comment
//@audit parameter number 3 starting from left need inline comment
114:     function createNewChain(


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L114-L114) 


```solidity

File: contracts/governance/Governance.sol

//@audit parameter number 0 starting from left need inline comment
41:     constructor(address _admin, address _securityCouncil, uint256 _minDelay) {

//@audit parameter number 0 starting from left need inline comment
239:     function _checkPredecessorDone(bytes32 _predecessorId) internal view {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/Governance.sol#L41-L41) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/Governance.sol#L239-L239)


```solidity

File: contracts/state-transition/ValidatorTimelock.sol

//@audit parameter number 0 starting from left need inline comment
108:     function commitBatches(

//@audit parameter number 1 starting from left need inline comment
126:     function commitBatchesSharedBridge(

//@audit parameter number 0 starting from left need inline comment
146:     function revertBatches(uint256) external onlyValidator(ERA_CHAIN_ID) {

//@audit parameter number 1 starting from left need inline comment
153:     function revertBatchesSharedBridge(uint256 _chainId, uint256) external onlyValidator(_chainId) {

//@audit parameter number 0 starting from left need inline comment
//@audit parameter number 1 starting from left need inline comment
//@audit parameter number 2 starting from left need inline comment
160:     function proveBatches(

//@audit parameter number 1 starting from left need inline comment
//@audit parameter number 2 starting from left need inline comment
//@audit parameter number 3 starting from left need inline comment
171:     function proveBatchesSharedBridge(


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L108-L108) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L126-L126), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L146-L146), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L153-L153), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L160-L160), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L171-L171)


```solidity

File: contracts/state-transition/chain-deps/DiamondProxy.sol

//@audit parameter number 0 starting from left need inline comment
11:     constructor(uint256 _chainId, Diamond.DiamondCutData memory _diamondCut) {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/DiamondProxy.sol#L11-L11) 


```solidity

File: contracts/state-transition/chain-deps/facets/Admin.sol

//@audit parameter number 0 starting from left need inline comment
58:     function setPriorityTxMaxGasLimit(uint256 _newPriorityTxMaxGasLimit) external onlyStateTransitionManager {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Admin.sol#L58-L58) 


```solidity

File: contracts/state-transition/chain-deps/facets/Executor.sol

//@audit parameter number 1 starting from left need inline comment
//@audit parameter number 2 starting from left need inline comment
103:     function _verifyBatchTimestamp(

//@audit parameter number 0 starting from left need inline comment
207:     function commitBatchesSharedBridge(

//@audit parameter number 1 starting from left need inline comment
321:     function _executeOneBatch(StoredBatchInfo memory _storedBatch, uint256 _executedBatchIdx) internal {

//@audit parameter number 0 starting from left need inline comment
337:     function executeBatchesSharedBridge(

//@audit parameter number 0 starting from left need inline comment
377:     function proveBatchesSharedBridge(

//@audit parameter number 0 starting from left need inline comment
477:     function revertBatchesSharedBridge(uint256, uint256 _newLastBatch) external nonReentrant onlyValidator {

//@audit parameter number 0 starting from left need inline comment
481:     function _revertBatches(uint256 _newLastBatch) internal {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L103-L103) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L207-L207), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L321-L321), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L337-L337), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L377-L377), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L477-L477), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L481-L481)


```solidity

File: contracts/state-transition/chain-deps/facets/Mailbox.sol

//@audit parameter number 0 starting from left need inline comment
104:     function _proveL2LogInclusion(


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L104-L104) 


```solidity

File: contracts/upgrades/BaseZkSyncUpgrade.sol

//@audit parameter number 0 starting from left need inline comment
236:     function _setNewProtocolVersion(uint256 _newProtocolVersion) internal virtual {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgrade.sol#L236-L236) 


```solidity

File: contracts/upgrades/BaseZkSyncUpgradeGenesis.sol

//@audit parameter number 0 starting from left need inline comment
20:     function _setNewProtocolVersion(uint256 _newProtocolVersion) internal override {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L20-L20) 


```solidity

File: contracts/state-transition/libraries/Diamond.sol

//@audit parameter number 0 starting from left need inline comment
172:     function _removeFunctions(address _facet, bytes4[] memory _selectors) private {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L172-L172) 


```solidity

File: contracts/state-transition/libraries/TransactionValidator.sol

//@audit parameter number 2 starting from left need inline comment
//@audit parameter number 3 starting from left need inline comment
19:     function validateL1ToL2Transaction(

//@audit parameter number 0 starting from left need inline comment
109:     function getTransactionBodyGasLimit(


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/TransactionValidator.sol#L19-L19) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/TransactionValidator.sol#L109-L109)


```solidity

File: contracts/bridge/L2SharedBridge.sol

//@audit parameter number 0 starting from left need inline comment
//@audit parameter number 2 starting from left need inline comment
//@audit parameter number 3 starting from left need inline comment
49:     function initialize(

//@audit parameter number 2 starting from left need inline comment
123:     function withdraw(address _l1Receiver, address _l2Token, uint256 _amount) external override {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L49-L49) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L123-L123)


```solidity

File: contracts/bridge/L2StandardERC20.sol

//@audit parameter number 0 starting from left need inline comment
50:     function bridgeInitialize(address _l1Address, bytes memory _data) external initializer {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2StandardERC20.sol#L50-L50) 


```solidity

File: contracts/SystemContractsCaller.sol

//@audit parameter number 0 starting from left need inline comment
27:     function safeCastToU32(uint256 _x) internal pure returns (uint32) {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/SystemContractsCaller.sol#L27-L27) 


</details>


### [NC&#x2011;102] Function state mutability can be restricted to pure 



*There are 1 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/bridge/L1ERC20Bridge.sol

60:     function initialize() external reentrancyGuardInitializer {}


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1ERC20Bridge.sol#L60-L60) 


</details>


### [NC&#x2011;103] Use the latest Solidity version for better security 
Using the latest solidity version will help avoid old compiler related vulnerabilities


*There are 104 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/AccountCodeStorage.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/AccountCodeStorage.sol#L3-L3) 


```solidity

File: contracts/BootloaderUtilities.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L3-L3) 


```solidity

File: contracts/ComplexUpgrader.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ComplexUpgrader.sol#L3-L3) 


```solidity

File: contracts/Compressor.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Compressor.sol#L3-L3) 


```solidity

File: contracts/Constants.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Constants.sol#L3-L3) 


```solidity

File: contracts/ContractDeployer.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L3-L3) 


```solidity

File: contracts/DefaultAccount.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/DefaultAccount.sol#L3-L3) 


```solidity

File: contracts/EmptyContract.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/EmptyContract.sol#L3-L3) 


```solidity

File: contracts/ImmutableSimulator.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ImmutableSimulator.sol#L3-L3) 


```solidity

File: contracts/KnownCodesStorage.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/KnownCodesStorage.sol#L3-L3) 


```solidity

File: contracts/L1Messenger.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L3-L3) 


```solidity

File: contracts/L2BaseToken.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L2BaseToken.sol#L3-L3) 


```solidity

File: contracts/MsgValueSimulator.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/MsgValueSimulator.sol#L3-L3) 


```solidity

File: contracts/NonceHolder.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/NonceHolder.sol#L3-L3) 


```solidity

File: contracts/PubdataChunkPublisher.sol

2: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/PubdataChunkPublisher.sol#L2-L2) 


```solidity

File: contracts/SystemContext.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L3-L3) 


```solidity

File: contracts/libraries/EfficientCall.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L3-L3) 


```solidity

File: contracts/libraries/RLPEncoder.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/RLPEncoder.sol#L3-L3) 


```solidity

File: contracts/libraries/SystemContractHelper.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L3-L3) 


```solidity

File: contracts/libraries/SystemContractsCaller.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractsCaller.sol#L3-L3) 


```solidity

File: contracts/libraries/TransactionHelper.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L3-L3) 


```solidity

File: contracts/libraries/UnsafeBytesCalldata.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/UnsafeBytesCalldata.sol#L3-L3) 


```solidity

File: contracts/libraries/Utils.sol

2: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L2-L2) 


```solidity

File: contracts/interfaces/IAccount.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IAccount.sol#L3-L3) 


```solidity

File: contracts/interfaces/IAccountCodeStorage.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IAccountCodeStorage.sol#L3-L3) 


```solidity

File: contracts/interfaces/IBaseToken.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IBaseToken.sol#L3-L3) 


```solidity

File: contracts/interfaces/IBootloaderUtilities.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IBootloaderUtilities.sol#L3-L3) 


```solidity

File: contracts/interfaces/IComplexUpgrader.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IComplexUpgrader.sol#L3-L3) 


```solidity

File: contracts/interfaces/ICompressor.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ICompressor.sol#L3-L3) 


```solidity

File: contracts/interfaces/IContractDeployer.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IContractDeployer.sol#L3-L3) 


```solidity

File: contracts/interfaces/IImmutableSimulator.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IImmutableSimulator.sol#L3-L3) 


```solidity

File: contracts/interfaces/IKnownCodesStorage.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IKnownCodesStorage.sol#L3-L3) 


```solidity

File: contracts/interfaces/IL1Messenger.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IL1Messenger.sol#L3-L3) 


```solidity

File: contracts/interfaces/IL2StandardToken.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IL2StandardToken.sol#L3-L3) 


```solidity

File: contracts/interfaces/IMailbox.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IMailbox.sol#L3-L3) 


```solidity

File: contracts/interfaces/INonceHolder.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/INonceHolder.sol#L3-L3) 


```solidity

File: contracts/interfaces/IPaymaster.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IPaymaster.sol#L3-L3) 


```solidity

File: contracts/interfaces/IPaymasterFlow.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IPaymasterFlow.sol#L3-L3) 


```solidity

File: contracts/interfaces/IPubdataChunkPublisher.sol

2: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IPubdataChunkPublisher.sol#L2-L2) 


```solidity

File: contracts/interfaces/ISystemContext.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ISystemContext.sol#L3-L3) 


```solidity

File: contracts/interfaces/ISystemContextDeprecated.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ISystemContextDeprecated.sol#L3-L3) 


```solidity

File: contracts/interfaces/ISystemContract.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ISystemContract.sol#L3-L3) 


```solidity

File: contracts/bridge/L1ERC20Bridge.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1ERC20Bridge.sol#L3-L3) 


```solidity

File: contracts/bridge/L1SharedBridge.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L3-L3) 


```solidity

File: contracts/bridgehub/Bridgehub.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L3-L3) 


```solidity

File: contracts/governance/Governance.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/Governance.sol#L3-L3) 


```solidity

File: contracts/state-transition/StateTransitionManager.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L3-L3) 


```solidity

File: contracts/state-transition/ValidatorTimelock.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L3-L3) 


```solidity

File: contracts/state-transition/chain-deps/DiamondInit.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/DiamondInit.sol#L3-L3) 


```solidity

File: contracts/state-transition/chain-deps/DiamondProxy.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/DiamondProxy.sol#L3-L3) 


```solidity

File: contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L3-L3) 


```solidity

File: contracts/state-transition/chain-deps/facets/Admin.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Admin.sol#L3-L3) 


```solidity

File: contracts/state-transition/chain-deps/facets/Executor.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L3-L3) 


```solidity

File: contracts/state-transition/chain-deps/facets/Getters.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L3-L3) 


```solidity

File: contracts/state-transition/chain-deps/facets/Mailbox.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L3-L3) 


```solidity

File: contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L3-L3) 


```solidity

File: contracts/upgrades/BaseZkSyncUpgrade.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgrade.sol#L3-L3) 


```solidity

File: contracts/upgrades/BaseZkSyncUpgradeGenesis.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L3-L3) 


```solidity

File: contracts/upgrades/DefaultUpgrade.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/DefaultUpgrade.sol#L3-L3) 


```solidity

File: contracts/upgrades/GenesisUpgrade.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/GenesisUpgrade.sol#L3-L3) 


```solidity

File: contracts/common/libraries/L2ContractHelper.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/L2ContractHelper.sol#L3-L3) 


```solidity

File: contracts/common/libraries/UncheckedMath.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/UncheckedMath.sol#L3-L3) 


```solidity

File: contracts/common/libraries/UnsafeBytes.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/UnsafeBytes.sol#L3-L3) 


```solidity

File: contracts/state-transition/libraries/Diamond.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L3-L3) 


```solidity

File: contracts/state-transition/libraries/LibMap.sol

2: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/LibMap.sol#L2-L2) 


```solidity

File: contracts/state-transition/libraries/Merkle.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Merkle.sol#L3-L3) 


```solidity

File: contracts/state-transition/libraries/PriorityQueue.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/PriorityQueue.sol#L3-L3) 


```solidity

File: contracts/state-transition/libraries/TransactionValidator.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/TransactionValidator.sol#L3-L3) 


```solidity

File: contracts/bridge/interfaces/IL1ERC20Bridge.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1ERC20Bridge.sol#L3-L3) 


```solidity

File: contracts/bridge/interfaces/IL1SharedBridge.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L3-L3) 


```solidity

File: contracts/bridge/interfaces/IL2Bridge.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL2Bridge.sol#L3-L3) 


```solidity

File: contracts/bridge/interfaces/IWETH9.sol

2: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IWETH9.sol#L2-L2) 


```solidity

File: contracts/bridgehub/IBridgehub.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L3-L3) 


```solidity

File: contracts/common/interfaces/IL2ContractDeployer.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/interfaces/IL2ContractDeployer.sol#L3-L3) 


```solidity

File: contracts/governance/IGovernance.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/IGovernance.sol#L3-L3) 


```solidity

File: contracts/state-transition/IStateTransitionManager.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/IStateTransitionManager.sol#L3-L3) 


```solidity

File: contracts/state-transition/chain-interfaces/IAdmin.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IAdmin.sol#L3-L3) 


```solidity

File: contracts/state-transition/chain-interfaces/IDiamondInit.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IDiamondInit.sol#L3-L3) 


```solidity

File: contracts/state-transition/chain-interfaces/IExecutor.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IExecutor.sol#L3-L3) 


```solidity

File: contracts/state-transition/chain-interfaces/IGetters.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IGetters.sol#L3-L3) 


```solidity

File: contracts/state-transition/chain-interfaces/ILegacyGetters.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/ILegacyGetters.sol#L3-L3) 


```solidity

File: contracts/state-transition/chain-interfaces/IMailbox.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IMailbox.sol#L3-L3) 


```solidity

File: contracts/state-transition/chain-interfaces/IVerifier.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IVerifier.sol#L3-L3) 


```solidity

File: contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol#L3-L3) 


```solidity

File: contracts/state-transition/chain-interfaces/IZkSyncStateTransitionBase.sol

2: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IZkSyncStateTransitionBase.sol#L2-L2) 


```solidity

File: contracts/state-transition/l2-deps/ISystemContext.sol

2: pragma solidity ^0.8.0;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/l2-deps/ISystemContext.sol#L2-L2) 


```solidity

File: contracts/upgrades/IDefaultUpgrade.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/IDefaultUpgrade.sol#L3-L3) 


```solidity

File: contracts/common/Config.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/Config.sol#L3-L3) 


```solidity

File: contracts/common/L2ContractAddresses.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/L2ContractAddresses.sol#L3-L3) 


```solidity

File: contracts/common/Messaging.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/Messaging.sol#L3-L3) 


```solidity

File: contracts/common/ReentrancyGuard.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/ReentrancyGuard.sol#L3-L3) 


```solidity

File: contracts/vendor/AddressAliasHelper.sol

19: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/vendor/AddressAliasHelper.sol#L19-L19) 


```solidity

File: contracts/bridge/L2SharedBridge.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L3-L3) 


```solidity

File: contracts/bridge/L2StandardERC20.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2StandardERC20.sol#L3-L3) 


```solidity

File: contracts/bridge/interfaces/IL1ERC20Bridge.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL1ERC20Bridge.sol#L3-L3) 


```solidity

File: contracts/bridge/interfaces/IL1SharedBridge.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL1SharedBridge.sol#L3-L3) 


```solidity

File: contracts/bridge/interfaces/IL2SharedBridge.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL2SharedBridge.sol#L3-L3) 


```solidity

File: contracts/bridge/interfaces/IL2StandardToken.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL2StandardToken.sol#L3-L3) 


```solidity

File: contracts/interfaces/IPaymaster.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/interfaces/IPaymaster.sol#L3-L3) 


```solidity

File: contracts/interfaces/IPaymasterFlow.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/interfaces/IPaymasterFlow.sol#L3-L3) 


```solidity

File: contracts/vendor/AddressAliasHelper.sol

19: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/vendor/AddressAliasHelper.sol#L19-L19) 


```solidity

File: contracts/ForceDeployUpgrader.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/ForceDeployUpgrader.sol#L3-L3) 


```solidity

File: contracts/L2ContractHelper.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/L2ContractHelper.sol#L3-L3) 


```solidity

File: contracts/SystemContractsCaller.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/SystemContractsCaller.sol#L3-L3) 


</details>


### [NC&#x2011;104] Consider adding formal verification proofs 
Consider using formal verification to mathematically prove that your code does what is intended, and does not have any edge cases with unexpected behavior. The solidity compiler itself has this functionality [built in](https://docs.soliditylang.org/en/latest/smtchecker.html#smtchecker-and-formal-verification)


*There are 3 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/AccountCodeStorage.sol

@audit Should implement invariant tests
1: 


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/AccountCodeStorage.sol#L1-L1) 


```solidity

File: contracts/bridge/L1ERC20Bridge.sol

@audit Should implement invariant tests
1: 


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1ERC20Bridge.sol#L1-L1) 


```solidity

File: contracts/bridge/L2SharedBridge.sol

@audit Should implement invariant tests
1: 


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L1-L1) 


</details>


### [NC&#x2011;105] Missing zero address check in functions with address parameters 
Adding a zero address check for each address type parameter can prevent errors.


*There are 17 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/ContractDeployer.sol

//@audit _address,  are not checked
34:     function getAccountInfo(address _address) external view returns (AccountInfo memory info) {

//@audit _address,  are not checked
58:     function _storeAccountInfo(address _address, AccountInfo memory _newInfo) internal {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L34-L34) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L58-L58)


```solidity

File: contracts/SystemContext.sol

//@audit _newOrigin,  are not checked
99:     function setTxOrigin(address _newOrigin) external onlyCallFromBootloader {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L99-L99) 


```solidity

File: contracts/libraries/EfficientCall.sol

//@audit _address,  are not checked
124:     function rawCall(
125:         uint256 _gas,
126:         address _address,
127:         uint256 _value,
128:         bytes calldata _data,
129:         bool _isSystem
130:     ) internal returns (bool success) {

//@audit _address,  are not checked
159:     function rawStaticCall(uint256 _gas, address _address, bytes calldata _data) internal view returns (bool success) {

//@audit _address,  are not checked
173:     function rawDelegateCall(uint256 _gas, address _address, bytes calldata _data) internal returns (bool success) {

//@audit _address, _whoToMimic,  are not checked
191:     function rawMimicCall(
192:         uint256 _gas,
193:         address _address,
194:         bytes calldata _data,
195:         address _whoToMimic,
196:         bool _isConstructor,
197:         bool _isSystem
198:     ) internal returns (bool success) {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L124-L130) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L159-L159), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L173-L173), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L191-L198)


```solidity

File: contracts/libraries/SystemContractsCaller.sol

//@audit to,  are not checked
76:     function systemCall(uint32 gasLimit, address to, uint256 value, bytes memory data) internal returns (bool success) {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractsCaller.sol#L76-L76) 


```solidity

File: contracts/bridge/L1SharedBridge.sol

//@audit _l1WethAddress,  are not checked
90:     constructor(
91:         address _l1WethAddress,
92:         IBridgehub _bridgehub,
93:         IL1ERC20Bridge _legacyBridge
94:     ) reentrancyGuardInitializer {

//@audit _l2BridgeAddress,  are not checked
142:     function initializeChainGovernance(uint256 _chainId, address _l2BridgeAddress) external onlyOwner {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L90-L94) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L142-L142)


```solidity

File: contracts/state-transition/StateTransitionManager.sol

//@audit _bridgehub,  are not checked
58:     constructor(address _bridgehub) reentrancyGuardInitializer {

//@audit _validatorTimelock,  are not checked
132:     function setValidatorTimelock(address _validatorTimelock) external onlyOwnerOrAdmin {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L58-L58) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L132-L132)


```solidity

File: contracts/state-transition/chain-deps/facets/Getters.sol

//@audit _address,  are not checked
112:     function isValidator(address _address) external view returns (bool) {

//@audit _facet,  are not checked
163:     function isFacetFreezable(address _facet) external view returns (bool isFreezable) {

//@audit _facet,  are not checked
217:     function facetFunctionSelectors(address _facet) external view returns (bytes4[] memory) {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L112-L112) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L163-L163), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L217-L217)


```solidity

File: contracts/state-transition/libraries/Diamond.sol

//@audit _facet,  are not checked
257:     function _removeFacet(address _facet) private {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L257-L257) 


```solidity

File: contracts/SystemContractsCaller.sol

//@audit to,  are not checked
37:     function systemCall(uint32 gasLimit, address to, uint256 value, bytes memory data) internal returns (bool success) {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/SystemContractsCaller.sol#L37-L37) 


</details>


### [NC&#x2011;106] Use a struct to encapsulate multiple function parameters 
If a function has too many parameters, replacing them with a struct can improve code readability and maintainability, increase reusability, and reduce the likelihood of errors when passing the parameters.


*There are 55 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/ContractDeployer.sol

321:     function _constructContract(
322:         address _sender,
323:         address _newAddress,
324:         bytes32 _bytecodeHash,
325:         bytes calldata _input,
326:         bool _isSystem,
327:         bool _callConstructor
328:     ) internal {
329:         uint256 value = msg.value;
330:         if (_callConstructor) {
331:             // 1. Transfer the balance to the new address on the constructor call.
332:             if (value > 0) {
333:                 BASE_TOKEN_SYSTEM_CONTRACT.transferFromTo(address(this), _newAddress, value);
334:             }
335:             // 2. Set the constructed code hash on the account
336:             _storeConstructingByteCodeHashOnAddress(_newAddress, _bytecodeHash);
337: 
338:             // 3. Call the constructor on behalf of the account
339:             if (value > 0) {
340:                 // Safe to cast value, because `msg.value` <= `uint128.max` due to `MessageValueSimulator` invariant
341:                 SystemContractHelper.setValueForNextFarCall(uint128(value));
342:             }
343:             bytes memory returnData = EfficientCall.mimicCall(gasleft(), _newAddress, _input, _sender, true, _isSystem);
344:             // 4. Mark bytecode hash as constructed
345:             ACCOUNT_CODE_STORAGE_SYSTEM_CONTRACT.markAccountCodeHashAsConstructed(_newAddress);
346:             // 5. Set the contract immutables
347:             ImmutableData[] memory immutables = abi.decode(returnData, (ImmutableData[]));
348:             IMMUTABLE_SIMULATOR_SYSTEM_CONTRACT.setImmutables(_newAddress, immutables);
349:         } else {
350:             require(value == 0, "The value must be zero if we do not call the constructor");
351:             // If we do not call the constructor, we need to set the constructed code hash.
352:             ACCOUNT_CODE_STORAGE_SYSTEM_CONTRACT.storeAccountConstructedCodeHash(_newAddress, _bytecodeHash);
353:         }
354: 
355:         emit ContractDeployed(_sender, _bytecodeHash, _newAddress);
356:     }


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L321-L356) 


```solidity

File: contracts/SystemContext.sol

341:     function setL2Block(
342:         uint128 _l2BlockNumber,
343:         uint128 _l2BlockTimestamp,
344:         bytes32 _expectedPrevL2BlockHash,
345:         bool _isFirstInBatch,
346:         uint128 _maxVirtualBlocksToCreate
347:     ) external onlyCallFromBootloader {
348:         // We check that the timestamp of the L2 block is consistent with the timestamp of the batch.
349:         if (_isFirstInBatch) {
350:             uint128 currentBatchTimestamp = currentBatchInfo.timestamp;
351:             require(
352:                 _l2BlockTimestamp >= currentBatchTimestamp,
353:                 "The timestamp of the L2 block must be greater than or equal to the timestamp of the current batch"
354:             );
355:             require(_maxVirtualBlocksToCreate > 0, "There must be a virtual block created at the start of the batch");
356:         }
357: 
358:         (uint128 currentL2BlockNumber, uint128 currentL2BlockTimestamp) = getL2BlockNumberAndTimestamp();
359: 
360:         if (currentL2BlockNumber == 0 && currentL2BlockTimestamp == 0) {
361:             // Since currentL2BlockNumber and currentL2BlockTimestamp are zero it means that it is
362:             // the first ever batch with L2 blocks, so we need to initialize those.
363:             _upgradeL2Blocks(_l2BlockNumber, _expectedPrevL2BlockHash, _isFirstInBatch);
364: 
365:             _setNewL2BlockData(_l2BlockNumber, _l2BlockTimestamp, _expectedPrevL2BlockHash);
366:         } else if (currentL2BlockNumber == _l2BlockNumber) {
367:             require(!_isFirstInBatch, "Can not reuse L2 block number from the previous batch");
368:             require(currentL2BlockTimestamp == _l2BlockTimestamp, "The timestamp of the same L2 block must be same");
369:             require(
370:                 _expectedPrevL2BlockHash == _getLatest257L2blockHash(_l2BlockNumber - 1),
371:                 "The previous hash of the same L2 block must be same"
372:             );
373:             require(_maxVirtualBlocksToCreate == 0, "Can not create virtual blocks in the middle of the miniblock");
374:         } else if (currentL2BlockNumber + 1 == _l2BlockNumber) {
375:             // From the checks in _upgradeL2Blocks it is known that currentL2BlockNumber can not be 0
376:             bytes32 prevL2BlockHash = _getLatest257L2blockHash(currentL2BlockNumber - 1);
377: 
378:             bytes32 pendingL2BlockHash = _calculateL2BlockHash(
379:                 currentL2BlockNumber,
380:                 currentL2BlockTimestamp,
381:                 prevL2BlockHash,
382:                 currentL2BlockTxsRollingHash
383:             );
384: 
385:             require(_expectedPrevL2BlockHash == pendingL2BlockHash, "The current L2 block hash is incorrect");
386:             require(
387:                 _l2BlockTimestamp > currentL2BlockTimestamp,
388:                 "The timestamp of the new L2 block must be greater than the timestamp of the previous L2 block"
389:             );
390: 
391:             // Since the new block is created, we'll clear out the rolling hash
392:             _setNewL2BlockData(_l2BlockNumber, _l2BlockTimestamp, _expectedPrevL2BlockHash);
393:         } else {
394:             revert("Invalid new L2 block number");
395:         }
396: 
397:         _setVirtualBlock(_l2BlockNumber, _maxVirtualBlocksToCreate, _l2BlockTimestamp);
398:     }


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L341-L398) 


```solidity

File: contracts/libraries/EfficientCall.sol

58:     function call(
59:         uint256 _gas,
60:         address _address,
61:         uint256 _value,
62:         bytes calldata _data,
63:         bool _isSystem
64:     ) internal returns (bytes memory returnData) {
65:         bool success = rawCall(_gas, _address, _value, _data, _isSystem);
66:         returnData = _verifyCallResult(success);
67:     }

105:     function mimicCall(
106:         uint256 _gas,
107:         address _address,
108:         bytes calldata _data,
109:         address _whoToMimic,
110:         bool _isConstructor,
111:         bool _isSystem
112:     ) internal returns (bytes memory returnData) {
113:         bool success = rawMimicCall(_gas, _address, _data, _whoToMimic, _isConstructor, _isSystem);
114:         returnData = _verifyCallResult(success);
115:     }

124:     function rawCall(
125:         uint256 _gas,
126:         address _address,
127:         uint256 _value,
128:         bytes calldata _data,
129:         bool _isSystem
130:     ) internal returns (bool success) {
131:         if (_value == 0) {
132:             _loadFarCallABIIntoActivePtr(_gas, _data, false, _isSystem);
133: 
134:             address callAddr = RAW_FAR_CALL_BY_REF_CALL_ADDRESS;
135:             assembly {
136:                 success := call(_address, callAddr, 0, 0, 0xFFFF, 0, 0)
137:             }
138:         } else {
139:             _loadFarCallABIIntoActivePtr(_gas, _data, false, true);
140: 
141:             // If there is provided `msg.value` call the `MsgValueSimulator` to forward ether.
142:             address msgValueSimulator = MSG_VALUE_SYSTEM_CONTRACT;
143:             address callAddr = SYSTEM_CALL_BY_REF_CALL_ADDRESS;
144:             // We need to supply the mask to the MsgValueSimulator to denote
145:             // that the call should be a system one.
146:             uint256 forwardMask = _isSystem ? MSG_VALUE_SIMULATOR_IS_SYSTEM_BIT : 0;
147: 
148:             assembly {
149:                 success := call(msgValueSimulator, callAddr, _value, _address, 0xFFFF, forwardMask, 0)
150:             }
151:         }
152:     }

191:     function rawMimicCall(
192:         uint256 _gas,
193:         address _address,
194:         bytes calldata _data,
195:         address _whoToMimic,
196:         bool _isConstructor,
197:         bool _isSystem
198:     ) internal returns (bool success) {
199:         _loadFarCallABIIntoActivePtr(_gas, _data, _isConstructor, _isSystem);
200: 
201:         address callAddr = MIMIC_CALL_BY_REF_CALL_ADDRESS;
202:         uint256 cleanupMask = ADDRESS_MASK;
203:         assembly {
204:             // Clearing values before usage in assembly, since Solidity
205:             // doesn't do it by default
206:             _whoToMimic := and(_whoToMimic, cleanupMask)
207: 
208:             success := call(_address, callAddr, 0, 0, _whoToMimic, 0, 0)
209:         }
210:     }


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L58-L67) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L105-L115), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L124-L152), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L191-L210)


```solidity

File: contracts/libraries/SystemContractHelper.sol

124:     function packPrecompileParams(
125:         uint32 _inputMemoryOffset,
126:         uint32 _inputMemoryLength,
127:         uint32 _outputMemoryOffset,
128:         uint32 _outputMemoryLength,
129:         uint64 _perPrecompileInterpreted
130:     ) internal pure returns (uint256 rawParams) {
131:         rawParams = _inputMemoryOffset;
132:         rawParams |= uint256(_inputMemoryLength) << 32;
133:         rawParams |= uint256(_outputMemoryOffset) << 64;
134:         rawParams |= uint256(_outputMemoryLength) << 96;
135:         rawParams |= uint256(_perPrecompileInterpreted) << 192;
136:     }


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L124-L136) 


```solidity

File: contracts/libraries/SystemContractsCaller.sol

214:     function getFarCallABI(
215:         uint32 dataOffset,
216:         uint32 memoryPage,
217:         uint32 dataStart,
218:         uint32 dataLength,
219:         uint32 gasPassed,
220:         uint8 shardId,
221:         CalldataForwardingMode forwardingMode,
222:         bool isConstructorCall,
223:         bool isSystemCall
224:     ) internal pure returns (uint256 farCallAbi) {
225:         // Fill in the call parameter fields
226:         farCallAbi = getFarCallABIWithEmptyFatPointer(
227:             gasPassed,
228:             shardId,
229:             forwardingMode,
230:             isConstructorCall,
231:             isSystemCall
232:         );
233:         // Fill in the fat pointer fields
234:         farCallAbi |= dataOffset;
235:         farCallAbi |= (uint256(memoryPage) << 32);
236:         farCallAbi |= (uint256(dataStart) << 64);
237:         farCallAbi |= (uint256(dataLength) << 96);
238:     }

250:     function getFarCallABIWithEmptyFatPointer(
251:         uint32 gasPassed,
252:         uint8 shardId,
253:         CalldataForwardingMode forwardingMode,
254:         bool isConstructorCall,
255:         bool isSystemCall
256:     ) internal pure returns (uint256 farCallAbiWithEmptyFatPtr) {
257:         farCallAbiWithEmptyFatPtr |= (uint256(gasPassed) << 192);
258:         farCallAbiWithEmptyFatPtr |= (uint256(forwardingMode) << 224);
259:         farCallAbiWithEmptyFatPtr |= (uint256(shardId) << 232);
260:         if (isConstructorCall) {
261:             farCallAbiWithEmptyFatPtr |= (1 << 240);
262:         }
263:         if (isSystemCall) {
264:             farCallAbiWithEmptyFatPtr |= (1 << 248);
265:         }
266:     }


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractsCaller.sol#L214-L238) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractsCaller.sol#L250-L266)


```solidity

File: contracts/interfaces/IMailbox.sol

06:     function finalizeEthWithdrawal(
07:         uint256 _l2BatchNumber,
08:         uint256 _l2MessageIndex,
09:         uint16 _l2TxNumberInBlock,
10:         bytes calldata _message,
11:         bytes32[] calldata _merkleProof
12:     ) external;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IMailbox.sol#L6-L12) 


```solidity

File: contracts/interfaces/IPaymaster.sol

43:     function postTransaction(
44:         bytes calldata _context,
45:         Transaction calldata _transaction,
46:         bytes32 _txHash,
47:         bytes32 _suggestedSignedHash,
48:         ExecutionResult _txResult,
49:         uint256 _maxRefundedGas
50:     ) external payable;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IPaymaster.sol#L43-L50) 


```solidity

File: contracts/bridge/L1ERC20Bridge.sol

098:     function deposit(
099:         address _l2Receiver,
100:         address _l1Token,
101:         uint256 _amount,
102:         uint256 _l2TxGasLimit,
103:         uint256 _l2TxGasPerPubdataByte
104:     ) external payable returns (bytes32 l2TxHash) {
105:         l2TxHash = deposit(_l2Receiver, _l1Token, _amount, _l2TxGasLimit, _l2TxGasPerPubdataByte, address(0));
106:     }

133:     function deposit(
134:         address _l2Receiver,
135:         address _l1Token,
136:         uint256 _amount,
137:         uint256 _l2TxGasLimit,
138:         uint256 _l2TxGasPerPubdataByte,
139:         address _refundRecipient
140:     ) public payable nonReentrant returns (bytes32 l2TxHash) {
141:         require(_amount != 0, "0T"); // empty deposit
142:         uint256 amount = _depositFundsToSharedBridge(msg.sender, IERC20(_l1Token), _amount);
143:         require(amount == _amount, "3T"); // The token has non-standard transfer logic
144: 
145:         l2TxHash = sharedBridge.depositLegacyErc20Bridge{value: msg.value}(
146:             msg.sender,
147:             _l2Receiver,
148:             _l1Token,
149:             _amount,
150:             _l2TxGasLimit,
151:             _l2TxGasPerPubdataByte,
152:             _refundRecipient
153:         );
154:         depositAmount[msg.sender][_l1Token][l2TxHash] = _amount;
155:         emit DepositInitiated(l2TxHash, msg.sender, _l2Receiver, _l1Token, _amount);
156:     }

176:     function claimFailedDeposit(
177:         address _depositSender,
178:         address _l1Token,
179:         bytes32 _l2TxHash,
180:         uint256 _l2BatchNumber,
181:         uint256 _l2MessageIndex,
182:         uint16 _l2TxNumberInBatch,
183:         bytes32[] calldata _merkleProof
184:     ) external nonReentrant {
185:         uint256 amount = depositAmount[_depositSender][_l1Token][_l2TxHash];
186:         require(amount != 0, "2T"); // empty deposit
187:         delete depositAmount[_depositSender][_l1Token][_l2TxHash];
188: 
189:         sharedBridge.claimFailedDepositLegacyErc20Bridge(
190:             _depositSender,
191:             _l1Token,
192:             amount,
193:             _l2TxHash,
194:             _l2BatchNumber,
195:             _l2MessageIndex,
196:             _l2TxNumberInBatch,
197:             _merkleProof
198:         );
199:         emit ClaimedFailedDeposit(_depositSender, _l1Token, amount);
200:     }

208:     function finalizeWithdrawal(
209:         uint256 _l2BatchNumber,
210:         uint256 _l2MessageIndex,
211:         uint16 _l2TxNumberInBatch,
212:         bytes calldata _message,
213:         bytes32[] calldata _merkleProof
214:     ) external nonReentrant {
215:         require(!isWithdrawalFinalized[_l2BatchNumber][_l2MessageIndex], "pw");
216:         // We don't need to set finalizeWithdrawal here, as we set it in the shared bridge
217: 
218:         (address l1Receiver, address l1Token, uint256 amount) = sharedBridge.finalizeWithdrawalLegacyErc20Bridge(
219:             _l2BatchNumber,
220:             _l2MessageIndex,
221:             _l2TxNumberInBatch,
222:             _message,
223:             _merkleProof
224:         );
225:         emit WithdrawalFinalized(l1Receiver, l1Token, amount);
226:     }


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1ERC20Bridge.sol#L98-L106) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1ERC20Bridge.sol#L133-L156), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1ERC20Bridge.sol#L176-L200), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1ERC20Bridge.sol#L208-L226)


```solidity

File: contracts/bridge/L1SharedBridge.sol

277:     function claimFailedDeposit(
278:         uint256 _chainId,
279:         address _depositSender,
280:         address _l1Token,
281:         uint256 _amount,
282:         bytes32 _l2TxHash,
283:         uint256 _l2BatchNumber,
284:         uint256 _l2MessageIndex,
285:         uint16 _l2TxNumberInBatch,
286:         bytes32[] calldata _merkleProof
287:     ) external override {
288:         _claimFailedDeposit(
289:             false,
290:             _chainId,
291:             _depositSender,
292:             _l1Token,
293:             _amount,
294:             _l2TxHash,
295:             _l2BatchNumber,
296:             _l2MessageIndex,
297:             _l2TxNumberInBatch,
298:             _merkleProof
299:         );
300:     }

303:     function _claimFailedDeposit(
304:         bool _checkedInLegacyBridge,
305:         uint256 _chainId,
306:         address _depositSender,
307:         address _l1Token,
308:         uint256 _amount,
309:         bytes32 _l2TxHash,
310:         uint256 _l2BatchNumber,
311:         uint256 _l2MessageIndex,
312:         uint16 _l2TxNumberInBatch,
313:         bytes32[] calldata _merkleProof
314:     ) internal nonReentrant {
315:         {
316:             bool proofValid = bridgehub.proveL1ToL2TransactionStatus(
317:                 _chainId,
318:                 _l2TxHash,
319:                 _l2BatchNumber,
320:                 _l2MessageIndex,
321:                 _l2TxNumberInBatch,
322:                 _merkleProof,
323:                 TxStatus.Failure
324:             );
325:             require(proofValid, "yn");
326:         }
327:         require(_amount > 0, "y1");
328: 
329:         {
330:             bool notCheckedInLegacyBridgeOrWeCanCheckDeposit;
331:             {
332:                 // Deposits that happened before the upgrade cannot be checked here, they have to be claimed and checked in the legacyBridge
333:                 bool weCanCheckDepositHere = !_isEraLegacyWithdrawal(_chainId, _l2BatchNumber);
334:                 // Double claims are not possible, as we this check except for legacy bridge withdrawals
335:                 // Funds claimed before the update will still be recorded in the legacy bridge
336:                 // Note we double check NEW deposits if they are called from the legacy bridge
337:                 notCheckedInLegacyBridgeOrWeCanCheckDeposit = (!_checkedInLegacyBridge) || weCanCheckDepositHere;
338:             }
339:             if (notCheckedInLegacyBridgeOrWeCanCheckDeposit) {
340:                 bytes32 dataHash = depositHappened[_chainId][_l2TxHash];
341:                 bytes32 txDataHash = keccak256(abi.encode(_depositSender, _l1Token, _amount));
342:                 require(dataHash == txDataHash, "ShB: d.it not hap");
343:                 delete depositHappened[_chainId][_l2TxHash];
344:             }
345:         }
346: 
347:         if (!hyperbridgingEnabled[_chainId]) {
348:             // check that the chain has sufficient balance
349:             require(chainBalance[_chainId][_l1Token] >= _amount, "ShB n funds");
350:             chainBalance[_chainId][_l1Token] -= _amount;
351:         }
352: 
353:         // Withdraw funds
354:         if (_l1Token == ETH_TOKEN_ADDRESS) {
355:             bool callSuccess;
356:             // Low-level assembly call, to avoid any memory copying (save gas)
357:             assembly {
358:                 callSuccess := call(gas(), _depositSender, _amount, 0, 0, 0, 0)
359:             }
360:             require(callSuccess, "ShB: claimFailedDeposit failed");
361:         } else {
362:             IERC20(_l1Token).safeTransfer(_depositSender, _amount);
363:             // Note we don't allow weth deposits anymore, but there might be legacy weth deposits.
364:             // until we add Weth bridging capabilities, we don't wrap/unwrap weth to ether.
365:         }
366: 
367:         emit ClaimedFailedDepositSharedBridge(_chainId, _depositSender, _l1Token, _amount);
368:     }

385:     function finalizeWithdrawal(
386:         uint256 _chainId,
387:         uint256 _l2BatchNumber,
388:         uint256 _l2MessageIndex,
389:         uint16 _l2TxNumberInBatch,
390:         bytes calldata _message,
391:         bytes32[] calldata _merkleProof
392:     ) external override {
393:         // To avoid rewithdrawing txs that have already happened on the legacy bridge.
394:         // Note: new withdraws are all recorded here, so double withdrawing them is not possible.
395:         if (_isEraLegacyWithdrawal(_chainId, _l2BatchNumber)) {
396:             require(!legacyBridge.isWithdrawalFinalized(_l2BatchNumber, _l2MessageIndex), "ShB: legacy withdrawal");
397:         }
398:         _finalizeWithdrawal(_chainId, _l2BatchNumber, _l2MessageIndex, _l2TxNumberInBatch, _message, _merkleProof);
399:     }

409:     function _finalizeWithdrawal(
410:         uint256 _chainId,
411:         uint256 _l2BatchNumber,
412:         uint256 _l2MessageIndex,
413:         uint16 _l2TxNumberInBatch,
414:         bytes calldata _message,
415:         bytes32[] calldata _merkleProof
416:     ) internal nonReentrant returns (address l1Receiver, address l1Token, uint256 amount) {
417:         require(!isWithdrawalFinalized[_chainId][_l2BatchNumber][_l2MessageIndex], "Withdrawal is already finalized");
418:         isWithdrawalFinalized[_chainId][_l2BatchNumber][_l2MessageIndex] = true;
419: 
420:         // Handling special case for withdrawal from zkSync Era initiated before Shared Bridge.
421:         if (_isEraLegacyWithdrawal(_chainId, _l2BatchNumber)) {
422:             // Checks that the withdrawal wasn't finalized already.
423:             bool alreadyFinalized = IGetters(ERA_DIAMOND_PROXY).isEthWithdrawalFinalized(
424:                 _l2BatchNumber,
425:                 _l2MessageIndex
426:             );
427:             require(!alreadyFinalized, "Withdrawal is already finalized 2");
428:         }
429: 
430:         MessageParams memory messageParams = MessageParams({
431:             l2BatchNumber: _l2BatchNumber,
432:             l2MessageIndex: _l2MessageIndex,
433:             l2TxNumberInBatch: _l2TxNumberInBatch
434:         });
435:         (l1Receiver, l1Token, amount) = _checkWithdrawal(_chainId, messageParams, _message, _merkleProof);
436: 
437:         if (!hyperbridgingEnabled[_chainId]) {
438:             // Check that the chain has sufficient balance
439:             require(chainBalance[_chainId][l1Token] >= amount, "ShB not enough funds 2"); // not enought funds
440:             chainBalance[_chainId][l1Token] -= amount;
441:         }
442: 
443:         if (l1Token == ETH_TOKEN_ADDRESS) {
444:             bool callSuccess;
445:             // Low-level assembly call, to avoid any memory copying (save gas)
446:             assembly {
447:                 callSuccess := call(gas(), l1Receiver, amount, 0, 0, 0, 0)
448:             }
449:             require(callSuccess, "ShB: withdraw failed");
450:         } else {
451:             // Withdraw funds
452:             IERC20(l1Token).safeTransfer(l1Receiver, amount);
453:         }
454:         emit WithdrawalFinalizedSharedBridge(_chainId, l1Receiver, l1Token, amount);
455:     }

554:     function depositLegacyErc20Bridge(
555:         address _prevMsgSender,
556:         address _l2Receiver,
557:         address _l1Token,
558:         uint256 _amount,
559:         uint256 _l2TxGasLimit,
560:         uint256 _l2TxGasPerPubdataByte,
561:         address _refundRecipient
562:     ) external payable override onlyLegacyBridge nonReentrant returns (bytes32 l2TxHash) {
563:         require(l2BridgeAddress[ERA_CHAIN_ID] != address(0), "ShB b. n dep");
564:         require(_l1Token != l1WethAddress, "ShB: WETH deposit not supported 2");
565: 
566:         // Note that funds have been transferred to this contract in the legacy ERC20 bridge.
567:         if (!hyperbridgingEnabled[ERA_CHAIN_ID]) {
568:             chainBalance[ERA_CHAIN_ID][_l1Token] += _amount;
569:         }
570: 
571:         bytes memory l2TxCalldata = _getDepositL2Calldata(_prevMsgSender, _l2Receiver, _l1Token, _amount);
572: 
573:         {
574:             // If the refund recipient is not specified, the refund will be sent to the sender of the transaction.
575:             // Otherwise, the refund will be sent to the specified address.
576:             // If the recipient is a contract on L1, the address alias will be applied.
577:             address refundRecipient = _refundRecipient;
578:             if (_refundRecipient == address(0)) {
579:                 refundRecipient = _prevMsgSender != tx.origin
580:                     ? AddressAliasHelper.applyL1ToL2Alias(_prevMsgSender)
581:                     : _prevMsgSender;
582:             }
583: 
584:             L2TransactionRequestDirect memory request = L2TransactionRequestDirect({
585:                 chainId: ERA_CHAIN_ID,
586:                 l2Contract: l2BridgeAddress[ERA_CHAIN_ID],
587:                 mintValue: msg.value, // l2 gas + l2 msg.Value the bridgehub will withdraw the mintValue from the base token bridge for gas
588:                 l2Value: 0, // L2 msg.value, this contract doesn't support base token deposits or wrapping functionality, for direct deposits use bridgehub
589:                 l2Calldata: l2TxCalldata,
590:                 l2GasLimit: _l2TxGasLimit,
591:                 l2GasPerPubdataByteLimit: _l2TxGasPerPubdataByte,
592:                 factoryDeps: new bytes[](0),
593:                 refundRecipient: refundRecipient
594:             });
595:             l2TxHash = bridgehub.requestL2TransactionDirect{value: msg.value}(request);
596:         }
597: 
598:         bytes32 txDataHash = keccak256(abi.encode(_prevMsgSender, _l1Token, _amount));
599:         // Save the deposited amount to claim funds on L1 if the deposit failed on L2
600:         depositHappened[ERA_CHAIN_ID][l2TxHash] = txDataHash;
601: 
602:         emit LegacyDepositInitiated(ERA_CHAIN_ID, l2TxHash, _prevMsgSender, _l2Receiver, _l1Token, _amount);
603:     }

615:     function finalizeWithdrawalLegacyErc20Bridge(
616:         uint256 _l2BatchNumber,
617:         uint256 _l2MessageIndex,
618:         uint16 _l2TxNumberInBatch,
619:         bytes calldata _message,
620:         bytes32[] calldata _merkleProof
621:     ) external override onlyLegacyBridge returns (address l1Receiver, address l1Token, uint256 amount) {
622:         (l1Receiver, l1Token, amount) = _finalizeWithdrawal(
623:             ERA_CHAIN_ID,
624:             _l2BatchNumber,
625:             _l2MessageIndex,
626:             _l2TxNumberInBatch,
627:             _message,
628:             _merkleProof
629:         );
630:     }

644:     function claimFailedDepositLegacyErc20Bridge(
645:         address _depositSender,
646:         address _l1Token,
647:         uint256 _amount,
648:         bytes32 _l2TxHash,
649:         uint256 _l2BatchNumber,
650:         uint256 _l2MessageIndex,
651:         uint16 _l2TxNumberInBatch,
652:         bytes32[] calldata _merkleProof
653:     ) external override onlyLegacyBridge {
654:         _claimFailedDeposit(
655:             true,
656:             ERA_CHAIN_ID,
657:             _depositSender,
658:             _l1Token,
659:             _amount,
660:             _l2TxHash,
661:             _l2BatchNumber,
662:             _l2MessageIndex,
663:             _l2TxNumberInBatch,
664:             _merkleProof
665:         );
666:     }


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L277-L300) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L303-L368), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L385-L399), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L409-L455), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L554-L603), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L615-L630), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L644-L666)


```solidity

File: contracts/bridgehub/Bridgehub.sol

114:     function createNewChain(
115:         uint256 _chainId,
116:         address _stateTransitionManager,
117:         address _baseToken,
118:         uint256, //_salt
119:         address _admin,
120:         bytes calldata _initData
121:     ) external onlyOwnerOrAdmin nonReentrant returns (uint256 chainId) {
122:         require(_chainId != 0, "Bridgehub: chainId cannot be 0");
123:         require(_chainId <= type(uint48).max, "Bridgehub: chainId too large");
124: 
125:         require(
126:             stateTransitionManagerIsRegistered[_stateTransitionManager],
127:             "Bridgehub: state transition not registered"
128:         );
129:         require(tokenIsRegistered[_baseToken], "Bridgehub: token not registered");
130:         require(address(sharedBridge) != address(0), "Bridgehub: weth bridge not set");
131: 
132:         require(stateTransitionManager[_chainId] == address(0), "Bridgehub: chainId already registered");
133: 
134:         stateTransitionManager[_chainId] = _stateTransitionManager;
135:         baseToken[_chainId] = _baseToken;
136: 
137:         IStateTransitionManager(_stateTransitionManager).createNewChain(
138:             _chainId,
139:             _baseToken,
140:             address(sharedBridge),
141:             _admin,
142:             _initData
143:         );
144: 
145:         emit NewChain(_chainId, _stateTransitionManager, _admin);
146:         return _chainId;
147:     }

152:     function proveL2MessageInclusion(
153:         uint256 _chainId,
154:         uint256 _batchNumber,
155:         uint256 _index,
156:         L2Message calldata _message,
157:         bytes32[] calldata _proof
158:     ) external view override returns (bool) {
159:         address stateTransition = getStateTransition(_chainId);
160:         return IZkSyncStateTransition(stateTransition).proveL2MessageInclusion(_batchNumber, _index, _message, _proof);
161:     }

164:     function proveL2LogInclusion(
165:         uint256 _chainId,
166:         uint256 _batchNumber,
167:         uint256 _index,
168:         L2Log memory _log,
169:         bytes32[] calldata _proof
170:     ) external view override returns (bool) {
171:         address stateTransition = getStateTransition(_chainId);
172:         return IZkSyncStateTransition(stateTransition).proveL2LogInclusion(_batchNumber, _index, _log, _proof);
173:     }

176:     function proveL1ToL2TransactionStatus(
177:         uint256 _chainId,
178:         bytes32 _l2TxHash,
179:         uint256 _l2BatchNumber,
180:         uint256 _l2MessageIndex,
181:         uint16 _l2TxNumberInBatch,
182:         bytes32[] calldata _merkleProof,
183:         TxStatus _status
184:     ) external view override returns (bool) {
185:         address stateTransition = getStateTransition(_chainId);
186:         return
187:             IZkSyncStateTransition(stateTransition).proveL1ToL2TransactionStatus(
188:                 _l2TxHash,
189:                 _l2BatchNumber,
190:                 _l2MessageIndex,
191:                 _l2TxNumberInBatch,
192:                 _merkleProof,
193:                 _status
194:             );
195:     }


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L114-L147) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L152-L161), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L164-L173), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L176-L195)


```solidity

File: contracts/state-transition/StateTransitionManager.sol

239:     function createNewChain(
240:         uint256 _chainId,
241:         address _baseToken,
242:         address _sharedBridge,
243:         address _admin,
244:         bytes calldata _diamondCut
245:     ) external onlyBridgehub {
246:         if (stateTransition[_chainId] != address(0)) {
247:             // StateTransition chain already registered
248:             return;
249:         }
250: 
251:         // check not registered
252:         Diamond.DiamondCutData memory diamondCut = abi.decode(_diamondCut, (Diamond.DiamondCutData));
253: 
254:         // check input
255:         bytes32 cutHashInput = keccak256(_diamondCut);
256:         require(cutHashInput == initialCutHash, "StateTransition: initial cutHash mismatch");
257: 
258:         // construct init data
259:         bytes memory initData;
260:         /// all together 4+9*32=292 bytes
261:         initData = bytes.concat(
262:             IDiamondInit.initialize.selector,
263:             bytes32(_chainId),
264:             bytes32(uint256(uint160(bridgehub))),
265:             bytes32(uint256(uint160(address(this)))),
266:             bytes32(uint256(protocolVersion)),
267:             bytes32(uint256(uint160(_admin))),
268:             bytes32(uint256(uint160(validatorTimelock))),
269:             bytes32(uint256(uint160(_baseToken))),
270:             bytes32(uint256(uint160(_sharedBridge))),
271:             bytes32(storedBatchZero),
272:             diamondCut.initCalldata
273:         );
274: 
275:         diamondCut.initCalldata = initData;
276:         // deploy stateTransitionContract
277:         DiamondProxy stateTransitionContract = new DiamondProxy{salt: bytes32(0)}(block.chainid, diamondCut);
278: 
279:         // save data
280:         address stateTransitionAddress = address(stateTransitionContract);
281: 
282:         stateTransition[_chainId] = stateTransitionAddress;
283: 
284:         // set chainId in VM
285:         _setChainIdUpgrade(_chainId, stateTransitionAddress);
286: 
287:         emit StateTransitionNewChain(_chainId, stateTransitionAddress);
288:     }


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L239-L288) 


```solidity

File: contracts/state-transition/chain-deps/facets/Mailbox.sol

074:     function proveL1ToL2TransactionStatus(
075:         bytes32 _l2TxHash,
076:         uint256 _l2BatchNumber,
077:         uint256 _l2MessageIndex,
078:         uint16 _l2TxNumberInBatch,
079:         bytes32[] calldata _merkleProof,
080:         TxStatus _status
081:     ) public view returns (bool) {
082:         // Bootloader sends an L2 -> L1 log only after processing the L1 -> L2 transaction.
083:         // Thus, we can verify that the L1 -> L2 transaction was included in the L2 batch with specified status.
084:         //
085:         // The semantics of such L2 -> L1 log is always:
086:         // - sender = L2_BOOTLOADER_ADDRESS
087:         // - key = hash(L1ToL2Transaction)
088:         // - value = status of the processing transaction (1 - success & 0 - fail)
089:         // - isService = true (just a conventional value)
090:         // - l2ShardId = 0 (means that L1 -> L2 transaction was processed in a rollup shard, other shards are not available yet anyway)
091:         // - txNumberInBatch = number of transaction in the batch
092:         L2Log memory l2Log = L2Log({
093:             l2ShardId: 0,
094:             isService: true,
095:             txNumberInBatch: _l2TxNumberInBatch,
096:             sender: L2_BOOTLOADER_ADDRESS,
097:             key: _l2TxHash,
098:             value: bytes32(uint256(_status))
099:         });
100:         return _proveL2LogInclusion(_l2BatchNumber, _l2MessageIndex, l2Log, _merkleProof);
101:     }

178:     function finalizeEthWithdrawal(
179:         uint256 _l2BatchNumber,
180:         uint256 _l2MessageIndex,
181:         uint16 _l2TxNumberInBatch,
182:         bytes calldata _message,
183:         bytes32[] calldata _merkleProof
184:     ) external nonReentrant {
185:         require(s.chainId == ERA_CHAIN_ID, "finalizeEthWithdrawal only available for Era on mailbox");
186:         IL1SharedBridge(s.baseTokenBridge).finalizeWithdrawal(
187:             ERA_CHAIN_ID,
188:             _l2BatchNumber,
189:             _l2MessageIndex,
190:             _l2TxNumberInBatch,
191:             _message,
192:             _merkleProof
193:         );
194:     }

197:     function requestL2Transaction(
198:         address _contractL2,
199:         uint256 _l2Value,
200:         bytes calldata _calldata,
201:         uint256 _l2GasLimit,
202:         uint256 _l2GasPerPubdataByteLimit,
203:         bytes[] calldata _factoryDeps,
204:         address _refundRecipient
205:     ) external payable returns (bytes32 canonicalTxHash) {
206:         require(s.chainId == ERA_CHAIN_ID, "legacy interface only available for era token");
207:         canonicalTxHash = _requestL2TransactionSender(
208:             BridgehubL2TransactionRequest({
209:                 sender: msg.sender,
210:                 contractL2: _contractL2,
211:                 mintValue: msg.value,
212:                 l2Value: _l2Value,
213:                 l2GasLimit: _l2GasLimit,
214:                 l2Calldata: _calldata,
215:                 l2GasPerPubdataByteLimit: _l2GasPerPubdataByteLimit,
216:                 factoryDeps: _factoryDeps,
217:                 refundRecipient: _refundRecipient
218:             })
219:         );
220:         IL1SharedBridge(s.baseTokenBridge).bridgehubDepositBaseToken{value: msg.value}(
221:             s.chainId,
222:             msg.sender,
223:             ETH_TOKEN_ADDRESS,
224:             msg.value
225:         );
226:     }


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L74-L101) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L178-L194), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L197-L226)


```solidity

File: contracts/bridge/interfaces/IL1ERC20Bridge.sol

26:     function deposit(
27:         address _l2Receiver,
28:         address _l1Token,
29:         uint256 _amount,
30:         uint256 _l2TxGasLimit,
31:         uint256 _l2TxGasPerPubdataByte,
32:         address _refundRecipient
33:     ) external payable returns (bytes32 txHash);

35:     function deposit(
36:         address _l2Receiver,
37:         address _l1Token,
38:         uint256 _amount,
39:         uint256 _l2TxGasLimit,
40:         uint256 _l2TxGasPerPubdataByte
41:     ) external payable returns (bytes32 txHash);

43:     function claimFailedDeposit(
44:         address _depositSender,
45:         address _l1Token,
46:         bytes32 _l2TxHash,
47:         uint256 _l2BatchNumber,
48:         uint256 _l2MessageIndex,
49:         uint16 _l2TxNumberInBatch,
50:         bytes32[] calldata _merkleProof
51:     ) external;

53:     function finalizeWithdrawal(
54:         uint256 _l2BatchNumber,
55:         uint256 _l2MessageIndex,
56:         uint16 _l2TxNumberInBatch,
57:         bytes calldata _message,
58:         bytes32[] calldata _merkleProof
59:     ) external;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1ERC20Bridge.sol#L26-L33) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1ERC20Bridge.sol#L35-L41), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1ERC20Bridge.sol#L43-L51), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1ERC20Bridge.sol#L53-L59)


```solidity

File: contracts/bridge/interfaces/IL1SharedBridge.sol

64:     function depositLegacyErc20Bridge(
65:         address _msgSender,
66:         address _l2Receiver,
67:         address _l1Token,
68:         uint256 _amount,
69:         uint256 _l2TxGasLimit,
70:         uint256 _l2TxGasPerPubdataByte,
71:         address _refundRecipient
72:     ) external payable returns (bytes32 txHash);

74:     function claimFailedDepositLegacyErc20Bridge(
75:         address _depositSender,
76:         address _l1Token,
77:         uint256 _amount,
78:         bytes32 _l2TxHash,
79:         uint256 _l2BatchNumber,
80:         uint256 _l2MessageIndex,
81:         uint16 _l2TxNumberInBatch,
82:         bytes32[] calldata _merkleProof
83:     ) external;

85:     function claimFailedDeposit(
86:         uint256 _chainId,
87:         address _depositSender,
88:         address _l1Token,
89:         uint256 _amount,
90:         bytes32 _l2TxHash,
91:         uint256 _l2BatchNumber,
92:         uint256 _l2MessageIndex,
93:         uint16 _l2TxNumberInBatch,
94:         bytes32[] calldata _merkleProof
95:     ) external;

097:     function finalizeWithdrawalLegacyErc20Bridge(
098:         uint256 _l2BatchNumber,
099:         uint256 _l2MessageIndex,
100:         uint16 _l2TxNumberInBatch,
101:         bytes calldata _message,
102:         bytes32[] calldata _merkleProof
103:     ) external returns (address l1Receiver, address l1Token, uint256 amount);

105:     function finalizeWithdrawal(
106:         uint256 _chainId,
107:         uint256 _l2BatchNumber,
108:         uint256 _l2MessageIndex,
109:         uint16 _l2TxNumberInBatch,
110:         bytes calldata _message,
111:         bytes32[] calldata _merkleProof
112:     ) external;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L64-L72) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L74-L83), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L85-L95), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L97-L103), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L105-L112)


```solidity

File: contracts/bridge/interfaces/IL2Bridge.sol

07:     function finalizeDeposit(
08:         address _l1Sender,
09:         address _l2Receiver,
10:         address _l1Token,
11:         uint256 _amount,
12:         bytes calldata _data
13:     ) external payable;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL2Bridge.sol#L7-L13) 


```solidity

File: contracts/bridgehub/IBridgehub.sol

73:     function proveL2MessageInclusion(
74:         uint256 _chainId,
75:         uint256 _batchNumber,
76:         uint256 _index,
77:         L2Message calldata _message,
78:         bytes32[] calldata _proof
79:     ) external view returns (bool);

81:     function proveL2LogInclusion(
82:         uint256 _chainId,
83:         uint256 _batchNumber,
84:         uint256 _index,
85:         L2Log memory _log,
86:         bytes32[] calldata _proof
87:     ) external view returns (bool);

89:     function proveL1ToL2TransactionStatus(
90:         uint256 _chainId,
91:         bytes32 _l2TxHash,
92:         uint256 _l2BatchNumber,
93:         uint256 _l2MessageIndex,
94:         uint16 _l2TxNumberInBatch,
95:         bytes32[] calldata _merkleProof,
96:         TxStatus _status
97:     ) external view returns (bool);

116:     function createNewChain(
117:         uint256 _chainId,
118:         address _stateTransitionManager,
119:         address _baseToken,
120:         uint256 _salt,
121:         address _admin,
122:         bytes calldata _initData
123:     ) external returns (uint256 chainId);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L73-L79) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L81-L87), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L89-L97), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L116-L123)


```solidity

File: contracts/state-transition/IStateTransitionManager.sol

74:     function createNewChain(
75:         uint256 _chainId,
76:         address _baseToken,
77:         address _sharedBridge,
78:         address _admin,
79:         bytes calldata _diamondCut
80:     ) external;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/IStateTransitionManager.sol#L74-L80) 


```solidity

File: contracts/state-transition/chain-interfaces/IMailbox.sol

47:     function proveL1ToL2TransactionStatus(
48:         bytes32 _l2TxHash,
49:         uint256 _l2BatchNumber,
50:         uint256 _l2MessageIndex,
51:         uint16 _l2TxNumberInBatch,
52:         bytes32[] calldata _merkleProof,
53:         TxStatus _status
54:     ) external view returns (bool);

62:     function finalizeEthWithdrawal(
63:         uint256 _l2BatchNumber,
64:         uint256 _l2MessageIndex,
65:         uint16 _l2TxNumberInBatch,
66:         bytes calldata _message,
67:         bytes32[] calldata _merkleProof
68:     ) external;

88:     function requestL2Transaction(
89:         address _contractL2,
90:         uint256 _l2Value,
91:         bytes calldata _calldata,
92:         uint256 _l2GasLimit,
93:         uint256 _l2GasPerPubdataByteLimit,
94:         bytes[] calldata _factoryDeps,
95:         address _refundRecipient
96:     ) external payable returns (bytes32 canonicalTxHash);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IMailbox.sol#L47-L54) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IMailbox.sol#L62-L68), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IMailbox.sol#L88-L96)


```solidity

File: contracts/bridge/L2SharedBridge.sol

079:     function finalizeDeposit(
080:         address _l1Sender,
081:         address _l2Receiver,
082:         address _l1Token,
083:         uint256 _amount,
084:         bytes calldata _data
085:     ) external payable override {
086:         // Only the L1 bridge counterpart can initiate and finalize the deposit.
087:         require(
088:             AddressAliasHelper.undoL1ToL2Alias(msg.sender) == l1Bridge ||
089:                 AddressAliasHelper.undoL1ToL2Alias(msg.sender) == l1LegacyBridge,
090:             "mq"
091:         );
092:         require(msg.value == 0, "Value should be 0 for ERC20 bridge");
093: 
094:         address expectedL2Token = l2TokenAddress(_l1Token);
095:         address currentL1Token = l1TokenAddress[expectedL2Token];
096:         if (currentL1Token == address(0)) {
097:             address deployedToken = _deployL2Token(_l1Token, _data);
098:             require(deployedToken == expectedL2Token, "mt");
099:             l1TokenAddress[expectedL2Token] = _l1Token;
100:         } else {
101:             require(currentL1Token == _l1Token, "gg"); // Double check that the expected value equal to real one
102:         }
103: 
104:         IL2StandardToken(expectedL2Token).bridgeMint(_l2Receiver, _amount);
105:         emit FinalizeDeposit(_l1Sender, _l2Receiver, expectedL2Token, _amount);
106:     }


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L79-L106) 


```solidity

File: contracts/bridge/interfaces/IL1ERC20Bridge.sol

09:     function finalizeWithdrawal(
10:         uint256 _l2BatchNumber,
11:         uint256 _l2MessageIndex,
12:         uint16 _l2TxNumberInBatch,
13:         bytes calldata _message,
14:         bytes32[] calldata _merkleProof
15:     ) external;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL1ERC20Bridge.sol#L9-L15) 


```solidity

File: contracts/bridge/interfaces/IL1SharedBridge.sol

09:     function finalizeWithdrawal(
10:         uint256 _chainId,
11:         uint256 _l2BatchNumber,
12:         uint256 _l2MessageIndex,
13:         uint16 _l2TxNumberInBatch,
14:         bytes calldata _message,
15:         bytes32[] calldata _merkleProof
16:     ) external;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL1SharedBridge.sol#L9-L16) 


```solidity

File: contracts/bridge/interfaces/IL2SharedBridge.sol

24:     function finalizeDeposit(
25:         address _l1Sender,
26:         address _l2Receiver,
27:         address _l1Token,
28:         uint256 _amount,
29:         bytes calldata _data
30:     ) external payable;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL2SharedBridge.sol#L24-L30) 


```solidity

File: contracts/interfaces/IPaymaster.sol

43:     function postTransaction(
44:         bytes calldata _context,
45:         Transaction calldata _transaction,
46:         bytes32 _txHash,
47:         bytes32 _suggestedSignedHash,
48:         ExecutionResult _txResult,
49:         uint256 _maxRefundedGas
50:     ) external payable;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/interfaces/IPaymaster.sol#L43-L50) 


```solidity

File: contracts/SystemContractsCaller.sol

095:     function getFarCallABI(
096:         uint32 dataOffset,
097:         uint32 memoryPage,
098:         uint32 dataStart,
099:         uint32 dataLength,
100:         uint32 gasPassed,
101:         uint8 shardId,
102:         CalldataForwardingMode forwardingMode,
103:         bool isConstructorCall,
104:         bool isSystemCall
105:     ) internal pure returns (uint256 farCallAbi) {
106:         // Fill in the call parameter fields
107:         farCallAbi = getFarCallABIWithEmptyFatPointer(
108:             gasPassed,
109:             shardId,
110:             forwardingMode,
111:             isConstructorCall,
112:             isSystemCall
113:         );
114:         // Fill in the fat pointer fields
115:         farCallAbi |= dataOffset;
116:         farCallAbi |= (uint256(memoryPage) << 32);
117:         farCallAbi |= (uint256(dataStart) << 64);
118:         farCallAbi |= (uint256(dataLength) << 96);
119:     }

121:     function getFarCallABIWithEmptyFatPointer(
122:         uint32 gasPassed,
123:         uint8 shardId,
124:         CalldataForwardingMode forwardingMode,
125:         bool isConstructorCall,
126:         bool isSystemCall
127:     ) internal pure returns (uint256 farCallAbiWithEmptyFatPtr) {
128:         farCallAbiWithEmptyFatPtr |= (uint256(gasPassed) << 192);
129:         farCallAbiWithEmptyFatPtr |= (uint256(forwardingMode) << 224);
130:         farCallAbiWithEmptyFatPtr |= (uint256(shardId) << 232);
131:         if (isConstructorCall) {
132:             farCallAbiWithEmptyFatPtr |= (1 << 240);
133:         }
134:         if (isSystemCall) {
135:             farCallAbiWithEmptyFatPtr |= (1 << 248);
136:         }
137:     }


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/SystemContractsCaller.sol#L95-L119) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/SystemContractsCaller.sol#L121-L137)


</details>


### [NC&#x2011;107] Do not cache `constants` 



*There are 1 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/state-transition/libraries/Diamond.sol

88:         bytes32 position = DIAMOND_STORAGE_POSITION;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L88-L88) 


</details>


### [NC&#x2011;108] Function state mutability can be restricted to `view` 
 


*There are 1 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/bridge/L1ERC20Bridge.sol

60:     function initialize() external reentrancyGuardInitializer {}


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1ERC20Bridge.sol#L60-L60) 


</details>


### [NC&#x2011;109] Do not cache `immutable` 



*There are 1 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/state-transition/libraries/Diamond.sol

88:         bytes32 position = DIAMOND_STORAGE_POSITION;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L88-L88) 


</details>


### [NC&#x2011;110] Use custom errors rather than `revert()`/`require()` strings for better readability 
Custom errors are available from solidity version 0.8.4. Custom errors are more easily processed in try-catch blocks, and are easier to re-use and maintain.


*There are 324 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/AccountCodeStorage.sol

26:         require(msg.sender == address(DEPLOYER_SYSTEM_CONTRACT), "Callable only by the deployer system contract");

37:         require(Utils.isContractConstructing(_hash), "Code hash is not for a contract on constructor");

48:         require(Utils.isContractConstructed(_hash), "Code hash is not for a constructed contract");

57:         require(Utils.isContractConstructing(codeHash), "Code hash is not for a contract on constructor");


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/AccountCodeStorage.sol#L26-L26) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/AccountCodeStorage.sol#L37-L37), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/AccountCodeStorage.sol#L48-L48), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/AccountCodeStorage.sol#L57-L57)


```solidity

File: contracts/BootloaderUtilities.sol

92:             require(vInt == 27 || vInt == 28, "Invalid v value");

191:             require(vInt == 27 || vInt == 28, "Invalid v value");

286:             require(vInt == 27 || vInt == 28, "Invalid v value");


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L92-L92) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L191-L191), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L286-L286)


```solidity

File: contracts/ComplexUpgrader.sol

22:         require(msg.sender == FORCE_DEPLOYER, "Can only be called by FORCE_DEPLOYER");

24:         require(_delegateTo.code.length > 0, "Delegatee is an EOA");


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ComplexUpgrader.sol#L22-L22) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ComplexUpgrader.sol#L24-L24)


```solidity

File: contracts/Compressor.sol

119:         require(_enumerationIndexSize <= MAX_ENUMERATION_INDEX_SIZE, "enumeration index size is too large");

156:         require(numInitialWritesProcessed == numberOfInitialWrites, "Incorrect number of initial storage diffs");

187:         require(stateDiffPtr == _compressedStateDiffs.length, "Extra data in _compressedStateDiffs");

51:             require(
52:                 encodedData.length * 4 == _bytecode.length,
53:                 "Encoded data length should be 4 times shorter than the original bytecode"
54:             );

56:             require(
57:                 dictionary.length / 8 <= encodedData.length / 2,
58:                 "Dictionary should have at most the same number of entries as the encoded data"
59:             );

140:             require(derivedKey == _compressedStateDiffs.readBytes32(stateDiffPtr), "iw: initial key mismatch");

171:             require(enumIndex == compressedEnumIndex, "rw: enum key mismatch");

63:                 require(indexOfEncodedChunk < dictionary.length, "Encoded chunk index is out of bounds");

68:                 require(encodedChunk == realChunk, "Encoded chunk does not match the original bytecode");

230:                 require(convertedValue == _finalValue, "transform or no compression: compressed and final mismatch");

232:                 require(
233:                     _initialValue + convertedValue == _finalValue,
234:                     "add: initial plus converted not equal to final"
235:                 );

237:                 require(
238:                     _initialValue - convertedValue == _finalValue,
239:                     "sub: initial minus converted not equal to final"
240:                 );


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Compressor.sol#L119-L119) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Compressor.sol#L156-L156), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Compressor.sol#L187-L187), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Compressor.sol#L51-L54), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Compressor.sol#L56-L59), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Compressor.sol#L140-L140), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Compressor.sol#L171-L171), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Compressor.sol#L63-L63), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Compressor.sol#L68-L68), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Compressor.sol#L230-L230), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Compressor.sol#L232-L235), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Compressor.sol#L237-L240)


```solidity

File: contracts/ContractDeployer.sol

29:         require(msg.sender == address(this), "Callable only by self");

77:         require(
78:             _nonceOrdering == AccountNonceOrdering.Arbitrary &&
79:                 currentInfo.nonceOrdering == AccountNonceOrdering.Sequential,
80:             "It is only possible to change from sequential to arbitrary ordering"
81:         );

239:         require(
240:             msg.sender == FORCE_DEPLOYER || msg.sender == address(COMPLEX_UPGRADER_CONTRACT),
241:             "Can only be called by FORCE_DEPLOYER or COMPLEX_UPGRADER_CONTRACT"
242:         );

251:         require(msg.value == sumOfValues, "`value` provided is not equal to the combined `value`s of deployments");

264:         require(_bytecodeHash != bytes32(0x0), "BytecodeHash cannot be zero");

265:         require(uint160(_newAddress) > MAX_SYSTEM_CONTRACT_ADDRESS, "Can not deploy contracts in kernel space");

268:         require(
269:             ACCOUNT_CODE_STORAGE_SYSTEM_CONTRACT.getCodeHash(uint256(uint160(_newAddress))) == 0x0,
270:             "Code hash is non-zero"
271:         );

273:         require(NONCE_HOLDER_SYSTEM_CONTRACT.getRawNonce(_newAddress) == 0x00, "Account is occupied");

303:         require(knownCodeMarker > 0, "The code hash is not known");

350:             require(value == 0, "The value must be zero if we do not call the constructor");


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L29-L29) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L77-L81), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L239-L242), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L251-L251), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L264-L264), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L265-L265), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L268-L271), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L273-L273), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L303-L303), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L350-L350)


```solidity

File: contracts/DefaultAccount.sol

100:         require(totalRequiredBalance <= address(this).balance, "Not enough balance for fee + value");

160:         require(_signature.length == 65, "Signature length is incorrect");

173:         require(v == 27 || v == 28, "v is neither 27 nor 28");

184:         require(uint256(s) <= 0x7FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF5D576E7357A4501DDFE92F46681B20A0, "Invalid s");

202:         require(success, "Failed to pay the fee to the operator");


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/DefaultAccount.sol#L100-L100) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/DefaultAccount.sol#L160-L160), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/DefaultAccount.sol#L173-L173), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/DefaultAccount.sol#L184-L184), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/DefaultAccount.sol#L202-L202)


```solidity

File: contracts/ImmutableSimulator.sol

35:         require(msg.sender == address(DEPLOYER_SYSTEM_CONTRACT), "Callable only by the deployer system contract");


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ImmutableSimulator.sol#L35-L35) 


```solidity

File: contracts/KnownCodesStorage.sol

20:         require(msg.sender == address(COMPRESSOR_CONTRACT), "Callable only by the compressor");

76:         require(version == 1 && _bytecodeHash[1] == bytes1(0), "Incorrectly formatted bytecodeHash");

78:         require(Utils.bytecodeLenInWords(_bytecodeHash) % 2 == 1, "Code length in words must be odd");


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/KnownCodesStorage.sol#L20-L20) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/KnownCodesStorage.sol#L76-L76), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/KnownCodesStorage.sol#L78-L78)


```solidity

File: contracts/L1Messenger.sol

201:         require(numberOfL2ToL1Logs <= L2_TO_L1_LOGS_MERKLE_TREE_LEAVES, "Too many L2->L1 logs");

214:         require(
215:             reconstructedChainedLogsHash == chainedLogsHash,
216:             "reconstructedChainedLogsHash is not equal to chainedLogsHash"
217:         );

245:         require(
246:             reconstructedChainedMessagesHash == chainedMessagesHash,
247:             "reconstructedChainedMessagesHash is not equal to chainedMessagesHash"
248:         );

269:         require(
270:             reconstructedChainedL1BytecodesRevealDataHash == chainedL1BytecodesRevealDataHash,
271:             "reconstructedChainedL1BytecodesRevealDataHash is not equal to chainedL1BytecodesRevealDataHash"
272:         );

279:         require(
280:             uint256(uint8(bytes1(_totalL2ToL1PubdataAndStateDiffs[calldataPtr]))) ==
281:                 STATE_DIFF_COMPRESSION_VERSION_NUMBER,
282:             "state diff compression version mismatch"
283:         );

298:         require(calldataPtr <= MAX_ALLOWED_PUBDATA_PER_BATCH, "L1 Messenger pubdata is too long");

315:         require(calldataPtr == _totalL2ToL1PubdataAndStateDiffs.length, "Extra data in the totalL2ToL1Pubdata array");


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L201-L201) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L214-L217), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L245-L248), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L269-L272), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L279-L283), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L298-L298), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L315-L315)


```solidity

File: contracts/L2BaseToken.sol

33:         require(
34:             msg.sender == MSG_VALUE_SYSTEM_CONTRACT ||
35:                 msg.sender == address(DEPLOYER_SYSTEM_CONTRACT) ||
36:                 msg.sender == BOOTLOADER_FORMAL_ADDRESS,
37:             "Only system contracts with special access can call this method"
38:         );

41:         require(fromBalance >= _amount, "Transfer amount exceeds balance");


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L2BaseToken.sol#L33-L38) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L2BaseToken.sol#L41-L41)


```solidity

File: contracts/MsgValueSimulator.sol

60:         require(to != address(this), "MsgValueSimulator calls itself");


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/MsgValueSimulator.sol#L60-L60) 


```solidity

File: contracts/NonceHolder.sol

66:         require(_value <= MAXIMAL_MIN_NONCE_INCREMENT, "The value for incrementing the nonce is too high");

85:         require(_value != 0, "Nonce value cannot be set to 0");

115:         require(oldMinNonce == _expectedNonce, "Incorrect nonce");

136:         require(
137:             msg.sender == address(DEPLOYER_SYSTEM_CONTRACT),
138:             "Only the contract deployer can increment the deployment nonce"
139:         );

89:             require(isNonceUsed(msg.sender, _key - 1), "Previous nonce has not been used");


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/NonceHolder.sol#L66-L66) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/NonceHolder.sol#L85-L85), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/NonceHolder.sol#L115-L115), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/NonceHolder.sol#L136-L139), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/NonceHolder.sol#L89-L89)


```solidity

File: contracts/PubdataChunkPublisher.sol

22:         require(_pubdata.length <= BLOB_SIZE_BYTES * MAX_NUMBER_OF_BLOBS, "pubdata should fit in 2 blobs");


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/PubdataChunkPublisher.sol#L22-L22) 


```solidity

File: contracts/SystemContext.sol

242:         require(_isFirstInBatch, "Upgrade transaction must be first");

245:         require(_l2BlockNumber > 0, "L2 block number is never expected to be zero");

413:         require(currentBatchNumber > 0, "The current batch number must be greater than 0");

429:         require(
430:             _newTimestamp > currentBlockTimestamp,
431:             "The timestamp of the batch must be greater than the timestamp of the previous block"
432:         );

451:         require(_newTimestamp > previousBatchTimestamp, "Timestamps should be incremental");

452:         require(previousBatchNumber + 1 == _expectedNewNumber, "The provided block number is not correct");

249:             require(correctPrevBlockHash == _expectedPrevL2BlockHash, "The previous L2 block hash is incorrect");

287:             require(_maxVirtualBlocksToCreate > 0, "Can't initialize the first virtual block");

351:             require(
352:                 _l2BlockTimestamp >= currentBatchTimestamp,
353:                 "The timestamp of the L2 block must be greater than or equal to the timestamp of the current batch"
354:             );

355:             require(_maxVirtualBlocksToCreate > 0, "There must be a virtual block created at the start of the batch");

367:             require(!_isFirstInBatch, "Can not reuse L2 block number from the previous batch");

368:             require(currentL2BlockTimestamp == _l2BlockTimestamp, "The timestamp of the same L2 block must be same");

369:             require(
370:                 _expectedPrevL2BlockHash == _getLatest257L2blockHash(_l2BlockNumber - 1),
371:                 "The previous hash of the same L2 block must be same"
372:             );

373:             require(_maxVirtualBlocksToCreate == 0, "Can not create virtual blocks in the middle of the miniblock");

385:             require(_expectedPrevL2BlockHash == pendingL2BlockHash, "The current L2 block hash is incorrect");

386:             require(
387:                 _l2BlockTimestamp > currentL2BlockTimestamp,
388:                 "The timestamp of the new L2 block must be greater than the timestamp of the previous L2 block"
389:             );


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L242-L242) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L245-L245), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L413-L413), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L429-L432), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L451-L451), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L452-L452), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L249-L249), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L287-L287), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L351-L354), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L355-L355), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L367-L367), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L368-L368), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L369-L372), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L373-L373), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L385-L385), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L386-L389)


```solidity

File: contracts/libraries/EfficientCall.sol

38:         require(returnData.length == 32, "keccak256 returned invalid data");

47:         require(returnData.length == 32, "sha returned invalid data");


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L38-L38) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L47-L47)


```solidity

File: contracts/libraries/SystemContractHelper.sol

319:         require(index < 10, "There are only 10 accessible registers");

350:         require(precompileCallSuccess, "Failed to charge gas");


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L319-L319) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L350-L350)


```solidity

File: contracts/libraries/TransactionHelper.sol

363:         require(_transaction.paymasterInput.length >= 4, "The standard paymaster input must be at least 4 bytes long");

367:             require(
368:                 _transaction.paymasterInput.length >= 68,
369:                 "The approvalBased paymaster input must be at least 68 bytes long"
370:             );


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L363-L363) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L367-L370)


```solidity

File: contracts/libraries/Utils.sol

21:         require(_x <= type(uint128).max, "Overflow");

27:         require(_x <= type(uint32).max, "Overflow");

33:         require(_x <= type(uint24).max, "Overflow");

84:         require(_bytecode.length % 32 == 0, "po");

87:         require(lengthInWords < 2 ** 16, "pp"); // bytecode length must be less than 2^16 words

88:         require(lengthInWords % 2 == 1, "pr"); // bytecode length in words must be odd


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L21-L21) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L27-L27), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L33-L33), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L84-L84), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L87-L87), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L88-L88)


```solidity

File: contracts/interfaces/ISystemContract.sol

21:         require(
22:             SystemContractHelper.isSystemCall() || SystemContractHelper.isSystemContract(msg.sender),
23:             "This method require system call flag"
24:         );

31:         require(
32:             SystemContractHelper.isSystemContract(msg.sender),
33:             "This method require the caller to be system contract"
34:         );

41:         require(msg.sender == caller, "Inappropriate caller");

48:         require(msg.sender == BOOTLOADER_FORMAL_ADDRESS, "Callable only by the bootloader");


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ISystemContract.sol#L21-L24) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ISystemContract.sol#L31-L34), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ISystemContract.sol#L41-L41), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ISystemContract.sol#L48-L48)


```solidity

File: contracts/bridge/L1ERC20Bridge.sol

64:         require(msg.sender == address(sharedBridge), "Not shared bridge");

66:         require(amount == _amount, "Incorrect amount");

141:         require(_amount != 0, "0T"); // empty deposit

143:         require(amount == _amount, "3T"); // The token has non-standard transfer logic

186:         require(amount != 0, "2T"); // empty deposit

215:         require(!isWithdrawalFinalized[_l2BatchNumber][_l2MessageIndex], "pw");


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1ERC20Bridge.sol#L64-L64) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1ERC20Bridge.sol#L66-L66), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1ERC20Bridge.sol#L141-L141), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1ERC20Bridge.sol#L143-L143), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1ERC20Bridge.sol#L186-L186), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1ERC20Bridge.sol#L215-L215)


```solidity

File: contracts/bridge/L1SharedBridge.sol

69:         require(msg.sender == address(bridgehub), "ShB not BH");

75:         require(
76:             msg.sender == address(bridgehub) || (_chainId == ERA_CHAIN_ID && msg.sender == ERA_DIAMOND_PROXY),
77:             "L1SharedBridge: not bridgehub or era chain"
78:         );

84:         require(msg.sender == address(legacyBridge), "ShB not legacy bridge");

108:         require(_owner != address(0), "ShB owner 0");

138:         require(bridgehub.getStateTransition(_chainId) == msg.sender, "receiveEth not state transition");

188:         require(l2BridgeAddress[_chainId] != address(0), "ShB l2 bridge not deployed");

194:         require(_l1Token != l1WethAddress, "ShB: WETH deposit not supported");

195:         require(bridgehub.baseToken(_chainId) != _l1Token, "ShB: baseToken deposit not supported");

208:         require(amount != 0, "6T"); // empty deposit amount

237:         require(depositHappened[_chainId][_txHash] == 0x00, "ShB tx hap");

327:         require(_amount > 0, "y1");

417:         require(!isWithdrawalFinalized[_chainId][_l2BatchNumber][_l2MessageIndex], "Withdrawal is already finalized");

484:         require(success, "ShB withd w proof"); // withdrawal wrong proof

501:         require(_l2ToL1message.length >= 56, "ShB wrong msg len"); // wrong messsage length

563:         require(l2BridgeAddress[ERA_CHAIN_ID] != address(0), "ShB b. n dep");

564:         require(_l1Token != l1WethAddress, "ShB: WETH deposit not supported 2");

325:             require(proofValid, "yn");

129:             require(amount > 0, "ShB: 0 amount to transfer");

132:             require(balanceAfter - balanceBefore == amount, "ShB: wrong amount transferred");

121:             require(balanceAfter > balanceBefore, "ShB: 0 eth transferred");

158:             require(msg.value == 0, "ShB m.v > 0 b d.it");

161:             require(amount == _amount, "3T"); // The token has non-standard transfer logic

155:             require(msg.value == _amount, "L1SharedBridge: msg.value not equal to amount");

202:             require(msg.value == 0, "ShB m.v > 0 for BH d.it 2");

206:             require(withdrawAmount == _depositAmount, "5T"); // The token has non-standard transfer logic

200:             require(_depositAmount == 0, "ShB wrong withdraw amount");

349:             require(chainBalance[_chainId][_l1Token] >= _amount, "ShB n funds");

360:             require(callSuccess, "ShB: claimFailedDeposit failed");

396:             require(!legacyBridge.isWithdrawalFinalized(_l2BatchNumber, _l2MessageIndex), "ShB: legacy withdrawal");

427:             require(!alreadyFinalized, "Withdrawal is already finalized 2");

439:             require(chainBalance[_chainId][l1Token] >= amount, "ShB not enough funds 2"); // not enought funds

449:             require(callSuccess, "ShB: withdraw failed");

342:                 require(dataHash == txDataHash, "ShB: d.it not hap");

517:             require(_l2ToL1message.length == 76, "ShB wrong msg len 2");


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L69-L69) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L75-L78), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L84-L84), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L108-L108), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L138-L138), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L188-L188), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L194-L194), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L195-L195), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L208-L208), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L237-L237), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L327-L327), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L417-L417), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L484-L484), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L501-L501), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L563-L563), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L564-L564), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L325-L325), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L129-L129), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L132-L132), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L121-L121), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L158-L158), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L161-L161), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L155-L155), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L202-L202), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L206-L206), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L200-L200), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L349-L349), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L360-L360), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L396-L396), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L427-L427), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L439-L439), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L449-L449), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L342-L342), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L517-L517)


```solidity

File: contracts/bridgehub/Bridgehub.sol

46:         require(msg.sender == admin || msg.sender == owner(), "Bridgehub: not owner or admin");

62:         require(msg.sender == currentPendingAdmin, "n42"); // Only proposed by current admin address can claim the admin rights

83:         require(
84:             !stateTransitionManagerIsRegistered[_stateTransitionManager],
85:             "Bridgehub: state transition already registered"
86:         );

93:         require(
94:             stateTransitionManagerIsRegistered[_stateTransitionManager],
95:             "Bridgehub: state transition not registered yet"
96:         );

102:         require(!tokenIsRegistered[_token], "Bridgehub: token already registered");

122:         require(_chainId != 0, "Bridgehub: chainId cannot be 0");

123:         require(_chainId <= type(uint48).max, "Bridgehub: chainId too large");

125:         require(
126:             stateTransitionManagerIsRegistered[_stateTransitionManager],
127:             "Bridgehub: state transition not registered"
128:         );

129:         require(tokenIsRegistered[_baseToken], "Bridgehub: token not registered");

130:         require(address(sharedBridge) != address(0), "Bridgehub: weth bridge not set");

132:         require(stateTransitionManager[_chainId] == address(0), "Bridgehub: chainId already registered");

296:         require(outputRequest.magicValue == TWO_BRIDGES_MAGIC_VALUE, "Bridgehub: magic value mismatch");

300:         require(
301:             _request.secondBridgeAddress > BRIDGEHUB_MIN_SECOND_BRIDGE_ADDRESS,
302:             "Bridgehub: second bridge address too low"
303:         ); // to avoid calls to precompiles

225:                 require(msg.value == 0, "Bridgehub: non-eth bridge with msg.value");

223:                 require(msg.value == _request.mintValue, "Bridgehub: msg.value mismatch 1");

275:                 require(msg.value == _request.secondBridgeValue, "Bridgehub: msg.value mismatch 3");

269:                 require(
270:                     msg.value == _request.mintValue + _request.secondBridgeValue,
271:                     "Bridgehub: msg.value mismatch 2"
272:                 );


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L46-L46) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L62-L62), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L83-L86), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L93-L96), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L102-L102), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L122-L122), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L123-L123), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L125-L128), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L129-L129), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L130-L130), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L132-L132), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L296-L296), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L300-L303), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L225-L225), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L223-L223), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L275-L275), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L269-L272)


```solidity

File: contracts/governance/Governance.sol

42:         require(_admin != address(0), "Admin should be non zero address");

59:         require(msg.sender == address(this), "Only governance contract itself is allowed to call this function");

65:         require(msg.sender == securityCouncil, "Only security council is allowed to call this function");

71:         require(
72:             msg.sender == owner() || msg.sender == securityCouncil,
73:             "Only the owner and security council are allowed to call this function"
74:         );

155:         require(isOperationPending(_id), "Operation must be pending");

172:         require(isOperationReady(id), "Operation must be ready before execution");

177:         require(isOperationReady(id), "Operation must be ready after execution");

191:         require(isOperationPending(id), "Operation must be pending before execution");

196:         require(isOperationPending(id), "Operation must be pending after execution");

216:         require(!isOperation(_id), "Operation with this proposal id already exists");

217:         require(_delay >= minDelay, "Proposed delay is less than minimum delay");

240:         require(_predecessorId == bytes32(0) || isOperationDone(_predecessorId), "Predecessor operation not completed");


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/Governance.sol#L42-L42) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/Governance.sol#L59-L59), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/Governance.sol#L65-L65), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/Governance.sol#L71-L74), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/Governance.sol#L155-L155), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/Governance.sol#L172-L172), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/Governance.sol#L177-L177), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/Governance.sol#L191-L191), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/Governance.sol#L196-L196), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/Governance.sol#L216-L216), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/Governance.sol#L217-L217), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/Governance.sol#L240-L240)


```solidity

File: contracts/state-transition/StateTransitionManager.sol

64:         require(msg.sender == bridgehub, "StateTransition: only bridgehub");

70:         require(msg.sender == admin || msg.sender == owner(), "Bridgehub: not owner or admin");

82:         require(_initializeData.governor != address(0), "StateTransition: governor zero");

121:         require(msg.sender == currentPendingAdmin, "n42"); // Only proposed by current admin address can claim the admin rights

256:         require(cutHashInput == initialCutHash, "StateTransition: initial cutHash mismatch");


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L64-L64) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L70-L70), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L82-L82), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L121-L121), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L256-L256)


```solidity

File: contracts/state-transition/ValidatorTimelock.sol

62:         require(msg.sender == stateTransitionManager.getChainAdmin(_chainId), "ValidatorTimelock: only chain admin");

68:         require(validators[_chainId][msg.sender] == true, "ValidatorTimelock: only validator");

195:                 require(block.timestamp >= commitBatchTimestamp + delay, "5c"); // The delay is not passed

217:                 require(block.timestamp >= commitBatchTimestamp + delay, "5c"); // The delay is not passed


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L62-L62) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L68-L68), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L195-L195), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L217-L217)


```solidity

File: contracts/state-transition/chain-deps/DiamondInit.sol

25:         require(address(_initializeData.verifier) != address(0), "vt");

26:         require(_initializeData.admin != address(0), "vy");

27:         require(_initializeData.validatorTimelock != address(0), "hc");

28:         require(_initializeData.priorityTxMaxGasLimit <= MAX_GAS_PER_TRANSACTION, "vu");


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/DiamondInit.sol#L25-L25) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/DiamondInit.sol#L26-L26), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/DiamondInit.sol#L27-L27), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/DiamondInit.sol#L28-L28)


```solidity

File: contracts/state-transition/chain-deps/DiamondProxy.sol

14:         require(_chainId == block.chainid, "pr");

25:         require(msg.data.length >= 4 || msg.data.length == 0, "Ut");

30:         require(facetAddress != address(0), "F"); // Proxy has no facet for this selector

31:         require(!diamondStorage.isFrozen || !facet.isFreezable, "q1"); // Facet is frozen


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/DiamondProxy.sol#L14-L14) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/DiamondProxy.sol#L25-L25), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/DiamondProxy.sol#L30-L30), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/DiamondProxy.sol#L31-L31)


```solidity

File: contracts/state-transition/chain-deps/facets/Admin.sol

34:         require(msg.sender == pendingAdmin, "n4"); // Only proposed by current admin address can claim the admin rights

59:         require(_newPriorityTxMaxGasLimit <= MAX_GAS_PER_TRANSACTION, "n5");

70:         require(_newFeeParams.maxPubdataPerBatch >= _newFeeParams.priorityTxMaxPubdata, "n6");

90:         require(s.totalBatchesCommitted == 0, "AdminFacet: set validium only after genesis"); // Validium mode can be set only before the first batch is committed

105:         require(
106:             cutHashInput == IStateTransitionManager(s.stateTransitionManager).upgradeCutHash(_oldProtocolVersion),
107:             "StateTransition: cutHash mismatch"
108:         );

110:         require(
111:             s.protocolVersion == _oldProtocolVersion,
112:             "StateTransition: protocolVersion mismatch in STC when upgrading"
113:         );

116:         require(
117:             s.protocolVersion > _oldProtocolVersion,
118:             "StateTransition: protocolVersion mismatch in STC after upgrading"
119:         );

136:         require(!diamondStorage.isFrozen, "a9"); // diamond proxy is frozen already

146:         require(diamondStorage.isFrozen, "a7"); // diamond proxy is not frozen


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Admin.sol#L34-L34) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Admin.sol#L59-L59), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Admin.sol#L70-L70), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Admin.sol#L90-L90), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Admin.sol#L105-L108), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Admin.sol#L110-L113), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Admin.sol#L116-L119), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Admin.sol#L136-L136), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Admin.sol#L146-L146)


```solidity

File: contracts/state-transition/chain-deps/facets/Executor.sol

37:         require(_newBatch.batchNumber == _previousBatch.batchNumber + 1, "f"); // only commit next batch

40:         require(pubdataSource == uint8(PubdataSource.Calldata) || pubdataSource == uint8(PubdataSource.Blob), "us");

74:         require(_previousBatch.batchHash == logOutput.previousBatchHash, "l");

76:         require(logOutput.chainedPriorityTxsHash == _newBatch.priorityOperationsHash, "t");

78:         require(logOutput.numberOfLayer1Txs == _newBatch.numberOfLayer1Txs, "ta");

110:         require(batchTimestamp == _expectedBatchTimestamp, "tb");

114:         require(_previousBatchTimestamp < batchTimestamp, "h3");

122:         require(block.timestamp - COMMIT_TIMESTAMP_NOT_OLDER <= batchTimestamp, "h1"); // New batch timestamp is too small

123:         require(lastL2BlockTimestamp <= block.timestamp + COMMIT_TIMESTAMP_APPROXIMATION_DELTA, "h2"); // The last L2 block timestamp is too big

226:         require(
227:             IStateTransitionManager(s.stateTransitionManager).protocolVersion() == s.protocolVersion,
228:             "Executor facet: wrong protocol version"
229:         );

231:         require(_newBatchesData.length == 1, "e4");

233:         require(s.storedBatchHashes[s.totalBatchesCommitted] == _hashStoredBatchInfo(_lastCommittedBatchData), "i"); // incorrect previous batch data

284:         require(s.l2SystemContractsUpgradeBatchNumber == 0, "ik");

323:         require(currentBatchNumber == s.totalBatchesExecuted + _executedBatchIdx + 1, "k"); // Execute batches in order

324:         require(
325:             _hashStoredBatchInfo(_storedBatch) == s.storedBatchHashes[currentBatchNumber],
326:             "exe10" // executing batch should be committed
327:         );

330:         require(priorityOperationsHash == _storedBatch.priorityOperationsHash, "x"); // priority operations hash does not match to expected

358:         require(newTotalBatchesExecuted <= s.totalBatchesVerified, "n"); // Can't execute batches more than committed and proven currently.

402:         require(_hashStoredBatchInfo(_prevBatch) == s.storedBatchHashes[currentTotalBatchesVerified], "t1");

421:         require(currentTotalBatchesVerified <= s.totalBatchesCommitted, "q");

442:         require(proofPublicInput.length == 1, "t4");

449:         require(successVerifyProof, "p"); // Proof verification fail

482:         require(s.totalBatchesCommitted > _newLastBatch, "v1"); // The last committed batch is less than new last batch

483:         require(_newLastBatch >= s.totalBatchesExecuted, "v2"); // Already executed batches cannot be reverted

543:         require(_batch.systemLogs.length <= MAX_L2_TO_L1_LOGS_COMMITMENT_BYTES, "pu");

567:         require(_blobCommitments.length == MAX_NUMBER_OF_BLOBS, "b10");

568:         require(_blobHashes.length == MAX_NUMBER_OF_BLOBS, "b11");

616:         require(success, "failed to call point evaluation precompile");

618:         require(result == BLS_MODULUS, "precompile unexpected output");

631:         require(_pubdataCommitments.length > 0, "pl");

632:         require(_pubdataCommitments.length <= PUBDATA_COMMITMENT_SIZE * MAX_NUMBER_OF_BLOBS, "bd");

633:         require(_pubdataCommitments.length % PUBDATA_COMMITMENT_SIZE == 0, "bs");

663:         require(versionedHash == bytes32(0), "lh");

681:         require(success, "vc");

50:             require(logOutput.pubdataHash == 0x00, "v0h");

149:             require(!_checkBit(processedLogs, uint8(logKey)), "kp");

194:             require(processedLogs == 1023, "b8");

192:             require(processedLogs == 511, "b7");

407:             require(
408:                 _hashStoredBatchInfo(_committedBatches[i]) == s.storedBatchHashes[currentTotalBatchesVerified],
409:                 "o1"
410:             );

639:             require(blobVersionedHash != bytes32(0), "vh");

668:             require(
669:                 (_blobHashes[i] == bytes32(0) && blobCommitments[i] == bytes32(0)) ||
670:                     (_blobHashes[i] != bytes32(0) && blobCommitments[i] != bytes32(0)),
671:                 "bh"
672:             );

61:             require(
62:                 logOutput.pubdataHash ==
63:                     keccak256(_newBatch.pubdataCommitments[1:_newBatch.pubdataCommitments.length - 32]),
64:                 "wp"
65:             );

154:                 require(logSender == L2_TO_L1_MESSENGER_SYSTEM_CONTRACT_ADDR, "lm");

157:                 require(logSender == L2_TO_L1_MESSENGER_SYSTEM_CONTRACT_ADDR, "ln");

160:                 require(logSender == L2_TO_L1_MESSENGER_SYSTEM_CONTRACT_ADDR, "lb");

163:                 require(logSender == L2_SYSTEM_CONTEXT_SYSTEM_CONTRACT_ADDR, "sc");

166:                 require(logSender == L2_SYSTEM_CONTEXT_SYSTEM_CONTRACT_ADDR, "sv");

169:                 require(logSender == L2_BOOTLOADER_ADDRESS, "bl");

172:                 require(logSender == L2_BOOTLOADER_ADDRESS, "bk");

175:                 require(logSender == L2_PUBDATA_CHUNK_PUBLISHER_ADDR, "pc");

178:                 require(logSender == L2_PUBDATA_CHUNK_PUBLISHER_ADDR, "pd");

181:                 require(logSender == L2_BOOTLOADER_ADDRESS, "bu");

182:                 require(_expectedSystemContractUpgradeTxHash == logValue, "ut");


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L37-L37) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L40-L40), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L74-L74), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L76-L76), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L78-L78), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L110-L110), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L114-L114), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L122-L122), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L123-L123), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L226-L229), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L231-L231), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L233-L233), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L284-L284), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L323-L323), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L324-L327), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L330-L330), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L358-L358), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L402-L402), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L421-L421), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L442-L442), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L449-L449), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L482-L482), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L483-L483), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L543-L543), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L567-L567), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L568-L568), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L616-L616), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L618-L618), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L631-L631), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L632-L632), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L633-L633), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L663-L663), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L681-L681), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L50-L50), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L149-L149), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L194-L194), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L192-L192), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L407-L410), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L639-L639), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L668-L672), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L61-L65), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L154-L154), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L157-L157), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L160-L160), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L163-L163), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L166-L166), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L169-L169), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L172-L172), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L175-L175), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L178-L178), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L181-L181), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L182-L182)


```solidity

File: contracts/state-transition/chain-deps/facets/Getters.sol

183:         require(ds.selectorToFacet[_selector].facetAddress != address(0), "g2");


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L183-L183) 


```solidity

File: contracts/state-transition/chain-deps/facets/Mailbox.sol

39:         require(s.chainId == ERA_CHAIN_ID, "transferEthToSharedBridge only available for Era on mailbox");

110:         require(_batchNumber <= s.totalBatchesExecuted, "xx");

117:         require(hashedLog != L2_L1_LOGS_TREE_DEFAULT_LEAF_HASH, "tw");

158:         require(s.baseTokenGasPriceMultiplierDenominator > 0, "Mailbox: baseTokenGasPriceDenominator not set");

185:         require(s.chainId == ERA_CHAIN_ID, "finalizeEthWithdrawal only available for Era on mailbox");

206:         require(s.chainId == ERA_CHAIN_ID, "legacy interface only available for era token");

243:         require(_request.l2GasPerPubdataByteLimit == REQUIRED_L2_GAS_PRICE_PER_PUBDATA, "qp");

264:         require(_factoryDeps.length <= MAX_NEW_FACTORY_DEPS, "uj");

272:         require(_mintValue >= baseCost + _params.l2Value, "mv"); // The `msg.value` doesn't cover the transaction cost


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L39-L39) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L110-L110), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L117-L117), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L158-L158), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L185-L185), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L206-L206), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L243-L243), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L264-L264), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L272-L272)


```solidity

File: contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol

16:         require(msg.sender == s.admin, "StateTransition Chain: not admin");

22:         require(s.validators[msg.sender], "StateTransition Chain: not validator");

27:         require(msg.sender == s.stateTransitionManager, "StateTransition Chain: not state transition manager");

32:         require(msg.sender == s.bridgehub, "StateTransition Chain: not bridgehub");

37:         require(
38:             msg.sender == s.admin || msg.sender == s.stateTransitionManager,
39:             "StateTransition Chain: Only by admin or state transition manager"
40:         );

45:         require(
46:             s.validators[msg.sender] || msg.sender == s.stateTransitionManager,
47:             "StateTransition Chain: Only by validator or state transition manager"
48:         );

53:         require(msg.sender == s.baseTokenBridge, "Only shared bridge can call this function");


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L16-L16) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L22-L22), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L27-L27), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L32-L32), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L37-L40), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L45-L48), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L53-L53)


```solidity

File: contracts/upgrades/BaseZkSyncUpgrade.sol

72:         require(block.timestamp >= _proposedUpgrade.upgradeTimestamp, "Upgrade is not ready yet");

190:         require(_l2ProtocolUpgradeTx.txType == SYSTEM_UPGRADE_L2_TX_TYPE, "L2 system upgrade tx type is wrong");

205:         require(
206:             _l2ProtocolUpgradeTx.nonce == _newProtocolVersion,
207:             "The new protocol version should be included in the L2 system upgrade tx"
208:         );

223:         require(_factoryDeps.length == _expectedHashes.length, "Wrong number of factory deps");

224:         require(_factoryDeps.length <= MAX_NEW_FACTORY_DEPS, "Factory deps can be at most 32");

238:         require(
239:             _newProtocolVersion > previousProtocolVersion,
240:             "New protocol version is not greater than the current one"
241:         );

242:         require(
243:             _newProtocolVersion - previousProtocolVersion <= MAX_ALLOWED_PROTOCOL_VERSION_DELTA,
244:             "Too big protocol version difference"
245:         );

249:         require(s.l2SystemContractsUpgradeTxHash == bytes32(0), "Previous upgrade has not been finalized");

250:         require(
251:             s.l2SystemContractsUpgradeBatchNumber == 0,
252:             "The batch number of the previous upgrade has not been cleaned"
253:         );

227:             require(
228:                 L2ContractHelper.hashL2Bytecode(_factoryDeps[i]) == bytes32(_expectedHashes[i]),
229:                 "Wrong factory dep hash"
230:             );


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgrade.sol#L72-L72) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgrade.sol#L190-L190), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgrade.sol#L205-L208), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgrade.sol#L223-L223), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgrade.sol#L224-L224), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgrade.sol#L238-L241), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgrade.sol#L242-L245), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgrade.sol#L249-L249), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgrade.sol#L250-L253), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgrade.sol#L227-L230)


```solidity

File: contracts/upgrades/BaseZkSyncUpgradeGenesis.sol

22:         require(
23:             // Genesis Upgrade difference: Note this is the only thing change > to >=
24:             _newProtocolVersion >= previousProtocolVersion,
25:             "New protocol version is not greater than the current one"
26:         );

27:         require(
28:             _newProtocolVersion - previousProtocolVersion <= MAX_ALLOWED_PROTOCOL_VERSION_DELTA,
29:             "Too big protocol version difference"
30:         );

33:         require(s.l2SystemContractsUpgradeTxHash == bytes32(0), "Previous upgrade has not been finalized");

34:         require(
35:             s.l2SystemContractsUpgradeBatchNumber == 0,
36:             "The batch number of the previous upgrade has not been cleaned"
37:         );

52:         require(block.timestamp >= _proposedUpgrade.upgradeTimestamp, "Upgrade is not ready yet");


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L22-L26) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L27-L30), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L33-L33), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L34-L37), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L52-L52)


```solidity

File: contracts/common/libraries/L2ContractHelper.sol

23:         require(_bytecode.length % 32 == 0, "pq");

26:         require(bytecodeLenInWords < 2 ** 16, "pp"); // bytecode length must be less than 2^16 words

27:         require(bytecodeLenInWords % 2 == 1, "ps"); // bytecode length in words must be odd

41:         require(version == 1 && _bytecodeHash[1] == bytes1(0), "zf"); // Incorrectly formatted bytecodeHash

43:         require(bytecodeLen(_bytecodeHash) % 2 == 1, "uy"); // Code length in words must be odd


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/L2ContractHelper.sol#L23-L23) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/L2ContractHelper.sol#L26-L26), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/L2ContractHelper.sol#L27-L27), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/L2ContractHelper.sol#L41-L41), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/L2ContractHelper.sol#L43-L43)


```solidity

File: contracts/state-transition/libraries/Diamond.sol

132:         require(_facet.code.length > 0, "G");

155:         require(_facet.code.length > 0, "K");

175:         require(_facet == address(0), "a1"); // facet address must be zero

107:             require(selectors.length > 0, "B"); // no functions for diamond cut

141:             require(oldFacet.facetAddress == address(0), "J"); // facet for this selector already exists

161:             require(oldFacet.facetAddress != address(0), "L"); // it is impossible to replace the facet with zero address

181:             require(oldFacet.facetAddress != address(0), "a2"); // Can't delete a non-existent facet

215:             require(_isSelectorFreezable == ds.selectorToFacet[selector0].isFreezable, "J1");

297:             require(data.length == 32, "lp");

298:             require(abi.decode(data, (bytes32)) == DIAMOND_INIT_SUCCESS_RETURN_VALUE, "lp1");

280:             require(_calldata.length == 0, "H"); // Non-empty calldata for zero address


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L132-L132) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L155-L155), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L175-L175), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L107-L107), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L141-L141), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L161-L161), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L181-L181), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L215-L215), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L297-L297), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L298-L298), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L280-L280)


```solidity

File: contracts/state-transition/libraries/Merkle.sol

24:         require(pathLength > 0, "xc");

25:         require(pathLength < 256, "bt");

26:         require(_index < (1 << pathLength), "px");


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Merkle.sol#L24-L24) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Merkle.sol#L25-L25), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Merkle.sol#L26-L26)


```solidity

File: contracts/state-transition/libraries/PriorityQueue.sol

65:         require(!_queue.isEmpty(), "D"); // priority queue is empty

73:         require(!_queue.isEmpty(), "s"); // priority queue is empty


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/PriorityQueue.sol#L65-L65) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/PriorityQueue.sol#L73-L73)


```solidity

File: contracts/state-transition/libraries/TransactionValidator.sol

28:         require(l2GasForTxBody <= _priorityTxMaxGasLimit, "ui");

30:         require(l2GasForTxBody / _transaction.gasPerPubdataByteLimit <= _priorityTxMaxPubdata, "uk");

34:         require(
35:             getMinimalPriorityTransactionGasLimit(
36:                 _encoded.length,
37:                 _transaction.factoryDeps.length,
38:                 _transaction.gasPerPubdataByteLimit
39:             ) <= l2GasForTxBody,
40:             "up"
41:         );

48:         require(_transaction.from <= type(uint16).max, "ua");

49:         require(_transaction.to <= type(uint160).max, "ub");

50:         require(_transaction.paymaster == 0, "uc");

51:         require(_transaction.value == 0, "ud");

52:         require(_transaction.maxFeePerGas == 0, "uq");

53:         require(_transaction.maxPriorityFeePerGas == 0, "ux");

54:         require(_transaction.reserved[0] == 0, "ue");

55:         require(_transaction.reserved[1] <= type(uint160).max, "uf");

56:         require(_transaction.reserved[2] == 0, "ug");

57:         require(_transaction.reserved[3] == 0, "uo");

58:         require(_transaction.signature.length == 0, "uh");

59:         require(_transaction.paymasterInput.length == 0, "ul1");

60:         require(_transaction.reservedDynamic.length == 0, "um");

115:         require(_totalGasLimit >= overhead, "my"); // provided gas limit doesn't cover transaction overhead


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/TransactionValidator.sol#L28-L28) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/TransactionValidator.sol#L30-L30), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/TransactionValidator.sol#L34-L41), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/TransactionValidator.sol#L48-L48), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/TransactionValidator.sol#L49-L49), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/TransactionValidator.sol#L50-L50), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/TransactionValidator.sol#L51-L51), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/TransactionValidator.sol#L52-L52), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/TransactionValidator.sol#L53-L53), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/TransactionValidator.sol#L54-L54), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/TransactionValidator.sol#L55-L55), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/TransactionValidator.sol#L56-L56), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/TransactionValidator.sol#L57-L57), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/TransactionValidator.sol#L58-L58), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/TransactionValidator.sol#L59-L59), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/TransactionValidator.sol#L60-L60), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/TransactionValidator.sol#L115-L115)


```solidity

File: contracts/common/ReentrancyGuard.sol

58:         require(lockSlotOldValue == 0, "1B");

75:         require(_status == _NOT_ENTERED, "r1");


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/ReentrancyGuard.sol#L58-L58) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/ReentrancyGuard.sol#L75-L75)


```solidity

File: contracts/bridge/L2SharedBridge.sol

55:         require(_l1Bridge != address(0), "bf");

56:         require(_l2TokenProxyBytecodeHash != bytes32(0), "df");

57:         require(_aliasedOwner != address(0), "sf");

58:         require(_l2TokenProxyBytecodeHash != bytes32(0), "df");

87:         require(
88:             AddressAliasHelper.undoL1ToL2Alias(msg.sender) == l1Bridge ||
89:                 AddressAliasHelper.undoL1ToL2Alias(msg.sender) == l1LegacyBridge,
90:             "mq"
91:         );

92:         require(msg.value == 0, "Value should be 0 for ERC20 bridge");

124:         require(_amount > 0, "Amount cannot be zero");

129:         require(l1Token != address(0), "yh");

176:         require(success, "mk");

68:             require(_l1LegecyBridge != address(0), "bf2");

101:             require(currentL1Token == _l1Token, "gg"); // Double check that the expected value equal to real one

98:             require(deployedToken == expectedL2Token, "mt");


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L55-L55) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L56-L56), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L57-L57), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L58-L58), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L87-L91), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L92-L92), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L124-L124), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L129-L129), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L176-L176), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L68-L68), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L101-L101), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L98-L98)


```solidity

File: contracts/bridge/L2StandardERC20.sol

51:         require(_l1Address != address(0), "in6"); // Should be non-zero address

120:         require(msg.sender == UpgradeableBeacon(beaconAddress).owner(), "tt");

130:         require(msg.sender == l2Bridge, "xnt"); // Only L2 bridge can call this method

137:         require(_version == _getInitializedVersion() + 1, "v");


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2StandardERC20.sol#L51-L51) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2StandardERC20.sol#L120-L120), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2StandardERC20.sol#L130-L130), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2StandardERC20.sol#L137-L137)


```solidity

File: contracts/SystemContractsCaller.sol

28:         require(_x <= type(uint32).max, "Overflow");


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/SystemContractsCaller.sol#L28-L28) 


</details>


### [NC&#x2011;111] Use `@inheritdoc` for overridden functions 



*There are 54 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/AccountCodeStorage.sol

30:     /// @notice Stores the bytecodeHash of constructing contract.
31:     /// @param _address The address of the account to set the codehash to.
32:     /// @param _hash The new bytecode hash of the constructing account.
33:     /// @dev This method trusts the ContractDeployer to make sure that the bytecode is known and well-formed,
34:     /// but checks whether the bytecode hash corresponds to the constructing smart contract.

41:     /// @notice Stores the bytecodeHash of constructed contract.
42:     /// @param _address The address of the account to set the codehash to.
43:     /// @param _hash The new bytecode hash of the constructed account.
44:     /// @dev This method trusts the ContractDeployer to make sure that the bytecode is known and well-formed,
45:     /// but checks whether the bytecode hash corresponds to the constructed smart contract.

52:     /// @notice Marks the account bytecodeHash as constructed.
53:     /// @param _address The address of the account to mark as constructed

75:     /// @notice Get the codehash stored for an address.
76:     /// @param _address The address of the account of which the codehash to return
77:     /// @return codeHash The codehash stored for this account.

86:     /// @notice Simulate the behavior of the `extcodehash` EVM opcode.
87:     /// @param _input The 256-bit account address.
88:     /// @return codeHash - hash of the bytecode according to the EIP-1052 specification.

114:     /// @notice Simulate the behavior of the `extcodesize` EVM opcode.
115:     /// @param _input The 256-bit account address.
116:     /// @return codeSize - the size of the deployed smart contract in bytes.


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/AccountCodeStorage.sol#L30-L34) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/AccountCodeStorage.sol#L41-L45), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/AccountCodeStorage.sol#L52-L53), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/AccountCodeStorage.sol#L75-L77), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/AccountCodeStorage.sol#L86-L88), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/AccountCodeStorage.sol#L114-L116)


```solidity

File: contracts/BootloaderUtilities.sol

19:     /// @notice Calculates the canonical transaction hash and the recommended transaction hash.
20:     /// @param _transaction The transaction.
21:     /// @return txHash and signedTxHash of the transaction, i.e. the transaction hash to be used in the explorer and commits to all
22:     /// the fields of the transaction and the recommended hash to be signed for this transaction.
23:     /// @dev txHash must be unique for all transactions.


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L19-L23) 


```solidity

File: contracts/ContractDeployer.sol

89:     /// @notice Calculates the address of a deployed contract via create2
90:     /// @param _sender The account that deploys the contract.
91:     /// @param _bytecodeHash The correctly formatted hash of the bytecode.
92:     /// @param _salt The create2 salt.
93:     /// @param _input The constructor data.
94:     /// @return newAddress The derived address of the account.

112:     /// @notice Calculates the address of a deployed contract via create
113:     /// @param _sender The account that deploys the contract.
114:     /// @param _senderNonce The deploy nonce of the sender's account.

128:     /// @notice Deploys a contract with similar address derivation rules to the EVM's `CREATE2` opcode.
129:     /// @param _salt The CREATE2 salt
130:     /// @param _bytecodeHash The correctly formatted hash of the bytecode.
131:     /// @param _input The constructor calldata

140:     /// @notice Deploys a contract with similar address derivation rules to the EVM's `CREATE` opcode.
141:     /// @param _bytecodeHash The correctly formatted hash of the bytecode.
142:     /// @param _input The constructor calldata
143:     /// @dev This method also accepts nonce as one of its parameters.
144:     /// It is not used anywhere and it needed simply for the consistency for the compiler
145:     /// Note: this method may be callable only in system mode,
146:     /// that is checked in the `createAccount` by `onlySystemCall` modifier.

155:     /// @notice Deploys a contract account with similar address derivation rules to the EVM's `CREATE2` opcode.
156:     /// @param _salt The CREATE2 salt
157:     /// @param _bytecodeHash The correctly formatted hash of the bytecode.
158:     /// @param _input The constructor calldata.
159:     /// @param _aaVersion The account abstraction version to use.
160:     /// Note: this method may be callable only in system mode,
161:     /// that is checked in the `createAccount` by `onlySystemCall` modifier.

176:     /// @notice Deploys a contract account with similar address derivation rules to the EVM's `CREATE` opcode.
177:     /// @param _bytecodeHash The correctly formatted hash of the bytecode.
178:     /// @param _input The constructor calldata.
179:     /// @param _aaVersion The account abstraction version to use.
180:     /// @dev This method also accepts salt as one of its parameters.
181:     /// It is not used anywhere and it needed simply for the consistency for the compiler


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L89-L94) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L112-L114), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L128-L131), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L140-L146), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L155-L161), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L176-L181)


```solidity

File: contracts/DefaultAccount.sol

58:     /// @notice Validates the transaction & increments nonce.
59:     /// @dev The transaction is considered accepted by the account if
60:     /// the call to this function by the bootloader does not revert
61:     /// and the nonce has been set as used.
62:     /// @param _suggestedSignedHash The suggested hash of the transaction to be signed by the user.
63:     /// This is the hash that is signed by the EOA by default.
64:     /// @param _transaction The transaction structure itself.
65:     /// @dev Besides the params above, it also accepts unused first paramter "_txHash", which
66:     /// is the unique (canonical) hash of the transaction.

107:     /// @notice Method called by the bootloader to execute the transaction.
108:     /// @param _transaction The transaction to execute.
109:     /// @dev It also accepts unused _txHash and _suggestedSignedHash parameters:
110:     /// the unique (canonical) hash of the transaction and the suggested signed
111:     /// hash of the transaction.

120:     /// @notice Method that should be used to initiate a transaction from this account by an external call.
121:     /// @dev The custom account is supposed to implement this method to initiate a transaction on behalf
122:     /// of the account via L1 -> L2 communication. However, the default account can initiate a transaction
123:     /// from L1, so we formally implement the interface method, but it doesn't execute any logic.
124:     /// @param _transaction The transaction to execute.


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/DefaultAccount.sol#L58-L66) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/DefaultAccount.sol#L107-L111), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/DefaultAccount.sol#L120-L124)


```solidity

File: contracts/ImmutableSimulator.sol

23:     /// @notice Method that returns the immutable with a certain index for a user.
24:     /// @param _dest The address which the immutable belongs to.
25:     /// @param _index The index of the immutable.
26:     /// @return The value of the immutables.

31:     /// @notice Method used by the contract deployer to store the immutables for an account
32:     /// @param _dest The address which to store the immutables for.
33:     /// @param _immutables The list of the immutables.


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ImmutableSimulator.sol#L23-L26) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ImmutableSimulator.sol#L31-L33)


```solidity

File: contracts/KnownCodesStorage.sol

63:     /// @notice Returns the marker stored for a bytecode hash. 1 means that the bytecode hash is known
64:     /// and can be used for deploying contracts. 0 otherwise.


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/KnownCodesStorage.sol#L63-L64) 


```solidity

File: contracts/L1Messenger.sol

114:     /// @notice Public functionality to send messages to L1.
115:     /// @param _message The message intended to be sent to L1.

159:     /// @dev Can be called only by KnownCodesStorage system contract.
160:     /// @param _bytecodeHash Hash of bytecode being published to L1.


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L114-L115) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L159-L160)


```solidity

File: contracts/L2BaseToken.sol

25:     /// @notice Transfer tokens from one address to another.
26:     /// @param _from The address to transfer the ETH from.
27:     /// @param _to The address to transfer the ETH to.
28:     /// @param _amount The amount of ETH in wei being transferred.
29:     /// @dev This function can be called only by trusted system contracts.
30:     /// @dev This function also emits "Transfer" event, which might be removed
31:     /// later on.

52:     /// @notice Returns ETH balance of an account
53:     /// @dev It takes `uint256` as an argument to be able to properly simulate the behaviour of the
54:     /// Ethereum's `BALANCE` opcode that accepts uint256 as an argument and truncates any upper bits
55:     /// @param _account The address of the account to return the balance of.

60:     /// @notice Increase the total supply of tokens and balance of the receiver.
61:     /// @dev This method is only callable by the bootloader.
62:     /// @param _account The address which to mint the funds to.
63:     /// @param _amount The amount of ETH in wei to be minted.

70:     /// @notice Initiate the ETH withdrawal, funds will be available to claim on L1 `finalizeEthWithdrawal` method.
71:     /// @param _l1Receiver The address on L1 to receive the funds.

82:     /// @notice Initiate the ETH withdrawal, with the sent message. The funds will be available to claim on L1 `finalizeEthWithdrawal` method.
83:     /// @param _l1Receiver The address on L1 to receive the funds.
84:     /// @param _additionalData Additional data to be sent to L1 with the withdrawal.

126:     /// @dev This method has not been stabilized and might be
127:     /// removed later on.

132:     /// @dev This method has not been stabilized and might be
133:     /// removed later on.

138:     /// @dev This method has not been stabilized and might be
139:     /// removed later on.


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L2BaseToken.sol#L25-L31) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L2BaseToken.sol#L52-L55), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L2BaseToken.sol#L60-L63), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L2BaseToken.sol#L70-L71), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L2BaseToken.sol#L82-L84), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L2BaseToken.sol#L126-L127), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L2BaseToken.sol#L132-L133), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L2BaseToken.sol#L138-L139)


```solidity

File: contracts/bridge/L1SharedBridge.sol

181:     /// @notice Initiates a deposit transaction within Bridgehub, used by `requestL2TransactionTwoBridges`.

230:     /// @notice Confirms the acceptance of a transaction by the Mailbox, as part of the L2 transaction process within Bridgehub.
231:     /// This function is utilized by `requestL2TransactionTwoBridges` to validate the execution of a transaction.

268:     /// @dev Withdraw funds from the initiated deposit, that failed when finalizing on L2
269:     /// @param _depositSender The address of the deposit initiator
270:     /// @param _l1Token The address of the deposited L1 ERC20 token
271:     /// @param _amount The amount of the deposit that failed.
272:     /// @param _l2TxHash The L2 transaction hash of the failed deposit finalization
273:     /// @param _l2BatchNumber The L2 batch number where the deposit finalization was processed
274:     /// @param _l2MessageIndex The position in the L2 logs Merkle tree of the l2Log that was sent with the message
275:     /// @param _l2TxNumberInBatch The L2 transaction number in a batch, in which the log was sent
276:     /// @param _merkleProof The Merkle proof of the processing L1 -> L2 transaction with deposit finalization

378:     /// @notice Finalize the withdrawal and release funds
379:     /// @param _chainId The chain ID of the transaction to check
380:     /// @param _l2BatchNumber The L2 batch number where the withdrawal was processed
381:     /// @param _l2MessageIndex The position in the L2 logs Merkle tree of the l2Log that was sent with the message
382:     /// @param _l2TxNumberInBatch The L2 transaction number in the batch, in which the log was sent
383:     /// @param _message The L2 withdraw data, stored in an L2 -> L1 message
384:     /// @param _merkleProof The Merkle proof of the inclusion L2 -> L1 message about withdrawal initialization

530:     /// @notice Initiates a deposit by locking funds on the contract and sending the request
531:     /// of processing an L2 transaction where tokens would be minted.
532:     /// @dev If the token is bridged for the first time, the L2 token contract will be deployed. Note however, that the
533:     /// newly-deployed token does not support any custom logic, i.e. rebase tokens' functionality is not supported.
534:     /// @param _l2Receiver The account address that should receive funds on L2
535:     /// @param _l1Token The L1 token address which is deposited
536:     /// @param _amount The total amount of tokens to be bridged
537:     /// @param _l2TxGasLimit The L2 gas limit to be used in the corresponding L2 transaction
538:     /// @param _l2TxGasPerPubdataByte The gasPerPubdataByteLimit to be used in the corresponding L2 transaction
539:     /// @param _refundRecipient The address on L2 that will receive the refund for the transaction.
540:     /// @dev If the L2 deposit finalization transaction fails, the `_refundRecipient` will receive the `_l2Value`.
541:     /// Please note, the contract may change the refund recipient's address to eliminate sending funds to addresses
542:     /// out of control.
543:     /// - If `_refundRecipient` is a contract on L1, the refund will be sent to the aliased `_refundRecipient`.
544:     /// - If `_refundRecipient` is set to `address(0)` and the sender has NO deployed bytecode on L1, the refund will
545:     /// be sent to the `msg.sender` address.
546:     /// - If `_refundRecipient` is set to `address(0)` and the sender has deployed bytecode on L1, the refund will be
547:     /// sent to the aliased `msg.sender` address.
548:     /// @dev The address aliasing of L1 contracts as refund recipient on L2 is necessary to guarantee that the funds
549:     /// are controllable through the Mailbox, since the Mailbox applies address aliasing to the from address for the
550:     /// L2 tx if the L1 msg.sender is a contract. Without address aliasing for L1 contracts as refund recipients they
551:     /// would not be able to make proper L2 tx requests through the Mailbox to use or withdraw the funds from L2, and
552:     /// the funds would be lost.
553:     /// @return l2TxHash The L2 transaction hash of deposit finalization.

605:     /// @notice Finalizes the withdrawal for transactions initiated via the legacy ERC20 bridge.
606:     /// @param _l2BatchNumber The L2 batch number where the withdrawal was processed
607:     /// @param _l2MessageIndex The position in the L2 logs Merkle tree of the l2Log that was sent with the message
608:     /// @param _l2TxNumberInBatch The L2 transaction number in the batch, in which the log was sent
609:     /// @param _message The L2 withdraw data, stored in an L2 -> L1 message
610:     /// @param _merkleProof The Merkle proof of the inclusion L2 -> L1 message about withdrawal initialization
611:     ///
612:     /// @return l1Receiver The address on L1 that will receive the withdrawn funds
613:     /// @return l1Token The address of the L1 token being withdrawn
614:     /// @return amount The amount of the token being withdrawns

632:     /// @notice Withdraw funds from the initiated deposit, that failed when finalizing on zkSync Era chain.
633:     /// This function is specifically designed for maintaining backward-compatibility with legacy `claimFailedDeposit`
634:     /// method in `L1ERC20Bridge`.
635:     ///
636:     /// @param _depositSender The address of the deposit initiator
637:     /// @param _l1Token The address of the deposited L1 ERC20 token
638:     /// @param _amount The amount of the deposit that failed.
639:     /// @param _l2TxHash The L2 transaction hash of the failed deposit finalization
640:     /// @param _l2BatchNumber The L2 batch number where the deposit finalization was processed
641:     /// @param _l2MessageIndex The position in the L2 logs Merkle tree of the l2Log that was sent with the message
642:     /// @param _l2TxNumberInBatch The L2 transaction number in a batch, in which the log was sent
643:     /// @param _merkleProof The Merkle proof of the processing L1 -> L2 transaction with deposit finalization


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L181-L181) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L230-L231), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L268-L276), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L378-L384), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L530-L553), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L605-L614), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L632-L643)


```solidity

File: contracts/bridgehub/Bridgehub.sol

151:     /// @notice forwards function call to Mailbox based on ChainId

163:     /// @notice forwards function call to Mailbox based on ChainId

175:     /// @notice forwards function call to Mailbox based on ChainId

213:     /// @notice the mailbox is called directly after the sharedBridge received the deposit
214:     /// this assumes that either ether is the base token or
215:     /// the msg.sender has approved mintValue allowance for the sharedBridge.
216:     /// This means this is not ideal for contract calls, as the contract would have to handle token allowance of the base Token

253:     /// @notice After depositing funds to the sharedBridge, the secondBridge is called
254:     ///  to return the actual L2 message which is sent to the Mailbox.
255:     ///  This assumes that either ether is the base token or
256:     ///  the msg.sender has approved the sharedBridge with the mintValue,
257:     ///  and also the necessary approvals are given for the second bridge.
258:     /// @notice The logic of this bridge is to allow easy depositing for bridges.
259:     /// Each contract that handles the users ERC20 tokens needs approvals from the user, this contract allows
260:     /// the user to approve for each token only its respective bridge
261:     /// @notice This function is great for contract calls to L2, the secondBridge can be any contract.


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L151-L151) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L163-L163), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L175-L175), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L213-L216), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L253-L261)


```solidity

File: contracts/state-transition/StateTransitionManager.sol

74:     function getChainAdmin(uint256 _chainId) external view override returns (address) {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L74-L74) 


```solidity

File: contracts/upgrades/BaseZkSyncUpgradeGenesis.sol

18:     /// @notice Changes the protocol version
19:     /// @param _newProtocolVersion The new protocol version

43:     /// @notice The main function that will be provided by the upgrade proxy
44:     /// @dev This is a virtual function and should be overridden by custom upgrade implementations.
45:     /// @param _proposedUpgrade The upgrade to be executed.
46:     /// @return The hash of the L2 system contract upgrade transaction.


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L18-L19) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L43-L46)


```solidity

File: contracts/upgrades/DefaultUpgrade.sol

11:     /// @notice The main function that will be called by the upgrade proxy.
12:     /// @param _proposedUpgrade The upgrade to be executed.


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/DefaultUpgrade.sol#L11-L12) 


```solidity

File: contracts/upgrades/GenesisUpgrade.sol

12:     /// @notice The main function that will be called by the upgrade proxy.
13:     /// @param _proposedUpgrade The upgrade to be executed.


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/GenesisUpgrade.sol#L12-L13) 


```solidity

File: contracts/bridge/L2SharedBridge.sol

73:     /// @notice Finalize the deposit and mint funds
74:     /// @param _l1Sender The account address that initiated the deposit on L1
75:     /// @param _l2Receiver The account address that would receive minted ether
76:     /// @param _l1Token The address of the token that was locked on the L1
77:     /// @param _amount Total amount of tokens deposited from L1
78:     /// @param _data The additional data that user can pass with the deposit

118:     /// @notice Initiates a withdrawal by burning funds on the contract and sending the message to L1
119:     /// where tokens would be unlocked
120:     /// @param _l1Receiver The account address that should receive funds on L1
121:     /// @param _l2Token The L2 token address which is withdrawn
122:     /// @param _amount The total amount of tokens to be withdrawn

148:     /// @return Address of an L2 token counterpart


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L73-L78) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L118-L122), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L148-L148)


```solidity

File: contracts/bridge/L2StandardERC20.sol

141:     /// @dev Mint tokens to a given account.
142:     /// @param _to The account that will receive the created tokens.
143:     /// @param _amount The amount that will be created.
144:     /// @notice Should be called by bridge after depositing tokens from L1.

150:     /// @dev Burn tokens from a given account.
151:     /// @param _from The account from which tokens will be burned.
152:     /// @param _amount The amount that will be burned.
153:     /// @notice Should be called by bridge before withdrawing tokens to L1.

159:     function name() public view override returns (string memory) {

165:     function symbol() public view override returns (string memory) {

171:     function decimals() public view override returns (uint8) {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2StandardERC20.sol#L141-L144) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2StandardERC20.sol#L150-L153), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2StandardERC20.sol#L159-L159), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2StandardERC20.sol#L165-L165), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2StandardERC20.sol#L171-L171)


</details>


### [NC&#x2011;112] Multiple mappings with same keys can be combined into a single struct mapping for readability 
Well-organized data structures make code reviews easier, which may lead to fewer bugs. Consider combining related mappings into mappings to structs, so it's clear what data is related.


*There are 6 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/bridge/L1ERC20Bridge.sol

32:     mapping(address account => mapping(address l1Token => mapping(bytes32 depositL2TxHash => uint256 amount)))

45:     mapping(address => uint256) private __DEPRECATED_lastWithdrawalLimitReset;

48:     mapping(address => uint256) private __DEPRECATED_withdrawnAmountInWindow;

51:     mapping(address => mapping(address => uint256)) private __DEPRECATED_totalDepositedAmountPerUser;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1ERC20Bridge.sol#L32-L32) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1ERC20Bridge.sol#L45-L45), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1ERC20Bridge.sol#L48-L48), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1ERC20Bridge.sol#L51-L51)


```solidity

File: contracts/bridgehub/Bridgehub.sol

21:     mapping(address _stateTransitionManager => bool) public stateTransitionManagerIsRegistered;

23:     mapping(address _token => bool) public tokenIsRegistered;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L21-L21) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L23-L23)


</details>


### [NC&#x2011;113] constructor should emit an event 
Use events to signal significant changes to off-chain monitoring tools.


*There are 9 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/bridge/L1ERC20Bridge.sol

55:     constructor(IL1SharedBridge _sharedBridge) reentrancyGuardInitializer {
56:         sharedBridge = _sharedBridge;
57:     }


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1ERC20Bridge.sol#L55-L57) 


```solidity

File: contracts/bridge/L1SharedBridge.sol

90:     constructor(
91:         address _l1WethAddress,
92:         IBridgehub _bridgehub,
93:         IL1ERC20Bridge _legacyBridge
94:     ) reentrancyGuardInitializer {
95:         _disableInitializers();
96:         l1WethAddress = _l1WethAddress;
97:         bridgehub = _bridgehub;
98:         legacyBridge = _legacyBridge;
99:     }


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L90-L99) 


```solidity

File: contracts/bridgehub/Bridgehub.sol

38:     constructor() reentrancyGuardInitializer {}


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L38-L38) 


```solidity

File: contracts/state-transition/StateTransitionManager.sol

58:     constructor(address _bridgehub) reentrancyGuardInitializer {
59:         bridgehub = _bridgehub;
60:     }


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L58-L60) 


```solidity

File: contracts/state-transition/ValidatorTimelock.sol

55:     constructor(address _initialOwner, uint32 _executionDelay) {
56:         _transferOwnership(_initialOwner);
57:         executionDelay = _executionDelay;
58:     }


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L55-L58) 


```solidity

File: contracts/state-transition/chain-deps/DiamondInit.sol

19:     constructor() reentrancyGuardInitializer {}


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/DiamondInit.sol#L19-L19) 


```solidity

File: contracts/state-transition/chain-deps/DiamondProxy.sol

11:     constructor(uint256 _chainId, Diamond.DiamondCutData memory _diamondCut) {
12:         // Check that the contract is deployed on the expected chain.
13:         // Thus, the contract deployed by the same Create2 factory on the different chain will have different addresses!
14:         require(_chainId == block.chainid, "pr");
15:         Diamond.diamondCut(_diamondCut);
16:     }


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/DiamondProxy.sol#L11-L16) 


```solidity

File: contracts/bridge/L2SharedBridge.sol

41:     constructor() {
42:         _disableInitializers();
43:     }


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L41-L43) 


```solidity

File: contracts/bridge/L2StandardERC20.sol

40:     constructor() {
41:         // Disable initialization to prevent Parity hack.
42:         _disableInitializers();
43:     }


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2StandardERC20.sol#L40-L43) 


</details>


### [NC&#x2011;114] Complex functions should include comments 
Large and/or complex functions should include comments to make them easier to understand and reduce margin for error.


*There are 9 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/Compressor.sol

44:     function publishCompressedBytecode(

220:     function _verifyValueCompression(


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Compressor.sol#L44-L44) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Compressor.sol#L220-L220)


```solidity

File: contracts/libraries/RLPEncoder.sol

84:     function _highestByteSet(uint256 _number) private pure returns (uint256 hbs) {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/RLPEncoder.sol#L84-L84) 


```solidity

File: contracts/libraries/TransactionHelper.sol

118:     function _encodeHashEIP712Transaction(Transaction calldata _transaction) private view returns (bytes32) {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L118-L118) 


```solidity

File: contracts/bridge/L1SharedBridge.sol

277:     function claimFailedDeposit(

644:     function claimFailedDepositLegacyErc20Bridge(


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L277-L277) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L644-L644)


```solidity

File: contracts/bridgehub/Bridgehub.sol

217:     function requestL2TransactionDirect(


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L217-L217) 


```solidity

File: contracts/state-transition/chain-deps/facets/Admin.sol

100:     function upgradeChainFromVersion(


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Admin.sol#L100-L100) 


```solidity

File: contracts/state-transition/chain-deps/facets/Mailbox.sol

197:     function requestL2Transaction(


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L197-L197) 


</details>


### [NC&#x2011;115] Make use of Solidiy's `using` keyword 
The directive `using A for B` can be used to attach functions (`A`) as operators to user-defined value types or as member functions to any type (`B`). The member functions receive the object they are called on as their first parameter (like the `self` variable in Python). The operator functions receive operands as parameters.  Doing so improves readability, makes debugging easier, and promotes modularity and reusability in the code.


*There are 186 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/AccountCodeStorage.sol

60:         bytes32 constructedBytecodeHash = Utils.constructedBytecodeHash(codeHash);

37:         require(Utils.isContractConstructing(_hash), "Code hash is not for a contract on constructor");

48:         require(Utils.isContractConstructed(_hash), "Code hash is not for a constructed contract");

57:         require(Utils.isContractConstructing(codeHash), "Code hash is not for a contract on constructor");

107:         else if (Utils.isContractConstructing(codeHash)) {

102:         if (codeHash == 0x00 && NONCE_HOLDER_SYSTEM_CONTRACT.getRawNonce(account) > 0) {

134:             !Utils.isContractConstructing(codeHash)

136:             codeSize = Utils.bytecodeLenInBytes(codeHash);


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/AccountCodeStorage.sol#L60-L60) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/AccountCodeStorage.sol#L37-L37), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/AccountCodeStorage.sol#L48-L48), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/AccountCodeStorage.sol#L57-L57), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/AccountCodeStorage.sol#L107-L107), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/AccountCodeStorage.sol#L102-L102), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/AccountCodeStorage.sol#L134-L134), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/AccountCodeStorage.sol#L136-L136)


```solidity

File: contracts/BootloaderUtilities.sol

52:         bytes memory encodedNonce = RLPEncoder.encodeUint256(_transaction.nonce);

61:         bytes memory encodedTo = RLPEncoder.encodeAddress(address(uint160(_transaction.to)));

62:         bytes memory encodedValue = RLPEncoder.encodeUint256(_transaction.value);

176:         bytes memory encodedAccessListLength = RLPEncoder.encodeListLen(0);

271:         bytes memory encodedAccessListLength = RLPEncoder.encodeListLen(0);

56:             bytes memory encodedGasPrice = RLPEncoder.encodeUint256(_transaction.maxFeePerGas);

57:             bytes memory encodedGasLimit = RLPEncoder.encodeUint256(_transaction.gasLimit);

143:             bytes memory encodedChainId = RLPEncoder.encodeUint256(block.chainid);

144:             bytes memory encodedNonce = RLPEncoder.encodeUint256(_transaction.nonce);

145:             bytes memory encodedGasPrice = RLPEncoder.encodeUint256(_transaction.maxFeePerGas);

146:             bytes memory encodedGasLimit = RLPEncoder.encodeUint256(_transaction.gasLimit);

147:             bytes memory encodedTo = RLPEncoder.encodeAddress(address(uint160(_transaction.to)));

148:             bytes memory encodedValue = RLPEncoder.encodeUint256(_transaction.value);

236:             bytes memory encodedChainId = RLPEncoder.encodeUint256(block.chainid);

237:             bytes memory encodedNonce = RLPEncoder.encodeUint256(_transaction.nonce);

238:             bytes memory encodedMaxPriorityFeePerGas = RLPEncoder.encodeUint256(_transaction.maxPriorityFeePerGas);

239:             bytes memory encodedMaxFeePerGas = RLPEncoder.encodeUint256(_transaction.maxFeePerGas);

240:             bytes memory encodedGasLimit = RLPEncoder.encodeUint256(_transaction.gasLimit);

241:             bytes memory encodedTo = RLPEncoder.encodeAddress(address(uint160(_transaction.to)));

242:             bytes memory encodedValue = RLPEncoder.encodeUint256(_transaction.value);

82:             rEncoded = RLPEncoder.encodeUint256(rInt);

87:             sEncoded = RLPEncoder.encodeUint256(sInt);

100:             vEncoded = RLPEncoder.encodeUint256(vInt);

116:             encodedListLength = RLPEncoder.encodeListLen(uint64(listLength));

181:             rEncoded = RLPEncoder.encodeUint256(rInt);

186:             sEncoded = RLPEncoder.encodeUint256(sInt);

193:             vEncoded = RLPEncoder.encodeUint256(vInt - 27);

207:             encodedListLength = RLPEncoder.encodeListLen(uint64(listLength));

276:             rEncoded = RLPEncoder.encodeUint256(rInt);

281:             sEncoded = RLPEncoder.encodeUint256(sInt);

288:             vEncoded = RLPEncoder.encodeUint256(vInt - 27);

302:             encodedListLength = RLPEncoder.encodeListLen(uint64(listLength));

71:                 encodedDataLength = RLPEncoder.encodeNonSingleBytesLen(txDataLen);

167:                 encodedDataLength = RLPEncoder.encodeNonSingleBytesLen(txDataLen);

262:                 encodedDataLength = RLPEncoder.encodeNonSingleBytesLen(txDataLen);

29:             txHash = keccak256(bytes.concat(signedTxHash, EfficientCall.keccak(_transaction.signature)));


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L52-L52) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L61-L61), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L62-L62), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L176-L176), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L271-L271), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L56-L56), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L57-L57), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L143-L143), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L144-L144), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L145-L145), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L146-L146), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L147-L147), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L148-L148), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L236-L236), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L237-L237), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L238-L238), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L239-L239), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L240-L240), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L241-L241), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L242-L242), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L82-L82), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L87-L87), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L100-L100), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L116-L116), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L181-L181), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L186-L186), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L193-L193), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L207-L207), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L276-L276), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L281-L281), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L288-L288), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L302-L302), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L71-L71), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L167-L167), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L262-L262), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L29-L29)


```solidity

File: contracts/Compressor.sol

73:         L1_MESSENGER_CONTRACT.sendToL1(_rawCompressedData);

74:         KNOWN_CODE_STORAGE_CONTRACT.markBytecodeAsPublished(bytecodeHash);

72:         bytecodeHash = Utils.hashL2Bytecode(_bytecode);

189:         stateDiffHash = EfficientCall.keccak(_stateDiffs);


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Compressor.sol#L73-L73) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Compressor.sol#L74-L74), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Compressor.sol#L72-L72), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Compressor.sol#L189-L189)


```solidity

File: contracts/ContractDeployer.sol

103:         bytes32 constructorInputHash = EfficientCall.keccak(_input);

168:         NONCE_HOLDER_SYSTEM_CONTRACT.incrementDeploymentNonce(msg.sender);

188:         uint256 senderNonce = NONCE_HOLDER_SYSTEM_CONTRACT.incrementDeploymentNonce(msg.sender);

302:         uint256 knownCodeMarker = KNOWN_CODE_STORAGE_CONTRACT.getMarker(_bytecodeHash);

311:         bytes32 constructingBytecodeHash = Utils.constructingBytecodeHash(_bytecodeHash);

312:         ACCOUNT_CODE_STORAGE_SYSTEM_CONTRACT.storeAccountConstructingCodeHash(_newAddress, constructingBytecodeHash);

49:             ACCOUNT_CODE_STORAGE_SYSTEM_CONTRACT.getRawCodeHash(_address) == 0

269:             ACCOUNT_CODE_STORAGE_SYSTEM_CONTRACT.getCodeHash(uint256(uint160(_newAddress))) == 0x0,

273:         require(NONCE_HOLDER_SYSTEM_CONTRACT.getRawNonce(_newAddress) == 0x00, "Account is occupied");

352:             ACCOUNT_CODE_STORAGE_SYSTEM_CONTRACT.storeAccountConstructedCodeHash(_newAddress, _bytecodeHash);

343:             bytes memory returnData = EfficientCall.mimicCall(gasleft(), _newAddress, _input, _sender, true, _isSystem);

345:             ACCOUNT_CODE_STORAGE_SYSTEM_CONTRACT.markAccountCodeHashAsConstructed(_newAddress);

333:                 BASE_TOKEN_SYSTEM_CONTRACT.transferFromTo(address(this), _newAddress, value);

341:                 SystemContractHelper.setValueForNextFarCall(uint128(value));


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L103-L103) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L168-L168), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L188-L188), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L302-L302), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L311-L311), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L312-L312), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L49-L49), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L269-L269), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L273-L273), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L352-L352), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L343-L343), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L345-L345), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L333-L333), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L341-L341)


```solidity

File: contracts/DefaultAccount.sol

46:         address codeAddress = SystemContractHelper.getCodeAddress();

149:         bool success = EfficientCall.rawCall(gas, to, value, data, isSystemCall);

151:             EfficientCall.propagateRevert();


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/DefaultAccount.sol#L46-L46) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/DefaultAccount.sol#L149-L149), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/DefaultAccount.sol#L151-L151)


```solidity

File: contracts/KnownCodesStorage.sol

78:         require(Utils.bytecodeLenInWords(_bytecodeHash) % 2 == 1, "Code length in words must be odd");

51:                 L1_MESSENGER_CONTRACT.requestBytecodeL1Publication(_bytecodeHash);


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/KnownCodesStorage.sol#L78-L78) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/KnownCodesStorage.sol#L51-L51)


```solidity

File: contracts/L1Messenger.sol

90:         SystemContractHelper.burnGas(Utils.safeCastToU32(gasToPay), 0);

154:         SystemContractHelper.burnGas(Utils.safeCastToU32(gasToPay), uint32(pubdataLen));

166:         uint256 bytecodeLen = Utils.bytecodeLenInBytes(_bytecodeHash);

179:         SystemContractHelper.burnGas(Utils.safeCastToU32(gasToPay), uint32(pubdataLen));

307:         bytes32 stateDiffHash = COMPRESSOR_CONTRACT.verifyCompressedStateDiffs(

317:         PUBDATA_CHUNK_PUBLISHER.chunkAndPublishPubdata(totalL2ToL1Pubdata);

320:         SystemContractHelper.toL1(true, bytes32(uint256(SystemLogKey.L2_TO_L1_LOGS_TREE_ROOT_KEY)), l2ToL1LogsTreeRoot);

321:         SystemContractHelper.toL1(

326:         SystemContractHelper.toL1(true, bytes32(uint256(SystemLogKey.STATE_DIFF_HASH_KEY)), stateDiffHash);

78:             txNumberInBlock: SYSTEM_CONTEXT_CONTRACT.txNumberInBlock(),

90:         SystemContractHelper.burnGas(Utils.safeCastToU32(gasToPay), 0);

118:         hash = EfficientCall.keccak(_message);

128:             txNumberInBlock: SYSTEM_CONTEXT_CONTRACT.txNumberInBlock(),

154:         SystemContractHelper.burnGas(Utils.safeCastToU32(gasToPay), uint32(pubdataLen));

179:         SystemContractHelper.burnGas(Utils.safeCastToU32(gasToPay), uint32(pubdataLen));

324:             EfficientCall.keccak(totalL2ToL1Pubdata)

207:             bytes32 hashedLog = EfficientCall.keccak(

239:             bytes32 hashedMessage = EfficientCall.keccak(

262:                     Utils.hashL2Bytecode(


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L90-L90) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L154-L154), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L166-L166), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L179-L179), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L307-L307), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L317-L317), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L320-L320), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L321-L321), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L326-L326), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L78-L78), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L90-L90), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L118-L118), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L128-L128), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L154-L154), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L179-L179), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L324-L324), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L207-L207), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L239-L239), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L262-L262)


```solidity

File: contracts/L2BaseToken.sol

77:         L1_MESSENGER_CONTRACT.sendToL1(message);

90:         L1_MESSENGER_CONTRACT.sendToL1(message);


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L2BaseToken.sol#L77-L77) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L2BaseToken.sol#L90-L90)


```solidity

File: contracts/MsgValueSimulator.sol

27:         uint256 addressAsUint = SystemContractHelper.getExtraAbiData(1);

28:         uint256 mask = SystemContractHelper.getExtraAbiData(2);

79:         SystemContractHelper.setValueForNextFarCall(Utils.safeCastToU128(value));

81:         return EfficientCall.mimicCall(userGas, to, _data, msg.sender, false, isSystemCall);

26:         value = SystemContractHelper.getExtraAbiData(0);

79:         SystemContractHelper.setValueForNextFarCall(Utils.safeCastToU128(value));


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/MsgValueSimulator.sol#L27-L27) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/MsgValueSimulator.sol#L28-L28), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/MsgValueSimulator.sol#L79-L79), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/MsgValueSimulator.sol#L81-L81), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/MsgValueSimulator.sol#L26-L26), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/MsgValueSimulator.sol#L79-L79)


```solidity

File: contracts/NonceHolder.sol

83:         IContractDeployer.AccountInfo memory accountInfo = DEPLOYER_SYSTEM_CONTRACT.getAccountInfo(msg.sender);


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/NonceHolder.sol#L83-L83) 


```solidity

File: contracts/PubdataChunkPublisher.sol

55:         SystemContractHelper.toL1(true, bytes32(uint256(SystemLogKey.BLOB_ONE_HASH_KEY)), blobHashes[0]);

56:         SystemContractHelper.toL1(true, bytes32(uint256(SystemLogKey.BLOB_TWO_HASH_KEY)), blobHashes[1]);


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/PubdataChunkPublisher.sol#L55-L55) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/PubdataChunkPublisher.sol#L56-L56)


```solidity

File: contracts/SystemContext.sol

418:         SystemContractHelper.toL1(

466:         SystemContractHelper.toL1(false, bytes32(uint256(SystemLogKey.PREV_BATCH_HASH_KEY)), _prevBatchHash);

118:         uint256 pubdataPublished = SystemContractHelper.getZkSyncMeta().pubdataPublished;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L418-L418) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L466-L466), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L118-L118)


```solidity

File: contracts/libraries/EfficientCall.sol

251:         SystemContractHelper.loadCalldataIntoActivePtr();

259:         SystemContractHelper.ptrAddIntoActive(uint32(dataOffset));

262:         SystemContractHelper.ptrShrinkIntoActive(shrinkTo);

264:         uint32 gas = Utils.safeCastToU32(_gas);

273:         SystemContractHelper.ptrPackIntoActivePtr(farCallAbi);


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L251-L251) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L259-L259), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L262-L262), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L264-L264), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L273-L273)


```solidity

File: contracts/libraries/SystemContractsCaller.sol

83:         uint32 dataLength = uint32(Utils.safeCastToU32(data.length));


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractsCaller.sol#L83-L83) 


```solidity

File: contracts/libraries/TransactionHelper.sol

155:         bytes memory encodedNonce = RLPEncoder.encodeUint256(_transaction.nonce);

164:         bytes memory encodedTo = RLPEncoder.encodeAddress(address(uint160(_transaction.to)));

165:         bytes memory encodedValue = RLPEncoder.encodeUint256(_transaction.value);

261:         bytes memory encodedAccessListLength = RLPEncoder.encodeListLen(0);

333:         bytes memory encodedAccessListLength = RLPEncoder.encodeListLen(0);

159:             bytes memory encodedGasPrice = RLPEncoder.encodeUint256(_transaction.maxFeePerGas);

160:             bytes memory encodedGasLimit = RLPEncoder.encodeUint256(_transaction.gasLimit);

228:             bytes memory encodedChainId = RLPEncoder.encodeUint256(block.chainid);

229:             bytes memory encodedNonce = RLPEncoder.encodeUint256(_transaction.nonce);

230:             bytes memory encodedGasPrice = RLPEncoder.encodeUint256(_transaction.maxFeePerGas);

231:             bytes memory encodedGasLimit = RLPEncoder.encodeUint256(_transaction.gasLimit);

232:             bytes memory encodedTo = RLPEncoder.encodeAddress(address(uint160(_transaction.to)));

233:             bytes memory encodedValue = RLPEncoder.encodeUint256(_transaction.value);

298:             bytes memory encodedChainId = RLPEncoder.encodeUint256(block.chainid);

299:             bytes memory encodedNonce = RLPEncoder.encodeUint256(_transaction.nonce);

300:             bytes memory encodedMaxPriorityFeePerGas = RLPEncoder.encodeUint256(_transaction.maxPriorityFeePerGas);

301:             bytes memory encodedMaxFeePerGas = RLPEncoder.encodeUint256(_transaction.maxFeePerGas);

302:             bytes memory encodedGasLimit = RLPEncoder.encodeUint256(_transaction.gasLimit);

303:             bytes memory encodedTo = RLPEncoder.encodeAddress(address(uint160(_transaction.to)));

304:             bytes memory encodedValue = RLPEncoder.encodeUint256(_transaction.value);

132:                 EfficientCall.keccak(_transaction.data),

134:                 EfficientCall.keccak(_transaction.paymasterInput)

199:             encodedListLength = RLPEncoder.encodeListLen(uint64(listLength));

271:             encodedListLength = RLPEncoder.encodeListLen(uint64(listLength));

343:             encodedListLength = RLPEncoder.encodeListLen(uint64(listLength));

174:                 encodedDataLength = RLPEncoder.encodeNonSingleBytesLen(txDataLen);

185:             encodedChainId = bytes.concat(RLPEncoder.encodeUint256(block.chainid), hex"80_80");

252:                 encodedDataLength = RLPEncoder.encodeNonSingleBytesLen(txDataLen);

324:                 encodedDataLength = RLPEncoder.encodeNonSingleBytesLen(txDataLen);


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L155-L155) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L164-L164), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L165-L165), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L261-L261), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L333-L333), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L159-L159), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L160-L160), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L228-L228), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L229-L229), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L230-L230), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L231-L231), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L232-L232), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L233-L233), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L298-L298), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L299-L299), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L300-L300), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L301-L301), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L302-L302), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L303-L303), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L304-L304), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L132-L132), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L134-L134), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L199-L199), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L271-L271), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L343-L343), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L174-L174), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L185-L185), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L252-L252), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L324-L324)


```solidity

File: contracts/libraries/Utils.sol

90:             EfficientCall.sha(_bytecode) &


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L90-L90) 


```solidity

File: contracts/interfaces/ISystemContract.sol

32:             SystemContractHelper.isSystemContract(msg.sender),

22:             SystemContractHelper.isSystemCall() || SystemContractHelper.isSystemContract(msg.sender),

22:             SystemContractHelper.isSystemCall() || SystemContractHelper.isSystemContract(msg.sender),


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ISystemContract.sol#L32-L32) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ISystemContract.sol#L22-L22), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ISystemContract.sol#L22-L22)


```solidity

File: contracts/bridge/L1ERC20Bridge.sol

79:         return L2ContractHelper.computeCreate2Address(l2Bridge, salt, l2TokenProxyBytecodeHash, constructorInputHash);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1ERC20Bridge.sol#L79-L79) 


```solidity

File: contracts/bridge/L1SharedBridge.sol

503:         (uint32 functionSignature, uint256 offset) = UnsafeBytes.readUint32(_l2ToL1message, 0);

506:             (l1Receiver, offset) = UnsafeBytes.readAddress(_l2ToL1message, offset);

507:             (amount, offset) = UnsafeBytes.readUint256(_l2ToL1message, offset);

518:             (l1Receiver, offset) = UnsafeBytes.readAddress(_l2ToL1message, offset);

519:             (l1Token, offset) = UnsafeBytes.readAddress(_l2ToL1message, offset);

520:             (amount, offset) = UnsafeBytes.readUint256(_l2ToL1message, offset);

580:                     ? AddressAliasHelper.applyL1ToL2Alias(_prevMsgSender)


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L503-L503) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L506-L506), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L507-L507), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L518-L518), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L519-L519), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L520-L520), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L580-L580)


```solidity

File: contracts/bridgehub/Bridgehub.sol

331:             _recipient = AddressAliasHelper.applyL1ToL2Alias(_refundRecipient);

328:             _recipient = msg.sender == tx.origin ? msg.sender : AddressAliasHelper.applyL1ToL2Alias(msg.sender);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L331-L331) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L328-L328)


```solidity

File: contracts/state-transition/StateTransitionManager.sol

220:         Diamond.DiamondCutData memory cutData = Diamond.DiamondCutData({


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L220-L220) 


```solidity

File: contracts/state-transition/chain-deps/DiamondProxy.sol

15:         Diamond.diamondCut(_diamondCut);

21:         Diamond.DiamondStorage storage diamondStorage = Diamond.getDiamondStorage();


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/DiamondProxy.sol#L15-L15) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/DiamondProxy.sol#L21-L21)


```solidity

File: contracts/state-transition/chain-deps/facets/Admin.sol

114:         Diamond.diamondCut(_diamondCut);

124:         Diamond.diamondCut(_diamondCut);

134:         Diamond.DiamondStorage storage diamondStorage = Diamond.getDiamondStorage();

144:         Diamond.DiamondStorage storage diamondStorage = Diamond.getDiamondStorage();


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Admin.sol#L114-L114) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Admin.sol#L124-L124), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Admin.sol#L134-L134), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Admin.sol#L144-L144)


```solidity

File: contracts/state-transition/chain-deps/facets/Executor.sol

612:         (bool success, bytes memory data) = POINT_EVALUATION_PRECOMPILE_ADDR.staticcall(precompileInput);

144:             (address logSender, ) = UnsafeBytes.readAddress(emittedL2Logs, i + L2_LOG_ADDRESS_OFFSET);

145:             (uint256 logKey, ) = UnsafeBytes.readUint256(emittedL2Logs, i + L2_LOG_KEY_OFFSET);

146:             (bytes32 logValue, ) = UnsafeBytes.readBytes32(emittedL2Logs, i + L2_LOG_VALUE_OFFSET);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L612-L612) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L144-L144), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L145-L145), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L146-L146)


```solidity

File: contracts/state-transition/chain-deps/facets/Getters.sol

158:         Diamond.DiamondStorage storage ds = Diamond.getDiamondStorage();

164:         Diamond.DiamondStorage storage ds = Diamond.getDiamondStorage();

182:         Diamond.DiamondStorage storage ds = Diamond.getDiamondStorage();

203:         Diamond.DiamondStorage storage ds = Diamond.getDiamondStorage();

218:         Diamond.DiamondStorage storage ds = Diamond.getDiamondStorage();

224:         Diamond.DiamondStorage storage ds = Diamond.getDiamondStorage();

230:         Diamond.DiamondStorage storage ds = Diamond.getDiamondStorage();


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L158-L158) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L164-L164), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L182-L182), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L203-L203), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L218-L218), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L224-L224), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L230-L230)


```solidity

File: contracts/state-transition/chain-deps/facets/Mailbox.sol

123:         bytes32 calculatedRootHash = Merkle.calculateRoot(_proof, _index, hashedLog);

174:         return Math.max(l2GasPrice, minL2GasPriceBaseToken);

325:         TransactionValidator.validateL1ToL2Transaction(

357:             bytes32 hashedBytecode = L2ContractHelper.hashL2Bytecode(_factoryDeps[i]);

235:             l2Sender = AddressAliasHelper.applyL1ToL2Alias(_request.sender);

278:             refundRecipient = AddressAliasHelper.applyL1ToL2Alias(refundRecipient);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L123-L123) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L174-L174), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L325-L325), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L357-L357), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L235-L235), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L278-L278)


```solidity

File: contracts/upgrades/BaseZkSyncUpgrade.sol

97:         L2ContractHelper.validateBytecodeHash(_l2DefaultAccountBytecodeHash);

114:         L2ContractHelper.validateBytecodeHash(_l2BootloaderBytecodeHash);

194:         TransactionValidator.validateL1ToL2Transaction(

201:         TransactionValidator.validateUpgradeTransaction(_l2ProtocolUpgradeTx);

228:                 L2ContractHelper.hashL2Bytecode(_factoryDeps[i]) == bytes32(_expectedHashes[i]),


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgrade.sol#L97-L97) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgrade.sol#L114-L114), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgrade.sol#L194-L194), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgrade.sol#L201-L201), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgrade.sol#L228-L228)


```solidity

File: contracts/state-transition/libraries/TransactionValidator.sol

136:         batchOverheadForTransaction = Math.max(batchOverheadForTransaction, overheadForLength);

83:             costForComputation += Math.ceilDiv(_encodingLength * L1_TX_DELTA_544_ENCODING_BYTES, 544);

89:             costForComputation = Math.max(costForComputation, L1_TX_MIN_L2_GAS_BASE);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/TransactionValidator.sol#L136-L136) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/TransactionValidator.sol#L83-L83), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/TransactionValidator.sol#L89-L89)


```solidity

File: contracts/bridge/L2SharedBridge.sol

132:         L2ContractHelper.sendMessageToL1(message);

153:             L2ContractHelper.computeCreate2Address(address(this), salt, l2TokenProxyBytecodeHash, constructorInputHash);

165:         (bool success, bytes memory returndata) = SystemContractsCaller.systemCallWithReturndata(

88:             AddressAliasHelper.undoL1ToL2Alias(msg.sender) == l1Bridge ||

89:                 AddressAliasHelper.undoL1ToL2Alias(msg.sender) == l1LegacyBridge,


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L132-L132) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L153-L153), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L165-L165), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L88-L88), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L89-L89)


</details>


### [NC&#x2011;116] Avoid using underscore at the end of a variable name 
The use of the underscore at the end of the variable name is unusual, consider refactoring it.


*There are 1 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/bridge/L2StandardERC20.sol

//@audit variable : `decimals_`
31:     uint8 private decimals_;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2StandardERC20.sol#L31-L31) 


</details>


### [NC&#x2011;117] [Solidity]: All `verbatim` blocks are considered identical by deduplicator and can incorrectly be unified 
The block deduplicator is a step of the opcode-based optimizer which identifies equivalent assembly blocks and merges them into a single one. However, when blocks contained `verbatim`, their comparison was performed incorrectly, leading to the collapse of assembly blocks which are identical except for the contents of the ``verbatim`` items. Since `verbatim` is only available in Yul, compilation of Solidity sources is not affected. For more details check the following [link](https://blog.soliditylang.org/2023/11/08/verbatim-invalid-deduplication-bug/)


*There are 103 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/AccountCodeStorage.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/AccountCodeStorage.sol#L3-L3) 


```solidity

File: contracts/BootloaderUtilities.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L3-L3) 


```solidity

File: contracts/ComplexUpgrader.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ComplexUpgrader.sol#L3-L3) 


```solidity

File: contracts/Compressor.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Compressor.sol#L3-L3) 


```solidity

File: contracts/Constants.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Constants.sol#L3-L3) 


```solidity

File: contracts/ContractDeployer.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L3-L3) 


```solidity

File: contracts/DefaultAccount.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/DefaultAccount.sol#L3-L3) 


```solidity

File: contracts/EmptyContract.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/EmptyContract.sol#L3-L3) 


```solidity

File: contracts/ImmutableSimulator.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ImmutableSimulator.sol#L3-L3) 


```solidity

File: contracts/KnownCodesStorage.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/KnownCodesStorage.sol#L3-L3) 


```solidity

File: contracts/L1Messenger.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L3-L3) 


```solidity

File: contracts/L2BaseToken.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L2BaseToken.sol#L3-L3) 


```solidity

File: contracts/MsgValueSimulator.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/MsgValueSimulator.sol#L3-L3) 


```solidity

File: contracts/NonceHolder.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/NonceHolder.sol#L3-L3) 


```solidity

File: contracts/PubdataChunkPublisher.sol

2: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/PubdataChunkPublisher.sol#L2-L2) 


```solidity

File: contracts/SystemContext.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L3-L3) 


```solidity

File: contracts/libraries/EfficientCall.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L3-L3) 


```solidity

File: contracts/libraries/RLPEncoder.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/RLPEncoder.sol#L3-L3) 


```solidity

File: contracts/libraries/SystemContractHelper.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L3-L3) 


```solidity

File: contracts/libraries/SystemContractsCaller.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractsCaller.sol#L3-L3) 


```solidity

File: contracts/libraries/TransactionHelper.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L3-L3) 


```solidity

File: contracts/libraries/UnsafeBytesCalldata.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/UnsafeBytesCalldata.sol#L3-L3) 


```solidity

File: contracts/libraries/Utils.sol

2: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L2-L2) 


```solidity

File: contracts/interfaces/IAccount.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IAccount.sol#L3-L3) 


```solidity

File: contracts/interfaces/IAccountCodeStorage.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IAccountCodeStorage.sol#L3-L3) 


```solidity

File: contracts/interfaces/IBaseToken.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IBaseToken.sol#L3-L3) 


```solidity

File: contracts/interfaces/IBootloaderUtilities.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IBootloaderUtilities.sol#L3-L3) 


```solidity

File: contracts/interfaces/IComplexUpgrader.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IComplexUpgrader.sol#L3-L3) 


```solidity

File: contracts/interfaces/ICompressor.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ICompressor.sol#L3-L3) 


```solidity

File: contracts/interfaces/IContractDeployer.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IContractDeployer.sol#L3-L3) 


```solidity

File: contracts/interfaces/IImmutableSimulator.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IImmutableSimulator.sol#L3-L3) 


```solidity

File: contracts/interfaces/IKnownCodesStorage.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IKnownCodesStorage.sol#L3-L3) 


```solidity

File: contracts/interfaces/IL1Messenger.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IL1Messenger.sol#L3-L3) 


```solidity

File: contracts/interfaces/IL2StandardToken.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IL2StandardToken.sol#L3-L3) 


```solidity

File: contracts/interfaces/IMailbox.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IMailbox.sol#L3-L3) 


```solidity

File: contracts/interfaces/INonceHolder.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/INonceHolder.sol#L3-L3) 


```solidity

File: contracts/interfaces/IPaymaster.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IPaymaster.sol#L3-L3) 


```solidity

File: contracts/interfaces/IPaymasterFlow.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IPaymasterFlow.sol#L3-L3) 


```solidity

File: contracts/interfaces/IPubdataChunkPublisher.sol

2: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IPubdataChunkPublisher.sol#L2-L2) 


```solidity

File: contracts/interfaces/ISystemContext.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ISystemContext.sol#L3-L3) 


```solidity

File: contracts/interfaces/ISystemContextDeprecated.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ISystemContextDeprecated.sol#L3-L3) 


```solidity

File: contracts/interfaces/ISystemContract.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ISystemContract.sol#L3-L3) 


```solidity

File: contracts/bridge/L1ERC20Bridge.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1ERC20Bridge.sol#L3-L3) 


```solidity

File: contracts/bridge/L1SharedBridge.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L3-L3) 


```solidity

File: contracts/bridgehub/Bridgehub.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L3-L3) 


```solidity

File: contracts/governance/Governance.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/Governance.sol#L3-L3) 


```solidity

File: contracts/state-transition/StateTransitionManager.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L3-L3) 


```solidity

File: contracts/state-transition/ValidatorTimelock.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L3-L3) 


```solidity

File: contracts/state-transition/chain-deps/DiamondInit.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/DiamondInit.sol#L3-L3) 


```solidity

File: contracts/state-transition/chain-deps/DiamondProxy.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/DiamondProxy.sol#L3-L3) 


```solidity

File: contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L3-L3) 


```solidity

File: contracts/state-transition/chain-deps/facets/Admin.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Admin.sol#L3-L3) 


```solidity

File: contracts/state-transition/chain-deps/facets/Executor.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L3-L3) 


```solidity

File: contracts/state-transition/chain-deps/facets/Getters.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L3-L3) 


```solidity

File: contracts/state-transition/chain-deps/facets/Mailbox.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L3-L3) 


```solidity

File: contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L3-L3) 


```solidity

File: contracts/upgrades/BaseZkSyncUpgrade.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgrade.sol#L3-L3) 


```solidity

File: contracts/upgrades/BaseZkSyncUpgradeGenesis.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L3-L3) 


```solidity

File: contracts/upgrades/DefaultUpgrade.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/DefaultUpgrade.sol#L3-L3) 


```solidity

File: contracts/upgrades/GenesisUpgrade.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/GenesisUpgrade.sol#L3-L3) 


```solidity

File: contracts/common/libraries/L2ContractHelper.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/L2ContractHelper.sol#L3-L3) 


```solidity

File: contracts/common/libraries/UncheckedMath.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/UncheckedMath.sol#L3-L3) 


```solidity

File: contracts/common/libraries/UnsafeBytes.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/UnsafeBytes.sol#L3-L3) 


```solidity

File: contracts/state-transition/libraries/Diamond.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L3-L3) 


```solidity

File: contracts/state-transition/libraries/LibMap.sol

2: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/LibMap.sol#L2-L2) 


```solidity

File: contracts/state-transition/libraries/Merkle.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Merkle.sol#L3-L3) 


```solidity

File: contracts/state-transition/libraries/PriorityQueue.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/PriorityQueue.sol#L3-L3) 


```solidity

File: contracts/state-transition/libraries/TransactionValidator.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/TransactionValidator.sol#L3-L3) 


```solidity

File: contracts/bridge/interfaces/IL1ERC20Bridge.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1ERC20Bridge.sol#L3-L3) 


```solidity

File: contracts/bridge/interfaces/IL1SharedBridge.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L3-L3) 


```solidity

File: contracts/bridge/interfaces/IL2Bridge.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL2Bridge.sol#L3-L3) 


```solidity

File: contracts/bridge/interfaces/IWETH9.sol

2: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IWETH9.sol#L2-L2) 


```solidity

File: contracts/bridgehub/IBridgehub.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L3-L3) 


```solidity

File: contracts/common/interfaces/IL2ContractDeployer.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/interfaces/IL2ContractDeployer.sol#L3-L3) 


```solidity

File: contracts/governance/IGovernance.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/IGovernance.sol#L3-L3) 


```solidity

File: contracts/state-transition/IStateTransitionManager.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/IStateTransitionManager.sol#L3-L3) 


```solidity

File: contracts/state-transition/chain-interfaces/IAdmin.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IAdmin.sol#L3-L3) 


```solidity

File: contracts/state-transition/chain-interfaces/IDiamondInit.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IDiamondInit.sol#L3-L3) 


```solidity

File: contracts/state-transition/chain-interfaces/IExecutor.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IExecutor.sol#L3-L3) 


```solidity

File: contracts/state-transition/chain-interfaces/IGetters.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IGetters.sol#L3-L3) 


```solidity

File: contracts/state-transition/chain-interfaces/ILegacyGetters.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/ILegacyGetters.sol#L3-L3) 


```solidity

File: contracts/state-transition/chain-interfaces/IMailbox.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IMailbox.sol#L3-L3) 


```solidity

File: contracts/state-transition/chain-interfaces/IVerifier.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IVerifier.sol#L3-L3) 


```solidity

File: contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol#L3-L3) 


```solidity

File: contracts/state-transition/chain-interfaces/IZkSyncStateTransitionBase.sol

2: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IZkSyncStateTransitionBase.sol#L2-L2) 


```solidity

File: contracts/upgrades/IDefaultUpgrade.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/IDefaultUpgrade.sol#L3-L3) 


```solidity

File: contracts/common/Config.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/Config.sol#L3-L3) 


```solidity

File: contracts/common/L2ContractAddresses.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/L2ContractAddresses.sol#L3-L3) 


```solidity

File: contracts/common/Messaging.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/Messaging.sol#L3-L3) 


```solidity

File: contracts/common/ReentrancyGuard.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/ReentrancyGuard.sol#L3-L3) 


```solidity

File: contracts/vendor/AddressAliasHelper.sol

19: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/vendor/AddressAliasHelper.sol#L19-L19) 


```solidity

File: contracts/bridge/L2SharedBridge.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L3-L3) 


```solidity

File: contracts/bridge/L2StandardERC20.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2StandardERC20.sol#L3-L3) 


```solidity

File: contracts/bridge/interfaces/IL1ERC20Bridge.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL1ERC20Bridge.sol#L3-L3) 


```solidity

File: contracts/bridge/interfaces/IL1SharedBridge.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL1SharedBridge.sol#L3-L3) 


```solidity

File: contracts/bridge/interfaces/IL2SharedBridge.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL2SharedBridge.sol#L3-L3) 


```solidity

File: contracts/bridge/interfaces/IL2StandardToken.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL2StandardToken.sol#L3-L3) 


```solidity

File: contracts/interfaces/IPaymaster.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/interfaces/IPaymaster.sol#L3-L3) 


```solidity

File: contracts/interfaces/IPaymasterFlow.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/interfaces/IPaymasterFlow.sol#L3-L3) 


```solidity

File: contracts/vendor/AddressAliasHelper.sol

19: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/vendor/AddressAliasHelper.sol#L19-L19) 


```solidity

File: contracts/ForceDeployUpgrader.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/ForceDeployUpgrader.sol#L3-L3) 


```solidity

File: contracts/L2ContractHelper.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/L2ContractHelper.sol#L3-L3) 


```solidity

File: contracts/SystemContractsCaller.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/SystemContractsCaller.sol#L3-L3) 


</details>


### [NC&#x2011;118] [NatSpec] Natspec `@param` is missing from `error` 



*There are 414 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/ContractDeployer.sol

33:     /// @notice Returns information about a certain account.

38:     /// @notice Returns the account abstraction version if `_address` is a deployed contract.
39:     /// Returns the latest supported account abstraction version if `_address` is an EOA.

57:     /// @notice Stores the new account information

235:     /// @notice This method is to be used only during an upgrade to set bytecodes on specific addresses.
236:     /// @dev We do not require `onlySystemCall` here, since the method is accessible only
237:     /// by `FORCE_DEPLOYER`.

258:     function _nonSystemDeployOnAddress(

300:     /// @notice Check that bytecode hash is marked as known on the `KnownCodeStorage` system contracts

196:     /// @notice A struct that describes a forced deployment on an address


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L33-L33) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L38-L39), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L57-L57), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L235-L237), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L258-L258), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L300-L300), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L196-L196)


```solidity

File: contracts/KnownCodesStorage.sol

63:     /// @notice Returns the marker stored for a bytecode hash. 1 means that the bytecode hash is known
64:     /// and can be used for deploying contracts. 0 otherwise.

71:     /// @notice Validates the format of bytecodehash
72:     /// @dev zk-circuit accepts & handles only valid format of bytecode hash, other input has undefined behavior
73:     /// That's why we need to validate it


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/KnownCodesStorage.sol#L63-L64) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/KnownCodesStorage.sol#L71-L73)


```solidity

File: contracts/L1Messenger.sol

49:     /// The gas cost of calculation of keccak256 of bytes array of such length.

60:     /// The gas cost of calculation of sha256 of bytes array of such length.

93:     /// @notice Internal function to send L2ToL1Log.


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L49-L49) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L60-L60), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L93-L93)


```solidity

File: contracts/L2BaseToken.sol

111:     /// @dev Get the message to be sent to L1 to initiate a withdrawal.

116:     /// @dev Get the message to be sent to L1 to initiate a withdrawal.


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L2BaseToken.sol#L111-L111) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L2BaseToken.sol#L116-L116)


```solidity

File: contracts/SystemContext.sol

109:     /// @notice Sets the number of L2 gas that is needed to pay a single byte of pubdata.
110:     /// @dev This value does not have any impact on the execution and purely serves as a way for users
111:     /// to access the current gas price for the pubdata.

126:     /// @notice The method that emulates `blockhash` opcode in EVM.
127:     /// @dev Just like the blockhash in the EVM, it returns bytes32(0),
128:     /// when queried about hashes that are older than 256 blocks ago.
129:     /// @dev Since zksolc compiler calls this method to emulate `blockhash`,
130:     /// its signature can not be changed to `getL2BlockHashEVM`.
131:     /// @return hash The blockhash of the block with the given number.

469:     /// @notice A testing method that manually sets the current blocks' number and timestamp.
470:     /// @dev Should be used only for testing / ethCalls and should never be used in production.

507:     /// @notice Returns the hash of the given batch.
508:     /// @dev Deprecated in favor of getBatchHash.


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L109-L111) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L126-L131), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L469-L470), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L507-L508)


```solidity

File: contracts/libraries/RLPEncoder.sol

11:     function encodeAddress(address _val) internal pure returns (bytes memory encoded) {

24:     function encodeUint256(uint256 _val) internal pure returns (bytes memory encoded) {

60:     function _encodeLength(uint64 _len, uint256 _offset) private pure returns (bytes memory encoded) {

81:     /// @notice Computes the index of the highest byte set in number.
82:     /// @notice Uses little endian ordering (The least significant byte has index `0`).
83:     /// NOTE: returns `0` for `0`


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/RLPEncoder.sol#L11-L11) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/RLPEncoder.sol#L24-L24), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/RLPEncoder.sol#L60-L60), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/RLPEncoder.sol#L81-L83)


```solidity

File: contracts/libraries/SystemContractHelper.sol

81:     /// @notice Compiler simulation of the `ptr.pack` opcode for the virtual `ACTIVE_PTR` pointer.
82:     /// @dev Do the concatenation between lowest part of `ACTIVE_PTR` and highest part of `_farCallAbi`
83:     /// forming packed fat pointer for a far call or ret ABI when necessary.
84:     /// Note: Panics if the lowest 128 bits of `_farCallAbi` are not zeroes.

92:     /// @notice Compiler simulation of the `ptr.add` opcode for the virtual `ACTIVE_PTR` pointer.
93:     /// @dev Transforms `ACTIVE_PTR.offset` into `ACTIVE_PTR.offset + u32(_value)`. If overflow happens then it panics.

104:     /// @notice Compiler simulation of the `ptr.shrink` opcode for the virtual `ACTIVE_PTR` pointer.
105:     /// @dev Transforms `ACTIVE_PTR.length` into `ACTIVE_PTR.length - u32(_shrink)`. If underflow happens then it panics.

314:     /// @notice Returns the N-th extraAbiParam for the current call.
315:     /// @return extraAbiData The value of the N-th extraAbiParam for this call.
316:     /// @dev It is equal to the value of the (N+2)-th register
317:     /// at the start of the call.

14: /// @notice NOTE: The `getZkSyncMeta` that is used to obtain this struct will experience a breaking change in 2024.
15: struct ZkSyncMeta {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L81-L84) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L92-L93), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L104-L105), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L314-L317), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L14-L15)


```solidity

File: contracts/libraries/TransactionHelper.sol

98:     /// @notice Calculate the suggested signed hash of the transaction,
99:     /// i.e. the hash that is signed by EOAs and is recommended to be signed by other accounts.

116:     /// @notice Encode hash of the zkSync native transaction type.
117:     /// @return keccak256 hash of the EIP-712 encoded representation of transaction

145:     /// @notice Encode hash of the legacy transaction type.
146:     /// @return keccak256 of the serialized RLP encoded representation of transaction

217:     /// @notice Encode hash of the EIP2930 transaction type.
218:     /// @return keccak256 of the serialized RLP encoded representation of transaction

287:     /// @notice Encode hash of the EIP1559 transaction type.
288:     /// @return keccak256 of the serialized RLP encoded representation of transaction

359:     /// @notice Processes the common paymaster flows, e.g. setting proper allowance
360:     /// for tokens, etc. For more information on the expected behavior, check out
361:     /// the "Paymaster flows" section in the documentation.

392:     /// @notice Pays the required fee for the transaction to the bootloader.
393:     /// @dev Currently it pays the maximum amount "_transaction.maxFeePerGas * _transaction.gasLimit",
394:     /// it will change in the future.

405:     function totalRequiredBalance(Transaction calldata _transaction) internal pure returns (uint256 requiredBalance) {

24: /// @notice Structure used to represent a zkSync transaction.
25: struct Transaction {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L98-L99) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L116-L117), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L145-L146), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L217-L218), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L287-L288), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L359-L361), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L392-L394), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L405-L405), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L24-L25)


```solidity

File: contracts/libraries/UnsafeBytesCalldata.sol

19:     function readUint16(bytes calldata _bytes, uint256 _start) internal pure returns (uint16 result) {

26:     function readUint32(bytes calldata _bytes, uint256 _start) internal pure returns (uint32 result) {

33:     function readUint64(bytes calldata _bytes, uint256 _start) internal pure returns (uint64 result) {

40:     function readBytes32(bytes calldata _bytes, uint256 _start) internal pure returns (bytes32 result) {

46:     function readUint256(bytes calldata _bytes, uint256 _start) internal pure returns (uint256 result) {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/UnsafeBytesCalldata.sol#L19-L19) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/UnsafeBytesCalldata.sol#L26-L26), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/UnsafeBytesCalldata.sol#L33-L33), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/UnsafeBytesCalldata.sol#L40-L40), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/UnsafeBytesCalldata.sol#L46-L46)


```solidity

File: contracts/libraries/Utils.sol

20:     function safeCastToU128(uint256 _x) internal pure returns (uint128) {

26:     function safeCastToU32(uint256 _x) internal pure returns (uint32) {

32:     function safeCastToU24(uint256 _x) internal pure returns (uint24) {

38:     /// @return codeLength The bytecode length in bytes

43:     /// @return codeLengthInWords The bytecode length in machine words

50:     /// @notice Denotes whether bytecode hash corresponds to a contract that already constructed

55:     /// @notice Denotes whether bytecode hash corresponds to a contract that is on constructor or has already been constructed


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L20-L20) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L26-L26), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L32-L32), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L38-L38), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L43-L43), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L50-L50), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L55-L55)


```solidity

File: contracts/interfaces/IAccount.sol

26:     function executeTransaction(

34:     function executeTransactionFromOutside(Transaction calldata _transaction) external payable;

36:     function payForTransaction(

42:     function prepareForPaymaster(


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IAccount.sol#L26-L26) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IAccount.sol#L34-L34), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IAccount.sol#L36-L36), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IAccount.sol#L42-L42)


```solidity

File: contracts/interfaces/IAccountCodeStorage.sol

6:     function storeAccountConstructingCodeHash(address _address, bytes32 _hash) external;

8:     function storeAccountConstructedCodeHash(address _address, bytes32 _hash) external;

10:     function markAccountCodeHashAsConstructed(address _address) external;

12:     function getRawCodeHash(address _address) external view returns (bytes32 codeHash);

14:     function getCodeHash(uint256 _input) external view returns (bytes32 codeHash);

16:     function getCodeSize(uint256 _input) external view returns (uint256 codeSize);


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IAccountCodeStorage.sol#L6-L6) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IAccountCodeStorage.sol#L8-L8), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IAccountCodeStorage.sol#L10-L10), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IAccountCodeStorage.sol#L12-L12), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IAccountCodeStorage.sol#L14-L14), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IAccountCodeStorage.sol#L16-L16)


```solidity

File: contracts/interfaces/IBaseToken.sol

6:     function balanceOf(uint256) external view returns (uint256);

8:     function transferFromTo(address _from, address _to, uint256 _amount) external;

18:     function mint(address _account, uint256 _amount) external;

20:     function withdraw(address _l1Receiver) external payable;

22:     function withdrawWithMessage(address _l1Receiver, bytes calldata _additionalData) external payable;

24:     event Mint(address indexed account, uint256 amount);

26:     event Transfer(address indexed from, address indexed to, uint256 value);

28:     event Withdrawal(address indexed _l2Sender, address indexed _l1Receiver, uint256 _amount);

30:     event WithdrawalWithMessage(


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IBaseToken.sol#L6-L6) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IBaseToken.sol#L8-L8), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IBaseToken.sol#L18-L18), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IBaseToken.sol#L20-L20), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IBaseToken.sol#L22-L22), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IBaseToken.sol#L24-L24), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IBaseToken.sol#L26-L26), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IBaseToken.sol#L28-L28), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IBaseToken.sol#L30-L30)


```solidity

File: contracts/interfaces/IBootloaderUtilities.sol

8:     function getTransactionHashes(


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IBootloaderUtilities.sol#L8-L8) 


```solidity

File: contracts/interfaces/IComplexUpgrader.sol

11:     function upgrade(address _delegateTo, bytes calldata _calldata) external payable;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IComplexUpgrader.sol#L11-L11) 


```solidity

File: contracts/interfaces/ICompressor.sol

19:     function publishCompressedBytecode(

24:     function verifyCompressedStateDiffs(


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ICompressor.sol#L19-L19) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ICompressor.sol#L24-L24)


```solidity

File: contracts/interfaces/IContractDeployer.sol

33:     event ContractDeployed(

39:     event AccountNonceOrderingUpdated(address indexed accountAddress, AccountNonceOrdering nonceOrdering);

41:     event AccountVersionUpdated(address indexed accountAddress, AccountAbstractionVersion aaVersion);

43:     function getNewAddressCreate2(

50:     function getNewAddressCreate(address _sender, uint256 _senderNonce) external pure returns (address newAddress);

52:     function create2(

58:     function create2Account(

65:     /// @dev While the `_salt` parameter is not used anywhere here,
66:     /// it is still needed for consistency between `create` and
67:     /// `create2` functions (required by the compiler).

74:     /// @dev While `_salt` is never used here, we leave it here as a parameter
75:     /// for the consistency with the `create` function.

83:     /// @notice Returns the information about a certain AA.

86:     /// @notice Can be called by an account to update its account version

89:     /// @notice Can be called by an account to update its nonce ordering

28:     struct AccountInfo {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IContractDeployer.sol#L33-L33) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IContractDeployer.sol#L39-L39), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IContractDeployer.sol#L41-L41), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IContractDeployer.sol#L43-L43), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IContractDeployer.sol#L50-L50), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IContractDeployer.sol#L52-L52), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IContractDeployer.sol#L58-L58), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IContractDeployer.sol#L65-L67), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IContractDeployer.sol#L74-L75), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IContractDeployer.sol#L83-L83), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IContractDeployer.sol#L86-L86), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IContractDeployer.sol#L89-L89), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IContractDeployer.sol#L28-L28)


```solidity

File: contracts/interfaces/IImmutableSimulator.sol

11:     function getImmutable(address _dest, uint256 _index) external view returns (bytes32);

13:     function setImmutables(address _dest, ImmutableData[] calldata _immutables) external;

5: struct ImmutableData {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IImmutableSimulator.sol#L11-L11) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IImmutableSimulator.sol#L13-L13), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IImmutableSimulator.sol#L5-L5)


```solidity

File: contracts/interfaces/IKnownCodesStorage.sol

12:     event MarkedAsKnown(bytes32 indexed bytecodeHash, bool indexed sendBytecodeToL1);

14:     function markFactoryDeps(bool _shouldSendToL1, bytes32[] calldata _hashes) external;

16:     function markBytecodeAsPublished(bytes32 _bytecodeHash) external;

18:     function getMarker(bytes32 _hash) external view returns (uint256);


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IKnownCodesStorage.sol#L12-L12) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IKnownCodesStorage.sol#L14-L14), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IKnownCodesStorage.sol#L16-L16), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IKnownCodesStorage.sol#L18-L18)


```solidity

File: contracts/interfaces/IL1Messenger.sol

43:     event L1MessageSent(address indexed _sender, bytes32 indexed _hash, bytes _message);

45:     event L2ToL1LogSent(L2ToL1Log _l2log);

47:     event BytecodeL1PublicationRequested(bytes32 _bytecodeHash);

49:     function sendToL1(bytes memory _message) external returns (bytes32);

51:     function sendL2ToL1Log(bool _isService, bytes32 _key, bytes32 _value) external returns (uint256 logIdInMerkleTree);

54:     function requestBytecodeL1Publication(bytes32 _bytecodeHash) external;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IL1Messenger.sol#L43-L43) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IL1Messenger.sol#L45-L45), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IL1Messenger.sol#L47-L47), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IL1Messenger.sol#L49-L49), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IL1Messenger.sol#L51-L51), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IL1Messenger.sol#L54-L54)


```solidity

File: contracts/interfaces/IL2StandardToken.sol

6:     event BridgeMint(address indexed _account, uint256 _amount);

8:     event BridgeBurn(address indexed _account, uint256 _amount);

10:     function bridgeMint(address _account, uint256 _amount) external;

12:     function bridgeBurn(address _account, uint256 _amount) external;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IL2StandardToken.sol#L6-L6) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IL2StandardToken.sol#L8-L8), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IL2StandardToken.sol#L10-L10), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IL2StandardToken.sol#L12-L12)


```solidity

File: contracts/interfaces/IMailbox.sol

6:     function finalizeEthWithdrawal(


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IMailbox.sol#L6-L6) 


```solidity

File: contracts/interfaces/INonceHolder.sol

14:     event ValueSetUnderNonce(address indexed accountAddress, uint256 indexed key, uint256 value);

16:     /// @dev Returns the current minimal nonce for account.

19:     /// @dev Returns the raw version of the current minimal nonce
20:     /// (equal to minNonce + 2^128 * deployment nonce).

23:     /// @dev Increases the minimal nonce for the msg.sender.

26:     /// @dev Sets the nonce value `key` as used.

29:     /// @dev Gets the value stored inside a custom nonce.

32:     /// @dev A convenience method to increment the minimal nonce if it is equal
33:     /// to the `_expectedNonce`.

36:     /// @dev Returns the deployment nonce for the accounts used for CREATE opcode.

39:     /// @dev Increments the deployment nonce for the account and returns the previous one.

42:     /// @dev Determines whether a certain nonce has been already used for an account.

45:     /// @dev Returns whether a nonce has been used for an account.


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/INonceHolder.sol#L14-L14) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/INonceHolder.sol#L16-L16), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/INonceHolder.sol#L19-L20), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/INonceHolder.sol#L23-L23), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/INonceHolder.sol#L26-L26), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/INonceHolder.sol#L29-L29), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/INonceHolder.sol#L32-L33), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/INonceHolder.sol#L36-L36), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/INonceHolder.sol#L39-L39), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/INonceHolder.sol#L42-L42), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/INonceHolder.sol#L45-L45)


```solidity

File: contracts/interfaces/IPaymasterFlow.sol

13:     function general(bytes calldata input) external;

15:     function approvalBased(address _token, uint256 _minAllowance, bytes calldata _innerInput) external;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IPaymasterFlow.sol#L13-L13) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IPaymasterFlow.sol#L15-L15)


```solidity

File: contracts/interfaces/ISystemContext.sol

46:     function getBlockHashEVM(uint256 _block) external view returns (bytes32);

48:     function getBatchHash(uint256 _batchNumber) external view returns (bytes32 hash);

12:     struct BlockInfo {

17:     /// @notice A structure representing the timeline for the upgrade from the batch numbers to the L2 block numbers.
18:     /// @dev It will used for the L1 batch -> L2 block migration in Q3 2023 only.


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ISystemContext.sol#L46-L46) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ISystemContext.sol#L48-L48), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ISystemContext.sol#L12-L12), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ISystemContext.sol#L17-L18)


```solidity

File: contracts/interfaces/ISystemContextDeprecated.sol

15:     function blockHash(uint256 _blockNumber) external view returns (bytes32 hash);


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ISystemContextDeprecated.sol#L15-L15) 


```solidity

File: contracts/interfaces/ISystemContract.sol

38:     /// @notice Modifier that makes sure that the method
39:     /// can only be called from a special given address.


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ISystemContract.sol#L38-L39) 


```solidity

File: contracts/bridge/L1ERC20Bridge.sol

53:     /// @dev Contract is expected to be used as proxy implementation.
54:     /// @dev Initialize the implementation to prevent Parity hack.

62:     /// @dev transfer token to shared bridge as part of upgrade

74:     /// @return The L2 token address that would be minted for deposit of the given L1 token on zkSync Era.

158:     /// @dev Transfers tokens from the depositor address to the shared bridge address.
159:     /// @return The difference between the contract balance before and after the transferring of funds.


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1ERC20Bridge.sol#L53-L54) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1ERC20Bridge.sol#L62-L62), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1ERC20Bridge.sol#L74-L74), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1ERC20Bridge.sol#L158-L159)


```solidity

File: contracts/bridge/L1SharedBridge.sol

73:     /// @notice Checks that the message sender is the bridgehub or zkSync Era Diamond Proxy.

88:     /// @dev Contract is expected to be used as proxy implementation.
89:     /// @dev Initialize the implementation to prevent Parity hack.

115:     /// @dev tranfer tokens from legacy erc20 bridge or mailbox and set chainBalance as part of migration process

137:     function receiveEth(uint256 _chainId) external payable {

141:     /// @dev Initializes the l2Bridge address by governance for a specific chain.

146:     /// @notice Allows bridgehub to acquire mintValue for L1->L2 transactions.
147:     /// @dev If the corresponding L2 transaction fails, refunds are issued to a refund recipient on L2.

171:     /// @dev Transfers tokens from the depositor address to the smart contract address.
172:     /// @return The difference between the contract balance before and after the transferring of funds.

181:     /// @notice Initiates a deposit transaction within Bridgehub, used by `requestL2TransactionTwoBridges`.

230:     /// @notice Confirms the acceptance of a transaction by the Mailbox, as part of the L2 transaction process within Bridgehub.
231:     /// This function is utilized by `requestL2TransactionTwoBridges` to validate the execution of a transaction.

242:     /// @dev Generate a calldata for calling the deposit finalization on the L2 bridge contract

253:     /// @dev Receives and parses (name, symbol, decimals) from the token contract

302:     /// @dev Processes claims of failed deposit, whether they originated from the legacy bridge or the current system.

407:     /// @dev Internal function that handles the logic for finalizing withdrawals,
408:     /// serving both the current bridge system and the legacy ERC20 bridge.

457:     /// @dev Verifies the validity of a withdrawal message from L2 and returns details of the withdrawal.

487:     function _parseL2WithdrawalMessage(

401:     struct MessageParams {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L73-L73) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L88-L89), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L115-L115), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L137-L137), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L141-L141), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L146-L147), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L171-L172), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L181-L181), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L230-L231), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L242-L242), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L253-L253), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L302-L302), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L407-L408), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L457-L457), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L487-L487), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L401-L401)


```solidity

File: contracts/bridgehub/Bridgehub.sol

40:     /// @notice used to initialize the contract

74:     /// @notice return the state transition chain contract for a chainId

81:     /// @notice State Transition can be any contract with the appropriate interface/functionality

90:     /// @notice State Transition can be any contract with the appropriate interface/functionality
91:     /// @notice this stops new Chains from using the STF, old chains are not affected

100:     /// @notice token can be any contract with the appropriate interface/functionality

106:     /// @notice To set shared bridge, only Owner. Not done in initialize, as
107:     /// the order of deployment is Bridgehub, Shared bridge, and then we call this

112:     /// @notice register new chain
113:     /// @notice for Eth the baseToken address is 1

151:     /// @notice forwards function call to Mailbox based on ChainId

163:     /// @notice forwards function call to Mailbox based on ChainId

175:     /// @notice forwards function call to Mailbox based on ChainId

197:     /// @notice forwards function call to Mailbox based on ChainId

213:     /// @notice the mailbox is called directly after the sharedBridge received the deposit
214:     /// this assumes that either ether is the base token or
215:     /// the msg.sender has approved mintValue allowance for the sharedBridge.
216:     /// This means this is not ideal for contract calls, as the contract would have to handle token allowance of the base Token

253:     /// @notice After depositing funds to the sharedBridge, the secondBridge is called
254:     ///  to return the actual L2 message which is sent to the Mailbox.
255:     ///  This assumes that either ether is the base token or
256:     ///  the msg.sender has approved the sharedBridge with the mintValue,
257:     ///  and also the necessary approvals are given for the second bridge.
258:     /// @notice The logic of this bridge is to allow easy depositing for bridges.
259:     /// Each contract that handles the users ERC20 tokens needs approvals from the user, this contract allows
260:     /// the user to approve for each token only its respective bridge
261:     /// @notice This function is great for contract calls to L2, the secondBridge can be any contract.

325:     function _actualRefundRecipient(address _refundRecipient) internal view returns (address _recipient) {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L40-L40) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L74-L74), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L81-L81), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L90-L91), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L100-L100), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L106-L107), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L112-L113), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L151-L151), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L163-L163), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L175-L175), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L197-L197), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L213-L216), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L253-L261), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L325-L325)


```solidity

File: contracts/governance/Governance.sol

82:     /// @dev Returns whether an id corresponds to a registered operation. This
83:     /// includes Waiting, Ready, and Done operations.

88:     /// @dev Returns whether an operation is pending or not. Note that a "pending" operation may also be "ready".

94:     /// @dev Returns whether an operation is ready for execution. Note that a "ready" operation is also "pending".

99:     /// @dev Returns whether an operation is done or not.

104:     /// @dev Returns operation state.


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/Governance.sol#L82-L83) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/Governance.sol#L88-L88), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/Governance.sol#L94-L94), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/Governance.sol#L99-L99), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/Governance.sol#L104-L104)


```solidity

File: contracts/state-transition/StateTransitionManager.sol

56:     /// @dev Contract is expected to be used as proxy implementation.
57:     /// @dev Initialize the implementation to prevent Parity hack.

74:     function getChainAdmin(uint256 _chainId) external view override returns (address) {

78:     /// @dev initialize

131:     /// @dev set validatorTimelock. Cannot do it an initialization, as validatorTimelock is deployed after STM

136:     /// @dev set initial cutHash

141:     /// @dev set New Version with upgrade from old version

151:     /// @dev set upgrade for some protocolVersion

159:     /// @dev freezes the specified chain

164:     /// @dev freezes the specified chain

169:     /// @dev reverts batches on the specified chain

176:     /// @dev we have to set the chainId at genesis, as blockhashzero is the same for all chains with the same chainId

230:     function registerAlreadyDeployedStateTransition(

238:     /// @notice called by Bridgehub when a chain registers


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L56-L57) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L74-L74), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L78-L78), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L131-L131), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L136-L136), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L141-L141), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L151-L151), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L159-L159), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L164-L164), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L169-L169), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L176-L176), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L230-L230), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L238-L238)


```solidity

File: contracts/state-transition/ValidatorTimelock.sol

28:     /// @notice The delay between committing and executing batches is changed.

31:     /// @notice A new validator has been added.

34:     /// @notice A validator has been removed.

37:     /// @notice Error for when an address is already a validator.

40:     /// @notice Error for when an address is not a validator.

55:     constructor(address _initialOwner, uint32 _executionDelay) {

60:     /// @notice Checks if the caller is the admin of the chain.

66:     /// @notice Checks if the caller is a validator.

72:     /// @dev Set new validator address.

77:     /// @dev Sets an address as a validator.

86:     /// @dev Removes an address as a validator.

95:     /// @dev Set the delay between committing and executing batches.

101:     /// @dev Returns the timestamp when `_l2BatchNumber` was committed.

106:     /// @dev Records the timestamp for all provided committed batches and make
107:     /// a call to the hyperchain diamond contract with the same calldata.

124:     /// @dev Records the timestamp for all provided committed batches and make
125:     /// a call to the hyperchain diamond contract with the same calldata.

143:     /// @dev Make a call to the hyperchain diamond contract with the same calldata.
144:     /// Note: If the batch is reverted, it needs to be committed first before the execution.
145:     /// So it's safe to not override the committed batches.

150:     /// @dev Make a call to the hyperchain diamond contract with the same calldata.
151:     /// Note: If the batch is reverted, it needs to be committed first before the execution.
152:     /// So it's safe to not override the committed batches.

157:     /// @dev Make a call to the hyperchain diamond contract with the same calldata.
158:     /// Note: We don't track the time when batches are proven, since all information about
159:     /// the batch is known on the commit stage and the proved is not finalized (may be reverted).

168:     /// @dev Make a call to the hyperchain diamond contract with the same calldata.
169:     /// Note: We don't track the time when batches are proven, since all information about
170:     /// the batch is known on the commit stage and the proved is not finalized (may be reverted).

180:     /// @dev Check that batches were committed at least X time ago and
181:     /// make a call to the hyperchain diamond contract with the same calldata.

201:     /// @dev Check that batches were committed at least X time ago and
202:     /// make a call to the hyperchain diamond contract with the same calldata.

223:     /// @dev Call the hyperchain diamond contract with the same calldata as this contract was called.
224:     /// Note: it is called the hyperchain diamond contract, not delegatecalled!


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L28-L28) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L31-L31), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L34-L34), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L37-L37), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L40-L40), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L55-L55), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L60-L60), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L66-L66), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L72-L72), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L77-L77), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L86-L86), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L95-L95), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L101-L101), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L106-L107), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L124-L125), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L143-L145), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L150-L152), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L157-L159), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L168-L170), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L180-L181), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L201-L202), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L223-L224)


```solidity

File: contracts/state-transition/chain-deps/DiamondInit.sol

21:     /// @notice hyperchain diamond contract initialization
22:     /// @return Magic 32 bytes, which indicates that the contract logic is expected to be used as a diamond proxy
23:     /// initializer


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/DiamondInit.sol#L21-L23) 


```solidity

File: contracts/state-transition/chain-deps/DiamondProxy.sol

11:     constructor(uint256 _chainId, Diamond.DiamondCutData memory _diamondCut) {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/DiamondProxy.sol#L11-L11) 


```solidity

File: contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol

61: /// @dev storing all storage variables for hyperchain diamond facets
62: /// NOTE: It is used in a proxy, so it is possible to add new variables to the end
63: /// but NOT to modify already existing variables or change their order.
64: /// NOTE: variables prefixed with '__DEPRECATED_' are deprecated and shouldn't be used.
65: /// Their presence is maintained for compatibility and to prevent storage collision.
66: struct ZkSyncStateTransitionStorage {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L61-L66) 


```solidity

File: contracts/state-transition/chain-deps/facets/Admin.sol

89:     function setValidiumMode(PubdataPricingMode _validiumMode) external onlyAdmin {

99:     /// upgrade a specific chain


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Admin.sol#L89-L89) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Admin.sol#L99-L99)


```solidity

File: contracts/state-transition/chain-deps/facets/Executor.sol

29:     /// @dev Process one batch commit using the previous batch StoredBatchInfo
30:     /// @dev returns new batch StoredBatchInfo
31:     /// @notice Does not change storage

126:     /// @dev Check that L2 logs are proper and batch contain all meta information for them
127:     /// @dev The logs processed here should line up such that only one log for each key from the
128:     ///      SystemLogKey enum in Constants.sol is processed per new batch.
129:     /// @dev Data returned from here will be used to form the batch commitment.

215:     function _commitBatches(

307:     /// @dev Pops the priority operations from the priority queue and returns a rolling hash of operations

317:     /// @dev Executes one batch
318:     /// @dev 1. Processes all pending operations (Complete priority requests)
319:     /// @dev 2. Finalizes batch on Ethereum
320:     /// @dev _executedBatchIdx is an index in the array of the batches that we want to execute together

349:     function _executeBatches(StoredBatchInfo[] calldata _batchesData) internal {

386:     function _proveBatches(

440:     function _verifyProof(uint256[] memory proofPublicInput, ProofInput calldata _proof) internal view {

452:     /// @dev Gets zk proof public input

481:     function _revertBatches(uint256 _newLastBatch) internal {

499:     /// @dev Creates batch commitment from its data

515:     function _batchPassThroughData(CommitBatchInfo calldata _batch) internal pure returns (bytes memory) {

537:     function _batchAuxiliaryOutput(

586:     /// @notice Returns the keccak hash of the ABI-encoded StoredBatchInfo

591:     /// @notice Returns true if the bit at index {_index} is 1

596:     /// @notice Sets the given bit in {_num} at index {_index} to 1.

601:     /// @notice Calls the point evaluation precompile and verifies the output
602:     /// Verify p(z) = y given commitment that corresponds to the polynomial p(x) and a KZG proof.
603:     /// Also verify that the provided commitment matches the provided versioned_hash.
604:     ///

621:     /// @dev Verifies that the blobs contain the correct data by calling the point evaluation precompile. For the precompile we need:
622:     /// versioned hash || opening point || opening value || commitment || proof
623:     /// the _pubdataCommitments will contain the last 4 values, the versioned hash is pulled from the BLOBHASH opcode
624:     /// pubdataCommitments is a list of: opening point (16 bytes) || claimed value (32 bytes) || commitment (48 bytes) || proof (48 bytes)) = 144 bytes

676:     /// @dev Since we don't have access to the new BLOBHASH opecode we need to leverage a static call to a yul contract
677:     /// that calls the opcode via a verbatim call. This should be swapped out once there is solidity support for the
678:     /// new opcode.


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L29-L31) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L126-L129), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L215-L215), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L307-L307), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L317-L320), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L349-L349), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L386-L386), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L440-L440), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L452-L452), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L481-L481), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L499-L499), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L515-L515), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L537-L537), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L586-L586), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L591-L591), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L596-L596), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L601-L604), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L621-L624), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L676-L678)


```solidity

File: contracts/state-transition/chain-deps/facets/Mailbox.sol

46:     /// @notice when requesting transactions through the bridgehub

103:     /// @dev Prove that a specific L2 log was sent in a specific L2 batch number

129:     /// @dev Convert arbitrary-length message to the raw l2 log

228:     function _requestL2TransactionSender(

258:     function _requestL2Transaction(

289:     function _serializeL2Transaction(

315:     /// @notice Stores a transaction record in storage & send event about that

352:     /// @notice Hashes the L2 bytecodes and returns them in the format in which they are processed by the bootloader


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L46-L46) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L103-L103), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L129-L129), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L228-L228), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L258-L258), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L289-L289), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L315-L315), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L352-L352)


```solidity

File: contracts/upgrades/BaseZkSyncUpgrade.sol

45:     /// @notice Changes the protocol version

48:     /// @notice P!hanges to the bytecode that is used in L2 as a bootloader (start program)

51:     /// @notice P!hanges to the bytecode that is used in L2 as a default account

54:     /// @notice Verifier address changed

57:     /// @notice Verifier parameters changed

60:     /// @notice Notifies about complete upgrade


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgrade.sol#L45-L45) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgrade.sol#L48-L48), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgrade.sol#L51-L51), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgrade.sol#L54-L54), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgrade.sol#L57-L57), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgrade.sol#L60-L60)


```solidity

File: contracts/common/libraries/UncheckedMath.sol

11:     function uncheckedInc(uint256 _number) internal pure returns (uint256) {

17:     function uncheckedAdd(uint256 _lhs, uint256 _rhs) internal pure returns (uint256) {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/UncheckedMath.sol#L11-L11) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/UncheckedMath.sol#L17-L17)


```solidity

File: contracts/common/libraries/UnsafeBytes.sol

19:     function readUint32(bytes memory _bytes, uint256 _start) internal pure returns (uint32 result, uint256 offset) {

26:     function readAddress(bytes memory _bytes, uint256 _start) internal pure returns (address result, uint256 offset) {

33:     function readUint256(bytes memory _bytes, uint256 _start) internal pure returns (uint256 result, uint256 offset) {

40:     function readBytes32(bytes memory _bytes, uint256 _start) internal pure returns (bytes32 result, uint256 offset) {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/UnsafeBytes.sol#L19-L19) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/UnsafeBytes.sol#L26-L26), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/UnsafeBytes.sol#L33-L33), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/UnsafeBytes.sol#L40-L40)


```solidity

File: contracts/state-transition/libraries/Diamond.sol

24:     event DiamondCut(FacetCut[] facetCuts, address initAddress, bytes initCalldata);

124:     /// @dev Add new functions to the diamond proxy
125:     /// NOTE: expect but NOT enforce that `_selectors` is NON-EMPTY array

147:     /// @dev Change associated facets to already known function selectors
148:     /// NOTE: expect but NOT enforce that `_selectors` is NON-EMPTY array

170:     /// @dev Remove association with function and facet
171:     /// NOTE: expect but NOT enforce that `_selectors` is NON-EMPTY array

187:     /// @dev Add address to the list of known facets if it is not on the list yet
188:     /// NOTE: should be called ONLY before adding a new selector associated with the address

200:     /// @dev Add one function to the already known facet
201:     /// NOTE: It is expected but NOT enforced that:
202:     /// - `_facet` is NON-ZERO address
203:     /// - `_facet` is already stored address in `DiamondStorage.facets`
204:     /// - `_selector` is NOT associated by another facet

226:     /// @dev Remove one associated function with facet
227:     /// NOTE: It is expected but NOT enforced that `_facet` is NON-ZERO address

255:     /// @dev remove facet from the list of known facets
256:     /// NOTE: It is expected but NOT enforced that there are no selectors associated with `_facet`

276:     /// @dev Delegates call to the initialization address with provided calldata
277:     /// @dev Used as a final step of diamond cut to execute the logic of the initialization for changed facets


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L24-L24) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L124-L125), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L147-L148), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L170-L171), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L187-L188), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L200-L204), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L226-L227), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L255-L256), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L276-L277)


```solidity

File: contracts/state-transition/libraries/LibMap.sol

9:     /// @dev A uint32 map in storage.


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/LibMap.sol#L9-L9) 


```solidity

File: contracts/state-transition/libraries/Merkle.sol

39:     /// @dev Keccak hash of the concatenation of two 32-byte words


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Merkle.sol#L39-L39) 


```solidity

File: contracts/state-transition/libraries/PriorityQueue.sol

33:     /// @notice Returns zero if and only if no operations were processed from the queue
34:     /// @return Index of the oldest priority operation that wasn't processed yet

39:     /// @return The total number of priority operations that were added to the priority queue, including all processed ones

44:     /// @return The total number of unprocessed priority operations in a priority queue

49:     /// @return Whether the priority queue contains no operations

54:     /// @notice Add the priority operation to the end of the priority queue

63:     /// @return The first unprocessed priority operation from the queue

70:     /// @notice Remove the first unprocessed priority operation from the queue
71:     /// @return priorityOperation that was popped from the priority queue


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/PriorityQueue.sol#L33-L34) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/PriorityQueue.sol#L39-L39), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/PriorityQueue.sol#L44-L44), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/PriorityQueue.sol#L49-L49), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/PriorityQueue.sol#L54-L54), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/PriorityQueue.sol#L63-L63), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/PriorityQueue.sol#L70-L71)


```solidity

File: contracts/bridge/interfaces/IL1ERC20Bridge.sol

12:     event DepositInitiated(

20:     event WithdrawalFinalized(address indexed to, address indexed l1Token, uint256 amount);

22:     event ClaimedFailedDeposit(address indexed to, address indexed l1Token, uint256 amount);

24:     function isWithdrawalFinalized(uint256 _l2BatchNumber, uint256 _l2MessageIndex) external view returns (bool);

26:     function deposit(

35:     function deposit(

43:     function claimFailedDeposit(

53:     function finalizeWithdrawal(

61:     function l2TokenAddress(address _l1Token) external view returns (address);

69:     function depositAmount(

75:     function tranferTokenToSharedBridge(address _token, uint256 _amount) external;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1ERC20Bridge.sol#L12-L12) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1ERC20Bridge.sol#L20-L20), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1ERC20Bridge.sol#L22-L22), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1ERC20Bridge.sol#L24-L24), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1ERC20Bridge.sol#L26-L26), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1ERC20Bridge.sol#L35-L35), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1ERC20Bridge.sol#L43-L43), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1ERC20Bridge.sol#L53-L53), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1ERC20Bridge.sol#L61-L61), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1ERC20Bridge.sol#L69-L69), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1ERC20Bridge.sol#L75-L75)


```solidity

File: contracts/bridge/interfaces/IL1SharedBridge.sol

13:     event LegacyDepositInitiated(

22:     event BridgehubDepositInitiated(

31:     event BridgehubDepositBaseTokenInitiated(

38:     event BridgehubDepositFinalized(

44:     event WithdrawalFinalizedSharedBridge(

51:     event ClaimedFailedDepositSharedBridge(

58:     function isWithdrawalFinalized(

64:     function depositLegacyErc20Bridge(

74:     function claimFailedDepositLegacyErc20Bridge(

85:     function claimFailedDeposit(

97:     function finalizeWithdrawalLegacyErc20Bridge(

105:     function finalizeWithdrawal(

120:     function l2BridgeAddress(uint256 _chainId) external view returns (address);

122:     function depositHappened(uint256 _chainId, bytes32 _l2TxHash) external view returns (bytes32);

124:     /// data is abi encoded :
125:     /// address _l1Token,
126:     /// uint256 _amount,
127:     /// address _l2Receiver

135:     function bridgehubDepositBaseToken(

142:     function bridgehubConfirmL2Transaction(uint256 _chainId, bytes32 _txDataHash, bytes32 _txHash) external;

144:     function receiveEth(uint256 _chainId) external payable;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L13-L13) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L22-L22), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L31-L31), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L38-L38), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L44-L44), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L51-L51), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L58-L58), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L64-L64), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L74-L74), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L85-L85), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L97-L97), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L105-L105), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L120-L120), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L122-L122), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L124-L127), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L135-L135), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L142-L142), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L144-L144)


```solidity

File: contracts/bridge/interfaces/IL2Bridge.sol

7:     function finalizeDeposit(

15:     function withdraw(address _l1Receiver, address _l2Token, uint256 _amount) external;

17:     function l1TokenAddress(address _l2Token) external view returns (address);

19:     function l2TokenAddress(address _l1Token) external view returns (address);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL2Bridge.sol#L7-L7) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL2Bridge.sol#L15-L15), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL2Bridge.sol#L17-L17), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL2Bridge.sol#L19-L19)


```solidity

File: contracts/bridge/interfaces/IWETH9.sol

7:     function withdraw(uint256 wad) external;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IWETH9.sol#L7-L7) 


```solidity

File: contracts/bridgehub/IBridgehub.sol

43:     /// @notice pendingAdmin is changed
44:     /// @dev Also emitted when new admin is accepted and in this case, `newPendingAdmin` would be zero address

47:     /// @notice Admin changed

58:     /// Getters

61:     function stateTransitionManager(uint256 _chainId) external view returns (address);

63:     function tokenIsRegistered(address _baseToken) external view returns (bool);

65:     function baseToken(uint256 _chainId) external view returns (address);

69:     function getStateTransition(uint256 _chainId) external view returns (address);

71:     /// Mailbox forwarder
72: 

81:     function proveL2LogInclusion(

89:     function proveL1ToL2TransactionStatus(

99:     function requestL2TransactionDirect(

103:     function requestL2TransactionTwoBridges(

107:     function l2TransactionBaseCost(

116:     function createNewChain(

125:     function addStateTransitionManager(address _stateTransitionManager) external;

127:     function removeStateTransitionManager(address _stateTransitionManager) external;

129:     function addToken(address _token) external;

131:     function setSharedBridge(address _sharedBridge) external;

133:     event NewChain(uint256 indexed chainId, address stateTransitionManager, address indexed chainGovernance);

10: struct L2TransactionRequestDirect {

22: struct L2TransactionRequestTwoBridgesOuter {

34: struct L2TransactionRequestTwoBridgesInner {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L43-L44) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L47-L47), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L58-L58), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L61-L61), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L63-L63), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L65-L65), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L69-L69), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L71-L72), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L81-L81), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L89-L89), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L99-L99), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L103-L103), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L107-L107), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L116-L116), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L125-L125), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L127-L127), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L129-L129), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L131-L131), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L133-L133), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L10-L10), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L22-L22), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L34-L34)


```solidity

File: contracts/common/interfaces/IL2ContractDeployer.sol

24:     /// @notice This method is to be used only during an upgrade to set bytecodes on specific addresses.


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/interfaces/IL2ContractDeployer.sol#L24-L24) 


```solidity

File: contracts/governance/IGovernance.sol

41:     function isOperation(bytes32 _id) external view returns (bool);

43:     function isOperationPending(bytes32 _id) external view returns (bool);

45:     function isOperationReady(bytes32 _id) external view returns (bool);

47:     function isOperationDone(bytes32 _id) external view returns (bool);

49:     function getOperationState(bytes32 _id) external view returns (OperationState);

51:     function scheduleTransparent(Operation calldata _operation, uint256 _delay) external;

53:     function scheduleShadow(bytes32 _id, uint256 _delay) external;

55:     function cancel(bytes32 _id) external;

57:     function execute(Operation calldata _operation) external payable;

59:     function executeInstant(Operation calldata _operation) external payable;

61:     function hashOperation(Operation calldata _operation) external pure returns (bytes32);

63:     function updateDelay(uint256 _newDelay) external;

65:     function updateSecurityCouncil(address _newSecurityCouncil) external;

67:     /// @notice Emitted when transparent operation is scheduled.

70:     /// @notice Emitted when shadow operation is scheduled.

73:     /// @notice Emitted when the operation is executed with delay or instantly.

76:     /// @notice Emitted when the security council address is changed.

79:     /// @notice Emitted when the minimum delay for future operations is modified.

82:     /// @notice Emitted when the operation with specified id is cancelled.


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/IGovernance.sol#L41-L41) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/IGovernance.sol#L43-L43), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/IGovernance.sol#L45-L45), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/IGovernance.sol#L47-L47), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/IGovernance.sol#L49-L49), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/IGovernance.sol#L51-L51), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/IGovernance.sol#L53-L53), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/IGovernance.sol#L55-L55), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/IGovernance.sol#L57-L57), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/IGovernance.sol#L59-L59), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/IGovernance.sol#L61-L61), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/IGovernance.sol#L63-L63), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/IGovernance.sol#L65-L65), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/IGovernance.sol#L67-L67), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/IGovernance.sol#L70-L70), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/IGovernance.sol#L73-L73), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/IGovernance.sol#L76-L76), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/IGovernance.sol#L79-L79), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/IGovernance.sol#L82-L82)


```solidity

File: contracts/state-transition/IStateTransitionManager.sol

28:     event StateTransitionNewChain(uint256 indexed _chainId, address indexed _stateTransitionContract);

30:     event SetChainIdUpgrade(

36:     /// @notice pendingAdmin is changed
37:     /// @dev Also emitted when new admin is accepted and in this case, `newPendingAdmin` would be zero address

40:     /// @notice Admin changed

53:     function stateTransition(uint256 _chainId) external view returns (address);

61:     function upgradeCutHash(uint256 _protocolVersion) external view returns (bytes32);

65:     function initialize(StateTransitionManagerInitializeData calldata _initalizeData) external;

67:     function setInitialCutHash(Diamond.DiamondCutData calldata _diamondCut) external;

69:     function setValidatorTimelock(address _validatorTimelock) external;

71:     function getChainAdmin(uint256 _chainId) external view returns (address);

73:     /// @notice

82:     function registerAlreadyDeployedStateTransition(uint256 _chainId, address _stateTransitionContract) external;

84:     function setNewVersionUpgrade(

90:     function setUpgradeDiamondCut(Diamond.DiamondCutData calldata _cutData, uint256 _oldProtocolVersion) external;

92:     function freezeChain(uint256 _chainId) external;

94:     function unfreezeChain(uint256 _chainId) external;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/IStateTransitionManager.sol#L28-L28) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/IStateTransitionManager.sol#L30-L30), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/IStateTransitionManager.sol#L36-L37), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/IStateTransitionManager.sol#L40-L40), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/IStateTransitionManager.sol#L53-L53), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/IStateTransitionManager.sol#L61-L61), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/IStateTransitionManager.sol#L65-L65), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/IStateTransitionManager.sol#L67-L67), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/IStateTransitionManager.sol#L69-L69), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/IStateTransitionManager.sol#L71-L71), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/IStateTransitionManager.sol#L73-L73), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/IStateTransitionManager.sol#L82-L82), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/IStateTransitionManager.sol#L84-L84), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/IStateTransitionManager.sol#L90-L90), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/IStateTransitionManager.sol#L92-L92), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/IStateTransitionManager.sol#L94-L94)


```solidity

File: contracts/state-transition/chain-interfaces/IAdmin.sol

39:     /// @notice Change the token multiplier for L1->L2 transactions

42:     /// @notice Used to set to validium directly after genesis

45:     function upgradeChainFromVersion(uint256 _protocolVersion, Diamond.DiamondCutData calldata _cutData) external;

60:     /// @notice Porter availability status changes

63:     /// @notice Validator's status changed

66:     /// @notice pendingAdmin is changed
67:     /// @dev Also emitted when new admin is accepted and in this case, `newPendingAdmin` would be zero address

70:     /// @notice Admin changed

73:     /// @notice Priority transaction max L2 gas limit changed

76:     /// @notice Fee params for L1->L2 transactions changed

79:     /// @notice Validium mode status changed

82:     /// @notice BaseToken multiplier for L1->L2 transactions changed

90:     /// @notice Emitted when an upgrade is executed.


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IAdmin.sol#L39-L39) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IAdmin.sol#L42-L42), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IAdmin.sol#L45-L45), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IAdmin.sol#L60-L60), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IAdmin.sol#L63-L63), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IAdmin.sol#L66-L67), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IAdmin.sol#L70-L70), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IAdmin.sol#L73-L73), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IAdmin.sol#L76-L76), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IAdmin.sol#L79-L79), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IAdmin.sol#L82-L82), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IAdmin.sol#L90-L90)


```solidity

File: contracts/state-transition/chain-interfaces/IDiamondInit.sol

62:     function initialize(InitializeData calldata _initData) external returns (bytes32);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IDiamondInit.sol#L62-L62) 


```solidity

File: contracts/state-transition/chain-interfaces/IExecutor.sol

142:     /// @notice same as `commitBatches` but with the chainId so ValidatorTimelock can sort the inputs.

160:     /// @notice same as `proveBatches` but with the chainId so ValidatorTimelock can sort the inputs.

174:     /// @notice same as `executeBatches` but with the chainId so ValidatorTimelock can sort the inputs.

183:     /// @notice same as `revertBatches` but with the chainId so ValidatorTimelock can sort the inputs.

27: struct LogProcessingOutput {

125:     /// @notice Recursive proof input data (individual commitments are constructed onchain)


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IExecutor.sol#L142-L142) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IExecutor.sol#L160-L160), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IExecutor.sol#L174-L174), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IExecutor.sol#L183-L183), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IExecutor.sol#L27-L27), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IExecutor.sol#L125-L125)


```solidity

File: contracts/state-transition/chain-interfaces/IGetters.sol

64:     /// @return Whether the address has a validator access

67:     /// @return merkleRoot Merkle root of the tree with L2 logs for the selected batch

70:     /// @notice For unfinalized (non executed) batches may change
71:     /// @dev returns zero for non-committed batches
72:     /// @return The hash of committed L2 batch.

132:     /// @return NON-sorted array with function selectors supported by a specific facet

138:     /// @return facet The facet address associated with a selector. Zero if the selector is not added to the diamond

141:     /// @return Whether the selector can be frozen by the admin or always accessible

144:     /// @return isFreezable Whether the facet can be frozen by the admin or always accessible


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IGetters.sol#L64-L64) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IGetters.sol#L67-L67), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IGetters.sol#L70-L72), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IGetters.sol#L132-L132), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IGetters.sol#L138-L138), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IGetters.sol#L141-L141), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IGetters.sol#L144-L144)


```solidity

File: contracts/state-transition/chain-interfaces/ILegacyGetters.sol

24:     /// @notice For unfinalized (non executed) batches may change
25:     /// @dev It is a *deprecated* method, please use `storedBatchHash` instead.
26:     /// @dev returns zero for non-committed batches
27:     /// @return The hash of committed L2 batch.


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/ILegacyGetters.sol#L24-L27) 


```solidity

File: contracts/state-transition/chain-interfaces/IMailbox.sol

98:     function bridgehubRequestL2Transaction(


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IMailbox.sol#L98-L98) 


```solidity

File: contracts/state-transition/chain-interfaces/IVerifier.sol

16:     /// @dev Verifies a zk-SNARK proof.
17:     /// @return A boolean value indicating whether the zk-SNARK proof is valid.
18:     /// Note: The function may revert execution instead of returning false in some cases.

5: /// @notice Part of the configuration parameters of ZKP circuits
6: struct VerifierParams {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IVerifier.sol#L16-L18) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IVerifier.sol#L5-L6)


```solidity

File: contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol

17:     event ProposeTransparentUpgrade(


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol#L17-L17) 


```solidity

File: contracts/state-transition/l2-deps/ISystemContext.sol

5:     function setChainId(uint256 _newChainId) external;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/l2-deps/ISystemContext.sol#L5-L5) 


```solidity

File: contracts/upgrades/IDefaultUpgrade.sol

8:     function upgrade(ProposedUpgrade calldata _upgrade) external returns (bytes32);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/IDefaultUpgrade.sol#L8-L8) 


```solidity

File: contracts/common/Messaging.sol

127: struct BridgehubL2TransactionRequest {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/Messaging.sol#L127-L127) 


```solidity

File: contracts/bridge/L2SharedBridge.sol

108:     /// @dev Deploy and initialize the L2 token for the L1 counterpart

137:     /// @dev Encode the message for l2ToL1log sent with withdraw initialization

148:     /// @return Address of an L2 token counterpart

156:     /// @dev Convert the L1 token address to the create2 salt of deployed L2 token

161:     /// @dev Deploy the beacon proxy for the L2 token, while using ContractDeployer system contract.
162:     /// @dev This function uses raw call to ContractDeployer to make sure that exactly `l2TokenProxyBytecodeHash` is used
163:     /// for the code of the proxy.


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L108-L108) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L137-L137), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L148-L148), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L156-L156), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L161-L163)


```solidity

File: contracts/bridge/L2StandardERC20.sol

134:     modifier onlyNextVersion(uint8 _version) {

177:     /// @dev External function to decode a string from bytes.

182:     /// @dev External function to decode a uint8 from bytes.

16:     /// @dev Describes whether there is a specific getter in the token.
17:     /// @notice Used to explicitly separate which getters the token has and which it does not.
18:     /// @notice Different tokens in L1 can implement or not implement getter function as `name`/`symbol`/`decimals`,
19:     /// @notice Our goal is to store all the getters that L1 token implements, and for others, we keep it as an unimplemented method.


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2StandardERC20.sol#L134-L134) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2StandardERC20.sol#L177-L177), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2StandardERC20.sol#L182-L182), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2StandardERC20.sol#L16-L19)


```solidity

File: contracts/bridge/interfaces/IL1ERC20Bridge.sol

9:     function finalizeWithdrawal(


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL1ERC20Bridge.sol#L9-L9) 


```solidity

File: contracts/bridge/interfaces/IL1SharedBridge.sol

9:     function finalizeWithdrawal(


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL1SharedBridge.sol#L9-L9) 


```solidity

File: contracts/bridge/interfaces/IL2SharedBridge.sol

7:     event FinalizeDeposit(

14:     event WithdrawalInitiated(

21:     /// @dev Event emitted when baseToken is received by the contract.

24:     function finalizeDeposit(

32:     function withdraw(address _l1Receiver, address _l2Token, uint256 _amount) external;

34:     function l1TokenAddress(address _l2Token) external view returns (address);

36:     function l2TokenAddress(address _l1Token) external view returns (address);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL2SharedBridge.sol#L7-L7) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL2SharedBridge.sol#L14-L14), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL2SharedBridge.sol#L21-L21), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL2SharedBridge.sol#L24-L24), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL2SharedBridge.sol#L32-L32), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL2SharedBridge.sol#L34-L34), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL2SharedBridge.sol#L36-L36)


```solidity

File: contracts/bridge/interfaces/IL2StandardToken.sol

6:     event BridgeInitialize(address indexed l1Token, string name, string symbol, uint8 decimals);

8:     event BridgeMint(address indexed _account, uint256 _amount);

10:     event BridgeBurn(address indexed _account, uint256 _amount);

12:     function bridgeMint(address _account, uint256 _amount) external;

14:     function bridgeBurn(address _account, uint256 _amount) external;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL2StandardToken.sol#L6-L6) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL2StandardToken.sol#L8-L8), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL2StandardToken.sol#L10-L10), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL2StandardToken.sol#L12-L12), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL2StandardToken.sol#L14-L14)


```solidity

File: contracts/interfaces/IPaymasterFlow.sol

14:     function general(bytes calldata input) external;

16:     function approvalBased(address _token, uint256 _minAllowance, bytes calldata _innerInput) external;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/interfaces/IPaymasterFlow.sol#L14-L14) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/interfaces/IPaymasterFlow.sol#L16-L16)


```solidity

File: contracts/L2ContractHelper.sol

116: /// @notice Structure used to represent a zkSync transaction.
117: struct Transaction {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/L2ContractHelper.sol#L116-L117) 


```solidity

File: contracts/SystemContractsCaller.sol

27:     function safeCastToU32(uint256 _x) internal pure returns (uint32) {

37:     function systemCall(uint32 gasLimit, address to, uint256 value, bytes memory data) internal returns (bool success) {

76:     function systemCallWithReturndata(

95:     function getFarCallABI(

121:     function getFarCallABIWithEmptyFatPointer(


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/SystemContractsCaller.sol#L27-L27) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/SystemContractsCaller.sol#L37-L37), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/SystemContractsCaller.sol#L76-L76), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/SystemContractsCaller.sol#L95-L95), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/SystemContractsCaller.sol#L121-L121)


</details>


### [NC&#x2011;119] [NatSpec] Natspec comment is missing from scope `block` 



*There are 31 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/BootloaderUtilities.sol

55:         {
56:             bytes memory encodedGasPrice = RLPEncoder.encodeUint256(_transaction.maxFeePerGas);
57:             bytes memory encodedGasLimit = RLPEncoder.encodeUint256(_transaction.gasLimit);
58:             encodedGasParam = bytes.concat(encodedGasPrice, encodedGasLimit);
59:         }

66:         {
67:             // Safe cast, because the length of the transaction data can't be so large.
68:             uint64 txDataLen = uint64(_transaction.data.length);
69:             if (txDataLen != 1) {
70:                 // If the length is not equal to one, then only using the length can it be encoded definitely.
71:                 encodedDataLength = RLPEncoder.encodeNonSingleBytesLen(txDataLen);
72:             } else if (_transaction.data[0] >= 0x80) {
73:                 // If input is a byte in [0x80, 0xff] range, RLP encoding will concatenates 0x81 with the byte.
74:                 encodedDataLength = hex"81";
75:             }
76:             // Otherwise the length is not encoded at all.
77:         }

80:         {
81:             uint256 rInt = uint256(bytes32(_transaction.signature[0:32]));
82:             rEncoded = RLPEncoder.encodeUint256(rInt);
83:         }

85:         {
86:             uint256 sInt = uint256(bytes32(_transaction.signature[32:64]));
87:             sEncoded = RLPEncoder.encodeUint256(sInt);
88:         }

090:         {
091:             uint256 vInt = uint256(uint8(_transaction.signature[64]));
092:             require(vInt == 27 || vInt == 28, "Invalid v value");
093: 
094:             // If the `chainId` is specified in the transaction, then the `v` value is encoded as
095:             // `35 + y + 2 * chainId == vInt + 8 + 2 * chainId`, where y - parity bit (see EIP-155).
096:             if (_transaction.reserved[0] != 0) {
097:                 vInt += 8 + block.chainid * 2;
098:             }
099: 
100:             vEncoded = RLPEncoder.encodeUint256(vInt);
101:         }

142:         {
143:             bytes memory encodedChainId = RLPEncoder.encodeUint256(block.chainid);
144:             bytes memory encodedNonce = RLPEncoder.encodeUint256(_transaction.nonce);
145:             bytes memory encodedGasPrice = RLPEncoder.encodeUint256(_transaction.maxFeePerGas);
146:             bytes memory encodedGasLimit = RLPEncoder.encodeUint256(_transaction.gasLimit);
147:             bytes memory encodedTo = RLPEncoder.encodeAddress(address(uint160(_transaction.to)));
148:             bytes memory encodedValue = RLPEncoder.encodeUint256(_transaction.value);
149:             encodedFixedLengthParams = bytes.concat(
150:                 encodedChainId,
151:                 encodedNonce,
152:                 encodedGasPrice,
153:                 encodedGasLimit,
154:                 encodedTo,
155:                 encodedValue
156:             );
157:         }

162:         {
163:             // Safe cast, because the length of the transaction data can't be so large.
164:             uint64 txDataLen = uint64(_transaction.data.length);
165:             if (txDataLen != 1) {
166:                 // If the length is not equal to one, then only using the length can it be encoded definitely.
167:                 encodedDataLength = RLPEncoder.encodeNonSingleBytesLen(txDataLen);
168:             } else if (_transaction.data[0] >= 0x80) {
169:                 // If input is a byte in [0x80, 0xff] range, RLP encoding will concatenates 0x81 with the byte.
170:                 encodedDataLength = hex"81";
171:             }
172:             // Otherwise the length is not encoded at all.
173:         }

179:         {
180:             uint256 rInt = uint256(bytes32(_transaction.signature[0:32]));
181:             rEncoded = RLPEncoder.encodeUint256(rInt);
182:         }

184:         {
185:             uint256 sInt = uint256(bytes32(_transaction.signature[32:64]));
186:             sEncoded = RLPEncoder.encodeUint256(sInt);
187:         }

189:         {
190:             uint256 vInt = uint256(uint8(_transaction.signature[64]));
191:             require(vInt == 27 || vInt == 28, "Invalid v value");
192: 
193:             vEncoded = RLPEncoder.encodeUint256(vInt - 27);
194:         }

235:         {
236:             bytes memory encodedChainId = RLPEncoder.encodeUint256(block.chainid);
237:             bytes memory encodedNonce = RLPEncoder.encodeUint256(_transaction.nonce);
238:             bytes memory encodedMaxPriorityFeePerGas = RLPEncoder.encodeUint256(_transaction.maxPriorityFeePerGas);
239:             bytes memory encodedMaxFeePerGas = RLPEncoder.encodeUint256(_transaction.maxFeePerGas);
240:             bytes memory encodedGasLimit = RLPEncoder.encodeUint256(_transaction.gasLimit);
241:             bytes memory encodedTo = RLPEncoder.encodeAddress(address(uint160(_transaction.to)));
242:             bytes memory encodedValue = RLPEncoder.encodeUint256(_transaction.value);
243:             encodedFixedLengthParams = bytes.concat(
244:                 encodedChainId,
245:                 encodedNonce,
246:                 encodedMaxPriorityFeePerGas,
247:                 encodedMaxFeePerGas,
248:                 encodedGasLimit,
249:                 encodedTo,
250:                 encodedValue
251:             );
252:         }

257:         {
258:             // Safe cast, because the length of the transaction data can't be so large.
259:             uint64 txDataLen = uint64(_transaction.data.length);
260:             if (txDataLen != 1) {
261:                 // If the length is not equal to one, then only using the length can it be encoded definitely.
262:                 encodedDataLength = RLPEncoder.encodeNonSingleBytesLen(txDataLen);
263:             } else if (_transaction.data[0] >= 0x80) {
264:                 // If input is a byte in [0x80, 0xff] range, RLP encoding will concatenates 0x81 with the byte.
265:                 encodedDataLength = hex"81";
266:             }
267:             // Otherwise the length is not encoded at all.
268:         }

274:         {
275:             uint256 rInt = uint256(bytes32(_transaction.signature[0:32]));
276:             rEncoded = RLPEncoder.encodeUint256(rInt);
277:         }

279:         {
280:             uint256 sInt = uint256(bytes32(_transaction.signature[32:64]));
281:             sEncoded = RLPEncoder.encodeUint256(sInt);
282:         }

284:         {
285:             uint256 vInt = uint256(uint8(_transaction.signature[64]));
286:             require(vInt == 27 || vInt == 28, "Invalid v value");
287: 
288:             vEncoded = RLPEncoder.encodeUint256(vInt - 27);
289:         }


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L55-L59) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L66-L77), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L80-L83), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L85-L88), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L90-L101), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L142-L157), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L162-L173), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L179-L182), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L184-L187), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L189-L194), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L235-L252), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L257-L268), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L274-L277), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L279-L282), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L284-L289)


```solidity

File: contracts/libraries/TransactionHelper.sol

158:         {
159:             bytes memory encodedGasPrice = RLPEncoder.encodeUint256(_transaction.maxFeePerGas);
160:             bytes memory encodedGasLimit = RLPEncoder.encodeUint256(_transaction.gasLimit);
161:             encodedGasParam = bytes.concat(encodedGasPrice, encodedGasLimit);
162:         }

169:         {
170:             // Safe cast, because the length of the transaction data can't be so large.
171:             uint64 txDataLen = uint64(_transaction.data.length);
172:             if (txDataLen != 1) {
173:                 // If the length is not equal to one, then only using the length can it be encoded definitely.
174:                 encodedDataLength = RLPEncoder.encodeNonSingleBytesLen(txDataLen);
175:             } else if (_transaction.data[0] >= 0x80) {
176:                 // If input is a byte in [0x80, 0xff] range, RLP encoding will concatenates 0x81 with the byte.
177:                 encodedDataLength = hex"81";
178:             }
179:             // Otherwise the length is not encoded at all.
180:         }

227:         {
228:             bytes memory encodedChainId = RLPEncoder.encodeUint256(block.chainid);
229:             bytes memory encodedNonce = RLPEncoder.encodeUint256(_transaction.nonce);
230:             bytes memory encodedGasPrice = RLPEncoder.encodeUint256(_transaction.maxFeePerGas);
231:             bytes memory encodedGasLimit = RLPEncoder.encodeUint256(_transaction.gasLimit);
232:             bytes memory encodedTo = RLPEncoder.encodeAddress(address(uint160(_transaction.to)));
233:             bytes memory encodedValue = RLPEncoder.encodeUint256(_transaction.value);
234:             encodedFixedLengthParams = bytes.concat(
235:                 encodedChainId,
236:                 encodedNonce,
237:                 encodedGasPrice,
238:                 encodedGasLimit,
239:                 encodedTo,
240:                 encodedValue
241:             );
242:         }

247:         {
248:             // Safe cast, because the length of the transaction data can't be so large.
249:             uint64 txDataLen = uint64(_transaction.data.length);
250:             if (txDataLen != 1) {
251:                 // If the length is not equal to one, then only using the length can it be encoded definitely.
252:                 encodedDataLength = RLPEncoder.encodeNonSingleBytesLen(txDataLen);
253:             } else if (_transaction.data[0] >= 0x80) {
254:                 // If input is a byte in [0x80, 0xff] range, RLP encoding will concatenates 0x81 with the byte.
255:                 encodedDataLength = hex"81";
256:             }
257:             // Otherwise the length is not encoded at all.
258:         }

297:         {
298:             bytes memory encodedChainId = RLPEncoder.encodeUint256(block.chainid);
299:             bytes memory encodedNonce = RLPEncoder.encodeUint256(_transaction.nonce);
300:             bytes memory encodedMaxPriorityFeePerGas = RLPEncoder.encodeUint256(_transaction.maxPriorityFeePerGas);
301:             bytes memory encodedMaxFeePerGas = RLPEncoder.encodeUint256(_transaction.maxFeePerGas);
302:             bytes memory encodedGasLimit = RLPEncoder.encodeUint256(_transaction.gasLimit);
303:             bytes memory encodedTo = RLPEncoder.encodeAddress(address(uint160(_transaction.to)));
304:             bytes memory encodedValue = RLPEncoder.encodeUint256(_transaction.value);
305:             encodedFixedLengthParams = bytes.concat(
306:                 encodedChainId,
307:                 encodedNonce,
308:                 encodedMaxPriorityFeePerGas,
309:                 encodedMaxFeePerGas,
310:                 encodedGasLimit,
311:                 encodedTo,
312:                 encodedValue
313:             );
314:         }

319:         {
320:             // Safe cast, because the length of the transaction data can't be so large.
321:             uint64 txDataLen = uint64(_transaction.data.length);
322:             if (txDataLen != 1) {
323:                 // If the length is not equal to one, then only using the length can it be encoded definitely.
324:                 encodedDataLength = RLPEncoder.encodeNonSingleBytesLen(txDataLen);
325:             } else if (_transaction.data[0] >= 0x80) {
326:                 // If input is a byte in [0x80, 0xff] range, RLP encoding will concatenates 0x81 with the byte.
327:                 encodedDataLength = hex"81";
328:             }
329:             // Otherwise the length is not encoded at all.
330:         }


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L158-L162) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L169-L180), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L227-L242), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L247-L258), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L297-L314), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L319-L330)


```solidity

File: contracts/bridge/L1SharedBridge.sol

215:         {
216:             // Request the finalization of the deposit on the L2 side
217:             bytes memory l2TxCalldata = _getDepositL2Calldata(_prevMsgSender, _l2Receiver, _l1Token, amount);
218: 
219:             request = L2TransactionRequestTwoBridgesInner({
220:                 magicValue: TWO_BRIDGES_MAGIC_VALUE,
221:                 l2Contract: l2BridgeAddress[_chainId],
222:                 l2Calldata: l2TxCalldata,
223:                 factoryDeps: new bytes[](0),
224:                 txDataHash: txDataHash
225:             });
226:         }

315:         {
316:             bool proofValid = bridgehub.proveL1ToL2TransactionStatus(
317:                 _chainId,
318:                 _l2TxHash,
319:                 _l2BatchNumber,
320:                 _l2MessageIndex,
321:                 _l2TxNumberInBatch,
322:                 _merkleProof,
323:                 TxStatus.Failure
324:             );
325:             require(proofValid, "yn");
326:         }

329:         {
330:             bool notCheckedInLegacyBridgeOrWeCanCheckDeposit;
331:             {
332:                 // Deposits that happened before the upgrade cannot be checked here, they have to be claimed and checked in the legacyBridge
333:                 bool weCanCheckDepositHere = !_isEraLegacyWithdrawal(_chainId, _l2BatchNumber);
334:                 // Double claims are not possible, as we this check except for legacy bridge withdrawals
335:                 // Funds claimed before the update will still be recorded in the legacy bridge
336:                 // Note we double check NEW deposits if they are called from the legacy bridge
337:                 notCheckedInLegacyBridgeOrWeCanCheckDeposit = (!_checkedInLegacyBridge) || weCanCheckDepositHere;
338:             }
339:             if (notCheckedInLegacyBridgeOrWeCanCheckDeposit) {
340:                 bytes32 dataHash = depositHappened[_chainId][_l2TxHash];
341:                 bytes32 txDataHash = keccak256(abi.encode(_depositSender, _l1Token, _amount));
342:                 require(dataHash == txDataHash, "ShB: d.it not hap");
343:                 delete depositHappened[_chainId][_l2TxHash];
344:             }
345:         }

331:             {
332:                 // Deposits that happened before the upgrade cannot be checked here, they have to be claimed and checked in the legacyBridge
333:                 bool weCanCheckDepositHere = !_isEraLegacyWithdrawal(_chainId, _l2BatchNumber);
334:                 // Double claims are not possible, as we this check except for legacy bridge withdrawals
335:                 // Funds claimed before the update will still be recorded in the legacy bridge
336:                 // Note we double check NEW deposits if they are called from the legacy bridge
337:                 notCheckedInLegacyBridgeOrWeCanCheckDeposit = (!_checkedInLegacyBridge) || weCanCheckDepositHere;
338:             }

466:         {
467:             bool baseTokenWithdrawal = (l1Token == bridgehub.baseToken(_chainId));
468:             address l2Sender = baseTokenWithdrawal ? L2_BASE_TOKEN_SYSTEM_CONTRACT_ADDR : l2BridgeAddress[_chainId];
469: 
470:             l2ToL1Message = L2Message({
471:                 txNumberInBatch: _messageParams.l2TxNumberInBatch,
472:                 sender: l2Sender,
473:                 data: _message
474:             });
475:         }

573:         {
574:             // If the refund recipient is not specified, the refund will be sent to the sender of the transaction.
575:             // Otherwise, the refund will be sent to the specified address.
576:             // If the recipient is a contract on L1, the address alias will be applied.
577:             address refundRecipient = _refundRecipient;
578:             if (_refundRecipient == address(0)) {
579:                 refundRecipient = _prevMsgSender != tx.origin
580:                     ? AddressAliasHelper.applyL1ToL2Alias(_prevMsgSender)
581:                     : _prevMsgSender;
582:             }
583: 
584:             L2TransactionRequestDirect memory request = L2TransactionRequestDirect({
585:                 chainId: ERA_CHAIN_ID,
586:                 l2Contract: l2BridgeAddress[ERA_CHAIN_ID],
587:                 mintValue: msg.value, // l2 gas + l2 msg.Value the bridgehub will withdraw the mintValue from the base token bridge for gas
588:                 l2Value: 0, // L2 msg.value, this contract doesn't support base token deposits or wrapping functionality, for direct deposits use bridgehub
589:                 l2Calldata: l2TxCalldata,
590:                 l2GasLimit: _l2TxGasLimit,
591:                 l2GasPerPubdataByteLimit: _l2TxGasPerPubdataByte,
592:                 factoryDeps: new bytes[](0),
593:                 refundRecipient: refundRecipient
594:             });
595:             l2TxHash = bridgehub.requestL2TransactionDirect{value: msg.value}(request);
596:         }


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L215-L226) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L315-L326), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L329-L345), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L331-L338), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L466-L475), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L573-L596)


```solidity

File: contracts/bridgehub/Bridgehub.sol

220:         {
221:             address token = baseToken[_request.chainId];
222:             if (token == ETH_TOKEN_ADDRESS) {
223:                 require(msg.value == _request.mintValue, "Bridgehub: msg.value mismatch 1");
224:             } else {
225:                 require(msg.value == 0, "Bridgehub: non-eth bridge with msg.value");
226:             }
227: 
228:             sharedBridge.bridgehubDepositBaseToken{value: msg.value}(
229:                 _request.chainId,
230:                 msg.sender,
231:                 token,
232:                 _request.mintValue
233:             );
234:         }

265:         {
266:             address token = baseToken[_request.chainId];
267:             uint256 baseTokenMsgValue;
268:             if (token == ETH_TOKEN_ADDRESS) {
269:                 require(
270:                     msg.value == _request.mintValue + _request.secondBridgeValue,
271:                     "Bridgehub: msg.value mismatch 2"
272:                 );
273:                 baseTokenMsgValue = _request.mintValue;
274:             } else {
275:                 require(msg.value == _request.secondBridgeValue, "Bridgehub: msg.value mismatch 3");
276:                 baseTokenMsgValue = 0;
277:             }
278:             sharedBridge.bridgehubDepositBaseToken{value: baseTokenMsgValue}(
279:                 _request.chainId,
280:                 msg.sender,
281:                 token,
282:                 _request.mintValue
283:             );
284:         }


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L220-L234) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L265-L284)


```solidity

File: contracts/state-transition/libraries/TransactionValidator.sol

75:         {
76:             // Adding the intrinsic cost for the transaction, i.e. auxiliary prices which cannot be easily accounted for
77:             costForComputation = L1_TX_INTRINSIC_L2_GAS;
78: 
79:             // Taking into account the hashing costs that depend on the length of the transaction
80:             // Note that L1_TX_DELTA_544_ENCODING_BYTES is the delta in the price for every 544 bytes of
81:             // the transaction's encoding. It is taken as LCM between 136 and 32 (the length for each keccak256 round
82:             // and the size of each new encoding word).
83:             costForComputation += Math.ceilDiv(_encodingLength * L1_TX_DELTA_544_ENCODING_BYTES, 544);
84: 
85:             // Taking into the account the additional costs of providing new factory dependencies
86:             costForComputation += _numberOfFactoryDependencies * L1_TX_DELTA_FACTORY_DEPS_L2_GAS;
87: 
88:             // There is a minimal amount of computational L2 gas that the transaction should cover
89:             costForComputation = Math.max(costForComputation, L1_TX_MIN_L2_GAS_BASE);
90:         }

93:         {
94:             // Adding the intrinsic cost for the transaction, i.e. auxiliary prices which cannot be easily accounted for
95:             costForPubdata = L1_TX_INTRINSIC_PUBDATA * _l2GasPricePerPubdata;
96: 
97:             // Taking into the account the additional costs of providing new factory dependencies
98:             costForPubdata += _numberOfFactoryDependencies * L1_TX_DELTA_FACTORY_DEPS_PUBDATA * _l2GasPricePerPubdata;
99:         }


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/TransactionValidator.sol#L75-L90) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/TransactionValidator.sol#L93-L99)


</details>


### [NC&#x2011;120] OpenZeppelin libraries should be upgraded to a newer version 
These contracts import some OpenZeppelin libraries, but they are using an old version.


*There are 21 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/bridge/L1ERC20Bridge.sol

5: import {IERC20} from "@openzeppelin/contracts/token/ERC20/IERC20.sol";

6: import {SafeERC20} from "@openzeppelin/contracts/token/ERC20/utils/SafeERC20.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1ERC20Bridge.sol#L5-L5) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1ERC20Bridge.sol#L6-L6)


```solidity

File: contracts/bridge/L1SharedBridge.sol

5: import {Initializable} from "@openzeppelin/contracts/proxy/utils/Initializable.sol";

6: import {Ownable2Step} from "@openzeppelin/contracts/access/Ownable2Step.sol";

8: import {IERC20Metadata} from "@openzeppelin/contracts/token/ERC20/extensions/IERC20Metadata.sol";

9: import {IERC20} from "@openzeppelin/contracts/token/ERC20/IERC20.sol";

10: import {SafeERC20} from "@openzeppelin/contracts/token/ERC20/utils/SafeERC20.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L5-L5) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L6-L6), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L8-L8), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L9-L9), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L10-L10)


```solidity

File: contracts/bridgehub/Bridgehub.sol

5: import {Ownable2Step} from "@openzeppelin/contracts/access/Ownable2Step.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L5-L5) 


```solidity

File: contracts/governance/Governance.sol

5: import {Ownable2Step} from "@openzeppelin/contracts/access/Ownable2Step.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/Governance.sol#L5-L5) 


```solidity

File: contracts/state-transition/StateTransitionManager.sol

16: import {Ownable2Step} from "@openzeppelin/contracts/access/Ownable2Step.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L16-L16) 


```solidity

File: contracts/state-transition/ValidatorTimelock.sol

5: import {Ownable2Step} from "@openzeppelin/contracts/access/Ownable2Step.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L5-L5) 


```solidity

File: contracts/state-transition/chain-deps/facets/Mailbox.sol

5: import {Math} from "@openzeppelin/contracts/utils/math/Math.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L5-L5) 


```solidity

File: contracts/state-transition/libraries/Diamond.sol

5: import {SafeCast} from "@openzeppelin/contracts/utils/math/SafeCast.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L5-L5) 


```solidity

File: contracts/state-transition/libraries/TransactionValidator.sol

5: import {Math} from "@openzeppelin/contracts/utils/math/Math.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/TransactionValidator.sol#L5-L5) 


```solidity

File: contracts/bridge/L2SharedBridge.sol

5: import {Initializable} from "@openzeppelin/contracts/proxy/utils/Initializable.sol";

6: import {BeaconProxy} from "@openzeppelin/contracts/proxy/beacon/BeaconProxy.sol";

7: import {UpgradeableBeacon} from "@openzeppelin/contracts/proxy/beacon/UpgradeableBeacon.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L5-L5) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L6-L6), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L7-L7)


```solidity

File: contracts/bridge/L2StandardERC20.sol

5: import {ERC20PermitUpgradeable} from "@openzeppelin/contracts-upgradeable/token/ERC20/extensions/draft-ERC20PermitUpgradeable.sol";

6: import {UpgradeableBeacon} from "@openzeppelin/contracts/proxy/beacon/UpgradeableBeacon.sol";

7: import {ERC1967Upgrade} from "@openzeppelin/contracts/proxy/ERC1967/ERC1967Upgrade.sol";

5: import {ERC20PermitUpgradeable} from "@openzeppelin/contracts-upgradeable/token/ERC20/extensions/draft-ERC20PermitUpgradeable.sol";


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2StandardERC20.sol#L5-L5) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2StandardERC20.sol#L6-L6), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2StandardERC20.sol#L7-L7), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2StandardERC20.sol#L5-L5)


</details>


### [NC&#x2011;121] Not using the latest version of `prb-math` from dependencies 
`prb-math` is an important mathematical library The package.json configuration file says that the project is using an old version of `prb-math`.


*There are 3 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: package.json

//@audit `prb-math` version is 
1: 

//@audit `prb-math` version is 
1: 

//@audit `prb-math` version is 
1: 


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//package.json#L1-L1) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//package.json#L1-L1), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//package.json#L1-L1)


</details>


### [NC&#x2011;122] Enforcing Lowercase and Underscores Only in the `name` Field of package.json 
package.json name variable should only consist of lowercase letters and underscores


*There are 3 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: package.json

//@audit package.json name is system-contracts
1: {

//@audit package.json name is l1-contracts
1: {

//@audit package.json name is l2-contracts
1: {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//package.json#L1-L1) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//package.json#L1-L1), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//package.json#L1-L1)


</details>


### [NC&#x2011;123] Non constant/immutable state variables are missing a setter post deployment 
Non-constant or non-immutable state variables lacking a setter function can create inflexibility in contract operations. If there's no way to update these variables post-deployment, the contract might not adapt to changing conditions or requirements, which can be a significant drawback, especially in upgradable or long-lived contracts. To resolve this, implement setter functions guarded by appropriate access controls, like `onlyOwner` or similar modifiers, so that these variables can be updated as required while maintaining security. This enables smoother contract maintenance and feature upgrades.


*There are 15 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/SystemContext.sol

37:     uint256 public blockGasLimit = type(uint32).max;

41:     address public coinbase = BOOTLOADER_FORMAL_ADDRESS;

44:     uint256 public difficulty = 2.5e15;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L37-L37) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L41-L41), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L44-L44)


```solidity

File: contracts/bridge/L1ERC20Bridge.sol

27:     mapping(uint256 l2BatchNumber => mapping(uint256 l2ToL1MessageNumber => bool isFinalized))
28:         public isWithdrawalFinalized;

32:     mapping(address account => mapping(address l1Token => mapping(bytes32 depositL2TxHash => uint256 amount)))
33:         public depositAmount;

36:     address public l2Bridge;

39:     address public l2TokenBeacon;

42:     bytes32 public l2TokenProxyBytecodeHash;

45:     mapping(address => uint256) private __DEPRECATED_lastWithdrawalLimitReset;

48:     mapping(address => uint256) private __DEPRECATED_withdrawnAmountInWindow;

51:     mapping(address => mapping(address => uint256)) private __DEPRECATED_totalDepositedAmountPerUser;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1ERC20Bridge.sol#L27-L28) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1ERC20Bridge.sol#L32-L33), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1ERC20Bridge.sol#L36-L36), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1ERC20Bridge.sol#L39-L39), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1ERC20Bridge.sol#L42-L42), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1ERC20Bridge.sol#L45-L45), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1ERC20Bridge.sol#L48-L48), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1ERC20Bridge.sol#L51-L51)


```solidity

File: contracts/bridge/L1SharedBridge.sol

57:     mapping(uint256 chainId => mapping(uint256 l2BatchNumber => mapping(uint256 l2ToL1MessageNumber => bool isFinalized)))
58:         public isWithdrawalFinalized;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L57-L58) 


```solidity

File: contracts/state-transition/ValidatorTimelock.sol

47:     mapping(uint256 => LibMap.Uint32Map) internal committedBatchTimestamp;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L47-L47) 


```solidity

File: contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol

12:     ZkSyncStateTransitionStorage internal s;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L12-L12) 


```solidity

File: contracts/bridge/L2SharedBridge.sol

37:     address private l1LegacyBridge;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L37-L37) 


</details>


### [NC&#x2011;124] Consider making private state variables internal to increase flexibility 
In Solidity, `private` state variables are strictly confined to the contract they are defined in and can't be accessed or modified by its derived contracts. While this offers strong encapsulation, it can limit contract extensibility and modification in inheritance chains. On the other hand, `internal` variables can be accessed and potentially overridden by child contracts, granting more flexibility in contract development and upgrades. Therefore, it's recommended to use `private` only when you explicitly want to prevent child contract access. Otherwise, prefer `internal` to maintain a balance between encapsulation and the flexibility offered by inheritance patterns in Solidity.


*There are 16 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/NonceHolder.sol

28:     uint256 private constant DEPLOY_NONCE_MULTIPLIER = 2 ** 128;

31:     uint256 private constant MAXIMAL_MIN_NONCE_INCREMENT = 2 ** 32;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/NonceHolder.sol#L28-L28) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/NonceHolder.sol#L31-L31)


```solidity

File: contracts/bridge/L1ERC20Bridge.sol

45:     mapping(address => uint256) private __DEPRECATED_lastWithdrawalLimitReset;

48:     mapping(address => uint256) private __DEPRECATED_withdrawnAmountInWindow;

51:     mapping(address => mapping(address => uint256)) private __DEPRECATED_totalDepositedAmountPerUser;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1ERC20Bridge.sol#L45-L45) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1ERC20Bridge.sol#L48-L48), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1ERC20Bridge.sol#L51-L51)


```solidity

File: contracts/bridgehub/Bridgehub.sol

35:     address private pendingAdmin;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L35-L35) 


```solidity

File: contracts/state-transition/StateTransitionManager.sol

54:     address private pendingAdmin;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L54-L54) 


```solidity

File: contracts/common/libraries/L2ContractHelper.sol

12:     bytes32 private constant CREATE2_PREFIX = keccak256("zksyncCreate2");


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/L2ContractHelper.sol#L12-L12) 


```solidity

File: contracts/state-transition/libraries/Diamond.sol

21:     bytes32 private constant DIAMOND_STORAGE_POSITION =
22:         0xc8fcad8db84d3cc18b4c41d551ea0ee66dd599cde068d998e57d5e09332c131b; // keccak256("diamond.standard.diamond.storage") - 1;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L21-L22) 


```solidity

File: contracts/common/ReentrancyGuard.sol

29:     uint256 private constant LOCK_FLAG_ADDRESS = 0x8e94fed44239eb2314ab7a406345e6c5a8f0ccedf3b600de3d004e672c33abf4;

38:     uint256 private constant _NOT_ENTERED = 1;

39:     uint256 private constant _ENTERED = 2;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/ReentrancyGuard.sol#L29-L29) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/ReentrancyGuard.sol#L38-L38), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/ReentrancyGuard.sol#L39-L39)


```solidity

File: contracts/bridge/L2SharedBridge.sol

37:     address private l1LegacyBridge;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L37-L37) 


```solidity

File: contracts/bridge/L2StandardERC20.sol

26:     ERC20Getters private availableGetters;

31:     uint8 private decimals_;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2StandardERC20.sol#L26-L26) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2StandardERC20.sol#L31-L31)


```solidity

File: contracts/L2ContractHelper.sol

85:     bytes32 private constant CREATE2_PREFIX = keccak256("zksyncCreate2");


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/L2ContractHelper.sol#L85-L85) 


</details>


### [NC&#x2011;125] Using Low-Level Call for Transfers 
Utilizing low-level calls like `.call{value: value}` for Ether transfers in Ethereum can be risky, as it can inadvertently allow malicious contract executions through fallback functions. To mitigate these risks and ensure safer Ether transfers, it is recommended to adopt more secure and explicit methods provided by reputable libraries such as OpenZeppelin. Functions like `Address.sendValue()` from OpenZeppelin provide a clearer and safer alternative for sending Ether, as they encapsulate necessary checks and error handling, ensuring that Ether is transferred securely and any errors are appropriately dealt with. This not only enhances the security of your smart contract but also improves code readability and maintainability, aligning with modern Solidity development practices.


*There are 1 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/governance/Governance.sol

226:             (bool success, bytes memory returnData) = _calls[i].target.call{value: _calls[i].value}(_calls[i].data);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/Governance.sol#L226-L226) 


</details>


### [NC&#x2011;126] Off-by-one timestamp error 
In Solidity, using `>=` or `<=` to compare against `block.timestamp` (alias `now`) may introduce off-by-one errors due to the fact that `block.timestamp` is only updated once per block and its value remains constant throughout the block's execution. If an operation happens at the exact second when `block.timestamp` changes, it could result in unexpected behavior. To avoid this, it's safer to use strict inequality operators (`>` or `<`). For instance, if a condition should only be met after a certain time, use `block.timestamp > time` rather than `block.timestamp >= time`. This way, potential off-by-one errors due to the exact timing of block mining are mitigated, leading to safer, more predictable contract behavior.


*There are 4 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/state-transition/ValidatorTimelock.sol

195:                 require(block.timestamp >= commitBatchTimestamp + delay, "5c"); // The delay is not passed

217:                 require(block.timestamp >= commitBatchTimestamp + delay, "5c"); // The delay is not passed


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L195-L195) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L217-L217)


```solidity

File: contracts/upgrades/BaseZkSyncUpgrade.sol

72:         require(block.timestamp >= _proposedUpgrade.upgradeTimestamp, "Upgrade is not ready yet");


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgrade.sol#L72-L72) 


```solidity

File: contracts/upgrades/BaseZkSyncUpgradeGenesis.sol

52:         require(block.timestamp >= _proposedUpgrade.upgradeTimestamp, "Upgrade is not ready yet");


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L52-L52) 


</details>


### [NC&#x2011;127] Lack of space near the operator 
Lack of space near operators in code can lead to reduced readability, making it more challenging to distinguish between different elements and understand the logic quickly. As a resolution, always include spaces around operators to ensure a clear visual separation, which promotes better maintainability and comprehension of the code.


*There are 15 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/Constants.sol

//@audit operator : -
94: uint256 constant MAX_MSG_VALUE = 2 ** 128 - 1;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Constants.sol#L94-L94) 


```solidity

File: contracts/libraries/Utils.sol

//@audit operator : %
88:         require(lengthInWords % 2 == 1, "pr"); // bytecode length in words must be odd


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L88-L88) 


```solidity

File: contracts/state-transition/ValidatorTimelock.sol

//@audit operator : +
195:                 require(block.timestamp >= commitBatchTimestamp + delay, "5c"); // The delay is not passed

//@audit operator : +
217:                 require(block.timestamp >= commitBatchTimestamp + delay, "5c"); // The delay is not passed


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L195-L195) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L217-L217)


```solidity

File: contracts/state-transition/chain-deps/facets/Executor.sol

593:         return (_bitMap & (1 << _index)) > 0;

//@audit operator : +
37:         require(_newBatch.batchNumber == _previousBatch.batchNumber + 1, "f"); // only commit next batch

//@audit operator : -
122:         require(block.timestamp - COMMIT_TIMESTAMP_NOT_OLDER <= batchTimestamp, "h1"); // New batch timestamp is too small

//@audit operator : +
123:         require(lastL2BlockTimestamp <= block.timestamp + COMMIT_TIMESTAMP_APPROXIMATION_DELTA, "h2"); // The last L2 block timestamp is too big

//@audit operator : +
323:         require(currentBatchNumber == s.totalBatchesExecuted + _executedBatchIdx + 1, "k"); // Execute batches in order

//@audit operator : +
323:         require(currentBatchNumber == s.totalBatchesExecuted + _executedBatchIdx + 1, "k"); // Execute batches in order


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L593-L593) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L37-L37), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L122-L122), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L123-L123), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L323-L323), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L323-L323)


```solidity

File: contracts/state-transition/chain-deps/facets/Mailbox.sol

//@audit operator : +
272:         require(_mintValue >= baseCost + _params.l2Value, "mv"); // The `msg.value` doesn't cover the transaction cost

//@audit operator : +
283:         _params.expirationTimestamp = uint64(block.timestamp + PRIORITY_EXPIRATION); // Safe to cast


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L272-L272) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L283-L283)


```solidity

File: contracts/common/libraries/L2ContractHelper.sol

//@audit operator : %
27:         require(bytecodeLenInWords % 2 == 1, "ps"); // bytecode length in words must be odd

//@audit operator : %
43:         require(bytecodeLen(_bytecodeHash) % 2 == 1, "uy"); // Code length in words must be odd


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/L2ContractHelper.sol#L27-L27) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/L2ContractHelper.sol#L43-L43)


```solidity

File: contracts/state-transition/libraries/Merkle.sol

26:         require(_index < (1 << pathLength), "px");


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Merkle.sol#L26-L26) 


</details>


### [NC&#x2011;128] Incorrect withdraw declaration 
In Solidity, it's essential for clarity and interoperability to correctly specify return types in function declarations. If the `withdraw` function is expected to return a `bool` to indicate success or failure, its omission could lead to ambiguity or unexpected behavior when interacting with or calling this function from other contracts or off-chain systems. Missing return values can mislead developers and potentially lead to contract integrations built on incorrect assumptions. To resolve this, the function declaration for `withdraw` should be modified to explicitly include the `bool` return type, ensuring clarity and correctness in contract interactions.


*There are 6 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/L2BaseToken.sol

72:     function withdraw(address _l1Receiver) external payable override {
73:         uint256 amount = _burnMsgValue();
74: 
75:         // Send the L2 log, a user could use it as proof of the withdrawal
76:         bytes memory message = _getL1WithdrawMessage(_l1Receiver, amount);
77:         L1_MESSENGER_CONTRACT.sendToL1(message);
78: 
79:         emit Withdrawal(msg.sender, _l1Receiver, amount);
80:     }


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L2BaseToken.sol#L72-L80) 


```solidity

File: contracts/interfaces/IBaseToken.sol

20:     function withdraw(address _l1Receiver) external payable;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IBaseToken.sol#L20-L20) 


```solidity

File: contracts/bridge/interfaces/IL2Bridge.sol

15:     function withdraw(address _l1Receiver, address _l2Token, uint256 _amount) external;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL2Bridge.sol#L15-L15) 


```solidity

File: contracts/bridge/interfaces/IWETH9.sol

7:     function withdraw(uint256 wad) external;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IWETH9.sol#L7-L7) 


```solidity

File: contracts/bridge/L2SharedBridge.sol

123:     function withdraw(address _l1Receiver, address _l2Token, uint256 _amount) external override {
124:         require(_amount > 0, "Amount cannot be zero");
125: 
126:         IL2StandardToken(_l2Token).bridgeBurn(msg.sender, _amount);
127: 
128:         address l1Token = l1TokenAddress[_l2Token];
129:         require(l1Token != address(0), "yh");
130: 
131:         bytes memory message = _getL1WithdrawMessage(_l1Receiver, l1Token, _amount);
132:         L2ContractHelper.sendMessageToL1(message);
133: 
134:         emit WithdrawalInitiated(msg.sender, _l1Receiver, _l2Token, _amount);
135:     }


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L123-L135) 


```solidity

File: contracts/bridge/interfaces/IL2SharedBridge.sol

32:     function withdraw(address _l1Receiver, address _l2Token, uint256 _amount) external;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL2SharedBridge.sol#L32-L32) 


</details>


### [NC&#x2011;129] Avoid mutating function parameters 
Function parameters in Solidity are passed by value, meaning they are essentially local copies. Mutating them can lead to confusion and errors because the changes don't persist outside the function. By keeping function parameters immutable, you ensure clarity in code behavior, preventing unintended side-effects. If you need to modify a value based on a parameter, use a local variable inside the function, leaving the original parameter unaltered. By adhering to this practice, you maintain a clear distinction between input data and the internal processing logic, improving code readability and reducing the potential for bugs.


*There are 5 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/SystemContext.sol

//@audit the following parameters are mutated _maxVirtualBlocksToCreate,
263:     function _setVirtualBlock(
264:         uint128 _l2BlockNumber,
265:         uint128 _maxVirtualBlocksToCreate,
266:         uint128 _newTimestamp
267:     ) internal {
268:         if (virtualBlockUpgradeInfo.virtualBlockFinishL2Block != 0) {
269:             // No need to to do anything about virtual blocks anymore
270:             // All the info is the same as for L2 blocks.
271:             currentVirtualL2BlockInfo = currentL2BlockInfo;
272:             return;
273:         }
274: 
275:         BlockInfo memory virtualBlockInfo = currentVirtualL2BlockInfo;
276: 
277:         if (currentVirtualL2BlockInfo.number == 0 && virtualBlockInfo.timestamp == 0) {
278:             uint128 currentBatchNumber = currentBatchInfo.number;
279: 
280:             // The virtual block is set for the first time. We can count it as 1 creation of a virtual block.
281:             // Note, that when setting the virtual block number we use the batch number to make a smoother upgrade from batch number to
282:             // the L2 block number.
283:             virtualBlockInfo.number = currentBatchNumber;
284:             // Remembering the batch number on which the upgrade to the virtual blocks has been done.
285:             virtualBlockUpgradeInfo.virtualBlockStartBatch = currentBatchNumber;
286: 
287:             require(_maxVirtualBlocksToCreate > 0, "Can't initialize the first virtual block");
288:             _maxVirtualBlocksToCreate -= 1;
289:         } else if (_maxVirtualBlocksToCreate == 0) {
290:             // The virtual blocks have been already initialized, but the operator didn't ask to create
291:             // any new virtual blocks. So we can just return.
292:             return;
293:         }
294: 
295:         virtualBlockInfo.number += _maxVirtualBlocksToCreate;
296:         virtualBlockInfo.timestamp = _newTimestamp;
297: 
298:         // The virtual block number must never exceed the L2 block number.
299:         // We do not use a `require` here, since the virtual blocks are a temporary solution to let the Solidity's `block.number`
300:         // catch up with the L2 block number and so the situation where virtualBlockInfo.number starts getting larger
301:         // than _l2BlockNumber is expected once virtual blocks have caught up the L2 blocks.
302:         if (virtualBlockInfo.number >= _l2BlockNumber) {
303:             virtualBlockUpgradeInfo.virtualBlockFinishL2Block = _l2BlockNumber;
304:             virtualBlockInfo.number = _l2BlockNumber;
305:         }
306: 
307:         currentVirtualL2BlockInfo = virtualBlockInfo;
308:     }


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L263-L308) 


```solidity

File: contracts/libraries/RLPEncoder.sol

//@audit the following parameters are mutated _number,
084:     function _highestByteSet(uint256 _number) private pure returns (uint256 hbs) {
085:         unchecked {
086:             if (_number > type(uint128).max) {
087:                 _number >>= 128;
088:                 hbs += 16;
089:             }
090:             if (_number > type(uint64).max) {
091:                 _number >>= 64;
092:                 hbs += 8;
093:             }
094:             if (_number > type(uint32).max) {
095:                 _number >>= 32;
096:                 hbs += 4;
097:             }
098:             if (_number > type(uint16).max) {
099:                 _number >>= 16;
100:                 hbs += 2;
101:             }
102:             if (_number > type(uint8).max) {
103:                 hbs += 1;
104:             }
105:         }
106:     }


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/RLPEncoder.sol#L84-L106) 


```solidity

File: contracts/state-transition/chain-deps/facets/Executor.sol

//@audit the following parameters are mutated _lastCommittedBatchData,
253:     function _commitBatchesWithoutSystemContractsUpgrade(
254:         StoredBatchInfo memory _lastCommittedBatchData,
255:         CommitBatchInfo[] calldata _newBatchesData
256:     ) internal {
257:         for (uint256 i = 0; i < _newBatchesData.length; i = i.uncheckedInc()) {
258:             _lastCommittedBatchData = _commitOneBatch(_lastCommittedBatchData, _newBatchesData[i], bytes32(0));
259: 
260:             s.storedBatchHashes[_lastCommittedBatchData.batchNumber] = _hashStoredBatchInfo(_lastCommittedBatchData);
261:             emit BlockCommit(
262:                 _lastCommittedBatchData.batchNumber,
263:                 _lastCommittedBatchData.batchHash,
264:                 _lastCommittedBatchData.commitment
265:             );
266:         }
267:     }

//@audit the following parameters are mutated _lastCommittedBatchData,
273:     function _commitBatchesWithSystemContractsUpgrade(
274:         StoredBatchInfo memory _lastCommittedBatchData,
275:         CommitBatchInfo[] calldata _newBatchesData,
276:         bytes32 _systemContractUpgradeTxHash
277:     ) internal {
278:         // The system contract upgrade is designed to be executed atomically with the new bootloader, a default account,
279:         // ZKP verifier, and other system parameters. Hence, we ensure that the upgrade transaction is
280:         // carried out within the first batch committed after the upgrade.
281: 
282:         // While the logic of the contract ensures that the s.l2SystemContractsUpgradeBatchNumber is 0 when this function is called,
283:         // this check is added just in case. Since it is a hot read, it does not encure noticeable gas cost.
284:         require(s.l2SystemContractsUpgradeBatchNumber == 0, "ik");
285: 
286:         // Save the batch number where the upgrade transaction was executed.
287:         s.l2SystemContractsUpgradeBatchNumber = _newBatchesData[0].batchNumber;
288: 
289:         for (uint256 i = 0; i < _newBatchesData.length; i = i.uncheckedInc()) {
290:             // The upgrade transaction must only be included in the first batch.
291:             bytes32 expectedUpgradeTxHash = i == 0 ? _systemContractUpgradeTxHash : bytes32(0);
292:             _lastCommittedBatchData = _commitOneBatch(
293:                 _lastCommittedBatchData,
294:                 _newBatchesData[i],
295:                 expectedUpgradeTxHash
296:             );
297: 
298:             s.storedBatchHashes[_lastCommittedBatchData.batchNumber] = _hashStoredBatchInfo(_lastCommittedBatchData);
299:             emit BlockCommit(
300:                 _lastCommittedBatchData.batchNumber,
301:                 _lastCommittedBatchData.batchHash,
302:                 _lastCommittedBatchData.commitment
303:             );
304:         }
305:     }


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L253-L267) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L273-L305)


```solidity

File: contracts/state-transition/libraries/Merkle.sol

//@audit the following parameters are mutated _index,
18:     function calculateRoot(
19:         bytes32[] calldata _path,
20:         uint256 _index,
21:         bytes32 _itemHash
22:     ) internal pure returns (bytes32) {
23:         uint256 pathLength = _path.length;
24:         require(pathLength > 0, "xc");
25:         require(pathLength < 256, "bt");
26:         require(_index < (1 << pathLength), "px");
27: 
28:         bytes32 currentHash = _itemHash;
29:         for (uint256 i; i < pathLength; i = i.uncheckedInc()) {
30:             currentHash = (_index % 2 == 0)
31:                 ? _efficientHash(currentHash, _path[i])
32:                 : _efficientHash(_path[i], currentHash);
33:             _index /= 2;
34:         }
35: 
36:         return currentHash;
37:     }


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Merkle.sol#L18-L37) 


</details>


### [NC&#x2011;130] A event should be emitted if a non immutable state variable is set in a constructor 



*There are 6 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/bridge/L1ERC20Bridge.sol

56:         sharedBridge = _sharedBridge;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1ERC20Bridge.sol#L56-L56) 


```solidity

File: contracts/bridge/L1SharedBridge.sol

96:         l1WethAddress = _l1WethAddress;

97:         bridgehub = _bridgehub;

98:         legacyBridge = _legacyBridge;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L96-L96) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L97-L97), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L98-L98)


```solidity

File: contracts/state-transition/StateTransitionManager.sol

59:         bridgehub = _bridgehub;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L59-L59) 


```solidity

File: contracts/state-transition/ValidatorTimelock.sol

57:         executionDelay = _executionDelay;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L57-L57) 


</details>


### [NC&#x2011;131] Contracts use both += 1 and ++ (-- and -= 1) 
For consistency consider only using one of these incrementing methods. The instances bellow represents the less used technique.


*There are 2 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/Compressor.sol

175:             stateDiffPtr += 1;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Compressor.sol#L175-L175) 


```solidity

File: contracts/state-transition/chain-deps/facets/Executor.sol

657:             versionedHashIndex += 1;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L657-L657) 


</details>


### [NC&#x2011;132] [Solidity]: Order of Argument Evaluation Disrupted in Non-Expression-Split Code by Optimizer Sequences with FullInliner 
Function call arguments in Yul are evaluated right to left. This order matters when the argument expressions have side-effects, and changing it may change contract behavior. FullInliner is an optimizer step that can replace a function call with the body of that function. The transformation involves assigning argument expressions to temporary variables, which imposes an explicit evaluation order. FullInliner was written with the assumption that this order does not necessarily have to match usual argument evaluation order because the argument expressions have no side-effects. In most circumstances this assumption is true because the default optimization step sequence contains the ExpressionSplitter step. ExpressionSplitter ensures that the code is in *expression-split form*, which means that function calls cannot appear nested inside expressions, and all function call arguments have to be variables. The assumption is, however, not guaranteed to be true in general. Version 0.6.7 introduced a setting allowing users to specify an arbitrary optimization step sequence, making it possible for the FullInliner to actually encounter argument expressions with side-effects, which can result in behavior differences between optimized and unoptimized bytecode. Contracts compiled without optimization or with the default optimization sequence are not affected. To trigger the bug the user has to explicitly choose compiler settings that contain a sequence with FullInliner step not preceded by ExpressionSplitter. [Ref](https://blog.soliditylang.org/2023/07/19/full-inliner-non-expression-split-argument-evaluation-order-bug/)


*There are 104 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/AccountCodeStorage.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/AccountCodeStorage.sol#L3-L3) 


```solidity

File: contracts/BootloaderUtilities.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L3-L3) 


```solidity

File: contracts/ComplexUpgrader.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ComplexUpgrader.sol#L3-L3) 


```solidity

File: contracts/Compressor.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Compressor.sol#L3-L3) 


```solidity

File: contracts/Constants.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Constants.sol#L3-L3) 


```solidity

File: contracts/ContractDeployer.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L3-L3) 


```solidity

File: contracts/DefaultAccount.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/DefaultAccount.sol#L3-L3) 


```solidity

File: contracts/EmptyContract.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/EmptyContract.sol#L3-L3) 


```solidity

File: contracts/ImmutableSimulator.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ImmutableSimulator.sol#L3-L3) 


```solidity

File: contracts/KnownCodesStorage.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/KnownCodesStorage.sol#L3-L3) 


```solidity

File: contracts/L1Messenger.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L3-L3) 


```solidity

File: contracts/L2BaseToken.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L2BaseToken.sol#L3-L3) 


```solidity

File: contracts/MsgValueSimulator.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/MsgValueSimulator.sol#L3-L3) 


```solidity

File: contracts/NonceHolder.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/NonceHolder.sol#L3-L3) 


```solidity

File: contracts/PubdataChunkPublisher.sol

2: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/PubdataChunkPublisher.sol#L2-L2) 


```solidity

File: contracts/SystemContext.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L3-L3) 


```solidity

File: contracts/libraries/EfficientCall.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L3-L3) 


```solidity

File: contracts/libraries/RLPEncoder.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/RLPEncoder.sol#L3-L3) 


```solidity

File: contracts/libraries/SystemContractHelper.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L3-L3) 


```solidity

File: contracts/libraries/SystemContractsCaller.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractsCaller.sol#L3-L3) 


```solidity

File: contracts/libraries/TransactionHelper.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L3-L3) 


```solidity

File: contracts/libraries/UnsafeBytesCalldata.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/UnsafeBytesCalldata.sol#L3-L3) 


```solidity

File: contracts/libraries/Utils.sol

2: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L2-L2) 


```solidity

File: contracts/interfaces/IAccount.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IAccount.sol#L3-L3) 


```solidity

File: contracts/interfaces/IAccountCodeStorage.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IAccountCodeStorage.sol#L3-L3) 


```solidity

File: contracts/interfaces/IBaseToken.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IBaseToken.sol#L3-L3) 


```solidity

File: contracts/interfaces/IBootloaderUtilities.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IBootloaderUtilities.sol#L3-L3) 


```solidity

File: contracts/interfaces/IComplexUpgrader.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IComplexUpgrader.sol#L3-L3) 


```solidity

File: contracts/interfaces/ICompressor.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ICompressor.sol#L3-L3) 


```solidity

File: contracts/interfaces/IContractDeployer.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IContractDeployer.sol#L3-L3) 


```solidity

File: contracts/interfaces/IImmutableSimulator.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IImmutableSimulator.sol#L3-L3) 


```solidity

File: contracts/interfaces/IKnownCodesStorage.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IKnownCodesStorage.sol#L3-L3) 


```solidity

File: contracts/interfaces/IL1Messenger.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IL1Messenger.sol#L3-L3) 


```solidity

File: contracts/interfaces/IL2StandardToken.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IL2StandardToken.sol#L3-L3) 


```solidity

File: contracts/interfaces/IMailbox.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IMailbox.sol#L3-L3) 


```solidity

File: contracts/interfaces/INonceHolder.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/INonceHolder.sol#L3-L3) 


```solidity

File: contracts/interfaces/IPaymaster.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IPaymaster.sol#L3-L3) 


```solidity

File: contracts/interfaces/IPaymasterFlow.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IPaymasterFlow.sol#L3-L3) 


```solidity

File: contracts/interfaces/IPubdataChunkPublisher.sol

2: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IPubdataChunkPublisher.sol#L2-L2) 


```solidity

File: contracts/interfaces/ISystemContext.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ISystemContext.sol#L3-L3) 


```solidity

File: contracts/interfaces/ISystemContextDeprecated.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ISystemContextDeprecated.sol#L3-L3) 


```solidity

File: contracts/interfaces/ISystemContract.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ISystemContract.sol#L3-L3) 


```solidity

File: contracts/bridge/L1ERC20Bridge.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1ERC20Bridge.sol#L3-L3) 


```solidity

File: contracts/bridge/L1SharedBridge.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L3-L3) 


```solidity

File: contracts/bridgehub/Bridgehub.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L3-L3) 


```solidity

File: contracts/governance/Governance.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/Governance.sol#L3-L3) 


```solidity

File: contracts/state-transition/StateTransitionManager.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L3-L3) 


```solidity

File: contracts/state-transition/ValidatorTimelock.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L3-L3) 


```solidity

File: contracts/state-transition/chain-deps/DiamondInit.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/DiamondInit.sol#L3-L3) 


```solidity

File: contracts/state-transition/chain-deps/DiamondProxy.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/DiamondProxy.sol#L3-L3) 


```solidity

File: contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L3-L3) 


```solidity

File: contracts/state-transition/chain-deps/facets/Admin.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Admin.sol#L3-L3) 


```solidity

File: contracts/state-transition/chain-deps/facets/Executor.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L3-L3) 


```solidity

File: contracts/state-transition/chain-deps/facets/Getters.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L3-L3) 


```solidity

File: contracts/state-transition/chain-deps/facets/Mailbox.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L3-L3) 


```solidity

File: contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L3-L3) 


```solidity

File: contracts/upgrades/BaseZkSyncUpgrade.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgrade.sol#L3-L3) 


```solidity

File: contracts/upgrades/BaseZkSyncUpgradeGenesis.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L3-L3) 


```solidity

File: contracts/upgrades/DefaultUpgrade.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/DefaultUpgrade.sol#L3-L3) 


```solidity

File: contracts/upgrades/GenesisUpgrade.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/GenesisUpgrade.sol#L3-L3) 


```solidity

File: contracts/common/libraries/L2ContractHelper.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/L2ContractHelper.sol#L3-L3) 


```solidity

File: contracts/common/libraries/UncheckedMath.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/UncheckedMath.sol#L3-L3) 


```solidity

File: contracts/common/libraries/UnsafeBytes.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/UnsafeBytes.sol#L3-L3) 


```solidity

File: contracts/state-transition/libraries/Diamond.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L3-L3) 


```solidity

File: contracts/state-transition/libraries/LibMap.sol

2: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/LibMap.sol#L2-L2) 


```solidity

File: contracts/state-transition/libraries/Merkle.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Merkle.sol#L3-L3) 


```solidity

File: contracts/state-transition/libraries/PriorityQueue.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/PriorityQueue.sol#L3-L3) 


```solidity

File: contracts/state-transition/libraries/TransactionValidator.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/TransactionValidator.sol#L3-L3) 


```solidity

File: contracts/bridge/interfaces/IL1ERC20Bridge.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1ERC20Bridge.sol#L3-L3) 


```solidity

File: contracts/bridge/interfaces/IL1SharedBridge.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L3-L3) 


```solidity

File: contracts/bridge/interfaces/IL2Bridge.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL2Bridge.sol#L3-L3) 


```solidity

File: contracts/bridge/interfaces/IWETH9.sol

2: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IWETH9.sol#L2-L2) 


```solidity

File: contracts/bridgehub/IBridgehub.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L3-L3) 


```solidity

File: contracts/common/interfaces/IL2ContractDeployer.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/interfaces/IL2ContractDeployer.sol#L3-L3) 


```solidity

File: contracts/governance/IGovernance.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/IGovernance.sol#L3-L3) 


```solidity

File: contracts/state-transition/IStateTransitionManager.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/IStateTransitionManager.sol#L3-L3) 


```solidity

File: contracts/state-transition/chain-interfaces/IAdmin.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IAdmin.sol#L3-L3) 


```solidity

File: contracts/state-transition/chain-interfaces/IDiamondInit.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IDiamondInit.sol#L3-L3) 


```solidity

File: contracts/state-transition/chain-interfaces/IExecutor.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IExecutor.sol#L3-L3) 


```solidity

File: contracts/state-transition/chain-interfaces/IGetters.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IGetters.sol#L3-L3) 


```solidity

File: contracts/state-transition/chain-interfaces/ILegacyGetters.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/ILegacyGetters.sol#L3-L3) 


```solidity

File: contracts/state-transition/chain-interfaces/IMailbox.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IMailbox.sol#L3-L3) 


```solidity

File: contracts/state-transition/chain-interfaces/IVerifier.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IVerifier.sol#L3-L3) 


```solidity

File: contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol#L3-L3) 


```solidity

File: contracts/state-transition/chain-interfaces/IZkSyncStateTransitionBase.sol

2: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IZkSyncStateTransitionBase.sol#L2-L2) 


```solidity

File: contracts/state-transition/l2-deps/ISystemContext.sol

2: pragma solidity ^0.8.0;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/l2-deps/ISystemContext.sol#L2-L2) 


```solidity

File: contracts/upgrades/IDefaultUpgrade.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/IDefaultUpgrade.sol#L3-L3) 


```solidity

File: contracts/common/Config.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/Config.sol#L3-L3) 


```solidity

File: contracts/common/L2ContractAddresses.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/L2ContractAddresses.sol#L3-L3) 


```solidity

File: contracts/common/Messaging.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/Messaging.sol#L3-L3) 


```solidity

File: contracts/common/ReentrancyGuard.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/ReentrancyGuard.sol#L3-L3) 


```solidity

File: contracts/vendor/AddressAliasHelper.sol

19: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/vendor/AddressAliasHelper.sol#L19-L19) 


```solidity

File: contracts/bridge/L2SharedBridge.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L3-L3) 


```solidity

File: contracts/bridge/L2StandardERC20.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2StandardERC20.sol#L3-L3) 


```solidity

File: contracts/bridge/interfaces/IL1ERC20Bridge.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL1ERC20Bridge.sol#L3-L3) 


```solidity

File: contracts/bridge/interfaces/IL1SharedBridge.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL1SharedBridge.sol#L3-L3) 


```solidity

File: contracts/bridge/interfaces/IL2SharedBridge.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL2SharedBridge.sol#L3-L3) 


```solidity

File: contracts/bridge/interfaces/IL2StandardToken.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL2StandardToken.sol#L3-L3) 


```solidity

File: contracts/interfaces/IPaymaster.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/interfaces/IPaymaster.sol#L3-L3) 


```solidity

File: contracts/interfaces/IPaymasterFlow.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/interfaces/IPaymasterFlow.sol#L3-L3) 


```solidity

File: contracts/vendor/AddressAliasHelper.sol

19: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/vendor/AddressAliasHelper.sol#L19-L19) 


```solidity

File: contracts/ForceDeployUpgrader.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/ForceDeployUpgrader.sol#L3-L3) 


```solidity

File: contracts/L2ContractHelper.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/L2ContractHelper.sol#L3-L3) 


```solidity

File: contracts/SystemContractsCaller.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/SystemContractsCaller.sol#L3-L3) 


</details>


### [NC&#x2011;133] Not using the named return variables anywhere in the function is confusing 
Consider changing the variable to be an unnamed one, since the variable is never assigned, nor is it returned by name. If the optimizer is not turned on, leaving the code as it is will also waste gas for the stack variable.


*There are 4 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/BootloaderUtilities.sol

// @audit txHash
44:     function encodeLegacyTransactionHash(Transaction calldata _transaction) internal view returns (bytes32 txHash) {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L44-L44) 


```solidity

File: contracts/ContractDeployer.sol

// @audit info
34:     function getAccountInfo(address _address) external view returns (AccountInfo memory info) {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L34-L34) 


```solidity

File: contracts/bridgehub/Bridgehub.sol

// @audit chainId
114:     function createNewChain(


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L114-L114) 


```solidity

File: contracts/state-transition/libraries/Diamond.sol

// @audit diamondStorage
87:     function getDiamondStorage() internal pure returns (DiamondStorage storage diamondStorage) {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L87-L87) 


</details>


### [NC&#x2011;134] Use named return values 
Using named returns makes the code more self-documenting, makes it easier to fill out NatSpec, and in some cases can save gas. The cases below are where there currently is at most one return statement, which is ideal for named returns.


*There are 145 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/AccountCodeStorage.sol

89:     function getCodeHash(uint256 _input) external view override returns (bytes32) {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/AccountCodeStorage.sol#L89-L89) 


```solidity

File: contracts/BootloaderUtilities.sol

139:     function encodeEIP2930TransactionHash(Transaction calldata _transaction) internal view returns (bytes32) {

229:     function encodeEIP1559TransactionHash(Transaction calldata _transaction) internal view returns (bytes32) {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L139-L139) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L229-L229)


```solidity

File: contracts/ContractDeployer.sol

40:     function extendedAccountVersion(address _address) public view returns (AccountAbstractionVersion) {

132:     function create2(
133:         bytes32 _salt,
134:         bytes32 _bytecodeHash,
135:         bytes calldata _input
136:     ) external payable override returns (address) {

147:     function create(
148:         bytes32 _salt,
149:         bytes32 _bytecodeHash,
150:         bytes calldata _input
151:     ) external payable override returns (address) {

162:     function create2Account(
163:         bytes32 _salt,
164:         bytes32 _bytecodeHash,
165:         bytes calldata _input,
166:         AccountAbstractionVersion _aaVersion
167:     ) public payable override onlySystemCall returns (address) {

182:     function createAccount(
183:         bytes32, // salt
184:         bytes32 _bytecodeHash,
185:         bytes calldata _input,
186:         AccountAbstractionVersion _aaVersion
187:     ) public payable override onlySystemCall returns (address) {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L40-L40) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L132-L136), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L147-L151), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L162-L167), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L182-L187)


```solidity

File: contracts/DefaultAccount.sol

159:     function _isValidSignature(bytes32 _hash, bytes memory _signature) internal view returns (bool) {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/DefaultAccount.sol#L159-L159) 


```solidity

File: contracts/ImmutableSimulator.sol

27:     function getImmutable(address _dest, uint256 _index) external view override returns (bytes32) {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ImmutableSimulator.sol#L27-L27) 


```solidity

File: contracts/L1Messenger.sol

50:     function keccakGasCost(uint256 _length) internal pure returns (uint256) {

61:     function sha256GasCost(uint256 _length) internal pure returns (uint256) {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L50-L50) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L1Messenger.sol#L61-L61)


```solidity

File: contracts/L2BaseToken.sol

56:     function balanceOf(uint256 _account) external view override returns (uint256) {

112:     function _getL1WithdrawMessage(address _to, uint256 _amount) internal pure returns (bytes memory) {

117:     function _getExtendedWithdrawMessage(
118:         address _to,
119:         uint256 _amount,
120:         address _sender,
121:         bytes memory _additionalData
122:     ) internal pure returns (bytes memory) {

128:     function name() external pure override returns (string memory) {

134:     function symbol() external pure override returns (string memory) {

140:     function decimals() external pure override returns (uint8) {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L2BaseToken.sol#L56-L56) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L2BaseToken.sol#L112-L112), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L2BaseToken.sol#L117-L122), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L2BaseToken.sol#L128-L128), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L2BaseToken.sol#L134-L134), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L2BaseToken.sol#L140-L140)


```solidity

File: contracts/MsgValueSimulator.sol

47:     fallback(bytes calldata _data) external onlySystemCall returns (bytes memory) {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/MsgValueSimulator.sol#L47-L47) 


```solidity

File: contracts/NonceHolder.sol

46:     function getMinNonce(address _address) public view returns (uint256) {

57:     function getRawNonce(address _address) public view returns (uint256) {

102:     function getValueUnderNonce(uint256 _key) public view returns (uint256) {

154:     function isNonceUsed(address _address, uint256 _nonce) public view returns (bool) {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/NonceHolder.sol#L46-L46) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/NonceHolder.sol#L57-L57), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/NonceHolder.sol#L102-L102), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/NonceHolder.sol#L154-L154)


```solidity

File: contracts/SystemContext.sol

117:     function getCurrentPubdataSpent() public view returns (uint256) {

122:     function getCurrentPubdataCost() external view returns (uint256) {

190:     function getBlockNumber() public view returns (uint128) {

198:     function getBlockTimestamp() public view returns (uint128) {

205:     function _getLatest257L2blockHash(uint256 _block) internal view returns (bytes32) {

221:     function _calculateL2BlockHash(
222:         uint128 _blockNumber,
223:         uint128 _blockTimestamp,
224:         bytes32 _prevL2BlockHash,
225:         bytes32 _blockTxsRollingHash
226:     ) internal pure returns (bytes32) {

233:     function _calculateLegacyL2BlockHash(uint128 _blockNumber) internal pure returns (bytes32) {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L117-L117) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L122-L122), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L190-L190), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L198-L198), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L205-L205), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L221-L226), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L233-L233)


```solidity

File: contracts/libraries/EfficientCall.sol

36:     function keccak(bytes calldata _data) internal view returns (bytes32) {

45:     function sha(bytes calldata _data) internal view returns (bytes32) {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L36-L36) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L45-L45)


```solidity

File: contracts/libraries/RLPEncoder.sol

49:     function encodeNonSingleBytesLen(uint64 _len) internal pure returns (bytes memory) {

56:     function encodeListLen(uint64 _len) internal pure returns (bytes memory) {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/RLPEncoder.sol#L49-L49) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/RLPEncoder.sol#L56-L56)


```solidity

File: contracts/libraries/SystemContractHelper.sol

329:     function isSystemCall() internal view returns (bool) {

338:     function isSystemContract(address _address) internal pure returns (bool) {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L329-L329) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L338-L338)


```solidity

File: contracts/libraries/TransactionHelper.sol

94:     function isEthToken(uint256 _addr) internal pure returns (bool) {

118:     function _encodeHashEIP712Transaction(Transaction calldata _transaction) private view returns (bytes32) {

147:     function _encodeHashLegacyTransaction(Transaction calldata _transaction) private view returns (bytes32) {

219:     function _encodeHashEIP2930Transaction(Transaction calldata _transaction) private view returns (bytes32) {

289:     function _encodeHashEIP1559Transaction(Transaction calldata _transaction) private view returns (bytes32) {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L94-L94) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L118-L118), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L147-L147), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L219-L219), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L289-L289)


```solidity

File: contracts/libraries/Utils.sol

20:     function safeCastToU128(uint256 _x) internal pure returns (uint128) {

26:     function safeCastToU32(uint256 _x) internal pure returns (uint32) {

32:     function safeCastToU24(uint256 _x) internal pure returns (uint24) {

51:     function isContractConstructed(bytes32 _bytecodeHash) internal pure returns (bool) {

56:     function isContractConstructing(bytes32 _bytecodeHash) internal pure returns (bool) {

63:     function constructingBytecodeHash(bytes32 _bytecodeHash) internal pure returns (bytes32) {

71:     function constructedBytecodeHash(bytes32 _bytecodeHash) internal pure returns (bytes32) {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L20-L20) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L26-L26), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L32-L32), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L51-L51), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L56-L56), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L63-L63), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L71-L71)


```solidity

File: contracts/bridge/L1ERC20Bridge.sol

75:     function l2TokenAddress(address _l1Token) external view returns (address) {

160:     function _depositFundsToSharedBridge(address _from, IERC20 _token, uint256 _amount) internal returns (uint256) {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1ERC20Bridge.sol#L75-L75) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1ERC20Bridge.sol#L160-L160)


```solidity

File: contracts/bridge/L1SharedBridge.sol

173:     function _depositFunds(address _from, IERC20 _token, uint256 _amount) internal returns (uint256) {

243:     function _getDepositL2Calldata(
244:         address _l1Sender,
245:         address _l2Receiver,
246:         address _l1Token,
247:         uint256 _amount
248:     ) internal view returns (bytes memory) {

254:     function _getERC20Getters(address _token) internal view returns (bytes memory) {

374:     function _isEraLegacyWithdrawal(uint256 _chainId, uint256 _l2BatchNumber) internal view returns (bool) {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L173-L173) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L243-L248), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L254-L254), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L374-L374)


```solidity

File: contracts/bridgehub/Bridgehub.sol

75:     function getStateTransition(uint256 _chainId) public view returns (address) {

152:     function proveL2MessageInclusion(
153:         uint256 _chainId,
154:         uint256 _batchNumber,
155:         uint256 _index,
156:         L2Message calldata _message,
157:         bytes32[] calldata _proof
158:     ) external view override returns (bool) {

164:     function proveL2LogInclusion(
165:         uint256 _chainId,
166:         uint256 _batchNumber,
167:         uint256 _index,
168:         L2Log memory _log,
169:         bytes32[] calldata _proof
170:     ) external view override returns (bool) {

176:     function proveL1ToL2TransactionStatus(
177:         uint256 _chainId,
178:         bytes32 _l2TxHash,
179:         uint256 _l2BatchNumber,
180:         uint256 _l2MessageIndex,
181:         uint16 _l2TxNumberInBatch,
182:         bytes32[] calldata _merkleProof,
183:         TxStatus _status
184:     ) external view override returns (bool) {

198:     function l2TransactionBaseCost(
199:         uint256 _chainId,
200:         uint256 _gasPrice,
201:         uint256 _l2GasLimit,
202:         uint256 _l2GasPerPubdataByteLimit
203:     ) external view returns (uint256) {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L75-L75) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L152-L158), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L164-L170), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L176-L184), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L198-L203)


```solidity

File: contracts/governance/Governance.sol

84:     function isOperation(bytes32 _id) public view returns (bool) {

89:     function isOperationPending(bytes32 _id) public view returns (bool) {

95:     function isOperationReady(bytes32 _id) public view returns (bool) {

100:     function isOperationDone(bytes32 _id) public view returns (bool) {

105:     function getOperationState(bytes32 _id) public view returns (OperationState) {

204:     function hashOperation(Operation calldata _operation) public pure returns (bytes32) {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/Governance.sol#L84-L84) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/Governance.sol#L89-L89), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/Governance.sol#L95-L95), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/Governance.sol#L100-L100), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/Governance.sol#L105-L105), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/Governance.sol#L204-L204)


```solidity

File: contracts/state-transition/StateTransitionManager.sol

74:     function getChainAdmin(uint256 _chainId) external view override returns (address) {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L74-L74) 


```solidity

File: contracts/state-transition/ValidatorTimelock.sol

102:     function getCommittedBatchTimestamp(uint256 _chainId, uint256 _l2BatchNumber) external view returns (uint256) {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L102-L102) 


```solidity

File: contracts/state-transition/chain-deps/DiamondInit.sol

24:     function initialize(InitializeData calldata _initializeData) external reentrancyGuardInitializer returns (bytes32) {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/DiamondInit.sol#L24-L24) 


```solidity

File: contracts/state-transition/chain-deps/facets/Executor.sol

32:     function _commitOneBatch(
33:         StoredBatchInfo memory _previousBatch,
34:         CommitBatchInfo calldata _newBatch,
35:         bytes32 _expectedSystemContractUpgradeTxHash
36:     ) internal view returns (StoredBatchInfo memory) {

453:     function _getBatchProofPublicInput(
454:         bytes32 _prevBatchCommitment,
455:         bytes32 _currentBatchCommitment,
456:         VerifierParams memory _verifierParams
457:     ) internal pure returns (uint256) {

500:     function _createBatchCommitment(
501:         CommitBatchInfo calldata _newBatchData,
502:         bytes32 _stateDiffHash,
503:         bytes32[] memory _blobCommitments,
504:         bytes32[] memory _blobHashes
505:     ) internal view returns (bytes32) {

515:     function _batchPassThroughData(CommitBatchInfo calldata _batch) internal pure returns (bytes memory) {

525:     function _batchMetaParameters() internal view returns (bytes memory) {

537:     function _batchAuxiliaryOutput(
538:         CommitBatchInfo calldata _batch,
539:         bytes32 _stateDiffHash,
540:         bytes32[] memory _blobCommitments,
541:         bytes32[] memory _blobHashes
542:     ) internal pure returns (bytes memory) {

587:     function _hashStoredBatchInfo(StoredBatchInfo memory _storedBatchInfo) internal pure returns (bytes32) {

592:     function _checkBit(uint256 _bitMap, uint8 _index) internal pure returns (bool) {

597:     function _setBit(uint256 _bitMap, uint8 _index) internal pure returns (uint256) {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L32-L36) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L453-L457), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L500-L505), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L515-L515), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L525-L525), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L537-L542), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L587-L587), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L592-L592), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L597-L597)


```solidity

File: contracts/state-transition/chain-deps/facets/Getters.sol

32:     function getVerifier() external view returns (address) {

37:     function getAdmin() external view returns (address) {

42:     function getPendingAdmin() external view returns (address) {

47:     function getBridgehub() external view returns (address) {

52:     function getStateTransitionManager() external view returns (address) {

57:     function getBaseToken() external view returns (address) {

62:     function getBaseTokenBridge() external view returns (address) {

67:     function baseTokenGasPriceMultiplierNominator() external view returns (uint128) {

72:     function baseTokenGasPriceMultiplierDenominator() external view returns (uint128) {

77:     function getTotalBatchesCommitted() external view returns (uint256) {

82:     function getTotalBatchesVerified() external view returns (uint256) {

87:     function getTotalBatchesExecuted() external view returns (uint256) {

92:     function getTotalPriorityTxs() external view returns (uint256) {

97:     function getFirstUnprocessedPriorityTx() external view returns (uint256) {

102:     function getPriorityQueueSize() external view returns (uint256) {

107:     function priorityQueueFrontOperation() external view returns (PriorityOperation memory) {

112:     function isValidator(address _address) external view returns (bool) {

117:     function l2LogsRootHash(uint256 _batchNumber) external view returns (bytes32) {

122:     function storedBatchHash(uint256 _batchNumber) external view returns (bytes32) {

127:     function getL2BootloaderBytecodeHash() external view returns (bytes32) {

132:     function getL2DefaultAccountBytecodeHash() external view returns (bytes32) {

137:     function getVerifierParams() external view returns (VerifierParams memory) {

142:     function getProtocolVersion() external view returns (uint256) {

147:     function getL2SystemContractsUpgradeTxHash() external view returns (bytes32) {

152:     function getL2SystemContractsUpgradeBatchNumber() external view returns (uint256) {

157:     function isDiamondStorageFrozen() external view returns (bool) {

176:     function getPriorityTxMaxGasLimit() external view returns (uint256) {

181:     function isFunctionFreezable(bytes4 _selector) external view returns (bool) {

188:     function isEthWithdrawalFinalized(uint256 _l2BatchNumber, uint256 _l2MessageIndex) external view returns (bool) {

193:     function getPubdataPricingMode() external view returns (PubdataPricingMode) {

217:     function facetFunctionSelectors(address _facet) external view returns (bytes4[] memory) {

223:     function facetAddresses() external view returns (address[] memory) {

229:     function facetAddress(bytes4 _selector) external view returns (address) {

239:     function getTotalBlocksCommitted() external view returns (uint256) {

244:     function getTotalBlocksVerified() external view returns (uint256) {

249:     function getTotalBlocksExecuted() external view returns (uint256) {

254:     function storedBlockHash(uint256 _batchNumber) external view returns (bytes32) {

259:     function getL2SystemContractsUpgradeBlockNumber() external view returns (uint256) {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L32-L32) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L37-L37), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L42-L42), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L47-L47), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L52-L52), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L57-L57), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L62-L62), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L67-L67), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L72-L72), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L77-L77), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L82-L82), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L87-L87), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L92-L92), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L97-L97), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L102-L102), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L107-L107), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L112-L112), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L117-L117), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L122-L122), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L127-L127), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L132-L132), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L137-L137), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L142-L142), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L147-L147), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L152-L152), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L157-L157), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L176-L176), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L181-L181), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L188-L188), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L193-L193), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L217-L217), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L223-L223), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L229-L229), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L239-L239), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L244-L244), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L249-L249), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L254-L254), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L259-L259)


```solidity

File: contracts/state-transition/chain-deps/facets/Mailbox.sol

54:     function proveL2MessageInclusion(
55:         uint256 _batchNumber,
56:         uint256 _index,
57:         L2Message memory _message,
58:         bytes32[] calldata _proof
59:     ) public view returns (bool) {

64:     function proveL2LogInclusion(
65:         uint256 _batchNumber,
66:         uint256 _index,
67:         L2Log memory _log,
68:         bytes32[] calldata _proof
69:     ) external view returns (bool) {

74:     function proveL1ToL2TransactionStatus(
75:         bytes32 _l2TxHash,
76:         uint256 _l2BatchNumber,
77:         uint256 _l2MessageIndex,
78:         uint16 _l2TxNumberInBatch,
79:         bytes32[] calldata _merkleProof,
80:         TxStatus _status
81:     ) public view returns (bool) {

104:     function _proveL2LogInclusion(
105:         uint256 _batchNumber,
106:         uint256 _index,
107:         L2Log memory _log,
108:         bytes32[] calldata _proof
109:     ) internal view returns (bool) {

130:     function _L2MessageToLog(L2Message memory _message) internal pure returns (L2Log memory) {

143:     function l2TransactionBaseCost(
144:         uint256 _gasPrice,
145:         uint256 _l2GasLimit,
146:         uint256 _l2GasPerPubdataByteLimit
147:     ) public view returns (uint256) {

156:     function _deriveL2GasPrice(uint256 _l1GasPrice, uint256 _gasPerPubdata) internal view returns (uint256) {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L54-L59) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L64-L69), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L74-L81), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L104-L109), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L130-L130), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L143-L147), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L156-L156)


```solidity

File: contracts/upgrades/BaseZkSyncUpgrade.sol

180:     function _setL2SystemContractUpgrade(
181:         L2CanonicalTransaction calldata _l2ProtocolUpgradeTx,
182:         bytes[] calldata _factoryDeps,
183:         uint256 _newProtocolVersion
184:     ) internal returns (bytes32) {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgrade.sol#L180-L184) 


```solidity

File: contracts/upgrades/BaseZkSyncUpgradeGenesis.sol

47:     function upgrade(ProposedUpgrade calldata _proposedUpgrade) public virtual override returns (bytes32) {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L47-L47) 


```solidity

File: contracts/upgrades/DefaultUpgrade.sol

13:     function upgrade(ProposedUpgrade calldata _proposedUpgrade) public override returns (bytes32) {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/DefaultUpgrade.sol#L13-L13) 


```solidity

File: contracts/upgrades/GenesisUpgrade.sol

14:     function upgrade(ProposedUpgrade calldata _proposedUpgrade) public override returns (bytes32) {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/GenesisUpgrade.sol#L14-L14) 


```solidity

File: contracts/common/libraries/L2ContractHelper.sol

60:     function computeCreate2Address(
61:         address _sender,
62:         bytes32 _salt,
63:         bytes32 _bytecodeHash,
64:         bytes32 _constructorInputHash
65:     ) internal pure returns (address) {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/L2ContractHelper.sol#L60-L65) 


```solidity

File: contracts/common/libraries/UncheckedMath.sol

11:     function uncheckedInc(uint256 _number) internal pure returns (uint256) {

17:     function uncheckedAdd(uint256 _lhs, uint256 _rhs) internal pure returns (uint256) {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/UncheckedMath.sol#L11-L11) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/UncheckedMath.sol#L17-L17)


```solidity

File: contracts/state-transition/libraries/Merkle.sol

18:     function calculateRoot(
19:         bytes32[] calldata _path,
20:         uint256 _index,
21:         bytes32 _itemHash
22:     ) internal pure returns (bytes32) {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Merkle.sol#L18-L22) 


```solidity

File: contracts/state-transition/libraries/PriorityQueue.sol

35:     function getFirstUnprocessedPriorityTx(Queue storage _queue) internal view returns (uint256) {

40:     function getTotalPriorityTxs(Queue storage _queue) internal view returns (uint256) {

45:     function getSize(Queue storage _queue) internal view returns (uint256) {

50:     function isEmpty(Queue storage _queue) internal view returns (bool) {

64:     function front(Queue storage _queue) internal view returns (PriorityOperation memory) {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/PriorityQueue.sol#L35-L35) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/PriorityQueue.sol#L40-L40), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/PriorityQueue.sol#L45-L45), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/PriorityQueue.sol#L50-L50), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/PriorityQueue.sol#L64-L64)


```solidity

File: contracts/state-transition/libraries/TransactionValidator.sol

69:     function getMinimalPriorityTransactionGasLimit(
70:         uint256 _encodingLength,
71:         uint256 _numberOfFactoryDependencies,
72:         uint256 _l2GasPricePerPubdata
73:     ) internal pure returns (uint256) {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/TransactionValidator.sol#L69-L73) 


```solidity

File: contracts/bridge/L2SharedBridge.sol

109:     function _deployL2Token(address _l1Token, bytes calldata _data) internal returns (address) {

138:     function _getL1WithdrawMessage(
139:         address _to,
140:         address _l1Token,
141:         uint256 _amount
142:     ) internal pure returns (bytes memory) {

149:     function l2TokenAddress(address _l1Token) public view override returns (address) {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L109-L109) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L138-L142), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L149-L149)


```solidity

File: contracts/bridge/L2StandardERC20.sol

159:     function name() public view override returns (string memory) {

165:     function symbol() public view override returns (string memory) {

171:     function decimals() public view override returns (uint8) {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2StandardERC20.sol#L159-L159) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2StandardERC20.sol#L165-L165), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2StandardERC20.sol#L171-L171)


```solidity

File: contracts/L2ContractHelper.sol

90:     function sendMessageToL1(bytes memory _message) internal returns (bytes32) {

101:     function computeCreate2Address(
102:         address _sender,
103:         bytes32 _salt,
104:         bytes32 _bytecodeHash,
105:         bytes32 _constructorInputHash
106:     ) internal pure returns (address) {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/L2ContractHelper.sol#L90-L90) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/L2ContractHelper.sol#L101-L106)


```solidity

File: contracts/SystemContractsCaller.sol

27:     function safeCastToU32(uint256 _x) internal pure returns (uint32) {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/SystemContractsCaller.sol#L27-L27) 


</details>


### [NC&#x2011;135] Consider moving duplicated strings to constants 



*There are 27 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/AccountCodeStorage.sol

26:         require(msg.sender == address(DEPLOYER_SYSTEM_CONTRACT), "Callable only by the deployer system contract");

37:         require(Utils.isContractConstructing(_hash), "Code hash is not for a contract on constructor");


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/AccountCodeStorage.sol#L26-L26) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/AccountCodeStorage.sol#L37-L37)


```solidity

File: contracts/BootloaderUtilities.sol

92:             require(vInt == 27 || vInt == 28, "Invalid v value");

213:                     "\x01",

308:                     "\x02",


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L92-L92) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L213-L213), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/BootloaderUtilities.sol#L308-L308)


```solidity

File: contracts/ImmutableSimulator.sol

35:         require(msg.sender == address(DEPLOYER_SYSTEM_CONTRACT), "Callable only by the deployer system contract");


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ImmutableSimulator.sol#L35-L35) 


```solidity

File: contracts/libraries/TransactionHelper.sol

277:                     "\x01",

349:                     "\x02",


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L277-L277) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/TransactionHelper.sol#L349-L349)


```solidity

File: contracts/libraries/Utils.sol

21:         require(_x <= type(uint128).max, "Overflow");


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/Utils.sol#L21-L21) 


```solidity

File: contracts/bridge/L1ERC20Bridge.sol

143:         require(amount == _amount, "3T"); // The token has non-standard transfer logic


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1ERC20Bridge.sol#L143-L143) 


```solidity

File: contracts/bridge/L1SharedBridge.sol

161:             require(amount == _amount, "3T"); // The token has non-standard transfer logic


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L161-L161) 


```solidity

File: contracts/bridgehub/Bridgehub.sol

46:         require(msg.sender == admin || msg.sender == owner(), "Bridgehub: not owner or admin");

62:         require(msg.sender == currentPendingAdmin, "n42"); // Only proposed by current admin address can claim the admin rights


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L46-L46) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L62-L62)


```solidity

File: contracts/state-transition/StateTransitionManager.sol

70:         require(msg.sender == admin || msg.sender == owner(), "Bridgehub: not owner or admin");

121:         require(msg.sender == currentPendingAdmin, "n42"); // Only proposed by current admin address can claim the admin rights


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L70-L70) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L121-L121)


```solidity

File: contracts/state-transition/ValidatorTimelock.sol

195:                 require(block.timestamp >= commitBatchTimestamp + delay, "5c"); // The delay is not passed


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L195-L195) 


```solidity

File: contracts/upgrades/BaseZkSyncUpgrade.sol

72:         require(block.timestamp >= _proposedUpgrade.upgradeTimestamp, "Upgrade is not ready yet");

240:             "New protocol version is not greater than the current one"

244:             "Too big protocol version difference"

249:         require(s.l2SystemContractsUpgradeTxHash == bytes32(0), "Previous upgrade has not been finalized");

252:             "The batch number of the previous upgrade has not been cleaned"


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgrade.sol#L72-L72) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgrade.sol#L240-L240), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgrade.sol#L244-L244), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgrade.sol#L249-L249), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgrade.sol#L252-L252)


```solidity

File: contracts/upgrades/BaseZkSyncUpgradeGenesis.sol

52:         require(block.timestamp >= _proposedUpgrade.upgradeTimestamp, "Upgrade is not ready yet");

25:             "New protocol version is not greater than the current one"

29:             "Too big protocol version difference"

33:         require(s.l2SystemContractsUpgradeTxHash == bytes32(0), "Previous upgrade has not been finalized");

36:             "The batch number of the previous upgrade has not been cleaned"


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L52-L52) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L25-L25), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L29-L29), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L33-L33), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L36-L36)


```solidity

File: contracts/bridge/L2SharedBridge.sol

56:         require(_l2TokenProxyBytecodeHash != bytes32(0), "df");


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L56-L56) 


</details>


### [NC&#x2011;136] Unused `public` contract variable 
If these serve no purpose, they should be safely removed


*There are 3 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/SystemContext.sol

//@audit the variable `blockGasLimit` is declared but never used
37:     uint256 public blockGasLimit = type(uint32).max;

//@audit the variable `coinbase` is declared but never used
41:     address public coinbase = BOOTLOADER_FORMAL_ADDRESS;

//@audit the variable `difficulty` is declared but never used
44:     uint256 public difficulty = 2.5e15;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L37-L37) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L41-L41), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L44-L44)


</details>


### [NC&#x2011;137] Missing checks for uint state variable assignments 
Consider whether reasonable bounds checks for variables would be useful


*There are 13 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/SystemContext.sol

85:         chainId = _newChainId;

106:         gasPrice = _gasPrice;

113:         basePubdataSpent = _basePubdataSpent;

114:         gasPerPubdataByte = _gasPerPubdataByte;

463:         baseFee = _baseFee;

479:         baseFee = _baseFee;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L85-L85) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L106-L106), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L113-L113), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L114-L114), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L463-L463), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L479-L479)


```solidity

File: contracts/bridge/L1SharedBridge.sol

111:         eraFirstPostUpgradeBatch = _eraFirstPostUpgradeBatch;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L111-L111) 


```solidity

File: contracts/governance/Governance.sol

49:         minDelay = _minDelay;

251:         minDelay = _newDelay;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/Governance.sol#L49-L49) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/Governance.sol#L251-L251)


```solidity

File: contracts/state-transition/StateTransitionManager.sol

148:         protocolVersion = _newProtocolVersion;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L148-L148) 


```solidity

File: contracts/state-transition/ValidatorTimelock.sol

57:         executionDelay = _executionDelay;

97:         executionDelay = _executionDelay;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L57-L57) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L97-L97)


```solidity

File: contracts/bridge/L2StandardERC20.sol

95:             decimals_ = decimalsUint8;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2StandardERC20.sol#L95-L95) 


</details>


### [NC&#x2011;138] Consider adding validation of user inputs 



*There are 162 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/AccountCodeStorage.sol

//@audit these parameters `_address`, are not checked
35:     function storeAccountConstructingCodeHash(address _address, bytes32 _hash) external override onlyDeployer {

//@audit these parameters `_address`, are not checked
46:     function storeAccountConstructedCodeHash(address _address, bytes32 _hash) external override onlyDeployer {

//@audit these parameters `_address`, are not checked
54:     function markAccountCodeHashAsConstructed(address _address) external override onlyDeployer {

//@audit these parameters `_address`, are not checked
68:     function _storeCodeHash(address _address, bytes32 _hash) internal {

//@audit these parameters `_address`, are not checked
78:     function getRawCodeHash(address _address) public view override returns (bytes32 codeHash) {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/AccountCodeStorage.sol#L35-L35) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/AccountCodeStorage.sol#L46-L46), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/AccountCodeStorage.sol#L54-L54), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/AccountCodeStorage.sol#L68-L68), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/AccountCodeStorage.sol#L78-L78)


```solidity

File: contracts/ContractDeployer.sol

//@audit these parameters `_address`, are not checked
34:     function getAccountInfo(address _address) external view returns (AccountInfo memory info) {

//@audit these parameters `_address`, are not checked
58:     function _storeAccountInfo(address _address, AccountInfo memory _newInfo) internal {

//@audit these parameters `_sender`, are not checked
95:     function getNewAddressCreate2(
96:         address _sender,
97:         bytes32 _bytecodeHash,
98:         bytes32 _salt,
99:         bytes calldata _input

//@audit these parameters `_sender`, are not checked
115:     function getNewAddressCreate(
116:         address _sender,
117:         uint256 _senderNonce

//@audit these parameters `_sender`, are not checked
213:     function forceDeployOnAddress(ForceDeployment calldata _deployment, address _sender) external payable onlySelf {

//@audit these parameters `_newAddress`, are not checked
283:     function _performDeployOnAddress(
284:         bytes32 _bytecodeHash,
285:         address _newAddress,
286:         AccountAbstractionVersion _aaVersion,
287:         bytes calldata _input

//@audit these parameters `_newAddress`, are not checked
309:     function _storeConstructingByteCodeHashOnAddress(address _newAddress, bytes32 _bytecodeHash) internal {

//@audit these parameters `_sender`,`_newAddress`, are not checked
321:     function _constructContract(
322:         address _sender,
323:         address _newAddress,
324:         bytes32 _bytecodeHash,
325:         bytes calldata _input,
326:         bool _isSystem,
327:         bool _callConstructor


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L34-L34) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L58-L58), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L95-L99), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L115-L117), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L213-L213), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L283-L287), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L309-L309), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L321-L327)


```solidity

File: contracts/ImmutableSimulator.sol

//@audit these parameters `_dest`, are not checked
27:     function getImmutable(address _dest, uint256 _index) external view override returns (bytes32) {

//@audit these parameters `_dest`, are not checked
34:     function setImmutables(address _dest, ImmutableData[] calldata _immutables) external override {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ImmutableSimulator.sol#L27-L27) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ImmutableSimulator.sol#L34-L34)


```solidity

File: contracts/L2BaseToken.sol

//@audit these parameters `_from`,`_to`, are not checked
32:     function transferFromTo(address _from, address _to, uint256 _amount) external override {

//@audit these parameters `_account`, are not checked
64:     function mint(address _account, uint256 _amount) external override onlyCallFromBootloader {

//@audit these parameters `_l1Receiver`, are not checked
72:     function withdraw(address _l1Receiver) external payable override {

//@audit these parameters `_l1Receiver`, are not checked
85:     function withdrawWithMessage(address _l1Receiver, bytes memory _additionalData) external payable override {

//@audit these parameters `_to`, are not checked
112:     function _getL1WithdrawMessage(address _to, uint256 _amount) internal pure returns (bytes memory) {

//@audit these parameters `_to`,`_sender`, are not checked
117:     function _getExtendedWithdrawMessage(
118:         address _to,
119:         uint256 _amount,
120:         address _sender,
121:         bytes memory _additionalData


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L2BaseToken.sol#L32-L32) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L2BaseToken.sol#L64-L64), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L2BaseToken.sol#L72-L72), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L2BaseToken.sol#L85-L85), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L2BaseToken.sol#L112-L112), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L2BaseToken.sol#L117-L121)


```solidity

File: contracts/NonceHolder.sol

//@audit these parameters `_address`, are not checked
46:     function getMinNonce(address _address) public view returns (uint256) {

//@audit these parameters `_address`, are not checked
57:     function getRawNonce(address _address) public view returns (uint256) {

//@audit these parameters `_address`, are not checked
125:     function getDeploymentNonce(address _address) external view returns (uint256 deploymentNonce) {

//@audit these parameters `_address`, are not checked
135:     function incrementDeploymentNonce(address _address) external returns (uint256 prevDeploymentNonce) {

//@audit these parameters `_address`, are not checked
166:     function validateNonceUsage(address _address, uint256 _key, bool _shouldBeUsed) external view {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/NonceHolder.sol#L46-L46) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/NonceHolder.sol#L57-L57), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/NonceHolder.sol#L125-L125), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/NonceHolder.sol#L135-L135), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/NonceHolder.sol#L166-L166)


```solidity

File: contracts/SystemContext.sol

//@audit these parameters `_newOrigin`, are not checked
99:     function setTxOrigin(address _newOrigin) external onlyCallFromBootloader {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L99-L99) 


```solidity

File: contracts/libraries/EfficientCall.sol

//@audit these parameters `_address`, are not checked
58:     function call(
59:         uint256 _gas,
60:         address _address,
61:         uint256 _value,
62:         bytes calldata _data,
63:         bool _isSystem

//@audit these parameters `_address`, are not checked
74:     function staticCall(
75:         uint256 _gas,
76:         address _address,
77:         bytes calldata _data

//@audit these parameters `_address`, are not checked
88:     function delegateCall(
89:         uint256 _gas,
90:         address _address,
91:         bytes calldata _data

//@audit these parameters `_address`,`_whoToMimic`, are not checked
105:     function mimicCall(
106:         uint256 _gas,
107:         address _address,
108:         bytes calldata _data,
109:         address _whoToMimic,
110:         bool _isConstructor,
111:         bool _isSystem

//@audit these parameters `_address`, are not checked
124:     function rawCall(
125:         uint256 _gas,
126:         address _address,
127:         uint256 _value,
128:         bytes calldata _data,
129:         bool _isSystem

//@audit these parameters `_address`, are not checked
159:     function rawStaticCall(uint256 _gas, address _address, bytes calldata _data) internal view returns (bool success) {

//@audit these parameters `_address`, are not checked
173:     function rawDelegateCall(uint256 _gas, address _address, bytes calldata _data) internal returns (bool success) {

//@audit these parameters `_address`,`_whoToMimic`, are not checked
191:     function rawMimicCall(
192:         uint256 _gas,
193:         address _address,
194:         bytes calldata _data,
195:         address _whoToMimic,
196:         bool _isConstructor,
197:         bool _isSystem


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L58-L63) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L74-L77), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L88-L91), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L105-L111), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L124-L129), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L159-L159), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L173-L173), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L191-L197)


```solidity

File: contracts/libraries/RLPEncoder.sol

//@audit these parameters `_val`, are not checked
11:     function encodeAddress(address _val) internal pure returns (bytes memory encoded) {


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/RLPEncoder.sol#L11-L11) 


```solidity

File: contracts/libraries/SystemContractsCaller.sol

//@audit these parameters `to`, are not checked
76:     function systemCall(uint32 gasLimit, address to, uint256 value, bytes memory data) internal returns (bool success) {

//@audit these parameters `to`, are not checked
123:     function systemCallWithReturndata(
124:         uint32 gasLimit,
125:         address to,
126:         uint128 value,
127:         bytes memory data

//@audit these parameters `to`, are not checked
150:     function systemCallWithPropagatedRevert(
151:         uint32 gasLimit,
152:         address to,
153:         uint128 value,
154:         bytes memory data


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractsCaller.sol#L76-L76) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractsCaller.sol#L123-L127), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractsCaller.sol#L150-L154)


```solidity

File: contracts/interfaces/IAccountCodeStorage.sol

//@audit these parameters `_address`, are not checked
6:     function storeAccountConstructingCodeHash(address _address, bytes32 _hash) external;

//@audit these parameters `_address`, are not checked
8:     function storeAccountConstructedCodeHash(address _address, bytes32 _hash) external;

//@audit these parameters `_address`, are not checked
10:     function markAccountCodeHashAsConstructed(address _address) external;

//@audit these parameters `_address`, are not checked
12:     function getRawCodeHash(address _address) external view returns (bytes32 codeHash);


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IAccountCodeStorage.sol#L6-L6) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IAccountCodeStorage.sol#L8-L8), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IAccountCodeStorage.sol#L10-L10), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IAccountCodeStorage.sol#L12-L12)


```solidity

File: contracts/interfaces/IBaseToken.sol

//@audit these parameters `_from`,`_to`, are not checked
8:     function transferFromTo(address _from, address _to, uint256 _amount) external;

//@audit these parameters `_account`, are not checked
18:     function mint(address _account, uint256 _amount) external;

//@audit these parameters `_l1Receiver`, are not checked
20:     function withdraw(address _l1Receiver) external payable;

//@audit these parameters `_l1Receiver`, are not checked
22:     function withdrawWithMessage(address _l1Receiver, bytes calldata _additionalData) external payable;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IBaseToken.sol#L8-L8) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IBaseToken.sol#L18-L18), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IBaseToken.sol#L20-L20), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IBaseToken.sol#L22-L22)


```solidity

File: contracts/interfaces/IComplexUpgrader.sol

//@audit these parameters `_delegateTo`, are not checked
11:     function upgrade(address _delegateTo, bytes calldata _calldata) external payable;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IComplexUpgrader.sol#L11-L11) 


```solidity

File: contracts/interfaces/IContractDeployer.sol

//@audit these parameters `_sender`, are not checked
43:     function getNewAddressCreate2(
44:         address _sender,
45:         bytes32 _bytecodeHash,
46:         bytes32 _salt,
47:         bytes calldata _input

//@audit these parameters `_sender`, are not checked
50:     function getNewAddressCreate(address _sender, uint256 _senderNonce) external pure returns (address newAddress);

//@audit these parameters `_address`, are not checked
84:     function getAccountInfo(address _address) external view returns (AccountInfo memory info);


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IContractDeployer.sol#L43-L47) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IContractDeployer.sol#L50-L50), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IContractDeployer.sol#L84-L84)


```solidity

File: contracts/interfaces/IImmutableSimulator.sol

//@audit these parameters `_dest`, are not checked
11:     function getImmutable(address _dest, uint256 _index) external view returns (bytes32);

//@audit these parameters `_dest`, are not checked
13:     function setImmutables(address _dest, ImmutableData[] calldata _immutables) external;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IImmutableSimulator.sol#L11-L11) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IImmutableSimulator.sol#L13-L13)


```solidity

File: contracts/interfaces/IL2StandardToken.sol

//@audit these parameters `_account`, are not checked
10:     function bridgeMint(address _account, uint256 _amount) external;

//@audit these parameters `_account`, are not checked
12:     function bridgeBurn(address _account, uint256 _amount) external;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IL2StandardToken.sol#L10-L10) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IL2StandardToken.sol#L12-L12)


```solidity

File: contracts/interfaces/INonceHolder.sol

//@audit these parameters `_address`, are not checked
17:     function getMinNonce(address _address) external view returns (uint256);

//@audit these parameters `_address`, are not checked
21:     function getRawNonce(address _address) external view returns (uint256);

//@audit these parameters `_address`, are not checked
37:     function getDeploymentNonce(address _address) external view returns (uint256);

//@audit these parameters `_address`, are not checked
40:     function incrementDeploymentNonce(address _address) external returns (uint256);

//@audit these parameters `_address`, are not checked
43:     function validateNonceUsage(address _address, uint256 _key, bool _shouldBeUsed) external view;

//@audit these parameters `_address`, are not checked
46:     function isNonceUsed(address _address, uint256 _nonce) external view returns (bool);


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/INonceHolder.sol#L17-L17) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/INonceHolder.sol#L21-L21), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/INonceHolder.sol#L37-L37), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/INonceHolder.sol#L40-L40), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/INonceHolder.sol#L43-L43), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/INonceHolder.sol#L46-L46)


```solidity

File: contracts/interfaces/IPaymasterFlow.sol

//@audit these parameters `_token`, are not checked
15:     function approvalBased(address _token, uint256 _minAllowance, bytes calldata _innerInput) external;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IPaymasterFlow.sol#L15-L15) 


```solidity

File: contracts/bridge/L1ERC20Bridge.sol

//@audit these parameters `_token`, are not checked
63:     function tranferTokenToSharedBridge(address _token, uint256 _amount) external {

//@audit these parameters `_l1Token`, are not checked
75:     function l2TokenAddress(address _l1Token) external view returns (address) {

//@audit these parameters `_l2Receiver`,`_l1Token`, are not checked
098:     function deposit(
099:         address _l2Receiver,
100:         address _l1Token,
101:         uint256 _amount,
102:         uint256 _l2TxGasLimit,
103:         uint256 _l2TxGasPerPubdataByte

//@audit these parameters `_l2Receiver`,`_l1Token`,`_refundRecipient`, are not checked
133:     function deposit(
134:         address _l2Receiver,
135:         address _l1Token,
136:         uint256 _amount,
137:         uint256 _l2TxGasLimit,
138:         uint256 _l2TxGasPerPubdataByte,
139:         address _refundRecipient

//@audit these parameters `_from`,`_token`, are not checked
160:     function _depositFundsToSharedBridge(address _from, IERC20 _token, uint256 _amount) internal returns (uint256) {

//@audit these parameters `_depositSender`,`_l1Token`, are not checked
176:     function claimFailedDeposit(
177:         address _depositSender,
178:         address _l1Token,
179:         bytes32 _l2TxHash,
180:         uint256 _l2BatchNumber,
181:         uint256 _l2MessageIndex,
182:         uint16 _l2TxNumberInBatch,
183:         bytes32[] calldata _merkleProof


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1ERC20Bridge.sol#L63-L63) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1ERC20Bridge.sol#L75-L75), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1ERC20Bridge.sol#L98-L103), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1ERC20Bridge.sol#L133-L139), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1ERC20Bridge.sol#L160-L160), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1ERC20Bridge.sol#L176-L183)


```solidity

File: contracts/bridge/L1SharedBridge.sol

//@audit these parameters ``, are not checked
104:     function initialize(
105:         address _owner,
106:         uint256 _eraFirstPostUpgradeBatch

//@audit these parameters `_target`, are not checked
116:     function transferFundsFromLegacy(address _token, address _target, uint256 _targetChainId) external onlyOwner {

//@audit these parameters `_l2BridgeAddress`, are not checked
142:     function initializeChainGovernance(uint256 _chainId, address _l2BridgeAddress) external onlyOwner {

//@audit these parameters `_prevMsgSender`, are not checked
148:     function bridgehubDepositBaseToken(
149:         uint256 _chainId,
150:         address _prevMsgSender,
151:         address _l1Token,
152:         uint256 _amount

//@audit these parameters `_from`,`_token`, are not checked
173:     function _depositFunds(address _from, IERC20 _token, uint256 _amount) internal returns (uint256) {

//@audit these parameters `_prevMsgSender`, are not checked
182:     function bridgehubDeposit(
183:         uint256 _chainId,
184:         address _prevMsgSender,
185:         uint256, // l2Value, needed for Weth deposits in the future
186:         bytes calldata _data

//@audit these parameters `_l1Sender`,`_l2Receiver`,`_l1Token`, are not checked
243:     function _getDepositL2Calldata(
244:         address _l1Sender,
245:         address _l2Receiver,
246:         address _l1Token,
247:         uint256 _amount

//@audit these parameters `_depositSender`,`_l1Token`, are not checked
277:     function claimFailedDeposit(
278:         uint256 _chainId,
279:         address _depositSender,
280:         address _l1Token,
281:         uint256 _amount,
282:         bytes32 _l2TxHash,
283:         uint256 _l2BatchNumber,
284:         uint256 _l2MessageIndex,
285:         uint16 _l2TxNumberInBatch,
286:         bytes32[] calldata _merkleProof

//@audit these parameters `_depositSender`, are not checked
303:     function _claimFailedDeposit(
304:         bool _checkedInLegacyBridge,
305:         uint256 _chainId,
306:         address _depositSender,
307:         address _l1Token,
308:         uint256 _amount,
309:         bytes32 _l2TxHash,
310:         uint256 _l2BatchNumber,
311:         uint256 _l2MessageIndex,
312:         uint16 _l2TxNumberInBatch,
313:         bytes32[] calldata _merkleProof

//@audit these parameters `_l2Receiver`, are not checked
554:     function depositLegacyErc20Bridge(
555:         address _prevMsgSender,
556:         address _l2Receiver,
557:         address _l1Token,
558:         uint256 _amount,
559:         uint256 _l2TxGasLimit,
560:         uint256 _l2TxGasPerPubdataByte,
561:         address _refundRecipient

//@audit these parameters `_depositSender`,`_l1Token`, are not checked
644:     function claimFailedDepositLegacyErc20Bridge(
645:         address _depositSender,
646:         address _l1Token,
647:         uint256 _amount,
648:         bytes32 _l2TxHash,
649:         uint256 _l2BatchNumber,
650:         uint256 _l2MessageIndex,
651:         uint16 _l2TxNumberInBatch,
652:         bytes32[] calldata _merkleProof


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L104-L106) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L116-L116), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L142-L142), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L148-L152), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L173-L173), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L182-L186), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L243-L247), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L277-L286), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L303-L313), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L554-L561), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L644-L652)


```solidity

File: contracts/bridgehub/Bridgehub.sol

//@audit these parameters `_owner`, are not checked
41:     function initialize(address _owner) external reentrancyGuardInitializer {

//@audit these parameters `_newPendingAdmin`, are not checked
51:     function setPendingAdmin(address _newPendingAdmin) external onlyOwnerOrAdmin {

//@audit these parameters `_stateTransitionManager`, are not checked
82:     function addStateTransitionManager(address _stateTransitionManager) external onlyOwner {

//@audit these parameters `_stateTransitionManager`, are not checked
92:     function removeStateTransitionManager(address _stateTransitionManager) external onlyOwner {

//@audit these parameters `_token`, are not checked
101:     function addToken(address _token) external onlyOwner {

//@audit these parameters `_sharedBridge`, are not checked
108:     function setSharedBridge(address _sharedBridge) external onlyOwner {

//@audit these parameters `_stateTransitionManager`,`_baseToken`,`_admin`, are not checked
114:     function createNewChain(
115:         uint256 _chainId,
116:         address _stateTransitionManager,
117:         address _baseToken,
118:         uint256, //_salt
119:         address _admin,
120:         bytes calldata _initData


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L41-L41) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L51-L51), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L82-L82), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L92-L92), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L101-L101), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L108-L108), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/Bridgehub.sol#L114-L120)


```solidity

File: contracts/governance/Governance.sol

//@audit these parameters `_newSecurityCouncil`, are not checked
256:     function updateSecurityCouncil(address _newSecurityCouncil) external onlySelf {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/Governance.sol#L256-L256) 


```solidity

File: contracts/state-transition/StateTransitionManager.sol

//@audit these parameters `_newPendingAdmin`, are not checked
110:     function setPendingAdmin(address _newPendingAdmin) external onlyOwnerOrAdmin {

//@audit these parameters `_validatorTimelock`, are not checked
132:     function setValidatorTimelock(address _validatorTimelock) external onlyOwnerOrAdmin {

//@audit these parameters `_chainContract`, are not checked
177:     function _setChainIdUpgrade(uint256 _chainId, address _chainContract) internal {

//@audit these parameters `_stateTransitionContract`, are not checked
230:     function registerAlreadyDeployedStateTransition(
231:         uint256 _chainId,
232:         address _stateTransitionContract

//@audit these parameters `_baseToken`,`_sharedBridge`,`_admin`, are not checked
239:     function createNewChain(
240:         uint256 _chainId,
241:         address _baseToken,
242:         address _sharedBridge,
243:         address _admin,
244:         bytes calldata _diamondCut


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L110-L110) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L132-L132), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L177-L177), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L230-L232), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L239-L244)


```solidity

File: contracts/state-transition/ValidatorTimelock.sol

//@audit these parameters `_stateTransitionManager`, are not checked
73:     function setStateTransitionManager(IStateTransitionManager _stateTransitionManager) external onlyOwner {

//@audit these parameters `_newValidator`, are not checked
78:     function addValidator(uint256 _chainId, address _newValidator) external onlyChainAdmin(_chainId) {

//@audit these parameters `_validator`, are not checked
87:     function removeValidator(uint256 _chainId, address _validator) external onlyChainAdmin(_chainId) {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L73-L73) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L78-L78), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/ValidatorTimelock.sol#L87-L87)


```solidity

File: contracts/state-transition/chain-deps/facets/Admin.sol

//@audit these parameters `_newPendingAdmin`, are not checked
23:     function setPendingAdmin(address _newPendingAdmin) external onlyAdmin {

//@audit these parameters `_validator`, are not checked
45:     function setValidator(address _validator, bool _active) external onlyStateTransitionManager {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Admin.sol#L23-L23) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Admin.sol#L45-L45)


```solidity

File: contracts/state-transition/chain-deps/facets/Getters.sol

//@audit these parameters `_address`, are not checked
112:     function isValidator(address _address) external view returns (bool) {

//@audit these parameters `_facet`, are not checked
163:     function isFacetFreezable(address _facet) external view returns (bool isFreezable) {

//@audit these parameters `_facet`, are not checked
217:     function facetFunctionSelectors(address _facet) external view returns (bytes4[] memory) {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L112-L112) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L163-L163), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Getters.sol#L217-L217)


```solidity

File: contracts/state-transition/chain-deps/facets/Mailbox.sol

//@audit these parameters `_contractL2`,`_refundRecipient`, are not checked
197:     function requestL2Transaction(
198:         address _contractL2,
199:         uint256 _l2Value,
200:         bytes calldata _calldata,
201:         uint256 _l2GasLimit,
202:         uint256 _l2GasPerPubdataByteLimit,
203:         bytes[] calldata _factoryDeps,
204:         address _refundRecipient


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L197-L204) 


```solidity

File: contracts/upgrades/BaseZkSyncUpgrade.sol

//@audit these parameters `_newVerifier`, are not checked
163:     function _upgradeVerifier(address _newVerifier, VerifierParams calldata _verifierParams) internal {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgrade.sol#L163-L163) 


```solidity

File: contracts/common/libraries/L2ContractHelper.sol

//@audit these parameters `_sender`, are not checked
60:     function computeCreate2Address(
61:         address _sender,
62:         bytes32 _salt,
63:         bytes32 _bytecodeHash,
64:         bytes32 _constructorInputHash


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/libraries/L2ContractHelper.sol#L60-L64) 


```solidity

File: contracts/state-transition/libraries/Diamond.sol

//@audit these parameters ``, are not checked
172:     function _removeFunctions(address _facet, bytes4[] memory _selectors) private {

//@audit these parameters `_facet`, are not checked
189:     function _saveFacetIfNew(address _facet) private {

//@audit these parameters `_facet`, are not checked
205:     function _addOneFunction(address _facet, bytes4 _selector, bool _isSelectorFreezable) private {

//@audit these parameters `_facet`, are not checked
257:     function _removeFacet(address _facet) private {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L172-L172) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L189-L189), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L205-L205), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L257-L257)


```solidity

File: contracts/bridge/interfaces/IL1ERC20Bridge.sol

//@audit these parameters `_l2Receiver`,`_l1Token`,`_refundRecipient`, are not checked
26:     function deposit(
27:         address _l2Receiver,
28:         address _l1Token,
29:         uint256 _amount,
30:         uint256 _l2TxGasLimit,
31:         uint256 _l2TxGasPerPubdataByte,
32:         address _refundRecipient

//@audit these parameters `_l2Receiver`,`_l1Token`, are not checked
35:     function deposit(
36:         address _l2Receiver,
37:         address _l1Token,
38:         uint256 _amount,
39:         uint256 _l2TxGasLimit,
40:         uint256 _l2TxGasPerPubdataByte

//@audit these parameters `_depositSender`,`_l1Token`, are not checked
43:     function claimFailedDeposit(
44:         address _depositSender,
45:         address _l1Token,
46:         bytes32 _l2TxHash,
47:         uint256 _l2BatchNumber,
48:         uint256 _l2MessageIndex,
49:         uint16 _l2TxNumberInBatch,
50:         bytes32[] calldata _merkleProof

//@audit these parameters `_l1Token`, are not checked
61:     function l2TokenAddress(address _l1Token) external view returns (address);

//@audit these parameters `_account`,`_l1Token`, are not checked
69:     function depositAmount(
70:         address _account,
71:         address _l1Token,
72:         bytes32 _depositL2TxHash

//@audit these parameters `_token`, are not checked
75:     function tranferTokenToSharedBridge(address _token, uint256 _amount) external;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1ERC20Bridge.sol#L26-L32) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1ERC20Bridge.sol#L35-L40), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1ERC20Bridge.sol#L43-L50), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1ERC20Bridge.sol#L61-L61), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1ERC20Bridge.sol#L69-L72), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1ERC20Bridge.sol#L75-L75)


```solidity

File: contracts/bridge/interfaces/IL1SharedBridge.sol

//@audit these parameters `_msgSender`,`_l2Receiver`,`_l1Token`,`_refundRecipient`, are not checked
64:     function depositLegacyErc20Bridge(
65:         address _msgSender,
66:         address _l2Receiver,
67:         address _l1Token,
68:         uint256 _amount,
69:         uint256 _l2TxGasLimit,
70:         uint256 _l2TxGasPerPubdataByte,
71:         address _refundRecipient

//@audit these parameters `_depositSender`,`_l1Token`, are not checked
74:     function claimFailedDepositLegacyErc20Bridge(
75:         address _depositSender,
76:         address _l1Token,
77:         uint256 _amount,
78:         bytes32 _l2TxHash,
79:         uint256 _l2BatchNumber,
80:         uint256 _l2MessageIndex,
81:         uint16 _l2TxNumberInBatch,
82:         bytes32[] calldata _merkleProof

//@audit these parameters `_depositSender`,`_l1Token`, are not checked
85:     function claimFailedDeposit(
86:         uint256 _chainId,
87:         address _depositSender,
88:         address _l1Token,
89:         uint256 _amount,
90:         bytes32 _l2TxHash,
91:         uint256 _l2BatchNumber,
92:         uint256 _l2MessageIndex,
93:         uint16 _l2TxNumberInBatch,
94:         bytes32[] calldata _merkleProof

//@audit these parameters `_prevMsgSender`, are not checked
128:     function bridgehubDeposit(
129:         uint256 _chainId,
130:         address _prevMsgSender,
131:         uint256 _l2Value,
132:         bytes calldata _data

//@audit these parameters `_prevMsgSender`,`_l1Token`, are not checked
135:     function bridgehubDepositBaseToken(
136:         uint256 _chainId,
137:         address _prevMsgSender,
138:         address _l1Token,
139:         uint256 _amount


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L64-L71) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L74-L82), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L85-L94), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L128-L132), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L135-L139)


```solidity

File: contracts/bridge/interfaces/IL2Bridge.sol

//@audit these parameters `_l1Sender`,`_l2Receiver`,`_l1Token`, are not checked
07:     function finalizeDeposit(
08:         address _l1Sender,
09:         address _l2Receiver,
10:         address _l1Token,
11:         uint256 _amount,
12:         bytes calldata _data

//@audit these parameters `_l1Receiver`,`_l2Token`, are not checked
15:     function withdraw(address _l1Receiver, address _l2Token, uint256 _amount) external;

//@audit these parameters `_l2Token`, are not checked
17:     function l1TokenAddress(address _l2Token) external view returns (address);

//@audit these parameters `_l1Token`, are not checked
19:     function l2TokenAddress(address _l1Token) external view returns (address);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL2Bridge.sol#L7-L12) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL2Bridge.sol#L15-L15), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL2Bridge.sol#L17-L17), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL2Bridge.sol#L19-L19)


```solidity

File: contracts/bridgehub/IBridgehub.sol

//@audit these parameters `_newPendingAdmin`, are not checked
53:     function setPendingAdmin(address _newPendingAdmin) external;

//@audit these parameters `_stateTransitionManager`, are not checked
59:     function stateTransitionManagerIsRegistered(address _stateTransitionManager) external view returns (bool);

//@audit these parameters `_baseToken`, are not checked
63:     function tokenIsRegistered(address _baseToken) external view returns (bool);

//@audit these parameters `_stateTransitionManager`,`_baseToken`,`_admin`, are not checked
116:     function createNewChain(
117:         uint256 _chainId,
118:         address _stateTransitionManager,
119:         address _baseToken,
120:         uint256 _salt,
121:         address _admin,
122:         bytes calldata _initData

//@audit these parameters `_stateTransitionManager`, are not checked
125:     function addStateTransitionManager(address _stateTransitionManager) external;

//@audit these parameters `_stateTransitionManager`, are not checked
127:     function removeStateTransitionManager(address _stateTransitionManager) external;

//@audit these parameters `_token`, are not checked
129:     function addToken(address _token) external;

//@audit these parameters `_sharedBridge`, are not checked
131:     function setSharedBridge(address _sharedBridge) external;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L53-L53) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L59-L59), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L63-L63), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L116-L122), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L125-L125), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L127-L127), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L129-L129), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L131-L131)


```solidity

File: contracts/governance/IGovernance.sol

//@audit these parameters `_newSecurityCouncil`, are not checked
65:     function updateSecurityCouncil(address _newSecurityCouncil) external;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/IGovernance.sol#L65-L65) 


```solidity

File: contracts/state-transition/IStateTransitionManager.sol

//@audit these parameters `_newPendingAdmin`, are not checked
48:     function setPendingAdmin(address _newPendingAdmin) external;

//@audit these parameters `_validatorTimelock`, are not checked
69:     function setValidatorTimelock(address _validatorTimelock) external;

//@audit these parameters `_baseToken`,`_sharedBridge`,`_admin`, are not checked
74:     function createNewChain(
75:         uint256 _chainId,
76:         address _baseToken,
77:         address _sharedBridge,
78:         address _admin,
79:         bytes calldata _diamondCut

//@audit these parameters `_stateTransitionContract`, are not checked
82:     function registerAlreadyDeployedStateTransition(uint256 _chainId, address _stateTransitionContract) external;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/IStateTransitionManager.sol#L48-L48) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/IStateTransitionManager.sol#L69-L69), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/IStateTransitionManager.sol#L74-L79), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/IStateTransitionManager.sol#L82-L82)


```solidity

File: contracts/state-transition/chain-interfaces/IAdmin.sol

//@audit these parameters `_newPendingAdmin`, are not checked
17:     function setPendingAdmin(address _newPendingAdmin) external;

//@audit these parameters `_validator`, are not checked
25:     function setValidator(address _validator, bool _active) external;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IAdmin.sol#L17-L17) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IAdmin.sol#L25-L25)


```solidity

File: contracts/state-transition/chain-interfaces/IGetters.sol

//@audit these parameters `_address`, are not checked
65:     function isValidator(address _address) external view returns (bool);

//@audit these parameters `_facet`, are not checked
133:     function facetFunctionSelectors(address _facet) external view returns (bytes4[] memory);

//@audit these parameters `_facet`, are not checked
145:     function isFacetFreezable(address _facet) external view returns (bool isFreezable);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IGetters.sol#L65-L65) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IGetters.sol#L133-L133), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IGetters.sol#L145-L145)


```solidity

File: contracts/state-transition/chain-interfaces/IMailbox.sol

//@audit these parameters `_contractL2`,`_refundRecipient`, are not checked
88:     function requestL2Transaction(
89:         address _contractL2,
90:         uint256 _l2Value,
91:         bytes calldata _calldata,
92:         uint256 _l2GasLimit,
93:         uint256 _l2GasPerPubdataByteLimit,
94:         bytes[] calldata _factoryDeps,
95:         address _refundRecipient


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IMailbox.sol#L88-L95) 


```solidity

File: contracts/bridge/L2SharedBridge.sol

//@audit these parameters ``,``, are not checked
49:     function initialize(
50:         address _l1Bridge,
51:         address _l1LegecyBridge,
52:         bytes32 _l2TokenProxyBytecodeHash,
53:         address _aliasedOwner

//@audit these parameters `_l1Sender`,`_l2Receiver`, are not checked
79:     function finalizeDeposit(
80:         address _l1Sender,
81:         address _l2Receiver,
82:         address _l1Token,
83:         uint256 _amount,
84:         bytes calldata _data

//@audit these parameters `_l1Token`, are not checked
109:     function _deployL2Token(address _l1Token, bytes calldata _data) internal returns (address) {

//@audit these parameters `_l1Receiver`,`_l2Token`, are not checked
123:     function withdraw(address _l1Receiver, address _l2Token, uint256 _amount) external override {

//@audit these parameters `_to`,`_l1Token`, are not checked
138:     function _getL1WithdrawMessage(
139:         address _to,
140:         address _l1Token,
141:         uint256 _amount

//@audit these parameters `_l1Token`, are not checked
149:     function l2TokenAddress(address _l1Token) public view override returns (address) {

//@audit these parameters `_l1Token`, are not checked
157:     function _getCreate2Salt(address _l1Token) internal pure returns (bytes32 salt) {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L49-L53) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L79-L84), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L109-L109), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L123-L123), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L138-L141), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L149-L149), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L157-L157)


```solidity

File: contracts/bridge/L2StandardERC20.sol

//@audit these parameters ``, are not checked
50:     function bridgeInitialize(address _l1Address, bytes memory _data) external initializer {

//@audit these parameters `_to`, are not checked
145:     function bridgeMint(address _to, uint256 _amount) external override onlyBridge {

//@audit these parameters `_from`, are not checked
154:     function bridgeBurn(address _from, uint256 _amount) external override onlyBridge {


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2StandardERC20.sol#L50-L50) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2StandardERC20.sol#L145-L145), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2StandardERC20.sol#L154-L154)


```solidity

File: contracts/bridge/interfaces/IL2SharedBridge.sol

//@audit these parameters `_l1Sender`,`_l2Receiver`,`_l1Token`, are not checked
24:     function finalizeDeposit(
25:         address _l1Sender,
26:         address _l2Receiver,
27:         address _l1Token,
28:         uint256 _amount,
29:         bytes calldata _data

//@audit these parameters `_l1Receiver`,`_l2Token`, are not checked
32:     function withdraw(address _l1Receiver, address _l2Token, uint256 _amount) external;

//@audit these parameters `_l2Token`, are not checked
34:     function l1TokenAddress(address _l2Token) external view returns (address);

//@audit these parameters `_l1Token`, are not checked
36:     function l2TokenAddress(address _l1Token) external view returns (address);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL2SharedBridge.sol#L24-L29) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL2SharedBridge.sol#L32-L32), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL2SharedBridge.sol#L34-L34), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL2SharedBridge.sol#L36-L36)


```solidity

File: contracts/bridge/interfaces/IL2StandardToken.sol

//@audit these parameters `_account`, are not checked
12:     function bridgeMint(address _account, uint256 _amount) external;

//@audit these parameters `_account`, are not checked
14:     function bridgeBurn(address _account, uint256 _amount) external;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL2StandardToken.sol#L12-L12) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL2StandardToken.sol#L14-L14)


```solidity

File: contracts/interfaces/IPaymasterFlow.sol

//@audit these parameters `_token`, are not checked
16:     function approvalBased(address _token, uint256 _minAllowance, bytes calldata _innerInput) external;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/interfaces/IPaymasterFlow.sol#L16-L16) 


```solidity

File: contracts/L2ContractHelper.sol

//@audit these parameters `_l1Receiver`, are not checked
65:     function withdrawWithMessage(address _l1Receiver, bytes memory _additionalData) external payable;

//@audit these parameters `_sender`, are not checked
101:     function computeCreate2Address(
102:         address _sender,
103:         bytes32 _salt,
104:         bytes32 _bytecodeHash,
105:         bytes32 _constructorInputHash


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/L2ContractHelper.sol#L65-L65) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/L2ContractHelper.sol#L101-L105)


```solidity

File: contracts/SystemContractsCaller.sol

//@audit these parameters `to`, are not checked
37:     function systemCall(uint32 gasLimit, address to, uint256 value, bytes memory data) internal returns (bool success) {

//@audit these parameters `to`, are not checked
76:     function systemCallWithReturndata(
77:         uint32 gasLimit,
78:         address to,
79:         uint128 value,
80:         bytes memory data


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/SystemContractsCaller.sol#L37-L37) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/SystemContractsCaller.sol#L76-L80)


</details>


### [NC&#x2011;139] Interfaces should use floating version pragmas 
If the file contains non-interfaces as well, the interfaces should be moved to a separate file.


*There are 43 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/interfaces/IAccount.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IAccount.sol#L3-L3) 


```solidity

File: contracts/interfaces/IAccountCodeStorage.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IAccountCodeStorage.sol#L3-L3) 


```solidity

File: contracts/interfaces/IBaseToken.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IBaseToken.sol#L3-L3) 


```solidity

File: contracts/interfaces/IBootloaderUtilities.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IBootloaderUtilities.sol#L3-L3) 


```solidity

File: contracts/interfaces/IComplexUpgrader.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IComplexUpgrader.sol#L3-L3) 


```solidity

File: contracts/interfaces/ICompressor.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ICompressor.sol#L3-L3) 


```solidity

File: contracts/interfaces/IContractDeployer.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IContractDeployer.sol#L3-L3) 


```solidity

File: contracts/interfaces/IImmutableSimulator.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IImmutableSimulator.sol#L3-L3) 


```solidity

File: contracts/interfaces/IKnownCodesStorage.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IKnownCodesStorage.sol#L3-L3) 


```solidity

File: contracts/interfaces/IL1Messenger.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IL1Messenger.sol#L3-L3) 


```solidity

File: contracts/interfaces/IL2StandardToken.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IL2StandardToken.sol#L3-L3) 


```solidity

File: contracts/interfaces/IMailbox.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IMailbox.sol#L3-L3) 


```solidity

File: contracts/interfaces/INonceHolder.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/INonceHolder.sol#L3-L3) 


```solidity

File: contracts/interfaces/IPaymaster.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IPaymaster.sol#L3-L3) 


```solidity

File: contracts/interfaces/IPaymasterFlow.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IPaymasterFlow.sol#L3-L3) 


```solidity

File: contracts/interfaces/IPubdataChunkPublisher.sol

2: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IPubdataChunkPublisher.sol#L2-L2) 


```solidity

File: contracts/interfaces/ISystemContext.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ISystemContext.sol#L3-L3) 


```solidity

File: contracts/interfaces/ISystemContextDeprecated.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/ISystemContextDeprecated.sol#L3-L3) 


```solidity

File: contracts/bridge/interfaces/IL1ERC20Bridge.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1ERC20Bridge.sol#L3-L3) 


```solidity

File: contracts/bridge/interfaces/IL1SharedBridge.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL1SharedBridge.sol#L3-L3) 


```solidity

File: contracts/bridge/interfaces/IL2Bridge.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IL2Bridge.sol#L3-L3) 


```solidity

File: contracts/bridge/interfaces/IWETH9.sol

2: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/interfaces/IWETH9.sol#L2-L2) 


```solidity

File: contracts/bridgehub/IBridgehub.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridgehub/IBridgehub.sol#L3-L3) 


```solidity

File: contracts/common/interfaces/IL2ContractDeployer.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/common/interfaces/IL2ContractDeployer.sol#L3-L3) 


```solidity

File: contracts/governance/IGovernance.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/IGovernance.sol#L3-L3) 


```solidity

File: contracts/state-transition/IStateTransitionManager.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/IStateTransitionManager.sol#L3-L3) 


```solidity

File: contracts/state-transition/chain-interfaces/IAdmin.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IAdmin.sol#L3-L3) 


```solidity

File: contracts/state-transition/chain-interfaces/IDiamondInit.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IDiamondInit.sol#L3-L3) 


```solidity

File: contracts/state-transition/chain-interfaces/IExecutor.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IExecutor.sol#L3-L3) 


```solidity

File: contracts/state-transition/chain-interfaces/IGetters.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IGetters.sol#L3-L3) 


```solidity

File: contracts/state-transition/chain-interfaces/ILegacyGetters.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/ILegacyGetters.sol#L3-L3) 


```solidity

File: contracts/state-transition/chain-interfaces/IMailbox.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IMailbox.sol#L3-L3) 


```solidity

File: contracts/state-transition/chain-interfaces/IVerifier.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IVerifier.sol#L3-L3) 


```solidity

File: contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol#L3-L3) 


```solidity

File: contracts/state-transition/chain-interfaces/IZkSyncStateTransitionBase.sol

2: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-interfaces/IZkSyncStateTransitionBase.sol#L2-L2) 


```solidity

File: contracts/upgrades/IDefaultUpgrade.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/IDefaultUpgrade.sol#L3-L3) 


```solidity

File: contracts/bridge/interfaces/IL1ERC20Bridge.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL1ERC20Bridge.sol#L3-L3) 


```solidity

File: contracts/bridge/interfaces/IL1SharedBridge.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL1SharedBridge.sol#L3-L3) 


```solidity

File: contracts/bridge/interfaces/IL2SharedBridge.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL2SharedBridge.sol#L3-L3) 


```solidity

File: contracts/bridge/interfaces/IL2StandardToken.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/interfaces/IL2StandardToken.sol#L3-L3) 


```solidity

File: contracts/interfaces/IPaymaster.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/interfaces/IPaymaster.sol#L3-L3) 


```solidity

File: contracts/interfaces/IPaymasterFlow.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/interfaces/IPaymasterFlow.sol#L3-L3) 


```solidity

File: contracts/L2ContractHelper.sol

3: pragma solidity 0.8.20;


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/L2ContractHelper.sol#L3-L3) 


</details>


### [NC&#x2011;140] Consider disallowing transfers to `address(this)` 
Consider preventing a contract's tokens from being transferred/minted to the contract itself


*There are 2 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/L2BaseToken.sol

64:     function mint(address _account, uint256 _amount) external override onlyCallFromBootloader {
65:         totalSupply += _amount;
66:         balance[_account] += _amount;
67:         emit Mint(_account, _amount);
68:     }


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L2BaseToken.sol#L64-L68) 


```solidity

File: contracts/interfaces/IBaseToken.sol

18:     function mint(address _account, uint256 _amount) external;


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/interfaces/IBaseToken.sol#L18-L18) 


</details>


### [NC&#x2011;141] Unusual loop variable 
For better readability, try to use common loop counter names


*There are 1 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/Compressor.sol

//@audit `encodedDataPointer` 
61:             for (uint256 encodedDataPointer = 0; encodedDataPointer < encodedData.length; encodedDataPointer += 2) {
62:                 uint256 indexOfEncodedChunk = uint256(encodedData.readUint16(encodedDataPointer)) * 8;
63:                 require(indexOfEncodedChunk < dictionary.length, "Encoded chunk index is out of bounds");
64: 
65:                 uint64 encodedChunk = dictionary.readUint64(indexOfEncodedChunk);
66:                 uint64 realChunk = _bytecode.readUint64(encodedDataPointer * 4);
67: 
68:                 require(encodedChunk == realChunk, "Encoded chunk does not match the original bytecode");
69:             }


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Compressor.sol#L61-L69) 


</details>


### [NC&#x2011;142] Consider using named function calls 
Named function calls in Solidity greatly improve code readability by explicitly mapping arguments to their respective parameter names. This clarity becomes critical when dealing with functions that have numerous or complex parameters, reducing potential errors due to misordered arguments. Therefore, adopting named function calls contributes to more maintainable and less error-prone code.


*There are 131 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: contracts/AccountCodeStorage.sol

38:         _storeCodeHash(_address, _hash);

49:         _storeCodeHash(_address, _hash);

62:         _storeCodeHash(_address, constructedBytecodeHash);


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/AccountCodeStorage.sol#L38-L38) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/AccountCodeStorage.sol#L49-L49), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/AccountCodeStorage.sol#L62-L62)


```solidity

File: contracts/Compressor.sol

147:             _verifyValueCompression(
148:                 initValue,
149:                 finalValue,
150:                 operation,
151:                 _compressedStateDiffs[stateDiffPtr:stateDiffPtr + len]
152:             );

178:             _verifyValueCompression(
179:                 initValue,
180:                 finalValue,
181:                 operation,
182:                 _compressedStateDiffs[stateDiffPtr:stateDiffPtr + len]
183:             );


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Compressor.sol#L147-L152) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/Compressor.sol#L178-L183)


```solidity

File: contracts/ContractDeployer.sol

84:         _storeAccountInfo(msg.sender, currentInfo);

137:         return create2Account(_salt, _bytecodeHash, _input, AccountAbstractionVersion.None);

152:         return createAccount(_salt, _bytecodeHash, _input, AccountAbstractionVersion.None);

169:         address newAddress = getNewAddressCreate2(msg.sender, _bytecodeHash, _salt, _input);

171:         _nonSystemDeployOnAddress(_bytecodeHash, newAddress, _aaVersion, _input);

189:         address newAddress = getNewAddressCreate(msg.sender, senderNonce);

191:         _nonSystemDeployOnAddress(_bytecodeHash, newAddress, _aaVersion, _input);

223:         _storeAccountInfo(_deployment.newAddress, newAccountInfo);

225:         _constructContract(
226:             _sender,
227:             _deployment.newAddress,
228:             _deployment.bytecodeHash,
229:             _deployment.input,
230:             false,
231:             _deployment.callConstructor
232:         );

275:         _performDeployOnAddress(_bytecodeHash, _newAddress, _aaVersion, _input);

295:         _storeAccountInfo(_newAddress, newAccountInfo);

297:         _constructContract(msg.sender, _newAddress, _bytecodeHash, _input, false, true);

336:             _storeConstructingByteCodeHashOnAddress(_newAddress, _bytecodeHash);


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L84-L84) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L137-L137), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L152-L152), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L169-L169), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L171-L171), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L189-L189), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L191-L191), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L223-L223), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L225-L232), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L275-L275), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L295-L295), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L297-L297), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/ContractDeployer.sol#L336-L336)


```solidity

File: contracts/DefaultAccount.sol

102:         if (_isValidSignature(txHash, _transaction.signature)) {

72:         magic = _validateTransaction(_suggestedSignedHash, _transaction);


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/DefaultAccount.sol#L102-L102) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/DefaultAccount.sol#L72-L72)


```solidity

File: contracts/KnownCodesStorage.sol

40:         _markBytecodeAsPublished(_bytecodeHash, false);

31:                 _markBytecodeAsPublished(_hashes[i], _shouldSendToL1);


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/KnownCodesStorage.sol#L40-L40) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/KnownCodesStorage.sol#L31-L31)


```solidity

File: contracts/L2BaseToken.sol

76:         bytes memory message = _getL1WithdrawMessage(_l1Receiver, amount);

89:         bytes memory message = _getExtendedWithdrawMessage(_l1Receiver, amount, msg.sender, _additionalData);


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L2BaseToken.sol#L76-L76) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/L2BaseToken.sol#L89-L89)


```solidity

File: contracts/NonceHolder.sol

167:         bool isUsed = isNonceUsed(_address, _key);

89:             require(isNonceUsed(msg.sender, _key - 1), "Previous nonce has not been used");


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/NonceHolder.sol#L167-L167) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/NonceHolder.sol#L89-L89)


```solidity

File: contracts/SystemContext.sol

319:         _setL2BlockHash(_l2BlockNumber - 1, _prevL2BlockHash);

397:         _setVirtualBlock(_l2BlockNumber, _maxVirtualBlocksToCreate, _l2BlockTimestamp);

255:             _setL2BlockHash(_l2BlockNumber - 1, correctPrevBlockHash);

363:             _upgradeL2Blocks(_l2BlockNumber, _expectedPrevL2BlockHash, _isFirstInBatch);

365:             _setNewL2BlockData(_l2BlockNumber, _l2BlockTimestamp, _expectedPrevL2BlockHash);

378:             bytes32 pendingL2BlockHash = _calculateL2BlockHash(
379:                 currentL2BlockNumber,
380:                 currentL2BlockTimestamp,
381:                 prevL2BlockHash,
382:                 currentL2BlockTxsRollingHash
383:             );

392:             _setNewL2BlockData(_l2BlockNumber, _l2BlockTimestamp, _expectedPrevL2BlockHash);


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L319-L319) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L397-L397), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L255-L255), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L363-L363), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L365-L365), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L378-L383), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/SystemContext.sol#L392-L392)


```solidity

File: contracts/libraries/EfficientCall.sol

37:         bytes memory returnData = staticCall(gasleft(), KECCAK256_SYSTEM_CONTRACT, _data);

46:         bytes memory returnData = staticCall(gasleft(), SHA256_SYSTEM_CONTRACT, _data);

65:         bool success = rawCall(_gas, _address, _value, _data, _isSystem);

79:         bool success = rawStaticCall(_gas, _address, _data);

93:         bool success = rawDelegateCall(_gas, _address, _data);

113:         bool success = rawMimicCall(_gas, _address, _data, _whoToMimic, _isConstructor, _isSystem);

160:         _loadFarCallABIIntoActivePtr(_gas, _data, false, false);

174:         _loadFarCallABIIntoActivePtr(_gas, _data, false, false);

199:         _loadFarCallABIIntoActivePtr(_gas, _data, _isConstructor, _isSystem);

139:             _loadFarCallABIIntoActivePtr(_gas, _data, false, true);

132:             _loadFarCallABIIntoActivePtr(_gas, _data, false, _isSystem);


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L37-L37) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L46-L46), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L65-L65), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L79-L79), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L93-L93), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L113-L113), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L160-L160), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L174-L174), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L199-L199), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L139-L139), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/EfficientCall.sol#L132-L132)


```solidity

File: contracts/libraries/RLPEncoder.sol

51:         return _encodeLength(_len, 0x80);

57:         return _encodeLength(_len, 0xc0);


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/RLPEncoder.sol#L51-L51) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/RLPEncoder.sol#L57-L57)


```solidity

File: contracts/libraries/SystemContractHelper.sol

345:         bool precompileCallSuccess = unsafePrecompileCall(
346:             0, // The precompile parameters are formal ones. We only need the precompile call to burn gas.
347:             _gasToPay,
348:             _pubdataToSpend
349:         );

228:         pubdataPublished = uint32(extractNumberFromMeta(meta, META_GAS_PER_PUBDATA_BYTE_OFFSET, 32));

238:         heapSize = uint32(extractNumberFromMeta(meta, META_HEAP_SIZE_OFFSET, 32));

247:         auxHeapSize = uint32(extractNumberFromMeta(meta, META_AUX_HEAP_SIZE_OFFSET, 32));

255:         shardId = uint8(extractNumberFromMeta(meta, META_SHARD_ID_OFFSET, 8));

264:         callerShardId = uint8(extractNumberFromMeta(meta, META_CALLER_SHARD_ID_OFFSET, 8));

273:         codeShardId = uint8(extractNumberFromMeta(meta, META_CODE_SHARD_ID_OFFSET, 8));


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L345-L349) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L228-L228), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L238-L238), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L247-L247), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L255-L255), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L264-L264), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractHelper.sol#L273-L273)


```solidity

File: contracts/libraries/SystemContractsCaller.sol

129:         success = systemCall(gasLimit, to, value, data);

157:         (success, returnData) = systemCallWithReturndata(gasLimit, to, value, data);

226:         farCallAbi = getFarCallABIWithEmptyFatPointer(
227:             gasPassed,
228:             shardId,
229:             forwardingMode,
230:             isConstructorCall,
231:             isSystemCall
232:         );


```

[link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractsCaller.sol#L129-L129) , [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractsCaller.sol#L157-L157), [link](https://github.com/code-423n4/2024-03-zksync/tree/main/code/system-contracts//contracts/libraries/SystemContractsCaller.sol#L226-L232)


```solidity

File: contracts/bridge/L1ERC20Bridge.sol

142:         uint256 amount = _depositFundsToSharedBridge(msg.sender, IERC20(_l1Token), _amount);

105:         l2TxHash = deposit(_l2Receiver, _l1Token, _amount, _l2TxGasLimit, _l2TxGasPerPubdataByte, address(0));


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1ERC20Bridge.sol#L142-L142) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1ERC20Bridge.sol#L105-L105)


```solidity

File: contracts/bridge/L1SharedBridge.sol

288:         _claimFailedDeposit(
289:             false,
290:             _chainId,
291:             _depositSender,
292:             _l1Token,
293:             _amount,
294:             _l2TxHash,
295:             _l2BatchNumber,
296:             _l2MessageIndex,
297:             _l2TxNumberInBatch,
298:             _merkleProof
299:         );

395:         if (_isEraLegacyWithdrawal(_chainId, _l2BatchNumber)) {

398:         _finalizeWithdrawal(_chainId, _l2BatchNumber, _l2MessageIndex, _l2TxNumberInBatch, _message, _merkleProof);

421:         if (_isEraLegacyWithdrawal(_chainId, _l2BatchNumber)) {

571:         bytes memory l2TxCalldata = _getDepositL2Calldata(_prevMsgSender, _l2Receiver, _l1Token, _amount);

654:         _claimFailedDeposit(
655:             true,
656:             ERA_CHAIN_ID,
657:             _depositSender,
658:             _l1Token,
659:             _amount,
660:             _l2TxHash,
661:             _l2BatchNumber,
662:             _l2MessageIndex,
663:             _l2TxNumberInBatch,
664:             _merkleProof
665:         );

217:             bytes memory l2TxCalldata = _getDepositL2Calldata(_prevMsgSender, _l2Receiver, _l1Token, amount);

435:         (l1Receiver, l1Token, amount) = _checkWithdrawal(_chainId, messageParams, _message, _merkleProof);

464:         (l1Receiver, l1Token, amount) = _parseL2WithdrawalMessage(_chainId, _message);

622:         (l1Receiver, l1Token, amount) = _finalizeWithdrawal(
623:             ERA_CHAIN_ID,
624:             _l2BatchNumber,
625:             _l2MessageIndex,
626:             _l2TxNumberInBatch,
627:             _message,
628:             _merkleProof
629:         );

160:             uint256 amount = _depositFunds(_prevMsgSender, IERC20(_l1Token), _amount); // note if _prevMsgSender is this contract, this will return 0. This does not happen.

205:             uint256 withdrawAmount = _depositFunds(_prevMsgSender, IERC20(_l1Token), _depositAmount);

333:                 bool weCanCheckDepositHere = !_isEraLegacyWithdrawal(_chainId, _l2BatchNumber);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L288-L299) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L395-L395), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L398-L398), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L421-L421), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L571-L571), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L654-L665), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L217-L217), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L435-L435), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L464-L464), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L622-L629), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L160-L160), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L205-L205), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/bridge/L1SharedBridge.sol#L333-L333)


```solidity

File: contracts/governance/Governance.sol

131:         _schedule(id, _delay);

143:         _schedule(_id, _delay);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/Governance.sol#L131-L131) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/governance/Governance.sol#L143-L143)


```solidity

File: contracts/state-transition/StateTransitionManager.sol

285:         _setChainIdUpgrade(_chainId, stateTransitionAddress);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/StateTransitionManager.sol#L285-L285) 


```solidity

File: contracts/state-transition/chain-deps/facets/Executor.sol

44:         LogProcessingOutput memory logOutput = _processL2Logs(_newBatch, _expectedSystemContractUpgradeTxHash);

81:         _verifyBatchTimestamp(logOutput.packedBatchAndL2BlockTimestamp, _newBatch.timestamp, _previousBatch.timestamp);

84:         bytes32 commitment = _createBatchCommitment(_newBatch, logOutput.stateDiffHash, blobCommitments, blobHashes);

203:         _commitBatches(_lastCommittedBatchData, _newBatchesData);

212:         _commitBatches(_lastCommittedBatchData, _newBatchesData);

373:         _proveBatches(_prevBatch, _committedBatches, _proof);

383:         _proveBatches(_prevBatch, _committedBatches, _proof);

433:         _verifyProof(proofPublicInput, _proof);

509:             _batchAuxiliaryOutput(_newBatchData, _stateDiffHash, _blobCommitments, _blobHashes)

553:                 _encodeBlobAuxilaryOutput(_blobCommitments, _blobHashes)

240:             _commitBatchesWithSystemContractsUpgrade(
241:                 _lastCommittedBatchData,
242:                 _newBatchesData,
243:                 systemContractsUpgradeTxHash
244:             );

238:             _commitBatchesWithoutSystemContractsUpgrade(_lastCommittedBatchData, _newBatchesData);

352:             _executeOneBatch(_batchesData[i], i);

430:             _verifyProof(proofPublicInput, _proof);

647:             _pointEvaluationPrecompile(
648:                 blobVersionedHash,
649:                 openingPoint,
650:                 _pubdataCommitments[i + PUBDATA_COMMITMENT_CLAIMED_VALUE_OFFSET:i + PUBDATA_COMMITMENT_SIZE]
651:             );

150:             processedLogs = _setBit(processedLogs, uint8(logKey));

258:             _lastCommittedBatchData = _commitOneBatch(_lastCommittedBatchData, _newBatchesData[i], bytes32(0));

292:             _lastCommittedBatchData = _commitOneBatch(
293:                 _lastCommittedBatchData,
294:                 _newBatchesData[i],
295:                 expectedUpgradeTxHash
296:             );

413:             proofPublicInput[i] = _getBatchProofPublicInput(
414:                 prevBatchCommitment,
415:                 currentBatchCommitment,
416:                 verifierParams
417:             );

58:             blobCommitments = _verifyBlobInformation(_newBatch.pubdataCommitments[1:], blobHashes);

149:             require(!_checkBit(processedLogs, uint8(logKey)), "kp");


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L44-L44) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L81-L81), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L84-L84), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L203-L203), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L212-L212), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L373-L373), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L383-L383), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L433-L433), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L509-L509), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L553-L553), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L240-L244), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L238-L238), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L352-L352), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L430-L430), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L647-L651), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L150-L150), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L258-L258), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L292-L296), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L413-L417), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L58-L58), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Executor.sol#L149-L149)


```solidity

File: contracts/state-transition/chain-deps/facets/Mailbox.sol

60:         return _proveL2LogInclusion(_batchNumber, _index, _L2MessageToLog(_message), _proof);

70:         return _proveL2LogInclusion(_batchNumber, _index, _log, _proof);

100:         return _proveL2LogInclusion(_l2BatchNumber, _l2MessageIndex, l2Log, _merkleProof);

148:         uint256 l2GasPrice = _deriveL2GasPrice(_gasPrice, _l2GasPerPubdataByteLimit);

321:         L2CanonicalTransaction memory transaction = _serializeL2Transaction(_priorityOpParams, _calldata, _factoryDeps);

255:         canonicalTxHash = _requestL2Transaction(_request.mintValue, params, _request.l2Calldata, _request.factoryDeps);

270:         _params.l2GasPrice = _deriveL2GasPrice(tx.gasprice, _params.l2GasPricePerPubdata);

286:         canonicalTxHash = _writePriorityOp(_params, _calldata, _factoryDeps);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L60-L60) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L70-L70), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L100-L100), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L148-L148), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L321-L321), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L255-L255), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L270-L270), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/chain-deps/facets/Mailbox.sol#L286-L286)


```solidity

File: contracts/upgrades/BaseZkSyncUpgrade.sol

76:         _upgradeVerifier(_proposedUpgrade.verifier, _proposedUpgrade.verifierParams);

77:         _setBaseSystemContracts(_proposedUpgrade.bootloaderHash, _proposedUpgrade.defaultAccountHash);

210:         _verifyFactoryDeps(_factoryDeps, _l2ProtocolUpgradeTx.factoryDeps);

79:         txHash = _setL2SystemContractUpgrade(
80:             _proposedUpgrade.l2ProtocolUpgradeTx,
81:             _proposedUpgrade.factoryDeps,
82:             _proposedUpgrade.newProtocolVersion
83:         );


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgrade.sol#L76-L76) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgrade.sol#L77-L77), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgrade.sol#L210-L210), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgrade.sol#L79-L83)


```solidity

File: contracts/upgrades/BaseZkSyncUpgradeGenesis.sol

56:         _upgradeVerifier(_proposedUpgrade.verifier, _proposedUpgrade.verifierParams);

57:         _setBaseSystemContracts(_proposedUpgrade.bootloaderHash, _proposedUpgrade.defaultAccountHash);

59:         bytes32 txHash = _setL2SystemContractUpgrade(
60:             _proposedUpgrade.l2ProtocolUpgradeTx,
61:             _proposedUpgrade.factoryDeps,
62:             _proposedUpgrade.newProtocolVersion
63:         );


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L56-L56) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L57-L57), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L59-L63)


```solidity

File: contracts/state-transition/libraries/Diamond.sol

120:         _initializeDiamondCut(initAddress, initCalldata);

143:             _addOneFunction(_facet, selector, _isFacetFreezable);

163:             _removeOneFunction(oldFacet.facetAddress, selector);

166:             _addOneFunction(_facet, selector, _isFacetFreezable);

183:             _removeOneFunction(oldFacet.facetAddress, selector);

110:                 _addFunctions(facet, selectors, isFacetFreezable);

112:                 _replaceFunctions(facet, selectors, isFacetFreezable);

114:                 _removeFunctions(facet, selectors);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L120-L120) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L143-L143), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L163-L163), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L166-L166), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L183-L183), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L110-L110), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L112-L112), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Diamond.sol#L114-L114)


```solidity

File: contracts/state-transition/libraries/Merkle.sol

32:                 : _efficientHash(_path[i], currentHash);

31:                 ? _efficientHash(currentHash, _path[i])


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Merkle.sol#L32-L32) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/Merkle.sol#L31-L31)


```solidity

File: contracts/state-transition/libraries/TransactionValidator.sol

25:         uint256 l2GasForTxBody = getTransactionBodyGasLimit(_transaction.gasLimit, _encoded.length);

35:             getMinimalPriorityTransactionGasLimit(
36:                 _encoded.length,
37:                 _transaction.factoryDeps.length,
38:                 _transaction.gasPerPubdataByteLimit
39:             ) <= l2GasForTxBody,


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/TransactionValidator.sol#L25-L25) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/ethereum//contracts/state-transition/libraries/TransactionValidator.sol#L35-L39)


```solidity

File: contracts/bridge/L2SharedBridge.sol

131:         bytes memory message = _getL1WithdrawMessage(_l1Receiver, l1Token, _amount);

97:             address deployedToken = _deployL2Token(_l1Token, _data);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L131-L131) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2SharedBridge.sol#L97-L97)


```solidity

File: contracts/bridge/L2StandardERC20.sol

88:         __ERC20_init_unchained(decodedName, decodedSymbol);

122:         __ERC20_init_unchained(_newName, _newSymbol);

146:         _mint(_to, _amount);

155:         _burn(_from, _amount);


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2StandardERC20.sol#L88-L88) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2StandardERC20.sol#L122-L122), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2StandardERC20.sol#L146-L146), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/bridge/L2StandardERC20.sol#L155-L155)


```solidity

File: contracts/SystemContractsCaller.sol

46:         uint256 farCallAbi = getFarCallABI(
47:             0,
48:             0,
49:             dataStart,
50:             dataLength,
51:             gasLimit,
52:             // Only rollup is supported for now
53:             0,
54:             CalldataForwardingMode.UseHeap,
55:             false,
56:             true
57:         );

82:         success = systemCall(gasLimit, to, value, data);

107:         farCallAbi = getFarCallABIWithEmptyFatPointer(
108:             gasPassed,
109:             shardId,
110:             forwardingMode,
111:             isConstructorCall,
112:             isSystemCall
113:         );


```

[link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/SystemContractsCaller.sol#L46-L57) , [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/SystemContractsCaller.sol#L82-L82), [link](https://github.com/code-423n4/2024-03-zksync/blob/main/code/contracts/zksync//contracts/SystemContractsCaller.sol#L107-L113)


</details>
