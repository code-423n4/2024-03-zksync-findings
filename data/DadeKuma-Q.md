## Summary

---

### Low Risk Issues
|Id|Title|Instances|
|:--:|:------|:--:|
|[[L-01]](#l-01-some-erc20-can-revert-on-a-zero-value-transfer)| Some `ERC20` can revert on a zero value `transfer` | 4 |
|[[L-02]](#l-02-check-for-eoa-may-be-unreliable)| Check for EOA may be unreliable | 5 |
|[[L-03]](#l-03-file-allows-a-version-of-solidity-that-is-susceptible-to-selector-related-optimizer-bug)| File allows a version of solidity that is susceptible to .selector-related optimizer bug | 12 |
|[[L-04]](#l-04-use-of-ecrecover-is-susceptible-to-signature-malleability)| Use of `ecrecover` is susceptible to signature malleability | 1 |
|[[L-05]](#l-05-missing-checks-in-constructorinitialize)| Missing checks in constructor/initialize | 6 |
|[[L-06]](#l-06-missing-checks-for-state-variable-assignments)| Missing checks for state variable assignments | 27 |
|[[L-07]](#l-07-functions-calling-contracts-with-transfer-hooks-are-missing-reentrancy-guards)| Functions calling contracts with transfer hooks are missing reentrancy guards | 3 |
|[[L-08]](#l-08-large-transfers-may-not-work-with-some-erc20-tokens)| Large transfers may not work with some `ERC20` tokens | 3 |
|[[L-09]](#l-09-large-approvals-may-not-work-with-some-erc20-tokens)| Large approvals may not work with some `ERC20` tokens | 1 |
|[[L-10]](#l-10-safeapprove-is-deprecated)| `safeApprove` is deprecated | 2 |
|[[L-11]](#l-11-initializers-could-be-front-run)| Initializers could be front-run | 3 |
|[[L-12]](#l-12-assert-is-deprecated-and-it-should-not-be-used)| `assert` is deprecated and it should not be used | 5 |
|[[L-13]](#l-13-possible-division-by-0-is-not-prevented)| Possible division by 0 is not prevented | 1 |
|[[L-14]](#l-14-truncating-blocktimestamp-can-reduce-the-lifespan-of-a-contract)| Truncating `block.timestamp` can reduce the lifespan of a contract | 2 |
|[[L-15]](#l-15-draft-imports-should-be-avoided)| Draft imports should be avoided | 1 |
|[[L-16]](#l-16-usage-of-txorigin-should-be-avoided)| Usage of `tx.origin` should be avoided | 3 |
|[[L-17]](#l-17-missing-limits-when-setting-minmax-amounts)| Missing limits when setting min/max amounts | 21 |
|[[L-18]](#l-18-owner-can-renounce-ownership)| Owner can renounce ownership | 5 |
|[[L-19]](#l-19-upgradeable-contract-is-missing-a-gap-storage-variable)| Upgradeable contract is missing a gap storage variable | 1 |
|[[L-20]](#l-20-lack-of-two-step-update-for-updating-protocol-addresses)| Lack of two-step update for updating protocol addresses | 2 |
|[[L-21]](#l-21-loss-of-precision-on-division)| Loss of precision on division | 5 |
|[[L-22]](#l-22-gas-griefingtheft-is-possible-on-an-unsafe-external-call)| Gas griefing/theft is possible on an unsafe external call | 1 |
|[[L-23]](#l-23-use-increaseallowancedecreaseallowance-instead-of-approvesafeapprove)| Use `increaseAllowance/decreaseAllowance` instead of `approve/safeApprove` | 2 |
|[[L-24]](#l-24-onlyowner-functions-not-accessible-if-owner-renounces-ownership)| `onlyOwner` functions not accessible if `owner` renounces ownership | 17 |
|[[L-25]](#l-25-no-access-control-on-receivepayable-fallback)| No access control on `receive/payable fallback` | 4 |
|[[L-26]](#l-26-unusedempty-receivefallback)| Unused/empty `receive`/`fallback` | 4 |
|[[L-27]](#l-27-missing-checks-for-address0-in-constructorinitializers)| Missing checks for `address(0)` in constructor/initializers | 8 |
|[[L-28]](#l-28-missing-checks-for-address0-when-updating-state-variables)| Missing checks for `address(0)` when updating state variables | 23 |

Total: 172 instances over 28 issues.

### Non Critical Issues
|Id|Title|Instances|
|:--:|:------|:--:|
|[[N-01]](#n-01-custom-error-should-be-used-rather-than-requireassert)| Custom `error` should be used rather than `require`/`assert` | 333 |
|[[N-02]](#n-02-high-cyclomatic-complexity)| High cyclomatic complexity | 16 |
|[[N-03]](#n-03-missing-events-in-sensitive-functions)| Missing events in sensitive functions | 20 |
|[[N-04]](#n-04-missing-events-in-initializers)| Missing events in initializers | 9 |
|[[N-05]](#n-05-consider-emitting-an-event-at-the-end-of-the-constructor)| Consider emitting an event at the end of the constructor | 9 |
|[[N-06]](#n-06-setters-should-prevent-re-setting-the-same-value)| Setters should prevent re-setting the same value | 21 |
|[[N-07]](#n-07-using-zero-as-a-parameter)| Using zero as a parameter | 81 |
|[[N-08]](#n-08-usage-of-intuint-is-discouraged)| Usage of `int/uint` is discouraged | 1 |
|[[N-09]](#n-09-named-imports-of-parent-contracts-are-missing)| Named imports of parent contracts are missing | 4 |
|[[N-10]](#n-10-unused-struct-definition)| Unused struct definition | 1 |
|[[N-11]](#n-11-unused-enum-definition)| Unused `enum` definition | 1 |
|[[N-12]](#n-12-unused-event-definition)| Unused `event` definition | 3 |
|[[N-13]](#n-13-unused-arguments-should-be-removed-or-implemented)| Unused arguments should be removed or implemented | 24 |
|[[N-14]](#n-14-unused-arguments-in-overrided-functions-should-be-commented)| Unused arguments in overrided functions should be commented | 2 |
|[[N-15]](#n-15-unused-state-variables)| Unused state variables | 13 |
|[[N-16]](#n-16-openzeppelin-libraries-should-be-upgraded-to-a-newer-version)| OpenZeppelin libraries should be upgraded to a newer version | 22 |
|[[N-17]](#n-17-same-constant-is-redefined-elsewhere)| Same `constant` is redefined elsewhere | 21 |
|[[N-18]](#n-18-enum-values-should-be-used-in-place-of-constant-array-indexes)| Enum values should be used in place of constant array indexes | 41 |
|[[N-19]](#n-19-variable-initialization-with-zero-value)| Variable initialization with zero value | 38 |
|[[N-20]](#n-20-consider-adding-emergency-stop-functionality)| Consider adding emergency-stop functionality | 5 |
|[[N-21]](#n-21-duplicated-requireif-statements-should-be-refactored)| Duplicated `require/if` statements should be refactored | 3 |
|[[N-22]](#n-22-inconsistent-usage-of-requireerror)| Inconsistent usage of `require`/`error` | 1 |
|[[N-23]](#n-23-some-functions-contain-the-same-exact-logic)| Some functions contain the same exact logic | 34 |
|[[N-24]](#n-24-public-functions-not-called-internally)| Public functions not called internally | 11 |
|[[N-25]](#n-25-missingmalformed-underscores-for-large-numeric-literals)| Missing/malformed underscores for large numeric literals | 1 |
|[[N-26]](#n-26-mixed-usage-of-intuint-with-int256uint256)| Mixed usage of `int`/`uint` with `int256`/`uint256` | 1 |
|[[N-27]](#n-27-consider-using-the-using-for-syntax)| Consider using the `using-for` syntax | 274 |
|[[N-28]](#n-28-use-eip-5627-to-describe-eip-712-domains)| Use EIP-5627 to describe EIP-712 domains | 1 |
|[[N-29]](#n-29-dependence-on-external-protocols)| Dependence on external protocols | 22 |
|[[N-30]](#n-30-use-transfer-libraries-instead-of-low-level-calls)| Use transfer libraries instead of low level calls | 1 |
|[[N-31]](#n-31-possible-reentrancy-in-modifiers-placed-before-nonreentrant)| Possible reentrancy in modifiers placed before `nonReentrant` | 2 |
|[[N-32]](#n-32-2n---1-should-be-re-written-as-typeuintnmax)| `2**<n> - 1` should be re-written as `type(uint<n>).max` | 6 |
|[[N-33]](#n-33-use-of-non-named-numeric-constants)| Use of non-named numeric constants | 181 |
|[[N-34]](#n-34-control-structures-do-not-comply-with-best-practices)| Control structures do not comply with best practices | 7 |
|[[N-35]](#n-35-use-a-single-file-for-system-wide-constants)| Use a single file for system wide constants | 31 |
|[[N-36]](#n-36-some-events-are-never-emitted)| Some events are never emitted | 3 |
|[[N-37]](#n-37-event-does-not-have-proper-indexed-fields)| Event does not have proper `indexed` fields | 11 |
|[[N-38]](#n-38-old-solidity-version)| Old Solidity version | 1 |
|[[N-39]](#n-39-use-of-floating-pragma)| Use of floating pragma | 1 |
|[[N-40]](#n-40-no-checks-for-empty-bytes)| No checks for empty bytes | 16 |
|[[N-41]](#n-41-use-of-abiencodepacked-instead-of-bytesconcat)| Use of `abi.encodePacked` instead of `bytes.concat` | 8 |
|[[N-42]](#n-42-use-of-abiencodepacked-instead-of-casting-directly)| Use of `abi.encodePacked` instead of casting directly | 2 |
|[[N-43]](#n-43-use-of-constant-variables-instead-of-immutable)| Use of `constant` variables instead of `immutable` | 4 |
|[[N-44]](#n-44-contract-functions-should-use-an-interface)| Contract functions should use an `interface` | 185 |
|[[N-45]](#n-45-requirerevert-without-any-message)| `require`/`revert` without any message | 5 |
|[[N-46]](#n-46-some-error-strings-are-not-descriptive)| Some error strings are not descriptive | 42 |
|[[N-47]](#n-47-multiple-addressid-mappings-can-be-combined-into-a-single-mapping-of-an-addressid-to-a-struct-for-readability)| Multiple `address`/ID mappings can be combined into a single mapping of an `address`/ID to a `struct`, for readability | 3 |
|[[N-48]](#n-48-variable-names-should-not-end-with-an-underscore)| Variable names should not end with an underscore | 1 |
|[[N-49]](#n-49-lack-of-specific-import-identifier)| Lack of specific `import` identifier | 41 |
|[[N-50]](#n-50-duplicate-import-statements)| Duplicate import statements | 3 |
|[[N-51]](#n-51-imports-should-be-organized-more-systematically)| Imports should be organized more systematically | 21 |
|[[N-52]](#n-52-use-an-already-existing-merkleproof-implementation)| Use an already existing `MerkleProof` implementation | 1 |
|[[N-53]](#n-53-use-an-already-existing-nonreentrant-implementation)| Use an already existing `nonReentrant` implementation | 1 |
|[[N-54]](#n-54-consider-using-abstract-contracts)| Consider using `abstract` contracts | 2 |
|[[N-55]](#n-55-long-bitmasks-are-hard-to-read)| Long bitmasks are hard to read | 1 |
|[[N-56]](#n-56-top-level-declarations-should-be-separated-by-at-least-two-lines)| Top-level declarations should be separated by at least two lines | 166 |
|[[N-57]](#n-57-use-a-struct-to-encapsulate-multiple-function-parameters)| Use a struct to encapsulate multiple function parameters | 55 |
|[[N-58]](#n-58-unresolved-todos-in-comments)| Unresolved `TODOs` in comments | 3 |
|[[N-59]](#n-59-event-is-missing-msgsender-parameter)| Event is missing `msg.sender` parameter | 69 |
|[[N-60]](#n-60-events-should-use-parameters-to-convey-information)| Events should use parameters to convey information | 2 |
|[[N-61]](#n-61-events-should-emit-both-new-and-old-values)| Events should emit both new and old values | 2 |
|[[N-62]](#n-62-events-may-be-emitted-out-of-order-due-to-reentrancy)| Events may be emitted out of order due to reentrancy | 18 |
|[[N-63]](#n-63-use-of-polymorphism-is-discouraged-for-security-audits)| Use of polymorphism is discouraged for security audits | 2 |
|[[N-64]](#n-64-avoid-external-calls-in-modifiers)| Avoid external calls in modifiers | 5 |
|[[N-65]](#n-65-use-a-modifier-instead-of-require-to-check-for-msgsender)| Use a `modifier` instead of `require` to check for `msg.sender` | 14 |
|[[N-66]](#n-66-constants-in-comparisons-should-appear-on-the-left-side)| Constants in comparisons should appear on the left side | 110 |
|[[N-67]](#n-67-consider-using-delete-instead-of-assigning-zerofalse-to-clear-values)| Consider using `delete` instead of assigning zero/false to clear values | 6 |
|[[N-68]](#n-68-consider-using-named-mappings)| Consider using named mappings | 8 |
|[[N-69]](#n-69-consider-using-named-returns)| Consider using named returns | 264 |
|[[N-70]](#n-70-unused-import)| Unused import | 16 |
|[[N-71]](#n-71-files-not-imported-in-any-source-code)| Files not imported in any source code | 4 |
|[[N-72]](#n-72-interfaces-should-use-floating-version-pragmas)| Interfaces should use floating version pragmas | 19 |
|[[N-73]](#n-73-layout-order-does-not-comply-with-best-practices)| Layout order does not comply with best practices | 15 |
|[[N-74]](#n-74-function-visibility-order-does-not-comply-with-best-practices)| Function visibility order does not comply with best practices | 103 |
|[[N-75]](#n-75-long-functions-should-be-refactored-into-multiple-functions)| Long functions should be refactored into multiple functions | 16 |
|[[N-76]](#n-76-consider-moving-duplicated-strings-to-constants)| Consider moving duplicated strings to constants | 12 |
|[[N-77]](#n-77-consider-providing-a-ranged-getter-for-array-state-variables)| Consider providing a ranged getter for array state variables | 1 |
|[[N-78]](#n-78-lines-are-too-long)| Lines are too long | 145 |
|[[N-79]](#n-79-some-variables-have-a-implicit-default-visibility)| Some variables have a implicit default visibility | 11 |
|[[N-80]](#n-80-consider-adding-a-blockdeny-list)| Consider adding a block/deny-list | 10 |
|[[N-81]](#n-81-use-of-override-is-unnecessary)| Use of `override` is unnecessary | 54 |
|[[N-82]](#n-82-missing-variable-names)| Missing variable names | 13 |
|[[N-83]](#n-83-contracts-should-have-full-test-coverage)| Contracts should have full test coverage | - |
|[[N-84]](#n-84-large-or-complicated-code-bases-should-implement-invariant-tests)| Large or complicated code bases should implement invariant tests | - |
|[[N-85]](#n-85-codebase-should-implement-formal-verification-testing)| Codebase should implement formal verification testing | - |
|[[N-86]](#n-86-state-variables-should-include-comments)| State variables should include comments | 8 |
|[[N-87]](#n-87-complex-functions-should-have-explicit-comments)| Complex functions should have explicit comments | 9 |
|[[N-88]](#n-88-assembly-code-should-have-explicit-comments)| Assembly code should have explicit comments | 48 |
|[[N-89]](#n-89-use-inheritdoc-for-overridden-functions)| Use `@inheritdoc` for overridden functions | 54 |
|[[N-90]](#n-90-some-functions-dont-follow-the-solidity-naming-convention)| Some functions don't follow the Solidity naming convention | 1 |
|[[N-91]](#n-91-variable-names-dont-follow-the-solidity-naming-convention)| Variable names don't follow the Solidity naming convention | 3 |
|[[N-92]](#n-92-constant-names-should-be-uppercase)| Constant names should be uppercase | 7 |
|[[N-93]](#n-93-immutable-variable-names-should-be-uppercase)| `immutable` variable names should be uppercase | 5 |
|[[N-94]](#n-94-missing-underscore-prefix-for-non-external-functions)| Missing underscore prefix for non-external functions | 109 |
|[[N-95]](#n-95-missing-underscore-prefix-for-non-external-variables)| Missing underscore prefix for non-external variables | 28 |
|[[N-96]](#n-96-missing-natspec-from-contract-declarations)| Missing NatSpec from contract declarations | 22 |
|[[N-97]](#n-97-missing-natspec-author-from-contract-declaration)| Missing NatSpec `@author` from contract declaration | 25 |
|[[N-98]](#n-98-missing-natspec-dev-from-contract-declaration)| Missing NatSpec `@dev` from contract declaration | 72 |
|[[N-99]](#n-99-missing-natspec-notice-from-contract-declaration)| Missing NatSpec `@notice` from contract declaration | 54 |
|[[N-100]](#n-100-missing-natspec-title-from-contract-declaration)| Missing NatSpec `@title` from contract declaration | 86 |
|[[N-101]](#n-101-missing-natspec-dev-from-error-declaration)| Missing NatSpec `@dev` from error declaration | 2 |
|[[N-102]](#n-102-missing-natspec-param-from-error-declaration)| Missing NatSpec `@param` from error declaration | 2 |
|[[N-103]](#n-103-missing-natspec-from-event-declaration)| Missing NatSpec from event declaration | 33 |
|[[N-104]](#n-104-missing-natspec-dev-from-event-declaration)| Missing NatSpec `@dev` from event declaration | 62 |
|[[N-105]](#n-105-missing-natspec-notice-from-event-declaration)| Missing NatSpec `@notice` from event declaration | 34 |
|[[N-106]](#n-106-missing-natspec-param-from-event-declaration)| Missing NatSpec `@param` from event declaration | 64 |
|[[N-107]](#n-107-missing-natspec-from-modifiers-definitions)| Missing NatSpec from modifiers definitions | 12 |
|[[N-108]](#n-108-missing-natspec-dev-from-modifier-declaration)| Missing NatSpec `@dev` from modifier declaration | 29 |
|[[N-109]](#n-109-missing-natspec-notice-from-modifier-declaration)| Missing NatSpec `@notice` from modifier declaration | 15 |
|[[N-110]](#n-110-missing-natspec-param-from-modifier-declaration)| Missing NatSpec `@param` from modifier declaration | 32 |
|[[N-111]](#n-111-missing-natspec-from-function-definitions)| Missing NatSpec from function definitions | 214 |
|[[N-112]](#n-112-missing-natspec-dev-from-function-declaration)| Missing NatSpec `@dev` from function declaration | 443 |
|[[N-113]](#n-113-missing-natspec-notice-from-function-declaration)| Missing NatSpec `@notice` from function declaration | 374 |
|[[N-114]](#n-114-missing-natspec-param-from-function-declaration)| Missing NatSpec `@param` from function declaration | 453 |
|[[N-115]](#n-115-incomplete-natspec-return-from-function-declaration)| Incomplete NatSpec `@return` from function declaration | 229 |

Total: 5265 instances over 115 issues.

## Low Risk Issues

---

### [L-01] Some `ERC20` can revert on a zero value `transfer`

Not all `ERC20` implementations are totally compliant, and some (e.g `LEND`) may fail while transfering a zero amount.

*There are 4 instances of this issue.*


```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

67: 		        IERC20(_token).safeTransfer(address(sharedBridge), amount);

162: 		        _token.safeTransferFrom(_from, address(sharedBridge), _amount);
```
[[67](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L67), [162](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L162)]



```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

175: 		        _token.safeTransferFrom(_from, address(this), _amount);

452: 		            IERC20(l1Token).safeTransfer(l1Receiver, amount);
```
[[175](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L175), [452](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L452)]


---

### [L-02] Check for EOA may be unreliable

The following checks may be true even if the caller is not an EOA. For example, these check will pass when the caller is:

- a contract in construction

- an address where a contract will be created

- an address where a contract lived, but was destroyed

- an externally-owned account

*There are 5 instances of this issue.*


```solidity
File: code/system-contracts/contracts/ComplexUpgrader.sol

24: 		        require(_delegateTo.code.length > 0, "Delegatee is an EOA");
```
[[24](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ComplexUpgrader.sol#L24)]



```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

329: 		        } else if (_refundRecipient.code.length > 0) {
```
[[329](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L329)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol

132: 		        require(_facet.code.length > 0, "G");

155: 		        require(_facet.code.length > 0, "K");
```
[[132](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L132), [155](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L155)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

277: 		        if (refundRecipient.code.length > 0) {
```
[[277](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L277)]


---

### [L-03] File allows a version of solidity that is susceptible to .selector-related optimizer bug

In solidity versions prior to 0.8.21, there is a legacy code generation [bug](https://soliditylang.org/blog/2023/07/19/missing-side-effects-on-selector-access-bug/) where if `foo().selector` is called, `foo()` doesn't actually get evaluated. It is listed as low-severity, because projects usually use the contract name rather than a function call to look up the selector.

*There are 12 instances of this issue.*

<details>
<summary>Expand findings</summary>


```solidity
File: code/system-contracts/contracts/DefaultAccount.sol

144: 		                selector == DEPLOYER_SYSTEM_CONTRACT.create.selector ||

145: 		                selector == DEPLOYER_SYSTEM_CONTRACT.create2.selector ||

146: 		                selector == DEPLOYER_SYSTEM_CONTRACT.createAccount.selector ||

147: 		                selector == DEPLOYER_SYSTEM_CONTRACT.create2Account.selector;
```
[[144](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L144), [145](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L145), [146](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L146), [147](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L147)]



```solidity
File: code/system-contracts/contracts/L2BaseToken.sol

113: 		        return abi.encodePacked(IMailbox.finalizeEthWithdrawal.selector, _to, _amount);

123: 		        return abi.encodePacked(IMailbox.finalizeEthWithdrawal.selector, _to, _amount, _sender, _additionalData);
```
[[113](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L2BaseToken.sol#L113), [123](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L2BaseToken.sol#L123)]



```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

366: 		        if (paymasterInputSelector == IPaymasterFlow.approvalBased.selector) {

385: 		        } else if (paymasterInputSelector == IPaymasterFlow.general.selector) {
```
[[366](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L366), [385](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L385)]



```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

504: 		        if (bytes4(functionSignature) == IMailbox.finalizeEthWithdrawal.selector) {

509: 		        } else if (bytes4(functionSignature) == IL1ERC20Bridge.finalizeWithdrawal.selector) {
```
[[504](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L504), [509](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L509)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

262: 		            IDiamondInit.initialize.selector,
```
[[262](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L262)]



```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

145: 		        return abi.encodePacked(IL1ERC20Bridge.finalizeWithdrawal.selector, _to, _l1Token, _amount);
```
[[145](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L145)]

</details>

---

### [L-04] Use of `ecrecover` is susceptible to signature malleability

The built-in EVM precompile `ecrecover` is susceptible to signature malleability, which could lead to [replay attacks](https://medium.com/cryptronics/signature-replay-vulnerabilities-in-smart-contracts-3b6f7596df57).

Consider using OpenZeppelin’s [ECDSA library](https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/utils/cryptography/ECDSA.sol#L125-L128) instead of the built-in function.

*There is 1 instance of this issue.*


```solidity
File: code/system-contracts/contracts/DefaultAccount.sol

186: 		        address recoveredAddress = ecrecover(_hash, v, r, s);
```
[[186](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L186)]


---

### [L-05] Missing checks in constructor/initialize

There are some missing checks in these functions, and this could lead to unexpected scenarios. Consider always adding a sanity check for state variables.

*There are 6 instances of this issue.*


```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

// @audit _eraFirstPostUpgradeBatch
104: 		    function initialize(
105: 		        address _owner,
106: 		        uint256 _eraFirstPostUpgradeBatch

// @audit _chainId
142: 		    function initializeChainGovernance(uint256 _chainId, address _l2BridgeAddress) external onlyOwner {
```
[[104-106](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L104-L106), [142](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L142)]



```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

// @audit _minDelay
41: 		    constructor(address _admin, address _securityCouncil, uint256 _minDelay) {
```
[[41](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L41)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

// @audit _executionDelay
55: 		    constructor(address _initialOwner, uint32 _executionDelay) {
```
[[55](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L55)]



```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

// @audit _version
111: 		    function reinitializeToken(
112: 		        ERC20Getters calldata _availableGetters,
113: 		        string memory _newName,
114: 		        string memory _newSymbol,
115: 		        uint8 _version
```
[[111-115](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L111-L115)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol

// @audit _chainId
11: 		    constructor(uint256 _chainId, Diamond.DiamondCutData memory _diamondCut) {
```
[[11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol#L11)]


---

### [L-06] Missing checks for state variable assignments

There are some missing checks in these functions, and this could lead to unexpected scenarios. Consider always adding a sanity check for state variables.

*There are 27 instances of this issue.*

<details>
<summary>Expand findings</summary>


```solidity
File: code/system-contracts/contracts/NonceHolder.sol

72: 		            rawNonces[addressAsKey] = (oldRawNonce + _value);

94: 		        nonceValues[addressAsKey][_key] = _value;

118: 		            rawNonces[addressAsKey] = oldRawNonce + 1;
```
[[72](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/NonceHolder.sol#L72), [94](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/NonceHolder.sol#L94), [118](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/NonceHolder.sol#L118)]



```solidity
File: code/system-contracts/contracts/SystemContext.sol

85: 		        chainId = _newChainId;

106: 		        gasPrice = _gasPrice;

113: 		        basePubdataSpent = _basePubdataSpent;

114: 		        gasPerPubdataByte = _gasPerPubdataByte;

213: 		        l2BlockHash[_block % MINIBLOCK_HASHES_TO_STORE] = _hash;

316: 		        currentL2BlockInfo = BlockInfo({number: _l2BlockNumber, timestamp: _l2BlockTimestamp});

322: 		        currentL2BlockTxsRollingHash = bytes32(0);

456: 		        batchHashes[previousBatchNumber] = _prevBatchHash;

461: 		        currentBatchInfo = newBlockInfo;

463: 		        baseFee = _baseFee;

477: 		        currentBatchInfo = newBlockInfo;

479: 		        baseFee = _baseFee;
```
[[85](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L85), [106](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L106), [113](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L113), [114](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L114), [213](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L213), [316](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L316), [322](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L322), [456](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L456), [461](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L461), [463](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L463), [477](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L477), [479](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L479)]



```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

154: 		        depositAmount[msg.sender][_l1Token][l2TxHash] = _amount;
```
[[154](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L154)]



```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

122: 		            chainBalance[_targetChainId][ETH_TOKEN_ADDRESS] =
123: 		                chainBalance[_targetChainId][ETH_TOKEN_ADDRESS] +
124: 		                balanceAfter -
125: 		                balanceBefore;

133: 		            chainBalance[_targetChainId][_token] = chainBalance[_targetChainId][_token] + amount;

600: 		        depositHappened[ERA_CHAIN_ID][l2TxHash] = txDataHash;
```
[[122-125](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L122-L125), [133](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L133), [600](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L600)]



```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

219: 		        timestamps[_id] = block.timestamp + _delay;

251: 		        minDelay = _newDelay;
```
[[219](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L219), [251](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L251)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

147: 		        upgradeCutHash[_oldProtocolVersion] = keccak256(abi.encode(_cutData));

148: 		        protocolVersion = _newProtocolVersion;

156: 		        upgradeCutHash[_oldProtocolVersion] = keccak256(abi.encode(_cutData));

234: 		        stateTransition[_chainId] = _stateTransitionContract;
```
[[147](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L147), [148](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L148), [156](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L156), [234](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L234)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

97: 		        executionDelay = _executionDelay;
```
[[97](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L97)]



```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

99: 		            l1TokenAddress[expectedL2Token] = _l1Token;
```
[[99](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L99)]

</details>

---

### [L-07] Functions calling contracts with transfer hooks are missing reentrancy guards

Even if the function follows the best practice of check-effects-interaction, not using a reentrancy guard when there may be transfer hooks will open the users of this protocol up to read-only reentrancies with no way to protect against it, except by block-listing the whole protocol.

*There are 3 instances of this issue.*


```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

67: 		        IERC20(_token).safeTransfer(address(sharedBridge), amount);

162: 		        _token.safeTransferFrom(_from, address(sharedBridge), _amount);
```
[[67](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L67), [162](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L162)]



```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

175: 		        _token.safeTransferFrom(_from, address(this), _amount);
```
[[175](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L175)]


---

### [L-08] Large transfers may not work with some `ERC20` tokens

Some `IERC20` implementations (e.g `UNI`, `COMP`) may fail if the valued `transferred` is larger than `uint96`. [Source](https://github.com/d-xo/weird-erc20/blob/main/src/Uint96.sol).

*There are 3 instances of this issue.*


```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

67: 		        IERC20(_token).safeTransfer(address(sharedBridge), amount);
```
[[67](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L67)]



```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

362: 		            IERC20(_l1Token).safeTransfer(_depositSender, _amount);

452: 		            IERC20(l1Token).safeTransfer(l1Receiver, amount);
```
[[362](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L362), [452](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L452)]


---

### [L-09] Large approvals may not work with some `ERC20` tokens

Not all `IERC20` implementations are totally compliant, and some (e.g `UNI`, `COMP`) may fail if the valued passed to `approve` is larger than `uint96`. If the approval amount is `type(uint256).max`, which may cause issues with systems that expect the value passed to approve to be reflected in the allowances mapping.

*There is 1 instance of this issue.*


```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

383: 		                IERC20(token).safeApprove(paymaster, minAllowance);
```
[[383](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L383)]


---

### [L-10] `safeApprove` is deprecated

The usage of deprecated library functions should be discouraged, as `safeApprove` is also potentially [dangerous](https://github.com/OpenZeppelin/openzeppelin-contracts/issues/2219).

*There are 2 instances of this issue.*


```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

382: 		                IERC20(token).safeApprove(paymaster, 0);

383: 		                IERC20(token).safeApprove(paymaster, minAllowance);
```
[[382](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L382), [383](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L383)]


---

### [L-11] Initializers could be front-run

Initializers could be front-run, allowing an attacker to either set their own values, take ownership of the contract, and in the best case forcing a re-deployment.

*There are 3 instances of this issue.*


```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

49: 		    function initialize(
```
[[49](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L49)]



```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

50: 		    function bridgeInitialize(address _l1Address, bytes memory _data) external initializer {
```
[[50](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L50)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol

62: 		    function initialize(InitializeData calldata _initData) external returns (bytes32);
```
[[62](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol#L62)]


---

### [L-12] `assert` is deprecated and it should not be used

Prior to Solidity 0.8.0, the big difference between the `assert` and `require` is that the former uses up all the remaining gas and reverts all the changes made when the predicate is false.

It should be avoided even after Solidity version 0.8.0 as the documentation states:

> Properly functioning code should never create a Panic, not even on invalid external input. If this happens, then there is a bug in your contract which you should fix.

*There are 5 instances of this issue.*


```solidity
File: code/system-contracts/contracts/DefaultAccount.sol

222: 		        assert(msg.sender != BOOTLOADER_FORMAL_ADDRESS);
```
[[222](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L222)]



```solidity
File: code/system-contracts/contracts/libraries/RLPEncoder.sol

50: 		        assert(_len != 1);
```
[[50](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/RLPEncoder.sol#L50)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

106: 		        assert(L2_TO_L1_LOG_SERIALIZE_SIZE != 2 * 32);
```
[[106](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L106)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol

51: 		        assert(L2_TO_L1_LOG_SERIALIZE_SIZE != 2 * 32);
```
[[51](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol#L51)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

426: 		        assert(block.chainid != 1);
```
[[426](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L426)]


---

### [L-13] Possible division by 0 is not prevented

These functions can be called with 0 value in the input and this value is not checked for being bigger than 0, that means in some scenarios this can potentially trigger a division by zero.

*There is 1 instance of this issue.*


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

// @audit _gasPerPubdata
172: 		        uint256 minL2GasPriceBaseToken = (fullPubdataPriceBaseToken + _gasPerPubdata - 1) / _gasPerPubdata;
```
[[172](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L172)]


---

### [L-14] Truncating `block.timestamp` can reduce the lifespan of a contract

Consider removing the casting to extend the lifespan of these contracts.

*There are 2 instances of this issue.*


```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

115: 		            uint32 timestamp = uint32(block.timestamp);

134: 		            uint32 timestamp = uint32(block.timestamp);
```
[[115](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L115), [134](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L134)]


---

### [L-15] Draft imports should be avoided

A draft status means that the EIPs they're based on are [not finalized](https://eips.ethereum.org/), and thus there may be breaking changes in even minor releases. Consider using a stable version for these libraries instead of a draft.

*There is 1 instance of this issue.*


```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

5: 		import {ERC20PermitUpgradeable} from "@openzeppelin/contracts-upgradeable/token/ERC20/extensions/draft-ERC20PermitUpgradeable.sol";
```
[[5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L5)]


---

### [L-16] Usage of `tx.origin` should be avoided

Besides the issue with authorization, there is a chance that `tx.origin` will be removed from the Ethereum protocol in the future, so code that uses `tx.origin` won't be compatible with [future releases](https://consensys.github.io/smart-contract-best-practices/development-recommendations/solidity-specific/tx-origin/).

*There are 3 instances of this issue.*


```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

579: 		                refundRecipient = _prevMsgSender != tx.origin
```
[[579](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L579)]



```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

328: 		            _recipient = msg.sender == tx.origin ? msg.sender : AddressAliasHelper.applyL1ToL2Alias(msg.sender);
```
[[328](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L328)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

234: 		        if (l2Sender != tx.origin) {
```
[[234](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L234)]


---

### [L-17] Missing limits when setting min/max amounts

There are some missing limits in these functions, and this could lead to unexpected scenarios. Consider adding a min/max limit for the following values, when appropriate.

*There are 21 instances of this issue.*

<details>
<summary>Expand findings</summary>


```solidity
File: code/system-contracts/contracts/SystemContext.sol

// @audit missing both checks -> _newChainId
84: 		    function setChainId(uint256 _newChainId) external onlyCallFromForceDeployer {

// @audit missing both checks -> _gasPrice
105: 		    function setGasPrice(uint256 _gasPrice) external onlyCallFromBootloader {

// @audit missing both checks -> _gasPerPubdataByte, _basePubdataSpent
112: 		    function setPubdataInfo(uint256 _gasPerPubdataByte, uint256 _basePubdataSpent) external onlyCallFromBootloader {

// @audit missing both checks -> _block
212: 		    function _setL2BlockHash(uint256 _block, bytes32 _hash) internal {

// @audit missing both checks -> _l2BlockNumber, _newTimestamp
// @audit missing max check -> 
263: 		    function _setVirtualBlock(
264: 		        uint128 _l2BlockNumber,
265: 		        uint128 _maxVirtualBlocksToCreate,
266: 		        uint128 _newTimestamp

// @audit missing both checks -> _l2BlockNumber, _l2BlockTimestamp
314: 		    function _setNewL2BlockData(uint128 _l2BlockNumber, uint128 _l2BlockTimestamp, bytes32 _prevL2BlockHash) internal {

// @audit missing both checks -> _l2BlockNumber
// @audit missing max check -> 
341: 		    function setL2Block(
342: 		        uint128 _l2BlockNumber,
343: 		        uint128 _l2BlockTimestamp,
344: 		        bytes32 _expectedPrevL2BlockHash,
345: 		        bool _isFirstInBatch,
346: 		        uint128 _maxVirtualBlocksToCreate

// @audit missing both checks -> _expectedNewNumber, _baseFee
// @audit missing max check -> 
444: 		    function setNewBatch(
445: 		        bytes32 _prevBatchHash,
446: 		        uint128 _newTimestamp,
447: 		        uint128 _expectedNewNumber,
448: 		        uint256 _baseFee
```
[[84](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L84), [105](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L105), [112](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L112), [212](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L212), [263-266](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L263-L266), [314](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L314), [341-346](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L341-L346), [444-448](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L444-L448)]



```solidity
File: code/system-contracts/contracts/libraries/SystemContractHelper.sol

// @audit missing both checks -> _value
168: 		    function setValueForNextFarCall(uint128 _value) internal returns (bool success) {
```
[[168](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L168)]



```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

// @audit missing both checks -> _newDelay
249: 		    function updateDelay(uint256 _newDelay) external onlySelf {
```
[[249](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L249)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

// @audit missing both checks -> _oldProtocolVersion, _newProtocolVersion
142: 		    function setNewVersionUpgrade(
143: 		        Diamond.DiamondCutData calldata _cutData,
144: 		        uint256 _oldProtocolVersion,
145: 		        uint256 _newProtocolVersion

// @audit missing both checks -> _oldProtocolVersion
152: 		    function setUpgradeDiamondCut(
153: 		        Diamond.DiamondCutData calldata _cutData,
154: 		        uint256 _oldProtocolVersion

// @audit missing both checks -> _chainId
177: 		    function _setChainIdUpgrade(uint256 _chainId, address _chainContract) internal {
```
[[142-145](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L142-L145), [152-154](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L152-L154), [177](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L177)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

// @audit missing both checks -> _executionDelay
96: 		    function setExecutionDelay(uint32 _executionDelay) external onlyOwner {
```
[[96](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L96)]



```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol

// @audit missing both checks -> _newProtocolVersion
180: 		    function _setL2SystemContractUpgrade(
181: 		        L2CanonicalTransaction calldata _l2ProtocolUpgradeTx,
182: 		        bytes[] calldata _factoryDeps,
183: 		        uint256 _newProtocolVersion

// @audit missing max check -> 
236: 		    function _setNewProtocolVersion(uint256 _newProtocolVersion) internal virtual {
```
[[180-183](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L180-L183), [236](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L236)]



```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol

// @audit missing max check -> 
20: 		    function _setNewProtocolVersion(uint256 _newProtocolVersion) internal override {
```
[[20](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L20)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/LibMap.sol

// @audit missing both checks -> _index, _value
38: 		    function set(Uint32Map storage _map, uint256 _index, uint32 _value) internal {
```
[[38](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/LibMap.sol#L38)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol

// @audit missing min check -> _newPriorityTxMaxGasLimit
58: 		    function setPriorityTxMaxGasLimit(uint256 _newPriorityTxMaxGasLimit) external onlyStateTransitionManager {

// @audit missing both checks -> _nominator, _denominator
79: 		    function setTokenMultiplier(uint128 _nominator, uint128 _denominator) external onlyAdminOrStateTransitionManager {
```
[[58](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L58), [79](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L79)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

// @audit missing both checks -> _bitMap, _index
597: 		    function _setBit(uint256 _bitMap, uint8 _index) internal pure returns (uint256) {
```
[[597](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L597)]

</details>

---

### [L-18] Owner can renounce ownership

Each of the following contracts implements or inherits the `renounceOwnership` function. This can represent a certain risk if the ownership is renounced for any other reason than by design. Renouncing ownership will leave the contract without an owner, thereby removing any functionality that is only available to the owner.

*There are 5 instances of this issue.*


```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

30: 		contract L1SharedBridge is IL1SharedBridge, ReentrancyGuard, Initializable, Ownable2Step {
```
[[30](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L30)]



```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

16: 		contract Bridgehub is IBridgehub, ReentrancyGuard, Ownable2Step {
```
[[16](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L16)]



```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

20: 		contract Governance is IGovernance, Ownable2Step {
```
[[20](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L20)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

25: 		contract StateTransitionManager is IStateTransitionManager, ReentrancyGuard, Ownable2Step {
```
[[25](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L25)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

22: 		contract ValidatorTimelock is IExecutor, Ownable2Step {
```
[[22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L22)]


---

### [L-19] Upgradeable contract is missing a gap storage variable

If a contract is extended, a gap storage variable will allow to freely add new state variables in the future, without compromising the storage compatibility with existing deployments.

[OpenZeppelin docs](https://docs.openzeppelin.com/contracts/4.x/upgradeable#storage_gaps) 

*There is 1 instance of this issue.*


```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

15: 		contract L2StandardERC20 is ERC20PermitUpgradeable, IL2StandardToken, ERC1967Upgrade {
```
[[15](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L15)]


---

### [L-20] Lack of two-step update for updating protocol addresses

Add a two-step process for any critical address changes.

*There are 2 instances of this issue.*


```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

78: 		    function addValidator(uint256 _chainId, address _newValidator) external onlyChainAdmin(_chainId) {
79: 		        if (validators[_chainId][_newValidator]) {
80: 		            revert AddressAlreadyValidator(_chainId);
81: 		        }
82: 		        validators[_chainId][_newValidator] = true;
83: 		        emit ValidatorAdded(_chainId, _newValidator);
84: 		    }
```
[[78-84](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L78-L84)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol

45: 		    function setValidator(address _validator, bool _active) external onlyStateTransitionManager {
46: 		        s.validators[_validator] = _active;
47: 		        emit ValidatorStatusUpdate(_validator, _active);
48: 		    }
```
[[45-48](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L45-L48)]


---

### [L-21] Loss of precision on division

Solidity doesn't support fractions, so divisions by large numbers could result in the quotient being zero.

To avoid this, it's recommended to require a minimum numerator amount to ensure that it is always greater than the denominator.

*There are 5 instances of this issue.*


```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol

30: 		        require(l2GasForTxBody / _transaction.gasPerPubdataByteLimit <= _priorityTxMaxPubdata, "uk");
```
[[30](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L30)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

159: 		        uint256 l1GasPriceConverted = (_l1GasPrice * s.baseTokenGasPriceMultiplierNominator) /
160: 		            s.baseTokenGasPriceMultiplierDenominator;

168: 		            batchOverheadBaseToken /
169: 		            uint256(feeParams.maxPubdataPerBatch);

171: 		        uint256 l2GasPrice = feeParams.minimalL2GasPrice + batchOverheadBaseToken / uint256(feeParams.maxL2GasPerBatch);

172: 		        uint256 minL2GasPriceBaseToken = (fullPubdataPriceBaseToken + _gasPerPubdata - 1) / _gasPerPubdata;
```
[[159-160](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L159-L160), [168-169](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L168-L169), [171](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L171), [172](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L172)]


---

### [L-22] Gas griefing/theft is possible on an unsafe external call

A low-level call will copy any amount of bytes to local memory. When bytes are copied from returndata to memory, the memory expansion cost is paid.

This means that when using a standard solidity call, the callee can 'returnbomb' the caller, imposing an arbitrary gas cost.

Because this gas is paid by the caller and in the caller's context, it can cause the caller to run out of gas and halt execution.

Consider replacing all unsafe `call` with `excessivelySafeCall` from this [repository](https://github.com/nomad-xyz/ExcessivelySafeCall).

*There is 1 instance of this issue.*


```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

226: 		            (bool success, bytes memory returnData) = _calls[i].target.call{value: _calls[i].value}(_calls[i].data);
```
[[226](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L226)]


---

### [L-23] Use `increaseAllowance/decreaseAllowance` instead of `approve/safeApprove`

Changing an allowance with `approve` brings the risk that someone may use both the old and the new allowance by unfortunate transaction ordering. Refer to [ERC20 API: An Attack Vector on the Approve/TransferFrom Methods](https://docs.google.com/document/d/1YLPtQxZu1UAvO9cZ1O2RPXBbT0mooh4DYKjA_jp-RLM/edit).

It is recommended to use the `increaseAllowance/decreaseAllowance` to avoid ths problem.

*There are 2 instances of this issue.*


```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

382: 		                IERC20(token).safeApprove(paymaster, 0);

383: 		                IERC20(token).safeApprove(paymaster, minAllowance);
```
[[382](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L382), [383](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L383)]


---

### [L-24] `onlyOwner` functions not accessible if `owner` renounces ownership

The `owner` is able to perform certain privileged activities, but it's possible to set the owner to `address(0)`. This can represent a certain risk if the ownership is renounced for any other reason than by design.

Renouncing ownership will leave the contract without an `owner`, therefore limiting any functionality that needs authority.

*There are 17 instances of this issue.*

<details>
<summary>Expand findings</summary>


```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

116: 		    function transferFundsFromLegacy(address _token, address _target, uint256 _targetChainId) external onlyOwner {

142: 		    function initializeChainGovernance(uint256 _chainId, address _l2BridgeAddress) external onlyOwner {
```
[[116](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L116), [142](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L142)]



```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

82: 		    function addStateTransitionManager(address _stateTransitionManager) external onlyOwner {

92: 		    function removeStateTransitionManager(address _stateTransitionManager) external onlyOwner {

101: 		    function addToken(address _token) external onlyOwner {

108: 		    function setSharedBridge(address _sharedBridge) external onlyOwner {
```
[[82](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L82), [92](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L92), [101](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L101), [108](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L108)]



```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

129: 		    function scheduleTransparent(Operation calldata _operation, uint256 _delay) external onlyOwner {

142: 		    function scheduleShadow(bytes32 _id, uint256 _delay) external onlyOwner {

154: 		    function cancel(bytes32 _id) external onlyOwner {
```
[[129](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L129), [142](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L142), [154](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L154)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

137: 		    function setInitialCutHash(Diamond.DiamondCutData calldata _diamondCut) external onlyOwner {

146: 		    ) external onlyOwner {

155: 		    ) external onlyOwner {

160: 		    function freezeChain(uint256 _chainId) external onlyOwner {

165: 		    function unfreezeChain(uint256 _chainId) external onlyOwner {

233: 		    ) external onlyOwner {
```
[[137](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L137), [146](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L146), [155](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L155), [160](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L160), [165](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L165), [233](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L233)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

73: 		    function setStateTransitionManager(IStateTransitionManager _stateTransitionManager) external onlyOwner {

96: 		    function setExecutionDelay(uint32 _executionDelay) external onlyOwner {
```
[[73](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L73), [96](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L96)]

</details>

---

### [L-25] No access control on `receive/payable fallback`

Users may send ETH by mistake to these contracts. As there is no access control on these functions, the funds will be permanently lost.

*There are 4 instances of this issue.*


```solidity
File: code/system-contracts/contracts/DefaultAccount.sol

227: 		    receive() external payable {
228: 		        // If the contract is called directly, behave like an EOA
229: 		    }
```
[[227-229](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L227-L229)]



```solidity
File: code/system-contracts/contracts/EmptyContract.sol

11: 		    fallback() external payable {}

13: 		    receive() external payable {}
```
[[11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/EmptyContract.sol#L11), [13](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/EmptyContract.sol#L13)]



```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

262: 		    receive() external payable {}
```
[[262](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L262)]


---

### [L-26] Unused/empty `receive`/`fallback`

If the intention is for the ETH to be used, the function should call another function, otherwise it should revert (e.g. `require(msg.sender == address(weth))`)

*There are 4 instances of this issue.*


```solidity
File: code/system-contracts/contracts/DefaultAccount.sol

227: 		    receive() external payable {
228: 		        // If the contract is called directly, behave like an EOA
229: 		    }
```
[[227-229](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L227-L229)]



```solidity
File: code/system-contracts/contracts/EmptyContract.sol

11: 		    fallback() external payable {}

13: 		    receive() external payable {}
```
[[11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/EmptyContract.sol#L11), [13](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/EmptyContract.sol#L13)]



```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

262: 		    receive() external payable {}
```
[[262](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L262)]


---

### [L-27] Missing checks for `address(0)` in constructor/initializers

Check for zero-address to avoid the risk of setting `address(0)` for state variables when deploying.

*There are 8 instances of this issue.*


```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

// @audit _sharedBridge
56: 		        sharedBridge = _sharedBridge;
```
[[56](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L56)]



```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

// @audit _l1WethAddress
96: 		        l1WethAddress = _l1WethAddress;

// @audit _bridgehub
97: 		        bridgehub = _bridgehub;

// @audit _legacyBridge
98: 		        legacyBridge = _legacyBridge;

// @audit _l2BridgeAddress
143: 		        l2BridgeAddress[_chainId] = _l2BridgeAddress;
```
[[96](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L96), [97](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L97), [98](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L98), [143](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L143)]



```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

// @audit _securityCouncil
46: 		        securityCouncil = _securityCouncil;
```
[[46](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L46)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

// @audit _bridgehub
59: 		        bridgehub = _bridgehub;
```
[[59](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L59)]



```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

// @audit _availableGetters
124: 		        availableGetters = _availableGetters;
```
[[124](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L124)]


---

### [L-28] Missing checks for `address(0)` when updating state variables

Check for zero-address to avoid the risk of setting `address(0)` for state variables after an update.

*There are 23 instances of this issue.*

<details>
<summary>Expand findings</summary>


```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

// @audit _address
59: 		        accountInfo[_address] = _newInfo;

// @audit _newInfo
59: 		        accountInfo[_address] = _newInfo;
```
[[59](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L59), [59](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L59)]



```solidity
File: code/system-contracts/contracts/ImmutableSimulator.sol

// @audit _dest
41: 		                immutableDataStorage[uint256(uint160(_dest))][index] = value;
```
[[41](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ImmutableSimulator.sol#L41)]



```solidity
File: code/system-contracts/contracts/L2BaseToken.sol

// @audit _from
43: 		            balance[_from] = fromBalance - _amount;
```
[[43](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L2BaseToken.sol#L43)]



```solidity
File: code/system-contracts/contracts/SystemContext.sol

// @audit _newOrigin
100: 		        origin = _newOrigin;
```
[[100](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L100)]



```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

// @audit _l1Token
154: 		        depositAmount[msg.sender][_l1Token][l2TxHash] = _amount;
```
[[154](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L154)]



```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

// @audit _token
133: 		            chainBalance[_targetChainId][_token] = chainBalance[_targetChainId][_token] + amount;

// @audit _target
122: 		            chainBalance[_targetChainId][ETH_TOKEN_ADDRESS] =
123: 		                chainBalance[_targetChainId][ETH_TOKEN_ADDRESS] +
124: 		                balanceAfter -
125: 		                balanceBefore;
```
[[133](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L133), [122-125](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L122-L125)]



```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

// @audit _newPendingAdmin
55: 		        pendingAdmin = _newPendingAdmin;

// @audit _stateTransitionManager
87: 		        stateTransitionManagerIsRegistered[_stateTransitionManager] = true;

// @audit _stateTransitionManager
97: 		        stateTransitionManagerIsRegistered[_stateTransitionManager] = false;

// @audit _token
103: 		        tokenIsRegistered[_token] = true;

// @audit _sharedBridge
109: 		        sharedBridge = IL1SharedBridge(_sharedBridge);

// @audit _stateTransitionManager
134: 		        stateTransitionManager[_chainId] = _stateTransitionManager;

// @audit _baseToken
135: 		        baseToken[_chainId] = _baseToken;
```
[[55](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L55), [87](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L87), [97](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L97), [103](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L103), [109](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L109), [134](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L134), [135](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L135)]



```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

// @audit _newSecurityCouncil
258: 		        securityCouncil = _newSecurityCouncil;
```
[[258](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L258)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

// @audit _newPendingAdmin
114: 		        pendingAdmin = _newPendingAdmin;

// @audit _validatorTimelock
133: 		        validatorTimelock = _validatorTimelock;

// @audit _stateTransitionContract
234: 		        stateTransition[_chainId] = _stateTransitionContract;
```
[[114](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L114), [133](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L133), [234](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L234)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

// @audit _stateTransitionManager
74: 		        stateTransitionManager = _stateTransitionManager;

// @audit _newValidator
82: 		        validators[_chainId][_newValidator] = true;

// @audit _validator
91: 		        validators[_chainId][_validator] = false;
```
[[74](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L74), [82](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L82), [91](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L91)]



```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

// @audit _l1Token
99: 		            l1TokenAddress[expectedL2Token] = _l1Token;
```
[[99](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L99)]

</details>

---

## Non Critical Issues

---

### [N-01] Custom `error` should be used rather than `require`/`assert`

Custom errors are available from solidity version 0.8.4. Custom errors are more easily processed in try-catch blocks, and are easier to re-use and maintain.

*There are 333 instances of this issue.*

<details>
<summary>Expand findings</summary>


```solidity
File: code/system-contracts/contracts/AccountCodeStorage.sol

26: 		        require(msg.sender == address(DEPLOYER_SYSTEM_CONTRACT), "Callable only by the deployer system contract");

37: 		        require(Utils.isContractConstructing(_hash), "Code hash is not for a contract on constructor");

48: 		        require(Utils.isContractConstructed(_hash), "Code hash is not for a constructed contract");

57: 		        require(Utils.isContractConstructing(codeHash), "Code hash is not for a contract on constructor");
```
[[26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L26), [37](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L37), [48](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L48), [57](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L57)]



```solidity
File: code/system-contracts/contracts/BootloaderUtilities.sol

92: 		            require(vInt == 27 || vInt == 28, "Invalid v value");

191: 		            require(vInt == 27 || vInt == 28, "Invalid v value");

286: 		            require(vInt == 27 || vInt == 28, "Invalid v value");
```
[[92](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L92), [191](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L191), [286](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L286)]



```solidity
File: code/system-contracts/contracts/ComplexUpgrader.sol

22: 		        require(msg.sender == FORCE_DEPLOYER, "Can only be called by FORCE_DEPLOYER");

24: 		        require(_delegateTo.code.length > 0, "Delegatee is an EOA");
```
[[22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ComplexUpgrader.sol#L22), [24](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ComplexUpgrader.sol#L24)]



```solidity
File: code/system-contracts/contracts/Compressor.sol

51: 		            require(
52: 		                encodedData.length * 4 == _bytecode.length,
53: 		                "Encoded data length should be 4 times shorter than the original bytecode"
54: 		            );

56: 		            require(
57: 		                dictionary.length / 8 <= encodedData.length / 2,
58: 		                "Dictionary should have at most the same number of entries as the encoded data"
59: 		            );

63: 		                require(indexOfEncodedChunk < dictionary.length, "Encoded chunk index is out of bounds");

68: 		                require(encodedChunk == realChunk, "Encoded chunk does not match the original bytecode");

119: 		        require(_enumerationIndexSize <= MAX_ENUMERATION_INDEX_SIZE, "enumeration index size is too large");

140: 		            require(derivedKey == _compressedStateDiffs.readBytes32(stateDiffPtr), "iw: initial key mismatch");

156: 		        require(numInitialWritesProcessed == numberOfInitialWrites, "Incorrect number of initial storage diffs");

171: 		            require(enumIndex == compressedEnumIndex, "rw: enum key mismatch");

187: 		        require(stateDiffPtr == _compressedStateDiffs.length, "Extra data in _compressedStateDiffs");

230: 		                require(convertedValue == _finalValue, "transform or no compression: compressed and final mismatch");

232: 		                require(
233: 		                    _initialValue + convertedValue == _finalValue,
234: 		                    "add: initial plus converted not equal to final"
235: 		                );

237: 		                require(
238: 		                    _initialValue - convertedValue == _finalValue,
239: 		                    "sub: initial minus converted not equal to final"
240: 		                );
```
[[51-54](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L51-L54), [56-59](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L56-L59), [63](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L63), [68](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L68), [119](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L119), [140](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L140), [156](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L156), [171](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L171), [187](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L187), [230](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L230), [232-235](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L232-L235), [237-240](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L237-L240)]



```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

29: 		        require(msg.sender == address(this), "Callable only by self");

77: 		        require(
78: 		            _nonceOrdering == AccountNonceOrdering.Arbitrary &&
79: 		                currentInfo.nonceOrdering == AccountNonceOrdering.Sequential,
80: 		            "It is only possible to change from sequential to arbitrary ordering"
81: 		        );

239: 		        require(
240: 		            msg.sender == FORCE_DEPLOYER || msg.sender == address(COMPLEX_UPGRADER_CONTRACT),
241: 		            "Can only be called by FORCE_DEPLOYER or COMPLEX_UPGRADER_CONTRACT"
242: 		        );

251: 		        require(msg.value == sumOfValues, "`value` provided is not equal to the combined `value`s of deployments");

264: 		        require(_bytecodeHash != bytes32(0x0), "BytecodeHash cannot be zero");

265: 		        require(uint160(_newAddress) > MAX_SYSTEM_CONTRACT_ADDRESS, "Can not deploy contracts in kernel space");

268: 		        require(
269: 		            ACCOUNT_CODE_STORAGE_SYSTEM_CONTRACT.getCodeHash(uint256(uint160(_newAddress))) == 0x0,
270: 		            "Code hash is non-zero"
271: 		        );

273: 		        require(NONCE_HOLDER_SYSTEM_CONTRACT.getRawNonce(_newAddress) == 0x00, "Account is occupied");

303: 		        require(knownCodeMarker > 0, "The code hash is not known");

350: 		            require(value == 0, "The value must be zero if we do not call the constructor");
```
[[29](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L29), [77-81](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L77-L81), [239-242](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L239-L242), [251](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L251), [264](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L264), [265](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L265), [268-271](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L268-L271), [273](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L273), [303](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L303), [350](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L350)]



```solidity
File: code/system-contracts/contracts/DefaultAccount.sol

100: 		        require(totalRequiredBalance <= address(this).balance, "Not enough balance for fee + value");

160: 		        require(_signature.length == 65, "Signature length is incorrect");

173: 		        require(v == 27 || v == 28, "v is neither 27 nor 28");

184: 		        require(uint256(s) <= 0x7FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF5D576E7357A4501DDFE92F46681B20A0, "Invalid s");

202: 		        require(success, "Failed to pay the fee to the operator");

222: 		        assert(msg.sender != BOOTLOADER_FORMAL_ADDRESS);
```
[[100](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L100), [160](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L160), [173](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L173), [184](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L184), [202](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L202), [222](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L222)]



```solidity
File: code/system-contracts/contracts/GasBoundCaller.sol

46: 		        require(_maxTotalGas >= gasleft(), "Gas limit is too low");

76: 		            require(pubdataAllowance + gasleft() >= pubdataCost + CALL_RETURN_OVERHEAD, "Not enough gas for pubdata");
```
[[46](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/GasBoundCaller.sol#L46), [76](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/GasBoundCaller.sol#L76)]



```solidity
File: code/system-contracts/contracts/ImmutableSimulator.sol

35: 		        require(msg.sender == address(DEPLOYER_SYSTEM_CONTRACT), "Callable only by the deployer system contract");
```
[[35](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ImmutableSimulator.sol#L35)]



```solidity
File: code/system-contracts/contracts/KnownCodesStorage.sol

20: 		        require(msg.sender == address(COMPRESSOR_CONTRACT), "Callable only by the compressor");

76: 		        require(version == 1 && _bytecodeHash[1] == bytes1(0), "Incorrectly formatted bytecodeHash");

78: 		        require(Utils.bytecodeLenInWords(_bytecodeHash) % 2 == 1, "Code length in words must be odd");
```
[[20](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/KnownCodesStorage.sol#L20), [76](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/KnownCodesStorage.sol#L76), [78](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/KnownCodesStorage.sol#L78)]



```solidity
File: code/system-contracts/contracts/L1Messenger.sol

201: 		        require(numberOfL2ToL1Logs <= L2_TO_L1_LOGS_MERKLE_TREE_LEAVES, "Too many L2->L1 logs");

214: 		        require(
215: 		            reconstructedChainedLogsHash == chainedLogsHash,
216: 		            "reconstructedChainedLogsHash is not equal to chainedLogsHash"
217: 		        );

245: 		        require(
246: 		            reconstructedChainedMessagesHash == chainedMessagesHash,
247: 		            "reconstructedChainedMessagesHash is not equal to chainedMessagesHash"
248: 		        );

269: 		        require(
270: 		            reconstructedChainedL1BytecodesRevealDataHash == chainedL1BytecodesRevealDataHash,
271: 		            "reconstructedChainedL1BytecodesRevealDataHash is not equal to chainedL1BytecodesRevealDataHash"
272: 		        );

279: 		        require(
280: 		            uint256(uint8(bytes1(_totalL2ToL1PubdataAndStateDiffs[calldataPtr]))) ==
281: 		                STATE_DIFF_COMPRESSION_VERSION_NUMBER,
282: 		            "state diff compression version mismatch"
283: 		        );

298: 		        require(calldataPtr <= MAX_ALLOWED_PUBDATA_PER_BATCH, "L1 Messenger pubdata is too long");

315: 		        require(calldataPtr == _totalL2ToL1PubdataAndStateDiffs.length, "Extra data in the totalL2ToL1Pubdata array");
```
[[201](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L201), [214-217](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L214-L217), [245-248](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L245-L248), [269-272](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L269-L272), [279-283](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L279-L283), [298](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L298), [315](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L315)]



```solidity
File: code/system-contracts/contracts/L2BaseToken.sol

33: 		        require(
34: 		            msg.sender == MSG_VALUE_SYSTEM_CONTRACT ||
35: 		                msg.sender == address(DEPLOYER_SYSTEM_CONTRACT) ||
36: 		                msg.sender == BOOTLOADER_FORMAL_ADDRESS,
37: 		            "Only system contracts with special access can call this method"
38: 		        );

41: 		        require(fromBalance >= _amount, "Transfer amount exceeds balance");
```
[[33-38](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L2BaseToken.sol#L33-L38), [41](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L2BaseToken.sol#L41)]



```solidity
File: code/system-contracts/contracts/MsgValueSimulator.sol

60: 		        require(to != address(this), "MsgValueSimulator calls itself");
```
[[60](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/MsgValueSimulator.sol#L60)]



```solidity
File: code/system-contracts/contracts/NonceHolder.sol

66: 		        require(_value <= MAXIMAL_MIN_NONCE_INCREMENT, "The value for incrementing the nonce is too high");

85: 		        require(_value != 0, "Nonce value cannot be set to 0");

89: 		            require(isNonceUsed(msg.sender, _key - 1), "Previous nonce has not been used");

115: 		        require(oldMinNonce == _expectedNonce, "Incorrect nonce");

136: 		        require(
137: 		            msg.sender == address(DEPLOYER_SYSTEM_CONTRACT),
138: 		            "Only the contract deployer can increment the deployment nonce"
139: 		        );
```
[[66](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/NonceHolder.sol#L66), [85](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/NonceHolder.sol#L85), [89](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/NonceHolder.sol#L89), [115](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/NonceHolder.sol#L115), [136-139](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/NonceHolder.sol#L136-L139)]



```solidity
File: code/system-contracts/contracts/PubdataChunkPublisher.sol

22: 		        require(_pubdata.length <= BLOB_SIZE_BYTES * MAX_NUMBER_OF_BLOBS, "pubdata should fit in 2 blobs");
```
[[22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/PubdataChunkPublisher.sol#L22)]



```solidity
File: code/system-contracts/contracts/SystemContext.sol

242: 		        require(_isFirstInBatch, "Upgrade transaction must be first");

245: 		        require(_l2BlockNumber > 0, "L2 block number is never expected to be zero");

249: 		            require(correctPrevBlockHash == _expectedPrevL2BlockHash, "The previous L2 block hash is incorrect");

287: 		            require(_maxVirtualBlocksToCreate > 0, "Can't initialize the first virtual block");

351: 		            require(
352: 		                _l2BlockTimestamp >= currentBatchTimestamp,
353: 		                "The timestamp of the L2 block must be greater than or equal to the timestamp of the current batch"
354: 		            );

355: 		            require(_maxVirtualBlocksToCreate > 0, "There must be a virtual block created at the start of the batch");

367: 		            require(!_isFirstInBatch, "Can not reuse L2 block number from the previous batch");

368: 		            require(currentL2BlockTimestamp == _l2BlockTimestamp, "The timestamp of the same L2 block must be same");

369: 		            require(
370: 		                _expectedPrevL2BlockHash == _getLatest257L2blockHash(_l2BlockNumber - 1),
371: 		                "The previous hash of the same L2 block must be same"
372: 		            );

373: 		            require(_maxVirtualBlocksToCreate == 0, "Can not create virtual blocks in the middle of the miniblock");

385: 		            require(_expectedPrevL2BlockHash == pendingL2BlockHash, "The current L2 block hash is incorrect");

386: 		            require(
387: 		                _l2BlockTimestamp > currentL2BlockTimestamp,
388: 		                "The timestamp of the new L2 block must be greater than the timestamp of the previous L2 block"
389: 		            );

413: 		        require(currentBatchNumber > 0, "The current batch number must be greater than 0");

429: 		        require(
430: 		            _newTimestamp > currentBlockTimestamp,
431: 		            "The timestamp of the batch must be greater than the timestamp of the previous block"
432: 		        );

451: 		        require(_newTimestamp > previousBatchTimestamp, "Timestamps should be incremental");

452: 		        require(previousBatchNumber + 1 == _expectedNewNumber, "The provided block number is not correct");
```
[[242](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L242), [245](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L245), [249](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L249), [287](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L287), [351-354](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L351-L354), [355](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L355), [367](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L367), [368](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L368), [369-372](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L369-L372), [373](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L373), [385](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L385), [386-389](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L386-L389), [413](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L413), [429-432](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L429-L432), [451](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L451), [452](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L452)]



```solidity
File: code/contracts/zksync/contracts/SystemContractsCaller.sol

28: 		        require(_x <= type(uint32).max, "Overflow");
```
[[28](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/SystemContractsCaller.sol#L28)]



```solidity
File: code/system-contracts/contracts/interfaces/ISystemContract.sol

21: 		        require(
22: 		            SystemContractHelper.isSystemCall() || SystemContractHelper.isSystemContract(msg.sender),
23: 		            "This method require system call flag"
24: 		        );

31: 		        require(
32: 		            SystemContractHelper.isSystemContract(msg.sender),
33: 		            "This method require the caller to be system contract"
34: 		        );

41: 		        require(msg.sender == caller, "Inappropriate caller");

48: 		        require(msg.sender == BOOTLOADER_FORMAL_ADDRESS, "Callable only by the bootloader");

55: 		        require(msg.sender == FORCE_DEPLOYER);
```
[[21-24](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContract.sol#L21-L24), [31-34](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContract.sol#L31-L34), [41](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContract.sol#L41), [48](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContract.sol#L48), [55](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContract.sol#L55)]



```solidity
File: code/system-contracts/contracts/libraries/EfficientCall.sol

38: 		        require(returnData.length == 32, "keccak256 returned invalid data");

47: 		        require(returnData.length == 32, "sha returned invalid data");
```
[[38](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L38), [47](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L47)]



```solidity
File: code/system-contracts/contracts/libraries/RLPEncoder.sol

50: 		        assert(_len != 1);
```
[[50](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/RLPEncoder.sol#L50)]



```solidity
File: code/system-contracts/contracts/libraries/SystemContractHelper.sol

319: 		        require(index < 10, "There are only 10 accessible registers");

350: 		        require(precompileCallSuccess, "Failed to charge gas");
```
[[319](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L319), [350](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L350)]



```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

363: 		        require(_transaction.paymasterInput.length >= 4, "The standard paymaster input must be at least 4 bytes long");

367: 		            require(
368: 		                _transaction.paymasterInput.length >= 68,
369: 		                "The approvalBased paymaster input must be at least 68 bytes long"
370: 		            );
```
[[363](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L363), [367-370](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L367-L370)]



```solidity
File: code/system-contracts/contracts/libraries/Utils.sol

21: 		        require(_x <= type(uint128).max, "Overflow");

27: 		        require(_x <= type(uint32).max, "Overflow");

33: 		        require(_x <= type(uint24).max, "Overflow");

84: 		        require(_bytecode.length % 32 == 0, "po");

87: 		        require(lengthInWords < 2 ** 16, "pp"); // bytecode length must be less than 2^16 words

88: 		        require(lengthInWords % 2 == 1, "pr"); // bytecode length in words must be odd
```
[[21](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L21), [27](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L27), [33](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L33), [84](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L84), [87](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L87), [88](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L88)]



```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

64: 		        require(msg.sender == address(sharedBridge), "Not shared bridge");

66: 		        require(amount == _amount, "Incorrect amount");

141: 		        require(_amount != 0, "0T"); // empty deposit

143: 		        require(amount == _amount, "3T"); // The token has non-standard transfer logic

186: 		        require(amount != 0, "2T"); // empty deposit

215: 		        require(!isWithdrawalFinalized[_l2BatchNumber][_l2MessageIndex], "pw");
```
[[64](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L64), [66](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L66), [141](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L141), [143](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L143), [186](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L186), [215](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L215)]



```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

69: 		        require(msg.sender == address(bridgehub), "ShB not BH");

75: 		        require(
76: 		            msg.sender == address(bridgehub) || (_chainId == ERA_CHAIN_ID && msg.sender == ERA_DIAMOND_PROXY),
77: 		            "L1SharedBridge: not bridgehub or era chain"
78: 		        );

84: 		        require(msg.sender == address(legacyBridge), "ShB not legacy bridge");

108: 		        require(_owner != address(0), "ShB owner 0");

121: 		            require(balanceAfter > balanceBefore, "ShB: 0 eth transferred");

129: 		            require(amount > 0, "ShB: 0 amount to transfer");

132: 		            require(balanceAfter - balanceBefore == amount, "ShB: wrong amount transferred");

138: 		        require(bridgehub.getStateTransition(_chainId) == msg.sender, "receiveEth not state transition");

155: 		            require(msg.value == _amount, "L1SharedBridge: msg.value not equal to amount");

158: 		            require(msg.value == 0, "ShB m.v > 0 b d.it");

161: 		            require(amount == _amount, "3T"); // The token has non-standard transfer logic

188: 		        require(l2BridgeAddress[_chainId] != address(0), "ShB l2 bridge not deployed");

194: 		        require(_l1Token != l1WethAddress, "ShB: WETH deposit not supported");

195: 		        require(bridgehub.baseToken(_chainId) != _l1Token, "ShB: baseToken deposit not supported");

200: 		            require(_depositAmount == 0, "ShB wrong withdraw amount");

202: 		            require(msg.value == 0, "ShB m.v > 0 for BH d.it 2");

206: 		            require(withdrawAmount == _depositAmount, "5T"); // The token has non-standard transfer logic

208: 		        require(amount != 0, "6T"); // empty deposit amount

237: 		        require(depositHappened[_chainId][_txHash] == 0x00, "ShB tx hap");

325: 		            require(proofValid, "yn");

327: 		        require(_amount > 0, "y1");

342: 		                require(dataHash == txDataHash, "ShB: d.it not hap");

349: 		            require(chainBalance[_chainId][_l1Token] >= _amount, "ShB n funds");

360: 		            require(callSuccess, "ShB: claimFailedDeposit failed");

396: 		            require(!legacyBridge.isWithdrawalFinalized(_l2BatchNumber, _l2MessageIndex), "ShB: legacy withdrawal");

417: 		        require(!isWithdrawalFinalized[_chainId][_l2BatchNumber][_l2MessageIndex], "Withdrawal is already finalized");

427: 		            require(!alreadyFinalized, "Withdrawal is already finalized 2");

439: 		            require(chainBalance[_chainId][l1Token] >= amount, "ShB not enough funds 2"); // not enought funds

449: 		            require(callSuccess, "ShB: withdraw failed");

484: 		        require(success, "ShB withd w proof"); // withdrawal wrong proof

501: 		        require(_l2ToL1message.length >= 56, "ShB wrong msg len"); // wrong messsage length

517: 		            require(_l2ToL1message.length == 76, "ShB wrong msg len 2");

563: 		        require(l2BridgeAddress[ERA_CHAIN_ID] != address(0), "ShB b. n dep");

564: 		        require(_l1Token != l1WethAddress, "ShB: WETH deposit not supported 2");
```
[[69](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L69), [75-78](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L75-L78), [84](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L84), [108](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L108), [121](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L121), [129](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L129), [132](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L132), [138](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L138), [155](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L155), [158](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L158), [161](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L161), [188](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L188), [194](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L194), [195](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L195), [200](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L200), [202](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L202), [206](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L206), [208](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L208), [237](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L237), [325](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L325), [327](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L327), [342](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L342), [349](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L349), [360](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L360), [396](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L396), [417](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L417), [427](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L427), [439](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L439), [449](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L449), [484](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L484), [501](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L501), [517](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L517), [563](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L563), [564](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L564)]



```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

46: 		        require(msg.sender == admin || msg.sender == owner(), "Bridgehub: not owner or admin");

62: 		        require(msg.sender == currentPendingAdmin, "n42"); // Only proposed by current admin address can claim the admin rights

83: 		        require(
84: 		            !stateTransitionManagerIsRegistered[_stateTransitionManager],
85: 		            "Bridgehub: state transition already registered"
86: 		        );

93: 		        require(
94: 		            stateTransitionManagerIsRegistered[_stateTransitionManager],
95: 		            "Bridgehub: state transition not registered yet"
96: 		        );

102: 		        require(!tokenIsRegistered[_token], "Bridgehub: token already registered");

122: 		        require(_chainId != 0, "Bridgehub: chainId cannot be 0");

123: 		        require(_chainId <= type(uint48).max, "Bridgehub: chainId too large");

125: 		        require(
126: 		            stateTransitionManagerIsRegistered[_stateTransitionManager],
127: 		            "Bridgehub: state transition not registered"
128: 		        );

129: 		        require(tokenIsRegistered[_baseToken], "Bridgehub: token not registered");

130: 		        require(address(sharedBridge) != address(0), "Bridgehub: weth bridge not set");

132: 		        require(stateTransitionManager[_chainId] == address(0), "Bridgehub: chainId already registered");

223: 		                require(msg.value == _request.mintValue, "Bridgehub: msg.value mismatch 1");

225: 		                require(msg.value == 0, "Bridgehub: non-eth bridge with msg.value");

269: 		                require(
270: 		                    msg.value == _request.mintValue + _request.secondBridgeValue,
271: 		                    "Bridgehub: msg.value mismatch 2"
272: 		                );

275: 		                require(msg.value == _request.secondBridgeValue, "Bridgehub: msg.value mismatch 3");

296: 		        require(outputRequest.magicValue == TWO_BRIDGES_MAGIC_VALUE, "Bridgehub: magic value mismatch");

300: 		        require(
301: 		            _request.secondBridgeAddress > BRIDGEHUB_MIN_SECOND_BRIDGE_ADDRESS,
302: 		            "Bridgehub: second bridge address too low"
303: 		        ); // to avoid calls to precompiles
```
[[46](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L46), [62](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L62), [83-86](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L83-L86), [93-96](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L93-L96), [102](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L102), [122](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L122), [123](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L123), [125-128](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L125-L128), [129](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L129), [130](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L130), [132](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L132), [223](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L223), [225](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L225), [269-272](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L269-L272), [275](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L275), [296](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L296), [300-303](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L300-L303)]



```solidity
File: code/contracts/ethereum/contracts/common/ReentrancyGuard.sol

58: 		        require(lockSlotOldValue == 0, "1B");

75: 		        require(_status == _NOT_ENTERED, "r1");
```
[[58](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/ReentrancyGuard.sol#L58), [75](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/ReentrancyGuard.sol#L75)]



```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

42: 		        require(_admin != address(0), "Admin should be non zero address");

59: 		        require(msg.sender == address(this), "Only governance contract itself is allowed to call this function");

65: 		        require(msg.sender == securityCouncil, "Only security council is allowed to call this function");

71: 		        require(
72: 		            msg.sender == owner() || msg.sender == securityCouncil,
73: 		            "Only the owner and security council are allowed to call this function"
74: 		        );

155: 		        require(isOperationPending(_id), "Operation must be pending");

172: 		        require(isOperationReady(id), "Operation must be ready before execution");

177: 		        require(isOperationReady(id), "Operation must be ready after execution");

191: 		        require(isOperationPending(id), "Operation must be pending before execution");

196: 		        require(isOperationPending(id), "Operation must be pending after execution");

216: 		        require(!isOperation(_id), "Operation with this proposal id already exists");

217: 		        require(_delay >= minDelay, "Proposed delay is less than minimum delay");

240: 		        require(_predecessorId == bytes32(0) || isOperationDone(_predecessorId), "Predecessor operation not completed");
```
[[42](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L42), [59](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L59), [65](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L65), [71-74](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L71-L74), [155](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L155), [172](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L172), [177](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L177), [191](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L191), [196](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L196), [216](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L216), [217](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L217), [240](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L240)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

64: 		        require(msg.sender == bridgehub, "StateTransition: only bridgehub");

70: 		        require(msg.sender == admin || msg.sender == owner(), "Bridgehub: not owner or admin");

82: 		        require(_initializeData.governor != address(0), "StateTransition: governor zero");

106: 		        assert(L2_TO_L1_LOG_SERIALIZE_SIZE != 2 * 32);

121: 		        require(msg.sender == currentPendingAdmin, "n42"); // Only proposed by current admin address can claim the admin rights

256: 		        require(cutHashInput == initialCutHash, "StateTransition: initial cutHash mismatch");
```
[[64](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L64), [70](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L70), [82](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L82), [106](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L106), [121](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L121), [256](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L256)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

62: 		        require(msg.sender == stateTransitionManager.getChainAdmin(_chainId), "ValidatorTimelock: only chain admin");

68: 		        require(validators[_chainId][msg.sender] == true, "ValidatorTimelock: only validator");

195: 		                require(block.timestamp >= commitBatchTimestamp + delay, "5c"); // The delay is not passed

217: 		                require(block.timestamp >= commitBatchTimestamp + delay, "5c"); // The delay is not passed
```
[[62](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L62), [68](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L68), [195](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L195), [217](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L217)]



```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol

72: 		        require(block.timestamp >= _proposedUpgrade.upgradeTimestamp, "Upgrade is not ready yet");

190: 		        require(_l2ProtocolUpgradeTx.txType == SYSTEM_UPGRADE_L2_TX_TYPE, "L2 system upgrade tx type is wrong");

205: 		        require(
206: 		            _l2ProtocolUpgradeTx.nonce == _newProtocolVersion,
207: 		            "The new protocol version should be included in the L2 system upgrade tx"
208: 		        );

223: 		        require(_factoryDeps.length == _expectedHashes.length, "Wrong number of factory deps");

224: 		        require(_factoryDeps.length <= MAX_NEW_FACTORY_DEPS, "Factory deps can be at most 32");

227: 		            require(
228: 		                L2ContractHelper.hashL2Bytecode(_factoryDeps[i]) == bytes32(_expectedHashes[i]),
229: 		                "Wrong factory dep hash"
230: 		            );

238: 		        require(
239: 		            _newProtocolVersion > previousProtocolVersion,
240: 		            "New protocol version is not greater than the current one"
241: 		        );

242: 		        require(
243: 		            _newProtocolVersion - previousProtocolVersion <= MAX_ALLOWED_PROTOCOL_VERSION_DELTA,
244: 		            "Too big protocol version difference"
245: 		        );

249: 		        require(s.l2SystemContractsUpgradeTxHash == bytes32(0), "Previous upgrade has not been finalized");

250: 		        require(
251: 		            s.l2SystemContractsUpgradeBatchNumber == 0,
252: 		            "The batch number of the previous upgrade has not been cleaned"
253: 		        );
```
[[72](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L72), [190](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L190), [205-208](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L205-L208), [223](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L223), [224](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L224), [227-230](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L227-L230), [238-241](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L238-L241), [242-245](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L242-L245), [249](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L249), [250-253](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L250-L253)]



```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol

22: 		        require(
23: 		            // Genesis Upgrade difference: Note this is the only thing change > to >=
24: 		            _newProtocolVersion >= previousProtocolVersion,
25: 		            "New protocol version is not greater than the current one"
26: 		        );

27: 		        require(
28: 		            _newProtocolVersion - previousProtocolVersion <= MAX_ALLOWED_PROTOCOL_VERSION_DELTA,
29: 		            "Too big protocol version difference"
30: 		        );

33: 		        require(s.l2SystemContractsUpgradeTxHash == bytes32(0), "Previous upgrade has not been finalized");

34: 		        require(
35: 		            s.l2SystemContractsUpgradeBatchNumber == 0,
36: 		            "The batch number of the previous upgrade has not been cleaned"
37: 		        );

52: 		        require(block.timestamp >= _proposedUpgrade.upgradeTimestamp, "Upgrade is not ready yet");
```
[[22-26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L22-L26), [27-30](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L27-L30), [33](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L33), [34-37](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L34-L37), [52](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L52)]



```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

55: 		        require(_l1Bridge != address(0), "bf");

56: 		        require(_l2TokenProxyBytecodeHash != bytes32(0), "df");

57: 		        require(_aliasedOwner != address(0), "sf");

58: 		        require(_l2TokenProxyBytecodeHash != bytes32(0), "df");

68: 		            require(_l1LegecyBridge != address(0), "bf2");

87: 		        require(
88: 		            AddressAliasHelper.undoL1ToL2Alias(msg.sender) == l1Bridge ||
89: 		                AddressAliasHelper.undoL1ToL2Alias(msg.sender) == l1LegacyBridge,
90: 		            "mq"
91: 		        );

92: 		        require(msg.value == 0, "Value should be 0 for ERC20 bridge");

98: 		            require(deployedToken == expectedL2Token, "mt");

101: 		            require(currentL1Token == _l1Token, "gg"); // Double check that the expected value equal to real one

124: 		        require(_amount > 0, "Amount cannot be zero");

129: 		        require(l1Token != address(0), "yh");

176: 		        require(success, "mk");
```
[[55](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L55), [56](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L56), [57](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L57), [58](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L58), [68](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L68), [87-91](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L87-L91), [92](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L92), [98](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L98), [101](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L101), [124](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L124), [129](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L129), [176](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L176)]



```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

51: 		        require(_l1Address != address(0), "in6"); // Should be non-zero address

120: 		        require(msg.sender == UpgradeableBeacon(beaconAddress).owner(), "tt");

130: 		        require(msg.sender == l2Bridge, "xnt"); // Only L2 bridge can call this method

137: 		        require(_version == _getInitializedVersion() + 1, "v");
```
[[51](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L51), [120](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L120), [130](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L130), [137](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L137)]



```solidity
File: code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol

23: 		        require(_bytecode.length % 32 == 0, "pq");

26: 		        require(bytecodeLenInWords < 2 ** 16, "pp"); // bytecode length must be less than 2^16 words

27: 		        require(bytecodeLenInWords % 2 == 1, "ps"); // bytecode length in words must be odd

41: 		        require(version == 1 && _bytecodeHash[1] == bytes1(0), "zf"); // Incorrectly formatted bytecodeHash

43: 		        require(bytecodeLen(_bytecodeHash) % 2 == 1, "uy"); // Code length in words must be odd
```
[[23](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L23), [26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L26), [27](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L27), [41](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L41), [43](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L43)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol

25: 		        require(address(_initializeData.verifier) != address(0), "vt");

26: 		        require(_initializeData.admin != address(0), "vy");

27: 		        require(_initializeData.validatorTimelock != address(0), "hc");

28: 		        require(_initializeData.priorityTxMaxGasLimit <= MAX_GAS_PER_TRANSACTION, "vu");

51: 		        assert(L2_TO_L1_LOG_SERIALIZE_SIZE != 2 * 32);
```
[[25](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol#L25), [26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol#L26), [27](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol#L27), [28](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol#L28), [51](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol#L51)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol

14: 		        require(_chainId == block.chainid, "pr");

25: 		        require(msg.data.length >= 4 || msg.data.length == 0, "Ut");

30: 		        require(facetAddress != address(0), "F"); // Proxy has no facet for this selector

31: 		        require(!diamondStorage.isFrozen || !facet.isFreezable, "q1"); // Facet is frozen
```
[[14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol#L14), [25](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol#L25), [30](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol#L30), [31](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol#L31)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol

107: 		            require(selectors.length > 0, "B"); // no functions for diamond cut

132: 		        require(_facet.code.length > 0, "G");

141: 		            require(oldFacet.facetAddress == address(0), "J"); // facet for this selector already exists

155: 		        require(_facet.code.length > 0, "K");

161: 		            require(oldFacet.facetAddress != address(0), "L"); // it is impossible to replace the facet with zero address

175: 		        require(_facet == address(0), "a1"); // facet address must be zero

181: 		            require(oldFacet.facetAddress != address(0), "a2"); // Can't delete a non-existent facet

215: 		            require(_isSelectorFreezable == ds.selectorToFacet[selector0].isFreezable, "J1");

280: 		            require(_calldata.length == 0, "H"); // Non-empty calldata for zero address

297: 		            require(data.length == 32, "lp");

298: 		            require(abi.decode(data, (bytes32)) == DIAMOND_INIT_SUCCESS_RETURN_VALUE, "lp1");
```
[[107](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L107), [132](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L132), [141](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L141), [155](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L155), [161](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L161), [175](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L175), [181](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L181), [215](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L215), [280](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L280), [297](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L297), [298](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L298)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol

24: 		        require(pathLength > 0, "xc");

25: 		        require(pathLength < 256, "bt");

26: 		        require(_index < (1 << pathLength), "px");
```
[[24](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol#L24), [25](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol#L25), [26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol#L26)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol

65: 		        require(!_queue.isEmpty(), "D"); // priority queue is empty

73: 		        require(!_queue.isEmpty(), "s"); // priority queue is empty
```
[[65](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L65), [73](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L73)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol

28: 		        require(l2GasForTxBody <= _priorityTxMaxGasLimit, "ui");

30: 		        require(l2GasForTxBody / _transaction.gasPerPubdataByteLimit <= _priorityTxMaxPubdata, "uk");

34: 		        require(
35: 		            getMinimalPriorityTransactionGasLimit(
36: 		                _encoded.length,
37: 		                _transaction.factoryDeps.length,
38: 		                _transaction.gasPerPubdataByteLimit
39: 		            ) <= l2GasForTxBody,
40: 		            "up"
41: 		        );

48: 		        require(_transaction.from <= type(uint16).max, "ua");

49: 		        require(_transaction.to <= type(uint160).max, "ub");

50: 		        require(_transaction.paymaster == 0, "uc");

51: 		        require(_transaction.value == 0, "ud");

52: 		        require(_transaction.maxFeePerGas == 0, "uq");

53: 		        require(_transaction.maxPriorityFeePerGas == 0, "ux");

54: 		        require(_transaction.reserved[0] == 0, "ue");

55: 		        require(_transaction.reserved[1] <= type(uint160).max, "uf");

56: 		        require(_transaction.reserved[2] == 0, "ug");

57: 		        require(_transaction.reserved[3] == 0, "uo");

58: 		        require(_transaction.signature.length == 0, "uh");

59: 		        require(_transaction.paymasterInput.length == 0, "ul1");

60: 		        require(_transaction.reservedDynamic.length == 0, "um");

115: 		        require(_totalGasLimit >= overhead, "my"); // provided gas limit doesn't cover transaction overhead
```
[[28](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L28), [30](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L30), [34-41](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L34-L41), [48](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L48), [49](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L49), [50](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L50), [51](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L51), [52](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L52), [53](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L53), [54](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L54), [55](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L55), [56](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L56), [57](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L57), [58](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L58), [59](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L59), [60](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L60), [115](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L115)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol

34: 		        require(msg.sender == pendingAdmin, "n4"); // Only proposed by current admin address can claim the admin rights

59: 		        require(_newPriorityTxMaxGasLimit <= MAX_GAS_PER_TRANSACTION, "n5");

70: 		        require(_newFeeParams.maxPubdataPerBatch >= _newFeeParams.priorityTxMaxPubdata, "n6");

90: 		        require(s.totalBatchesCommitted == 0, "AdminFacet: set validium only after genesis"); // Validium mode can be set only before the first batch is committed

105: 		        require(
106: 		            cutHashInput == IStateTransitionManager(s.stateTransitionManager).upgradeCutHash(_oldProtocolVersion),
107: 		            "StateTransition: cutHash mismatch"
108: 		        );

110: 		        require(
111: 		            s.protocolVersion == _oldProtocolVersion,
112: 		            "StateTransition: protocolVersion mismatch in STC when upgrading"
113: 		        );

116: 		        require(
117: 		            s.protocolVersion > _oldProtocolVersion,
118: 		            "StateTransition: protocolVersion mismatch in STC after upgrading"
119: 		        );

136: 		        require(!diamondStorage.isFrozen, "a9"); // diamond proxy is frozen already

146: 		        require(diamondStorage.isFrozen, "a7"); // diamond proxy is not frozen
```
[[34](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L34), [59](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L59), [70](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L70), [90](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L90), [105-108](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L105-L108), [110-113](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L110-L113), [116-119](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L116-L119), [136](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L136), [146](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L146)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

37: 		        require(_newBatch.batchNumber == _previousBatch.batchNumber + 1, "f"); // only commit next batch

40: 		        require(pubdataSource == uint8(PubdataSource.Calldata) || pubdataSource == uint8(PubdataSource.Blob), "us");

50: 		            require(logOutput.pubdataHash == 0x00, "v0h");

51: 		            require(_newBatch.pubdataCommitments.length == 1);

61: 		            require(
62: 		                logOutput.pubdataHash ==
63: 		                    keccak256(_newBatch.pubdataCommitments[1:_newBatch.pubdataCommitments.length - 32]),
64: 		                "wp"
65: 		            );

74: 		        require(_previousBatch.batchHash == logOutput.previousBatchHash, "l");

76: 		        require(logOutput.chainedPriorityTxsHash == _newBatch.priorityOperationsHash, "t");

78: 		        require(logOutput.numberOfLayer1Txs == _newBatch.numberOfLayer1Txs, "ta");

110: 		        require(batchTimestamp == _expectedBatchTimestamp, "tb");

114: 		        require(_previousBatchTimestamp < batchTimestamp, "h3");

122: 		        require(block.timestamp - COMMIT_TIMESTAMP_NOT_OLDER <= batchTimestamp, "h1"); // New batch timestamp is too small

123: 		        require(lastL2BlockTimestamp <= block.timestamp + COMMIT_TIMESTAMP_APPROXIMATION_DELTA, "h2"); // The last L2 block timestamp is too big

149: 		            require(!_checkBit(processedLogs, uint8(logKey)), "kp");

154: 		                require(logSender == L2_TO_L1_MESSENGER_SYSTEM_CONTRACT_ADDR, "lm");

157: 		                require(logSender == L2_TO_L1_MESSENGER_SYSTEM_CONTRACT_ADDR, "ln");

160: 		                require(logSender == L2_TO_L1_MESSENGER_SYSTEM_CONTRACT_ADDR, "lb");

163: 		                require(logSender == L2_SYSTEM_CONTEXT_SYSTEM_CONTRACT_ADDR, "sc");

166: 		                require(logSender == L2_SYSTEM_CONTEXT_SYSTEM_CONTRACT_ADDR, "sv");

169: 		                require(logSender == L2_BOOTLOADER_ADDRESS, "bl");

172: 		                require(logSender == L2_BOOTLOADER_ADDRESS, "bk");

175: 		                require(logSender == L2_PUBDATA_CHUNK_PUBLISHER_ADDR, "pc");

178: 		                require(logSender == L2_PUBDATA_CHUNK_PUBLISHER_ADDR, "pd");

181: 		                require(logSender == L2_BOOTLOADER_ADDRESS, "bu");

182: 		                require(_expectedSystemContractUpgradeTxHash == logValue, "ut");

192: 		            require(processedLogs == 511, "b7");

194: 		            require(processedLogs == 1023, "b8");

226: 		        require(
227: 		            IStateTransitionManager(s.stateTransitionManager).protocolVersion() == s.protocolVersion,
228: 		            "Executor facet: wrong protocol version"
229: 		        );

231: 		        require(_newBatchesData.length == 1, "e4");

233: 		        require(s.storedBatchHashes[s.totalBatchesCommitted] == _hashStoredBatchInfo(_lastCommittedBatchData), "i"); // incorrect previous batch data

284: 		        require(s.l2SystemContractsUpgradeBatchNumber == 0, "ik");

323: 		        require(currentBatchNumber == s.totalBatchesExecuted + _executedBatchIdx + 1, "k"); // Execute batches in order

324: 		        require(
325: 		            _hashStoredBatchInfo(_storedBatch) == s.storedBatchHashes[currentBatchNumber],
326: 		            "exe10" // executing batch should be committed
327: 		        );

330: 		        require(priorityOperationsHash == _storedBatch.priorityOperationsHash, "x"); // priority operations hash does not match to expected

358: 		        require(newTotalBatchesExecuted <= s.totalBatchesVerified, "n"); // Can't execute batches more than committed and proven currently.

402: 		        require(_hashStoredBatchInfo(_prevBatch) == s.storedBatchHashes[currentTotalBatchesVerified], "t1");

407: 		            require(
408: 		                _hashStoredBatchInfo(_committedBatches[i]) == s.storedBatchHashes[currentTotalBatchesVerified],
409: 		                "o1"
410: 		            );

421: 		        require(currentTotalBatchesVerified <= s.totalBatchesCommitted, "q");

426: 		        assert(block.chainid != 1);

442: 		        require(proofPublicInput.length == 1, "t4");

449: 		        require(successVerifyProof, "p"); // Proof verification fail

482: 		        require(s.totalBatchesCommitted > _newLastBatch, "v1"); // The last committed batch is less than new last batch

483: 		        require(_newLastBatch >= s.totalBatchesExecuted, "v2"); // Already executed batches cannot be reverted

543: 		        require(_batch.systemLogs.length <= MAX_L2_TO_L1_LOGS_COMMITMENT_BYTES, "pu");

567: 		        require(_blobCommitments.length == MAX_NUMBER_OF_BLOBS, "b10");

568: 		        require(_blobHashes.length == MAX_NUMBER_OF_BLOBS, "b11");

616: 		        require(success, "failed to call point evaluation precompile");

618: 		        require(result == BLS_MODULUS, "precompile unexpected output");

631: 		        require(_pubdataCommitments.length > 0, "pl");

632: 		        require(_pubdataCommitments.length <= PUBDATA_COMMITMENT_SIZE * MAX_NUMBER_OF_BLOBS, "bd");

633: 		        require(_pubdataCommitments.length % PUBDATA_COMMITMENT_SIZE == 0, "bs");

639: 		            require(blobVersionedHash != bytes32(0), "vh");

663: 		        require(versionedHash == bytes32(0), "lh");

668: 		            require(
669: 		                (_blobHashes[i] == bytes32(0) && blobCommitments[i] == bytes32(0)) ||
670: 		                    (_blobHashes[i] != bytes32(0) && blobCommitments[i] != bytes32(0)),
671: 		                "bh"
672: 		            );

681: 		        require(success, "vc");
```
[[37](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L37), [40](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L40), [50](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L50), [51](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L51), [61-65](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L61-L65), [74](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L74), [76](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L76), [78](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L78), [110](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L110), [114](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L114), [122](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L122), [123](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L123), [149](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L149), [154](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L154), [157](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L157), [160](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L160), [163](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L163), [166](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L166), [169](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L169), [172](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L172), [175](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L175), [178](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L178), [181](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L181), [182](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L182), [192](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L192), [194](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L194), [226-229](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L226-L229), [231](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L231), [233](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L233), [284](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L284), [323](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L323), [324-327](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L324-L327), [330](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L330), [358](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L358), [402](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L402), [407-410](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L407-L410), [421](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L421), [426](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L426), [442](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L442), [449](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L449), [482](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L482), [483](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L483), [543](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L543), [567](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L567), [568](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L568), [616](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L616), [618](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L618), [631](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L631), [632](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L632), [633](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L633), [639](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L639), [663](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L663), [668-672](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L668-L672), [681](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L681)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol

183: 		        require(ds.selectorToFacet[_selector].facetAddress != address(0), "g2");
```
[[183](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L183)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

39: 		        require(s.chainId == ERA_CHAIN_ID, "transferEthToSharedBridge only available for Era on mailbox");

110: 		        require(_batchNumber <= s.totalBatchesExecuted, "xx");

117: 		        require(hashedLog != L2_L1_LOGS_TREE_DEFAULT_LEAF_HASH, "tw");

158: 		        require(s.baseTokenGasPriceMultiplierDenominator > 0, "Mailbox: baseTokenGasPriceDenominator not set");

185: 		        require(s.chainId == ERA_CHAIN_ID, "finalizeEthWithdrawal only available for Era on mailbox");

206: 		        require(s.chainId == ERA_CHAIN_ID, "legacy interface only available for era token");

243: 		        require(_request.l2GasPerPubdataByteLimit == REQUIRED_L2_GAS_PRICE_PER_PUBDATA, "qp");

264: 		        require(_factoryDeps.length <= MAX_NEW_FACTORY_DEPS, "uj");

272: 		        require(_mintValue >= baseCost + _params.l2Value, "mv"); // The `msg.value` doesn't cover the transaction cost
```
[[39](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L39), [110](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L110), [117](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L117), [158](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L158), [185](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L185), [206](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L206), [243](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L243), [264](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L264), [272](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L272)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol

16: 		        require(msg.sender == s.admin, "StateTransition Chain: not admin");

22: 		        require(s.validators[msg.sender], "StateTransition Chain: not validator");

27: 		        require(msg.sender == s.stateTransitionManager, "StateTransition Chain: not state transition manager");

32: 		        require(msg.sender == s.bridgehub, "StateTransition Chain: not bridgehub");

37: 		        require(
38: 		            msg.sender == s.admin || msg.sender == s.stateTransitionManager,
39: 		            "StateTransition Chain: Only by admin or state transition manager"
40: 		        );

45: 		        require(
46: 		            s.validators[msg.sender] || msg.sender == s.stateTransitionManager,
47: 		            "StateTransition Chain: Only by validator or state transition manager"
48: 		        );

53: 		        require(msg.sender == s.baseTokenBridge, "Only shared bridge can call this function");
```
[[16](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L16), [22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L22), [27](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L27), [32](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L32), [37-40](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L37-L40), [45-48](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L45-L48), [53](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L53)]

</details>

---

### [N-02] High cyclomatic complexity

Consider breaking down these blocks into more manageable units, by splitting things into utility functions, by reducing nesting, and by using early returns.

*There are 16 instances of this issue.*

<details>
<summary>Expand findings</summary>


```solidity
File: code/system-contracts/contracts/BootloaderUtilities.sol

44: 		    function encodeLegacyTransactionHash(Transaction calldata _transaction) internal view returns (bytes32 txHash) {

139: 		    function encodeEIP2930TransactionHash(Transaction calldata _transaction) internal view returns (bytes32) {

229: 		    function encodeEIP1559TransactionHash(Transaction calldata _transaction) internal view returns (bytes32) {
```
[[44](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L44), [139](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L139), [229](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L229)]



```solidity
File: code/system-contracts/contracts/Compressor.sol

110: 		    function verifyCompressedStateDiffs(
```
[[110](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L110)]



```solidity
File: code/system-contracts/contracts/L1Messenger.sol

194: 		    function publishPubdataAndClearState(
```
[[194](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L194)]



```solidity
File: code/system-contracts/contracts/SystemContext.sol

341: 		    function setL2Block(
```
[[341](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L341)]



```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

147: 		    function _encodeHashLegacyTransaction(Transaction calldata _transaction) private view returns (bytes32) {

219: 		    function _encodeHashEIP2930Transaction(Transaction calldata _transaction) private view returns (bytes32) {

289: 		    function _encodeHashEIP1559Transaction(Transaction calldata _transaction) private view returns (bytes32) {
```
[[147](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L147), [219](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L219), [289](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L289)]



```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

303: 		    function _claimFailedDeposit(
```
[[303](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L303)]



```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

262: 		    function requestL2TransactionTwoBridges(
```
[[262](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L262)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

177: 		    function _setChainIdUpgrade(uint256 _chainId, address _chainContract) internal {
```
[[177](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L177)]



```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

50: 		    function bridgeInitialize(address _l1Address, bytes memory _data) external initializer {
```
[[50](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L50)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

32: 		    function _commitOneBatch(

130: 		    function _processL2Logs(

386: 		    function _proveBatches(
```
[[32](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L32), [130](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L130), [386](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L386)]

</details>

---

### [N-03] Missing events in sensitive functions

Events should be emitted when sensitive changes are made to the contracts, but some functions lack them.

*There are 20 instances of this issue.*

<details>
<summary>Expand findings</summary>


```solidity
File: code/system-contracts/contracts/ImmutableSimulator.sol

34: 		    function setImmutables(address _dest, ImmutableData[] calldata _immutables) external override {
35: 		        require(msg.sender == address(DEPLOYER_SYSTEM_CONTRACT), "Callable only by the deployer system contract");
36: 		        unchecked {
37: 		            uint256 immutablesLength = _immutables.length;
38: 		            for (uint256 i = 0; i < immutablesLength; ++i) {
39: 		                uint256 index = _immutables[i].index;
40: 		                bytes32 value = _immutables[i].value;
41: 		                immutableDataStorage[uint256(uint160(_dest))][index] = value;
42: 		            }
43: 		        }
44: 		    }
```
[[34-44](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ImmutableSimulator.sol#L34-L44)]



```solidity
File: code/system-contracts/contracts/SystemContext.sol

84: 		    function setChainId(uint256 _newChainId) external onlyCallFromForceDeployer {
85: 		        chainId = _newChainId;
86: 		    }

99: 		    function setTxOrigin(address _newOrigin) external onlyCallFromBootloader {
100: 		        origin = _newOrigin;
101: 		    }

105: 		    function setGasPrice(uint256 _gasPrice) external onlyCallFromBootloader {
106: 		        gasPrice = _gasPrice;
107: 		    }

112: 		    function setPubdataInfo(uint256 _gasPerPubdataByte, uint256 _basePubdataSpent) external onlyCallFromBootloader {
113: 		        basePubdataSpent = _basePubdataSpent;
114: 		        gasPerPubdataByte = _gasPerPubdataByte;
115: 		    }

212: 		    function _setL2BlockHash(uint256 _block, bytes32 _hash) internal {
213: 		        l2BlockHash[_block % MINIBLOCK_HASHES_TO_STORE] = _hash;
214: 		    }

263: 		    function _setVirtualBlock(
264: 		        uint128 _l2BlockNumber,
265: 		        uint128 _maxVirtualBlocksToCreate,
266: 		        uint128 _newTimestamp
267: 		    ) internal {
268: 		        if (virtualBlockUpgradeInfo.virtualBlockFinishL2Block != 0) {
269: 		            // No need to to do anything about virtual blocks anymore
270: 		            // All the info is the same as for L2 blocks.
271: 		            currentVirtualL2BlockInfo = currentL2BlockInfo;
272: 		            return;
273: 		        }
274: 		
275: 		        BlockInfo memory virtualBlockInfo = currentVirtualL2BlockInfo;
276: 		
277: 		        if (currentVirtualL2BlockInfo.number == 0 && virtualBlockInfo.timestamp == 0) {
278: 		            uint128 currentBatchNumber = currentBatchInfo.number;
279: 		
280: 		            // The virtual block is set for the first time. We can count it as 1 creation of a virtual block.
281: 		            // Note, that when setting the virtual block number we use the batch number to make a smoother upgrade from batch number to
282: 		            // the L2 block number.
283: 		            virtualBlockInfo.number = currentBatchNumber;
284: 		            // Remembering the batch number on which the upgrade to the virtual blocks has been done.
285: 		            virtualBlockUpgradeInfo.virtualBlockStartBatch = currentBatchNumber;
286: 		
287: 		            require(_maxVirtualBlocksToCreate > 0, "Can't initialize the first virtual block");
288: 		            _maxVirtualBlocksToCreate -= 1;
289: 		        } else if (_maxVirtualBlocksToCreate == 0) {
290: 		            // The virtual blocks have been already initialized, but the operator didn't ask to create
291: 		            // any new virtual blocks. So we can just return.
292: 		            return;
293: 		        }
294: 		
295: 		        virtualBlockInfo.number += _maxVirtualBlocksToCreate;
296: 		        virtualBlockInfo.timestamp = _newTimestamp;
297: 		
298: 		        // The virtual block number must never exceed the L2 block number.
299: 		        // We do not use a `require` here, since the virtual blocks are a temporary solution to let the Solidity's `block.number`
300: 		        // catch up with the L2 block number and so the situation where virtualBlockInfo.number starts getting larger
301: 		        // than _l2BlockNumber is expected once virtual blocks have caught up the L2 blocks.
302: 		        if (virtualBlockInfo.number >= _l2BlockNumber) {
303: 		            virtualBlockUpgradeInfo.virtualBlockFinishL2Block = _l2BlockNumber;
304: 		            virtualBlockInfo.number = _l2BlockNumber;
305: 		        }
306: 		
307: 		        currentVirtualL2BlockInfo = virtualBlockInfo;
308: 		    }

314: 		    function _setNewL2BlockData(uint128 _l2BlockNumber, uint128 _l2BlockTimestamp, bytes32 _prevL2BlockHash) internal {
315: 		        // In the unsafe version we do not check that the block data is correct
316: 		        currentL2BlockInfo = BlockInfo({number: _l2BlockNumber, timestamp: _l2BlockTimestamp});
317: 		
318: 		        // It is always assumed in production that _l2BlockNumber > 0
319: 		        _setL2BlockHash(_l2BlockNumber - 1, _prevL2BlockHash);
320: 		
321: 		        // Reseting the rolling hash
322: 		        currentL2BlockTxsRollingHash = bytes32(0);
323: 		    }

341: 		    function setL2Block(
342: 		        uint128 _l2BlockNumber,
343: 		        uint128 _l2BlockTimestamp,
344: 		        bytes32 _expectedPrevL2BlockHash,
345: 		        bool _isFirstInBatch,
346: 		        uint128 _maxVirtualBlocksToCreate
347: 		    ) external onlyCallFromBootloader {
348: 		        // We check that the timestamp of the L2 block is consistent with the timestamp of the batch.
349: 		        if (_isFirstInBatch) {
350: 		            uint128 currentBatchTimestamp = currentBatchInfo.timestamp;
351: 		            require(
352: 		                _l2BlockTimestamp >= currentBatchTimestamp,
353: 		                "The timestamp of the L2 block must be greater than or equal to the timestamp of the current batch"
354: 		            );
355: 		            require(_maxVirtualBlocksToCreate > 0, "There must be a virtual block created at the start of the batch");
356: 		        }
357: 		
358: 		        (uint128 currentL2BlockNumber, uint128 currentL2BlockTimestamp) = getL2BlockNumberAndTimestamp();
359: 		
360: 		        if (currentL2BlockNumber == 0 && currentL2BlockTimestamp == 0) {
361: 		            // Since currentL2BlockNumber and currentL2BlockTimestamp are zero it means that it is
362: 		            // the first ever batch with L2 blocks, so we need to initialize those.
363: 		            _upgradeL2Blocks(_l2BlockNumber, _expectedPrevL2BlockHash, _isFirstInBatch);
364: 		
365: 		            _setNewL2BlockData(_l2BlockNumber, _l2BlockTimestamp, _expectedPrevL2BlockHash);
366: 		        } else if (currentL2BlockNumber == _l2BlockNumber) {
367: 		            require(!_isFirstInBatch, "Can not reuse L2 block number from the previous batch");
368: 		            require(currentL2BlockTimestamp == _l2BlockTimestamp, "The timestamp of the same L2 block must be same");
369: 		            require(
370: 		                _expectedPrevL2BlockHash == _getLatest257L2blockHash(_l2BlockNumber - 1),
371: 		                "The previous hash of the same L2 block must be same"
372: 		            );
373: 		            require(_maxVirtualBlocksToCreate == 0, "Can not create virtual blocks in the middle of the miniblock");
374: 		        } else if (currentL2BlockNumber + 1 == _l2BlockNumber) {
375: 		            // From the checks in _upgradeL2Blocks it is known that currentL2BlockNumber can not be 0
376: 		            bytes32 prevL2BlockHash = _getLatest257L2blockHash(currentL2BlockNumber - 1);
377: 		
378: 		            bytes32 pendingL2BlockHash = _calculateL2BlockHash(
379: 		                currentL2BlockNumber,
380: 		                currentL2BlockTimestamp,
381: 		                prevL2BlockHash,
382: 		                currentL2BlockTxsRollingHash
383: 		            );
384: 		
385: 		            require(_expectedPrevL2BlockHash == pendingL2BlockHash, "The current L2 block hash is incorrect");
386: 		            require(
387: 		                _l2BlockTimestamp > currentL2BlockTimestamp,
388: 		                "The timestamp of the new L2 block must be greater than the timestamp of the previous L2 block"
389: 		            );
390: 		
391: 		            // Since the new block is created, we'll clear out the rolling hash
392: 		            _setNewL2BlockData(_l2BlockNumber, _l2BlockTimestamp, _expectedPrevL2BlockHash);
393: 		        } else {
394: 		            revert("Invalid new L2 block number");
395: 		        }
396: 		
397: 		        _setVirtualBlock(_l2BlockNumber, _maxVirtualBlocksToCreate, _l2BlockTimestamp);
398: 		    }

444: 		    function setNewBatch(
445: 		        bytes32 _prevBatchHash,
446: 		        uint128 _newTimestamp,
447: 		        uint128 _expectedNewNumber,
448: 		        uint256 _baseFee
449: 		    ) external onlyCallFromBootloader {
450: 		        (uint128 previousBatchNumber, uint128 previousBatchTimestamp) = getBatchNumberAndTimestamp();
451: 		        require(_newTimestamp > previousBatchTimestamp, "Timestamps should be incremental");
452: 		        require(previousBatchNumber + 1 == _expectedNewNumber, "The provided block number is not correct");
453: 		
454: 		        _ensureBatchConsistentWithL2Block(_newTimestamp);
455: 		
456: 		        batchHashes[previousBatchNumber] = _prevBatchHash;
457: 		
458: 		        // Setting new block number and timestamp
459: 		        BlockInfo memory newBlockInfo = BlockInfo({number: previousBatchNumber + 1, timestamp: _newTimestamp});
460: 		
461: 		        currentBatchInfo = newBlockInfo;
462: 		
463: 		        baseFee = _baseFee;
464: 		
465: 		        // The correctness of this block hash:
466: 		        SystemContractHelper.toL1(false, bytes32(uint256(SystemLogKey.PREV_BATCH_HASH_KEY)), _prevBatchHash);
467: 		    }
```
[[84-86](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L84-L86), [99-101](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L99-L101), [105-107](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L105-L107), [112-115](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L112-L115), [212-214](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L212-L214), [263-308](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L263-L308), [314-323](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L314-L323), [341-398](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L341-L398), [444-467](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L444-L467)]



```solidity
File: code/system-contracts/contracts/libraries/SystemContractHelper.sol

168: 		    function setValueForNextFarCall(uint128 _value) internal returns (bool success) {
169: 		        uint256 cleanupMask = UINT128_MASK;
170: 		        address callAddr = SET_CONTEXT_VALUE_CALL_ADDRESS;
171: 		        assembly {
172: 		            // Clearing input params as they are not cleaned by Solidity by default
173: 		            _value := and(_value, cleanupMask)
174: 		            success := call(0, callAddr, _value, 0, 0xFFFF, 0, 0)
175: 		        }
176: 		    }
```
[[168-176](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L168-L176)]



```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

108: 		    function setSharedBridge(address _sharedBridge) external onlyOwner {
109: 		        sharedBridge = IL1SharedBridge(_sharedBridge);
110: 		    }
```
[[108-110](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L108-L110)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

132: 		    function setValidatorTimelock(address _validatorTimelock) external onlyOwnerOrAdmin {
133: 		        validatorTimelock = _validatorTimelock;
134: 		    }

137: 		    function setInitialCutHash(Diamond.DiamondCutData calldata _diamondCut) external onlyOwner {
138: 		        initialCutHash = keccak256(abi.encode(_diamondCut));
139: 		    }

142: 		    function setNewVersionUpgrade(
143: 		        Diamond.DiamondCutData calldata _cutData,
144: 		        uint256 _oldProtocolVersion,
145: 		        uint256 _newProtocolVersion
146: 		    ) external onlyOwner {
147: 		        upgradeCutHash[_oldProtocolVersion] = keccak256(abi.encode(_cutData));
148: 		        protocolVersion = _newProtocolVersion;
149: 		    }

152: 		    function setUpgradeDiamondCut(
153: 		        Diamond.DiamondCutData calldata _cutData,
154: 		        uint256 _oldProtocolVersion
155: 		    ) external onlyOwner {
156: 		        upgradeCutHash[_oldProtocolVersion] = keccak256(abi.encode(_cutData));
157: 		    }
```
[[132-134](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L132-L134), [137-139](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L137-L139), [142-149](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L142-L149), [152-157](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L152-L157)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

73: 		    function setStateTransitionManager(IStateTransitionManager _stateTransitionManager) external onlyOwner {
74: 		        stateTransitionManager = _stateTransitionManager;
75: 		    }
```
[[73-75](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L73-L75)]



```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol

180: 		    function _setL2SystemContractUpgrade(
181: 		        L2CanonicalTransaction calldata _l2ProtocolUpgradeTx,
182: 		        bytes[] calldata _factoryDeps,
183: 		        uint256 _newProtocolVersion
184: 		    ) internal returns (bytes32) {
185: 		        // If the type is 0, it is considered as noop and so will not be required to be executed.
186: 		        if (_l2ProtocolUpgradeTx.txType == 0) {
187: 		            return bytes32(0);
188: 		        }
189: 		
190: 		        require(_l2ProtocolUpgradeTx.txType == SYSTEM_UPGRADE_L2_TX_TYPE, "L2 system upgrade tx type is wrong");
191: 		
192: 		        bytes memory encodedTransaction = abi.encode(_l2ProtocolUpgradeTx);
193: 		
194: 		        TransactionValidator.validateL1ToL2Transaction(
195: 		            _l2ProtocolUpgradeTx,
196: 		            encodedTransaction,
197: 		            s.priorityTxMaxGasLimit,
198: 		            s.feeParams.priorityTxMaxPubdata
199: 		        );
200: 		
201: 		        TransactionValidator.validateUpgradeTransaction(_l2ProtocolUpgradeTx);
202: 		
203: 		        // We want the hashes of l2 system upgrade transactions to be unique.
204: 		        // This is why we require that the `nonce` field is unique to each upgrade.
205: 		        require(
206: 		            _l2ProtocolUpgradeTx.nonce == _newProtocolVersion,
207: 		            "The new protocol version should be included in the L2 system upgrade tx"
208: 		        );
209: 		
210: 		        _verifyFactoryDeps(_factoryDeps, _l2ProtocolUpgradeTx.factoryDeps);
211: 		
212: 		        bytes32 l2ProtocolUpgradeTxHash = keccak256(encodedTransaction);
213: 		
214: 		        s.l2SystemContractsUpgradeTxHash = l2ProtocolUpgradeTxHash;
215: 		
216: 		        return l2ProtocolUpgradeTxHash;
217: 		    }
```
[[180-217](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L180-L217)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/LibMap.sol

38: 		    function set(Uint32Map storage _map, uint256 _index, uint32 _value) internal {
39: 		        unchecked {
40: 		            // Each storage slot can store 256 bits of data.
41: 		            // As uint32 is 32 bits long, 8 uint32s can be packed into one storage slot.
42: 		            // Hence, `_index / 8` is done to find the storage slot that contains the required uint32.
43: 		            uint256 mapIndex = _index / 8;
44: 		            uint256 mapValue = _map.map[mapIndex];
45: 		
46: 		            // First three bits of the original `_index` denotes the position of the uint32 in that slot.
47: 		            // So, '(_index & 7) * 32' is done to find the bit position of the uint32 in that storage slot.
48: 		            uint256 bitOffset = (_index & 7) * 32;
49: 		
50: 		            // XORing a value A with B, and then with A again, gives the original value B.
51: 		            // We will use this property to update the uint32 value in the slot.
52: 		
53: 		            // Shift the bits to the right and retrieve the uint32 value.
54: 		            uint32 oldValue = uint32(mapValue >> bitOffset);
55: 		
56: 		            // Calculate the XOR of the new value and the existing value.
57: 		            uint256 newValueXorOldValue = uint256(oldValue ^ _value);
58: 		
59: 		            // Finally, we XOR the slot with the XOR of the new value and the existing value,
60: 		            // shifted to its proper position. The XOR operation will effectively replace the old value with the new value.
61: 		            _map.map[mapIndex] = (newValueXorOldValue << bitOffset) ^ mapValue;
62: 		        }
63: 		    }
```
[[38-63](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/LibMap.sol#L38-L63)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

597: 		    function _setBit(uint256 _bitMap, uint8 _index) internal pure returns (uint256) {
598: 		        return _bitMap | (1 << _index);
599: 		    }
```
[[597-599](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L597-L599)]

</details>

---

### [N-04] Missing events in initializers

As a best practice, consider emitting an event when the contract is initialized. In this way, it's easy for the user to track the exact point in time when the contract was initialized, by filtering the emitted events.

*There are 9 instances of this issue.*

<details>
<summary>Expand findings</summary>


```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

60: 		    function initialize() external reentrancyGuardInitializer {}
```
[[60](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L60)]



```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

104: 		    function initialize(

142: 		    function initializeChainGovernance(uint256 _chainId, address _l2BridgeAddress) external onlyOwner {
```
[[104](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L104), [142](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L142)]



```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

41: 		    function initialize(address _owner) external reentrancyGuardInitializer {
```
[[41](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L41)]



```solidity
File: code/contracts/ethereum/contracts/common/ReentrancyGuard.sol

46: 		    function _initializeReentrancyGuard() private {
```
[[46](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/ReentrancyGuard.sol#L46)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

79: 		    function initialize(
```
[[79](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L79)]



```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

49: 		    function initialize(
```
[[49](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L49)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol

24: 		    function initialize(InitializeData calldata _initializeData) external reentrancyGuardInitializer returns (bytes32) {
```
[[24](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol#L24)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol

278: 		    function _initializeDiamondCut(address _init, bytes memory _calldata) private {
```
[[278](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L278)]

</details>

---

### [N-05] Consider emitting an event at the end of the constructor

This will allow users to easily exactly pinpoint when and by whom a contract was constructed.

*There are 9 instances of this issue.*

<details>
<summary>Expand findings</summary>


```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

55: 		    constructor(IL1SharedBridge _sharedBridge) reentrancyGuardInitializer {
```
[[55](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L55)]



```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

90: 		    constructor(
```
[[90](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L90)]



```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

38: 		    constructor() reentrancyGuardInitializer {}
```
[[38](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L38)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

58: 		    constructor(address _bridgehub) reentrancyGuardInitializer {
```
[[58](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L58)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

55: 		    constructor(address _initialOwner, uint32 _executionDelay) {
```
[[55](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L55)]



```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

41: 		    constructor() {
```
[[41](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L41)]



```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

40: 		    constructor() {
```
[[40](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L40)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol

19: 		    constructor() reentrancyGuardInitializer {}
```
[[19](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol#L19)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol

11: 		    constructor(uint256 _chainId, Diamond.DiamondCutData memory _diamondCut) {
```
[[11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol#L11)]

</details>

---

### [N-06] Setters should prevent re-setting the same value

Not only is wasteful in terms of gas, but this is especially problematic when an event is emitted and the old and new values set are the same, as listeners might not expect this kind of scenario.

*There are 21 instances of this issue.*

<details>
<summary>Expand findings</summary>


```solidity
File: code/system-contracts/contracts/ImmutableSimulator.sol

// @audit immutableDataStorage
34: 		    function setImmutables(address _dest, ImmutableData[] calldata _immutables) external override {
```
[[34](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ImmutableSimulator.sol#L34)]



```solidity
File: code/system-contracts/contracts/NonceHolder.sol

// @audit nonceValues
82: 		    function setValueUnderNonce(uint256 _key, uint256 _value) public onlySystemCall {
```
[[82](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/NonceHolder.sol#L82)]



```solidity
File: code/system-contracts/contracts/SystemContext.sol

// @audit chainId
84: 		    function setChainId(uint256 _newChainId) external onlyCallFromForceDeployer {

// @audit origin
99: 		    function setTxOrigin(address _newOrigin) external onlyCallFromBootloader {

// @audit gasPrice
105: 		    function setGasPrice(uint256 _gasPrice) external onlyCallFromBootloader {

// @audit basePubdataSpent, gasPerPubdataByte
112: 		    function setPubdataInfo(uint256 _gasPerPubdataByte, uint256 _basePubdataSpent) external onlyCallFromBootloader {

// @audit l2BlockHash
212: 		    function _setL2BlockHash(uint256 _block, bytes32 _hash) internal {

// @audit currentVirtualL2BlockInfo, currentVirtualL2BlockInfo
263: 		    function _setVirtualBlock(

// @audit currentL2BlockInfo, currentL2BlockTxsRollingHash
314: 		    function _setNewL2BlockData(uint128 _l2BlockNumber, uint128 _l2BlockTimestamp, bytes32 _prevL2BlockHash) internal {

// @audit batchHashes, currentBatchInfo, baseFee
444: 		    function setNewBatch(
```
[[84](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L84), [99](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L99), [105](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L105), [112](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L112), [212](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L212), [263](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L263), [314](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L314), [444](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L444)]



```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

// @audit pendingAdmin
51: 		    function setPendingAdmin(address _newPendingAdmin) external onlyOwnerOrAdmin {

// @audit sharedBridge
108: 		    function setSharedBridge(address _sharedBridge) external onlyOwner {
```
[[51](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L51), [108](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L108)]



```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

// @audit minDelay
249: 		    function updateDelay(uint256 _newDelay) external onlySelf {

// @audit securityCouncil
256: 		    function updateSecurityCouncil(address _newSecurityCouncil) external onlySelf {
```
[[249](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L249), [256](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L256)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

// @audit pendingAdmin
110: 		    function setPendingAdmin(address _newPendingAdmin) external onlyOwnerOrAdmin {

// @audit validatorTimelock
132: 		    function setValidatorTimelock(address _validatorTimelock) external onlyOwnerOrAdmin {

// @audit initialCutHash
137: 		    function setInitialCutHash(Diamond.DiamondCutData calldata _diamondCut) external onlyOwner {

// @audit upgradeCutHash, protocolVersion
142: 		    function setNewVersionUpgrade(

// @audit upgradeCutHash
152: 		    function setUpgradeDiamondCut(
```
[[110](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L110), [132](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L132), [137](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L137), [142](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L142), [152](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L152)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

// @audit stateTransitionManager
73: 		    function setStateTransitionManager(IStateTransitionManager _stateTransitionManager) external onlyOwner {

// @audit executionDelay
96: 		    function setExecutionDelay(uint32 _executionDelay) external onlyOwner {
```
[[73](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L73), [96](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L96)]

</details>

---

### [N-07] Using zero as a parameter

Taking zero as a valid argument without checks can lead to severe security issues in some cases.

If using a zero argument is mandatory, consider using descriptive constants or an enum instead of passing zero directly on function calls, as that might be error-prone, to fully describe the caller's intention.

*There are 81 instances of this issue.*

<details>
<summary>Expand findings</summary>


```solidity
File: code/system-contracts/contracts/BootloaderUtilities.sol

176: 		        bytes memory encodedAccessListLength = RLPEncoder.encodeListLen(0);

271: 		        bytes memory encodedAccessListLength = RLPEncoder.encodeListLen(0);
```
[[176](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L176), [271](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L271)]



```solidity
File: code/system-contracts/contracts/Compressor.sol

121: 		        uint256 numberOfInitialWrites = uint256(_compressedStateDiffs.readUint16(0));

202: 		            uint256 dictionaryLen = uint256(_rawCompressedData.readUint16(0));
```
[[121](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L121), [202](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L202)]



```solidity
File: code/system-contracts/contracts/DefaultAccount.sol

83: 		        SystemContractsCaller.systemCallWithPropagatedRevert(
84: 		            uint32(gasleft()),
85: 		            address(NONCE_HOLDER_SYSTEM_CONTRACT),
86: 		            0,
87: 		            abi.encodeCall(INonceHolder.incrementMinNonceIfEquals, (_transaction.nonce))
88: 		        );

94: 		        bytes32 txHash = _suggestedSignedHash != bytes32(0) ? _suggestedSignedHash : _transaction.encodeHash();
```
[[83-88](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L83-L88), [94](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L94)]



```solidity
File: code/system-contracts/contracts/KnownCodesStorage.sol

76: 		        require(version == 1 && _bytecodeHash[1] == bytes1(0), "Incorrectly formatted bytecodeHash");
```
[[76](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/KnownCodesStorage.sol#L76)]



```solidity
File: code/system-contracts/contracts/L1Messenger.sol

75: 		        L2ToL1Log memory l2ToL1Log = L2ToL1Log({
76: 		            l2ShardId: 0,
77: 		            isService: _isService,
78: 		            txNumberInBlock: SYSTEM_CONTEXT_CONTRACT.txNumberInBlock(),
79: 		            sender: msg.sender,
80: 		            key: _key,
81: 		            value: _value
82: 		        });

90: 		        SystemContractHelper.burnGas(Utils.safeCastToU32(gasToPay), 0);

125: 		        L2ToL1Log memory l2ToL1Log = L2ToL1Log({
126: 		            l2ShardId: 0,
127: 		            isService: true,
128: 		            txNumberInBlock: SYSTEM_CONTEXT_CONTRACT.txNumberInBlock(),
129: 		            sender: address(this),
130: 		            key: bytes32(uint256(uint160(msg.sender))),
131: 		            value: hash
132: 		        });

329: 		        chainedLogsHash = bytes32(0);

331: 		        chainedMessagesHash = bytes32(0);

332: 		        chainedL1BytecodesRevealDataHash = bytes32(0);
```
[[75-82](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L75-L82), [90](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L90), [125-132](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L125-L132), [329](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L329), [331](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L331), [332](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L332)]



```solidity
File: code/system-contracts/contracts/MsgValueSimulator.sol

26: 		        value = SystemContractHelper.getExtraAbiData(0);
```
[[26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/MsgValueSimulator.sol#L26)]



```solidity
File: code/system-contracts/contracts/SystemContext.sol

145: 		            hash = bytes32(0);

322: 		        currentL2BlockTxsRollingHash = bytes32(0);
```
[[145](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L145), [322](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L322)]



```solidity
File: code/contracts/zksync/contracts/SystemContractsCaller.sol

46: 		        uint256 farCallAbi = getFarCallABI(
47: 		            0,
48: 		            0,
49: 		            dataStart,
50: 		            dataLength,
51: 		            gasLimit,
52: 		            // Only rollup is supported for now
53: 		            0,
54: 		            CalldataForwardingMode.UseHeap,
55: 		            false,
56: 		            true
57: 		        );
```
[[46-57](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/SystemContractsCaller.sol#L46-L57)]



```solidity
File: code/system-contracts/contracts/libraries/EfficientCall.sol

265: 		        uint256 farCallAbi = SystemContractsCaller.getFarCallABIWithEmptyFatPointer(
266: 		            gas,
267: 		            // Only rollup is supported for now
268: 		            0,
269: 		            CalldataForwardingMode.ForwardFatPointer,
270: 		            _isConstructor,
271: 		            _isSystem
272: 		        );
```
[[265-272](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L265-L272)]



```solidity
File: code/system-contracts/contracts/libraries/SystemContractHelper.sol

345: 		        bool precompileCallSuccess = unsafePrecompileCall(
346: 		            0, // The precompile parameters are formal ones. We only need the precompile call to burn gas.
347: 		            _gasToPay,
348: 		            _pubdataToSpend
349: 		        );
```
[[345-349](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L345-L349)]



```solidity
File: code/system-contracts/contracts/libraries/SystemContractsCaller.sol

85: 		        uint256 farCallAbi = SystemContractsCaller.getFarCallABI(
86: 		            0,
87: 		            0,
88: 		            dataStart,
89: 		            dataLength,
90: 		            gasLimit,
91: 		            // Only rollup is supported for now
92: 		            0,
93: 		            CalldataForwardingMode.UseHeap,
94: 		            false,
95: 		            true
96: 		        );
```
[[85-96](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L85-L96)]



```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

261: 		        bytes memory encodedAccessListLength = RLPEncoder.encodeListLen(0);

333: 		        bytes memory encodedAccessListLength = RLPEncoder.encodeListLen(0);

382: 		                IERC20(token).safeApprove(paymaster, 0);
```
[[261](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L261), [333](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L333), [382](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L382)]



```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

223: 		                factoryDeps: new bytes[](0),

503: 		        (uint32 functionSignature, uint256 offset) = UnsafeBytes.readUint32(_l2ToL1message, 0);

584: 		            L2TransactionRequestDirect memory request = L2TransactionRequestDirect({
585: 		                chainId: ERA_CHAIN_ID,
586: 		                l2Contract: l2BridgeAddress[ERA_CHAIN_ID],
587: 		                mintValue: msg.value, // l2 gas + l2 msg.Value the bridgehub will withdraw the mintValue from the base token bridge for gas
588: 		                l2Value: 0, // L2 msg.value, this contract doesn't support base token deposits or wrapping functionality, for direct deposits use bridgehub
589: 		                l2Calldata: l2TxCalldata,
590: 		                l2GasLimit: _l2TxGasLimit,
591: 		                l2GasPerPubdataByteLimit: _l2TxGasPerPubdataByte,
592: 		                factoryDeps: new bytes[](0),
593: 		                refundRecipient: refundRecipient
594: 		            });

592: 		                factoryDeps: new bytes[](0),
```
[[223](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L223), [503](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L503), [584-594](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L584-L594), [592](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L592)]



```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

50: 		        emit ChangeMinDelay(0, _minDelay);

240: 		        require(_predecessorId == bytes32(0) || isOperationDone(_predecessorId), "Predecessor operation not completed");
```
[[50](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L50), [240](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L240)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

90: 		        IExecutor.StoredBatchInfo memory batchZero = IExecutor.StoredBatchInfo(
91: 		            0,
92: 		            _initializeData.genesisBatchHash,
93: 		            _initializeData.genesisIndexRepeatedStorageChanges,
94: 		            0,
95: 		            EMPTY_STRING_KECCAK,
96: 		            DEFAULT_L2_LOGS_TREE_ROOT_HASH,
97: 		            0,
98: 		            _initializeData.genesisBatchCommitment
99: 		        );

182: 		        L2CanonicalTransaction memory l2ProtocolUpgradeTx = L2CanonicalTransaction({
183: 		            txType: SYSTEM_UPGRADE_L2_TX_TYPE,
184: 		            from: uint256(uint160(L2_FORCE_DEPLOYER_ADDR)),
185: 		            to: uint256(uint160(L2_SYSTEM_CONTEXT_SYSTEM_CONTRACT_ADDR)),
186: 		            gasLimit: $(PRIORITY_TX_MAX_GAS_LIMIT),
187: 		            gasPerPubdataByteLimit: REQUIRED_L2_GAS_PRICE_PER_PUBDATA,
188: 		            maxFeePerGas: uint256(0),
189: 		            maxPriorityFeePerGas: uint256(0),
190: 		            paymaster: uint256(0),
191: 		            // Note, that the priority operation id is used as "nonce" for L1->L2 transactions
192: 		            nonce: protocolVersion,
193: 		            value: 0,
194: 		            reserved: [uint256(0), 0, 0, 0],
195: 		            data: systemContextCalldata,
196: 		            signature: new bytes(0),
197: 		            factoryDeps: uintEmptyArray,
198: 		            paymasterInput: new bytes(0),
199: 		            reservedDynamic: new bytes(0)
200: 		        });

188: 		            maxFeePerGas: uint256(0),

189: 		            maxPriorityFeePerGas: uint256(0),

190: 		            paymaster: uint256(0),

194: 		            reserved: [uint256(0), 0, 0, 0],

196: 		            signature: new bytes(0),

198: 		            paymasterInput: new bytes(0),

199: 		            reservedDynamic: new bytes(0)

202: 		        ProposedUpgrade memory proposedUpgrade = ProposedUpgrade({
203: 		            l2ProtocolUpgradeTx: l2ProtocolUpgradeTx,
204: 		            factoryDeps: bytesEmptyArray,
205: 		            bootloaderHash: bytes32(0),
206: 		            defaultAccountHash: bytes32(0),
207: 		            verifier: address(0),
208: 		            verifierParams: VerifierParams({
209: 		                recursionNodeLevelVkHash: bytes32(0),
210: 		                recursionLeafLevelVkHash: bytes32(0),
211: 		                recursionCircuitsSetVksHash: bytes32(0)
212: 		            }),
213: 		            l1ContractsUpgradeCalldata: new bytes(0),
214: 		            postUpgradeCalldata: new bytes(0),
215: 		            upgradeTimestamp: 0,
216: 		            newProtocolVersion: protocolVersion
217: 		        });

205: 		            bootloaderHash: bytes32(0),

206: 		            defaultAccountHash: bytes32(0),

209: 		                recursionNodeLevelVkHash: bytes32(0),

210: 		                recursionLeafLevelVkHash: bytes32(0),

211: 		                recursionCircuitsSetVksHash: bytes32(0)

213: 		            l1ContractsUpgradeCalldata: new bytes(0),

214: 		            postUpgradeCalldata: new bytes(0),

277: 		        DiamondProxy stateTransitionContract = new DiamondProxy{salt: bytes32(0)}(block.chainid, diamondCut);
```
[[90-99](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L90-L99), [182-200](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L182-L200), [188](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L188), [189](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L189), [190](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L190), [194](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L194), [196](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L196), [198](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L198), [199](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L199), [202-217](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L202-L217), [205](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L205), [206](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L206), [209](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L209), [210](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L210), [211](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L211), [213](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L213), [214](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L214), [277](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L277)]



```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol

93: 		        if (_l2DefaultAccountBytecodeHash == bytes32(0)) {

110: 		        if (_l2BootloaderBytecodeHash == bytes32(0)) {

148: 		            _newVerifierParams.recursionNodeLevelVkHash == bytes32(0) &&

149: 		            _newVerifierParams.recursionLeafLevelVkHash == bytes32(0) &&

150: 		            _newVerifierParams.recursionCircuitsSetVksHash == bytes32(0)

187: 		            return bytes32(0);

249: 		        require(s.l2SystemContractsUpgradeTxHash == bytes32(0), "Previous upgrade has not been finalized");
```
[[93](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L93), [110](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L110), [148](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L148), [149](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L149), [150](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L150), [187](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L187), [249](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L249)]



```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol

33: 		        require(s.l2SystemContractsUpgradeTxHash == bytes32(0), "Previous upgrade has not been finalized");
```
[[33](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L33)]



```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

56: 		        require(_l2TokenProxyBytecodeHash != bytes32(0), "df");

58: 		        require(_l2TokenProxyBytecodeHash != bytes32(0), "df");

64: 		            address l2StandardToken = address(new L2StandardERC20{salt: bytes32(0)}());

65: 		            l2TokenBeacon = new UpgradeableBeacon{salt: bytes32(0)}(l2StandardToken);

165: 		        (bool success, bytes memory returndata) = SystemContractsCaller.systemCallWithReturndata(
166: 		            uint32(gasleft()),
167: 		            DEPLOYER_SYSTEM_CONTRACT,
168: 		            0,
169: 		            abi.encodeCall(
170: 		                IContractDeployer.create2,
171: 		                (salt, l2TokenProxyBytecodeHash, abi.encode(address(l2TokenBeacon), ""))
172: 		            )
173: 		        );
```
[[56](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L56), [58](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L58), [64](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L64), [65](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L65), [165-173](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L165-L173)]



```solidity
File: code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol

41: 		        require(version == 1 && _bytecodeHash[1] == bytes1(0), "zf"); // Incorrectly formatted bytecodeHash
```
[[41](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L41)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

191: 		        if (_expectedSystemContractUpgradeTxHash == bytes32(0)) {

237: 		        if (systemContractsUpgradeTxHash == bytes32(0) || s.l2SystemContractsUpgradeBatchNumber != 0) {

258: 		            _lastCommittedBatchData = _commitOneBatch(_lastCommittedBatchData, _newBatchesData[i], bytes32(0));

291: 		            bytes32 expectedUpgradeTxHash = i == 0 ? _systemContractUpgradeTxHash : bytes32(0);

520: 		                uint64(0), // index repeated storage changes in zkPorter

521: 		                bytes32(0) // zkPorter batch hash

639: 		            require(blobVersionedHash != bytes32(0), "vh");

663: 		        require(versionedHash == bytes32(0), "lh");

669: 		                (_blobHashes[i] == bytes32(0) && blobCommitments[i] == bytes32(0)) ||

669: 		                (_blobHashes[i] == bytes32(0) && blobCommitments[i] == bytes32(0)) ||

670: 		                    (_blobHashes[i] != bytes32(0) && blobCommitments[i] != bytes32(0)),

670: 		                    (_blobHashes[i] != bytes32(0) && blobCommitments[i] != bytes32(0)),
```
[[191](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L191), [237](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L237), [258](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L258), [291](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L291), [520](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L520), [521](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L521), [639](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L639), [663](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L663), [669](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L669), [669](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L669), [670](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L670), [670](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L670)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

92: 		        L2Log memory l2Log = L2Log({
93: 		            l2ShardId: 0,
94: 		            isService: true,
95: 		            txNumberInBatch: _l2TxNumberInBatch,
96: 		            sender: L2_BOOTLOADER_ADDRESS,
97: 		            key: _l2TxHash,
98: 		            value: bytes32(uint256(_status))
99: 		        });

132: 		            L2Log({
133: 		                l2ShardId: 0,
134: 		                isService: true,
135: 		                txNumberInBatch: _message.txNumberInBatch,
136: 		                sender: L2_TO_L1_MESSENGER_SYSTEM_CONTRACT_ADDR,
137: 		                key: bytes32(uint256(uint160(_message.sender))),
138: 		                value: keccak256(_message.data)
139: 		            });

301: 		            maxPriorityFeePerGas: uint256(0),

302: 		            paymaster: uint256(0),

308: 		            signature: new bytes(0),

310: 		            paymasterInput: new bytes(0),

311: 		            reservedDynamic: new bytes(0)

338: 		                layer2Tip: uint192(0) // TODO: Restore after fee modeling will be stable. (SMA-1230)
```
[[92-99](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L92-L99), [132-139](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L132-L139), [301](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L301), [302](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L302), [308](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L308), [310](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L310), [311](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L311), [338](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L338)]

</details>

---

### [N-08] Usage of `int/uint` is discouraged

It is recommended to always use `uint256/int256` instead of `uint/int` in function parameters, since they are used for function signatures.

*There is 1 instance of this issue.*


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

580: 		        for (uint i = 0; i < MAX_NUMBER_OF_BLOBS; i++) {
```
[[580](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L580)]


---

### [N-09] Named imports of parent contracts are missing

Parent contracts should use [named imports](https://docs.soliditylang.org/en/latest/layout-of-source-files.html#syntax-and-semantics) to improve the code readability.

*There are 4 instances of this issue.*


```solidity
File: code/system-contracts/contracts/AccountCodeStorage.sol

// @audit IAccountCodeStorage
22: 		contract AccountCodeStorage is IAccountCodeStorage {
```
[[22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L22)]



```solidity
File: code/system-contracts/contracts/DefaultAccount.sol

// @audit IAccount
19: 		contract DefaultAccount is IAccount {
```
[[19](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L19)]



```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

// @audit IBridgehub, ReentrancyGuard
16: 		contract Bridgehub is IBridgehub, ReentrancyGuard, Ownable2Step {
```
[[16](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L16)]



```solidity
File: code/contracts/ethereum/contracts/upgrades/GenesisUpgrade.sol

// @audit BaseZkSyncUpgradeGenesis
11: 		contract GenesisUpgrade is BaseZkSyncUpgradeGenesis {
```
[[11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/GenesisUpgrade.sol#L11)]


---

### [N-10] Unused struct definition

These `struct` are never used by any other source file, consider removing them.

*There is 1 instance of this issue.*


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol

51: 		struct InitializeDataNewChain {
52: 		    IVerifier verifier;
53: 		    VerifierParams verifierParams;
54: 		    bytes32 l2BootloaderBytecodeHash;
55: 		    bytes32 l2DefaultAccountBytecodeHash;
56: 		    uint256 priorityTxMaxGasLimit;
57: 		    FeeParams feeParams;
58: 		    address blobVersionedHashRetriever;
59: 		}
```
[[51-59](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol#L51-L59)]


---

### [N-11] Unused `enum` definition

These `enum` are never used by any other source file, consider removing them.

*There is 1 instance of this issue.*


```solidity
File: code/system-contracts/contracts/libraries/SystemContractHelper.sol

24: 		enum Global {
25: 		    CalldataPtr,
26: 		    CallFlags,
27: 		    ExtraABIData1,
28: 		    ExtraABIData2,
29: 		    ReturndataPtr
30: 		}
```
[[24-30](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L24-L30)]


---

### [N-12] Unused `event` definition

The following events are never used, consider to remove them.

*There are 3 instances of this issue.*


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol

134: 		    event EthWithdrawalFinalized(address indexed to, uint256 amount);
```
[[134](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L134)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol

17: 		    event ProposeTransparentUpgrade(
18: 		        Diamond.DiamondCutData diamondCut,
19: 		        uint256 indexed proposalId,
20: 		        bytes32 proposalSalt
21: 		    );
```
[[17-21](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol#L17-L21)]



```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol

22: 		    event BaseTokenReceived(uint256 amount);
```
[[22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol#L22)]


---

### [N-13] Unused arguments should be removed or implemented

Some arguments are never used: if this is intentional, consider removing these arguments from the function. Otherwise, implement the missing logic accordingly.

*There are 24 instances of this issue.*

<details>
<summary>Expand findings</summary>


```solidity
File: code/system-contracts/contracts/AccountCodeStorage.sol

// @audit _hash
68: 		    function _storeCodeHash(address _address, bytes32 _hash) internal {
```
[[68](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L68)]



```solidity
File: code/contracts/zksync/contracts/SystemContractsCaller.sol

// @audit to
37: 		    function systemCall(uint32 gasLimit, address to, uint256 value, bytes memory data) internal returns (bool success) {
```
[[37](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/SystemContractsCaller.sol#L37)]



```solidity
File: code/system-contracts/contracts/libraries/EfficientCall.sol

// @audit _address
124: 		    function rawCall(
125: 		        uint256 _gas,
126: 		        address _address,
127: 		        uint256 _value,
128: 		        bytes calldata _data,
129: 		        bool _isSystem

// @audit _address
159: 		    function rawStaticCall(uint256 _gas, address _address, bytes calldata _data) internal view returns (bool success) {

// @audit _address
173: 		    function rawDelegateCall(uint256 _gas, address _address, bytes calldata _data) internal returns (bool success) {

// @audit _address
191: 		    function rawMimicCall(
192: 		        uint256 _gas,
193: 		        address _address,
194: 		        bytes calldata _data,
195: 		        address _whoToMimic,
196: 		        bool _isConstructor,
197: 		        bool _isSystem
```
[[124-129](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L124-L129), [159](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L159), [173](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L173), [191-197](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L191-L197)]



```solidity
File: code/system-contracts/contracts/libraries/SystemContractHelper.sol

// @audit _key, _value
48: 		    function toL1(bool _isService, bytes32 _key, bytes32 _value) internal {

// @audit _farCallAbi
85: 		    function ptrPackIntoActivePtr(uint256 _farCallAbi) internal view {

// @audit _rawParams
148: 		    function unsafePrecompileCall(
149: 		        uint256 _rawParams,
150: 		        uint32 _gasToBurn,
151: 		        uint32 _pubdataToSpend

// @audit initializer, value1
181: 		    function eventInitialize(uint256 initializer, uint256 value1) internal {

// @audit value1, value2
191: 		    function eventWrite(uint256 value1, uint256 value2) internal {
```
[[48](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L48), [85](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L85), [148-151](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L148-L151), [181](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L181), [191](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L191)]



```solidity
File: code/system-contracts/contracts/libraries/SystemContractsCaller.sol

// @audit to
76: 		    function systemCall(uint32 gasLimit, address to, uint256 value, bytes memory data) internal returns (bool success) {
```
[[76](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L76)]



```solidity
File: code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol

// @audit _start
19: 		    function readUint16(bytes calldata _bytes, uint256 _start) internal pure returns (uint16 result) {

// @audit _start
26: 		    function readUint32(bytes calldata _bytes, uint256 _start) internal pure returns (uint32 result) {

// @audit _start
33: 		    function readUint64(bytes calldata _bytes, uint256 _start) internal pure returns (uint64 result) {

// @audit _start
40: 		    function readBytes32(bytes calldata _bytes, uint256 _start) internal pure returns (bytes32 result) {

// @audit _start
46: 		    function readUint256(bytes calldata _bytes, uint256 _start) internal pure returns (uint256 result) {
```
[[19](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol#L19), [26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol#L26), [33](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol#L33), [40](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol#L40), [46](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol#L46)]



```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol

// @audit _customCallDataForUpgrade
263: 		    function _upgradeL1Contract(bytes calldata _customCallDataForUpgrade) internal virtual {}

// @audit _customCallDataForUpgrade
269: 		    function _postUpgrade(bytes calldata _customCallDataForUpgrade) internal virtual {}
```
[[263](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L263), [269](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L269)]



```solidity
File: code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol

// @audit _bytes, _start
19: 		    function readUint32(bytes memory _bytes, uint256 _start) internal pure returns (uint32 result, uint256 offset) {

// @audit _bytes, _start
26: 		    function readAddress(bytes memory _bytes, uint256 _start) internal pure returns (address result, uint256 offset) {

// @audit _bytes, _start
33: 		    function readUint256(bytes memory _bytes, uint256 _start) internal pure returns (uint256 result, uint256 offset) {

// @audit _bytes, _start
40: 		    function readBytes32(bytes memory _bytes, uint256 _start) internal pure returns (bytes32 result, uint256 offset) {
```
[[19](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol#L19), [26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol#L26), [33](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol#L33), [40](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol#L40)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol

// @audit _lhs, _rhs
40: 		    function _efficientHash(bytes32 _lhs, bytes32 _rhs) private pure returns (bytes32 result) {
```
[[40](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol#L40)]

</details>

---

### [N-14] Unused arguments in overrided functions should be commented

Consider removing the name of these unused arguments to avoid compiler warnings.

*There are 2 instances of this issue.*


```solidity
File: code/system-contracts/contracts/DefaultAccount.sol

// @audit _transaction
125: 		    function executeTransactionFromOutside(Transaction calldata _transaction) external payable override {
```
[[125](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L125)]



```solidity
File: code/system-contracts/contracts/KnownCodesStorage.sol

// @audit _hash
65: 		    function getMarker(bytes32 _hash) public view override returns (uint256 marker) {
```
[[65](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/KnownCodesStorage.sol#L65)]


---

### [N-15] Unused state variables

Consider removing any unusued state variable to improve the readability of the codebase.

*There are 13 instances of this issue.*

<details>
<summary>Expand findings</summary>


```solidity
File: code/system-contracts/contracts/SystemContext.sol

37: 		    uint256 public blockGasLimit = type(uint32).max;

41: 		    address public coinbase = BOOTLOADER_FORMAL_ADDRESS;

44: 		    uint256 public difficulty = 2.5e15;
```
[[37](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L37), [41](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L41), [44](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L44)]



```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

45: 		    mapping(address => uint256) private __DEPRECATED_lastWithdrawalLimitReset;

48: 		    mapping(address => uint256) private __DEPRECATED_withdrawnAmountInWindow;

51: 		    mapping(address => mapping(address => uint256)) private __DEPRECATED_totalDepositedAmountPerUser;
```
[[45](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L45), [48](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L48), [51](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L51)]



```solidity
File: code/contracts/ethereum/contracts/common/ReentrancyGuard.sol

29: 		    uint256 private constant LOCK_FLAG_ADDRESS = 0x8e94fed44239eb2314ab7a406345e6c5a8f0ccedf3b600de3d004e672c33abf4;

39: 		    uint256 private constant _ENTERED = 2;
```
[[29](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/ReentrancyGuard.sol#L29), [39](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/ReentrancyGuard.sol#L39)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

26: 		    string public constant override getName = "ValidatorTimelock";
```
[[26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L26)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol

20: 		    string public constant override getName = "AdminFacet";
```
[[20](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L20)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

27: 		    string public constant override getName = "ExecutorFacet";
```
[[27](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L27)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol

25: 		    string public constant override getName = "GettersFacet";
```
[[25](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L25)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

35: 		    string public constant override getName = "MailboxFacet";
```
[[35](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L35)]

</details>

---

### [N-16] OpenZeppelin libraries should be upgraded to a newer version

These contracts import some OpenZeppelin libraries, but they are using an old version.

*There are 22 instances of this issue.*

<details>
<summary>Expand findings</summary>


```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

5: 		import "../openzeppelin/token/ERC20/IERC20.sol";

6: 		import "../openzeppelin/token/ERC20/utils/SafeERC20.sol";
```
[[5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L5), [6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L6)]



```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

5: 		import {IERC20} from "@openzeppelin/contracts/token/ERC20/IERC20.sol";

6: 		import {SafeERC20} from "@openzeppelin/contracts/token/ERC20/utils/SafeERC20.sol";
```
[[5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L5), [6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L6)]



```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

5: 		import {Initializable} from "@openzeppelin/contracts/proxy/utils/Initializable.sol";

6: 		import {Ownable2Step} from "@openzeppelin/contracts/access/Ownable2Step.sol";

8: 		import {IERC20Metadata} from "@openzeppelin/contracts/token/ERC20/extensions/IERC20Metadata.sol";

9: 		import {IERC20} from "@openzeppelin/contracts/token/ERC20/IERC20.sol";

10: 		import {SafeERC20} from "@openzeppelin/contracts/token/ERC20/utils/SafeERC20.sol";
```
[[5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L5), [6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L6), [8](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L8), [9](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L9), [10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L10)]



```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

5: 		import {Ownable2Step} from "@openzeppelin/contracts/access/Ownable2Step.sol";
```
[[5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L5)]



```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

5: 		import {Ownable2Step} from "@openzeppelin/contracts/access/Ownable2Step.sol";
```
[[5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L5)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

16: 		import {Ownable2Step} from "@openzeppelin/contracts/access/Ownable2Step.sol";
```
[[16](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L16)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

5: 		import {Ownable2Step} from "@openzeppelin/contracts/access/Ownable2Step.sol";
```
[[5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L5)]



```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

5: 		import {Initializable} from "@openzeppelin/contracts/proxy/utils/Initializable.sol";

6: 		import {BeaconProxy} from "@openzeppelin/contracts/proxy/beacon/BeaconProxy.sol";

7: 		import {UpgradeableBeacon} from "@openzeppelin/contracts/proxy/beacon/UpgradeableBeacon.sol";
```
[[5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L5), [6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L6), [7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L7)]



```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

5: 		import {ERC20PermitUpgradeable} from "@openzeppelin/contracts-upgradeable/token/ERC20/extensions/draft-ERC20PermitUpgradeable.sol";

6: 		import {UpgradeableBeacon} from "@openzeppelin/contracts/proxy/beacon/UpgradeableBeacon.sol";

7: 		import {ERC1967Upgrade} from "@openzeppelin/contracts/proxy/ERC1967/ERC1967Upgrade.sol";
```
[[5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L5), [6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L6), [7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L7)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol

5: 		import {SafeCast} from "@openzeppelin/contracts/utils/math/SafeCast.sol";
```
[[5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L5)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol

5: 		import {Math} from "@openzeppelin/contracts/utils/math/Math.sol";
```
[[5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L5)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

5: 		import {Math} from "@openzeppelin/contracts/utils/math/Math.sol";
```
[[5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L5)]

</details>

---

### [N-17] Same `constant` is redefined elsewhere

Keeping the same constants in different files may cause some problems, as the values could become out of sync when only one location is updated; reading constants from a single file is preferable. This should also be preferred for gas optimizations.

*There are 21 instances of this issue.*

<details>
<summary>Expand findings</summary>


```solidity
File: code/system-contracts/contracts/AccountCodeStorage.sol

// @audit seen in code/contracts/ethereum/contracts/common/Config.sol
23: 		    bytes32 constant EMPTY_STRING_KECCAK = 0xc5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470;
```
[[23](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L23)]



```solidity
File: code/contracts/zksync/contracts/L2ContractHelper.sol

// @audit seen in code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol
85: 		    bytes32 private constant CREATE2_PREFIX = keccak256("zksyncCreate2");
```
[[85](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/L2ContractHelper.sol#L85)]



```solidity
File: code/contracts/zksync/contracts/SystemContractsCaller.sol

// @audit seen in code/system-contracts/contracts/libraries/SystemContractsCaller.sol
7: 		address constant SYSTEM_CALL_CALL_ADDRESS = address((1 << 16) - 11);
```
[[7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/SystemContractsCaller.sol#L7)]



```solidity
File: code/system-contracts/contracts/interfaces/IL1Messenger.sol

// @audit seen in code/contracts/ethereum/contracts/common/Config.sol
25: 		uint256 constant L2_TO_L1_LOG_SERIALIZE_SIZE = 88;

// @audit seen in code/contracts/ethereum/contracts/common/Config.sol
30: 		bytes32 constant L2_L1_LOGS_TREE_DEFAULT_LEAF_HASH = 0x72abee45b59e344af8a6e520241c4744aff26ed411f4c4b00f8af09adada43ba;
```
[[25](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL1Messenger.sol#L25), [30](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL1Messenger.sol#L30)]



```solidity
File: code/system-contracts/contracts/interfaces/IPaymaster.sol

// @audit seen in code/contracts/zksync/contracts/interfaces/IPaymaster.sol
12: 		bytes4 constant PAYMASTER_VALIDATION_SUCCESS_MAGIC = IPaymaster.validateAndPayForPaymasterTransaction.selector;
```
[[12](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IPaymaster.sol#L12)]



```solidity
File: code/system-contracts/contracts/libraries/SystemContractsCaller.sol

// @audit seen in code/contracts/zksync/contracts/SystemContractsCaller.sol
22: 		address constant SYSTEM_CALL_CALL_ADDRESS = address((1 << 16) - 11);
```
[[22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L22)]



```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

// @audit seen in code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol
37: 		    IBridgehub public immutable override bridgehub;
```
[[37](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L37)]



```solidity
File: code/contracts/ethereum/contracts/common/Config.sol

// @audit seen in code/system-contracts/contracts/AccountCodeStorage.sol
6: 		bytes32 constant EMPTY_STRING_KECCAK = 0xc5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470;

// @audit seen in code/system-contracts/contracts/interfaces/IL1Messenger.sol
11: 		uint256 constant L2_TO_L1_LOG_SERIALIZE_SIZE = 88;

// @audit seen in code/system-contracts/contracts/interfaces/IL1Messenger.sol
19: 		bytes32 constant L2_L1_LOGS_TREE_DEFAULT_LEAF_HASH = 0x72abee45b59e344af8a6e520241c4744aff26ed411f4c4b00f8af09adada43ba;
```
[[6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/Config.sol#L6), [11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/Config.sol#L11), [19](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/Config.sol#L19)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

// @audit seen in code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol
27: 		    address public immutable bridgehub;
```
[[27](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L27)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

// @audit seen in code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol, code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol, code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol, code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol
26: 		    string public constant override getName = "ValidatorTimelock";
```
[[26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L26)]



```solidity
File: code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol

// @audit seen in code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol
22: 		    uint160 constant offset = uint160(0x1111000000000000000000000000000000001111);
```
[[22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol#L22)]



```solidity
File: code/contracts/zksync/contracts/interfaces/IPaymaster.sol

// @audit seen in code/system-contracts/contracts/interfaces/IPaymaster.sol
12: 		bytes4 constant PAYMASTER_VALIDATION_SUCCESS_MAGIC = IPaymaster.validateAndPayForPaymasterTransaction.selector;
```
[[12](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/interfaces/IPaymaster.sol#L12)]



```solidity
File: code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol

// @audit seen in code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol
22: 		    uint160 constant offset = uint160(0x1111000000000000000000000000000000001111);
```
[[22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol#L22)]



```solidity
File: code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol

// @audit seen in code/contracts/zksync/contracts/L2ContractHelper.sol
12: 		    bytes32 private constant CREATE2_PREFIX = keccak256("zksyncCreate2");
```
[[12](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L12)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol

// @audit seen in code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol, code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol, code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol, code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol
20: 		    string public constant override getName = "AdminFacet";
```
[[20](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L20)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

// @audit seen in code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol, code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol, code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol, code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol
27: 		    string public constant override getName = "ExecutorFacet";
```
[[27](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L27)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol

// @audit seen in code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol, code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol, code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol, code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol
25: 		    string public constant override getName = "GettersFacet";
```
[[25](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L25)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

// @audit seen in code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol, code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol, code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol, code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol
35: 		    string public constant override getName = "MailboxFacet";
```
[[35](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L35)]

</details>

---

### [N-18] Enum values should be used in place of constant array indexes

Consider using an enum instead of hardcoding an index access to make the code easier to understand.

*There are 41 instances of this issue.*

<details>
<summary>Expand findings</summary>


```solidity
File: code/system-contracts/contracts/BootloaderUtilities.sol

72: 		            } else if (_transaction.data[0] >= 0x80) {

91: 		            uint256 vInt = uint256(uint8(_transaction.signature[64]));

96: 		            if (_transaction.reserved[0] != 0) {

168: 		            } else if (_transaction.data[0] >= 0x80) {

190: 		            uint256 vInt = uint256(uint8(_transaction.signature[64]));

263: 		            } else if (_transaction.data[0] >= 0x80) {

285: 		            uint256 vInt = uint256(uint8(_transaction.signature[64]));
```
[[72](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L72), [91](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L91), [96](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L96), [168](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L168), [190](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L190), [263](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L263), [285](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L285)]



```solidity
File: code/system-contracts/contracts/KnownCodesStorage.sol

75: 		        uint8 version = uint8(_bytecodeHash[0]);

76: 		        require(version == 1 && _bytecodeHash[1] == bytes1(0), "Incorrectly formatted bytecodeHash");
```
[[75](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/KnownCodesStorage.sol#L75), [76](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/KnownCodesStorage.sol#L76)]



```solidity
File: code/system-contracts/contracts/L1Messenger.sol

230: 		        bytes32 l2ToL1LogsTreeRoot = l2ToL1LogsTreeArray[0];
```
[[230](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L230)]



```solidity
File: code/system-contracts/contracts/PubdataChunkPublisher.sol

55: 		        SystemContractHelper.toL1(true, bytes32(uint256(SystemLogKey.BLOB_ONE_HASH_KEY)), blobHashes[0]);

56: 		        SystemContractHelper.toL1(true, bytes32(uint256(SystemLogKey.BLOB_TWO_HASH_KEY)), blobHashes[1]);
```
[[55](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/PubdataChunkPublisher.sol#L55), [56](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/PubdataChunkPublisher.sol#L56)]



```solidity
File: code/system-contracts/contracts/libraries/RLPEncoder.sol

29: 		                encoded[0] = (_val == 0) ? bytes1(uint8(128)) : bytes1(uint8(_val));

34: 		                encoded[0] = bytes1(uint8(hbs + 0x81));

64: 		                encoded[0] = bytes1(uint8(_len + _offset));

69: 		                encoded[0] = bytes1(uint8(_offset + hbs + 56));
```
[[29](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/RLPEncoder.sol#L29), [34](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/RLPEncoder.sol#L34), [64](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/RLPEncoder.sol#L64), [69](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/RLPEncoder.sol#L69)]



```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

175: 		            } else if (_transaction.data[0] >= 0x80) {

184: 		        if (_transaction.reserved[0] != 0) {

253: 		            } else if (_transaction.data[0] >= 0x80) {

325: 		            } else if (_transaction.data[0] >= 0x80) {
```
[[175](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L175), [184](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L184), [253](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L253), [325](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L325)]



```solidity
File: code/system-contracts/contracts/libraries/Utils.sol

46: 		            codeLengthInWords = uint256(uint8(_bytecodeHash[2])) * 256 + uint256(uint8(_bytecodeHash[3]));

46: 		            codeLengthInWords = uint256(uint8(_bytecodeHash[2])) * 256 + uint256(uint8(_bytecodeHash[3]));

52: 		        return _bytecodeHash[1] == 0x00;

57: 		        return _bytecodeHash[1] == 0x01;
```
[[46](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L46), [46](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L46), [52](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L52), [57](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L57)]



```solidity
File: code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol

40: 		        uint8 version = uint8(_bytecodeHash[0]);

41: 		        require(version == 1 && _bytecodeHash[1] == bytes1(0), "zf"); // Incorrectly formatted bytecodeHash

50: 		        codeLengthInWords = uint256(uint8(_bytecodeHash[2])) * 256 + uint256(uint8(_bytecodeHash[3]));

50: 		        codeLengthInWords = uint256(uint8(_bytecodeHash[2])) * 256 + uint256(uint8(_bytecodeHash[3]));
```
[[40](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L40), [41](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L41), [50](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L50), [50](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L50)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol

41: 		        s.storedBatchHashes[0] = _initializeData.storedBatchZero;
```
[[41](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol#L41)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol

214: 		            bytes4 selector0 = ds.facetToSelectors[_facet].selectors[0];
```
[[214](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L214)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol

54: 		        require(_transaction.reserved[0] == 0, "ue");

55: 		        require(_transaction.reserved[1] <= type(uint160).max, "uf");

56: 		        require(_transaction.reserved[2] == 0, "ug");

57: 		        require(_transaction.reserved[3] == 0, "uo");
```
[[54](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L54), [55](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L55), [56](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L56), [57](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L57)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

39: 		        uint8 pubdataSource = uint8(bytes1(_newBatch.pubdataCommitments[0]));

55: 		            blobHashes[0] = logOutput.blob1Hash;

56: 		            blobHashes[1] = logOutput.blob2Hash;

66: 		            blobHashes[0] = logOutput.blob1Hash;

67: 		            blobCommitments[0] = bytes32(

287: 		        s.l2SystemContractsUpgradeBatchNumber = _newBatchesData[0].batchNumber;
```
[[39](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L39), [55](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L55), [56](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L56), [66](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L66), [67](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L67), [287](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L287)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol

170: 		            bytes4 selector0 = ds.facetToSelectors[_facet].selectors[0];
```
[[170](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L170)]

</details>

---

### [N-19] Variable initialization with zero value

It's not necessary to initialize a variable with a zero value, as it's the default behaviour, and it's actually worse in gas terms as it adds an overhead.

*There are 38 instances of this issue.*

<details>
<summary>Expand findings</summary>


```solidity
File: code/system-contracts/contracts/Compressor.sol

61: 		            for (uint256 encodedDataPointer = 0; encodedDataPointer < encodedData.length; encodedDataPointer += 2) {

124: 		        uint256 numInitialWritesProcessed = 0;

127: 		        for (uint256 i = 0; i < _numberOfStateDiffs * STATE_DIFF_ENTRY_SIZE; i += STATE_DIFF_ENTRY_SIZE) {

159: 		        for (uint256 i = 0; i < _numberOfStateDiffs * STATE_DIFF_ENTRY_SIZE; i += STATE_DIFF_ENTRY_SIZE) {
```
[[61](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L61), [124](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L124), [127](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L127), [159](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L159)]



```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

247: 		        uint256 sumOfValues = 0;

248: 		        for (uint256 i = 0; i < deploymentsLength; ++i) {

253: 		        for (uint256 i = 0; i < deploymentsLength; ++i) {
```
[[247](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L247), [248](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L248), [253](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L253)]



```solidity
File: code/system-contracts/contracts/ImmutableSimulator.sol

38: 		            for (uint256 i = 0; i < immutablesLength; ++i) {
```
[[38](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ImmutableSimulator.sol#L38)]



```solidity
File: code/system-contracts/contracts/KnownCodesStorage.sol

30: 		            for (uint256 i = 0; i < hashesLen; ++i) {
```
[[30](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/KnownCodesStorage.sol#L30)]



```solidity
File: code/system-contracts/contracts/L1Messenger.sol

197: 		        uint256 calldataPtr = 0;

206: 		        for (uint256 i = 0; i < numberOfL2ToL1Logs; ++i) {

224: 		            for (uint256 i = 0; i < nodesOnCurrentLevel; ++i) {

236: 		        for (uint256 i = 0; i < numberOfMessages; ++i) {

254: 		        for (uint256 i = 0; i < numberOfBytecodes; ++i) {
```
[[197](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L197), [206](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L206), [224](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L224), [236](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L236), [254](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L254)]



```solidity
File: code/system-contracts/contracts/PubdataChunkPublisher.sol

36: 		        for (uint256 i = 0; i < MAX_NUMBER_OF_BLOBS; i++) {
```
[[36](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/PubdataChunkPublisher.sol#L36)]



```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

225: 		        for (uint256 i = 0; i < _calls.length; ++i) {
```
[[225](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L225)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

116: 		            for (uint256 i = 0; i < _newBatchesData.length; ++i) {

135: 		            for (uint256 i = 0; i < _newBatchesData.length; ++i) {

185: 		            for (uint256 i = 0; i < _newBatchesData.length; ++i) {

209: 		            for (uint256 i = 0; i < _newBatchesData.length; ++i) {
```
[[116](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L116), [135](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L135), [185](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L185), [209](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L209)]



```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol

226: 		        for (uint256 i = 0; i < _factoryDeps.length; ++i) {
```
[[226](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L226)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol

101: 		        for (uint256 i = 0; i < facetCutsLength; i = i.uncheckedInc()) {

138: 		        for (uint256 i = 0; i < selectorsLength; i = i.uncheckedInc()) {

158: 		        for (uint256 i = 0; i < selectorsLength; i = i.uncheckedInc()) {

178: 		        for (uint256 i = 0; i < selectorsLength; i = i.uncheckedInc()) {
```
[[101](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L101), [138](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L138), [158](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L158), [178](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L178)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol

92: 		        uint256 costForPubdata = 0;
```
[[92](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L92)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

142: 		        for (uint256 i = 0; i < emittedL2Logs.length; i = i.uncheckedAdd(L2_TO_L1_LOG_SERIALIZE_SIZE)) {

257: 		        for (uint256 i = 0; i < _newBatchesData.length; i = i.uncheckedInc()) {

289: 		        for (uint256 i = 0; i < _newBatchesData.length; i = i.uncheckedInc()) {

311: 		        for (uint256 i = 0; i < _nPriorityOps; i = i.uncheckedInc()) {

351: 		        for (uint256 i = 0; i < nBatches; i = i.uncheckedInc()) {

405: 		        for (uint256 i = 0; i < committedBatchesLength; i = i.uncheckedInc()) {

580: 		        for (uint i = 0; i < MAX_NUMBER_OF_BLOBS; i++) {

629: 		        uint256 versionedHashIndex = 0;

636: 		        for (uint256 i = 0; i < _pubdataCommitments.length; i += PUBDATA_COMMITMENT_SIZE) {

667: 		        for (uint256 i = 0; i < MAX_NUMBER_OF_BLOBS; i++) {
```
[[142](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L142), [257](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L257), [289](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L289), [311](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L311), [351](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L351), [405](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L405), [580](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L580), [629](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L629), [636](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L636), [667](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L667)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol

208: 		        for (uint256 i = 0; i < facetsLen; i = i.uncheckedInc()) {
```
[[208](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L208)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

356: 		        for (uint256 i = 0; i < factoryDepsLen; i = i.uncheckedInc()) {
```
[[356](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L356)]

</details>

---

### [N-20] Consider adding emergency-stop functionality

Consider adding `pausable` to the following contracts so it's possible to stop them in case of an emergency.

*There are 5 instances of this issue.*


```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

30: 		contract L1SharedBridge is IL1SharedBridge, ReentrancyGuard, Initializable, Ownable2Step {
```
[[30](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L30)]



```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

16: 		contract Bridgehub is IBridgehub, ReentrancyGuard, Ownable2Step {
```
[[16](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L16)]



```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

20: 		contract Governance is IGovernance, Ownable2Step {
```
[[20](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L20)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

25: 		contract StateTransitionManager is IStateTransitionManager, ReentrancyGuard, Ownable2Step {
```
[[25](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L25)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

22: 		contract ValidatorTimelock is IExecutor, Ownable2Step {
```
[[22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L22)]


---

### [N-21] Duplicated `require/if` statements should be refactored

These statements should be refactored to a separate function, as there are multiple parts of the codebase that use the same logic, to improve the code readability and reduce code duplication.

*There are 3 instances of this issue.*


```solidity
File: code/system-contracts/contracts/BootloaderUtilities.sol

// @audit this require is duplicated on line 191, 286
92: 		            require(vInt == 27 || vInt == 28, "Invalid v value");
```
[[92](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L92)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

// @audit this require is duplicated on line 217
195: 		                require(block.timestamp >= commitBatchTimestamp + delay, "5c"); // The delay is not passed
```
[[195](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L195)]



```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

// @audit this require is duplicated on line 58
56: 		        require(_l2TokenProxyBytecodeHash != bytes32(0), "df");
```
[[56](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L56)]


---

### [N-22] Inconsistent usage of `require`/`error`

Some parts of the codebase use `require` statements, while others use custom `error`s. Consider refactoring the code to use the same approach: the following findings represent the minority of `require` vs `error`, and they show the first occurance in each file, for brevity.

*There is 1 instance of this issue.*


```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

80: 		            revert AddressAlreadyValidator(_chainId);
```
[[80](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L80)]


---

### [N-23] Some functions contain the same exact logic

These functions might be a problem if the logic changes before the contract is deployed, as the developer must remember to syncronize the logic between all the function instances.

Consider using a single function instead of duplicating the code, for example by using a `library`, or through inheritance.

*There are 34 instances of this issue.*

<details>
<summary>Expand findings</summary>


```solidity
File: code/contracts/zksync/contracts/L2ContractHelper.sol

// @audit duplicated logic in code/contracts/zksync/contracts/L2ContractHelper.sol -> computeCreate2Address, code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol -> computeCreate2Address
101: 		    function computeCreate2Address(
```
[[101](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/L2ContractHelper.sol#L101)]



```solidity
File: code/contracts/zksync/contracts/SystemContractsCaller.sol

// @audit duplicated logic in code/contracts/zksync/contracts/SystemContractsCaller.sol -> safeCastToU32, code/system-contracts/contracts/libraries/Utils.sol -> safeCastToU32
27: 		    function safeCastToU32(uint256 _x) internal pure returns (uint32) {

// @audit duplicated logic in code/contracts/zksync/contracts/SystemContractsCaller.sol -> systemCallWithReturndata, code/system-contracts/contracts/libraries/SystemContractsCaller.sol -> systemCallWithReturndata
76: 		    function systemCallWithReturndata(

// @audit duplicated logic in code/contracts/zksync/contracts/SystemContractsCaller.sol -> getFarCallABI, code/system-contracts/contracts/libraries/SystemContractsCaller.sol -> getFarCallABI
95: 		    function getFarCallABI(

// @audit duplicated logic in code/contracts/zksync/contracts/SystemContractsCaller.sol -> getFarCallABIWithEmptyFatPointer, code/system-contracts/contracts/libraries/SystemContractsCaller.sol -> getFarCallABIWithEmptyFatPointer
121: 		    function getFarCallABIWithEmptyFatPointer(
```
[[27](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/SystemContractsCaller.sol#L27), [76](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/SystemContractsCaller.sol#L76), [95](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/SystemContractsCaller.sol#L95), [121](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/SystemContractsCaller.sol#L121)]



```solidity
File: code/system-contracts/contracts/libraries/SystemContractsCaller.sol

// @audit duplicated logic in code/contracts/zksync/contracts/SystemContractsCaller.sol -> systemCallWithReturndata, code/system-contracts/contracts/libraries/SystemContractsCaller.sol -> systemCallWithReturndata
123: 		    function systemCallWithReturndata(

// @audit duplicated logic in code/contracts/zksync/contracts/SystemContractsCaller.sol -> getFarCallABI, code/system-contracts/contracts/libraries/SystemContractsCaller.sol -> getFarCallABI
214: 		    function getFarCallABI(

// @audit duplicated logic in code/contracts/zksync/contracts/SystemContractsCaller.sol -> getFarCallABIWithEmptyFatPointer, code/system-contracts/contracts/libraries/SystemContractsCaller.sol -> getFarCallABIWithEmptyFatPointer
250: 		    function getFarCallABIWithEmptyFatPointer(
```
[[123](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L123), [214](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L214), [250](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L250)]



```solidity
File: code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol

// @audit duplicated logic in code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol -> readBytes32, code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol -> readUint256
40: 		    function readBytes32(bytes calldata _bytes, uint256 _start) internal pure returns (bytes32 result) {
```
[[40](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol#L40)]



```solidity
File: code/system-contracts/contracts/libraries/Utils.sol

// @audit duplicated logic in code/contracts/zksync/contracts/SystemContractsCaller.sol -> safeCastToU32, code/system-contracts/contracts/libraries/Utils.sol -> safeCastToU32
26: 		    function safeCastToU32(uint256 _x) internal pure returns (uint32) {
```
[[26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L26)]



```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

// @audit duplicated logic in code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol -> initialize, code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol -> _upgradeL1Contract, code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol -> _postUpgrade
60: 		    function initialize() external reentrancyGuardInitializer {}
```
[[60](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L60)]



```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

// @audit duplicated logic in code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol -> setPendingAdmin, code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol -> setPendingAdmin
51: 		    function setPendingAdmin(address _newPendingAdmin) external onlyOwnerOrAdmin {

// @audit duplicated logic in code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol -> acceptAdmin, code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol -> acceptAdmin
60: 		    function acceptAdmin() external {
```
[[51](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L51), [60](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L60)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

// @audit duplicated logic in code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol -> setPendingAdmin, code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol -> setPendingAdmin
110: 		    function setPendingAdmin(address _newPendingAdmin) external onlyOwnerOrAdmin {

// @audit duplicated logic in code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol -> acceptAdmin, code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol -> acceptAdmin
119: 		    function acceptAdmin() external {

// @audit duplicated logic in code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol -> freezeChain, code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol -> unfreezeChain
160: 		    function freezeChain(uint256 _chainId) external onlyOwner {
```
[[110](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L110), [119](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L119), [160](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L160)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

// @audit duplicated logic in code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol -> revertBatches, code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol -> proveBatches
146: 		    function revertBatches(uint256) external onlyValidator(ERA_CHAIN_ID) {

// @audit duplicated logic in code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol -> revertBatchesSharedBridge, code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol -> proveBatchesSharedBridge
153: 		    function revertBatchesSharedBridge(uint256 _chainId, uint256) external onlyValidator(_chainId) {
```
[[146](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L146), [153](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L153)]



```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol

// @audit duplicated logic in code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol -> initialize, code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol -> _upgradeL1Contract, code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol -> _postUpgrade
263: 		    function _upgradeL1Contract(bytes calldata _customCallDataForUpgrade) internal virtual {}
```
[[263](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L263)]



```solidity
File: code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol

// @audit duplicated logic in code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol -> applyL1ToL2Alias, code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol -> applyL1ToL2Alias
28: 		    function applyL1ToL2Alias(address l1Address) internal pure returns (address l2Address) {

// @audit duplicated logic in code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol -> undoL1ToL2Alias, code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol -> undoL1ToL2Alias
38: 		    function undoL1ToL2Alias(address l2Address) internal pure returns (address l1Address) {
```
[[28](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol#L28), [38](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol#L38)]



```solidity
File: code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol

// @audit duplicated logic in code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol -> applyL1ToL2Alias, code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol -> applyL1ToL2Alias
28: 		    function applyL1ToL2Alias(address l1Address) internal pure returns (address l2Address) {

// @audit duplicated logic in code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol -> undoL1ToL2Alias, code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol -> undoL1ToL2Alias
38: 		    function undoL1ToL2Alias(address l2Address) internal pure returns (address l1Address) {
```
[[28](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol#L28), [38](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol#L38)]



```solidity
File: code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol

// @audit duplicated logic in code/contracts/zksync/contracts/L2ContractHelper.sol -> computeCreate2Address, code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol -> computeCreate2Address
60: 		    function computeCreate2Address(
```
[[60](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L60)]



```solidity
File: code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol

// @audit duplicated logic in code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol -> readUint256, code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol -> readBytes32
33: 		    function readUint256(bytes memory _bytes, uint256 _start) internal pure returns (uint256 result, uint256 offset) {
```
[[33](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol#L33)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

// @audit duplicated logic in code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol -> commitBatches, code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol -> commitBatchesSharedBridge
199: 		    function commitBatches(

// @audit duplicated logic in code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol -> executeBatchesSharedBridge, code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol -> executeBatches
337: 		    function executeBatchesSharedBridge(

// @audit duplicated logic in code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol -> proveBatches, code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol -> proveBatchesSharedBridge
368: 		    function proveBatches(

// @audit duplicated logic in code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol -> revertBatches, code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol -> revertBatchesSharedBridge
472: 		    function revertBatches(uint256 _newLastBatch) external nonReentrant onlyValidatorOrStateTransitionManager {
```
[[199](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L199), [337](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L337), [368](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L368), [472](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L472)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol

// @audit duplicated logic in code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol -> getTotalBatchesCommitted, code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol -> getTotalBlocksCommitted
77: 		    function getTotalBatchesCommitted() external view returns (uint256) {

// @audit duplicated logic in code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol -> getTotalBatchesVerified, code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol -> getTotalBlocksVerified
82: 		    function getTotalBatchesVerified() external view returns (uint256) {

// @audit duplicated logic in code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol -> getTotalBatchesExecuted, code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol -> getTotalBlocksExecuted
87: 		    function getTotalBatchesExecuted() external view returns (uint256) {

// @audit duplicated logic in code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol -> storedBatchHash, code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol -> storedBlockHash
122: 		    function storedBatchHash(uint256 _batchNumber) external view returns (bytes32) {

// @audit duplicated logic in code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol -> getL2SystemContractsUpgradeBatchNumber, code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol -> getL2SystemContractsUpgradeBlockNumber
152: 		    function getL2SystemContractsUpgradeBatchNumber() external view returns (uint256) {
```
[[77](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L77), [82](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L82), [87](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L87), [122](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L122), [152](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L152)]

</details>

---

### [N-24] Public functions not called internally

Those functions should be declared as `external` instead of `public`, as they are never called internally by the contract.

Contracts are allowed to override their parents' functions and change the visibility from external to public.

*There are 11 instances of this issue.*


```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

40: 		    function extendedAccountVersion(address _address) public view returns (AccountAbstractionVersion) {
```
[[40](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L40)]



```solidity
File: code/system-contracts/contracts/NonceHolder.sol

57: 		    function getRawNonce(address _address) public view returns (uint256) {

65: 		    function increaseMinNonce(uint256 _value) public onlySystemCall returns (uint256 oldMinNonce) {

82: 		    function setValueUnderNonce(uint256 _key, uint256 _value) public onlySystemCall {

102: 		    function getValueUnderNonce(uint256 _key) public view returns (uint256) {
```
[[57](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/NonceHolder.sol#L57), [65](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/NonceHolder.sol#L65), [82](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/NonceHolder.sol#L82), [102](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/NonceHolder.sol#L102)]



```solidity
File: code/system-contracts/contracts/SystemContext.sol

190: 		    function getBlockNumber() public view returns (uint128) {

198: 		    function getBlockTimestamp() public view returns (uint128) {
```
[[190](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L190), [198](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L198)]



```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol

67: 		    function upgrade(ProposedUpgrade calldata _proposedUpgrade) public virtual returns (bytes32 txHash) {
```
[[67](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L67)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

54: 		    function proveL2MessageInclusion(

74: 		    function proveL1ToL2TransactionStatus(

143: 		    function l2TransactionBaseCost(
```
[[54](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L54), [74](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L74), [143](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L143)]


---

### [N-25] Missing/malformed underscores for large numeric literals

Large hardcoded numbers in code can be difficult to read. Consider using underscores for number literals to improve readability (e.g `1234567` -> `1_234_567`). Consider using an underscore for every third digit from the right.

*There is 1 instance of this issue.*


```solidity
File: code/system-contracts/contracts/MsgValueSimulator.sol

41: 		    uint256 constant MSG_VALUE_SIMULATOR_STIPEND_GAS = 27000;
```
[[41](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/MsgValueSimulator.sol#L41)]


---

### [N-26] Mixed usage of `int`/`uint` with `int256`/`uint256`

The codebase uses both `int`/`uint` and `int256`/`uint256` at the same time. To improve the consistency, even if they are aliases, it is recommended to use only a variant, preferably `int256`/`uint256` as they are the preferred type names.

*There is 1 instance of this issue.*


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

// @audit i
580: 		        for (uint i = 0; i < MAX_NUMBER_OF_BLOBS; i++) {
```
[[580](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L580)]


---

### [N-27] Consider using the `using-for` syntax

The `using-for` [syntax](https://docs.soliditylang.org/en/latest/contracts.html#using-for) is the more common way of calling library functions.

*There are 274 instances of this issue.*

<details>
<summary>Expand findings</summary>


```solidity
File: code/system-contracts/contracts/AccountCodeStorage.sol

37: 		        require(Utils.isContractConstructing(_hash), "Code hash is not for a contract on constructor");

48: 		        require(Utils.isContractConstructed(_hash), "Code hash is not for a constructed contract");

57: 		        require(Utils.isContractConstructing(codeHash), "Code hash is not for a contract on constructor");

60: 		        bytes32 constructedBytecodeHash = Utils.constructedBytecodeHash(codeHash);

102: 		        if (codeHash == 0x00 && NONCE_HOLDER_SYSTEM_CONTRACT.getRawNonce(account) > 0) {

107: 		        else if (Utils.isContractConstructing(codeHash)) {

134: 		            !Utils.isContractConstructing(codeHash)

136: 		            codeSize = Utils.bytecodeLenInBytes(codeHash);
```
[[37](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L37), [48](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L48), [57](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L57), [60](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L60), [102](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L102), [107](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L107), [134](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L134), [136](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L136)]



```solidity
File: code/system-contracts/contracts/BootloaderUtilities.sol

29: 		            txHash = keccak256(bytes.concat(signedTxHash, EfficientCall.keccak(_transaction.signature)));

52: 		        bytes memory encodedNonce = RLPEncoder.encodeUint256(_transaction.nonce);

56: 		            bytes memory encodedGasPrice = RLPEncoder.encodeUint256(_transaction.maxFeePerGas);

57: 		            bytes memory encodedGasLimit = RLPEncoder.encodeUint256(_transaction.gasLimit);

61: 		        bytes memory encodedTo = RLPEncoder.encodeAddress(address(uint160(_transaction.to)));

62: 		        bytes memory encodedValue = RLPEncoder.encodeUint256(_transaction.value);

71: 		                encodedDataLength = RLPEncoder.encodeNonSingleBytesLen(txDataLen);

82: 		            rEncoded = RLPEncoder.encodeUint256(rInt);

87: 		            sEncoded = RLPEncoder.encodeUint256(sInt);

100: 		            vEncoded = RLPEncoder.encodeUint256(vInt);

116: 		            encodedListLength = RLPEncoder.encodeListLen(uint64(listLength));

143: 		            bytes memory encodedChainId = RLPEncoder.encodeUint256(block.chainid);

144: 		            bytes memory encodedNonce = RLPEncoder.encodeUint256(_transaction.nonce);

145: 		            bytes memory encodedGasPrice = RLPEncoder.encodeUint256(_transaction.maxFeePerGas);

146: 		            bytes memory encodedGasLimit = RLPEncoder.encodeUint256(_transaction.gasLimit);

147: 		            bytes memory encodedTo = RLPEncoder.encodeAddress(address(uint160(_transaction.to)));

148: 		            bytes memory encodedValue = RLPEncoder.encodeUint256(_transaction.value);

167: 		                encodedDataLength = RLPEncoder.encodeNonSingleBytesLen(txDataLen);

176: 		        bytes memory encodedAccessListLength = RLPEncoder.encodeListLen(0);

181: 		            rEncoded = RLPEncoder.encodeUint256(rInt);

186: 		            sEncoded = RLPEncoder.encodeUint256(sInt);

193: 		            vEncoded = RLPEncoder.encodeUint256(vInt - 27);

207: 		            encodedListLength = RLPEncoder.encodeListLen(uint64(listLength));

236: 		            bytes memory encodedChainId = RLPEncoder.encodeUint256(block.chainid);

237: 		            bytes memory encodedNonce = RLPEncoder.encodeUint256(_transaction.nonce);

238: 		            bytes memory encodedMaxPriorityFeePerGas = RLPEncoder.encodeUint256(_transaction.maxPriorityFeePerGas);

239: 		            bytes memory encodedMaxFeePerGas = RLPEncoder.encodeUint256(_transaction.maxFeePerGas);

240: 		            bytes memory encodedGasLimit = RLPEncoder.encodeUint256(_transaction.gasLimit);

241: 		            bytes memory encodedTo = RLPEncoder.encodeAddress(address(uint160(_transaction.to)));

242: 		            bytes memory encodedValue = RLPEncoder.encodeUint256(_transaction.value);

262: 		                encodedDataLength = RLPEncoder.encodeNonSingleBytesLen(txDataLen);

271: 		        bytes memory encodedAccessListLength = RLPEncoder.encodeListLen(0);

276: 		            rEncoded = RLPEncoder.encodeUint256(rInt);

281: 		            sEncoded = RLPEncoder.encodeUint256(sInt);

288: 		            vEncoded = RLPEncoder.encodeUint256(vInt - 27);

302: 		            encodedListLength = RLPEncoder.encodeListLen(uint64(listLength));
```
[[29](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L29), [52](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L52), [56](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L56), [57](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L57), [61](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L61), [62](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L62), [71](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L71), [82](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L82), [87](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L87), [100](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L100), [116](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L116), [143](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L143), [144](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L144), [145](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L145), [146](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L146), [147](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L147), [148](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L148), [167](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L167), [176](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L176), [181](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L181), [186](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L186), [193](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L193), [207](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L207), [236](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L236), [237](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L237), [238](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L238), [239](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L239), [240](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L240), [241](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L241), [242](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L242), [262](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L262), [271](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L271), [276](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L276), [281](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L281), [288](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L288), [302](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L302)]



```solidity
File: code/system-contracts/contracts/Compressor.sol

72: 		        bytecodeHash = Utils.hashL2Bytecode(_bytecode);

73: 		        L1_MESSENGER_CONTRACT.sendToL1(_rawCompressedData);

74: 		        KNOWN_CODE_STORAGE_CONTRACT.markBytecodeAsPublished(bytecodeHash);

189: 		        stateDiffHash = EfficientCall.keccak(_stateDiffs);
```
[[72](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L72), [73](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L73), [74](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L74), [189](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L189)]



```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

42: 		        if (info.supportedAAVersion != AccountAbstractionVersion.None) {

49: 		            ACCOUNT_CODE_STORAGE_SYSTEM_CONTRACT.getRawCodeHash(_address) == 0

51: 		            return AccountAbstractionVersion.Version1;

54: 		        return AccountAbstractionVersion.None;

78: 		            _nonceOrdering == AccountNonceOrdering.Arbitrary &&

79: 		                currentInfo.nonceOrdering == AccountNonceOrdering.Sequential,

103: 		        bytes32 constructorInputHash = EfficientCall.keccak(_input);

137: 		        return create2Account(_salt, _bytecodeHash, _input, AccountAbstractionVersion.None);

152: 		        return createAccount(_salt, _bytecodeHash, _input, AccountAbstractionVersion.None);

168: 		        NONCE_HOLDER_SYSTEM_CONTRACT.incrementDeploymentNonce(msg.sender);

188: 		        uint256 senderNonce = NONCE_HOLDER_SYSTEM_CONTRACT.incrementDeploymentNonce(msg.sender);

220: 		        newAccountInfo.supportedAAVersion = AccountAbstractionVersion.None;

222: 		        newAccountInfo.nonceOrdering = AccountNonceOrdering.Sequential;

269: 		            ACCOUNT_CODE_STORAGE_SYSTEM_CONTRACT.getCodeHash(uint256(uint160(_newAddress))) == 0x0,

273: 		        require(NONCE_HOLDER_SYSTEM_CONTRACT.getRawNonce(_newAddress) == 0x00, "Account is occupied");

294: 		        newAccountInfo.nonceOrdering = AccountNonceOrdering.Sequential;

302: 		        uint256 knownCodeMarker = KNOWN_CODE_STORAGE_CONTRACT.getMarker(_bytecodeHash);

311: 		        bytes32 constructingBytecodeHash = Utils.constructingBytecodeHash(_bytecodeHash);

312: 		        ACCOUNT_CODE_STORAGE_SYSTEM_CONTRACT.storeAccountConstructingCodeHash(_newAddress, constructingBytecodeHash);

333: 		                BASE_TOKEN_SYSTEM_CONTRACT.transferFromTo(address(this), _newAddress, value);

341: 		                SystemContractHelper.setValueForNextFarCall(uint128(value));

343: 		            bytes memory returnData = EfficientCall.mimicCall(gasleft(), _newAddress, _input, _sender, true, _isSystem);

345: 		            ACCOUNT_CODE_STORAGE_SYSTEM_CONTRACT.markAccountCodeHashAsConstructed(_newAddress);

348: 		            IMMUTABLE_SIMULATOR_SYSTEM_CONTRACT.setImmutables(_newAddress, immutables);

352: 		            ACCOUNT_CODE_STORAGE_SYSTEM_CONTRACT.storeAccountConstructedCodeHash(_newAddress, _bytecodeHash);
```
[[42](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L42), [49](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L49), [51](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L51), [54](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L54), [78](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L78), [79](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L79), [103](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L103), [137](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L137), [152](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L152), [168](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L168), [188](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L188), [220](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L220), [222](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L222), [269](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L269), [273](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L273), [294](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L294), [302](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L302), [311](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L311), [312](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L312), [333](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L333), [341](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L341), [343](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L343), [345](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L345), [348](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L348), [352](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L352)]



```solidity
File: code/system-contracts/contracts/DefaultAccount.sol

46: 		        address codeAddress = SystemContractHelper.getCodeAddress();

83: 		        SystemContractsCaller.systemCallWithPropagatedRevert(

87: 		            abi.encodeCall(INonceHolder.incrementMinNonceIfEquals, (_transaction.nonce))

133: 		        uint128 value = Utils.safeCastToU128(_transaction.value);

135: 		        uint32 gas = Utils.safeCastToU32(gasleft());

144: 		                selector == DEPLOYER_SYSTEM_CONTRACT.create.selector ||

145: 		                selector == DEPLOYER_SYSTEM_CONTRACT.create2.selector ||

146: 		                selector == DEPLOYER_SYSTEM_CONTRACT.createAccount.selector ||

147: 		                selector == DEPLOYER_SYSTEM_CONTRACT.create2Account.selector;

149: 		        bool success = EfficientCall.rawCall(gas, to, value, data, isSystemCall);

151: 		            EfficientCall.propagateRevert();
```
[[46](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L46), [83](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L83), [87](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L87), [133](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L133), [135](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L135), [144](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L144), [145](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L145), [146](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L146), [147](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L147), [149](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L149), [151](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L151)]



```solidity
File: code/system-contracts/contracts/GasBoundCaller.sol

51: 		        uint256 pubdataPublishedBefore = REAL_SYSTEM_CONTEXT_CONTRACT.getCurrentPubdataSpent();

57: 		        bytes memory returnData = EfficientCall.call(gasleft(), _to, msg.value, _data, false);

59: 		        uint256 pubdataPublishedAfter = REAL_SYSTEM_CONTEXT_CONTRACT.getCurrentPubdataSpent();

67: 		        uint256 pubdataPrice = REAL_SYSTEM_CONTEXT_CONTRACT.gasPerPubdataByte();
```
[[51](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/GasBoundCaller.sol#L51), [57](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/GasBoundCaller.sol#L57), [59](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/GasBoundCaller.sol#L59), [67](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/GasBoundCaller.sol#L67)]



```solidity
File: code/system-contracts/contracts/KnownCodesStorage.sol

51: 		                L1_MESSENGER_CONTRACT.requestBytecodeL1Publication(_bytecodeHash);

78: 		        require(Utils.bytecodeLenInWords(_bytecodeHash) % 2 == 1, "Code length in words must be odd");
```
[[51](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/KnownCodesStorage.sol#L51), [78](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/KnownCodesStorage.sol#L78)]



```solidity
File: code/system-contracts/contracts/L1Messenger.sol

78: 		            txNumberInBlock: SYSTEM_CONTEXT_CONTRACT.txNumberInBlock(),

90: 		        SystemContractHelper.burnGas(Utils.safeCastToU32(gasToPay), 0);

90: 		        SystemContractHelper.burnGas(Utils.safeCastToU32(gasToPay), 0);

118: 		        hash = EfficientCall.keccak(_message);

128: 		            txNumberInBlock: SYSTEM_CONTEXT_CONTRACT.txNumberInBlock(),

154: 		        SystemContractHelper.burnGas(Utils.safeCastToU32(gasToPay), uint32(pubdataLen));

154: 		        SystemContractHelper.burnGas(Utils.safeCastToU32(gasToPay), uint32(pubdataLen));

166: 		        uint256 bytecodeLen = Utils.bytecodeLenInBytes(_bytecodeHash);

179: 		        SystemContractHelper.burnGas(Utils.safeCastToU32(gasToPay), uint32(pubdataLen));

179: 		        SystemContractHelper.burnGas(Utils.safeCastToU32(gasToPay), uint32(pubdataLen));

207: 		            bytes32 hashedLog = EfficientCall.keccak(

239: 		            bytes32 hashedMessage = EfficientCall.keccak(

262: 		                    Utils.hashL2Bytecode(

307: 		        bytes32 stateDiffHash = COMPRESSOR_CONTRACT.verifyCompressedStateDiffs(

317: 		        PUBDATA_CHUNK_PUBLISHER.chunkAndPublishPubdata(totalL2ToL1Pubdata);

320: 		        SystemContractHelper.toL1(true, bytes32(uint256(SystemLogKey.L2_TO_L1_LOGS_TREE_ROOT_KEY)), l2ToL1LogsTreeRoot);

320: 		        SystemContractHelper.toL1(true, bytes32(uint256(SystemLogKey.L2_TO_L1_LOGS_TREE_ROOT_KEY)), l2ToL1LogsTreeRoot);

321: 		        SystemContractHelper.toL1(

323: 		            bytes32(uint256(SystemLogKey.TOTAL_L2_TO_L1_PUBDATA_KEY)),

324: 		            EfficientCall.keccak(totalL2ToL1Pubdata)

326: 		        SystemContractHelper.toL1(true, bytes32(uint256(SystemLogKey.STATE_DIFF_HASH_KEY)), stateDiffHash);

326: 		        SystemContractHelper.toL1(true, bytes32(uint256(SystemLogKey.STATE_DIFF_HASH_KEY)), stateDiffHash);
```
[[78](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L78), [90](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L90), [90](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L90), [118](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L118), [128](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L128), [154](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L154), [154](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L154), [166](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L166), [179](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L179), [179](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L179), [207](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L207), [239](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L239), [262](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L262), [307](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L307), [317](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L317), [320](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L320), [320](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L320), [321](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L321), [323](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L323), [324](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L324), [326](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L326), [326](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L326)]



```solidity
File: code/system-contracts/contracts/L2BaseToken.sol

77: 		        L1_MESSENGER_CONTRACT.sendToL1(message);

90: 		        L1_MESSENGER_CONTRACT.sendToL1(message);

113: 		        return abi.encodePacked(IMailbox.finalizeEthWithdrawal.selector, _to, _amount);

123: 		        return abi.encodePacked(IMailbox.finalizeEthWithdrawal.selector, _to, _amount, _sender, _additionalData);
```
[[77](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L2BaseToken.sol#L77), [90](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L2BaseToken.sol#L90), [113](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L2BaseToken.sol#L113), [123](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L2BaseToken.sol#L123)]



```solidity
File: code/system-contracts/contracts/MsgValueSimulator.sol

26: 		        value = SystemContractHelper.getExtraAbiData(0);

27: 		        uint256 addressAsUint = SystemContractHelper.getExtraAbiData(1);

28: 		        uint256 mask = SystemContractHelper.getExtraAbiData(2);

64: 		                abi.encodeCall(REAL_BASE_TOKEN_SYSTEM_CONTRACT.transferFromTo, (msg.sender, to, value))

79: 		        SystemContractHelper.setValueForNextFarCall(Utils.safeCastToU128(value));

79: 		        SystemContractHelper.setValueForNextFarCall(Utils.safeCastToU128(value));

81: 		        return EfficientCall.mimicCall(userGas, to, _data, msg.sender, false, isSystemCall);
```
[[26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/MsgValueSimulator.sol#L26), [27](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/MsgValueSimulator.sol#L27), [28](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/MsgValueSimulator.sol#L28), [64](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/MsgValueSimulator.sol#L64), [79](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/MsgValueSimulator.sol#L79), [79](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/MsgValueSimulator.sol#L79), [81](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/MsgValueSimulator.sol#L81)]



```solidity
File: code/system-contracts/contracts/NonceHolder.sol

83: 		        IContractDeployer.AccountInfo memory accountInfo = DEPLOYER_SYSTEM_CONTRACT.getAccountInfo(msg.sender);

88: 		        if (accountInfo.nonceOrdering == IContractDeployer.AccountNonceOrdering.Sequential && _key != 0) {
```
[[83](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/NonceHolder.sol#L83), [88](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/NonceHolder.sol#L88)]



```solidity
File: code/system-contracts/contracts/PubdataChunkPublisher.sol

55: 		        SystemContractHelper.toL1(true, bytes32(uint256(SystemLogKey.BLOB_ONE_HASH_KEY)), blobHashes[0]);

55: 		        SystemContractHelper.toL1(true, bytes32(uint256(SystemLogKey.BLOB_ONE_HASH_KEY)), blobHashes[0]);

56: 		        SystemContractHelper.toL1(true, bytes32(uint256(SystemLogKey.BLOB_TWO_HASH_KEY)), blobHashes[1]);

56: 		        SystemContractHelper.toL1(true, bytes32(uint256(SystemLogKey.BLOB_TWO_HASH_KEY)), blobHashes[1]);
```
[[55](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/PubdataChunkPublisher.sol#L55), [55](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/PubdataChunkPublisher.sol#L55), [56](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/PubdataChunkPublisher.sol#L56), [56](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/PubdataChunkPublisher.sol#L56)]



```solidity
File: code/system-contracts/contracts/SystemContext.sol

118: 		        uint256 pubdataPublished = SystemContractHelper.getZkSyncMeta().pubdataPublished;

418: 		        SystemContractHelper.toL1(

420: 		            bytes32(uint256(SystemLogKey.PACKED_BATCH_AND_L2_BLOCK_TIMESTAMP_KEY)),

466: 		        SystemContractHelper.toL1(false, bytes32(uint256(SystemLogKey.PREV_BATCH_HASH_KEY)), _prevBatchHash);

466: 		        SystemContractHelper.toL1(false, bytes32(uint256(SystemLogKey.PREV_BATCH_HASH_KEY)), _prevBatchHash);
```
[[118](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L118), [418](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L418), [420](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L420), [466](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L466), [466](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L466)]



```solidity
File: code/contracts/zksync/contracts/L2ContractHelper.sol

91: 		        return L2_MESSENGER.sendToL1(_message);
```
[[91](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/L2ContractHelper.sol#L91)]



```solidity
File: code/contracts/zksync/contracts/SystemContractsCaller.sol

44: 		        uint32 dataLength = uint32(Utils.safeCastToU32(data.length));

54: 		            CalldataForwardingMode.UseHeap,
```
[[44](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/SystemContractsCaller.sol#L44), [54](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/SystemContractsCaller.sol#L54)]



```solidity
File: code/system-contracts/contracts/interfaces/ISystemContract.sol

22: 		            SystemContractHelper.isSystemCall() || SystemContractHelper.isSystemContract(msg.sender),

22: 		            SystemContractHelper.isSystemCall() || SystemContractHelper.isSystemContract(msg.sender),

32: 		            SystemContractHelper.isSystemContract(msg.sender),
```
[[22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContract.sol#L22), [22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContract.sol#L22), [32](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContract.sol#L32)]



```solidity
File: code/system-contracts/contracts/libraries/EfficientCall.sol

251: 		        SystemContractHelper.loadCalldataIntoActivePtr();

259: 		        SystemContractHelper.ptrAddIntoActive(uint32(dataOffset));

262: 		        SystemContractHelper.ptrShrinkIntoActive(shrinkTo);

264: 		        uint32 gas = Utils.safeCastToU32(_gas);

265: 		        uint256 farCallAbi = SystemContractsCaller.getFarCallABIWithEmptyFatPointer(

269: 		            CalldataForwardingMode.ForwardFatPointer,

273: 		        SystemContractHelper.ptrPackIntoActivePtr(farCallAbi);
```
[[251](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L251), [259](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L259), [262](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L262), [264](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L264), [265](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L265), [269](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L269), [273](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L273)]



```solidity
File: code/system-contracts/contracts/libraries/SystemContractsCaller.sol

83: 		        uint32 dataLength = uint32(Utils.safeCastToU32(data.length));

85: 		        uint256 farCallAbi = SystemContractsCaller.getFarCallABI(

93: 		            CalldataForwardingMode.UseHeap,
```
[[83](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L83), [85](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L85), [93](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L93)]



```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

132: 		                EfficientCall.keccak(_transaction.data),

134: 		                EfficientCall.keccak(_transaction.paymasterInput)

155: 		        bytes memory encodedNonce = RLPEncoder.encodeUint256(_transaction.nonce);

159: 		            bytes memory encodedGasPrice = RLPEncoder.encodeUint256(_transaction.maxFeePerGas);

160: 		            bytes memory encodedGasLimit = RLPEncoder.encodeUint256(_transaction.gasLimit);

164: 		        bytes memory encodedTo = RLPEncoder.encodeAddress(address(uint160(_transaction.to)));

165: 		        bytes memory encodedValue = RLPEncoder.encodeUint256(_transaction.value);

174: 		                encodedDataLength = RLPEncoder.encodeNonSingleBytesLen(txDataLen);

185: 		            encodedChainId = bytes.concat(RLPEncoder.encodeUint256(block.chainid), hex"80_80");

199: 		            encodedListLength = RLPEncoder.encodeListLen(uint64(listLength));

228: 		            bytes memory encodedChainId = RLPEncoder.encodeUint256(block.chainid);

229: 		            bytes memory encodedNonce = RLPEncoder.encodeUint256(_transaction.nonce);

230: 		            bytes memory encodedGasPrice = RLPEncoder.encodeUint256(_transaction.maxFeePerGas);

231: 		            bytes memory encodedGasLimit = RLPEncoder.encodeUint256(_transaction.gasLimit);

232: 		            bytes memory encodedTo = RLPEncoder.encodeAddress(address(uint160(_transaction.to)));

233: 		            bytes memory encodedValue = RLPEncoder.encodeUint256(_transaction.value);

252: 		                encodedDataLength = RLPEncoder.encodeNonSingleBytesLen(txDataLen);

261: 		        bytes memory encodedAccessListLength = RLPEncoder.encodeListLen(0);

271: 		            encodedListLength = RLPEncoder.encodeListLen(uint64(listLength));

298: 		            bytes memory encodedChainId = RLPEncoder.encodeUint256(block.chainid);

299: 		            bytes memory encodedNonce = RLPEncoder.encodeUint256(_transaction.nonce);

300: 		            bytes memory encodedMaxPriorityFeePerGas = RLPEncoder.encodeUint256(_transaction.maxPriorityFeePerGas);

301: 		            bytes memory encodedMaxFeePerGas = RLPEncoder.encodeUint256(_transaction.maxFeePerGas);

302: 		            bytes memory encodedGasLimit = RLPEncoder.encodeUint256(_transaction.gasLimit);

303: 		            bytes memory encodedTo = RLPEncoder.encodeAddress(address(uint160(_transaction.to)));

304: 		            bytes memory encodedValue = RLPEncoder.encodeUint256(_transaction.value);

324: 		                encodedDataLength = RLPEncoder.encodeNonSingleBytesLen(txDataLen);

333: 		        bytes memory encodedAccessListLength = RLPEncoder.encodeListLen(0);

343: 		            encodedListLength = RLPEncoder.encodeListLen(uint64(listLength));

366: 		        if (paymasterInputSelector == IPaymasterFlow.approvalBased.selector) {

385: 		        } else if (paymasterInputSelector == IPaymasterFlow.general.selector) {
```
[[132](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L132), [134](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L134), [155](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L155), [159](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L159), [160](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L160), [164](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L164), [165](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L165), [174](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L174), [185](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L185), [199](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L199), [228](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L228), [229](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L229), [230](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L230), [231](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L231), [232](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L232), [233](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L233), [252](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L252), [261](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L261), [271](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L271), [298](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L298), [299](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L299), [300](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L300), [301](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L301), [302](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L302), [303](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L303), [304](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L304), [324](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L324), [333](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L333), [343](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L343), [366](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L366), [385](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L385)]



```solidity
File: code/system-contracts/contracts/libraries/Utils.sol

90: 		            EfficientCall.sha(_bytecode) &
```
[[90](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L90)]



```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

79: 		        return L2ContractHelper.computeCreate2Address(l2Bridge, salt, l2TokenProxyBytecodeHash, constructorInputHash);
```
[[79](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L79)]



```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

250: 		        return abi.encodeCall(IL2Bridge.finalizeDeposit, (_l1Sender, _l2Receiver, _l1Token, _amount, gettersData));

262: 		        (, bytes memory data1) = _token.staticcall(abi.encodeCall(IERC20Metadata.name, ()));

263: 		        (, bytes memory data2) = _token.staticcall(abi.encodeCall(IERC20Metadata.symbol, ()));

264: 		        (, bytes memory data3) = _token.staticcall(abi.encodeCall(IERC20Metadata.decimals, ()));

323: 		                TxStatus.Failure

503: 		        (uint32 functionSignature, uint256 offset) = UnsafeBytes.readUint32(_l2ToL1message, 0);

504: 		        if (bytes4(functionSignature) == IMailbox.finalizeEthWithdrawal.selector) {

506: 		            (l1Receiver, offset) = UnsafeBytes.readAddress(_l2ToL1message, offset);

507: 		            (amount, offset) = UnsafeBytes.readUint256(_l2ToL1message, offset);

509: 		        } else if (bytes4(functionSignature) == IL1ERC20Bridge.finalizeWithdrawal.selector) {

518: 		            (l1Receiver, offset) = UnsafeBytes.readAddress(_l2ToL1message, offset);

519: 		            (l1Token, offset) = UnsafeBytes.readAddress(_l2ToL1message, offset);

520: 		            (amount, offset) = UnsafeBytes.readUint256(_l2ToL1message, offset);

580: 		                    ? AddressAliasHelper.applyL1ToL2Alias(_prevMsgSender)
```
[[250](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L250), [262](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L262), [263](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L263), [264](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L264), [323](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L323), [503](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L503), [504](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L504), [506](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L506), [507](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L507), [509](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L509), [518](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L518), [519](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L519), [520](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L520), [580](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L580)]



```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

328: 		            _recipient = msg.sender == tx.origin ? msg.sender : AddressAliasHelper.applyL1ToL2Alias(msg.sender);

331: 		            _recipient = AddressAliasHelper.applyL1ToL2Alias(_refundRecipient);
```
[[328](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L328), [331](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L331)]



```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

85: 		        return getOperationState(_id) != OperationState.Unset;

91: 		        return state == OperationState.Waiting || state == OperationState.Ready;

91: 		        return state == OperationState.Waiting || state == OperationState.Ready;

96: 		        return getOperationState(_id) == OperationState.Ready;

101: 		        return getOperationState(_id) == OperationState.Done;

108: 		            return OperationState.Unset;

110: 		            return OperationState.Done;

112: 		            return OperationState.Waiting;

114: 		            return OperationState.Ready;
```
[[85](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L85), [91](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L91), [91](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L91), [96](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L96), [101](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L101), [108](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L108), [110](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L110), [112](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L112), [114](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L114)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

90: 		        IExecutor.StoredBatchInfo memory batchZero = IExecutor.StoredBatchInfo(

178: 		        bytes memory systemContextCalldata = abi.encodeCall(ISystemContext.setChainId, (_chainId));

220: 		        Diamond.DiamondCutData memory cutData = Diamond.DiamondCutData({

223: 		            initCalldata: abi.encodeCall(IDefaultUpgrade.upgrade, (proposedUpgrade))

252: 		        Diamond.DiamondCutData memory diamondCut = abi.decode(_diamondCut, (Diamond.DiamondCutData));

262: 		            IDiamondInit.initialize.selector,
```
[[90](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L90), [178](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L178), [220](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L220), [223](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L223), [252](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L252), [262](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L262)]



```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol

97: 		        L2ContractHelper.validateBytecodeHash(_l2DefaultAccountBytecodeHash);

114: 		        L2ContractHelper.validateBytecodeHash(_l2BootloaderBytecodeHash);

194: 		        TransactionValidator.validateL1ToL2Transaction(

201: 		        TransactionValidator.validateUpgradeTransaction(_l2ProtocolUpgradeTx);

228: 		                L2ContractHelper.hashL2Bytecode(_factoryDeps[i]) == bytes32(_expectedHashes[i]),
```
[[97](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L97), [114](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L114), [194](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L194), [201](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L201), [228](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L228)]



```solidity
File: code/contracts/ethereum/contracts/upgrades/DefaultUpgrade.sol

15: 		        return Diamond.DIAMOND_INIT_SUCCESS_RETURN_VALUE;
```
[[15](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/DefaultUpgrade.sol#L15)]



```solidity
File: code/contracts/ethereum/contracts/upgrades/GenesisUpgrade.sol

16: 		        return Diamond.DIAMOND_INIT_SUCCESS_RETURN_VALUE;
```
[[16](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/GenesisUpgrade.sol#L16)]



```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

88: 		            AddressAliasHelper.undoL1ToL2Alias(msg.sender) == l1Bridge ||

89: 		                AddressAliasHelper.undoL1ToL2Alias(msg.sender) == l1LegacyBridge,

132: 		        L2ContractHelper.sendMessageToL1(message);

145: 		        return abi.encodePacked(IL1ERC20Bridge.finalizeWithdrawal.selector, _to, _l1Token, _amount);

153: 		            L2ContractHelper.computeCreate2Address(address(this), salt, l2TokenProxyBytecodeHash, constructorInputHash);

165: 		        (bool success, bytes memory returndata) = SystemContractsCaller.systemCallWithReturndata(

170: 		                IContractDeployer.create2,
```
[[88](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L88), [89](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L89), [132](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L132), [145](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L145), [153](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L153), [165](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L165), [170](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L170)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol

53: 		        return Diamond.DIAMOND_INIT_SUCCESS_RETURN_VALUE;
```
[[53](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol#L53)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol

15: 		        Diamond.diamondCut(_diamondCut);

21: 		        Diamond.DiamondStorage storage diamondStorage = Diamond.getDiamondStorage();
```
[[15](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol#L15), [21](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol#L21)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol

109: 		            if (action == Action.Add) {

111: 		            } else if (action == Action.Replace) {

113: 		            } else if (action == Action.Remove) {
```
[[109](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L109), [111](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L111), [113](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L113)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol

83: 		            costForComputation += Math.ceilDiv(_encodingLength * L1_TX_DELTA_544_ENCODING_BYTES, 544);

89: 		            costForComputation = Math.max(costForComputation, L1_TX_MIN_L2_GAS_BASE);

136: 		        batchOverheadForTransaction = Math.max(batchOverheadForTransaction, overheadForLength);
```
[[83](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L83), [89](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L89), [136](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L136)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol

114: 		        Diamond.diamondCut(_diamondCut);

124: 		        Diamond.diamondCut(_diamondCut);

134: 		        Diamond.DiamondStorage storage diamondStorage = Diamond.getDiamondStorage();

144: 		        Diamond.DiamondStorage storage diamondStorage = Diamond.getDiamondStorage();
```
[[114](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L114), [124](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L124), [134](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L134), [144](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L144)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

40: 		        require(pubdataSource == uint8(PubdataSource.Calldata) || pubdataSource == uint8(PubdataSource.Blob), "us");

40: 		        require(pubdataSource == uint8(PubdataSource.Calldata) || pubdataSource == uint8(PubdataSource.Blob), "us");

48: 		        if (s.feeParams.pubdataPricingMode == PubdataPricingMode.Validium) {

52: 		        } else if (pubdataSource == uint8(PubdataSource.Blob)) {

59: 		        } else if (pubdataSource == uint8(PubdataSource.Calldata)) {

144: 		            (address logSender, ) = UnsafeBytes.readAddress(emittedL2Logs, i + L2_LOG_ADDRESS_OFFSET);

145: 		            (uint256 logKey, ) = UnsafeBytes.readUint256(emittedL2Logs, i + L2_LOG_KEY_OFFSET);

146: 		            (bytes32 logValue, ) = UnsafeBytes.readBytes32(emittedL2Logs, i + L2_LOG_VALUE_OFFSET);

153: 		            if (logKey == uint256(SystemLogKey.L2_TO_L1_LOGS_TREE_ROOT_KEY)) {

156: 		            } else if (logKey == uint256(SystemLogKey.TOTAL_L2_TO_L1_PUBDATA_KEY)) {

159: 		            } else if (logKey == uint256(SystemLogKey.STATE_DIFF_HASH_KEY)) {

162: 		            } else if (logKey == uint256(SystemLogKey.PACKED_BATCH_AND_L2_BLOCK_TIMESTAMP_KEY)) {

165: 		            } else if (logKey == uint256(SystemLogKey.PREV_BATCH_HASH_KEY)) {

168: 		            } else if (logKey == uint256(SystemLogKey.CHAINED_PRIORITY_TXN_HASH_KEY)) {

171: 		            } else if (logKey == uint256(SystemLogKey.NUMBER_OF_LAYER_1_TXS_KEY)) {

174: 		            } else if (logKey == uint256(SystemLogKey.BLOB_ONE_HASH_KEY)) {

177: 		            } else if (logKey == uint256(SystemLogKey.BLOB_TWO_HASH_KEY)) {

180: 		            } else if (logKey == uint256(SystemLogKey.EXPECTED_SYSTEM_CONTRACT_UPGRADE_TX_HASH_KEY)) {

612: 		        (bool success, bytes memory data) = POINT_EVALUATION_PRECOMPILE_ADDR.staticcall(precompileInput);
```
[[40](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L40), [40](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L40), [48](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L48), [52](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L52), [59](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L59), [144](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L144), [145](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L145), [146](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L146), [153](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L153), [156](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L156), [159](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L159), [162](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L162), [165](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L165), [168](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L168), [171](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L171), [174](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L174), [177](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L177), [180](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L180), [612](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L612)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol

158: 		        Diamond.DiamondStorage storage ds = Diamond.getDiamondStorage();

164: 		        Diamond.DiamondStorage storage ds = Diamond.getDiamondStorage();

182: 		        Diamond.DiamondStorage storage ds = Diamond.getDiamondStorage();

203: 		        Diamond.DiamondStorage storage ds = Diamond.getDiamondStorage();

218: 		        Diamond.DiamondStorage storage ds = Diamond.getDiamondStorage();

224: 		        Diamond.DiamondStorage storage ds = Diamond.getDiamondStorage();

230: 		        Diamond.DiamondStorage storage ds = Diamond.getDiamondStorage();
```
[[158](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L158), [164](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L164), [182](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L182), [203](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L203), [218](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L218), [224](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L224), [230](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L230)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

123: 		        bytes32 calculatedRootHash = Merkle.calculateRoot(_proof, _index, hashedLog);

162: 		        if (feeParams.pubdataPricingMode == PubdataPricingMode.Rollup) {

174: 		        return Math.max(l2GasPrice, minL2GasPriceBaseToken);

235: 		            l2Sender = AddressAliasHelper.applyL1ToL2Alias(_request.sender);

278: 		            refundRecipient = AddressAliasHelper.applyL1ToL2Alias(refundRecipient);

325: 		        TransactionValidator.validateL1ToL2Transaction(

357: 		            bytes32 hashedBytecode = L2ContractHelper.hashL2Bytecode(_factoryDeps[i]);
```
[[123](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L123), [162](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L162), [174](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L174), [235](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L235), [278](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L278), [325](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L325), [357](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L357)]

</details>

---

### [N-28] Use EIP-5627 to describe EIP-712 domains

EIP-5267 is a standard which allows for the retrieval and description of EIP-712 hash domains. This enable external tools to allow users to view the fields and values that describe their domain.

This is especially useful when a project may exist on multiple chains and or in multiple contracts, and allows users/tools to verify that the signature is for the right fork, chain, version, contract, etc.

*There is 1 instance of this issue.*


```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

82: 		    bytes32 constant EIP712_DOMAIN_TYPEHASH = keccak256("EIP712Domain(string name,string version,uint256 chainId)");
```
[[82](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L82)]


---

### [N-29] Dependence on external protocols

External protocols should be monitored as such dependencies may introduce vulnerabilities if a vulnerability is found in the external protocol.

*There are 22 instances of this issue.*

<details>
<summary>Expand findings</summary>


```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

5: 		import "../openzeppelin/token/ERC20/IERC20.sol";

6: 		import "../openzeppelin/token/ERC20/utils/SafeERC20.sol";
```
[[5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L5), [6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L6)]



```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

5: 		import {IERC20} from "@openzeppelin/contracts/token/ERC20/IERC20.sol";

6: 		import {SafeERC20} from "@openzeppelin/contracts/token/ERC20/utils/SafeERC20.sol";
```
[[5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L5), [6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L6)]



```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

5: 		import {Initializable} from "@openzeppelin/contracts/proxy/utils/Initializable.sol";

6: 		import {Ownable2Step} from "@openzeppelin/contracts/access/Ownable2Step.sol";

8: 		import {IERC20Metadata} from "@openzeppelin/contracts/token/ERC20/extensions/IERC20Metadata.sol";

9: 		import {IERC20} from "@openzeppelin/contracts/token/ERC20/IERC20.sol";

10: 		import {SafeERC20} from "@openzeppelin/contracts/token/ERC20/utils/SafeERC20.sol";
```
[[5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L5), [6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L6), [8](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L8), [9](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L9), [10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L10)]



```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

5: 		import {Ownable2Step} from "@openzeppelin/contracts/access/Ownable2Step.sol";
```
[[5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L5)]



```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

5: 		import {Ownable2Step} from "@openzeppelin/contracts/access/Ownable2Step.sol";
```
[[5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L5)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

16: 		import {Ownable2Step} from "@openzeppelin/contracts/access/Ownable2Step.sol";
```
[[16](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L16)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

5: 		import {Ownable2Step} from "@openzeppelin/contracts/access/Ownable2Step.sol";
```
[[5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L5)]



```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

5: 		import {Initializable} from "@openzeppelin/contracts/proxy/utils/Initializable.sol";

6: 		import {BeaconProxy} from "@openzeppelin/contracts/proxy/beacon/BeaconProxy.sol";

7: 		import {UpgradeableBeacon} from "@openzeppelin/contracts/proxy/beacon/UpgradeableBeacon.sol";
```
[[5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L5), [6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L6), [7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L7)]



```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

5: 		import {ERC20PermitUpgradeable} from "@openzeppelin/contracts-upgradeable/token/ERC20/extensions/draft-ERC20PermitUpgradeable.sol";

6: 		import {UpgradeableBeacon} from "@openzeppelin/contracts/proxy/beacon/UpgradeableBeacon.sol";

7: 		import {ERC1967Upgrade} from "@openzeppelin/contracts/proxy/ERC1967/ERC1967Upgrade.sol";
```
[[5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L5), [6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L6), [7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L7)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol

5: 		import {SafeCast} from "@openzeppelin/contracts/utils/math/SafeCast.sol";
```
[[5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L5)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol

5: 		import {Math} from "@openzeppelin/contracts/utils/math/Math.sol";
```
[[5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L5)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

5: 		import {Math} from "@openzeppelin/contracts/utils/math/Math.sol";
```
[[5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L5)]

</details>

---

### [N-30] Use transfer libraries instead of low level calls

Consider using `SafeTransferLib.safeTransferETH` or `Address.sendValue` for clearer semantic meaning instead of using a low level `call`.

*There is 1 instance of this issue.*


```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

226: 		            (bool success, bytes memory returnData) = _calls[i].target.call{value: _calls[i].value}(_calls[i].data);
```
[[226](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L226)]


---

### [N-31] Possible reentrancy in modifiers placed before `nonReentrant`

It might be possible to reenter in other modifiers, as `nonReentrant` is not declared as the first one and the modifier execution is sequential.

*There are 2 instances of this issue.*


```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

554: 		    function depositLegacyErc20Bridge(
555: 		        address _prevMsgSender,
556: 		        address _l2Receiver,
557: 		        address _l1Token,
558: 		        uint256 _amount,
559: 		        uint256 _l2TxGasLimit,
560: 		        uint256 _l2TxGasPerPubdataByte,
561: 		        address _refundRecipient
562: 		    ) external payable override onlyLegacyBridge nonReentrant returns (bytes32 l2TxHash) {
```
[[554-562](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L554-L562)]



```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

114: 		    function createNewChain(
115: 		        uint256 _chainId,
116: 		        address _stateTransitionManager,
117: 		        address _baseToken,
118: 		        uint256, //_salt
119: 		        address _admin,
120: 		        bytes calldata _initData
121: 		    ) external onlyOwnerOrAdmin nonReentrant returns (uint256 chainId) {
```
[[114-121](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L114-L121)]


---

### [N-32] `2**<n> - 1` should be re-written as `type(uint<n>).max`

Earlier versions of solidity can use `uint<n>(-1)` instead. Expressions not including the `- 1` can often be re-written to accomodate the change (e.g. by using a `>` rather than a `>=`, which will also save some gas).

*There are 6 instances of this issue.*


```solidity
File: code/system-contracts/contracts/NonceHolder.sol

28: 		    uint256 private constant DEPLOY_NONCE_MULTIPLIER = 2 ** 128;

28: 		    uint256 private constant DEPLOY_NONCE_MULTIPLIER = 2 ** 128;

31: 		    uint256 private constant MAXIMAL_MIN_NONCE_INCREMENT = 2 ** 32;

31: 		    uint256 private constant MAXIMAL_MIN_NONCE_INCREMENT = 2 ** 32;
```
[[28](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/NonceHolder.sol#L28), [28](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/NonceHolder.sol#L28), [31](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/NonceHolder.sol#L31), [31](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/NonceHolder.sol#L31)]



```solidity
File: code/system-contracts/contracts/libraries/Utils.sol

87: 		        require(lengthInWords < 2 ** 16, "pp"); // bytecode length must be less than 2^16 words
```
[[87](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L87)]



```solidity
File: code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol

26: 		        require(bytecodeLenInWords < 2 ** 16, "pp"); // bytecode length must be less than 2^16 words
```
[[26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L26)]


---

### [N-33] Use of non-named numeric constants

Constants should be defined instead of using magic numbers.

*There are 181 instances of this issue.*

<details>
<summary>Expand findings</summary>


```solidity
File: code/system-contracts/contracts/AccountCodeStorage.sol

// @audit 0x00
102: 		        if (codeHash == 0x00 && NONCE_HOLDER_SYSTEM_CONTRACT.getRawNonce(account) > 0) {

// @audit 0x00
133: 		            codeHash != 0x00 &&
```
[[102](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L102), [133](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L133)]



```solidity
File: code/system-contracts/contracts/BootloaderUtilities.sol

// @audit 0x80
72: 		            } else if (_transaction.data[0] >= 0x80) {

// @audit 32
81: 		            uint256 rInt = uint256(bytes32(_transaction.signature[0:32]));

// @audit 32
86: 		            uint256 sInt = uint256(bytes32(_transaction.signature[32:64]));

// @audit 64
86: 		            uint256 sInt = uint256(bytes32(_transaction.signature[32:64]));

// @audit 64
91: 		            uint256 vInt = uint256(uint8(_transaction.signature[64]));

// @audit 27
92: 		            require(vInt == 27 || vInt == 28, "Invalid v value");

// @audit 28
92: 		            require(vInt == 27 || vInt == 28, "Invalid v value");

// @audit 8
97: 		                vInt += 8 + block.chainid * 2;

// @audit 0x80
168: 		            } else if (_transaction.data[0] >= 0x80) {

// @audit 32
180: 		            uint256 rInt = uint256(bytes32(_transaction.signature[0:32]));

// @audit 32
185: 		            uint256 sInt = uint256(bytes32(_transaction.signature[32:64]));

// @audit 64
185: 		            uint256 sInt = uint256(bytes32(_transaction.signature[32:64]));

// @audit 64
190: 		            uint256 vInt = uint256(uint8(_transaction.signature[64]));

// @audit 27
191: 		            require(vInt == 27 || vInt == 28, "Invalid v value");

// @audit 28
191: 		            require(vInt == 27 || vInt == 28, "Invalid v value");

// @audit 27
193: 		            vEncoded = RLPEncoder.encodeUint256(vInt - 27);

// @audit 0x80
263: 		            } else if (_transaction.data[0] >= 0x80) {

// @audit 32
275: 		            uint256 rInt = uint256(bytes32(_transaction.signature[0:32]));

// @audit 32
280: 		            uint256 sInt = uint256(bytes32(_transaction.signature[32:64]));

// @audit 64
280: 		            uint256 sInt = uint256(bytes32(_transaction.signature[32:64]));

// @audit 64
285: 		            uint256 vInt = uint256(uint8(_transaction.signature[64]));

// @audit 27
286: 		            require(vInt == 27 || vInt == 28, "Invalid v value");

// @audit 28
286: 		            require(vInt == 27 || vInt == 28, "Invalid v value");

// @audit 27
288: 		            vEncoded = RLPEncoder.encodeUint256(vInt - 27);
```
[[72](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L72), [81](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L81), [86](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L86), [86](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L86), [91](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L91), [92](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L92), [92](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L92), [97](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L97), [168](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L168), [180](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L180), [185](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L185), [185](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L185), [190](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L190), [191](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L191), [191](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L191), [193](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L193), [263](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L263), [275](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L275), [280](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L280), [280](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L280), [285](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L285), [286](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L286), [286](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L286), [288](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L288)]



```solidity
File: code/system-contracts/contracts/Compressor.sol

// @audit 4
52: 		                encodedData.length * 4 == _bytecode.length,

// @audit 8
57: 		                dictionary.length / 8 <= encodedData.length / 2,

// @audit 8
62: 		                uint256 indexOfEncodedChunk = uint256(encodedData.readUint16(encodedDataPointer)) * 8;

// @audit 4
66: 		                uint64 realChunk = _bytecode.readUint64(encodedDataPointer * 4);

// @audit 84
129: 		            uint64 enumIndex = stateDiff.readUint64(84);

// @audit 52
137: 		            bytes32 derivedKey = stateDiff.readBytes32(52);

// @audit 92
138: 		            uint256 initValue = stateDiff.readUint256(92);

// @audit 124
139: 		            uint256 finalValue = stateDiff.readUint256(124);

// @audit 32
141: 		            stateDiffPtr += 32;

// @audit 32
146: 		            uint8 len = operation == 0 ? 32 : metadata >> LENGTH_BITS_OFFSET;

// @audit 84
161: 		            uint64 enumIndex = stateDiff.readUint64(84);

// @audit 92
166: 		            uint256 initValue = stateDiff.readUint256(92);

// @audit 124
167: 		            uint256 finalValue = stateDiff.readUint256(124);

// @audit 32
177: 		            uint8 len = operation == 0 ? 32 : metadata >> LENGTH_BITS_OFFSET;

// @audit 8
203: 		            dictionary = _rawCompressedData[2:2 + dictionaryLen * 8];

// @audit 8
204: 		            encodedData = _rawCompressedData[2 + dictionaryLen * 8:];

// @audit 3
229: 		            if (_operation == 0 || _operation == 3) {

// @audit 256
253: 		        number >>= (256 - (_calldataSlice.length * 8));

// @audit 8
253: 		        number >>= (256 - (_calldataSlice.length * 8));
```
[[52](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L52), [57](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L57), [62](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L62), [66](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L66), [129](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L129), [137](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L137), [138](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L138), [139](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L139), [141](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L141), [146](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L146), [161](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L161), [166](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L166), [167](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L167), [177](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L177), [203](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L203), [204](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L204), [229](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L229), [253](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L253), [253](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L253)]



```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

// @audit 0x0
264: 		        require(_bytecodeHash != bytes32(0x0), "BytecodeHash cannot be zero");

// @audit 0x0
269: 		            ACCOUNT_CODE_STORAGE_SYSTEM_CONTRACT.getCodeHash(uint256(uint160(_newAddress))) == 0x0,

// @audit 0x00
273: 		        require(NONCE_HOLDER_SYSTEM_CONTRACT.getRawNonce(_newAddress) == 0x00, "Account is occupied");
```
[[264](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L264), [269](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L269), [273](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L273)]



```solidity
File: code/system-contracts/contracts/DefaultAccount.sol

// @audit 4
139: 		        if (to == address(DEPLOYER_SYSTEM_CONTRACT) && data.length >= 4) {

// @audit 4
140: 		            bytes4 selector = bytes4(data[:4]);

// @audit 65
160: 		        require(_signature.length == 65, "Signature length is incorrect");

// @audit 27
173: 		        require(v == 27 || v == 28, "v is neither 27 nor 28");

// @audit 28
173: 		        require(v == 27 || v == 28, "v is neither 27 nor 28");

// @audit 0x7FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF5D576E7357A4501DDFE92F46681B20A0
184: 		        require(uint256(s) <= 0x7FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF5D576E7357A4501DDFE92F46681B20A0, "Invalid s");
```
[[139](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L139), [140](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L140), [160](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L160), [173](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L173), [173](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L173), [184](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L184)]



```solidity
File: code/system-contracts/contracts/L1Messenger.sol

// @audit 8
62: 		        return SHA256_ROUND_GAS_COST * ((_length + 8) / SHA256_ROUND_NUMBER_OF_BYTES + 1);

// @audit 64
89: 		        uint256 gasToPay = keccakGasCost(L2_TO_L1_LOG_SERIALIZE_SIZE) + 2 * keccakGasCost(64);

// @audit 4
140: 		            pubdataLen = 4 + _message.length + L2_TO_L1_LOG_SERIALIZE_SIZE;

// @audit 3
149: 		            3 *

// @audit 64
150: 		            keccakGasCost(64) +

// @audit 4
171: 		            pubdataLen = 4 + bytecodeLen;

// @audit 64
176: 		            keccakGasCost(64) +

// @audit 4
200: 		        uint32 numberOfL2ToL1Logs = uint32(bytes4(_totalL2ToL1PubdataAndStateDiffs[calldataPtr:calldataPtr + 4]));

// @audit 4
202: 		        calldataPtr += 4;

// @audit 4
233: 		        uint32 numberOfMessages = uint32(bytes4(_totalL2ToL1PubdataAndStateDiffs[calldataPtr:calldataPtr + 4]));

// @audit 4
234: 		        calldataPtr += 4;

// @audit 4
237: 		            uint32 currentMessageLength = uint32(bytes4(_totalL2ToL1PubdataAndStateDiffs[calldataPtr:calldataPtr + 4]));

// @audit 4
238: 		            calldataPtr += 4;

// @audit 4
251: 		        uint32 numberOfBytecodes = uint32(bytes4(_totalL2ToL1PubdataAndStateDiffs[calldataPtr:calldataPtr + 4]));

// @audit 4
252: 		        calldataPtr += 4;

// @audit 4
256: 		                bytes4(_totalL2ToL1PubdataAndStateDiffs[calldataPtr:calldataPtr + 4])

// @audit 4
258: 		            calldataPtr += 4;

// @audit 3
286: 		        uint24 compressedStateDiffSize = uint24(bytes3(_totalL2ToL1PubdataAndStateDiffs[calldataPtr:calldataPtr + 3]));

// @audit 3
287: 		        calldataPtr += 3;

// @audit 4
300: 		        uint32 numberOfStateDiffs = uint32(bytes4(_totalL2ToL1PubdataAndStateDiffs[calldataPtr:calldataPtr + 4]));

// @audit 4
301: 		        calldataPtr += 4;
```
[[62](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L62), [89](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L89), [140](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L140), [149](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L149), [150](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L150), [171](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L171), [176](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L176), [200](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L200), [202](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L202), [233](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L233), [234](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L234), [237](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L237), [238](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L238), [251](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L251), [252](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L252), [256](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L256), [258](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L258), [286](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L286), [287](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L287), [300](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L300), [301](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L301)]



```solidity
File: code/system-contracts/contracts/L2BaseToken.sol

// @audit 18
141: 		        return 18;
```
[[141](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L2BaseToken.sol#L141)]



```solidity
File: code/system-contracts/contracts/SystemContext.sol

// @audit 256
144: 		        if (blockNumber <= _block || blockNumber - _block > 256) {

// @audit 128
416: 		        uint256 packedTimestamps = (uint256(currentBatchTimestamp) << 128) | currentL2BlockTimestamp;

// @audit 128
498: 		        blockInfo = (uint256(blockNumber) << 128) | uint256(blockTimestamp);
```
[[144](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L144), [416](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L416), [498](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L498)]



```solidity
File: code/contracts/zksync/contracts/SystemContractsCaller.sol

// @audit 32
116: 		        farCallAbi |= (uint256(memoryPage) << 32);

// @audit 64
117: 		        farCallAbi |= (uint256(dataStart) << 64);

// @audit 96
118: 		        farCallAbi |= (uint256(dataLength) << 96);

// @audit 192
128: 		        farCallAbiWithEmptyFatPtr |= (uint256(gasPassed) << 192);

// @audit 224
129: 		        farCallAbiWithEmptyFatPtr |= (uint256(forwardingMode) << 224);

// @audit 232
130: 		        farCallAbiWithEmptyFatPtr |= (uint256(shardId) << 232);

// @audit 240
132: 		            farCallAbiWithEmptyFatPtr |= (1 << 240);

// @audit 248
135: 		            farCallAbiWithEmptyFatPtr |= (1 << 248);
```
[[116](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/SystemContractsCaller.sol#L116), [117](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/SystemContractsCaller.sol#L117), [118](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/SystemContractsCaller.sol#L118), [128](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/SystemContractsCaller.sol#L128), [129](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/SystemContractsCaller.sol#L129), [130](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/SystemContractsCaller.sol#L130), [132](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/SystemContractsCaller.sol#L132), [135](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/SystemContractsCaller.sol#L135)]



```solidity
File: code/system-contracts/contracts/libraries/EfficientCall.sol

// @audit 32
38: 		        require(returnData.length == 32, "keccak256 returned invalid data");

// @audit 32
47: 		        require(returnData.length == 32, "sha returned invalid data");
```
[[38](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L38), [47](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L47)]



```solidity
File: code/system-contracts/contracts/libraries/RLPEncoder.sol

// @audit 0x15
13: 		        encoded = new bytes(0x15);

// @audit 128
26: 		            if (_val < 128) {

// @audit 128
29: 		                encoded[0] = (_val == 0) ? bytes1(uint8(128)) : bytes1(uint8(_val));

// @audit 0x81
34: 		                encoded[0] = bytes1(uint8(hbs + 0x81));

// @audit 31
36: 		                uint256 lbs = 31 - hbs;

// @audit 8
37: 		                uint256 shiftedVal = _val << (lbs * 8);

// @audit 0x80
51: 		        return _encodeLength(_len, 0x80);

// @audit 0xc0
57: 		        return _encodeLength(_len, 0xc0);

// @audit 56
62: 		            if (_len < 56) {

// @audit 56
69: 		                encoded[0] = bytes1(uint8(_offset + hbs + 56));

// @audit 31
71: 		                uint256 lbs = 31 - hbs;

// @audit 8
72: 		                uint256 shiftedVal = uint256(_len) << (lbs * 8);

// @audit 128
87: 		                _number >>= 128;

// @audit 16
88: 		                hbs += 16;

// @audit 64
91: 		                _number >>= 64;

// @audit 8
92: 		                hbs += 8;

// @audit 32
95: 		                _number >>= 32;

// @audit 4
96: 		                hbs += 4;

// @audit 16
99: 		                _number >>= 16;
```
[[13](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/RLPEncoder.sol#L13), [26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/RLPEncoder.sol#L26), [29](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/RLPEncoder.sol#L29), [34](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/RLPEncoder.sol#L34), [36](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/RLPEncoder.sol#L36), [37](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/RLPEncoder.sol#L37), [51](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/RLPEncoder.sol#L51), [57](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/RLPEncoder.sol#L57), [62](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/RLPEncoder.sol#L62), [69](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/RLPEncoder.sol#L69), [71](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/RLPEncoder.sol#L71), [72](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/RLPEncoder.sol#L72), [87](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/RLPEncoder.sol#L87), [88](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/RLPEncoder.sol#L88), [91](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/RLPEncoder.sol#L91), [92](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/RLPEncoder.sol#L92), [95](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/RLPEncoder.sol#L95), [96](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/RLPEncoder.sol#L96), [99](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/RLPEncoder.sol#L99)]



```solidity
File: code/system-contracts/contracts/libraries/SystemContractHelper.sol

// @audit 32
132: 		        rawParams |= uint256(_inputMemoryLength) << 32;

// @audit 64
133: 		        rawParams |= uint256(_outputMemoryOffset) << 64;

// @audit 96
134: 		        rawParams |= uint256(_outputMemoryLength) << 96;

// @audit 192
135: 		        rawParams |= uint256(_perPrecompileInterpreted) << 192;

// @audit 32
155: 		        uint256 params = uint256(_gasToBurn) + (uint256(_pubdataToSpend) << 32);

// @audit 256
217: 		        uint256 shifted = (meta << (256 - size - offset));

// @audit 256
219: 		        result = (shifted >> (256 - size));

// @audit 32
228: 		        pubdataPublished = uint32(extractNumberFromMeta(meta, META_GAS_PER_PUBDATA_BYTE_OFFSET, 32));

// @audit 32
238: 		        heapSize = uint32(extractNumberFromMeta(meta, META_HEAP_SIZE_OFFSET, 32));

// @audit 32
247: 		        auxHeapSize = uint32(extractNumberFromMeta(meta, META_AUX_HEAP_SIZE_OFFSET, 32));

// @audit 8
255: 		        shardId = uint8(extractNumberFromMeta(meta, META_SHARD_ID_OFFSET, 8));

// @audit 8
264: 		        callerShardId = uint8(extractNumberFromMeta(meta, META_CALLER_SHARD_ID_OFFSET, 8));

// @audit 8
273: 		        codeShardId = uint8(extractNumberFromMeta(meta, META_CODE_SHARD_ID_OFFSET, 8));

// @audit 10
319: 		        require(index < 10, "There are only 10 accessible registers");
```
[[132](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L132), [133](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L133), [134](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L134), [135](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L135), [155](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L155), [217](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L217), [219](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L219), [228](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L228), [238](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L238), [247](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L247), [255](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L255), [264](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L264), [273](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L273), [319](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L319)]



```solidity
File: code/system-contracts/contracts/libraries/SystemContractsCaller.sol

// @audit 32
235: 		        farCallAbi |= (uint256(memoryPage) << 32);

// @audit 64
236: 		        farCallAbi |= (uint256(dataStart) << 64);

// @audit 96
237: 		        farCallAbi |= (uint256(dataLength) << 96);

// @audit 192
257: 		        farCallAbiWithEmptyFatPtr |= (uint256(gasPassed) << 192);

// @audit 224
258: 		        farCallAbiWithEmptyFatPtr |= (uint256(forwardingMode) << 224);

// @audit 232
259: 		        farCallAbiWithEmptyFatPtr |= (uint256(shardId) << 232);

// @audit 240
261: 		            farCallAbiWithEmptyFatPtr |= (1 << 240);

// @audit 248
264: 		            farCallAbiWithEmptyFatPtr |= (1 << 248);
```
[[235](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L235), [236](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L236), [237](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L237), [257](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L257), [258](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L258), [259](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L259), [261](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L261), [264](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L264)]



```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

// @audit 0x80
175: 		            } else if (_transaction.data[0] >= 0x80) {

// @audit 0x80
253: 		            } else if (_transaction.data[0] >= 0x80) {

// @audit 0x80
325: 		            } else if (_transaction.data[0] >= 0x80) {

// @audit 4
363: 		        require(_transaction.paymasterInput.length >= 4, "The standard paymaster input must be at least 4 bytes long");

// @audit 4
365: 		        bytes4 paymasterInputSelector = bytes4(_transaction.paymasterInput[0:4]);

// @audit 68
368: 		                _transaction.paymasterInput.length >= 68,

// @audit 4
374: 		            (address token, uint256 minAllowance) = abi.decode(_transaction.paymasterInput[4:68], (address, uint256));

// @audit 68
374: 		            (address token, uint256 minAllowance) = abi.decode(_transaction.paymasterInput[4:68], (address, uint256));
```
[[175](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L175), [253](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L253), [325](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L325), [363](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L363), [365](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L365), [368](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L368), [374](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L374), [374](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L374)]



```solidity
File: code/system-contracts/contracts/libraries/Utils.sol

// @audit 5
40: 		        codeLength = bytecodeLenInWords(_bytecodeHash) << 5; // _bytecodeHash * 32

// @audit 256
46: 		            codeLengthInWords = uint256(uint8(_bytecodeHash[2])) * 256 + uint256(uint8(_bytecodeHash[3]));

// @audit 3
46: 		            codeLengthInWords = uint256(uint8(_bytecodeHash[2])) * 256 + uint256(uint8(_bytecodeHash[3]));

// @audit 0x00
52: 		        return _bytecodeHash[1] == 0x00;

// @audit 0x01
57: 		        return _bytecodeHash[1] == 0x01;

// @audit 32
84: 		        require(_bytecode.length % 32 == 0, "po");

// @audit 32
86: 		        uint256 lengthInWords = _bytecode.length / 32;

// @audit 16
87: 		        require(lengthInWords < 2 ** 16, "pp"); // bytecode length must be less than 2^16 words

// @audit 0x00000000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF
91: 		            0x00000000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF;

// @audit 248
93: 		        hashedBytecode = (hashedBytecode | bytes32(uint256(1 << 248)));

// @audit 224
95: 		        hashedBytecode = hashedBytecode | bytes32(lengthInWords << 224);
```
[[40](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L40), [46](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L46), [46](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L46), [52](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L52), [57](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L57), [84](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L84), [86](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L86), [87](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L87), [91](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L91), [93](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L93), [95](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L95)]



```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

// @audit 0x00
237: 		        require(depositHappened[_chainId][_txHash] == 0x00, "ShB tx hap");

// @audit 18
258: 		            bytes memory decimals = abi.encode(uint8(18));

// @audit 56
501: 		        require(_l2ToL1message.length >= 56, "ShB wrong msg len"); // wrong messsage length

// @audit 76
517: 		            require(_l2ToL1message.length == 76, "ShB wrong msg len 2");
```
[[237](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L237), [258](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L258), [501](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L501), [517](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L517)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

// @audit 32
106: 		        assert(L2_TO_L1_LOG_SERIALIZE_SIZE != 2 * 32);
```
[[106](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L106)]



```solidity
File: code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol

// @audit 32
23: 		        require(_bytecode.length % 32 == 0, "pq");

// @audit 32
25: 		        uint256 bytecodeLenInWords = _bytecode.length / 32;

// @audit 16
26: 		        require(bytecodeLenInWords < 2 ** 16, "pp"); // bytecode length must be less than 2^16 words

// @audit 0x00000000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF
28: 		        hashedBytecode = sha256(_bytecode) & 0x00000000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF;

// @audit 248
30: 		        hashedBytecode = (hashedBytecode | bytes32(uint256(1 << 248)));

// @audit 224
32: 		        hashedBytecode = hashedBytecode | bytes32(bytecodeLenInWords << 224);

// @audit 256
50: 		        codeLengthInWords = uint256(uint8(_bytecodeHash[2])) * 256 + uint256(uint8(_bytecodeHash[3]));

// @audit 3
50: 		        codeLengthInWords = uint256(uint8(_bytecodeHash[2])) * 256 + uint256(uint8(_bytecodeHash[3]));
```
[[23](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L23), [25](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L25), [26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L26), [28](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L28), [30](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L30), [32](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L32), [50](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L50), [50](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L50)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol

// @audit 32
51: 		        assert(L2_TO_L1_LOG_SERIALIZE_SIZE != 2 * 32);
```
[[51](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol#L51)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol

// @audit 4
25: 		        require(msg.data.length >= 4 || msg.data.length == 0, "Ut");
```
[[25](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol#L25)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol

// @audit 4
286: 		                if (data.length <= 4) {

// @audit 32
297: 		            require(data.length == 32, "lp");
```
[[286](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L286), [297](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L297)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/LibMap.sol

// @audit 8
23: 		            uint256 mapValue = _map.map[_index / 8];

// @audit 7
27: 		            uint256 bitOffset = (_index & 7) * 32;

// @audit 32
27: 		            uint256 bitOffset = (_index & 7) * 32;

// @audit 8
43: 		            uint256 mapIndex = _index / 8;

// @audit 7
48: 		            uint256 bitOffset = (_index & 7) * 32;

// @audit 32
48: 		            uint256 bitOffset = (_index & 7) * 32;
```
[[23](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/LibMap.sol#L23), [27](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/LibMap.sol#L27), [27](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/LibMap.sol#L27), [43](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/LibMap.sol#L43), [48](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/LibMap.sol#L48), [48](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/LibMap.sol#L48)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol

// @audit 256
25: 		        require(pathLength < 256, "bt");
```
[[25](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol#L25)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol

// @audit 3
57: 		        require(_transaction.reserved[3] == 0, "uo");

// @audit 544
83: 		            costForComputation += Math.ceilDiv(_encodingLength * L1_TX_DELTA_544_ENCODING_BYTES, 544);
```
[[57](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L57), [83](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L83)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

// @audit 0x00
50: 		            require(logOutput.pubdataHash == 0x00, "v0h");

// @audit 32
63: 		                    keccak256(_newBatch.pubdataCommitments[1:_newBatch.pubdataCommitments.length - 32]),

// @audit 32
68: 		                _newBatch.pubdataCommitments[_newBatch.pubdataCommitments.length - 32:_newBatch

// @audit 128
109: 		        uint256 batchTimestamp = _packedBatchAndL2BlockTimestamp >> 128;

// @audit 511
192: 		            require(processedLogs == 511, "b7");

// @audit 1023
194: 		            require(processedLogs == 1023, "b8");
```
[[50](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L50), [63](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L63), [68](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L68), [109](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L109), [192](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L192), [194](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L194)]

</details>

---

### [N-34] Control structures do not comply with best practices

This is a [best practice](https://docs.soliditylang.org/en/latest/style-guide.html#control-structures) that should be followed. 

*There are 7 instances of this issue.*


```solidity
File: code/system-contracts/contracts/AccountCodeStorage.sol

131: 		        if (
```
[[131](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L131)]



```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

47: 		        if (
```
[[47](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L47)]



```solidity
File: code/system-contracts/contracts/SystemContext.sol

150: 		        } else if (
```
[[150](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L150)]



```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol

147: 		        if (
```
[[147](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L147)]



```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

161: 		        if (availableGetters.ignoreName) revert();

167: 		        if (availableGetters.ignoreSymbol) revert();

173: 		        if (availableGetters.ignoreDecimals) revert();
```
[[161](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L161), [167](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L167), [173](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L173)]


---

### [N-35] Use a single file for system wide constants

Consider grouping all the system constants under a single file. This finding shows only the first constant for each file, for brevity.

*There are 31 instances of this issue.*

<details>
<summary>Expand findings</summary>


```solidity
File: code/system-contracts/contracts/AccountCodeStorage.sol

23: 		    bytes32 constant EMPTY_STRING_KECCAK = 0xc5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470;
```
[[23](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L23)]



```solidity
File: code/system-contracts/contracts/GasBoundCaller.sol

18: 		    uint256 constant CALL_ENTRY_OVERHEAD = 800;
```
[[18](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/GasBoundCaller.sol#L18)]



```solidity
File: code/system-contracts/contracts/L1Messenger.sol

44: 		    uint256 internal constant KECCAK_ROUND_GAS_COST = 40;
```
[[44](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L44)]



```solidity
File: code/system-contracts/contracts/MsgValueSimulator.sol

36: 		    uint256 constant GAS_TO_PASS = 2300;
```
[[36](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/MsgValueSimulator.sol#L36)]



```solidity
File: code/system-contracts/contracts/NonceHolder.sol

28: 		    uint256 private constant DEPLOY_NONCE_MULTIPLIER = 2 ** 128;
```
[[28](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/NonceHolder.sol#L28)]



```solidity
File: code/system-contracts/contracts/SystemContext.sol

23: 		    uint256 internal constant MINIBLOCK_HASHES_TO_STORE = 257;
```
[[23](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L23)]



```solidity
File: code/contracts/zksync/contracts/L2ContractHelper.sol

68: 		uint160 constant SYSTEM_CONTRACTS_OFFSET = 0x8000; // 2^15
```
[[68](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/L2ContractHelper.sol#L68)]



```solidity
File: code/contracts/zksync/contracts/SystemContractsCaller.sol

7: 		address constant SYSTEM_CALL_CALL_ADDRESS = address((1 << 16) - 11);
```
[[7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/SystemContractsCaller.sol#L7)]



```solidity
File: code/system-contracts/contracts/interfaces/IAccount.sol

7: 		bytes4 constant ACCOUNT_VALIDATION_SUCCESS_MAGIC = IAccount.validateTransaction.selector;
```
[[7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IAccount.sol#L7)]



```solidity
File: code/system-contracts/contracts/interfaces/ICompressor.sol

6: 		uint8 constant OPERATION_BITMASK = 7;
```
[[6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ICompressor.sol#L6)]



```solidity
File: code/system-contracts/contracts/interfaces/IL1Messenger.sol

25: 		uint256 constant L2_TO_L1_LOG_SERIALIZE_SIZE = 88;
```
[[25](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL1Messenger.sol#L25)]



```solidity
File: code/system-contracts/contracts/interfaces/IPaymaster.sol

12: 		bytes4 constant PAYMASTER_VALIDATION_SUCCESS_MAGIC = IPaymaster.validateAndPayForPaymasterTransaction.selector;
```
[[12](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IPaymaster.sol#L12)]



```solidity
File: code/system-contracts/contracts/libraries/SystemContractHelper.sol

9: 		uint256 constant UINT32_MASK = type(uint32).max;
```
[[9](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L9)]



```solidity
File: code/system-contracts/contracts/libraries/SystemContractsCaller.sol

12: 		address constant TO_L1_CALL_ADDRESS = address((1 << 16) - 1);
```
[[12](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L12)]



```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

15: 		uint8 constant EIP_712_TX_TYPE = 0x71;
```
[[15](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L15)]



```solidity
File: code/system-contracts/contracts/libraries/Utils.sol

13: 		    bytes32 constant IS_CONSTRUCTOR_BYTECODE_HASH_BIT_MASK =
14: 		        0x00ff000000000000000000000000000000000000000000000000000000000000;
```
[[13-14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L13-L14)]



```solidity
File: code/contracts/ethereum/contracts/common/Config.sol

6: 		bytes32 constant EMPTY_STRING_KECCAK = 0xc5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470;
```
[[6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/Config.sol#L6)]



```solidity
File: code/contracts/ethereum/contracts/common/L2ContractAddresses.sol

6: 		address constant L2_BOOTLOADER_ADDRESS = address(0x8001);
```
[[6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/L2ContractAddresses.sol#L6)]



```solidity
File: code/contracts/ethereum/contracts/common/ReentrancyGuard.sol

29: 		    uint256 private constant LOCK_FLAG_ADDRESS = 0x8e94fed44239eb2314ab7a406345e6c5a8f0ccedf3b600de3d004e672c33abf4;
```
[[29](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/ReentrancyGuard.sol#L29)]



```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

22: 		    uint256 internal constant EXECUTED_PROPOSAL_TIMESTAMP = uint256(1);
```
[[22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L22)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

26: 		    string public constant override getName = "ValidatorTimelock";
```
[[26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L26)]



```solidity
File: code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol

22: 		    uint160 constant offset = uint160(0x1111000000000000000000000000000000001111);
```
[[22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol#L22)]



```solidity
File: code/contracts/zksync/contracts/interfaces/IPaymaster.sol

12: 		bytes4 constant PAYMASTER_VALIDATION_SUCCESS_MAGIC = IPaymaster.validateAndPayForPaymasterTransaction.selector;
```
[[12](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/interfaces/IPaymaster.sol#L12)]



```solidity
File: code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol

22: 		    uint160 constant offset = uint160(0x1111000000000000000000000000000000001111);
```
[[22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol#L22)]



```solidity
File: code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol

12: 		    bytes32 private constant CREATE2_PREFIX = keccak256("zksyncCreate2");
```
[[12](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L12)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol

40: 		uint256 constant L2_LOG_ADDRESS_OFFSET = 4;
```
[[40](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L40)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol

17: 		    bytes32 internal constant DIAMOND_INIT_SUCCESS_RETURN_VALUE =
18: 		        0x33774e659306e47509050e97cb651e731180a42d458212294d30751925c551a2; // keccak256("diamond.zksync.init") - 1
```
[[17-18](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L17-L18)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol

20: 		    string public constant override getName = "AdminFacet";
```
[[20](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L20)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

27: 		    string public constant override getName = "ExecutorFacet";
```
[[27](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L27)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol

25: 		    string public constant override getName = "GettersFacet";
```
[[25](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L25)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

35: 		    string public constant override getName = "MailboxFacet";
```
[[35](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L35)]

</details>

---

### [N-36] Some events are never emitted

The following events are never emitted, consider to remove them.

*There are 3 instances of this issue.*


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol

134: 		    event EthWithdrawalFinalized(address indexed to, uint256 amount);
```
[[134](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L134)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol

17: 		    event ProposeTransparentUpgrade(
18: 		        Diamond.DiamondCutData diamondCut,
19: 		        uint256 indexed proposalId,
20: 		        bytes32 proposalSalt
21: 		    );
```
[[17-21](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol#L17-L21)]



```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol

22: 		    event BaseTokenReceived(uint256 amount);
```
[[22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol#L22)]


---

### [N-37] Event does not have proper `indexed` fields

Index event fields make the field more quickly accessible to off-chain tools that parse events. However, note that each index field costs extra gas during emission, so it's not necessarily best to index the maximum allowed per event (three fields).

Each event should use three `indexed` fields if there are three or more fields, and gas usage is not particularly of concern for the events in question. If there are fewer than three fields, all of the fields should be indexed.

*There are 11 instances of this issue.*

<details>
<summary>Expand findings</summary>


```solidity
File: code/system-contracts/contracts/interfaces/IBaseToken.sol

// @audit _additionalData
30: 		    event WithdrawalWithMessage(
31: 		        address indexed _l2Sender,
32: 		        address indexed _l1Receiver,
33: 		        uint256 _amount,
34: 		        bytes _additionalData
35: 		    );
```
[[30-35](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBaseToken.sol#L30-L35)]



```solidity
File: code/system-contracts/contracts/interfaces/IL1Messenger.sol

// @audit _message
43: 		    event L1MessageSent(address indexed _sender, bytes32 indexed _hash, bytes _message);

// @audit _bytecodeHash
47: 		    event BytecodeL1PublicationRequested(bytes32 _bytecodeHash);
```
[[43](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL1Messenger.sol#L43), [47](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL1Messenger.sol#L47)]



```solidity
File: code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol

// @audit stateTransitionManager
133: 		    event NewChain(uint256 indexed chainId, address stateTransitionManager, address indexed chainGovernance);
```
[[133](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L133)]



```solidity
File: code/contracts/ethereum/contracts/governance/IGovernance.sol

// @audit _securityCouncilBefore, _securityCouncilAfter
77: 		    event ChangeSecurityCouncil(address _securityCouncilBefore, address _securityCouncilAfter);
```
[[77](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L77)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

// @audit _addedValidator
32: 		    event ValidatorAdded(uint256 _chainId, address _addedValidator);

// @audit _removedValidator
35: 		    event ValidatorRemoved(uint256 _chainId, address _removedValidator);
```
[[32](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L32), [35](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L35)]



```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol

// @audit l1Token
31: 		    event BridgehubDepositBaseTokenInitiated(
32: 		        uint256 indexed chainId,
33: 		        address indexed from,
34: 		        address l1Token,
35: 		        uint256 amount
36: 		    );
```
[[31-36](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L31-L36)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol

// @audit txHash
123: 		    event NewPriorityRequest(
124: 		        uint256 txId,
125: 		        bytes32 txHash,
126: 		        uint64 expirationTimestamp,
127: 		        L2CanonicalTransaction transaction,
128: 		        bytes[] factoryDeps
129: 		    );
```
[[123-129](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L123-L129)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol

// @audit proposalSalt
17: 		    event ProposeTransparentUpgrade(
18: 		        Diamond.DiamondCutData diamondCut,
19: 		        uint256 indexed proposalId,
20: 		        bytes32 proposalSalt
21: 		    );
```
[[17-21](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol#L17-L21)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol

// @audit initAddress, initCalldata
24: 		    event DiamondCut(FacetCut[] facetCuts, address initAddress, bytes initCalldata);
```
[[24](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L24)]

</details>

---

### [N-38] Old Solidity version

Use a more recent version of Solidity: the latest version is 0.8.24, but it's safer to use at least the version 0.8.19 to get the latest bugfixes and features when deploying on L2.

*There is 1 instance of this issue.*


```solidity
File: code/contracts/ethereum/contracts/state-transition/l2-deps/ISystemContext.sol

2: 		pragma solidity ^0.8.0;
```
[[2](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/l2-deps/ISystemContext.sol#L2)]


---

### [N-39] Use of floating pragma

Locking the pragma helps avoid accidental deploys with an outdated compiler version that may introduce bugs and unexpected vulnerabilities.

Floating pragma is meant to be used for libraries and contracts that have external users and need backward compatibility.

*There is 1 instance of this issue.*


```solidity
File: code/contracts/ethereum/contracts/state-transition/l2-deps/ISystemContext.sol

2: 		pragma solidity ^0.8.0;
```
[[2](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/l2-deps/ISystemContext.sol#L2)]


---

### [N-40] No checks for empty bytes

Like the zero-address check, an empty bytes assignment might be undesiderable, but the following functions don't have it.

*There are 16 instances of this issue.*

<details>
<summary>Expand findings</summary>


```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

// @audit _bytecodeHash, _salt, _input
95: 		    function getNewAddressCreate2(
96: 		        address _sender,
97: 		        bytes32 _bytecodeHash,
98: 		        bytes32 _salt,
99: 		        bytes calldata _input
```
[[95-99](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L95-L99)]



```solidity
File: code/system-contracts/contracts/KnownCodesStorage.sol

// @audit _hash
65: 		    function getMarker(bytes32 _hash) public view override returns (uint256 marker) {
```
[[65](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/KnownCodesStorage.sol#L65)]



```solidity
File: code/system-contracts/contracts/L2BaseToken.sol

// @audit _additionalData
117: 		    function _getExtendedWithdrawMessage(
118: 		        address _to,
119: 		        uint256 _amount,
120: 		        address _sender,
121: 		        bytes memory _additionalData
```
[[117-121](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L2BaseToken.sol#L117-L121)]



```solidity
File: code/system-contracts/contracts/SystemContext.sol

// @audit _hash
212: 		    function _setL2BlockHash(uint256 _block, bytes32 _hash) internal {

// @audit _prevL2BlockHash
314: 		    function _setNewL2BlockData(uint128 _l2BlockNumber, uint128 _l2BlockTimestamp, bytes32 _prevL2BlockHash) internal {

// @audit _expectedPrevL2BlockHash
341: 		    function setL2Block(
342: 		        uint128 _l2BlockNumber,
343: 		        uint128 _l2BlockTimestamp,
344: 		        bytes32 _expectedPrevL2BlockHash,
345: 		        bool _isFirstInBatch,
346: 		        uint128 _maxVirtualBlocksToCreate

// @audit _prevBatchHash
444: 		    function setNewBatch(
445: 		        bytes32 _prevBatchHash,
446: 		        uint128 _newTimestamp,
447: 		        uint128 _expectedNewNumber,
448: 		        uint256 _baseFee
```
[[212](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L212), [314](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L314), [341-346](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L341-L346), [444-448](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L444-L448)]



```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

// @audit _id
105: 		    function getOperationState(bytes32 _id) public view returns (OperationState) {
```
[[105](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L105)]



```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol

// @audit _l2DefaultAccountBytecodeHash
92: 		    function _setL2DefaultAccountBytecodeHash(bytes32 _l2DefaultAccountBytecodeHash) private {

// @audit _l2BootloaderBytecodeHash
109: 		    function _setL2BootloaderBytecodeHash(bytes32 _l2BootloaderBytecodeHash) private {

// @audit _bootloaderHash, _defaultAccountHash
171: 		    function _setBaseSystemContracts(bytes32 _bootloaderHash, bytes32 _defaultAccountHash) internal {
```
[[92](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L92), [109](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L109), [171](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L171)]



```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

// @audit _l2TokenProxyBytecodeHash
49: 		    function initialize(
50: 		        address _l1Bridge,
51: 		        address _l1LegecyBridge,
52: 		        bytes32 _l2TokenProxyBytecodeHash,
53: 		        address _aliasedOwner
```
[[49-53](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L49-L53)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol

// @audit _selector
205: 		    function _addOneFunction(address _facet, bytes4 _selector, bool _isSelectorFreezable) private {

// @audit _selector
228: 		    function _removeOneFunction(address _facet, bytes4 _selector) private {

// @audit _calldata
278: 		    function _initializeDiamondCut(address _init, bytes memory _calldata) private {
```
[[205](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L205), [228](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L228), [278](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L278)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

// @audit _prevBatchCommitment, _currentBatchCommitment
453: 		    function _getBatchProofPublicInput(
454: 		        bytes32 _prevBatchCommitment,
455: 		        bytes32 _currentBatchCommitment,
456: 		        VerifierParams memory _verifierParams
```
[[453-456](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L453-L456)]

</details>

---

### [N-41] Use of `abi.encodePacked` instead of `bytes.concat`

Starting from version `0.8.4`, the recommended approach for appending bytes is to use `bytes.concat` instead of `abi.encodePacked`.

*There are 8 instances of this issue.*

<details>
<summary>Expand findings</summary>


```solidity
File: code/system-contracts/contracts/L1Messenger.sol

96: 		            abi.encodePacked(
97: 		                _l2ToL1Log.l2ShardId,
98: 		                _l2ToL1Log.isService,
99: 		                _l2ToL1Log.txNumberInBlock,
100: 		                _l2ToL1Log.sender,
101: 		                _l2ToL1Log.key,
102: 		                _l2ToL1Log.value
103: 		            )
```
[[96-103](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L96-L103)]



```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

142: 		        return keccak256(abi.encodePacked("\x19\x01", domainSeparator, structHash));
```
[[142](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L142)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

461: 		                    abi.encodePacked(
462: 		                        _prevBatchCommitment,
463: 		                        _currentBatchCommitment,
464: 		                        _verifierParams.recursionNodeLevelVkHash,
465: 		                        _verifierParams.recursionLeafLevelVkHash
466: 		                    )

528: 		            abi.encodePacked(
529: 		                s.zkPorterIsAvailable,
530: 		                s.l2BootloaderBytecodeHash,
531: 		                l2DefaultAccountBytecodeHash,
532: 		                // VM 1.5.0 requires us to pass the EVM simulator code hash. For now it is the same as the default account.
533: 		                l2DefaultAccountBytecodeHash
534: 		            );

548: 		            abi.encodePacked(
549: 		                l2ToL1LogsHash,
550: 		                _stateDiffHash,
551: 		                _batch.bootloaderHeapInitialContentsHash,
552: 		                _batch.eventsQueueStateHash,
553: 		                _encodeBlobAuxilaryOutput(_blobCommitments, _blobHashes)
554: 		            );

610: 		        bytes memory precompileInput = abi.encodePacked(_versionedHash, _openingPoint, _openingValueCommitmentProof);

655: 		                abi.encodePacked(blobVersionedHash, _pubdataCommitments[i:i + PUBDATA_COMMITMENT_COMMITMENT_OFFSET])
```
[[461-466](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L461-L466), [528-534](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L528-L534), [548-554](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L548-L554), [610](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L610), [655](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L655)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

113: 		            abi.encodePacked(_log.l2ShardId, _log.isService, _log.txNumberInBatch, _log.sender, _log.key, _log.value)
```
[[113](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L113)]

</details>

---

### [N-42] Use of `abi.encodePacked` instead of casting directly

Consider casting to `bytes32` directly instead of using `abi.encodePacked` when there is just a single argument, to make the code more clear.

*There are 2 instances of this issue.*


```solidity
File: code/system-contracts/contracts/SystemContext.sol

234: 		        return keccak256(abi.encodePacked(uint32(_blockNumber)));
```
[[234](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L234)]



```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

133: 		                keccak256(abi.encodePacked(_transaction.factoryDeps)),
```
[[133](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L133)]


---

### [N-43] Use of `constant` variables instead of `immutable`

Constant variables and immutable variables serve different purposes and should be used accordingly.

To clarify, constant variables are used for literal values in the code, whereas immutable variables are ideal for values calculated or passed into the constructor.

*There are 4 instances of this issue.*


```solidity
File: code/contracts/zksync/contracts/L2ContractHelper.sol

85: 		    bytes32 private constant CREATE2_PREFIX = keccak256("zksyncCreate2");
```
[[85](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/L2ContractHelper.sol#L85)]



```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

82: 		    bytes32 constant EIP712_DOMAIN_TYPEHASH = keccak256("EIP712Domain(string name,string version,uint256 chainId)");

84: 		    bytes32 constant EIP712_TRANSACTION_TYPE_HASH =
85: 		        keccak256(
86: 		            "Transaction(uint256 txType,uint256 from,uint256 to,uint256 gasLimit,uint256 gasPerPubdataByteLimit,uint256 maxFeePerGas,uint256 maxPriorityFeePerGas,uint256 paymaster,uint256 nonce,uint256 value,bytes data,bytes32[] factoryDeps,bytes paymasterInput)"
87: 		        );
```
[[82](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L82), [84-87](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L84-L87)]



```solidity
File: code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol

12: 		    bytes32 private constant CREATE2_PREFIX = keccak256("zksyncCreate2");
```
[[12](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L12)]


---

### [N-44] Contract functions should use an `interface`

All `external`/`public` functions should override an `interface`. This is useful to make sure that the whole API is extracted.

*There are 185 instances of this issue.*

<details>
<summary>Expand findings</summary>


```solidity
File: code/system-contracts/contracts/ComplexUpgrader.sol

21: 		    function upgrade(address _delegateTo, bytes calldata _calldata) external payable {
```
[[21](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ComplexUpgrader.sol#L21)]



```solidity
File: code/system-contracts/contracts/Compressor.sol

44: 		    function publishCompressedBytecode(

110: 		    function verifyCompressedStateDiffs(
```
[[44](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L44), [110](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L110)]



```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

34: 		    function getAccountInfo(address _address) external view returns (AccountInfo memory info) {

40: 		    function extendedAccountVersion(address _address) public view returns (AccountAbstractionVersion) {

65: 		    function updateAccountVersion(AccountAbstractionVersion _version) external onlySystemCall {

74: 		    function updateNonceOrdering(AccountNonceOrdering _nonceOrdering) external onlySystemCall {

213: 		    function forceDeployOnAddress(ForceDeployment calldata _deployment, address _sender) external payable onlySelf {

238: 		    function forceDeployOnAddresses(ForceDeployment[] calldata _deployments) external payable {
```
[[34](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L34), [40](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L40), [65](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L65), [74](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L74), [213](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L213), [238](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L238)]



```solidity
File: code/system-contracts/contracts/DefaultAccount.sol

196: 		    function payForTransaction(

212: 		    function prepareForPaymaster(
```
[[196](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L196), [212](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L212)]



```solidity
File: code/system-contracts/contracts/GasBoundCaller.sol

35: 		    function gasBoundCall(address _to, uint256 _maxTotalGas, bytes calldata _data) external payable {
```
[[35](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/GasBoundCaller.sol#L35)]



```solidity
File: code/system-contracts/contracts/KnownCodesStorage.sol

27: 		    function markFactoryDeps(bool _shouldSendToL1, bytes32[] calldata _hashes) external onlyCallFromBootloader {

39: 		    function markBytecodeAsPublished(bytes32 _bytecodeHash) external onlyCompressor {
```
[[27](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/KnownCodesStorage.sol#L27), [39](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/KnownCodesStorage.sol#L39)]



```solidity
File: code/system-contracts/contracts/L1Messenger.sol

70: 		    function sendL2ToL1Log(

194: 		    function publishPubdataAndClearState(
```
[[70](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L70), [194](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L194)]



```solidity
File: code/system-contracts/contracts/NonceHolder.sol

46: 		    function getMinNonce(address _address) public view returns (uint256) {

57: 		    function getRawNonce(address _address) public view returns (uint256) {

65: 		    function increaseMinNonce(uint256 _value) public onlySystemCall returns (uint256 oldMinNonce) {

82: 		    function setValueUnderNonce(uint256 _key, uint256 _value) public onlySystemCall {

102: 		    function getValueUnderNonce(uint256 _key) public view returns (uint256) {

110: 		    function incrementMinNonceIfEquals(uint256 _expectedNonce) external onlySystemCall {

125: 		    function getDeploymentNonce(address _address) external view returns (uint256 deploymentNonce) {

135: 		    function incrementDeploymentNonce(address _address) external returns (uint256 prevDeploymentNonce) {

154: 		    function isNonceUsed(address _address, uint256 _nonce) public view returns (bool) {

166: 		    function validateNonceUsage(address _address, uint256 _key, bool _shouldBeUsed) external view {
```
[[46](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/NonceHolder.sol#L46), [57](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/NonceHolder.sol#L57), [65](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/NonceHolder.sol#L65), [82](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/NonceHolder.sol#L82), [102](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/NonceHolder.sol#L102), [110](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/NonceHolder.sol#L110), [125](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/NonceHolder.sol#L125), [135](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/NonceHolder.sol#L135), [154](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/NonceHolder.sol#L154), [166](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/NonceHolder.sol#L166)]



```solidity
File: code/system-contracts/contracts/PubdataChunkPublisher.sol

21: 		    function chunkAndPublishPubdata(bytes calldata _pubdata) external onlyCallFrom(address(L1_MESSENGER_CONTRACT)) {
```
[[21](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/PubdataChunkPublisher.sol#L21)]



```solidity
File: code/system-contracts/contracts/SystemContext.sol

84: 		    function setChainId(uint256 _newChainId) external onlyCallFromForceDeployer {

99: 		    function setTxOrigin(address _newOrigin) external onlyCallFromBootloader {

105: 		    function setGasPrice(uint256 _gasPrice) external onlyCallFromBootloader {

112: 		    function setPubdataInfo(uint256 _gasPerPubdataByte, uint256 _basePubdataSpent) external onlyCallFromBootloader {

117: 		    function getCurrentPubdataSpent() public view returns (uint256) {

122: 		    function getCurrentPubdataCost() external view returns (uint256) {

132: 		    function getBlockHashEVM(uint256 _block) external view returns (bytes32 hash) {

166: 		    function getBatchHash(uint256 _batchNumber) external view returns (bytes32 hash) {

172: 		    function getBatchNumberAndTimestamp() public view returns (uint128 batchNumber, uint128 batchTimestamp) {

180: 		    function getL2BlockNumberAndTimestamp() public view returns (uint128 blockNumber, uint128 blockTimestamp) {

190: 		    function getBlockNumber() public view returns (uint128) {

198: 		    function getBlockTimestamp() public view returns (uint128) {

341: 		    function setL2Block(

402: 		    function appendTransactionToCurrentL2Block(bytes32 _txHash) external onlyCallFromBootloader {

408: 		    function publishTimestampDataToL1() external onlyCallFromBootloader {

444: 		    function setNewBatch(

471: 		    function unsafeOverrideBatch(

482: 		    function incrementTxNumberInBatch() external onlyCallFromBootloader {

486: 		    function resetTxNumberInBatch() external onlyCallFromBootloader {

496: 		    function currentBlockInfo() external view returns (uint256 blockInfo) {

503: 		    function getBlockNumberAndTimestamp() external view returns (uint256 blockNumber, uint256 blockTimestamp) {

509: 		    function blockHash(uint256 _blockNumber) external view returns (bytes32 hash) {
```
[[84](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L84), [99](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L99), [105](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L105), [112](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L112), [117](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L117), [122](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L122), [132](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L132), [166](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L166), [172](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L172), [180](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L180), [190](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L190), [198](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L198), [341](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L341), [402](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L402), [408](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L408), [444](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L444), [471](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L471), [482](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L482), [486](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L486), [496](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L496), [503](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L503), [509](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L509)]



```solidity
File: code/contracts/zksync/contracts/ForceDeployUpgrader.sol

13: 		    function forceDeploy(IContractDeployer.ForceDeployment[] calldata _forceDeployments) external payable {
```
[[13](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/ForceDeployUpgrader.sol#L13)]



```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

60: 		    function initialize() external reentrancyGuardInitializer {}

63: 		    function tranferTokenToSharedBridge(address _token, uint256 _amount) external {

75: 		    function l2TokenAddress(address _l1Token) external view returns (address) {

98: 		    function deposit(

133: 		    function deposit(

176: 		    function claimFailedDeposit(

208: 		    function finalizeWithdrawal(
```
[[60](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L60), [63](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L63), [75](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L75), [98](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L98), [133](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L133), [176](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L176), [208](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L208)]



```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

104: 		    function initialize(

116: 		    function transferFundsFromLegacy(address _token, address _target, uint256 _targetChainId) external onlyOwner {

137: 		    function receiveEth(uint256 _chainId) external payable {

142: 		    function initializeChainGovernance(uint256 _chainId, address _l2BridgeAddress) external onlyOwner {

148: 		    function bridgehubDepositBaseToken(
```
[[104](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L104), [116](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L116), [137](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L137), [142](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L142), [148](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L148)]



```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

41: 		    function initialize(address _owner) external reentrancyGuardInitializer {

51: 		    function setPendingAdmin(address _newPendingAdmin) external onlyOwnerOrAdmin {

60: 		    function acceptAdmin() external {

75: 		    function getStateTransition(uint256 _chainId) public view returns (address) {

82: 		    function addStateTransitionManager(address _stateTransitionManager) external onlyOwner {

92: 		    function removeStateTransitionManager(address _stateTransitionManager) external onlyOwner {

101: 		    function addToken(address _token) external onlyOwner {

108: 		    function setSharedBridge(address _sharedBridge) external onlyOwner {

114: 		    function createNewChain(

198: 		    function l2TransactionBaseCost(
```
[[41](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L41), [51](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L51), [60](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L60), [75](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L75), [82](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L82), [92](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L92), [101](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L101), [108](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L108), [114](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L114), [198](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L198)]



```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

84: 		    function isOperation(bytes32 _id) public view returns (bool) {

89: 		    function isOperationPending(bytes32 _id) public view returns (bool) {

95: 		    function isOperationReady(bytes32 _id) public view returns (bool) {

100: 		    function isOperationDone(bytes32 _id) public view returns (bool) {

105: 		    function getOperationState(bytes32 _id) public view returns (OperationState) {

129: 		    function scheduleTransparent(Operation calldata _operation, uint256 _delay) external onlyOwner {

142: 		    function scheduleShadow(bytes32 _id, uint256 _delay) external onlyOwner {

154: 		    function cancel(bytes32 _id) external onlyOwner {

167: 		    function execute(Operation calldata _operation) external payable onlyOwnerOrSecurityCouncil {

186: 		    function executeInstant(Operation calldata _operation) external payable onlySecurityCouncil {

204: 		    function hashOperation(Operation calldata _operation) public pure returns (bytes32) {

249: 		    function updateDelay(uint256 _newDelay) external onlySelf {

256: 		    function updateSecurityCouncil(address _newSecurityCouncil) external onlySelf {
```
[[84](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L84), [89](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L89), [95](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L95), [100](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L100), [105](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L105), [129](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L129), [142](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L142), [154](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L154), [167](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L167), [186](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L186), [204](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L204), [249](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L249), [256](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L256)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

79: 		    function initialize(

110: 		    function setPendingAdmin(address _newPendingAdmin) external onlyOwnerOrAdmin {

119: 		    function acceptAdmin() external {

132: 		    function setValidatorTimelock(address _validatorTimelock) external onlyOwnerOrAdmin {

137: 		    function setInitialCutHash(Diamond.DiamondCutData calldata _diamondCut) external onlyOwner {

142: 		    function setNewVersionUpgrade(

152: 		    function setUpgradeDiamondCut(

160: 		    function freezeChain(uint256 _chainId) external onlyOwner {

165: 		    function unfreezeChain(uint256 _chainId) external onlyOwner {

170: 		    function revertBatches(uint256 _chainId, uint256 _newLastBatch) external onlyOwnerOrAdmin {

230: 		    function registerAlreadyDeployedStateTransition(

239: 		    function createNewChain(
```
[[79](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L79), [110](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L110), [119](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L119), [132](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L132), [137](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L137), [142](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L142), [152](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L152), [160](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L160), [165](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L165), [170](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L170), [230](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L230), [239](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L239)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

73: 		    function setStateTransitionManager(IStateTransitionManager _stateTransitionManager) external onlyOwner {

78: 		    function addValidator(uint256 _chainId, address _newValidator) external onlyChainAdmin(_chainId) {

87: 		    function removeValidator(uint256 _chainId, address _validator) external onlyChainAdmin(_chainId) {

96: 		    function setExecutionDelay(uint32 _executionDelay) external onlyOwner {

102: 		    function getCommittedBatchTimestamp(uint256 _chainId, uint256 _l2BatchNumber) external view returns (uint256) {

108: 		    function commitBatches(

126: 		    function commitBatchesSharedBridge(

146: 		    function revertBatches(uint256) external onlyValidator(ERA_CHAIN_ID) {

153: 		    function revertBatchesSharedBridge(uint256 _chainId, uint256) external onlyValidator(_chainId) {

160: 		    function proveBatches(

171: 		    function proveBatchesSharedBridge(

182: 		    function executeBatches(StoredBatchInfo[] calldata _newBatchesData) external onlyValidator(ERA_CHAIN_ID) {

203: 		    function executeBatchesSharedBridge(
```
[[73](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L73), [78](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L78), [87](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L87), [96](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L96), [102](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L102), [108](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L108), [126](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L126), [146](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L146), [153](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L153), [160](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L160), [171](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L171), [182](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L182), [203](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L203)]



```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol

67: 		    function upgrade(ProposedUpgrade calldata _proposedUpgrade) public virtual returns (bytes32 txHash) {
```
[[67](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L67)]



```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

49: 		    function initialize(
```
[[49](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L49)]



```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

50: 		    function bridgeInitialize(address _l1Address, bytes memory _data) external initializer {

111: 		    function reinitializeToken(

178: 		    function decodeString(bytes memory _input) external pure returns (string memory result) {

183: 		    function decodeUint8(bytes memory _input) external pure returns (uint8 result) {
```
[[50](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L50), [111](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L111), [178](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L178), [183](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L183)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol

24: 		    function initialize(InitializeData calldata _initializeData) external reentrancyGuardInitializer returns (bytes32) {
```
[[24](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol#L24)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol

23: 		    function setPendingAdmin(address _newPendingAdmin) external onlyAdmin {

32: 		    function acceptAdmin() external {

45: 		    function setValidator(address _validator, bool _active) external onlyStateTransitionManager {

51: 		    function setPorterAvailability(bool _zkPorterIsAvailable) external onlyStateTransitionManager {

58: 		    function setPriorityTxMaxGasLimit(uint256 _newPriorityTxMaxGasLimit) external onlyStateTransitionManager {

67: 		    function changeFeeParams(FeeParams calldata _newFeeParams) external onlyAdminOrStateTransitionManager {

79: 		    function setTokenMultiplier(uint128 _nominator, uint128 _denominator) external onlyAdminOrStateTransitionManager {

89: 		    function setValidiumMode(PubdataPricingMode _validiumMode) external onlyAdmin {

100: 		    function upgradeChainFromVersion(

123: 		    function executeUpgrade(Diamond.DiamondCutData calldata _diamondCut) external onlyStateTransitionManager {

133: 		    function freezeDiamond() external onlyAdminOrStateTransitionManager {

143: 		    function unfreezeDiamond() external onlyAdminOrStateTransitionManager {
```
[[23](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L23), [32](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L32), [45](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L45), [51](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L51), [58](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L58), [67](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L67), [79](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L79), [89](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L89), [100](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L100), [123](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L123), [133](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L133), [143](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L143)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

199: 		    function commitBatches(

207: 		    function commitBatchesSharedBridge(

337: 		    function executeBatchesSharedBridge(

345: 		    function executeBatches(StoredBatchInfo[] calldata _batchesData) external nonReentrant onlyValidator {

368: 		    function proveBatches(

377: 		    function proveBatchesSharedBridge(

472: 		    function revertBatches(uint256 _newLastBatch) external nonReentrant onlyValidatorOrStateTransitionManager {

477: 		    function revertBatchesSharedBridge(uint256, uint256 _newLastBatch) external nonReentrant onlyValidator {
```
[[199](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L199), [207](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L207), [337](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L337), [345](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L345), [368](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L368), [377](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L377), [472](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L472), [477](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L477)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol

32: 		    function getVerifier() external view returns (address) {

37: 		    function getAdmin() external view returns (address) {

42: 		    function getPendingAdmin() external view returns (address) {

47: 		    function getBridgehub() external view returns (address) {

52: 		    function getStateTransitionManager() external view returns (address) {

57: 		    function getBaseToken() external view returns (address) {

62: 		    function getBaseTokenBridge() external view returns (address) {

67: 		    function baseTokenGasPriceMultiplierNominator() external view returns (uint128) {

72: 		    function baseTokenGasPriceMultiplierDenominator() external view returns (uint128) {

77: 		    function getTotalBatchesCommitted() external view returns (uint256) {

82: 		    function getTotalBatchesVerified() external view returns (uint256) {

87: 		    function getTotalBatchesExecuted() external view returns (uint256) {

92: 		    function getTotalPriorityTxs() external view returns (uint256) {

97: 		    function getFirstUnprocessedPriorityTx() external view returns (uint256) {

102: 		    function getPriorityQueueSize() external view returns (uint256) {

107: 		    function priorityQueueFrontOperation() external view returns (PriorityOperation memory) {

112: 		    function isValidator(address _address) external view returns (bool) {

117: 		    function l2LogsRootHash(uint256 _batchNumber) external view returns (bytes32) {

122: 		    function storedBatchHash(uint256 _batchNumber) external view returns (bytes32) {

127: 		    function getL2BootloaderBytecodeHash() external view returns (bytes32) {

132: 		    function getL2DefaultAccountBytecodeHash() external view returns (bytes32) {

137: 		    function getVerifierParams() external view returns (VerifierParams memory) {

142: 		    function getProtocolVersion() external view returns (uint256) {

147: 		    function getL2SystemContractsUpgradeTxHash() external view returns (bytes32) {

152: 		    function getL2SystemContractsUpgradeBatchNumber() external view returns (uint256) {

157: 		    function isDiamondStorageFrozen() external view returns (bool) {

163: 		    function isFacetFreezable(address _facet) external view returns (bool isFreezable) {

176: 		    function getPriorityTxMaxGasLimit() external view returns (uint256) {

181: 		    function isFunctionFreezable(bytes4 _selector) external view returns (bool) {

188: 		    function isEthWithdrawalFinalized(uint256 _l2BatchNumber, uint256 _l2MessageIndex) external view returns (bool) {

193: 		    function getPubdataPricingMode() external view returns (PubdataPricingMode) {

202: 		    function facets() external view returns (Facet[] memory result) {

217: 		    function facetFunctionSelectors(address _facet) external view returns (bytes4[] memory) {

223: 		    function facetAddresses() external view returns (address[] memory) {

229: 		    function facetAddress(bytes4 _selector) external view returns (address) {

239: 		    function getTotalBlocksCommitted() external view returns (uint256) {

244: 		    function getTotalBlocksVerified() external view returns (uint256) {

249: 		    function getTotalBlocksExecuted() external view returns (uint256) {

254: 		    function storedBlockHash(uint256 _batchNumber) external view returns (bytes32) {

259: 		    function getL2SystemContractsUpgradeBlockNumber() external view returns (uint256) {
```
[[32](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L32), [37](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L37), [42](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L42), [47](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L47), [52](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L52), [57](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L57), [62](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L62), [67](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L67), [72](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L72), [77](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L77), [82](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L82), [87](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L87), [92](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L92), [97](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L97), [102](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L102), [107](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L107), [112](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L112), [117](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L117), [122](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L122), [127](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L127), [132](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L132), [137](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L137), [142](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L142), [147](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L147), [152](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L152), [157](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L157), [163](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L163), [176](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L176), [181](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L181), [188](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L188), [193](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L193), [202](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L202), [217](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L217), [223](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L223), [229](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L229), [239](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L239), [244](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L244), [249](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L249), [254](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L254), [259](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L259)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

38: 		    function transferEthToSharedBridge() external onlyBaseTokenBridge {

47: 		    function bridgehubRequestL2Transaction(

54: 		    function proveL2MessageInclusion(

64: 		    function proveL2LogInclusion(

74: 		    function proveL1ToL2TransactionStatus(

143: 		    function l2TransactionBaseCost(

178: 		    function finalizeEthWithdrawal(

197: 		    function requestL2Transaction(
```
[[38](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L38), [47](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L47), [54](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L54), [64](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L64), [74](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L74), [143](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L143), [178](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L178), [197](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L197)]

</details>

---

### [N-45] `require`/`revert` without any message

If a transaction reverts, it can be confusing to debug if there aren't any messages. Add a descriptive message to all `require`/`revert` statements.

*There are 5 instances of this issue.*


```solidity
File: code/system-contracts/contracts/interfaces/ISystemContract.sol

55: 		        require(msg.sender == FORCE_DEPLOYER);
```
[[55](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContract.sol#L55)]



```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

161: 		        if (availableGetters.ignoreName) revert();

167: 		        if (availableGetters.ignoreSymbol) revert();

173: 		        if (availableGetters.ignoreDecimals) revert();
```
[[161](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L161), [167](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L167), [173](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L173)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

51: 		            require(_newBatch.pubdataCommitments.length == 1);
```
[[51](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L51)]


---

### [N-46] Some error strings are not descriptive

Consider adding more detail to the following error messages. It is recommended to keep the message size under 32 chars to avoid adding a gas overhead.

*There are 42 instances of this issue.*

<details>
<summary>Expand findings</summary>


```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

141: 		        require(_amount != 0, "0T"); // empty deposit

143: 		        require(amount == _amount, "3T"); // The token has non-standard transfer logic

186: 		        require(amount != 0, "2T"); // empty deposit
```
[[141](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L141), [143](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L143), [186](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L186)]



```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

161: 		            require(amount == _amount, "3T"); // The token has non-standard transfer logic

206: 		            require(withdrawAmount == _depositAmount, "5T"); // The token has non-standard transfer logic

208: 		        require(amount != 0, "6T"); // empty deposit amount

327: 		        require(_amount > 0, "y1");
```
[[161](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L161), [206](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L206), [208](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L208), [327](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L327)]



```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

62: 		        require(msg.sender == currentPendingAdmin, "n42"); // Only proposed by current admin address can claim the admin rights
```
[[62](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L62)]



```solidity
File: code/contracts/ethereum/contracts/common/ReentrancyGuard.sol

58: 		        require(lockSlotOldValue == 0, "1B");

75: 		        require(_status == _NOT_ENTERED, "r1");
```
[[58](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/ReentrancyGuard.sol#L58), [75](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/ReentrancyGuard.sol#L75)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

121: 		        require(msg.sender == currentPendingAdmin, "n42"); // Only proposed by current admin address can claim the admin rights
```
[[121](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L121)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

195: 		                require(block.timestamp >= commitBatchTimestamp + delay, "5c"); // The delay is not passed

217: 		                require(block.timestamp >= commitBatchTimestamp + delay, "5c"); // The delay is not passed
```
[[195](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L195), [217](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L217)]



```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

68: 		            require(_l1LegecyBridge != address(0), "bf2");
```
[[68](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L68)]



```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

51: 		        require(_l1Address != address(0), "in6"); // Should be non-zero address
```
[[51](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L51)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol

31: 		        require(!diamondStorage.isFrozen || !facet.isFreezable, "q1"); // Facet is frozen
```
[[31](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol#L31)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol

175: 		        require(_facet == address(0), "a1"); // facet address must be zero

181: 		            require(oldFacet.facetAddress != address(0), "a2"); // Can't delete a non-existent facet

215: 		            require(_isSelectorFreezable == ds.selectorToFacet[selector0].isFreezable, "J1");

298: 		            require(abi.decode(data, (bytes32)) == DIAMOND_INIT_SUCCESS_RETURN_VALUE, "lp1");
```
[[175](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L175), [181](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L181), [215](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L215), [298](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L298)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol

59: 		        require(_transaction.paymasterInput.length == 0, "ul1");
```
[[59](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L59)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol

34: 		        require(msg.sender == pendingAdmin, "n4"); // Only proposed by current admin address can claim the admin rights

59: 		        require(_newPriorityTxMaxGasLimit <= MAX_GAS_PER_TRANSACTION, "n5");

70: 		        require(_newFeeParams.maxPubdataPerBatch >= _newFeeParams.priorityTxMaxPubdata, "n6");

136: 		        require(!diamondStorage.isFrozen, "a9"); // diamond proxy is frozen already

146: 		        require(diamondStorage.isFrozen, "a7"); // diamond proxy is not frozen
```
[[34](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L34), [59](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L59), [70](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L70), [136](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L136), [146](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L146)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

50: 		            require(logOutput.pubdataHash == 0x00, "v0h");

114: 		        require(_previousBatchTimestamp < batchTimestamp, "h3");

122: 		        require(block.timestamp - COMMIT_TIMESTAMP_NOT_OLDER <= batchTimestamp, "h1"); // New batch timestamp is too small

123: 		        require(lastL2BlockTimestamp <= block.timestamp + COMMIT_TIMESTAMP_APPROXIMATION_DELTA, "h2"); // The last L2 block timestamp is too big

192: 		            require(processedLogs == 511, "b7");

194: 		            require(processedLogs == 1023, "b8");

231: 		        require(_newBatchesData.length == 1, "e4");

324: 		        require(
325: 		            _hashStoredBatchInfo(_storedBatch) == s.storedBatchHashes[currentBatchNumber],
326: 		            "exe10" // executing batch should be committed
327: 		        );

402: 		        require(_hashStoredBatchInfo(_prevBatch) == s.storedBatchHashes[currentTotalBatchesVerified], "t1");

407: 		            require(
408: 		                _hashStoredBatchInfo(_committedBatches[i]) == s.storedBatchHashes[currentTotalBatchesVerified],
409: 		                "o1"
410: 		            );

442: 		        require(proofPublicInput.length == 1, "t4");

482: 		        require(s.totalBatchesCommitted > _newLastBatch, "v1"); // The last committed batch is less than new last batch

483: 		        require(_newLastBatch >= s.totalBatchesExecuted, "v2"); // Already executed batches cannot be reverted

567: 		        require(_blobCommitments.length == MAX_NUMBER_OF_BLOBS, "b10");

568: 		        require(_blobHashes.length == MAX_NUMBER_OF_BLOBS, "b11");
```
[[50](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L50), [114](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L114), [122](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L122), [123](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L123), [192](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L192), [194](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L194), [231](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L231), [324-327](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L324-L327), [402](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L402), [407-410](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L407-L410), [442](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L442), [482](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L482), [483](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L483), [567](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L567), [568](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L568)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol

183: 		        require(ds.selectorToFacet[_selector].facetAddress != address(0), "g2");
```
[[183](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L183)]

</details>

---

### [N-47] Multiple `address`/ID mappings can be combined into a single mapping of an `address`/ID to a `struct`, for readability

Well-organized data structures make code reviews easier, which may lead to fewer bugs. Consider combining related mappings into mappings to structs, so it's clear what data is related.

*There are 3 instances of this issue.*


```solidity
File: code/system-contracts/contracts/NonceHolder.sol

// @audit consider merging rawNonces, nonceValues
36: 		    mapping(uint256 account => uint256 packedMinAndDeploymentNonce) internal rawNonces;

41: 		    mapping(uint256 account => mapping(uint256 nonceKey => uint256 value)) internal nonceValues;
```
[[36](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/NonceHolder.sol#L36)]



```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

// @audit consider merging depositAmount, __DEPRECATED_totalDepositedAmountPerUser
32: 		    mapping(address account => mapping(address l1Token => mapping(bytes32 depositL2TxHash => uint256 amount)))
33: 		        public depositAmount;

51: 		    mapping(address => mapping(address => uint256)) private __DEPRECATED_totalDepositedAmountPerUser;

// @audit consider merging __DEPRECATED_lastWithdrawalLimitReset, __DEPRECATED_withdrawnAmountInWindow
45: 		    mapping(address => uint256) private __DEPRECATED_lastWithdrawalLimitReset;

48: 		    mapping(address => uint256) private __DEPRECATED_withdrawnAmountInWindow;
```
[[32-33](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L32-L33), [45](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L45)]


---

### [N-48] Variable names should not end with an underscore

The use of underscore at the end of the variable name is uncommon and also suggests that the variable name was not completely changed.  Consider refactoring `variableName_` to `variableName`.

*There is 1 instance of this issue.*


```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

31: 		    uint8 private decimals_;
```
[[31](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L31)]


---

### [N-49] Lack of specific `import` identifier

It is better to use `import {<identifier>} from "<file.sol>"` instead of `import "<file.sol>"` to improve readability and speed up the compilation time.

*There are 41 instances of this issue.*

<details>
<summary>Expand findings</summary>


```solidity
File: code/system-contracts/contracts/AccountCodeStorage.sol

5: 		import "./interfaces/IAccountCodeStorage.sol";

6: 		import "./libraries/Utils.sol";
```
[[5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L5), [6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L6)]



```solidity
File: code/system-contracts/contracts/DefaultAccount.sol

5: 		import "./interfaces/IAccount.sol";

6: 		import "./libraries/TransactionHelper.sol";

7: 		import "./libraries/SystemContractHelper.sol";

8: 		import "./libraries/EfficientCall.sol";
```
[[5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L5), [6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L6), [7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L7), [8](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L8)]



```solidity
File: code/system-contracts/contracts/interfaces/IAccount.sol

5: 		import "../libraries/TransactionHelper.sol";
```
[[5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IAccount.sol#L5)]



```solidity
File: code/system-contracts/contracts/interfaces/IBootloaderUtilities.sol

5: 		import "../libraries/TransactionHelper.sol";
```
[[5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBootloaderUtilities.sol#L5)]



```solidity
File: code/system-contracts/contracts/interfaces/IPaymaster.sol

5: 		import "../libraries/TransactionHelper.sol";
```
[[5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IPaymaster.sol#L5)]



```solidity
File: code/system-contracts/contracts/libraries/EfficientCall.sol

5: 		import "./SystemContractHelper.sol";

6: 		import "./Utils.sol";
```
[[5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L5), [6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L6)]



```solidity
File: code/system-contracts/contracts/libraries/SystemContractsCaller.sol

6: 		import "./Utils.sol";
```
[[6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L6)]



```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

5: 		import "../openzeppelin/token/ERC20/IERC20.sol";

6: 		import "../openzeppelin/token/ERC20/utils/SafeERC20.sol";

8: 		import "../interfaces/IPaymasterFlow.sol";

9: 		import "../interfaces/IContractDeployer.sol";

11: 		import "./RLPEncoder.sol";

12: 		import "./EfficientCall.sol";
```
[[5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L5), [6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L6), [8](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L8), [9](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L9), [11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L11), [12](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L12)]



```solidity
File: code/system-contracts/contracts/libraries/Utils.sol

4: 		import "./EfficientCall.sol";
```
[[4](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L4)]



```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

7: 		import "./IBridgehub.sol";

8: 		import "../bridge/interfaces/IL1SharedBridge.sol";

9: 		import "../state-transition/IStateTransitionManager.sol";

10: 		import "../common/ReentrancyGuard.sol";

11: 		import "../state-transition/chain-interfaces/IZkSyncStateTransition.sol";

14: 		import "../vendor/AddressAliasHelper.sol";
```
[[7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L7), [8](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L8), [9](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L9), [10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L10), [11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L11), [14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L14)]



```solidity
File: code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol

6: 		import "../common/Messaging.sol";

7: 		import "../state-transition/IStateTransitionManager.sol";

8: 		import "../state-transition/libraries/Diamond.sol";
```
[[6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L6), [7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L7), [8](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L8)]



```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol

5: 		import "../state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol";

6: 		import "../state-transition/chain-interfaces/IMailbox.sol";

7: 		import "../state-transition/chain-interfaces/IVerifier.sol";

8: 		import "../common/libraries/L2ContractHelper.sol";

9: 		import "../common/Messaging.sol";

10: 		import "../state-transition/libraries/TransactionValidator.sol";
```
[[5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L5), [6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L6), [7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L7), [8](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L8), [9](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L9), [10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L10)]



```solidity
File: code/contracts/ethereum/contracts/upgrades/GenesisUpgrade.sol

5: 		import "../state-transition/libraries/Diamond.sol";

6: 		import "./BaseZkSyncUpgradeGenesis.sol";

7: 		import "./IDefaultUpgrade.sol";
```
[[5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/GenesisUpgrade.sol#L5), [6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/GenesisUpgrade.sol#L6), [7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/GenesisUpgrade.sol#L7)]



```solidity
File: code/contracts/zksync/contracts/interfaces/IPaymaster.sol

5: 		import "../L2ContractHelper.sol";
```
[[5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/interfaces/IPaymaster.sol#L5)]



```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol

5: 		import "./IL1SharedBridge.sol";
```
[[5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L5)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol

12: 		import "../l2-deps/ISystemContext.sol";
```
[[12](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol#L12)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol

13: 		import "../libraries/Diamond.sol";
```
[[13](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol#L13)]

</details>

---

### [N-50] Duplicate import statements

Consider removing duplicate import statements, as they are already imported once.

*There are 3 instances of this issue.*


```solidity
File: code/system-contracts/contracts/PubdataChunkPublisher.sol

9: 		import {SystemLogKey} from "./Constants.sol";
```
[[9](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/PubdataChunkPublisher.sol#L9)]



```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol

8: 		import {IVerifier} from "../state-transition/chain-interfaces/IVerifier.sol";
```
[[8](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L8)]



```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol

6: 		import {IBridgehub} from "../../bridgehub/IBridgehub.sol";
```
[[6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L6)]


---

### [N-51] Imports should be organized more systematically

The contract's interface should be imported first, followed by each of the interfaces it uses, followed by all other files. The examples below do not follow this layout.

*There are 21 instances of this issue.*

<details>
<summary>Expand findings</summary>


```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

6: 		import {IContractDeployer} from "./interfaces/IContractDeployer.sol";
```
[[6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L6)]



```solidity
File: code/system-contracts/contracts/MsgValueSimulator.sol

7: 		import {ISystemContract} from "./interfaces/ISystemContract.sol";
```
[[7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/MsgValueSimulator.sol#L7)]



```solidity
File: code/system-contracts/contracts/NonceHolder.sol

7: 		import {ISystemContract} from "./interfaces/ISystemContract.sol";
```
[[7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/NonceHolder.sol#L7)]



```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

8: 		import {IL1ERC20Bridge} from "./interfaces/IL1ERC20Bridge.sol";
```
[[8](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L8)]



```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

13: 		import {IL1SharedBridge} from "./interfaces/IL1SharedBridge.sol";
```
[[13](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L13)]



```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

7: 		import "./IBridgehub.sol";
```
[[7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L7)]



```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

6: 		import {IGovernance} from "./IGovernance.sol";
```
[[6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L6)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

11: 		import {IStateTransitionManager, StateTransitionManagerInitializeData} from "./IStateTransitionManager.sol";
```
[[11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L11)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

7: 		import {IExecutor} from "./chain-interfaces/IExecutor.sol";
```
[[7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L7)]



```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol

12: 		import {ProposedUpgrade, BaseZkSyncUpgrade} from "./BaseZkSyncUpgrade.sol";
```
[[12](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L12)]



```solidity
File: code/contracts/ethereum/contracts/upgrades/DefaultUpgrade.sol

6: 		import {BaseZkSyncUpgrade, ProposedUpgrade} from "./BaseZkSyncUpgrade.sol";
```
[[6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/DefaultUpgrade.sol#L6)]



```solidity
File: code/contracts/ethereum/contracts/upgrades/GenesisUpgrade.sol

6: 		import "./BaseZkSyncUpgradeGenesis.sol";
```
[[6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/GenesisUpgrade.sol#L6)]



```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

10: 		import {IL2SharedBridge} from "./interfaces/IL2SharedBridge.sol";
```
[[10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L10)]



```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

7: 		import {ERC1967Upgrade} from "@openzeppelin/contracts/proxy/ERC1967/ERC1967Upgrade.sol";
```
[[7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L7)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol

6: 		import {ZkSyncStateTransitionBase} from "./facets/ZkSyncStateTransitionBase.sol";
```
[[6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol#L6)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol

8: 		import {IZkSyncStateTransitionBase} from "./IZkSyncStateTransitionBase.sol";
```
[[8](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L8)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol

9: 		import {ZkSyncStateTransitionBase} from "./ZkSyncStateTransitionBase.sol";
```
[[9](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L9)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

7: 		import {IExecutor, L2_LOG_ADDRESS_OFFSET, L2_LOG_KEY_OFFSET, L2_LOG_VALUE_OFFSET, SystemLogKey, LogProcessingOutput, PubdataSource, BLS_MODULUS, PUBDATA_COMMITMENT_SIZE, PUBDATA_COMMITMENT_CLAIMED_VALUE_OFFSET, PUBDATA_COMMITMENT_COMMITMENT_OFFSET, MAX_NUMBER_OF_BLOBS, TOTAL_BLOBS_IN_COMMITMENT} from "../../chain-interfaces/IExecutor.sol";
```
[[7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L7)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol

11: 		import {IGetters} from "../../chain-interfaces/IGetters.sol";
```
[[11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L11)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

7: 		import {IMailbox} from "../../chain-interfaces/IMailbox.sol";
```
[[7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L7)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol

6: 		import {ReentrancyGuard} from "../../../common/ReentrancyGuard.sol";
```
[[6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L6)]

</details>

---

### [N-52] Use an already existing `MerkleProof` implementation

Consider using an already existing and well-tested implementation (e.g. OpenZeppelin) instead of creating a new one from scratch to avoid introducing bugs.

*There is 1 instance of this issue.*


```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol

9: 		library Merkle {
```
[[9](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol#L9)]


---

### [N-53] Use an already existing `nonReentrant` implementation

Consider using an already existing and well-tested implementation (e.g. OpenZeppelin) instead of creating a new one from scratch to avoid introducing bugs.

*There is 1 instance of this issue.*


```solidity
File: code/contracts/ethereum/contracts/common/ReentrancyGuard.sol

68: 		    modifier nonReentrant() {
```
[[68](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/ReentrancyGuard.sol#L68)]


---

### [N-54] Consider using `abstract` contracts

Consider using the `abstract` keyword to indicate that some contracts must not be instantiated but should only be used with inheritance in other contracts.

*There are 2 instances of this issue.*


```solidity
File: code/system-contracts/contracts/L2BaseToken.sol

18: 		contract L2BaseToken is IBaseToken, ISystemContract {
```
[[18](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L2BaseToken.sol#L18)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol

11: 		contract ZkSyncStateTransitionBase is ReentrancyGuard {
```
[[11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L11)]


---

### [N-55] Long bitmasks are hard to read

Consider using bitshifts instead of a bitmap if the value is a power of 2 and the variable is constant, to improve the code readability.

*There is 1 instance of this issue.*


```solidity
File: code/system-contracts/contracts/libraries/Utils.sol

17: 		    bytes32 constant SET_IS_CONSTRUCTOR_MARKER_BIT_MASK =
18: 		        0x0001000000000000000000000000000000000000000000000000000000000000;
```
[[17-18](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L17-L18)]


---

### [N-56] Top-level declarations should be separated by at least two lines

Surround top level declarations in Solidity source with two blank lines. [Documentation](https://docs.soliditylang.org/en/latest/style-guide.html#blank-lines)

*There are 166 instances of this issue.*

<details>
<summary>Expand findings</summary>


```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

256: 		    }
257: 		
258: 		    function _nonSystemDeployOnAddress(
```
[[256-258](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L256-L258)]



```solidity
File: code/system-contracts/contracts/DefaultAccount.sol

218: 		    }
219: 		
220: 		    fallback() external payable ignoreInDelegateCall {

225: 		    }
226: 		
227: 		    receive() external payable {
```
[[218-220](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L218-L220), [225-227](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L225-L227)]



```solidity
File: code/system-contracts/contracts/EmptyContract.sol

11: 		    fallback() external payable {}
12: 		
13: 		    receive() external payable {}
```
[[11-13](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/EmptyContract.sol#L11-L13)]



```solidity
File: code/system-contracts/contracts/SystemContext.sol

115: 		    }
116: 		
117: 		    function getCurrentPubdataSpent() public view returns (uint256) {

120: 		    }
121: 		
122: 		    function getCurrentPubdataCost() external view returns (uint256) {

480: 		    }
481: 		
482: 		    function incrementTxNumberInBatch() external onlyCallFromBootloader {

484: 		    }
485: 		
486: 		    function resetTxNumberInBatch() external onlyCallFromBootloader {
```
[[115-117](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L115-L117), [120-122](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L120-L122), [480-482](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L480-L482), [484-486](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L484-L486)]



```solidity
File: code/contracts/zksync/contracts/SystemContractsCaller.sol

74: 		    }
75: 		
76: 		    function systemCallWithReturndata(

93: 		    }
94: 		
95: 		    function getFarCallABI(

119: 		    }
120: 		
121: 		    function getFarCallABIWithEmptyFatPointer(
```
[[74-76](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/SystemContractsCaller.sol#L74-L76), [93-95](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/SystemContractsCaller.sol#L93-L95), [119-121](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/SystemContractsCaller.sol#L119-L121)]



```solidity
File: code/system-contracts/contracts/interfaces/IAccount.sol

24: 		    ) external payable returns (bytes4 magic);
25: 		
26: 		    function executeTransaction(

34: 		    function executeTransactionFromOutside(Transaction calldata _transaction) external payable;
35: 		
36: 		    function payForTransaction(

40: 		    ) external payable;
41: 		
42: 		    function prepareForPaymaster(
```
[[24-26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IAccount.sol#L24-L26), [34-36](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IAccount.sol#L34-L36), [40-42](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IAccount.sol#L40-L42)]



```solidity
File: code/system-contracts/contracts/interfaces/IAccountCodeStorage.sol

6: 		    function storeAccountConstructingCodeHash(address _address, bytes32 _hash) external;
7: 		
8: 		    function storeAccountConstructedCodeHash(address _address, bytes32 _hash) external;

8: 		    function storeAccountConstructedCodeHash(address _address, bytes32 _hash) external;
9: 		
10: 		    function markAccountCodeHashAsConstructed(address _address) external;

10: 		    function markAccountCodeHashAsConstructed(address _address) external;
11: 		
12: 		    function getRawCodeHash(address _address) external view returns (bytes32 codeHash);

12: 		    function getRawCodeHash(address _address) external view returns (bytes32 codeHash);
13: 		
14: 		    function getCodeHash(uint256 _input) external view returns (bytes32 codeHash);

14: 		    function getCodeHash(uint256 _input) external view returns (bytes32 codeHash);
15: 		
16: 		    function getCodeSize(uint256 _input) external view returns (uint256 codeSize);
```
[[6-8](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IAccountCodeStorage.sol#L6-L8), [8-10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IAccountCodeStorage.sol#L8-L10), [10-12](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IAccountCodeStorage.sol#L10-L12), [12-14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IAccountCodeStorage.sol#L12-L14), [14-16](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IAccountCodeStorage.sol#L14-L16)]



```solidity
File: code/system-contracts/contracts/interfaces/IBaseToken.sol

6: 		    function balanceOf(uint256) external view returns (uint256);
7: 		
8: 		    function transferFromTo(address _from, address _to, uint256 _amount) external;

8: 		    function transferFromTo(address _from, address _to, uint256 _amount) external;
9: 		
10: 		    function totalSupply() external view returns (uint256);

10: 		    function totalSupply() external view returns (uint256);
11: 		
12: 		    function name() external pure returns (string memory);

12: 		    function name() external pure returns (string memory);
13: 		
14: 		    function symbol() external pure returns (string memory);

14: 		    function symbol() external pure returns (string memory);
15: 		
16: 		    function decimals() external pure returns (uint8);

16: 		    function decimals() external pure returns (uint8);
17: 		
18: 		    function mint(address _account, uint256 _amount) external;

18: 		    function mint(address _account, uint256 _amount) external;
19: 		
20: 		    function withdraw(address _l1Receiver) external payable;

20: 		    function withdraw(address _l1Receiver) external payable;
21: 		
22: 		    function withdrawWithMessage(address _l1Receiver, bytes calldata _additionalData) external payable;
```
[[6-8](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBaseToken.sol#L6-L8), [8-10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBaseToken.sol#L8-L10), [10-12](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBaseToken.sol#L10-L12), [12-14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBaseToken.sol#L12-L14), [14-16](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBaseToken.sol#L14-L16), [16-18](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBaseToken.sol#L16-L18), [18-20](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBaseToken.sol#L18-L20), [20-22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBaseToken.sol#L20-L22)]



```solidity
File: code/system-contracts/contracts/interfaces/ICompressor.sol

22: 		    ) external payable returns (bytes32 bytecodeHash);
23: 		
24: 		    function verifyCompressedStateDiffs(
```
[[22-24](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ICompressor.sol#L22-L24)]



```solidity
File: code/system-contracts/contracts/interfaces/IContractDeployer.sol

48: 		    ) external view returns (address newAddress);
49: 		
50: 		    function getNewAddressCreate(address _sender, uint256 _senderNonce) external pure returns (address newAddress);

50: 		    function getNewAddressCreate(address _sender, uint256 _senderNonce) external pure returns (address newAddress);
51: 		
52: 		    function create2(

56: 		    ) external payable returns (address newAddress);
57: 		
58: 		    function create2Account(
```
[[48-50](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L48-L50), [50-52](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L50-L52), [56-58](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L56-L58)]



```solidity
File: code/system-contracts/contracts/interfaces/IImmutableSimulator.sol

11: 		    function getImmutable(address _dest, uint256 _index) external view returns (bytes32);
12: 		
13: 		    function setImmutables(address _dest, ImmutableData[] calldata _immutables) external;
```
[[11-13](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IImmutableSimulator.sol#L11-L13)]



```solidity
File: code/system-contracts/contracts/interfaces/IKnownCodesStorage.sol

14: 		    function markFactoryDeps(bool _shouldSendToL1, bytes32[] calldata _hashes) external;
15: 		
16: 		    function markBytecodeAsPublished(bytes32 _bytecodeHash) external;

16: 		    function markBytecodeAsPublished(bytes32 _bytecodeHash) external;
17: 		
18: 		    function getMarker(bytes32 _hash) external view returns (uint256);
```
[[14-16](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IKnownCodesStorage.sol#L14-L16), [16-18](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IKnownCodesStorage.sol#L16-L18)]



```solidity
File: code/system-contracts/contracts/interfaces/IL1Messenger.sol

49: 		    function sendToL1(bytes memory _message) external returns (bytes32);
50: 		
51: 		    function sendL2ToL1Log(bool _isService, bytes32 _key, bytes32 _value) external returns (uint256 logIdInMerkleTree);
```
[[49-51](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL1Messenger.sol#L49-L51)]



```solidity
File: code/system-contracts/contracts/interfaces/IL2StandardToken.sol

10: 		    function bridgeMint(address _account, uint256 _amount) external;
11: 		
12: 		    function bridgeBurn(address _account, uint256 _amount) external;

12: 		    function bridgeBurn(address _account, uint256 _amount) external;
13: 		
14: 		    function l1Address() external view returns (address);

14: 		    function l1Address() external view returns (address);
15: 		
16: 		    function l2Bridge() external view returns (address);
```
[[10-12](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL2StandardToken.sol#L10-L12), [12-14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL2StandardToken.sol#L12-L14), [14-16](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL2StandardToken.sol#L14-L16)]



```solidity
File: code/system-contracts/contracts/interfaces/IPaymasterFlow.sol

13: 		    function general(bytes calldata input) external;
14: 		
15: 		    function approvalBased(address _token, uint256 _minAllowance, bytes calldata _innerInput) external;
```
[[13-15](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IPaymasterFlow.sol#L13-L15)]



```solidity
File: code/system-contracts/contracts/interfaces/ISystemContext.sol

30: 		    function chainId() external view returns (uint256);
31: 		
32: 		    function origin() external view returns (address);

32: 		    function origin() external view returns (address);
33: 		
34: 		    function gasPrice() external view returns (uint256);

34: 		    function gasPrice() external view returns (uint256);
35: 		
36: 		    function blockGasLimit() external view returns (uint256);

36: 		    function blockGasLimit() external view returns (uint256);
37: 		
38: 		    function coinbase() external view returns (address);

38: 		    function coinbase() external view returns (address);
39: 		
40: 		    function difficulty() external view returns (uint256);

40: 		    function difficulty() external view returns (uint256);
41: 		
42: 		    function baseFee() external view returns (uint256);

42: 		    function baseFee() external view returns (uint256);
43: 		
44: 		    function txNumberInBlock() external view returns (uint16);

44: 		    function txNumberInBlock() external view returns (uint16);
45: 		
46: 		    function getBlockHashEVM(uint256 _block) external view returns (bytes32);

46: 		    function getBlockHashEVM(uint256 _block) external view returns (bytes32);
47: 		
48: 		    function getBatchHash(uint256 _batchNumber) external view returns (bytes32 hash);

48: 		    function getBatchHash(uint256 _batchNumber) external view returns (bytes32 hash);
49: 		
50: 		    function getBlockNumber() external view returns (uint128);

50: 		    function getBlockNumber() external view returns (uint128);
51: 		
52: 		    function getBlockTimestamp() external view returns (uint128);

52: 		    function getBlockTimestamp() external view returns (uint128);
53: 		
54: 		    function getBatchNumberAndTimestamp() external view returns (uint128 blockNumber, uint128 blockTimestamp);

54: 		    function getBatchNumberAndTimestamp() external view returns (uint128 blockNumber, uint128 blockTimestamp);
55: 		
56: 		    function getL2BlockNumberAndTimestamp() external view returns (uint128 blockNumber, uint128 blockTimestamp);

56: 		    function getL2BlockNumberAndTimestamp() external view returns (uint128 blockNumber, uint128 blockTimestamp);
57: 		
58: 		    function gasPerPubdataByte() external view returns (uint256 gasPerPubdataByte);

58: 		    function gasPerPubdataByte() external view returns (uint256 gasPerPubdataByte);
59: 		
60: 		    function getCurrentPubdataSpent() external view returns (uint256 currentPubdataSpent);
```
[[30-32](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L30-L32), [32-34](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L32-L34), [34-36](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L34-L36), [36-38](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L36-L38), [38-40](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L38-L40), [40-42](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L40-L42), [42-44](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L42-L44), [44-46](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L44-L46), [46-48](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L46-L48), [48-50](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L48-L50), [50-52](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L50-L52), [52-54](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L52-L54), [54-56](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L54-L56), [56-58](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L56-L58), [58-60](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L58-L60)]



```solidity
File: code/system-contracts/contracts/interfaces/ISystemContextDeprecated.sol

11: 		    function currentBlockInfo() external view returns (uint256);
12: 		
13: 		    function getBlockNumberAndTimestamp() external view returns (uint256 blockNumber, uint256 blockTimestamp);

13: 		    function getBlockNumberAndTimestamp() external view returns (uint256 blockNumber, uint256 blockTimestamp);
14: 		
15: 		    function blockHash(uint256 _blockNumber) external view returns (bytes32 hash);
```
[[11-13](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContextDeprecated.sol#L11-L13), [13-15](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContextDeprecated.sol#L13-L15)]



```solidity
File: code/system-contracts/contracts/libraries/RLPEncoder.sol

22: 		    }
23: 		
24: 		    function encodeUint256(uint256 _val) internal pure returns (bytes memory encoded) {

58: 		    }
59: 		
60: 		    function _encodeLength(uint64 _len, uint256 _offset) private pure returns (bytes memory encoded) {
```
[[22-24](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/RLPEncoder.sol#L22-L24), [58-60](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/RLPEncoder.sol#L58-L60)]



```solidity
File: code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol

24: 		    }
25: 		
26: 		    function readUint32(bytes calldata _bytes, uint256 _start) internal pure returns (uint32 result) {

31: 		    }
32: 		
33: 		    function readUint64(bytes calldata _bytes, uint256 _start) internal pure returns (uint64 result) {

38: 		    }
39: 		
40: 		    function readBytes32(bytes calldata _bytes, uint256 _start) internal pure returns (bytes32 result) {

44: 		    }
45: 		
46: 		    function readUint256(bytes calldata _bytes, uint256 _start) internal pure returns (uint256 result) {
```
[[24-26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol#L24-L26), [31-33](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol#L31-L33), [38-40](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol#L38-L40), [44-46](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol#L44-L46)]



```solidity
File: code/system-contracts/contracts/libraries/Utils.sol

24: 		    }
25: 		
26: 		    function safeCastToU32(uint256 _x) internal pure returns (uint32) {

30: 		    }
31: 		
32: 		    function safeCastToU24(uint256 _x) internal pure returns (uint24) {
```
[[24-26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L24-L26), [30-32](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L30-L32)]



```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

135: 		    }
136: 		
137: 		    function receiveEth(uint256 _chainId) external payable {

485: 		    }
486: 		
487: 		    function _parseL2WithdrawalMessage(
```
[[135-137](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L135-L137), [485-487](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L485-L487)]



```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

323: 		    }
324: 		
325: 		    function _actualRefundRecipient(address _refundRecipient) internal view returns (address _recipient) {
```
[[323-325](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L323-L325)]



```solidity
File: code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol

59: 		    function stateTransitionManagerIsRegistered(address _stateTransitionManager) external view returns (bool);
60: 		
61: 		    function stateTransitionManager(uint256 _chainId) external view returns (address);

61: 		    function stateTransitionManager(uint256 _chainId) external view returns (address);
62: 		
63: 		    function tokenIsRegistered(address _baseToken) external view returns (bool);

63: 		    function tokenIsRegistered(address _baseToken) external view returns (bool);
64: 		
65: 		    function baseToken(uint256 _chainId) external view returns (address);

65: 		    function baseToken(uint256 _chainId) external view returns (address);
66: 		
67: 		    function sharedBridge() external view returns (IL1SharedBridge);

67: 		    function sharedBridge() external view returns (IL1SharedBridge);
68: 		
69: 		    function getStateTransition(uint256 _chainId) external view returns (address);

79: 		    ) external view returns (bool);
80: 		
81: 		    function proveL2LogInclusion(

87: 		    ) external view returns (bool);
88: 		
89: 		    function proveL1ToL2TransactionStatus(

97: 		    ) external view returns (bool);
98: 		
99: 		    function requestL2TransactionDirect(

101: 		    ) external payable returns (bytes32 canonicalTxHash);
102: 		
103: 		    function requestL2TransactionTwoBridges(

105: 		    ) external payable returns (bytes32 canonicalTxHash);
106: 		
107: 		    function l2TransactionBaseCost(

123: 		    ) external returns (uint256 chainId);
124: 		
125: 		    function addStateTransitionManager(address _stateTransitionManager) external;

125: 		    function addStateTransitionManager(address _stateTransitionManager) external;
126: 		
127: 		    function removeStateTransitionManager(address _stateTransitionManager) external;

127: 		    function removeStateTransitionManager(address _stateTransitionManager) external;
128: 		
129: 		    function addToken(address _token) external;

129: 		    function addToken(address _token) external;
130: 		
131: 		    function setSharedBridge(address _sharedBridge) external;
```
[[59-61](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L59-L61), [61-63](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L61-L63), [63-65](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L63-L65), [65-67](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L65-L67), [67-69](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L67-L69), [79-81](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L79-L81), [87-89](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L87-L89), [97-99](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L97-L99), [101-103](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L101-L103), [105-107](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L105-L107), [123-125](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L123-L125), [125-127](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L125-L127), [127-129](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L127-L129), [129-131](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L129-L131)]



```solidity
File: code/contracts/ethereum/contracts/governance/IGovernance.sol

41: 		    function isOperation(bytes32 _id) external view returns (bool);
42: 		
43: 		    function isOperationPending(bytes32 _id) external view returns (bool);

43: 		    function isOperationPending(bytes32 _id) external view returns (bool);
44: 		
45: 		    function isOperationReady(bytes32 _id) external view returns (bool);

45: 		    function isOperationReady(bytes32 _id) external view returns (bool);
46: 		
47: 		    function isOperationDone(bytes32 _id) external view returns (bool);

47: 		    function isOperationDone(bytes32 _id) external view returns (bool);
48: 		
49: 		    function getOperationState(bytes32 _id) external view returns (OperationState);

49: 		    function getOperationState(bytes32 _id) external view returns (OperationState);
50: 		
51: 		    function scheduleTransparent(Operation calldata _operation, uint256 _delay) external;

51: 		    function scheduleTransparent(Operation calldata _operation, uint256 _delay) external;
52: 		
53: 		    function scheduleShadow(bytes32 _id, uint256 _delay) external;

53: 		    function scheduleShadow(bytes32 _id, uint256 _delay) external;
54: 		
55: 		    function cancel(bytes32 _id) external;

55: 		    function cancel(bytes32 _id) external;
56: 		
57: 		    function execute(Operation calldata _operation) external payable;

57: 		    function execute(Operation calldata _operation) external payable;
58: 		
59: 		    function executeInstant(Operation calldata _operation) external payable;

59: 		    function executeInstant(Operation calldata _operation) external payable;
60: 		
61: 		    function hashOperation(Operation calldata _operation) external pure returns (bytes32);

61: 		    function hashOperation(Operation calldata _operation) external pure returns (bytes32);
62: 		
63: 		    function updateDelay(uint256 _newDelay) external;

63: 		    function updateDelay(uint256 _newDelay) external;
64: 		
65: 		    function updateSecurityCouncil(address _newSecurityCouncil) external;
```
[[41-43](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L41-L43), [43-45](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L43-L45), [45-47](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L45-L47), [47-49](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L47-L49), [49-51](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L49-L51), [51-53](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L51-L53), [53-55](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L53-L55), [55-57](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L55-L57), [57-59](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L57-L59), [59-61](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L59-L61), [61-63](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L61-L63), [63-65](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L63-L65)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol

51: 		    function acceptAdmin() external;
52: 		
53: 		    function stateTransition(uint256 _chainId) external view returns (address);

53: 		    function stateTransition(uint256 _chainId) external view returns (address);
54: 		
55: 		    function storedBatchZero() external view returns (bytes32);

55: 		    function storedBatchZero() external view returns (bytes32);
56: 		
57: 		    function initialCutHash() external view returns (bytes32);

57: 		    function initialCutHash() external view returns (bytes32);
58: 		
59: 		    function genesisUpgrade() external view returns (address);

59: 		    function genesisUpgrade() external view returns (address);
60: 		
61: 		    function upgradeCutHash(uint256 _protocolVersion) external view returns (bytes32);

61: 		    function upgradeCutHash(uint256 _protocolVersion) external view returns (bytes32);
62: 		
63: 		    function protocolVersion() external view returns (uint256);

63: 		    function protocolVersion() external view returns (uint256);
64: 		
65: 		    function initialize(StateTransitionManagerInitializeData calldata _initalizeData) external;

65: 		    function initialize(StateTransitionManagerInitializeData calldata _initalizeData) external;
66: 		
67: 		    function setInitialCutHash(Diamond.DiamondCutData calldata _diamondCut) external;

67: 		    function setInitialCutHash(Diamond.DiamondCutData calldata _diamondCut) external;
68: 		
69: 		    function setValidatorTimelock(address _validatorTimelock) external;

69: 		    function setValidatorTimelock(address _validatorTimelock) external;
70: 		
71: 		    function getChainAdmin(uint256 _chainId) external view returns (address);

80: 		    ) external;
81: 		
82: 		    function registerAlreadyDeployedStateTransition(uint256 _chainId, address _stateTransitionContract) external;

82: 		    function registerAlreadyDeployedStateTransition(uint256 _chainId, address _stateTransitionContract) external;
83: 		
84: 		    function setNewVersionUpgrade(

88: 		    ) external;
89: 		
90: 		    function setUpgradeDiamondCut(Diamond.DiamondCutData calldata _cutData, uint256 _oldProtocolVersion) external;

90: 		    function setUpgradeDiamondCut(Diamond.DiamondCutData calldata _cutData, uint256 _oldProtocolVersion) external;
91: 		
92: 		    function freezeChain(uint256 _chainId) external;

92: 		    function freezeChain(uint256 _chainId) external;
93: 		
94: 		    function unfreezeChain(uint256 _chainId) external;
```
[[51-53](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L51-L53), [53-55](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L53-L55), [55-57](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L55-L57), [57-59](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L57-L59), [59-61](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L59-L61), [61-63](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L61-L63), [63-65](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L63-L65), [65-67](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L65-L67), [67-69](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L67-L69), [69-71](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L69-L71), [80-82](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L80-L82), [82-84](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L82-L84), [88-90](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L88-L90), [90-92](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L90-L92), [92-94](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L92-L94)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

228: 		    }
229: 		
230: 		    function registerAlreadyDeployedStateTransition(
```
[[228-230](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L228-L230)]



```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

157: 		    }
158: 		
159: 		    function name() public view override returns (string memory) {

163: 		    }
164: 		
165: 		    function symbol() public view override returns (string memory) {

169: 		    }
170: 		
171: 		    function decimals() public view override returns (uint8) {
```
[[157-159](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L157-L159), [163-165](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L163-L165), [169-171](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L169-L171)]



```solidity
File: code/contracts/zksync/contracts/interfaces/IPaymasterFlow.sol

14: 		    function general(bytes calldata input) external;
15: 		
16: 		    function approvalBased(address _token, uint256 _minAllowance, bytes calldata _innerInput) external;
```
[[14-16](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/interfaces/IPaymasterFlow.sol#L14-L16)]



```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol

24: 		    function isWithdrawalFinalized(uint256 _l2BatchNumber, uint256 _l2MessageIndex) external view returns (bool);
25: 		
26: 		    function deposit(

33: 		    ) external payable returns (bytes32 txHash);
34: 		
35: 		    function deposit(

41: 		    ) external payable returns (bytes32 txHash);
42: 		
43: 		    function claimFailedDeposit(

51: 		    ) external;
52: 		
53: 		    function finalizeWithdrawal(

59: 		    ) external;
60: 		
61: 		    function l2TokenAddress(address _l1Token) external view returns (address);

61: 		    function l2TokenAddress(address _l1Token) external view returns (address);
62: 		
63: 		    function sharedBridge() external view returns (IL1SharedBridge);

63: 		    function sharedBridge() external view returns (IL1SharedBridge);
64: 		
65: 		    function l2TokenBeacon() external view returns (address);

65: 		    function l2TokenBeacon() external view returns (address);
66: 		
67: 		    function l2Bridge() external view returns (address);

67: 		    function l2Bridge() external view returns (address);
68: 		
69: 		    function depositAmount(

73: 		    ) external returns (uint256 amount);
74: 		
75: 		    function tranferTokenToSharedBridge(address _token, uint256 _amount) external;
```
[[24-26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L24-L26), [33-35](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L33-L35), [41-43](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L41-L43), [51-53](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L51-L53), [59-61](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L59-L61), [61-63](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L61-L63), [63-65](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L63-L65), [65-67](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L65-L67), [67-69](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L67-L69), [73-75](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L73-L75)]



```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol

62: 		    ) external view returns (bool);
63: 		
64: 		    function depositLegacyErc20Bridge(

72: 		    ) external payable returns (bytes32 txHash);
73: 		
74: 		    function claimFailedDepositLegacyErc20Bridge(

83: 		    ) external;
84: 		
85: 		    function claimFailedDeposit(

95: 		    ) external;
96: 		
97: 		    function finalizeWithdrawalLegacyErc20Bridge(

103: 		    ) external returns (address l1Receiver, address l1Token, uint256 amount);
104: 		
105: 		    function finalizeWithdrawal(

112: 		    ) external;
113: 		
114: 		    function l1WethAddress() external view returns (address);

114: 		    function l1WethAddress() external view returns (address);
115: 		
116: 		    function bridgehub() external view returns (IBridgehub);

116: 		    function bridgehub() external view returns (IBridgehub);
117: 		
118: 		    function legacyBridge() external view returns (IL1ERC20Bridge);

118: 		    function legacyBridge() external view returns (IL1ERC20Bridge);
119: 		
120: 		    function l2BridgeAddress(uint256 _chainId) external view returns (address);

120: 		    function l2BridgeAddress(uint256 _chainId) external view returns (address);
121: 		
122: 		    function depositHappened(uint256 _chainId, bytes32 _l2TxHash) external view returns (bytes32);

133: 		    ) external payable returns (L2TransactionRequestTwoBridgesInner memory request);
134: 		
135: 		    function bridgehubDepositBaseToken(

140: 		    ) external payable;
141: 		
142: 		    function bridgehubConfirmL2Transaction(uint256 _chainId, bytes32 _txDataHash, bytes32 _txHash) external;

142: 		    function bridgehubConfirmL2Transaction(uint256 _chainId, bytes32 _txDataHash, bytes32 _txHash) external;
143: 		
144: 		    function receiveEth(uint256 _chainId) external payable;
```
[[62-64](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L62-L64), [72-74](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L72-L74), [83-85](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L83-L85), [95-97](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L95-L97), [103-105](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L103-L105), [112-114](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L112-L114), [114-116](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L114-L116), [116-118](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L116-L118), [118-120](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L118-L120), [120-122](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L120-L122), [133-135](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L133-L135), [140-142](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L140-L142), [142-144](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L142-L144)]



```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL2Bridge.sol

13: 		    ) external payable;
14: 		
15: 		    function withdraw(address _l1Receiver, address _l2Token, uint256 _amount) external;

15: 		    function withdraw(address _l1Receiver, address _l2Token, uint256 _amount) external;
16: 		
17: 		    function l1TokenAddress(address _l2Token) external view returns (address);

17: 		    function l1TokenAddress(address _l2Token) external view returns (address);
18: 		
19: 		    function l2TokenAddress(address _l1Token) external view returns (address);

19: 		    function l2TokenAddress(address _l1Token) external view returns (address);
20: 		
21: 		    function l1Bridge() external view returns (address);
```
[[13-15](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL2Bridge.sol#L13-L15), [15-17](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL2Bridge.sol#L15-L17), [17-19](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL2Bridge.sol#L17-L19), [19-21](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL2Bridge.sol#L19-L21)]



```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IWETH9.sol

5: 		    function deposit() external payable;
6: 		
7: 		    function withdraw(uint256 wad) external;
```
[[5-7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IWETH9.sol#L5-L7)]



```solidity
File: code/contracts/ethereum/contracts/common/libraries/UncheckedMath.sol

15: 		    }
16: 		
17: 		    function uncheckedAdd(uint256 _lhs, uint256 _rhs) internal pure returns (uint256) {
```
[[15-17](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/UncheckedMath.sol#L15-L17)]



```solidity
File: code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol

24: 		    }
25: 		
26: 		    function readAddress(bytes memory _bytes, uint256 _start) internal pure returns (address result, uint256 offset) {

31: 		    }
32: 		
33: 		    function readUint256(bytes memory _bytes, uint256 _start) internal pure returns (uint256 result, uint256 offset) {

38: 		    }
39: 		
40: 		    function readBytes32(bytes memory _bytes, uint256 _start) internal pure returns (bytes32 result, uint256 offset) {
```
[[24-26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol#L24-L26), [31-33](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol#L31-L33), [38-40](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol#L38-L40)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol

43: 		    function setValidiumMode(PubdataPricingMode _validiumMode) external;
44: 		
45: 		    function upgradeChainFromVersion(uint256 _protocolVersion, Diamond.DiamondCutData calldata _cutData) external;
```
[[43-45](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L43-L45)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol

96: 		    ) external payable returns (bytes32 canonicalTxHash);
97: 		
98: 		    function bridgehubRequestL2Transaction(
```
[[96-98](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L96-L98)]



```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol

30: 		    ) external payable;
31: 		
32: 		    function withdraw(address _l1Receiver, address _l2Token, uint256 _amount) external;

32: 		    function withdraw(address _l1Receiver, address _l2Token, uint256 _amount) external;
33: 		
34: 		    function l1TokenAddress(address _l2Token) external view returns (address);

34: 		    function l1TokenAddress(address _l2Token) external view returns (address);
35: 		
36: 		    function l2TokenAddress(address _l1Token) external view returns (address);

36: 		    function l2TokenAddress(address _l1Token) external view returns (address);
37: 		
38: 		    function l1Bridge() external view returns (address);
```
[[30-32](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol#L30-L32), [32-34](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol#L32-L34), [34-36](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol#L34-L36), [36-38](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol#L36-L38)]



```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol

12: 		    function bridgeMint(address _account, uint256 _amount) external;
13: 		
14: 		    function bridgeBurn(address _account, uint256 _amount) external;

14: 		    function bridgeBurn(address _account, uint256 _amount) external;
15: 		
16: 		    function l1Address() external view returns (address);

16: 		    function l1Address() external view returns (address);
17: 		
18: 		    function l2Bridge() external view returns (address);
```
[[12-14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol#L12-L14), [14-16](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol#L14-L16), [16-18](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol#L16-L18)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol

87: 		    }
88: 		
89: 		    function setValidiumMode(PubdataPricingMode _validiumMode) external onlyAdmin {
```
[[87-89](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L87-L89)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

213: 		    }
214: 		
215: 		    function _commitBatches(

347: 		    }
348: 		
349: 		    function _executeBatches(StoredBatchInfo[] calldata _batchesData) internal {

384: 		    }
385: 		
386: 		    function _proveBatches(

438: 		    }
439: 		
440: 		    function _verifyProof(uint256[] memory proofPublicInput, ProofInput calldata _proof) internal view {

479: 		    }
480: 		
481: 		    function _revertBatches(uint256 _newLastBatch) internal {

513: 		    }
514: 		
515: 		    function _batchPassThroughData(CommitBatchInfo calldata _batch) internal pure returns (bytes memory) {

523: 		    }
524: 		
525: 		    function _batchMetaParameters() internal view returns (bytes memory) {

535: 		    }
536: 		
537: 		    function _batchAuxiliaryOutput(
```
[[213-215](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L213-L215), [347-349](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L347-L349), [384-386](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L384-L386), [438-440](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L438-L440), [479-481](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L479-L481), [513-515](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L513-L515), [523-525](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L523-L525), [535-537](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L535-L537)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

226: 		    }
227: 		
228: 		    function _requestL2TransactionSender(

256: 		    }
257: 		
258: 		    function _requestL2Transaction(

287: 		    }
288: 		
289: 		    function _serializeL2Transaction(
```
[[226-228](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L226-L228), [256-258](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L256-L258), [287-289](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L287-L289)]

</details>

---

### [N-57] Use a struct to encapsulate multiple function parameters

If a function has too many parameters, replacing them with a struct can improve code readability and maintainability, increase reusability, and reduce the likelihood of errors when passing the parameters.

*There are 55 instances of this issue.*

<details>
<summary>Expand findings</summary>


```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

321: 		    function _constructContract(
322: 		        address _sender,
323: 		        address _newAddress,
324: 		        bytes32 _bytecodeHash,
325: 		        bytes calldata _input,
326: 		        bool _isSystem,
327: 		        bool _callConstructor
```
[[321-327](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L321-L327)]



```solidity
File: code/system-contracts/contracts/SystemContext.sol

341: 		    function setL2Block(
342: 		        uint128 _l2BlockNumber,
343: 		        uint128 _l2BlockTimestamp,
344: 		        bytes32 _expectedPrevL2BlockHash,
345: 		        bool _isFirstInBatch,
346: 		        uint128 _maxVirtualBlocksToCreate
```
[[341-346](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L341-L346)]



```solidity
File: code/contracts/zksync/contracts/SystemContractsCaller.sol

95: 		    function getFarCallABI(
96: 		        uint32 dataOffset,
97: 		        uint32 memoryPage,
98: 		        uint32 dataStart,
99: 		        uint32 dataLength,
100: 		        uint32 gasPassed,
101: 		        uint8 shardId,
102: 		        CalldataForwardingMode forwardingMode,
103: 		        bool isConstructorCall,
104: 		        bool isSystemCall

121: 		    function getFarCallABIWithEmptyFatPointer(
122: 		        uint32 gasPassed,
123: 		        uint8 shardId,
124: 		        CalldataForwardingMode forwardingMode,
125: 		        bool isConstructorCall,
126: 		        bool isSystemCall
```
[[95-104](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/SystemContractsCaller.sol#L95-L104), [121-126](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/SystemContractsCaller.sol#L121-L126)]



```solidity
File: code/system-contracts/contracts/interfaces/IMailbox.sol

6: 		    function finalizeEthWithdrawal(
7: 		        uint256 _l2BatchNumber,
8: 		        uint256 _l2MessageIndex,
9: 		        uint16 _l2TxNumberInBlock,
10: 		        bytes calldata _message,
11: 		        bytes32[] calldata _merkleProof
```
[[6-11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IMailbox.sol#L6-L11)]



```solidity
File: code/system-contracts/contracts/interfaces/IPaymaster.sol

43: 		    function postTransaction(
44: 		        bytes calldata _context,
45: 		        Transaction calldata _transaction,
46: 		        bytes32 _txHash,
47: 		        bytes32 _suggestedSignedHash,
48: 		        ExecutionResult _txResult,
49: 		        uint256 _maxRefundedGas
```
[[43-49](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IPaymaster.sol#L43-L49)]



```solidity
File: code/system-contracts/contracts/libraries/EfficientCall.sol

58: 		    function call(
59: 		        uint256 _gas,
60: 		        address _address,
61: 		        uint256 _value,
62: 		        bytes calldata _data,
63: 		        bool _isSystem

105: 		    function mimicCall(
106: 		        uint256 _gas,
107: 		        address _address,
108: 		        bytes calldata _data,
109: 		        address _whoToMimic,
110: 		        bool _isConstructor,
111: 		        bool _isSystem

124: 		    function rawCall(
125: 		        uint256 _gas,
126: 		        address _address,
127: 		        uint256 _value,
128: 		        bytes calldata _data,
129: 		        bool _isSystem

191: 		    function rawMimicCall(
192: 		        uint256 _gas,
193: 		        address _address,
194: 		        bytes calldata _data,
195: 		        address _whoToMimic,
196: 		        bool _isConstructor,
197: 		        bool _isSystem
```
[[58-63](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L58-L63), [105-111](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L105-L111), [124-129](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L124-L129), [191-197](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L191-L197)]



```solidity
File: code/system-contracts/contracts/libraries/SystemContractHelper.sol

124: 		    function packPrecompileParams(
125: 		        uint32 _inputMemoryOffset,
126: 		        uint32 _inputMemoryLength,
127: 		        uint32 _outputMemoryOffset,
128: 		        uint32 _outputMemoryLength,
129: 		        uint64 _perPrecompileInterpreted
```
[[124-129](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L124-L129)]



```solidity
File: code/system-contracts/contracts/libraries/SystemContractsCaller.sol

214: 		    function getFarCallABI(
215: 		        uint32 dataOffset,
216: 		        uint32 memoryPage,
217: 		        uint32 dataStart,
218: 		        uint32 dataLength,
219: 		        uint32 gasPassed,
220: 		        uint8 shardId,
221: 		        CalldataForwardingMode forwardingMode,
222: 		        bool isConstructorCall,
223: 		        bool isSystemCall

250: 		    function getFarCallABIWithEmptyFatPointer(
251: 		        uint32 gasPassed,
252: 		        uint8 shardId,
253: 		        CalldataForwardingMode forwardingMode,
254: 		        bool isConstructorCall,
255: 		        bool isSystemCall
```
[[214-223](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L214-L223), [250-255](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L250-L255)]



```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

98: 		    function deposit(
99: 		        address _l2Receiver,
100: 		        address _l1Token,
101: 		        uint256 _amount,
102: 		        uint256 _l2TxGasLimit,
103: 		        uint256 _l2TxGasPerPubdataByte

133: 		    function deposit(
134: 		        address _l2Receiver,
135: 		        address _l1Token,
136: 		        uint256 _amount,
137: 		        uint256 _l2TxGasLimit,
138: 		        uint256 _l2TxGasPerPubdataByte,
139: 		        address _refundRecipient

176: 		    function claimFailedDeposit(
177: 		        address _depositSender,
178: 		        address _l1Token,
179: 		        bytes32 _l2TxHash,
180: 		        uint256 _l2BatchNumber,
181: 		        uint256 _l2MessageIndex,
182: 		        uint16 _l2TxNumberInBatch,
183: 		        bytes32[] calldata _merkleProof

208: 		    function finalizeWithdrawal(
209: 		        uint256 _l2BatchNumber,
210: 		        uint256 _l2MessageIndex,
211: 		        uint16 _l2TxNumberInBatch,
212: 		        bytes calldata _message,
213: 		        bytes32[] calldata _merkleProof
```
[[98-103](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L98-L103), [133-139](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L133-L139), [176-183](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L176-L183), [208-213](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L208-L213)]



```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

277: 		    function claimFailedDeposit(
278: 		        uint256 _chainId,
279: 		        address _depositSender,
280: 		        address _l1Token,
281: 		        uint256 _amount,
282: 		        bytes32 _l2TxHash,
283: 		        uint256 _l2BatchNumber,
284: 		        uint256 _l2MessageIndex,
285: 		        uint16 _l2TxNumberInBatch,
286: 		        bytes32[] calldata _merkleProof

303: 		    function _claimFailedDeposit(
304: 		        bool _checkedInLegacyBridge,
305: 		        uint256 _chainId,
306: 		        address _depositSender,
307: 		        address _l1Token,
308: 		        uint256 _amount,
309: 		        bytes32 _l2TxHash,
310: 		        uint256 _l2BatchNumber,
311: 		        uint256 _l2MessageIndex,
312: 		        uint16 _l2TxNumberInBatch,
313: 		        bytes32[] calldata _merkleProof

385: 		    function finalizeWithdrawal(
386: 		        uint256 _chainId,
387: 		        uint256 _l2BatchNumber,
388: 		        uint256 _l2MessageIndex,
389: 		        uint16 _l2TxNumberInBatch,
390: 		        bytes calldata _message,
391: 		        bytes32[] calldata _merkleProof

409: 		    function _finalizeWithdrawal(
410: 		        uint256 _chainId,
411: 		        uint256 _l2BatchNumber,
412: 		        uint256 _l2MessageIndex,
413: 		        uint16 _l2TxNumberInBatch,
414: 		        bytes calldata _message,
415: 		        bytes32[] calldata _merkleProof

554: 		    function depositLegacyErc20Bridge(
555: 		        address _prevMsgSender,
556: 		        address _l2Receiver,
557: 		        address _l1Token,
558: 		        uint256 _amount,
559: 		        uint256 _l2TxGasLimit,
560: 		        uint256 _l2TxGasPerPubdataByte,
561: 		        address _refundRecipient

615: 		    function finalizeWithdrawalLegacyErc20Bridge(
616: 		        uint256 _l2BatchNumber,
617: 		        uint256 _l2MessageIndex,
618: 		        uint16 _l2TxNumberInBatch,
619: 		        bytes calldata _message,
620: 		        bytes32[] calldata _merkleProof

644: 		    function claimFailedDepositLegacyErc20Bridge(
645: 		        address _depositSender,
646: 		        address _l1Token,
647: 		        uint256 _amount,
648: 		        bytes32 _l2TxHash,
649: 		        uint256 _l2BatchNumber,
650: 		        uint256 _l2MessageIndex,
651: 		        uint16 _l2TxNumberInBatch,
652: 		        bytes32[] calldata _merkleProof
```
[[277-286](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L277-L286), [303-313](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L303-L313), [385-391](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L385-L391), [409-415](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L409-L415), [554-561](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L554-L561), [615-620](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L615-L620), [644-652](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L644-L652)]



```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

114: 		    function createNewChain(
115: 		        uint256 _chainId,
116: 		        address _stateTransitionManager,
117: 		        address _baseToken,
118: 		        uint256, //_salt
119: 		        address _admin,
120: 		        bytes calldata _initData

152: 		    function proveL2MessageInclusion(
153: 		        uint256 _chainId,
154: 		        uint256 _batchNumber,
155: 		        uint256 _index,
156: 		        L2Message calldata _message,
157: 		        bytes32[] calldata _proof

164: 		    function proveL2LogInclusion(
165: 		        uint256 _chainId,
166: 		        uint256 _batchNumber,
167: 		        uint256 _index,
168: 		        L2Log memory _log,
169: 		        bytes32[] calldata _proof

176: 		    function proveL1ToL2TransactionStatus(
177: 		        uint256 _chainId,
178: 		        bytes32 _l2TxHash,
179: 		        uint256 _l2BatchNumber,
180: 		        uint256 _l2MessageIndex,
181: 		        uint16 _l2TxNumberInBatch,
182: 		        bytes32[] calldata _merkleProof,
183: 		        TxStatus _status
```
[[114-120](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L114-L120), [152-157](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L152-L157), [164-169](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L164-L169), [176-183](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L176-L183)]



```solidity
File: code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol

73: 		    function proveL2MessageInclusion(
74: 		        uint256 _chainId,
75: 		        uint256 _batchNumber,
76: 		        uint256 _index,
77: 		        L2Message calldata _message,
78: 		        bytes32[] calldata _proof

81: 		    function proveL2LogInclusion(
82: 		        uint256 _chainId,
83: 		        uint256 _batchNumber,
84: 		        uint256 _index,
85: 		        L2Log memory _log,
86: 		        bytes32[] calldata _proof

89: 		    function proveL1ToL2TransactionStatus(
90: 		        uint256 _chainId,
91: 		        bytes32 _l2TxHash,
92: 		        uint256 _l2BatchNumber,
93: 		        uint256 _l2MessageIndex,
94: 		        uint16 _l2TxNumberInBatch,
95: 		        bytes32[] calldata _merkleProof,
96: 		        TxStatus _status

116: 		    function createNewChain(
117: 		        uint256 _chainId,
118: 		        address _stateTransitionManager,
119: 		        address _baseToken,
120: 		        uint256 _salt,
121: 		        address _admin,
122: 		        bytes calldata _initData
```
[[73-78](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L73-L78), [81-86](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L81-L86), [89-96](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L89-L96), [116-122](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L116-L122)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol

74: 		    function createNewChain(
75: 		        uint256 _chainId,
76: 		        address _baseToken,
77: 		        address _sharedBridge,
78: 		        address _admin,
79: 		        bytes calldata _diamondCut
```
[[74-79](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L74-L79)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

239: 		    function createNewChain(
240: 		        uint256 _chainId,
241: 		        address _baseToken,
242: 		        address _sharedBridge,
243: 		        address _admin,
244: 		        bytes calldata _diamondCut
```
[[239-244](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L239-L244)]



```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

79: 		    function finalizeDeposit(
80: 		        address _l1Sender,
81: 		        address _l2Receiver,
82: 		        address _l1Token,
83: 		        uint256 _amount,
84: 		        bytes calldata _data
```
[[79-84](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L79-L84)]



```solidity
File: code/contracts/zksync/contracts/interfaces/IPaymaster.sol

43: 		    function postTransaction(
44: 		        bytes calldata _context,
45: 		        Transaction calldata _transaction,
46: 		        bytes32 _txHash,
47: 		        bytes32 _suggestedSignedHash,
48: 		        ExecutionResult _txResult,
49: 		        uint256 _maxRefundedGas
```
[[43-49](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/interfaces/IPaymaster.sol#L43-L49)]



```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol

26: 		    function deposit(
27: 		        address _l2Receiver,
28: 		        address _l1Token,
29: 		        uint256 _amount,
30: 		        uint256 _l2TxGasLimit,
31: 		        uint256 _l2TxGasPerPubdataByte,
32: 		        address _refundRecipient

35: 		    function deposit(
36: 		        address _l2Receiver,
37: 		        address _l1Token,
38: 		        uint256 _amount,
39: 		        uint256 _l2TxGasLimit,
40: 		        uint256 _l2TxGasPerPubdataByte

43: 		    function claimFailedDeposit(
44: 		        address _depositSender,
45: 		        address _l1Token,
46: 		        bytes32 _l2TxHash,
47: 		        uint256 _l2BatchNumber,
48: 		        uint256 _l2MessageIndex,
49: 		        uint16 _l2TxNumberInBatch,
50: 		        bytes32[] calldata _merkleProof

53: 		    function finalizeWithdrawal(
54: 		        uint256 _l2BatchNumber,
55: 		        uint256 _l2MessageIndex,
56: 		        uint16 _l2TxNumberInBatch,
57: 		        bytes calldata _message,
58: 		        bytes32[] calldata _merkleProof
```
[[26-32](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L26-L32), [35-40](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L35-L40), [43-50](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L43-L50), [53-58](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L53-L58)]



```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol

64: 		    function depositLegacyErc20Bridge(
65: 		        address _msgSender,
66: 		        address _l2Receiver,
67: 		        address _l1Token,
68: 		        uint256 _amount,
69: 		        uint256 _l2TxGasLimit,
70: 		        uint256 _l2TxGasPerPubdataByte,
71: 		        address _refundRecipient

74: 		    function claimFailedDepositLegacyErc20Bridge(
75: 		        address _depositSender,
76: 		        address _l1Token,
77: 		        uint256 _amount,
78: 		        bytes32 _l2TxHash,
79: 		        uint256 _l2BatchNumber,
80: 		        uint256 _l2MessageIndex,
81: 		        uint16 _l2TxNumberInBatch,
82: 		        bytes32[] calldata _merkleProof

85: 		    function claimFailedDeposit(
86: 		        uint256 _chainId,
87: 		        address _depositSender,
88: 		        address _l1Token,
89: 		        uint256 _amount,
90: 		        bytes32 _l2TxHash,
91: 		        uint256 _l2BatchNumber,
92: 		        uint256 _l2MessageIndex,
93: 		        uint16 _l2TxNumberInBatch,
94: 		        bytes32[] calldata _merkleProof

97: 		    function finalizeWithdrawalLegacyErc20Bridge(
98: 		        uint256 _l2BatchNumber,
99: 		        uint256 _l2MessageIndex,
100: 		        uint16 _l2TxNumberInBatch,
101: 		        bytes calldata _message,
102: 		        bytes32[] calldata _merkleProof

105: 		    function finalizeWithdrawal(
106: 		        uint256 _chainId,
107: 		        uint256 _l2BatchNumber,
108: 		        uint256 _l2MessageIndex,
109: 		        uint16 _l2TxNumberInBatch,
110: 		        bytes calldata _message,
111: 		        bytes32[] calldata _merkleProof
```
[[64-71](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L64-L71), [74-82](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L74-L82), [85-94](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L85-L94), [97-102](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L97-L102), [105-111](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L105-L111)]



```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL2Bridge.sol

7: 		    function finalizeDeposit(
8: 		        address _l1Sender,
9: 		        address _l2Receiver,
10: 		        address _l1Token,
11: 		        uint256 _amount,
12: 		        bytes calldata _data
```
[[7-12](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL2Bridge.sol#L7-L12)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol

47: 		    function proveL1ToL2TransactionStatus(
48: 		        bytes32 _l2TxHash,
49: 		        uint256 _l2BatchNumber,
50: 		        uint256 _l2MessageIndex,
51: 		        uint16 _l2TxNumberInBatch,
52: 		        bytes32[] calldata _merkleProof,
53: 		        TxStatus _status

62: 		    function finalizeEthWithdrawal(
63: 		        uint256 _l2BatchNumber,
64: 		        uint256 _l2MessageIndex,
65: 		        uint16 _l2TxNumberInBatch,
66: 		        bytes calldata _message,
67: 		        bytes32[] calldata _merkleProof

88: 		    function requestL2Transaction(
89: 		        address _contractL2,
90: 		        uint256 _l2Value,
91: 		        bytes calldata _calldata,
92: 		        uint256 _l2GasLimit,
93: 		        uint256 _l2GasPerPubdataByteLimit,
94: 		        bytes[] calldata _factoryDeps,
95: 		        address _refundRecipient
```
[[47-53](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L47-L53), [62-67](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L62-L67), [88-95](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L88-L95)]



```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL1ERC20Bridge.sol

9: 		    function finalizeWithdrawal(
10: 		        uint256 _l2BatchNumber,
11: 		        uint256 _l2MessageIndex,
12: 		        uint16 _l2TxNumberInBatch,
13: 		        bytes calldata _message,
14: 		        bytes32[] calldata _merkleProof
```
[[9-14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L9-L14)]



```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL1SharedBridge.sol

9: 		    function finalizeWithdrawal(
10: 		        uint256 _chainId,
11: 		        uint256 _l2BatchNumber,
12: 		        uint256 _l2MessageIndex,
13: 		        uint16 _l2TxNumberInBatch,
14: 		        bytes calldata _message,
15: 		        bytes32[] calldata _merkleProof
```
[[9-15](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL1SharedBridge.sol#L9-L15)]



```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol

24: 		    function finalizeDeposit(
25: 		        address _l1Sender,
26: 		        address _l2Receiver,
27: 		        address _l1Token,
28: 		        uint256 _amount,
29: 		        bytes calldata _data
```
[[24-29](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol#L24-L29)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

74: 		    function proveL1ToL2TransactionStatus(
75: 		        bytes32 _l2TxHash,
76: 		        uint256 _l2BatchNumber,
77: 		        uint256 _l2MessageIndex,
78: 		        uint16 _l2TxNumberInBatch,
79: 		        bytes32[] calldata _merkleProof,
80: 		        TxStatus _status

178: 		    function finalizeEthWithdrawal(
179: 		        uint256 _l2BatchNumber,
180: 		        uint256 _l2MessageIndex,
181: 		        uint16 _l2TxNumberInBatch,
182: 		        bytes calldata _message,
183: 		        bytes32[] calldata _merkleProof

197: 		    function requestL2Transaction(
198: 		        address _contractL2,
199: 		        uint256 _l2Value,
200: 		        bytes calldata _calldata,
201: 		        uint256 _l2GasLimit,
202: 		        uint256 _l2GasPerPubdataByteLimit,
203: 		        bytes[] calldata _factoryDeps,
204: 		        address _refundRecipient
```
[[74-80](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L74-L80), [178-183](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L178-L183), [197-204](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L197-L204)]

</details>

---

### [N-58] Unresolved `TODOs` in comments

Some features might not be properly implemented, as there are commented `TODOs`. Review the comments to ensure that everything is implemented, and remove them before deploying.

*There are 3 instances of this issue.*


```solidity
File: code/contracts/ethereum/contracts/common/Config.sol

21: 		// TODO: change constant to the real root hash of empty Merkle tree (SMA-184)
```
[[21](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/Config.sol#L21)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol

16: 		    // KL todo: need this in the server for now
```
[[16](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol#L16)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

338: 		                layer2Tip: uint192(0) // TODO: Restore after fee modeling will be stable. (SMA-1230)
```
[[338](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L338)]


---

### [N-59] Event is missing `msg.sender` parameter

The following functions are missing some parameters when emitting an event: when dealing with a source address which uses the value of `msg.sender`, the `msg.sender` value should be specified in every event.

Otherwise, a contract or web page listening to events cannot react to connected users: basically, those events cannot be used properly.

*There are 69 instances of this issue.*

<details>
<summary>Expand findings</summary>


```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

355: 		        emit ContractDeployed(_sender, _bytecodeHash, _newAddress);
```
[[355](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L355)]



```solidity
File: code/system-contracts/contracts/KnownCodesStorage.sol

59: 		            emit MarkedAsKnown(_bytecodeHash, _shouldSendToL1);
```
[[59](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/KnownCodesStorage.sol#L59)]



```solidity
File: code/system-contracts/contracts/L1Messenger.sol

111: 		        emit L2ToL1LogSent(_l2ToL1Log);

181: 		        emit BytecodeL1PublicationRequested(_bytecodeHash);
```
[[111](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L111), [181](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L181)]



```solidity
File: code/system-contracts/contracts/L2BaseToken.sol

49: 		        emit Transfer(_from, _to, _amount);

67: 		        emit Mint(_account, _amount);
```
[[49](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L2BaseToken.sol#L49), [67](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L2BaseToken.sol#L67)]



```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

199: 		        emit ClaimedFailedDeposit(_depositSender, _l1Token, amount);

225: 		        emit WithdrawalFinalized(l1Receiver, l1Token, amount);
```
[[199](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L199), [225](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L225)]



```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

168: 		        emit BridgehubDepositBaseTokenInitiated(_chainId, _prevMsgSender, _l1Token, _amount);

227: 		        emit BridgehubDepositInitiated(_chainId, txDataHash, _prevMsgSender, _l2Receiver, _l1Token, amount);

239: 		        emit BridgehubDepositFinalized(_chainId, _txDataHash, _txHash);

367: 		        emit ClaimedFailedDepositSharedBridge(_chainId, _depositSender, _l1Token, _amount);

454: 		        emit WithdrawalFinalizedSharedBridge(_chainId, l1Receiver, l1Token, amount);

602: 		        emit LegacyDepositInitiated(ERA_CHAIN_ID, l2TxHash, _prevMsgSender, _l2Receiver, _l1Token, _amount);
```
[[168](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L168), [227](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L227), [239](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L239), [367](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L367), [454](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L454), [602](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L602)]



```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

56: 		        emit NewPendingAdmin(oldPendingAdmin, _newPendingAdmin);

68: 		        emit NewPendingAdmin(currentPendingAdmin, address(0));

69: 		        emit NewAdmin(previousAdmin, pendingAdmin);

145: 		        emit NewChain(_chainId, _stateTransitionManager, _admin);
```
[[56](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L56), [68](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L68), [69](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L69), [145](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L145)]



```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

47: 		        emit ChangeSecurityCouncil(address(0), _securityCouncil);

50: 		        emit ChangeMinDelay(0, _minDelay);

132: 		        emit TransparentOperationScheduled(id, _delay, _operation);

144: 		        emit ShadowOperationScheduled(_id, _delay);

157: 		        emit OperationCancelled(_id);

180: 		        emit OperationExecuted(id);

199: 		        emit OperationExecuted(id);

250: 		        emit ChangeMinDelay(minDelay, _newDelay);

257: 		        emit ChangeSecurityCouncil(securityCouncil, _newSecurityCouncil);
```
[[47](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L47), [50](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L50), [132](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L132), [144](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L144), [157](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L157), [180](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L180), [199](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L199), [250](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L250), [257](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L257)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

115: 		        emit NewPendingAdmin(oldPendingAdmin, _newPendingAdmin);

127: 		        emit NewPendingAdmin(currentPendingAdmin, address(0));

128: 		        emit NewAdmin(previousAdmin, pendingAdmin);

227: 		        emit SetChainIdUpgrade(_chainContract, l2ProtocolUpgradeTx, protocolVersion);

235: 		        emit StateTransitionNewChain(_chainId, _stateTransitionContract);

287: 		        emit StateTransitionNewChain(_chainId, stateTransitionAddress);
```
[[115](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L115), [127](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L127), [128](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L128), [227](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L227), [235](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L235), [287](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L287)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

83: 		        emit ValidatorAdded(_chainId, _newValidator);

92: 		        emit ValidatorRemoved(_chainId, _validator);

98: 		        emit NewExecutionDelay(_executionDelay);
```
[[83](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L83), [92](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L92), [98](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L98)]



```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol

87: 		        emit UpgradeComplete(_proposedUpgrade.newProtocolVersion, txHash, _proposedUpgrade);

104: 		        emit NewL2DefaultAccountBytecodeHash(previousDefaultAccountBytecodeHash, _l2DefaultAccountBytecodeHash);

121: 		        emit NewL2BootloaderBytecodeHash(previousBootloaderBytecodeHash, _l2BootloaderBytecodeHash);

137: 		        emit NewVerifier(address(oldVerifier), address(_newVerifier));

157: 		        emit NewVerifierParams(oldVerifierParams, _newVerifierParams);

256: 		        emit NewProtocolVersion(previousProtocolVersion, _newProtocolVersion);
```
[[87](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L87), [104](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L104), [121](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L121), [137](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L137), [157](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L157), [256](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L256)]



```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol

40: 		        emit NewProtocolVersion(previousProtocolVersion, _newProtocolVersion);

67: 		        emit UpgradeComplete(_proposedUpgrade.newProtocolVersion, txHash, _proposedUpgrade);
```
[[40](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L40), [67](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L67)]



```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

105: 		        emit FinalizeDeposit(_l1Sender, _l2Receiver, expectedL2Token, _amount);
```
[[105](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L105)]



```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

101: 		        emit BridgeInitialize(_l1Address, decodedName, decodedSymbol, decimals_);

126: 		        emit BridgeInitialize(l1Address, _newName, _newSymbol, decimals_);

147: 		        emit BridgeMint(_to, _amount);

156: 		        emit BridgeBurn(_from, _amount);
```
[[101](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L101), [126](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L126), [147](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L147), [156](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L156)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol

121: 		        emit DiamondCut(facetCuts, initAddress, initCalldata);
```
[[121](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L121)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol

28: 		        emit NewPendingAdmin(oldPendingAdmin, _newPendingAdmin);

40: 		        emit NewPendingAdmin(pendingAdmin, address(0));

41: 		        emit NewAdmin(previousAdmin, pendingAdmin);

47: 		        emit ValidatorStatusUpdate(_validator, _active);

54: 		        emit IsPorterAvailableStatusUpdate(_zkPorterIsAvailable);

63: 		        emit NewPriorityTxMaxGasLimit(oldPriorityTxMaxGasLimit, _newPriorityTxMaxGasLimit);

75: 		        emit NewFeeParams(oldFeeParams, _newFeeParams);

86: 		        emit NewBaseTokenMultiplier(oldNominator, oldDenominator, _nominator, _denominator);

92: 		        emit ValidiumModeStatusUpdate(_validiumMode);

115: 		        emit ExecuteUpgrade(_diamondCut);

125: 		        emit ExecuteUpgrade(_diamondCut);

139: 		        emit Freeze();

149: 		        emit Unfreeze();
```
[[28](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L28), [40](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L40), [41](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L41), [47](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L47), [54](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L54), [63](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L63), [75](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L75), [86](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L86), [92](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L92), [115](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L115), [125](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L125), [139](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L139), [149](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L149)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

261: 		            emit BlockCommit(
262: 		                _lastCommittedBatchData.batchNumber,
263: 		                _lastCommittedBatchData.batchHash,
264: 		                _lastCommittedBatchData.commitment
265: 		            );

299: 		            emit BlockCommit(
300: 		                _lastCommittedBatchData.batchNumber,
301: 		                _lastCommittedBatchData.batchHash,
302: 		                _lastCommittedBatchData.commitment
303: 		            );

353: 		            emit BlockExecution(_batchesData[i].batchNumber, _batchesData[i].batchHash, _batchesData[i].commitment);

436: 		        emit BlocksVerification(s.totalBatchesVerified, currentTotalBatchesVerified);

496: 		        emit BlocksRevert(s.totalBatchesCommitted, s.totalBatchesVerified, s.totalBatchesExecuted);
```
[[261-265](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L261-L265), [299-303](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L299-L303), [353](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L353), [436](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L436), [496](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L496)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

343: 		        emit NewPriorityRequest(
344: 		            _priorityOpParams.txId,
345: 		            canonicalTxHash,
346: 		            _priorityOpParams.expirationTimestamp,
347: 		            transaction,
348: 		            _factoryDeps
349: 		        );
```
[[343-349](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L343-L349)]

</details>

---

### [N-60] Events should use parameters to convey information

As an example, rather than using `event Paused()` and `event Unpaused()`, it would be preferable to use event `PauseState(address indexed operator, bool isPaused)`.

*There are 2 instances of this issue.*


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol

94: 		    event Freeze();

97: 		    event Unfreeze();
```
[[94](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L94), [97](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L97)]


---

### [N-61] Events should emit both new and old values

Events are generally emitted when sensitive changes are made to the contracts.

However, some are missing important parameters, as they should include both the new value and old value where possible.

*There are 2 instances of this issue.*


```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

68: 		        emit AccountVersionUpdated(msg.sender, _version);
```
[[68](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L68)]



```solidity
File: code/system-contracts/contracts/NonceHolder.sol

96: 		        emit ValueSetUnderNonce(msg.sender, _key, _value);
```
[[96](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/NonceHolder.sol#L96)]


---

### [N-62] Events may be emitted out of order due to reentrancy

If a reentrancy occurs, some events may be emitted in an unexpected order, and this may be a problem if a third party expects a specific order for these events. Ensure that events follow the best practice of CEI.

*There are 18 instances of this issue.*

<details>
<summary>Expand findings</summary>


```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

// @audit sharedBridge.claimFailedDepositLegacyErc20Bridge(
            _depositSender,
            _l1Token,
            amount,
            _l2TxHash,
            _l2BatchNumber,
            _l2MessageIndex,
            _l2TxNumberInBatch,
            _merkleProof
        )
199: 		        emit ClaimedFailedDeposit(_depositSender, _l1Token, amount);

// @audit sharedBridge.finalizeWithdrawalLegacyErc20Bridge(
            _l2BatchNumber,
            _l2MessageIndex,
            _l2TxNumberInBatch,
            _message,
            _merkleProof
        )
225: 		        emit WithdrawalFinalized(l1Receiver, l1Token, amount);
```
[[199](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L199), [225](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L225)]



```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

// @audit bridgehub.baseToken(_chainId)
227: 		        emit BridgehubDepositInitiated(_chainId, txDataHash, _prevMsgSender, _l2Receiver, _l1Token, amount);

// @audit bridgehub.proveL1ToL2TransactionStatus(
                _chainId,
                _l2TxHash,
                _l2BatchNumber,
                _l2MessageIndex,
                _l2TxNumberInBatch,
                _merkleProof,
                TxStatus.Failure
            )
367: 		        emit ClaimedFailedDepositSharedBridge(_chainId, _depositSender, _l1Token, _amount);

// @audit IGetters(ERA_DIAMOND_PROXY).isEthWithdrawalFinalized(
                _l2BatchNumber,
                _l2MessageIndex
            )
454: 		        emit WithdrawalFinalizedSharedBridge(_chainId, l1Receiver, l1Token, amount);
```
[[227](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L227), [367](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L367), [454](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L454)]



```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

// @audit IStateTransitionManager(_stateTransitionManager).createNewChain(
            _chainId,
            _baseToken,
            address(sharedBridge),
            _admin,
            _initData
        )
145: 		        emit NewChain(_chainId, _stateTransitionManager, _admin);
```
[[145](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L145)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

// @audit IAdmin(_chainContract).executeUpgrade(cutData)
227: 		        emit SetChainIdUpgrade(_chainContract, l2ProtocolUpgradeTx, protocolVersion);

// @audit bytes.concat(
            IDiamondInit.initialize.selector,
            bytes32(_chainId),
            bytes32(uint256(uint160(bridgehub))),
            bytes32(uint256(uint160(address(this)))),
            bytes32(uint256(protocolVersion)),
            bytes32(uint256(uint160(_admin))),
            bytes32(uint256(uint160(validatorTimelock))),
            bytes32(uint256(uint160(_baseToken))),
            bytes32(uint256(uint160(_sharedBridge))),
            bytes32(storedBatchZero),
            diamondCut.initCalldata
        )
287: 		        emit StateTransitionNewChain(_chainId, stateTransitionAddress);
```
[[227](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L227), [287](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L287)]



```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

// @audit IL2StandardToken(expectedL2Token).bridgeMint(_l2Receiver, _amount)
105: 		        emit FinalizeDeposit(_l1Sender, _l2Receiver, expectedL2Token, _amount);

// @audit IL2StandardToken(_l2Token).bridgeBurn(msg.sender, _amount)
134: 		        emit WithdrawalInitiated(msg.sender, _l1Receiver, _l2Token, _amount);
```
[[105](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L105), [134](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L134)]



```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

// @audit UpgradeableBeacon(beaconAddress).owner()
126: 		        emit BridgeInitialize(l1Address, _newName, _newSymbol, decimals_);
```
[[126](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L126)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol

// @audit i.uncheckedInc()
121: 		        emit DiamondCut(facetCuts, initAddress, initCalldata);
```
[[121](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L121)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol

// @audit IStateTransitionManager(s.stateTransitionManager).upgradeCutHash(_oldProtocolVersion)
115: 		        emit ExecuteUpgrade(_diamondCut);
```
[[115](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L115)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

// @audit i.uncheckedInc()
261: 		            emit BlockCommit(
262: 		                _lastCommittedBatchData.batchNumber,
263: 		                _lastCommittedBatchData.batchHash,
264: 		                _lastCommittedBatchData.commitment
265: 		            );

// @audit i.uncheckedInc()
299: 		            emit BlockCommit(
300: 		                _lastCommittedBatchData.batchNumber,
301: 		                _lastCommittedBatchData.batchHash,
302: 		                _lastCommittedBatchData.commitment
303: 		            );

// @audit i.uncheckedInc()
353: 		            emit BlockExecution(_batchesData[i].batchNumber, _batchesData[i].batchHash, _batchesData[i].commitment);

// @audit i.uncheckedInc()
436: 		        emit BlocksVerification(s.totalBatchesVerified, currentTotalBatchesVerified);
```
[[261-265](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L261-L265), [299-303](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L299-L303), [353](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L353), [436](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L436)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

// @audit s.priorityQueue.pushBack(
            PriorityOperation({
                canonicalTxHash: canonicalTxHash,
                expirationTimestamp: _priorityOpParams.expirationTimestamp,
                layer2Tip: uint192(0) // TODO: Restore after fee modeling will be stable. (SMA-1230)
            })
        )
343: 		        emit NewPriorityRequest(
344: 		            _priorityOpParams.txId,
345: 		            canonicalTxHash,
346: 		            _priorityOpParams.expirationTimestamp,
347: 		            transaction,
348: 		            _factoryDeps
349: 		        );
```
[[343-349](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L343-L349)]

</details>

---

### [N-63] Use of polymorphism is discouraged for security audits

A duplicated function name in the same contract might have problems with automated auditing tools, so it should be avoided. Consider always using a different name for functions to improve the readability of the code.

*There are 2 instances of this issue.*


```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

// @audit found also on line 98
133: 		    function deposit(
```
[[133](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L133)]



```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol

// @audit found also on line 26
35: 		    function deposit(
```
[[35](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L35)]


---

### [N-64] Avoid external calls in modifiers

It is unusual to have external calls in modifiers, and doing so will make reviewers more likely to miss important external interactions. Consider moving the external call to an internal function, and calling that function from the modifier.

*There are 5 instances of this issue.*


```solidity
File: code/system-contracts/contracts/DefaultAccount.sol

46: 		        address codeAddress = SystemContractHelper.getCodeAddress();
```
[[46](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L46)]



```solidity
File: code/system-contracts/contracts/interfaces/ISystemContract.sol

22: 		            SystemContractHelper.isSystemCall() || SystemContractHelper.isSystemContract(msg.sender),

22: 		            SystemContractHelper.isSystemCall() || SystemContractHelper.isSystemContract(msg.sender),

32: 		            SystemContractHelper.isSystemContract(msg.sender),
```
[[22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContract.sol#L22), [22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContract.sol#L22), [32](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContract.sol#L32)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

62: 		        require(msg.sender == stateTransitionManager.getChainAdmin(_chainId), "ValidatorTimelock: only chain admin");
```
[[62](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L62)]


---

### [N-65] Use a `modifier` instead of `require` to check for `msg.sender`

If some functions are only allowed to be called by some specific users, consider using a `modifier` instead of checking with a `require` statement, especially if this check is done in multiple functions.

*There are 14 instances of this issue.*

<details>
<summary>Expand findings</summary>


```solidity
File: code/system-contracts/contracts/ComplexUpgrader.sol

22: 		        require(msg.sender == FORCE_DEPLOYER, "Can only be called by FORCE_DEPLOYER");
```
[[22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ComplexUpgrader.sol#L22)]



```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

239: 		        require(
240: 		            msg.sender == FORCE_DEPLOYER || msg.sender == address(COMPLEX_UPGRADER_CONTRACT),
241: 		            "Can only be called by FORCE_DEPLOYER or COMPLEX_UPGRADER_CONTRACT"
242: 		        );
```
[[239-242](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L239-L242)]



```solidity
File: code/system-contracts/contracts/DefaultAccount.sol

222: 		        assert(msg.sender != BOOTLOADER_FORMAL_ADDRESS);
```
[[222](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L222)]



```solidity
File: code/system-contracts/contracts/ImmutableSimulator.sol

35: 		        require(msg.sender == address(DEPLOYER_SYSTEM_CONTRACT), "Callable only by the deployer system contract");
```
[[35](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ImmutableSimulator.sol#L35)]



```solidity
File: code/system-contracts/contracts/L2BaseToken.sol

33: 		        require(
34: 		            msg.sender == MSG_VALUE_SYSTEM_CONTRACT ||
35: 		                msg.sender == address(DEPLOYER_SYSTEM_CONTRACT) ||
36: 		                msg.sender == BOOTLOADER_FORMAL_ADDRESS,
37: 		            "Only system contracts with special access can call this method"
38: 		        );
```
[[33-38](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L2BaseToken.sol#L33-L38)]



```solidity
File: code/system-contracts/contracts/NonceHolder.sol

89: 		            require(isNonceUsed(msg.sender, _key - 1), "Previous nonce has not been used");

136: 		        require(
137: 		            msg.sender == address(DEPLOYER_SYSTEM_CONTRACT),
138: 		            "Only the contract deployer can increment the deployment nonce"
139: 		        );
```
[[89](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/NonceHolder.sol#L89), [136-139](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/NonceHolder.sol#L136-L139)]



```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

64: 		        require(msg.sender == address(sharedBridge), "Not shared bridge");
```
[[64](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L64)]



```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

138: 		        require(bridgehub.getStateTransition(_chainId) == msg.sender, "receiveEth not state transition");
```
[[138](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L138)]



```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

62: 		        require(msg.sender == currentPendingAdmin, "n42"); // Only proposed by current admin address can claim the admin rights
```
[[62](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L62)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

121: 		        require(msg.sender == currentPendingAdmin, "n42"); // Only proposed by current admin address can claim the admin rights
```
[[121](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L121)]



```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

87: 		        require(
88: 		            AddressAliasHelper.undoL1ToL2Alias(msg.sender) == l1Bridge ||
89: 		                AddressAliasHelper.undoL1ToL2Alias(msg.sender) == l1LegacyBridge,
90: 		            "mq"
91: 		        );
```
[[87-91](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L87-L91)]



```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

120: 		        require(msg.sender == UpgradeableBeacon(beaconAddress).owner(), "tt");
```
[[120](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L120)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol

34: 		        require(msg.sender == pendingAdmin, "n4"); // Only proposed by current admin address can claim the admin rights
```
[[34](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L34)]

</details>

---

### [N-66] Constants in comparisons should appear on the left side

This is useful to avoid doing some [typo bugs](https://www.moserware.com/2008/01/constants-on-left-are-better-but-this.html).

*There are 110 instances of this issue.*

<details>
<summary>Expand findings</summary>


```solidity
File: code/system-contracts/contracts/AccountCodeStorage.sol

102: 		        if (codeHash == 0x00 && NONCE_HOLDER_SYSTEM_CONTRACT.getRawNonce(account) > 0) {

133: 		            codeHash != 0x00 &&
```
[[102](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L102), [133](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L133)]



```solidity
File: code/system-contracts/contracts/BootloaderUtilities.sol

69: 		            if (txDataLen != 1) {

92: 		            require(vInt == 27 || vInt == 28, "Invalid v value");

92: 		            require(vInt == 27 || vInt == 28, "Invalid v value");

96: 		            if (_transaction.reserved[0] != 0) {

165: 		            if (txDataLen != 1) {

191: 		            require(vInt == 27 || vInt == 28, "Invalid v value");

191: 		            require(vInt == 27 || vInt == 28, "Invalid v value");

260: 		            if (txDataLen != 1) {

286: 		            require(vInt == 27 || vInt == 28, "Invalid v value");

286: 		            require(vInt == 27 || vInt == 28, "Invalid v value");
```
[[69](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L69), [92](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L92), [92](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L92), [96](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L96), [165](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L165), [191](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L191), [191](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L191), [260](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L260), [286](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L286), [286](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L286)]



```solidity
File: code/system-contracts/contracts/Compressor.sol

130: 		            if (enumIndex != 0) {

146: 		            uint8 len = operation == 0 ? 32 : metadata >> LENGTH_BITS_OFFSET;

162: 		            if (enumIndex == 0) {

177: 		            uint8 len = operation == 0 ? 32 : metadata >> LENGTH_BITS_OFFSET;

229: 		            if (_operation == 0 || _operation == 3) {

229: 		            if (_operation == 0 || _operation == 3) {

231: 		            } else if (_operation == 1) {

236: 		            } else if (_operation == 2) {
```
[[130](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L130), [146](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L146), [162](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L162), [177](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L177), [229](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L229), [229](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L229), [231](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L231), [236](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L236)]



```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

49: 		            ACCOUNT_CODE_STORAGE_SYSTEM_CONTRACT.getRawCodeHash(_address) == 0

269: 		            ACCOUNT_CODE_STORAGE_SYSTEM_CONTRACT.getCodeHash(uint256(uint160(_newAddress))) == 0x0,

273: 		        require(NONCE_HOLDER_SYSTEM_CONTRACT.getRawNonce(_newAddress) == 0x00, "Account is occupied");

350: 		            require(value == 0, "The value must be zero if we do not call the constructor");
```
[[49](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L49), [269](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L269), [273](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L273), [350](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L350)]



```solidity
File: code/system-contracts/contracts/DefaultAccount.sol

160: 		        require(_signature.length == 65, "Signature length is incorrect");

173: 		        require(v == 27 || v == 28, "v is neither 27 nor 28");

173: 		        require(v == 27 || v == 28, "v is neither 27 nor 28");
```
[[160](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L160), [173](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L173), [173](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L173)]



```solidity
File: code/system-contracts/contracts/GasBoundCaller.sol

73: 		        if (pubdataCost != 0) {
```
[[73](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/GasBoundCaller.sol#L73)]



```solidity
File: code/system-contracts/contracts/KnownCodesStorage.sol

47: 		        if (getMarker(_bytecodeHash) == 0) {

76: 		        require(version == 1 && _bytecodeHash[1] == bytes1(0), "Incorrectly formatted bytecodeHash");

78: 		        require(Utils.bytecodeLenInWords(_bytecodeHash) % 2 == 1, "Code length in words must be odd");
```
[[47](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/KnownCodesStorage.sol#L47), [76](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/KnownCodesStorage.sol#L76), [78](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/KnownCodesStorage.sol#L78)]



```solidity
File: code/system-contracts/contracts/MsgValueSimulator.sol

30: 		        isSystemCall = (mask & MSG_VALUE_SIMULATOR_IS_SYSTEM_BIT) != 0;

62: 		        if (value != 0) {
```
[[30](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/MsgValueSimulator.sol#L30), [62](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/MsgValueSimulator.sol#L62)]



```solidity
File: code/system-contracts/contracts/NonceHolder.sol

85: 		        require(_value != 0, "Nonce value cannot be set to 0");

88: 		        if (accountInfo.nonceOrdering == IContractDeployer.AccountNonceOrdering.Sequential && _key != 0) {
```
[[85](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/NonceHolder.sol#L85), [88](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/NonceHolder.sol#L88)]



```solidity
File: code/system-contracts/contracts/SystemContext.sol

268: 		        if (virtualBlockUpgradeInfo.virtualBlockFinishL2Block != 0) {

277: 		        if (currentVirtualL2BlockInfo.number == 0 && virtualBlockInfo.timestamp == 0) {

277: 		        if (currentVirtualL2BlockInfo.number == 0 && virtualBlockInfo.timestamp == 0) {

289: 		        } else if (_maxVirtualBlocksToCreate == 0) {

360: 		        if (currentL2BlockNumber == 0 && currentL2BlockTimestamp == 0) {

360: 		        if (currentL2BlockNumber == 0 && currentL2BlockTimestamp == 0) {

373: 		            require(_maxVirtualBlocksToCreate == 0, "Can not create virtual blocks in the middle of the miniblock");
```
[[268](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L268), [277](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L277), [277](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L277), [289](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L289), [360](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L360), [360](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L360), [373](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L373)]



```solidity
File: code/contracts/zksync/contracts/SystemContractsCaller.sol

59: 		        if (value == 0) {
```
[[59](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/SystemContractsCaller.sol#L59)]



```solidity
File: code/system-contracts/contracts/libraries/EfficientCall.sol

38: 		        require(returnData.length == 32, "keccak256 returned invalid data");

47: 		        require(returnData.length == 32, "sha returned invalid data");

131: 		        if (_value == 0) {
```
[[38](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L38), [47](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L47), [131](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L131)]



```solidity
File: code/system-contracts/contracts/libraries/RLPEncoder.sol

29: 		                encoded[0] = (_val == 0) ? bytes1(uint8(128)) : bytes1(uint8(_val));

50: 		        assert(_len != 1);
```
[[29](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/RLPEncoder.sol#L29), [50](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/RLPEncoder.sol#L50)]



```solidity
File: code/system-contracts/contracts/libraries/SystemContractHelper.sol

332: 		        return (callFlags & 2) != 0;
```
[[332](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L332)]



```solidity
File: code/system-contracts/contracts/libraries/SystemContractsCaller.sol

98: 		        if (value == 0) {
```
[[98](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L98)]



```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

95: 		        return _addr == uint256(uint160(address(BASE_TOKEN_SYSTEM_CONTRACT))) || _addr == 0;

172: 		            if (txDataLen != 1) {

184: 		        if (_transaction.reserved[0] != 0) {

250: 		            if (txDataLen != 1) {

322: 		            if (txDataLen != 1) {
```
[[95](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L95), [172](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L172), [184](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L184), [250](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L250), [322](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L322)]



```solidity
File: code/system-contracts/contracts/libraries/Utils.sol

52: 		        return _bytecodeHash[1] == 0x00;

57: 		        return _bytecodeHash[1] == 0x01;

84: 		        require(_bytecode.length % 32 == 0, "po");

88: 		        require(lengthInWords % 2 == 1, "pr"); // bytecode length in words must be odd
```
[[52](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L52), [57](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L57), [84](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L84), [88](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L88)]



```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

141: 		        require(_amount != 0, "0T"); // empty deposit

186: 		        require(amount != 0, "2T"); // empty deposit
```
[[141](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L141), [186](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L186)]



```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

158: 		            require(msg.value == 0, "ShB m.v > 0 b d.it");

200: 		            require(_depositAmount == 0, "ShB wrong withdraw amount");

202: 		            require(msg.value == 0, "ShB m.v > 0 for BH d.it 2");

208: 		        require(amount != 0, "6T"); // empty deposit amount

237: 		        require(depositHappened[_chainId][_txHash] == 0x00, "ShB tx hap");

517: 		            require(_l2ToL1message.length == 76, "ShB wrong msg len 2");
```
[[158](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L158), [200](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L200), [202](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L202), [208](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L208), [237](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L237), [517](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L517)]



```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

122: 		        require(_chainId != 0, "Bridgehub: chainId cannot be 0");

225: 		                require(msg.value == 0, "Bridgehub: non-eth bridge with msg.value");
```
[[122](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L122), [225](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L225)]



```solidity
File: code/contracts/ethereum/contracts/common/ReentrancyGuard.sol

58: 		        require(lockSlotOldValue == 0, "1B");
```
[[58](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/ReentrancyGuard.sol#L58)]



```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

107: 		        if (timestamp == 0) {
```
[[107](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L107)]



```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol

186: 		        if (_l2ProtocolUpgradeTx.txType == 0) {

251: 		            s.l2SystemContractsUpgradeBatchNumber == 0,
```
[[186](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L186), [251](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L251)]



```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol

35: 		            s.l2SystemContractsUpgradeBatchNumber == 0,
```
[[35](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L35)]



```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

92: 		        require(msg.value == 0, "Value should be 0 for ERC20 bridge");
```
[[92](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L92)]



```solidity
File: code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol

23: 		        require(_bytecode.length % 32 == 0, "pq");

27: 		        require(bytecodeLenInWords % 2 == 1, "ps"); // bytecode length in words must be odd

41: 		        require(version == 1 && _bytecodeHash[1] == bytes1(0), "zf"); // Incorrectly formatted bytecodeHash

43: 		        require(bytecodeLen(_bytecodeHash) % 2 == 1, "uy"); // Code length in words must be odd
```
[[23](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L23), [27](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L27), [41](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L41), [43](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L43)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol

25: 		        require(msg.data.length >= 4 || msg.data.length == 0, "Ut");
```
[[25](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol#L25)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol

194: 		        if (selectorsLength == 0) {

213: 		        if (selectorPosition != 0) {

250: 		        if (lastSelectorPosition == 0) {

280: 		            require(_calldata.length == 0, "H"); // Non-empty calldata for zero address

297: 		            require(data.length == 32, "lp");
```
[[194](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L194), [213](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L213), [250](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L250), [280](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L280), [297](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L297)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol

30: 		            currentHash = (_index % 2 == 0)
```
[[30](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol#L30)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol

50: 		        require(_transaction.paymaster == 0, "uc");

51: 		        require(_transaction.value == 0, "ud");

52: 		        require(_transaction.maxFeePerGas == 0, "uq");

53: 		        require(_transaction.maxPriorityFeePerGas == 0, "ux");

54: 		        require(_transaction.reserved[0] == 0, "ue");

56: 		        require(_transaction.reserved[2] == 0, "ug");

57: 		        require(_transaction.reserved[3] == 0, "uo");

58: 		        require(_transaction.signature.length == 0, "uh");

59: 		        require(_transaction.paymasterInput.length == 0, "ul1");

60: 		        require(_transaction.reservedDynamic.length == 0, "um");
```
[[50](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L50), [51](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L51), [52](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L52), [53](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L53), [54](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L54), [56](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L56), [57](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L57), [58](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L58), [59](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L59), [60](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L60)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol

90: 		        require(s.totalBatchesCommitted == 0, "AdminFacet: set validium only after genesis"); // Validium mode can be set only before the first batch is committed
```
[[90](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L90)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

50: 		            require(logOutput.pubdataHash == 0x00, "v0h");

51: 		            require(_newBatch.pubdataCommitments.length == 1);

192: 		            require(processedLogs == 511, "b7");

194: 		            require(processedLogs == 1023, "b8");

231: 		        require(_newBatchesData.length == 1, "e4");

237: 		        if (systemContractsUpgradeTxHash == bytes32(0) || s.l2SystemContractsUpgradeBatchNumber != 0) {

284: 		        require(s.l2SystemContractsUpgradeBatchNumber == 0, "ik");

291: 		            bytes32 expectedUpgradeTxHash = i == 0 ? _systemContractUpgradeTxHash : bytes32(0);

361: 		        if (batchWhenUpgradeHappened != 0 && batchWhenUpgradeHappened <= newTotalBatchesExecuted) {

426: 		        assert(block.chainid != 1);

442: 		        require(proofPublicInput.length == 1, "t4");

633: 		        require(_pubdataCommitments.length % PUBDATA_COMMITMENT_SIZE == 0, "bs");
```
[[50](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L50), [51](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L51), [192](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L192), [194](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L194), [231](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L231), [237](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L237), [284](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L284), [291](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L291), [361](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L361), [426](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L426), [442](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L442), [633](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L633)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol

169: 		        if (selectorsArrayLen != 0) {
```
[[169](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L169)]

</details>

---

### [N-67] Consider using `delete` instead of assigning zero/false to clear values

The `delete` keyword more closely matches the semantics of what is being done, and draws more attention to the changing of state, which may lead to a more thorough audit of its associated logic.

*There are 6 instances of this issue.*


```solidity
File: code/system-contracts/contracts/L1Messenger.sol

330: 		        numberOfLogsToProcess = 0;
```
[[330](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L330)]



```solidity
File: code/system-contracts/contracts/SystemContext.sol

487: 		        txNumberInBlock = 0;
```
[[487](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L487)]



```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

97: 		        stateTransitionManagerIsRegistered[_stateTransitionManager] = false;

276: 		                baseTokenMsgValue = 0;
```
[[97](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L97), [276](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L276)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

91: 		        validators[_chainId][_validator] = false;
```
[[91](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L91)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol

147: 		        diamondStorage.isFrozen = false;
```
[[147](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L147)]


---

### [N-68] Consider using named mappings

Named mappings improve the readability of the code, even if they are optional, as it's possible to infer the usage of both key and value, instead of looking just at the type.

*There are 8 instances of this issue.*


```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

26: 		    mapping(address => AccountInfo) internal accountInfo;
```
[[26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L26)]



```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

45: 		    mapping(address => uint256) private __DEPRECATED_lastWithdrawalLimitReset;

48: 		    mapping(address => uint256) private __DEPRECATED_withdrawnAmountInWindow;

51: 		    mapping(address => mapping(address => uint256)) private __DEPRECATED_totalDepositedAmountPerUser;

51: 		    mapping(address => mapping(address => uint256)) private __DEPRECATED_totalDepositedAmountPerUser;
```
[[45](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L45), [48](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L48), [51](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L51), [51](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L51)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

30: 		    mapping(uint256 => address) public stateTransition;

48: 		    mapping(uint256 => bytes32) public upgradeCutHash;
```
[[30](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L30), [48](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L48)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

47: 		    mapping(uint256 => LibMap.Uint32Map) internal committedBatchTimestamp;
```
[[47](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L47)]


---

### [N-69] Consider using named returns

Using named returns makes the code more self-documenting, makes it easier to fill out NatSpec, and in some cases can save gas. The cases below are where there currently is at most one return statement, which is ideal for named returns.

*There are 264 instances of this issue.*

<details>
<summary>Expand findings</summary>


```solidity
File: code/system-contracts/contracts/AccountCodeStorage.sol

89: 		    function getCodeHash(uint256 _input) external view override returns (bytes32) {
```
[[89](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L89)]



```solidity
File: code/system-contracts/contracts/BootloaderUtilities.sol

139: 		    function encodeEIP2930TransactionHash(Transaction calldata _transaction) internal view returns (bytes32) {

229: 		    function encodeEIP1559TransactionHash(Transaction calldata _transaction) internal view returns (bytes32) {
```
[[139](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L139), [229](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L229)]



```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

40: 		    function extendedAccountVersion(address _address) public view returns (AccountAbstractionVersion) {

132: 		    function create2(
133: 		        bytes32 _salt,
134: 		        bytes32 _bytecodeHash,
135: 		        bytes calldata _input
136: 		    ) external payable override returns (address) {

147: 		    function create(
148: 		        bytes32 _salt,
149: 		        bytes32 _bytecodeHash,
150: 		        bytes calldata _input
151: 		    ) external payable override returns (address) {

162: 		    function create2Account(
163: 		        bytes32 _salt,
164: 		        bytes32 _bytecodeHash,
165: 		        bytes calldata _input,
166: 		        AccountAbstractionVersion _aaVersion
167: 		    ) public payable override onlySystemCall returns (address) {

182: 		    function createAccount(
183: 		        bytes32, // salt
184: 		        bytes32 _bytecodeHash,
185: 		        bytes calldata _input,
186: 		        AccountAbstractionVersion _aaVersion
187: 		    ) public payable override onlySystemCall returns (address) {
```
[[40](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L40), [132-136](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L132-L136), [147-151](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L147-L151), [162-167](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L162-L167), [182-187](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L182-L187)]



```solidity
File: code/system-contracts/contracts/DefaultAccount.sol

159: 		    function _isValidSignature(bytes32 _hash, bytes memory _signature) internal view returns (bool) {
```
[[159](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L159)]



```solidity
File: code/system-contracts/contracts/ImmutableSimulator.sol

27: 		    function getImmutable(address _dest, uint256 _index) external view override returns (bytes32) {
```
[[27](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ImmutableSimulator.sol#L27)]



```solidity
File: code/system-contracts/contracts/L1Messenger.sol

50: 		    function keccakGasCost(uint256 _length) internal pure returns (uint256) {

61: 		    function sha256GasCost(uint256 _length) internal pure returns (uint256) {
```
[[50](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L50), [61](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L61)]



```solidity
File: code/system-contracts/contracts/L2BaseToken.sol

56: 		    function balanceOf(uint256 _account) external view override returns (uint256) {

112: 		    function _getL1WithdrawMessage(address _to, uint256 _amount) internal pure returns (bytes memory) {

117: 		    function _getExtendedWithdrawMessage(
118: 		        address _to,
119: 		        uint256 _amount,
120: 		        address _sender,
121: 		        bytes memory _additionalData
122: 		    ) internal pure returns (bytes memory) {

128: 		    function name() external pure override returns (string memory) {

134: 		    function symbol() external pure override returns (string memory) {

140: 		    function decimals() external pure override returns (uint8) {
```
[[56](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L2BaseToken.sol#L56), [112](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L2BaseToken.sol#L112), [117-122](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L2BaseToken.sol#L117-L122), [128](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L2BaseToken.sol#L128), [134](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L2BaseToken.sol#L134), [140](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L2BaseToken.sol#L140)]



```solidity
File: code/system-contracts/contracts/MsgValueSimulator.sol

47: 		    fallback(bytes calldata _data) external onlySystemCall returns (bytes memory) {
```
[[47](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/MsgValueSimulator.sol#L47)]



```solidity
File: code/system-contracts/contracts/NonceHolder.sol

46: 		    function getMinNonce(address _address) public view returns (uint256) {

57: 		    function getRawNonce(address _address) public view returns (uint256) {

102: 		    function getValueUnderNonce(uint256 _key) public view returns (uint256) {

154: 		    function isNonceUsed(address _address, uint256 _nonce) public view returns (bool) {
```
[[46](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/NonceHolder.sol#L46), [57](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/NonceHolder.sol#L57), [102](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/NonceHolder.sol#L102), [154](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/NonceHolder.sol#L154)]



```solidity
File: code/system-contracts/contracts/SystemContext.sol

117: 		    function getCurrentPubdataSpent() public view returns (uint256) {

122: 		    function getCurrentPubdataCost() external view returns (uint256) {

190: 		    function getBlockNumber() public view returns (uint128) {

198: 		    function getBlockTimestamp() public view returns (uint128) {

205: 		    function _getLatest257L2blockHash(uint256 _block) internal view returns (bytes32) {

221: 		    function _calculateL2BlockHash(
222: 		        uint128 _blockNumber,
223: 		        uint128 _blockTimestamp,
224: 		        bytes32 _prevL2BlockHash,
225: 		        bytes32 _blockTxsRollingHash
226: 		    ) internal pure returns (bytes32) {

233: 		    function _calculateLegacyL2BlockHash(uint128 _blockNumber) internal pure returns (bytes32) {
```
[[117](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L117), [122](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L122), [190](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L190), [198](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L198), [205](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L205), [221-226](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L221-L226), [233](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L233)]



```solidity
File: code/contracts/zksync/contracts/L2ContractHelper.sol

22: 		    function sendToL1(bytes memory _message) external returns (bytes32);

53: 		    function create2(bytes32 _salt, bytes32 _bytecodeHash, bytes calldata _input) external returns (address);

90: 		    function sendMessageToL1(bytes memory _message) internal returns (bytes32) {

101: 		    function computeCreate2Address(
102: 		        address _sender,
103: 		        bytes32 _salt,
104: 		        bytes32 _bytecodeHash,
105: 		        bytes32 _constructorInputHash
106: 		    ) internal pure returns (address) {
```
[[22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/L2ContractHelper.sol#L22), [53](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/L2ContractHelper.sol#L53), [90](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/L2ContractHelper.sol#L90), [101-106](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/L2ContractHelper.sol#L101-L106)]



```solidity
File: code/contracts/zksync/contracts/SystemContractsCaller.sol

27: 		    function safeCastToU32(uint256 _x) internal pure returns (uint32) {
```
[[27](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/SystemContractsCaller.sol#L27)]



```solidity
File: code/system-contracts/contracts/interfaces/IBaseToken.sol

6: 		    function balanceOf(uint256) external view returns (uint256);

10: 		    function totalSupply() external view returns (uint256);

12: 		    function name() external pure returns (string memory);

14: 		    function symbol() external pure returns (string memory);

16: 		    function decimals() external pure returns (uint8);
```
[[6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBaseToken.sol#L6), [10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBaseToken.sol#L10), [12](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBaseToken.sol#L12), [14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBaseToken.sol#L14), [16](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBaseToken.sol#L16)]



```solidity
File: code/system-contracts/contracts/interfaces/IImmutableSimulator.sol

11: 		    function getImmutable(address _dest, uint256 _index) external view returns (bytes32);
```
[[11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IImmutableSimulator.sol#L11)]



```solidity
File: code/system-contracts/contracts/interfaces/IKnownCodesStorage.sol

18: 		    function getMarker(bytes32 _hash) external view returns (uint256);
```
[[18](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IKnownCodesStorage.sol#L18)]



```solidity
File: code/system-contracts/contracts/interfaces/IL1Messenger.sol

49: 		    function sendToL1(bytes memory _message) external returns (bytes32);
```
[[49](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL1Messenger.sol#L49)]



```solidity
File: code/system-contracts/contracts/interfaces/IL2StandardToken.sol

14: 		    function l1Address() external view returns (address);

16: 		    function l2Bridge() external view returns (address);
```
[[14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL2StandardToken.sol#L14), [16](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL2StandardToken.sol#L16)]



```solidity
File: code/system-contracts/contracts/interfaces/INonceHolder.sol

17: 		    function getMinNonce(address _address) external view returns (uint256);

21: 		    function getRawNonce(address _address) external view returns (uint256);

24: 		    function increaseMinNonce(uint256 _value) external returns (uint256);

30: 		    function getValueUnderNonce(uint256 _key) external view returns (uint256);

37: 		    function getDeploymentNonce(address _address) external view returns (uint256);

40: 		    function incrementDeploymentNonce(address _address) external returns (uint256);

46: 		    function isNonceUsed(address _address, uint256 _nonce) external view returns (bool);
```
[[17](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/INonceHolder.sol#L17), [21](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/INonceHolder.sol#L21), [24](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/INonceHolder.sol#L24), [30](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/INonceHolder.sol#L30), [37](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/INonceHolder.sol#L37), [40](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/INonceHolder.sol#L40), [46](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/INonceHolder.sol#L46)]



```solidity
File: code/system-contracts/contracts/interfaces/ISystemContext.sol

30: 		    function chainId() external view returns (uint256);

32: 		    function origin() external view returns (address);

34: 		    function gasPrice() external view returns (uint256);

36: 		    function blockGasLimit() external view returns (uint256);

38: 		    function coinbase() external view returns (address);

40: 		    function difficulty() external view returns (uint256);

42: 		    function baseFee() external view returns (uint256);

44: 		    function txNumberInBlock() external view returns (uint16);

46: 		    function getBlockHashEVM(uint256 _block) external view returns (bytes32);

50: 		    function getBlockNumber() external view returns (uint128);

52: 		    function getBlockTimestamp() external view returns (uint128);
```
[[30](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L30), [32](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L32), [34](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L34), [36](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L36), [38](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L38), [40](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L40), [42](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L42), [44](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L44), [46](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L46), [50](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L50), [52](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L52)]



```solidity
File: code/system-contracts/contracts/interfaces/ISystemContextDeprecated.sol

11: 		    function currentBlockInfo() external view returns (uint256);
```
[[11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContextDeprecated.sol#L11)]



```solidity
File: code/system-contracts/contracts/libraries/EfficientCall.sol

36: 		    function keccak(bytes calldata _data) internal view returns (bytes32) {

45: 		    function sha(bytes calldata _data) internal view returns (bytes32) {
```
[[36](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L36), [45](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L45)]



```solidity
File: code/system-contracts/contracts/libraries/RLPEncoder.sol

49: 		    function encodeNonSingleBytesLen(uint64 _len) internal pure returns (bytes memory) {

56: 		    function encodeListLen(uint64 _len) internal pure returns (bytes memory) {
```
[[49](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/RLPEncoder.sol#L49), [56](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/RLPEncoder.sol#L56)]



```solidity
File: code/system-contracts/contracts/libraries/SystemContractHelper.sol

329: 		    function isSystemCall() internal view returns (bool) {

338: 		    function isSystemContract(address _address) internal pure returns (bool) {
```
[[329](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L329), [338](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L338)]



```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

94: 		    function isEthToken(uint256 _addr) internal pure returns (bool) {

118: 		    function _encodeHashEIP712Transaction(Transaction calldata _transaction) private view returns (bytes32) {

147: 		    function _encodeHashLegacyTransaction(Transaction calldata _transaction) private view returns (bytes32) {

219: 		    function _encodeHashEIP2930Transaction(Transaction calldata _transaction) private view returns (bytes32) {

289: 		    function _encodeHashEIP1559Transaction(Transaction calldata _transaction) private view returns (bytes32) {
```
[[94](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L94), [118](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L118), [147](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L147), [219](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L219), [289](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L289)]



```solidity
File: code/system-contracts/contracts/libraries/Utils.sol

20: 		    function safeCastToU128(uint256 _x) internal pure returns (uint128) {

26: 		    function safeCastToU32(uint256 _x) internal pure returns (uint32) {

32: 		    function safeCastToU24(uint256 _x) internal pure returns (uint24) {

51: 		    function isContractConstructed(bytes32 _bytecodeHash) internal pure returns (bool) {

56: 		    function isContractConstructing(bytes32 _bytecodeHash) internal pure returns (bool) {

63: 		    function constructingBytecodeHash(bytes32 _bytecodeHash) internal pure returns (bytes32) {

71: 		    function constructedBytecodeHash(bytes32 _bytecodeHash) internal pure returns (bytes32) {
```
[[20](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L20), [26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L26), [32](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L32), [51](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L51), [56](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L56), [63](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L63), [71](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L71)]



```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

75: 		    function l2TokenAddress(address _l1Token) external view returns (address) {

160: 		    function _depositFundsToSharedBridge(address _from, IERC20 _token, uint256 _amount) internal returns (uint256) {
```
[[75](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L75), [160](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L160)]



```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

173: 		    function _depositFunds(address _from, IERC20 _token, uint256 _amount) internal returns (uint256) {

243: 		    function _getDepositL2Calldata(
244: 		        address _l1Sender,
245: 		        address _l2Receiver,
246: 		        address _l1Token,
247: 		        uint256 _amount
248: 		    ) internal view returns (bytes memory) {

254: 		    function _getERC20Getters(address _token) internal view returns (bytes memory) {

374: 		    function _isEraLegacyWithdrawal(uint256 _chainId, uint256 _l2BatchNumber) internal view returns (bool) {
```
[[173](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L173), [243-248](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L243-L248), [254](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L254), [374](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L374)]



```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

75: 		    function getStateTransition(uint256 _chainId) public view returns (address) {

152: 		    function proveL2MessageInclusion(
153: 		        uint256 _chainId,
154: 		        uint256 _batchNumber,
155: 		        uint256 _index,
156: 		        L2Message calldata _message,
157: 		        bytes32[] calldata _proof
158: 		    ) external view override returns (bool) {

164: 		    function proveL2LogInclusion(
165: 		        uint256 _chainId,
166: 		        uint256 _batchNumber,
167: 		        uint256 _index,
168: 		        L2Log memory _log,
169: 		        bytes32[] calldata _proof
170: 		    ) external view override returns (bool) {

176: 		    function proveL1ToL2TransactionStatus(
177: 		        uint256 _chainId,
178: 		        bytes32 _l2TxHash,
179: 		        uint256 _l2BatchNumber,
180: 		        uint256 _l2MessageIndex,
181: 		        uint16 _l2TxNumberInBatch,
182: 		        bytes32[] calldata _merkleProof,
183: 		        TxStatus _status
184: 		    ) external view override returns (bool) {

198: 		    function l2TransactionBaseCost(
199: 		        uint256 _chainId,
200: 		        uint256 _gasPrice,
201: 		        uint256 _l2GasLimit,
202: 		        uint256 _l2GasPerPubdataByteLimit
203: 		    ) external view returns (uint256) {
```
[[75](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L75), [152-158](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L152-L158), [164-170](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L164-L170), [176-184](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L176-L184), [198-203](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L198-L203)]



```solidity
File: code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol

59: 		    function stateTransitionManagerIsRegistered(address _stateTransitionManager) external view returns (bool);

61: 		    function stateTransitionManager(uint256 _chainId) external view returns (address);

63: 		    function tokenIsRegistered(address _baseToken) external view returns (bool);

65: 		    function baseToken(uint256 _chainId) external view returns (address);

67: 		    function sharedBridge() external view returns (IL1SharedBridge);

69: 		    function getStateTransition(uint256 _chainId) external view returns (address);

73: 		    function proveL2MessageInclusion(
74: 		        uint256 _chainId,
75: 		        uint256 _batchNumber,
76: 		        uint256 _index,
77: 		        L2Message calldata _message,
78: 		        bytes32[] calldata _proof
79: 		    ) external view returns (bool);

81: 		    function proveL2LogInclusion(
82: 		        uint256 _chainId,
83: 		        uint256 _batchNumber,
84: 		        uint256 _index,
85: 		        L2Log memory _log,
86: 		        bytes32[] calldata _proof
87: 		    ) external view returns (bool);

89: 		    function proveL1ToL2TransactionStatus(
90: 		        uint256 _chainId,
91: 		        bytes32 _l2TxHash,
92: 		        uint256 _l2BatchNumber,
93: 		        uint256 _l2MessageIndex,
94: 		        uint16 _l2TxNumberInBatch,
95: 		        bytes32[] calldata _merkleProof,
96: 		        TxStatus _status
97: 		    ) external view returns (bool);

107: 		    function l2TransactionBaseCost(
108: 		        uint256 _chainId,
109: 		        uint256 _gasPrice,
110: 		        uint256 _l2GasLimit,
111: 		        uint256 _l2GasPerPubdataByteLimit
112: 		    ) external view returns (uint256);
```
[[59](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L59), [61](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L61), [63](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L63), [65](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L65), [67](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L67), [69](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L69), [73-79](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L73-L79), [81-87](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L81-L87), [89-97](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L89-L97), [107-112](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L107-L112)]



```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

84: 		    function isOperation(bytes32 _id) public view returns (bool) {

89: 		    function isOperationPending(bytes32 _id) public view returns (bool) {

95: 		    function isOperationReady(bytes32 _id) public view returns (bool) {

100: 		    function isOperationDone(bytes32 _id) public view returns (bool) {

105: 		    function getOperationState(bytes32 _id) public view returns (OperationState) {

204: 		    function hashOperation(Operation calldata _operation) public pure returns (bytes32) {
```
[[84](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L84), [89](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L89), [95](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L95), [100](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L100), [105](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L105), [204](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L204)]



```solidity
File: code/contracts/ethereum/contracts/governance/IGovernance.sol

41: 		    function isOperation(bytes32 _id) external view returns (bool);

43: 		    function isOperationPending(bytes32 _id) external view returns (bool);

45: 		    function isOperationReady(bytes32 _id) external view returns (bool);

47: 		    function isOperationDone(bytes32 _id) external view returns (bool);

49: 		    function getOperationState(bytes32 _id) external view returns (OperationState);

61: 		    function hashOperation(Operation calldata _operation) external pure returns (bytes32);
```
[[41](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L41), [43](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L43), [45](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L45), [47](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L47), [49](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L49), [61](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L61)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol

43: 		    function bridgehub() external view returns (address);

53: 		    function stateTransition(uint256 _chainId) external view returns (address);

55: 		    function storedBatchZero() external view returns (bytes32);

57: 		    function initialCutHash() external view returns (bytes32);

59: 		    function genesisUpgrade() external view returns (address);

61: 		    function upgradeCutHash(uint256 _protocolVersion) external view returns (bytes32);

63: 		    function protocolVersion() external view returns (uint256);

71: 		    function getChainAdmin(uint256 _chainId) external view returns (address);
```
[[43](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L43), [53](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L53), [55](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L55), [57](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L57), [59](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L59), [61](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L61), [63](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L63), [71](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L71)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

74: 		    function getChainAdmin(uint256 _chainId) external view override returns (address) {
```
[[74](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L74)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

102: 		    function getCommittedBatchTimestamp(uint256 _chainId, uint256 _l2BatchNumber) external view returns (uint256) {
```
[[102](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L102)]



```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol

180: 		    function _setL2SystemContractUpgrade(
181: 		        L2CanonicalTransaction calldata _l2ProtocolUpgradeTx,
182: 		        bytes[] calldata _factoryDeps,
183: 		        uint256 _newProtocolVersion
184: 		    ) internal returns (bytes32) {
```
[[180-184](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L180-L184)]



```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol

47: 		    function upgrade(ProposedUpgrade calldata _proposedUpgrade) public virtual override returns (bytes32) {
```
[[47](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L47)]



```solidity
File: code/contracts/ethereum/contracts/upgrades/DefaultUpgrade.sol

13: 		    function upgrade(ProposedUpgrade calldata _proposedUpgrade) public override returns (bytes32) {
```
[[13](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/DefaultUpgrade.sol#L13)]



```solidity
File: code/contracts/ethereum/contracts/upgrades/GenesisUpgrade.sol

14: 		    function upgrade(ProposedUpgrade calldata _proposedUpgrade) public override returns (bytes32) {
```
[[14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/GenesisUpgrade.sol#L14)]



```solidity
File: code/contracts/ethereum/contracts/upgrades/IDefaultUpgrade.sol

8: 		    function upgrade(ProposedUpgrade calldata _upgrade) external returns (bytes32);
```
[[8](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/IDefaultUpgrade.sol#L8)]



```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

109: 		    function _deployL2Token(address _l1Token, bytes calldata _data) internal returns (address) {

138: 		    function _getL1WithdrawMessage(
139: 		        address _to,
140: 		        address _l1Token,
141: 		        uint256 _amount
142: 		    ) internal pure returns (bytes memory) {

149: 		    function l2TokenAddress(address _l1Token) public view override returns (address) {
```
[[109](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L109), [138-142](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L138-L142), [149](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L149)]



```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

159: 		    function name() public view override returns (string memory) {

165: 		    function symbol() public view override returns (string memory) {

171: 		    function decimals() public view override returns (uint8) {
```
[[159](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L159), [165](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L165), [171](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L171)]



```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol

24: 		    function isWithdrawalFinalized(uint256 _l2BatchNumber, uint256 _l2MessageIndex) external view returns (bool);

61: 		    function l2TokenAddress(address _l1Token) external view returns (address);

63: 		    function sharedBridge() external view returns (IL1SharedBridge);

65: 		    function l2TokenBeacon() external view returns (address);

67: 		    function l2Bridge() external view returns (address);
```
[[24](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L24), [61](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L61), [63](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L63), [65](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L65), [67](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L67)]



```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol

58: 		    function isWithdrawalFinalized(
59: 		        uint256 _chainId,
60: 		        uint256 _l2BatchNumber,
61: 		        uint256 _l2MessageIndex
62: 		    ) external view returns (bool);

114: 		    function l1WethAddress() external view returns (address);

116: 		    function bridgehub() external view returns (IBridgehub);

118: 		    function legacyBridge() external view returns (IL1ERC20Bridge);

120: 		    function l2BridgeAddress(uint256 _chainId) external view returns (address);

122: 		    function depositHappened(uint256 _chainId, bytes32 _l2TxHash) external view returns (bytes32);
```
[[58-62](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L58-L62), [114](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L114), [116](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L116), [118](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L118), [120](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L120), [122](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L122)]



```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL2Bridge.sol

17: 		    function l1TokenAddress(address _l2Token) external view returns (address);

19: 		    function l2TokenAddress(address _l1Token) external view returns (address);

21: 		    function l1Bridge() external view returns (address);
```
[[17](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL2Bridge.sol#L17), [19](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL2Bridge.sol#L19), [21](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL2Bridge.sol#L21)]



```solidity
File: code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol

60: 		    function computeCreate2Address(
61: 		        address _sender,
62: 		        bytes32 _salt,
63: 		        bytes32 _bytecodeHash,
64: 		        bytes32 _constructorInputHash
65: 		    ) internal pure returns (address) {
```
[[60-65](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L60-L65)]



```solidity
File: code/contracts/ethereum/contracts/common/libraries/UncheckedMath.sol

11: 		    function uncheckedInc(uint256 _number) internal pure returns (uint256) {

17: 		    function uncheckedAdd(uint256 _lhs, uint256 _rhs) internal pure returns (uint256) {
```
[[11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/UncheckedMath.sol#L11), [17](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/UncheckedMath.sol#L17)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol

24: 		    function initialize(InitializeData calldata _initializeData) external reentrancyGuardInitializer returns (bytes32) {
```
[[24](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol#L24)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol

62: 		    function initialize(InitializeData calldata _initData) external returns (bytes32);
```
[[62](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol#L62)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol

19: 		    function getVerifier() external view returns (address);

22: 		    function getAdmin() external view returns (address);

25: 		    function getPendingAdmin() external view returns (address);

28: 		    function getBridgehub() external view returns (address);

31: 		    function getStateTransitionManager() external view returns (address);

34: 		    function getBaseToken() external view returns (address);

37: 		    function getBaseTokenBridge() external view returns (address);

40: 		    function getTotalBatchesCommitted() external view returns (uint256);

43: 		    function getTotalBatchesVerified() external view returns (uint256);

46: 		    function getTotalBatchesExecuted() external view returns (uint256);

49: 		    function getTotalPriorityTxs() external view returns (uint256);

56: 		    function getFirstUnprocessedPriorityTx() external view returns (uint256);

59: 		    function getPriorityQueueSize() external view returns (uint256);

62: 		    function priorityQueueFrontOperation() external view returns (PriorityOperation memory);

65: 		    function isValidator(address _address) external view returns (bool);

73: 		    function storedBatchHash(uint256 _batchNumber) external view returns (bytes32);

76: 		    function getL2BootloaderBytecodeHash() external view returns (bytes32);

79: 		    function getL2DefaultAccountBytecodeHash() external view returns (bytes32);

82: 		    function getVerifierParams() external view returns (VerifierParams memory);

85: 		    function isDiamondStorageFrozen() external view returns (bool);

88: 		    function getProtocolVersion() external view returns (uint256);

91: 		    function getL2SystemContractsUpgradeTxHash() external view returns (bytes32);

98: 		    function getL2SystemContractsUpgradeBatchNumber() external view returns (uint256);

101: 		    function getPriorityTxMaxGasLimit() external view returns (uint256);

106: 		    function isEthWithdrawalFinalized(uint256 _l2BatchNumber, uint256 _l2MessageIndex) external view returns (bool);

109: 		    function getPubdataPricingMode() external view returns (PubdataPricingMode);

112: 		    function baseTokenGasPriceMultiplierNominator() external view returns (uint128);

115: 		    function baseTokenGasPriceMultiplierDenominator() external view returns (uint128);

130: 		    function facets() external view returns (Facet[] memory);

133: 		    function facetFunctionSelectors(address _facet) external view returns (bytes4[] memory);

142: 		    function isFunctionFreezable(bytes4 _selector) external view returns (bool);
```
[[19](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L19), [22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L22), [25](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L25), [28](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L28), [31](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L31), [34](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L34), [37](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L37), [40](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L40), [43](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L43), [46](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L46), [49](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L49), [56](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L56), [59](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L59), [62](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L62), [65](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L65), [73](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L73), [76](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L76), [79](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L79), [82](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L82), [85](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L85), [88](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L88), [91](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L91), [98](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L98), [101](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L101), [106](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L106), [109](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L109), [112](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L112), [115](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L115), [130](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L130), [133](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L133), [142](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L142)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/ILegacyGetters.sol

14: 		    function getTotalBlocksCommitted() external view returns (uint256);

18: 		    function getTotalBlocksVerified() external view returns (uint256);

22: 		    function getTotalBlocksExecuted() external view returns (uint256);

28: 		    function storedBlockHash(uint256 _batchNumber) external view returns (bytes32);

36: 		    function getL2SystemContractsUpgradeBlockNumber() external view returns (uint256);
```
[[14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/ILegacyGetters.sol#L14), [18](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/ILegacyGetters.sol#L18), [22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/ILegacyGetters.sol#L22), [28](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/ILegacyGetters.sol#L28), [36](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/ILegacyGetters.sol#L36)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol

18: 		    function proveL2MessageInclusion(
19: 		        uint256 _batchNumber,
20: 		        uint256 _index,
21: 		        L2Message calldata _message,
22: 		        bytes32[] calldata _proof
23: 		    ) external view returns (bool);

31: 		    function proveL2LogInclusion(
32: 		        uint256 _batchNumber,
33: 		        uint256 _index,
34: 		        L2Log memory _log,
35: 		        bytes32[] calldata _proof
36: 		    ) external view returns (bool);

47: 		    function proveL1ToL2TransactionStatus(
48: 		        bytes32 _l2TxHash,
49: 		        uint256 _l2BatchNumber,
50: 		        uint256 _l2MessageIndex,
51: 		        uint16 _l2TxNumberInBatch,
52: 		        bytes32[] calldata _merkleProof,
53: 		        TxStatus _status
54: 		    ) external view returns (bool);

107: 		    function l2TransactionBaseCost(
108: 		        uint256 _gasPrice,
109: 		        uint256 _l2GasLimit,
110: 		        uint256 _l2GasPerPubdataByteLimit
111: 		    ) external view returns (uint256);
```
[[18-23](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L18-L23), [31-36](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L31-L36), [47-54](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L47-L54), [107-111](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L107-L111)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IVerifier.sol

19: 		    function verify(
20: 		        uint256[] calldata _publicInputs,
21: 		        uint256[] calldata _proof,
22: 		        uint256[] calldata _recursiveAggregationInput
23: 		    ) external view returns (bool);

27: 		    function verificationKeyHash() external pure returns (bytes32);
```
[[19-23](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IVerifier.sol#L19-L23), [27](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IVerifier.sol#L27)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransitionBase.sol

9: 		    function getName() external view returns (string memory);
```
[[9](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransitionBase.sol#L9)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol

18: 		    function calculateRoot(
19: 		        bytes32[] calldata _path,
20: 		        uint256 _index,
21: 		        bytes32 _itemHash
22: 		    ) internal pure returns (bytes32) {
```
[[18-22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol#L18-L22)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol

35: 		    function getFirstUnprocessedPriorityTx(Queue storage _queue) internal view returns (uint256) {

40: 		    function getTotalPriorityTxs(Queue storage _queue) internal view returns (uint256) {

45: 		    function getSize(Queue storage _queue) internal view returns (uint256) {

50: 		    function isEmpty(Queue storage _queue) internal view returns (bool) {

64: 		    function front(Queue storage _queue) internal view returns (PriorityOperation memory) {
```
[[35](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L35), [40](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L40), [45](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L45), [50](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L50), [64](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L64)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol

69: 		    function getMinimalPriorityTransactionGasLimit(
70: 		        uint256 _encodingLength,
71: 		        uint256 _numberOfFactoryDependencies,
72: 		        uint256 _l2GasPricePerPubdata
73: 		    ) internal pure returns (uint256) {
```
[[69-73](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L69-L73)]



```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol

34: 		    function l1TokenAddress(address _l2Token) external view returns (address);

36: 		    function l2TokenAddress(address _l1Token) external view returns (address);

38: 		    function l1Bridge() external view returns (address);
```
[[34](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol#L34), [36](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol#L36), [38](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol#L38)]



```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol

16: 		    function l1Address() external view returns (address);

18: 		    function l2Bridge() external view returns (address);
```
[[16](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol#L16), [18](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol#L18)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

32: 		    function _commitOneBatch(
33: 		        StoredBatchInfo memory _previousBatch,
34: 		        CommitBatchInfo calldata _newBatch,
35: 		        bytes32 _expectedSystemContractUpgradeTxHash
36: 		    ) internal view returns (StoredBatchInfo memory) {

453: 		    function _getBatchProofPublicInput(
454: 		        bytes32 _prevBatchCommitment,
455: 		        bytes32 _currentBatchCommitment,
456: 		        VerifierParams memory _verifierParams
457: 		    ) internal pure returns (uint256) {

500: 		    function _createBatchCommitment(
501: 		        CommitBatchInfo calldata _newBatchData,
502: 		        bytes32 _stateDiffHash,
503: 		        bytes32[] memory _blobCommitments,
504: 		        bytes32[] memory _blobHashes
505: 		    ) internal view returns (bytes32) {

515: 		    function _batchPassThroughData(CommitBatchInfo calldata _batch) internal pure returns (bytes memory) {

525: 		    function _batchMetaParameters() internal view returns (bytes memory) {

537: 		    function _batchAuxiliaryOutput(
538: 		        CommitBatchInfo calldata _batch,
539: 		        bytes32 _stateDiffHash,
540: 		        bytes32[] memory _blobCommitments,
541: 		        bytes32[] memory _blobHashes
542: 		    ) internal pure returns (bytes memory) {

587: 		    function _hashStoredBatchInfo(StoredBatchInfo memory _storedBatchInfo) internal pure returns (bytes32) {

592: 		    function _checkBit(uint256 _bitMap, uint8 _index) internal pure returns (bool) {

597: 		    function _setBit(uint256 _bitMap, uint8 _index) internal pure returns (uint256) {
```
[[32-36](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L32-L36), [453-457](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L453-L457), [500-505](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L500-L505), [515](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L515), [525](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L525), [537-542](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L537-L542), [587](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L587), [592](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L592), [597](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L597)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol

32: 		    function getVerifier() external view returns (address) {

37: 		    function getAdmin() external view returns (address) {

42: 		    function getPendingAdmin() external view returns (address) {

47: 		    function getBridgehub() external view returns (address) {

52: 		    function getStateTransitionManager() external view returns (address) {

57: 		    function getBaseToken() external view returns (address) {

62: 		    function getBaseTokenBridge() external view returns (address) {

67: 		    function baseTokenGasPriceMultiplierNominator() external view returns (uint128) {

72: 		    function baseTokenGasPriceMultiplierDenominator() external view returns (uint128) {

77: 		    function getTotalBatchesCommitted() external view returns (uint256) {

82: 		    function getTotalBatchesVerified() external view returns (uint256) {

87: 		    function getTotalBatchesExecuted() external view returns (uint256) {

92: 		    function getTotalPriorityTxs() external view returns (uint256) {

97: 		    function getFirstUnprocessedPriorityTx() external view returns (uint256) {

102: 		    function getPriorityQueueSize() external view returns (uint256) {

107: 		    function priorityQueueFrontOperation() external view returns (PriorityOperation memory) {

112: 		    function isValidator(address _address) external view returns (bool) {

117: 		    function l2LogsRootHash(uint256 _batchNumber) external view returns (bytes32) {

122: 		    function storedBatchHash(uint256 _batchNumber) external view returns (bytes32) {

127: 		    function getL2BootloaderBytecodeHash() external view returns (bytes32) {

132: 		    function getL2DefaultAccountBytecodeHash() external view returns (bytes32) {

137: 		    function getVerifierParams() external view returns (VerifierParams memory) {

142: 		    function getProtocolVersion() external view returns (uint256) {

147: 		    function getL2SystemContractsUpgradeTxHash() external view returns (bytes32) {

152: 		    function getL2SystemContractsUpgradeBatchNumber() external view returns (uint256) {

157: 		    function isDiamondStorageFrozen() external view returns (bool) {

176: 		    function getPriorityTxMaxGasLimit() external view returns (uint256) {

181: 		    function isFunctionFreezable(bytes4 _selector) external view returns (bool) {

188: 		    function isEthWithdrawalFinalized(uint256 _l2BatchNumber, uint256 _l2MessageIndex) external view returns (bool) {

193: 		    function getPubdataPricingMode() external view returns (PubdataPricingMode) {

217: 		    function facetFunctionSelectors(address _facet) external view returns (bytes4[] memory) {

223: 		    function facetAddresses() external view returns (address[] memory) {

229: 		    function facetAddress(bytes4 _selector) external view returns (address) {

239: 		    function getTotalBlocksCommitted() external view returns (uint256) {

244: 		    function getTotalBlocksVerified() external view returns (uint256) {

249: 		    function getTotalBlocksExecuted() external view returns (uint256) {

254: 		    function storedBlockHash(uint256 _batchNumber) external view returns (bytes32) {

259: 		    function getL2SystemContractsUpgradeBlockNumber() external view returns (uint256) {
```
[[32](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L32), [37](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L37), [42](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L42), [47](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L47), [52](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L52), [57](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L57), [62](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L62), [67](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L67), [72](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L72), [77](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L77), [82](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L82), [87](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L87), [92](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L92), [97](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L97), [102](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L102), [107](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L107), [112](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L112), [117](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L117), [122](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L122), [127](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L127), [132](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L132), [137](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L137), [142](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L142), [147](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L147), [152](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L152), [157](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L157), [176](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L176), [181](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L181), [188](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L188), [193](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L193), [217](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L217), [223](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L223), [229](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L229), [239](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L239), [244](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L244), [249](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L249), [254](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L254), [259](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L259)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

54: 		    function proveL2MessageInclusion(
55: 		        uint256 _batchNumber,
56: 		        uint256 _index,
57: 		        L2Message memory _message,
58: 		        bytes32[] calldata _proof
59: 		    ) public view returns (bool) {

64: 		    function proveL2LogInclusion(
65: 		        uint256 _batchNumber,
66: 		        uint256 _index,
67: 		        L2Log memory _log,
68: 		        bytes32[] calldata _proof
69: 		    ) external view returns (bool) {

74: 		    function proveL1ToL2TransactionStatus(
75: 		        bytes32 _l2TxHash,
76: 		        uint256 _l2BatchNumber,
77: 		        uint256 _l2MessageIndex,
78: 		        uint16 _l2TxNumberInBatch,
79: 		        bytes32[] calldata _merkleProof,
80: 		        TxStatus _status
81: 		    ) public view returns (bool) {

104: 		    function _proveL2LogInclusion(
105: 		        uint256 _batchNumber,
106: 		        uint256 _index,
107: 		        L2Log memory _log,
108: 		        bytes32[] calldata _proof
109: 		    ) internal view returns (bool) {

130: 		    function _L2MessageToLog(L2Message memory _message) internal pure returns (L2Log memory) {

143: 		    function l2TransactionBaseCost(
144: 		        uint256 _gasPrice,
145: 		        uint256 _l2GasLimit,
146: 		        uint256 _l2GasPerPubdataByteLimit
147: 		    ) public view returns (uint256) {

156: 		    function _deriveL2GasPrice(uint256 _l1GasPrice, uint256 _gasPerPubdata) internal view returns (uint256) {
```
[[54-59](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L54-L59), [64-69](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L64-L69), [74-81](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L74-L81), [104-109](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L104-L109), [130](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L130), [143-147](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L143-L147), [156](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L156)]

</details>

---

### [N-70] Unused import

Some imports are not used, consider removing them.

*There are 16 instances of this issue.*

<details>
<summary>Expand findings</summary>


```solidity
File: code/system-contracts/contracts/Compressor.sol

// @audit INITIAL_WRITE_STARTING_POSITION, COMPRESSED_INITIAL_WRITE_SIZE, STATE_DIFF_ENUM_INDEX_OFFSET, STATE_DIFF_FINAL_VALUE_OFFSET, STATE_DIFF_DERIVED_KEY_OFFSET, DERIVED_KEY_LENGTH, VALUE_LENGTH, ENUM_INDEX_LENGTH
10: 		import {L1_MESSENGER_CONTRACT, INITIAL_WRITE_STARTING_POSITION, COMPRESSED_INITIAL_WRITE_SIZE, STATE_DIFF_ENTRY_SIZE, STATE_DIFF_ENUM_INDEX_OFFSET, STATE_DIFF_FINAL_VALUE_OFFSET, STATE_DIFF_DERIVED_KEY_OFFSET, DERIVED_KEY_LENGTH, VALUE_LENGTH, ENUM_INDEX_LENGTH, KNOWN_CODE_STORAGE_CONTRACT} from "./Constants.sol";
```
[[10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L10)]



```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

// @audit KECCAK256_SYSTEM_CONTRACT
7: 		import {CREATE2_PREFIX, CREATE_PREFIX, NONCE_HOLDER_SYSTEM_CONTRACT, ACCOUNT_CODE_STORAGE_SYSTEM_CONTRACT, FORCE_DEPLOYER, MAX_SYSTEM_CONTRACT_ADDRESS, KNOWN_CODE_STORAGE_CONTRACT, BASE_TOKEN_SYSTEM_CONTRACT, IMMUTABLE_SIMULATOR_SYSTEM_CONTRACT, COMPLEX_UPGRADER_CONTRACT, KECCAK256_SYSTEM_CONTRACT} from "./Constants.sol";
```
[[7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L7)]



```solidity
File: code/system-contracts/contracts/PubdataChunkPublisher.sol

// @audit EfficientCall
7: 		import {EfficientCall} from "./libraries/EfficientCall.sol";
```
[[7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/PubdataChunkPublisher.sol#L7)]



```solidity
File: code/system-contracts/contracts/libraries/SystemContractHelper.sol

// @audit SystemContractsCaller, CalldataForwardingMode, MIMIC_CALL_BY_REF_CALL_ADDRESS, MSG_VALUE_SIMULATOR_IS_SYSTEM_BIT, RAW_FAR_CALL_BY_REF_CALL_ADDRESS, SYSTEM_CALL_BY_REF_CALL_ADDRESS
7: 		import {SystemContractsCaller, CalldataForwardingMode, CALLFLAGS_CALL_ADDRESS, CODE_ADDRESS_CALL_ADDRESS, EVENT_WRITE_ADDRESS, EVENT_INITIALIZE_ADDRESS, GET_EXTRA_ABI_DATA_ADDRESS, LOAD_CALLDATA_INTO_ACTIVE_PTR_CALL_ADDRESS, META_CODE_SHARD_ID_OFFSET, META_CALLER_SHARD_ID_OFFSET, META_SHARD_ID_OFFSET, META_AUX_HEAP_SIZE_OFFSET, META_HEAP_SIZE_OFFSET, META_GAS_PER_PUBDATA_BYTE_OFFSET, MIMIC_CALL_BY_REF_CALL_ADDRESS, META_CALL_ADDRESS, MSG_VALUE_SIMULATOR_IS_SYSTEM_BIT, PTR_CALLDATA_CALL_ADDRESS, PTR_ADD_INTO_ACTIVE_CALL_ADDRESS, PTR_SHRINK_INTO_ACTIVE_CALL_ADDRESS, PTR_PACK_INTO_ACTIVE_CALL_ADDRESS, RAW_FAR_CALL_BY_REF_CALL_ADDRESS, PRECOMPILE_CALL_ADDRESS, SET_CONTEXT_VALUE_CALL_ADDRESS, SYSTEM_CALL_BY_REF_CALL_ADDRESS, TO_L1_CALL_ADDRESS} from "./SystemContractsCaller.sol";
```
[[7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L7)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

// @audit ERA_DIAMOND_PROXY, ERA_CHAIN_ID
19: 		import {REQUIRED_L2_GAS_PRICE_PER_PUBDATA, L2_TO_L1_LOG_SERIALIZE_SIZE, DEFAULT_L2_LOGS_TREE_ROOT_HASH, EMPTY_STRING_KECCAK, SYSTEM_UPGRADE_L2_TX_TYPE, ERA_DIAMOND_PROXY, ERA_CHAIN_ID} from "../common/Config.sol";
```
[[19](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L19)]



```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol

// @audit IMailbox
6: 		import {IMailbox} from "../state-transition/chain-interfaces/IMailbox.sol";
```
[[6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L6)]



```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol

// @audit MAX_NEW_FACTORY_DEPS, SYSTEM_UPGRADE_L2_TX_TYPE
11: 		import {MAX_NEW_FACTORY_DEPS, SYSTEM_UPGRADE_L2_TX_TYPE, MAX_ALLOWED_PROTOCOL_VERSION_DELTA} from "../common/Config.sol";
```
[[11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L11)]



```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

// @audit L2_BASE_TOKEN_ADDRESS
15: 		import {L2ContractHelper, DEPLOYER_SYSTEM_CONTRACT, L2_BASE_TOKEN_ADDRESS, IContractDeployer} from "../L2ContractHelper.sol";

// @audit ERA_WETH_ADDRESS
17: 		import {ERA_CHAIN_ID, ERA_WETH_ADDRESS} from "../Config.sol";
```
[[15](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L15), [17](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L17)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol

// @audit FeeParams
7: 		import {FeeParams} from "./ZkSyncStateTransitionStorage.sol";

// @audit VerifierParams
10: 		import {VerifierParams} from "../chain-interfaces/IVerifier.sol";
```
[[7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol#L7), [10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol#L10)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol

// @audit L2CanonicalTransaction
5: 		import {L2CanonicalTransaction} from "../../common/Messaging.sol";
```
[[5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol#L5)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol

// @audit VerifierParams
10: 		import {VerifierParams} from "./IVerifier.sol";
```
[[10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol#L10)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

// @audit UnsafeBytes
14: 		import {UnsafeBytes} from "../../../common/libraries/UnsafeBytes.sol";

// @audit L2_BASE_TOKEN_SYSTEM_CONTRACT_ADDR
19: 		import {L2_BOOTLOADER_ADDRESS, L2_TO_L1_MESSENGER_SYSTEM_CONTRACT_ADDR, L2_BASE_TOKEN_SYSTEM_CONTRACT_ADDR} from "../../../common/L2ContractAddresses.sol";

// @audit IBridgehub
21: 		import {IBridgehub} from "../../../bridgehub/IBridgehub.sol";
```
[[14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L14), [19](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L19), [21](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L21)]

</details>

---

### [N-71] Files not imported in any source code

These files are never imported by any other source file. If any one of these files is needed for tests, it should be moved to a test directory.

*There are 4 instances of this issue.*


```solidity
File: code/system-contracts/contracts/interfaces/IPaymaster.sol

3: 		pragma solidity 0.8.20;
```
[[3](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IPaymaster.sol#L3)]



```solidity
File: code/contracts/zksync/contracts/interfaces/IPaymaster.sol

3: 		pragma solidity 0.8.20;
```
[[3](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/interfaces/IPaymaster.sol#L3)]



```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IWETH9.sol

2: 		pragma solidity 0.8.20;
```
[[2](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IWETH9.sol#L2)]



```solidity
File: code/contracts/ethereum/contracts/common/interfaces/IL2ContractDeployer.sol

3: 		pragma solidity 0.8.20;
```
[[3](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/interfaces/IL2ContractDeployer.sol#L3)]


---

### [N-72] Interfaces should use floating version pragmas

If the file contains non-interfaces as well, the interfaces should be moved to a separate file.

*There are 19 instances of this issue.*

<details>
<summary>Expand findings</summary>


```solidity
File: code/contracts/zksync/contracts/L2ContractHelper.sol

3: 		pragma solidity 0.8.20;
```
[[3](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/L2ContractHelper.sol#L3)]



```solidity
File: code/contracts/zksync/contracts/SystemContractsCaller.sol

3: 		pragma solidity 0.8.20;
```
[[3](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/SystemContractsCaller.sol#L3)]



```solidity
File: code/system-contracts/contracts/libraries/EfficientCall.sol

3: 		pragma solidity 0.8.20;
```
[[3](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L3)]



```solidity
File: code/system-contracts/contracts/libraries/RLPEncoder.sol

3: 		pragma solidity 0.8.20;
```
[[3](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/RLPEncoder.sol#L3)]



```solidity
File: code/system-contracts/contracts/libraries/SystemContractHelper.sol

3: 		pragma solidity 0.8.20;
```
[[3](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L3)]



```solidity
File: code/system-contracts/contracts/libraries/SystemContractsCaller.sol

3: 		pragma solidity 0.8.20;
```
[[3](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L3)]



```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

3: 		pragma solidity 0.8.20;
```
[[3](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L3)]



```solidity
File: code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol

3: 		pragma solidity 0.8.20;
```
[[3](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol#L3)]



```solidity
File: code/system-contracts/contracts/libraries/Utils.sol

2: 		pragma solidity 0.8.20;
```
[[2](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L2)]



```solidity
File: code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol

19: 		pragma solidity 0.8.20;
```
[[19](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol#L19)]



```solidity
File: code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol

19: 		pragma solidity 0.8.20;
```
[[19](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol#L19)]



```solidity
File: code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol

3: 		pragma solidity 0.8.20;
```
[[3](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L3)]



```solidity
File: code/contracts/ethereum/contracts/common/libraries/UncheckedMath.sol

3: 		pragma solidity 0.8.20;
```
[[3](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/UncheckedMath.sol#L3)]



```solidity
File: code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol

3: 		pragma solidity 0.8.20;
```
[[3](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol#L3)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol

3: 		pragma solidity 0.8.20;
```
[[3](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L3)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/LibMap.sol

2: 		pragma solidity 0.8.20;
```
[[2](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/LibMap.sol#L2)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol

3: 		pragma solidity 0.8.20;
```
[[3](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol#L3)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol

3: 		pragma solidity 0.8.20;
```
[[3](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L3)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol

3: 		pragma solidity 0.8.20;
```
[[3](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L3)]

</details>

---

### [N-73] Layout order does not comply with best practices

This is a [best practice](https://docs.soliditylang.org/en/latest/style-guide.html#order-of-layout) that should be followed.

Inside each contract, library or interface, use the following order:

1. Type declarations
2. State variables
3. Events
4. Errors
5. Modifiers
6. Functions

*There are 15 instances of this issue.*

<details>
<summary>Expand findings</summary>


```solidity
File: code/system-contracts/contracts/L1Messenger.sol

// @audit function keccakGasCost found on line 50
55: 		    uint256 internal constant SHA256_ROUND_GAS_COST = 7;
```
[[55](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L55)]



```solidity
File: code/system-contracts/contracts/MsgValueSimulator.sol

// @audit function _getAbiParams found on line 25
36: 		    uint256 constant GAS_TO_PASS = 2300;
```
[[36](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/MsgValueSimulator.sol#L36)]



```solidity
File: code/system-contracts/contracts/SystemContext.sol

// @audit function setChainId found on line 84
89: 		    uint16 public txNumberInBlock;
```
[[89](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L89)]



```solidity
File: code/system-contracts/contracts/interfaces/IBaseToken.sol

// @audit function withdrawWithMessage found on line 22
24: 		    event Mint(address indexed account, uint256 amount);
```
[[24](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBaseToken.sol#L24)]



```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

// @audit function initialize found on line 41
45: 		    modifier onlyOwnerOrAdmin() {
```
[[45](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L45)]



```solidity
File: code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol

// @audit function setSharedBridge found on line 131
133: 		    event NewChain(uint256 indexed chainId, address stateTransitionManager, address indexed chainGovernance);
```
[[133](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L133)]



```solidity
File: code/contracts/ethereum/contracts/common/ReentrancyGuard.sol

// @audit function _initializeReentrancyGuard found on line 46
68: 		    modifier nonReentrant() {
```
[[68](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/ReentrancyGuard.sol#L68)]



```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

// @audit function constructor found on line 41
58: 		    modifier onlySelf() {
```
[[58](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L58)]



```solidity
File: code/contracts/ethereum/contracts/governance/IGovernance.sol

// @audit function updateSecurityCouncil found on line 65
68: 		    event TransparentOperationScheduled(bytes32 indexed _id, uint256 delay, Operation _operation);
```
[[68](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L68)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

// @audit function constructor found on line 58
63: 		    modifier onlyBridgehub() {
```
[[63](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L63)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

// @audit error ValidatorDoesNotExist found on line 41
44: 		    IStateTransitionManager public stateTransitionManager;

// @audit function constructor found on line 55
61: 		    modifier onlyChainAdmin(uint256 _chainId) {
```
[[44](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L44)]



```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

// @audit function reinitializeToken found on line 111
129: 		    modifier onlyBridge() {
```
[[129](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L129)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol

// @audit function unfreezeDiamond found on line 58
61: 		    event IsPorterAvailableStatusUpdate(bool isPorterAvailable);
```
[[61](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L61)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol

// @audit function revertBatchesSharedBridge found on line 184
191: 		    event BlockCommit(uint256 indexed batchNumber, bytes32 indexed batchHash, bytes32 indexed commitment);
```
[[191](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L191)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol

// @audit function transferEthToSharedBridge found on line 114
123: 		    event NewPriorityRequest(
```
[[123](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L123)]

</details>

---

### [N-74] Function visibility order does not comply with best practices

This is a [best practice](https://docs.soliditylang.org/en/latest/style-guide.html#order-of-functions) that should be followed.

Functions should be grouped according to their visibility and ordered:

1. constructor
2. receive function (if exists)
3. fallback function (if exists)
4. external
5. public
6. internal
7. private

Within a grouping, place the view and pure functions last.

*There are 103 instances of this issue.*

<details>
<summary>Expand findings</summary>


```solidity
File: code/system-contracts/contracts/AccountCodeStorage.sol

// @audit _storeCodeHash on line 68, which is internal
78: 		    function getRawCodeHash(address _address) public view override returns (bytes32 codeHash) {

// @audit _storeCodeHash on line 68, which is internal
89: 		    function getCodeHash(uint256 _input) external view override returns (bytes32) {

// @audit _storeCodeHash on line 68, which is internal
117: 		    function getCodeSize(uint256 _input) external view override returns (uint256 codeSize) {
```
[[78](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L78), [89](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L89), [117](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L117)]



```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

// @audit _storeAccountInfo on line 58, which is internal
65: 		    function updateAccountVersion(AccountAbstractionVersion _version) external onlySystemCall {

// @audit _storeAccountInfo on line 58, which is internal
74: 		    function updateNonceOrdering(AccountNonceOrdering _nonceOrdering) external onlySystemCall {

// @audit _storeAccountInfo on line 58, which is internal
95: 		    function getNewAddressCreate2(

// @audit _storeAccountInfo on line 58, which is internal
115: 		    function getNewAddressCreate(

// @audit _storeAccountInfo on line 58, which is internal
132: 		    function create2(

// @audit _storeAccountInfo on line 58, which is internal
147: 		    function create(

// @audit _storeAccountInfo on line 58, which is internal
162: 		    function create2Account(

// @audit _storeAccountInfo on line 58, which is internal
182: 		    function createAccount(

// @audit _storeAccountInfo on line 58, which is internal
213: 		    function forceDeployOnAddress(ForceDeployment calldata _deployment, address _sender) external payable onlySelf {

// @audit _storeAccountInfo on line 58, which is internal
238: 		    function forceDeployOnAddresses(ForceDeployment[] calldata _deployments) external payable {
```
[[65](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L65), [74](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L74), [95](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L95), [115](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L115), [132](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L132), [147](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L147), [162](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L162), [182](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L182), [213](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L213), [238](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L238)]



```solidity
File: code/system-contracts/contracts/DefaultAccount.sol

// @audit _validateTransaction on line 78, which is internal
112: 		    function executeTransaction(

// @audit _validateTransaction on line 78, which is internal
125: 		    function executeTransactionFromOutside(Transaction calldata _transaction) external payable override {

// @audit _isValidSignature on line 159, which is internal
196: 		    function payForTransaction(

// @audit _isValidSignature on line 159, which is internal
212: 		    function prepareForPaymaster(

// @audit _isValidSignature on line 159, which is internal
220: 		    fallback() external payable ignoreInDelegateCall {

// @audit _isValidSignature on line 159, which is internal
227: 		    receive() external payable {
```
[[112](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L112), [125](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L125), [196](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L196), [212](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L212), [220](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L220), [227](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L227)]



```solidity
File: code/system-contracts/contracts/EmptyContract.sol

// @audit null on line 11, which is fallback
13: 		    receive() external payable {}
```
[[13](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/EmptyContract.sol#L13)]



```solidity
File: code/system-contracts/contracts/KnownCodesStorage.sol

// @audit _markBytecodeAsPublished on line 46, which is internal
65: 		    function getMarker(bytes32 _hash) public view override returns (uint256 marker) {
```
[[65](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/KnownCodesStorage.sol#L65)]



```solidity
File: code/system-contracts/contracts/L1Messenger.sol

// @audit sha256GasCost on line 61, which is internal
70: 		    function sendL2ToL1Log(

// @audit _processL2ToL1Log on line 94, which is internal
116: 		    function sendToL1(bytes calldata _message) external override returns (bytes32 hash) {

// @audit _processL2ToL1Log on line 94, which is internal
161: 		    function requestBytecodeL1Publication(

// @audit _processL2ToL1Log on line 94, which is internal
194: 		    function publishPubdataAndClearState(
```
[[70](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L70), [116](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L116), [161](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L161), [194](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L194)]



```solidity
File: code/system-contracts/contracts/L2BaseToken.sol

// @audit _getExtendedWithdrawMessage on line 117, which is internal
128: 		    function name() external pure override returns (string memory) {

// @audit _getExtendedWithdrawMessage on line 117, which is internal
134: 		    function symbol() external pure override returns (string memory) {

// @audit _getExtendedWithdrawMessage on line 117, which is internal
140: 		    function decimals() external pure override returns (uint8) {
```
[[128](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L2BaseToken.sol#L128), [134](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L2BaseToken.sol#L134), [140](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L2BaseToken.sol#L140)]



```solidity
File: code/system-contracts/contracts/MsgValueSimulator.sol

// @audit _getAbiParams on line 25, which is internal
47: 		    fallback(bytes calldata _data) external onlySystemCall returns (bytes memory) {
```
[[47](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/MsgValueSimulator.sol#L47)]



```solidity
File: code/system-contracts/contracts/NonceHolder.sol

// @audit getValueUnderNonce on line 102, which is public
110: 		    function incrementMinNonceIfEquals(uint256 _expectedNonce) external onlySystemCall {

// @audit getValueUnderNonce on line 102, which is public
125: 		    function getDeploymentNonce(address _address) external view returns (uint256 deploymentNonce) {

// @audit getValueUnderNonce on line 102, which is public
135: 		    function incrementDeploymentNonce(address _address) external returns (uint256 prevDeploymentNonce) {

// @audit isNonceUsed on line 154, which is public
166: 		    function validateNonceUsage(address _address, uint256 _key, bool _shouldBeUsed) external view {
```
[[110](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/NonceHolder.sol#L110), [125](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/NonceHolder.sol#L125), [135](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/NonceHolder.sol#L135), [166](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/NonceHolder.sol#L166)]



```solidity
File: code/system-contracts/contracts/SystemContext.sol

// @audit getCurrentPubdataSpent on line 117, which is public
122: 		    function getCurrentPubdataCost() external view returns (uint256) {

// @audit getCurrentPubdataSpent on line 117, which is public
132: 		    function getBlockHashEVM(uint256 _block) external view returns (bytes32 hash) {

// @audit getCurrentPubdataSpent on line 117, which is public
166: 		    function getBatchHash(uint256 _batchNumber) external view returns (bytes32 hash) {

// @audit _setNewL2BlockData on line 314, which is internal
341: 		    function setL2Block(

// @audit _setNewL2BlockData on line 314, which is internal
402: 		    function appendTransactionToCurrentL2Block(bytes32 _txHash) external onlyCallFromBootloader {

// @audit _setNewL2BlockData on line 314, which is internal
408: 		    function publishTimestampDataToL1() external onlyCallFromBootloader {

// @audit _ensureBatchConsistentWithL2Block on line 427, which is internal
444: 		    function setNewBatch(

// @audit _ensureBatchConsistentWithL2Block on line 427, which is internal
471: 		    function unsafeOverrideBatch(

// @audit _ensureBatchConsistentWithL2Block on line 427, which is internal
482: 		    function incrementTxNumberInBatch() external onlyCallFromBootloader {

// @audit _ensureBatchConsistentWithL2Block on line 427, which is internal
486: 		    function resetTxNumberInBatch() external onlyCallFromBootloader {

// @audit _ensureBatchConsistentWithL2Block on line 427, which is internal
496: 		    function currentBlockInfo() external view returns (uint256 blockInfo) {

// @audit _ensureBatchConsistentWithL2Block on line 427, which is internal
503: 		    function getBlockNumberAndTimestamp() external view returns (uint256 blockNumber, uint256 blockTimestamp) {

// @audit _ensureBatchConsistentWithL2Block on line 427, which is internal
509: 		    function blockHash(uint256 _blockNumber) external view returns (bytes32 hash) {
```
[[122](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L122), [132](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L132), [166](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L166), [341](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L341), [402](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L402), [408](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L408), [444](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L444), [471](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L471), [482](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L482), [486](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L486), [496](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L496), [503](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L503), [509](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L509)]



```solidity
File: code/system-contracts/contracts/libraries/EfficientCall.sol

// @audit _verifyCallResult on line 215, which is private
232: 		    function propagateRevert() internal pure {
```
[[232](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L232)]



```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

// @audit _encodeHashEIP1559Transaction on line 289, which is private
362: 		    function processPaymasterInput(Transaction calldata _transaction) internal {

// @audit _encodeHashEIP1559Transaction on line 289, which is private
395: 		    function payToTheBootloader(Transaction calldata _transaction) internal returns (bool success) {

// @audit _encodeHashEIP1559Transaction on line 289, which is private
405: 		    function totalRequiredBalance(Transaction calldata _transaction) internal pure returns (uint256 requiredBalance) {
```
[[362](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L362), [395](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L395), [405](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L405)]



```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

// @audit _depositFundsToSharedBridge on line 160, which is internal
176: 		    function claimFailedDeposit(

// @audit _depositFundsToSharedBridge on line 160, which is internal
208: 		    function finalizeWithdrawal(
```
[[176](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L176), [208](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L208)]



```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

// @audit _depositFunds on line 173, which is internal
182: 		    function bridgehubDeposit(

// @audit _depositFunds on line 173, which is internal
232: 		    function bridgehubConfirmL2Transaction(

// @audit _getERC20Getters on line 254, which is internal
277: 		    function claimFailedDeposit(

// @audit _isEraLegacyWithdrawal on line 374, which is internal
385: 		    function finalizeWithdrawal(

// @audit _parseL2WithdrawalMessage on line 487, which is internal
554: 		    function depositLegacyErc20Bridge(

// @audit _parseL2WithdrawalMessage on line 487, which is internal
615: 		    function finalizeWithdrawalLegacyErc20Bridge(

// @audit _parseL2WithdrawalMessage on line 487, which is internal
644: 		    function claimFailedDepositLegacyErc20Bridge(
```
[[182](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L182), [232](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L232), [277](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L277), [385](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L385), [554](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L554), [615](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L615), [644](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L644)]



```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

// @audit getStateTransition on line 75, which is public
82: 		    function addStateTransitionManager(address _stateTransitionManager) external onlyOwner {

// @audit getStateTransition on line 75, which is public
92: 		    function removeStateTransitionManager(address _stateTransitionManager) external onlyOwner {

// @audit getStateTransition on line 75, which is public
101: 		    function addToken(address _token) external onlyOwner {

// @audit getStateTransition on line 75, which is public
108: 		    function setSharedBridge(address _sharedBridge) external onlyOwner {

// @audit getStateTransition on line 75, which is public
114: 		    function createNewChain(

// @audit getStateTransition on line 75, which is public
152: 		    function proveL2MessageInclusion(

// @audit getStateTransition on line 75, which is public
164: 		    function proveL2LogInclusion(

// @audit getStateTransition on line 75, which is public
176: 		    function proveL1ToL2TransactionStatus(

// @audit getStateTransition on line 75, which is public
198: 		    function l2TransactionBaseCost(

// @audit getStateTransition on line 75, which is public
217: 		    function requestL2TransactionDirect(

// @audit getStateTransition on line 75, which is public
262: 		    function requestL2TransactionTwoBridges(
```
[[82](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L82), [92](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L92), [101](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L101), [108](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L108), [114](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L114), [152](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L152), [164](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L164), [176](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L176), [198](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L198), [217](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L217), [262](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L262)]



```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

// @audit getOperationState on line 105, which is public
129: 		    function scheduleTransparent(Operation calldata _operation, uint256 _delay) external onlyOwner {

// @audit getOperationState on line 105, which is public
142: 		    function scheduleShadow(bytes32 _id, uint256 _delay) external onlyOwner {

// @audit getOperationState on line 105, which is public
154: 		    function cancel(bytes32 _id) external onlyOwner {

// @audit getOperationState on line 105, which is public
167: 		    function execute(Operation calldata _operation) external payable onlyOwnerOrSecurityCouncil {

// @audit getOperationState on line 105, which is public
186: 		    function executeInstant(Operation calldata _operation) external payable onlySecurityCouncil {

// @audit _checkPredecessorDone on line 239, which is internal
249: 		    function updateDelay(uint256 _newDelay) external onlySelf {

// @audit _checkPredecessorDone on line 239, which is internal
256: 		    function updateSecurityCouncil(address _newSecurityCouncil) external onlySelf {

// @audit _checkPredecessorDone on line 239, which is internal
262: 		    receive() external payable {}
```
[[129](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L129), [142](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L142), [154](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L154), [167](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L167), [186](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L186), [249](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L249), [256](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L256), [262](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L262)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

// @audit _setChainIdUpgrade on line 177, which is internal
230: 		    function registerAlreadyDeployedStateTransition(

// @audit _setChainIdUpgrade on line 177, which is internal
239: 		    function createNewChain(
```
[[230](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L230), [239](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L239)]



```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol

// @audit _setVerifierParams on line 142, which is private
163: 		    function _upgradeVerifier(address _newVerifier, VerifierParams calldata _verifierParams) internal {

// @audit _setVerifierParams on line 142, which is private
171: 		    function _setBaseSystemContracts(bytes32 _bootloaderHash, bytes32 _defaultAccountHash) internal {

// @audit _setVerifierParams on line 142, which is private
180: 		    function _setL2SystemContractUpgrade(

// @audit _verifyFactoryDeps on line 222, which is private
236: 		    function _setNewProtocolVersion(uint256 _newProtocolVersion) internal virtual {

// @audit _verifyFactoryDeps on line 222, which is private
263: 		    function _upgradeL1Contract(bytes calldata _customCallDataForUpgrade) internal virtual {}

// @audit _verifyFactoryDeps on line 222, which is private
269: 		    function _postUpgrade(bytes calldata _customCallDataForUpgrade) internal virtual {}
```
[[163](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L163), [171](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L171), [180](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L180), [236](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L236), [263](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L263), [269](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L269)]



```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol

// @audit _setNewProtocolVersion on line 20, which is internal
47: 		    function upgrade(ProposedUpgrade calldata _proposedUpgrade) public virtual override returns (bytes32) {
```
[[47](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L47)]



```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

// @audit _deployL2Token on line 109, which is internal
123: 		    function withdraw(address _l1Receiver, address _l2Token, uint256 _amount) external override {

// @audit _getL1WithdrawMessage on line 138, which is internal
149: 		    function l2TokenAddress(address _l1Token) public view override returns (address) {
```
[[123](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L123), [149](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L149)]



```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

// @audit decimals on line 171, which is public
178: 		    function decodeString(bytes memory _input) external pure returns (string memory result) {

// @audit decimals on line 171, which is public
183: 		    function decodeUint8(bytes memory _input) external pure returns (uint8 result) {
```
[[178](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L178), [183](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L183)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

// @audit _processL2Logs on line 130, which is internal
199: 		    function commitBatches(

// @audit _processL2Logs on line 130, which is internal
207: 		    function commitBatchesSharedBridge(

// @audit _executeOneBatch on line 321, which is internal
337: 		    function executeBatchesSharedBridge(

// @audit _executeOneBatch on line 321, which is internal
345: 		    function executeBatches(StoredBatchInfo[] calldata _batchesData) external nonReentrant onlyValidator {

// @audit _executeBatches on line 349, which is internal
368: 		    function proveBatches(

// @audit _executeBatches on line 349, which is internal
377: 		    function proveBatchesSharedBridge(

// @audit _getBatchProofPublicInput on line 453, which is internal
472: 		    function revertBatches(uint256 _newLastBatch) external nonReentrant onlyValidatorOrStateTransitionManager {

// @audit _getBatchProofPublicInput on line 453, which is internal
477: 		    function revertBatchesSharedBridge(uint256, uint256 _newLastBatch) external nonReentrant onlyValidator {
```
[[199](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L199), [207](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L207), [337](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L337), [345](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L345), [368](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L368), [377](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L377), [472](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L472), [477](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L477)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

// @audit proveL2MessageInclusion on line 54, which is public
64: 		    function proveL2LogInclusion(

// @audit _L2MessageToLog on line 130, which is internal
143: 		    function l2TransactionBaseCost(

// @audit _deriveL2GasPrice on line 156, which is internal
178: 		    function finalizeEthWithdrawal(

// @audit _deriveL2GasPrice on line 156, which is internal
197: 		    function requestL2Transaction(
```
[[64](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L64), [143](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L143), [178](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L178), [197](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L197)]

</details>

---

### [N-75] Long functions should be refactored into multiple functions

Consider splitting long functions into multiple, smaller functions to improve the code readability.

*There are 16 instances of this issue.*

<details>
<summary>Expand findings</summary>


```solidity
File: code/system-contracts/contracts/BootloaderUtilities.sol

44: 		    function encodeLegacyTransactionHash(Transaction calldata _transaction) internal view returns (bytes32 txHash) {

139: 		    function encodeEIP2930TransactionHash(Transaction calldata _transaction) internal view returns (bytes32) {

229: 		    function encodeEIP1559TransactionHash(Transaction calldata _transaction) internal view returns (bytes32) {
```
[[44](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L44), [139](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L139), [229](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L229)]



```solidity
File: code/system-contracts/contracts/Compressor.sol

110: 		    function verifyCompressedStateDiffs(
```
[[110](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L110)]



```solidity
File: code/system-contracts/contracts/L1Messenger.sol

194: 		    function publishPubdataAndClearState(
```
[[194](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L194)]



```solidity
File: code/system-contracts/contracts/SystemContext.sol

341: 		    function setL2Block(
```
[[341](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L341)]



```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

147: 		    function _encodeHashLegacyTransaction(Transaction calldata _transaction) private view returns (bytes32) {

219: 		    function _encodeHashEIP2930Transaction(Transaction calldata _transaction) private view returns (bytes32) {

289: 		    function _encodeHashEIP1559Transaction(Transaction calldata _transaction) private view returns (bytes32) {
```
[[147](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L147), [219](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L219), [289](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L289)]



```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

303: 		    function _claimFailedDeposit(
```
[[303](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L303)]



```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

262: 		    function requestL2TransactionTwoBridges(
```
[[262](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L262)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

177: 		    function _setChainIdUpgrade(uint256 _chainId, address _chainContract) internal {
```
[[177](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L177)]



```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

50: 		    function bridgeInitialize(address _l1Address, bytes memory _data) external initializer {
```
[[50](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L50)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

32: 		    function _commitOneBatch(

130: 		    function _processL2Logs(

386: 		    function _proveBatches(
```
[[32](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L32), [130](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L130), [386](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L386)]

</details>

---

### [N-76] Consider moving duplicated strings to constants

This will decrease the probability of making typos, and the code will be more readable

*There are 12 instances of this issue.*


```solidity
File: code/system-contracts/contracts/AccountCodeStorage.sol

37: 		        require(Utils.isContractConstructing(_hash), "Code hash is not for a contract on constructor");

57: 		        require(Utils.isContractConstructing(codeHash), "Code hash is not for a contract on constructor");
```
[[37](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L37), [57](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L57)]



```solidity
File: code/system-contracts/contracts/BootloaderUtilities.sol

92: 		            require(vInt == 27 || vInt == 28, "Invalid v value");

191: 		            require(vInt == 27 || vInt == 28, "Invalid v value");

286: 		            require(vInt == 27 || vInt == 28, "Invalid v value");
```
[[92](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L92), [191](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L191), [286](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L286)]



```solidity
File: code/system-contracts/contracts/libraries/Utils.sol

21: 		        require(_x <= type(uint128).max, "Overflow");

27: 		        require(_x <= type(uint32).max, "Overflow");

33: 		        require(_x <= type(uint24).max, "Overflow");
```
[[21](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L21), [27](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L27), [33](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L33)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

195: 		                require(block.timestamp >= commitBatchTimestamp + delay, "5c"); // The delay is not passed

217: 		                require(block.timestamp >= commitBatchTimestamp + delay, "5c"); // The delay is not passed
```
[[195](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L195), [217](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L217)]



```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

56: 		        require(_l2TokenProxyBytecodeHash != bytes32(0), "df");

58: 		        require(_l2TokenProxyBytecodeHash != bytes32(0), "df");
```
[[56](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L56), [58](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L58)]


---

### [N-77] Consider providing a ranged getter for array state variables

While the compiler automatically provides a getter for accessing single elements within a public state variable array, it doesn't provide a way to fetch the whole array, or subsets thereof.

Consider adding a function to allow the fetching of slices of the array, especially if the contract doesn't already have multicall functionality.

*There is 1 instance of this issue.*


```solidity
File: code/system-contracts/contracts/SystemContext.sol

70: 		    bytes32[MINIBLOCK_HASHES_TO_STORE] internal l2BlockHash;
```
[[70](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L70)]


---

### [N-78] Lines are too long

Maximum suggested line length is 120 characters according to the [documentation](https://docs.soliditylang.org/en/latest/style-guide.html#maximum-line-length).

*There are 145 instances of this issue.*

<details>
<summary>Expand findings</summary>


```solidity
File: code/system-contracts/contracts/AccountCodeStorage.sol

14: 		 * the second byte denotes whether the contract is constructed, and the next two bytes denote the length in 32-byte words.

17: 		 * @dev The length of each bytecode MUST be odd.  It's internal code format requirements, due to padding of SHA256 function.
```
[[14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L14), [17](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L17)]



```solidity
File: code/system-contracts/contracts/BootloaderUtilities.sol

6: 		import {Transaction, TransactionHelper, EIP_712_TX_TYPE, LEGACY_TX_TYPE, EIP_2930_TX_TYPE, EIP_1559_TX_TYPE} from "./libraries/TransactionHelper.sol";

21: 		    /// @return txHash and signedTxHash of the transaction, i.e. the transaction hash to be used in the explorer and commits to all
```
[[6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L6), [21](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L21)]



```solidity
File: code/system-contracts/contracts/ComplexUpgrader.sol

11: 		 * @notice Upgrader which should be used to perform complex multistep upgrades on L2. In case some custom logic for an upgrade is needed
```
[[11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ComplexUpgrader.sol#L11)]



```solidity
File: code/system-contracts/contracts/Compressor.sol

5: 		import {ICompressor, OPERATION_BITMASK, LENGTH_BITS_OFFSET, MAX_ENUMERATION_INDEX_SIZE} from "./interfaces/ICompressor.sol";

10: 		import {L1_MESSENGER_CONTRACT, INITIAL_WRITE_STARTING_POSITION, COMPRESSED_INITIAL_WRITE_SIZE, STATE_DIFF_ENTRY_SIZE, STATE_DIFF_ENUM_INDEX_OFFSET, STATE_DIFF_FINAL_VALUE_OFFSET, STATE_DIFF_DERIVED_KEY_OFFSET, DERIVED_KEY_LENGTH, VALUE_LENGTH, ENUM_INDEX_LENGTH, KNOWN_CODE_STORAGE_CONTRACT} from "./Constants.sol";

17: 		 * @dev Every deployed bytecode/published state diffs in zkEVM should be publicly restorable from the L1 data availability.

41: 		    /// @dev Currently, the method may be called only from the bootloader because the server is not ready to publish bytecodes

43: 		    /// @dev Read more about the compression: https://github.com/matter-labs/zksync-era/blob/main/docs/guides/advanced/compression.md

82: 		    /// @dev We don't verify that the size of {_stateDiffs} is equivalent to {_numberOfStateDiffs} * STATE_DIFF_ENTRY_SIZE since that check is

85: 		    /// @dev This check assumes that the ordering of state diffs are sorted by (address, key) for the encoded state diffs and

87: 		    /// @dev state diff:   [20bytes address][32bytes key][32bytes derived key][8bytes enum index][32bytes initial value][32bytes final value]

213: 		    /// value or difference between initial and final value. It should be of arbitrary length less than or equal to 32 bytes.

214: 		    /// @dev It is the responsibility of the caller of this function to ensure that the `_compressedValue` has length no longer than 32 bytes.
```
[[5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L5), [10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L10), [17](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L17), [41](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L41), [43](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L43), [82](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L82), [85](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L85), [87](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L87), [213](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L213), [214](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L214)]



```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

7: 		import {CREATE2_PREFIX, CREATE_PREFIX, NONCE_HOLDER_SYSTEM_CONTRACT, ACCOUNT_CODE_STORAGE_SYSTEM_CONTRACT, FORCE_DEPLOYER, MAX_SYSTEM_CONTRACT_ADDRESS, KNOWN_CODE_STORAGE_CONTRACT, BASE_TOKEN_SYSTEM_CONTRACT, IMMUTABLE_SIMULATOR_SYSTEM_CONTRACT, COMPLEX_UPGRADER_CONTRACT, KECCAK256_SYSTEM_CONTRACT} from "./Constants.sol";

216: 		        // Since the `forceDeployOnAddress` function is called only during upgrades, the Governance is trusted to correctly select

217: 		        // the addresses to deploy the new bytecodes to and to assess whether overriding the AccountInfo for the "force-deployed"
```
[[7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L7), [216](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L216), [217](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L217)]



```solidity
File: code/system-contracts/contracts/DefaultAccount.sol

9: 		import {BOOTLOADER_FORMAL_ADDRESS, NONCE_HOLDER_SYSTEM_CONTRACT, DEPLOYER_SYSTEM_CONTRACT, INonceHolder} from "./Constants.sol";
```
[[9](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L9)]



```solidity
File: code/system-contracts/contracts/GasBoundCaller.sol

19: 		    /// @notice We assume that no more than `CALL_RETURN_OVERHEAD` ergs are used for the O(1) operations at the end of the execution,

30: 		    /// of the `_maxTotalGas` parameter. In other words, `max(gas(), _maxTotalGas)` is the maximum amount of gas that can be spent by this function.

31: 		    /// @dev The function relays the `returndata` returned by the callee. In case the `callee` reverts, it reverts with the same error.

48: 		        // This is the amount of gas that can be spent *exclusively* on pubdata in addition to the `gas` provided to this function.
```
[[19](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/GasBoundCaller.sol#L19), [30](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/GasBoundCaller.sol#L30), [31](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/GasBoundCaller.sol#L31), [48](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/GasBoundCaller.sol#L48)]



```solidity
File: code/system-contracts/contracts/KnownCodesStorage.sol

15: 		 * the second byte denotes whether the contract is constructed, and the next two bytes denote the length in 32-byte words.
```
[[15](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/KnownCodesStorage.sol#L15)]



```solidity
File: code/system-contracts/contracts/L1Messenger.sol

5: 		import {IL1Messenger, L2ToL1Log, L2_L1_LOGS_TREE_DEFAULT_LEAF_HASH, L2_TO_L1_LOG_SERIALIZE_SIZE, STATE_DIFF_COMPRESSION_VERSION_NUMBER} from "./interfaces/IL1Messenger.sol";

10: 		import {SystemLogKey, SYSTEM_CONTEXT_CONTRACT, KNOWN_CODE_STORAGE_CONTRACT, COMPRESSOR_CONTRACT, STATE_DIFF_ENTRY_SIZE, MAX_ALLOWED_PUBDATA_PER_BATCH, L2_TO_L1_LOGS_MERKLE_TREE_LEAVES, PUBDATA_CHUNK_PUBLISHER, COMPUTATIONAL_PRICE_FOR_PUBDATA} from "./Constants.sol";

187: 		    ///        processed in the current L1 Batch. Pubdata consists of L2 to L1 Logs, messages, deployed bytecode, and state diffs.

190: 		    /// @dev The data passed in also contains the encoded state diffs to be checked again, however this is aux data that is not

277: 		        /// body (`compressedStateDiffSize` bytes, 4 bytes number of state diffs, `numberOfStateDiffs` * `STATE_DIFF_ENTRY_SIZE` bytes for the uncompressed state diffs)

278: 		        /// encoded state diffs: [20bytes address][32bytes key][32bytes derived key][8bytes enum index][32bytes initial value][32bytes final value]
```
[[5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L5), [10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L10), [187](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L187), [190](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L190), [277](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L277), [278](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L278)]



```solidity
File: code/system-contracts/contracts/L2BaseToken.sol

7: 		import {MSG_VALUE_SYSTEM_CONTRACT, DEPLOYER_SYSTEM_CONTRACT, BOOTLOADER_FORMAL_ADDRESS, L1_MESSENGER_CONTRACT} from "./Constants.sol";

14: 		 * @dev It does NOT provide interfaces for personal interaction with tokens like `transfer`, `approve`, and `transferFrom`.

82: 		    /// @notice Initiate the ETH withdrawal, with the sent message. The funds will be available to claim on L1 `finalizeEthWithdrawal` method.
```
[[7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L2BaseToken.sol#L7), [14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L2BaseToken.sol#L14), [82](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L2BaseToken.sol#L82)]



```solidity
File: code/system-contracts/contracts/MsgValueSimulator.sol

40: 		    /// It is equal to the following constant: https://github.com/matter-labs/era-zkevm_opcode_defs/blob/7bf8016f5bb13a73289f321ad6ea8f614540ece9/src/system_params.rs#L96.
```
[[40](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/MsgValueSimulator.sol#L40)]



```solidity
File: code/system-contracts/contracts/NonceHolder.sol

24: 		 * @dev The behavior of some of the methods depends on the nonce ordering of the account. Nonce ordering is a mere suggestion and all the checks that are present
```
[[24](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/NonceHolder.sol#L24)]



```solidity
File: code/system-contracts/contracts/PubdataChunkPublisher.sol

20: 		    /// @dev We always publish 2 system logs even if our pubdata fits into a single blob. This makes processing logs on L1 easier.
```
[[20](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/PubdataChunkPublisher.sol#L20)]



```solidity
File: code/system-contracts/contracts/SystemContext.sol

21: 		    /// - Store the latest 256 hashes (and strictly rely that we do not accidentally override the hash of the block 256 blocks ago)

65: 		    /// of the miniblocks cheaper, we only store the previous MINIBLOCK_HASHES_TO_STORE ones. Since whenever we need to publish a state

67: 		    /// By having this data in a cyclic array of MINIBLOCK_HASHES_TO_STORE blocks, we bring the costs down by 40% (i.e. 40 bytes per miniblock instead of 64 bytes).

69: 		    /// @dev Hashes of the blocks older than the ones which are stored here can be calculated as _calculateLegacyL2BlockHash(blockNumber).

74: 		    /// - Their number will start from being equal to the number of the batch and it will increase until it reaches the L2 block number.

79: 		    /// @notice The information about the virtual blocks upgrade, which tracks when the migration to the L2 blocks has started and finished.

139: 		        // 2. If the block was created before the upgrade for the virtual blocks (i.e. there we used to use hashes of the batches),

142: 		        // all the information which is returned for users should be for L2 blocks, we return the hash of the corresponding L2 block.

157: 		            // that's why the legacy L2 blocks' hashes are keccak256(abi.encodePacked(uint32(_block))), while these are equivalent to

281: 		            // Note, that when setting the virtual block number we use the batch number to make a smoother upgrade from batch number to

299: 		        // We do not use a `require` here, since the virtual blocks are a temporary solution to let the Solidity's `block.number`
```
[[21](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L21), [65](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L65), [67](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L67), [69](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L69), [74](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L74), [79](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L79), [139](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L139), [142](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L142), [157](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L157), [281](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L281), [299](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L299)]



```solidity
File: code/system-contracts/contracts/interfaces/IL1Messenger.sol

6: 		/// @param l2ShardId The shard identifier, 0 - rollup, 1 - porter. All other values are not used but are reserved for the future

24: 		/// @dev Equal to the bytes size of the tuple - (uint8 ShardId, bool isService, uint16 txNumberInBlock, address sender, bytes32 key, bytes32 value)

30: 		bytes32 constant L2_L1_LOGS_TREE_DEFAULT_LEAF_HASH = 0x72abee45b59e344af8a6e520241c4744aff26ed411f4c4b00f8af09adada43ba;
```
[[6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL1Messenger.sol#L6), [24](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL1Messenger.sol#L24), [30](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL1Messenger.sol#L30)]



```solidity
File: code/system-contracts/contracts/interfaces/ISystemContext.sol

25: 		        /// all the information returned to users for block.timestamp/number, etc should be the information about the L2 blocks and
```
[[25](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L25)]



```solidity
File: code/system-contracts/contracts/interfaces/ISystemContextDeprecated.sol

8: 		 * @notice The interface with deprecated functions of the SystemContext contract. It is aimed for backward compatibility.
```
[[8](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContextDeprecated.sol#L8)]



```solidity
File: code/system-contracts/contracts/libraries/EfficientCall.sol

16: 		 * In turn, zkEVM operates over a fat pointer, which is a set of (memory page, offset, start, length) in the memory/calldata/returndata.

25: 		 * 3. `ptr.pack` - Do the concatenation between the lowest 128 bits of the pointer itself and the highest 128 bits of `_value`. It is typically used to prepare the ABI for external calls.
```
[[16](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L16), [25](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L25)]



```solidity
File: code/system-contracts/contracts/libraries/SystemContractHelper.sol

7: 		import {SystemContractsCaller, CalldataForwardingMode, CALLFLAGS_CALL_ADDRESS, CODE_ADDRESS_CALL_ADDRESS, EVENT_WRITE_ADDRESS, EVENT_INITIALIZE_ADDRESS, GET_EXTRA_ABI_DATA_ADDRESS, LOAD_CALLDATA_INTO_ACTIVE_PTR_CALL_ADDRESS, META_CODE_SHARD_ID_OFFSET, META_CALLER_SHARD_ID_OFFSET, META_SHARD_ID_OFFSET, META_AUX_HEAP_SIZE_OFFSET, META_HEAP_SIZE_OFFSET, META_GAS_PER_PUBDATA_BYTE_OFFSET, MIMIC_CALL_BY_REF_CALL_ADDRESS, META_CALL_ADDRESS, MSG_VALUE_SIMULATOR_IS_SYSTEM_BIT, PTR_CALLDATA_CALL_ADDRESS, PTR_ADD_INTO_ACTIVE_CALL_ADDRESS, PTR_SHRINK_INTO_ACTIVE_CALL_ADDRESS, PTR_PACK_INTO_ACTIVE_CALL_ADDRESS, RAW_FAR_CALL_BY_REF_CALL_ADDRESS, PRECOMPILE_CALL_ADDRESS, SET_CONTEXT_VALUE_CALL_ADDRESS, SYSTEM_CALL_BY_REF_CALL_ADDRESS, TO_L1_CALL_ADDRESS} from "./SystemContractsCaller.sol";
```
[[7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L7)]



```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

86: 		            "Transaction(uint256 txType,uint256 from,uint256 to,uint256 gasLimit,uint256 gasPerPubdataByteLimit,uint256 maxFeePerGas,uint256 maxPriorityFeePerGas,uint256 paymaster,uint256 nonce,uint256 value,bytes data,bytes32[] factoryDeps,bytes paymasterInput)"

291: 		        // H(0x02 || RLP(chain_id, nonce, max_priority_fee_per_gas, max_fee_per_gas, gas_limit, destination, amount, data, access_list))
```
[[86](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L86), [291](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L291)]



```solidity
File: code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol

9: 		 * @dev Each of the functions accepts the `bytes calldata` and the offset where data should be read and returns a value of a certain type.
```
[[9](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol#L9)]



```solidity
File: code/system-contracts/contracts/libraries/Utils.sol

55: 		    /// @notice Denotes whether bytecode hash corresponds to a contract that is on constructor or has already been constructed
```
[[55](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L55)]



```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

31: 		    /// @dev Used for saving the number of deposited funds, to claim them in case the deposit transaction will fail in zkSync Era.
```
[[31](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L31)]



```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

21: 		import {ERA_CHAIN_ID, ERA_ERC20_BRIDGE_ADDRESS, ETH_TOKEN_ADDRESS, ERA_DIAMOND_PROXY, TWO_BRIDGES_MAGIC_VALUE} from "../common/Config.sol";

22: 		import {IBridgehub, L2TransactionRequestTwoBridgesInner, L2TransactionRequestDirect} from "../bridgehub/IBridgehub.sol";

43: 		    /// This variable is used to differentiate between pre-upgrade and post-upgrade withdrawals. Withdrawals from batches older

47: 		    /// @dev A mapping chainId => bridgeProxy. Used to store the bridge proxy's address, and to see if it has been deployed yet.

103: 		    /// implementation. The owner is the Governor and separate from the ProxyAdmin from now on, so that the Governor can call the bridge.

160: 		            uint256 amount = _depositFunds(_prevMsgSender, IERC20(_l1Token), _amount); // note if _prevMsgSender is this contract, this will return 0. This does not happen.

167: 		        // Note that we don't save the deposited amount, as this is for the base token, which gets sent to the refundRecipient if the tx fails

230: 		    /// @notice Confirms the acceptance of a transaction by the Mailbox, as part of the L2 transaction process within Bridgehub.

332: 		                // Deposits that happened before the upgrade cannot be checked here, they have to be claimed and checked in the legacyBridge

494: 		        // It should be equal to the length of the bytes4 function signature + address l1Receiver + uint256 amount = 4 + 20 + 32 = 56 (bytes).

587: 		                mintValue: msg.value, // l2 gas + l2 msg.Value the bridgehub will withdraw the mintValue from the base token bridge for gas

588: 		                l2Value: 0, // L2 msg.value, this contract doesn't support base token deposits or wrapping functionality, for direct deposits use bridgehub
```
[[21](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L21), [22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L22), [43](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L43), [47](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L47), [103](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L103), [160](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L160), [167](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L167), [230](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L230), [332](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L332), [494](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L494), [587](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L587), [588](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L588)]



```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

216: 		    /// This means this is not ideal for contract calls, as the contract would have to handle token allowance of the base Token
```
[[216](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L216)]



```solidity
File: code/contracts/ethereum/contracts/common/Config.sol

19: 		bytes32 constant L2_L1_LOGS_TREE_DEFAULT_LEAF_HASH = 0x72abee45b59e344af8a6e520241c4744aff26ed411f4c4b00f8af09adada43ba;
```
[[19](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/Config.sol#L19)]



```solidity
File: code/contracts/ethereum/contracts/common/ReentrancyGuard.sol

32: 		    // https://github.com/OpenZeppelin/openzeppelin-contracts/blob/566a774222707e424896c0c390a84dc3c13bdcb2/contracts/security/ReentrancyGuard.sol
```
[[32](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/ReentrancyGuard.sol#L32)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

19: 		import {REQUIRED_L2_GAS_PRICE_PER_PUBDATA, L2_TO_L1_LOG_SERIALIZE_SIZE, DEFAULT_L2_LOGS_TREE_ROOT_HASH, EMPTY_STRING_KECCAK, SYSTEM_UPGRADE_L2_TX_TYPE, ERA_DIAMOND_PROXY, ERA_CHAIN_ID} from "../common/Config.sol";
```
[[19](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L19)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

13: 		/// @notice Intermediate smart contract between the validator EOA account and the hyperchains state transition diamond smart contract.

15: 		/// modifying the main hyperchain diamond contract. As such, even if this contract is compromised, it will not impact the main
```
[[13](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L13), [15](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L15)]



```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol

11: 		import {MAX_NEW_FACTORY_DEPS, SYSTEM_UPGRADE_L2_TX_TYPE, MAX_ALLOWED_PROTOCOL_VERSION_DELTA} from "../common/Config.sol";
```
[[11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L11)]



```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol

11: 		import {MAX_NEW_FACTORY_DEPS, SYSTEM_UPGRADE_L2_TX_TYPE, MAX_ALLOWED_PROTOCOL_VERSION_DELTA} from "../common/Config.sol";
```
[[11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L11)]



```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

15: 		import {L2ContractHelper, DEPLOYER_SYSTEM_CONTRACT, L2_BASE_TOKEN_ADDRESS, IContractDeployer} from "../L2ContractHelper.sol";
```
[[15](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L15)]



```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

5: 		import {ERC20PermitUpgradeable} from "@openzeppelin/contracts-upgradeable/token/ERC20/extensions/draft-ERC20PermitUpgradeable.sol";

19: 		    /// @notice Our goal is to store all the getters that L1 token implements, and for others, we keep it as an unimplemented method.
```
[[5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L5), [19](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L19)]



```solidity
File: code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol

9: 		 * @dev Each of the functions accepts the `bytes memory` and the offset where data should be read and returns a value of a certain type.
```
[[9](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol#L9)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol

69: 		    /// @notice Address which will exercise critical changes to the Diamond Proxy (upgrades, freezing & unfreezing). Replaced by STM

149: 		    /// @notice gasPriceMultiplier for each baseToken, so that each L1->L2 transaction pays for its transaction on the destination
```
[[69](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L69), [149](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L149)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol

21: 		/// @dev Enum used to determine the source of pubdata. At first we will support calldata and blobs but this can be extended.

45: 		/// @dev Offset used to pull Value From Log. Equal to 4 (bytes for isService) + 20 (bytes for address) + 32 (bytes for key)

53: 		/// @dev Format: list of: opening point (16 bytes) || claimed value (32 bytes) || commitment (48 bytes) || proof (48 bytes)) = 144 bytes

77: 		    /// @param indexRepeatedStorageChanges The serial number of the shortcut index that's used as a unique identifier for storage keys that were used twice or more

97: 		    /// @param indexRepeatedStorageChanges The serial number of the shortcut index that's used as a unique identifier for storage keys that were used twice or more

101: 		    /// @param bootloaderHeapInitialContentsHash Hash of the initial contents of the bootloader heap. In practice it serves as the commitment to the transactions in the batch.

102: 		    /// @param eventsQueueStateHash Hash of the events queue state. In practice it serves as the commitment to the events in the batch.

105: 		    /// @dev pubdataCommitments format: This will always start with a 1 byte pubdataSource flag. Current allowed values are 0 (calldata) or 1 (blobs)

106: 		    ///                             kzg: list of: opening point (16 bytes) || claimed value (32 bytes) || commitment (48 bytes) || proof (48 bytes) = 144 bytes

108: 		    ///                                       and 32 bytes appended to serve as the blob commitment part for the aux output part of the batch commitment

110: 		    /// @dev When using calldata, we only need to send one blob commitment since the max number of bytes in calldata fits in a single blob and we can pull the

196: 		    /// @dev It has the name "BlocksVerification" and not "BatchesVerification" due to backward compatibility considerations
```
[[21](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L21), [45](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L45), [53](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L53), [77](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L77), [97](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L97), [101](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L101), [102](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L102), [105](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L105), [106](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L106), [108](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L108), [110](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L110), [196](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L196)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol

10: 		/// @title The interface of the Getters Contract that implements functions for getting contract state from outside the blockchain.

54: 		    /// in case exactly *unprocessed* transactions are needed, one should check that getPriorityQueueSize() is greater than 0.

111: 		    /// @return the baseTokenGasPriceMultiplierNominator, used to compare the baseTokenPrice to ether for L1->L2 transactions

114: 		    /// @return the baseTokenGasPriceMultiplierDenominator, used to compare the baseTokenPrice to ether for L1->L2 transactions
```
[[10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L10), [54](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L54), [111](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L111), [114](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L114)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol

6: 		import {L2CanonicalTransaction, L2Log, L2Message, TxStatus, BridgehubL2TransactionRequest} from "../../common/Messaging.sol";

15: 		    /// @param _message Information about the sent message: sender address, the message itself, tx index in the L2 batch where the message was sent

46: 		    /// NOTE: It may return `false` for incorrect proof, but it doesn't mean that the L1 -> L2 transaction has an opposite status!

75: 		    /// @param _l2GasPerPubdataByteLimit The maximum amount L2 gas that the operator may charge the user for single byte of pubdata.

79: 		    /// Please note, the contract may change the refund recipient's address to eliminate sending funds to addresses out of control.

81: 		    /// - If `_refundRecipient` is set to `address(0)` and the sender has NO deployed bytecode on L1, the refund will be sent to the `msg.sender` address.

82: 		    /// - If `_refundRecipient` is set to `address(0)` and the sender has deployed bytecode on L1, the refund will be sent to the aliased `msg.sender` address.

83: 		    /// @dev The address aliasing of L1 contracts as refund recipient on L2 is necessary to guarantee that the funds are controllable,

87: 		    /// @return canonicalTxHash The hash of the requested L2 transaction. This hash can be used to follow the transaction status

105: 		    /// @param _l2GasPerPubdataByteLimit The maximum amount of L2 gas that the operator may charge the user for a single byte of pubdata.
```
[[6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L6), [15](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L15), [46](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L46), [75](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L75), [79](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L79), [81](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L81), [82](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L82), [83](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L83), [87](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L87), [105](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L105)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol

16: 		    /// @dev Used to distinguish calls to contracts that were supposed to be used as diamond initializer from other contracts.

22: 		        0xc8fcad8db84d3cc18b4c41d551ea0ee66dd599cde068d998e57d5e09332c131b; // keccak256("diamond.standard.diamond.storage") - 1;
```
[[16](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L16), [22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L22)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/LibMap.sol

6: 		/// @dev This library is an adaptation of the corresponding Solady library (https://github.com/vectorized/solady/blob/main/src/utils/LibMap.sol)
```
[[6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/LibMap.sol#L6)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol

13: 		    /// NOTE: When using this function, check that the _path length is equal to the tree height to prevent shorter/longer paths attack
```
[[13](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol#L13)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol

8: 		import {TX_SLOT_OVERHEAD_L2_GAS, MEMORY_OVERHEAD_GAS, L1_TX_INTRINSIC_L2_GAS, L1_TX_DELTA_544_ENCODING_BYTES, L1_TX_DELTA_FACTORY_DEPS_L2_GAS, L1_TX_MIN_L2_GAS_BASE, L1_TX_INTRINSIC_PUBDATA, L1_TX_DELTA_FACTORY_DEPS_PUBDATA} from "../../common/Config.sol";

68: 		    /// Note: The calculation includes the main cost of the priority transaction, however, in reality, the operator can spend a little more gas on overheads.

107: 		    /// and the L2 gas needed to process the transaction itself (i.e. the actual l2GasLimit that will be used for the transaction).
```
[[8](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L8), [68](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L68), [107](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L107)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol

90: 		        require(s.totalBatchesCommitted == 0, "AdminFacet: set validium only after genesis"); // Validium mode can be set only before the first batch is committed
```
[[90](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L90)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

6: 		import {COMMIT_TIMESTAMP_NOT_OLDER, COMMIT_TIMESTAMP_APPROXIMATION_DELTA, EMPTY_STRING_KECCAK, L2_TO_L1_LOG_SERIALIZE_SIZE, MAX_L2_TO_L1_LOGS_COMMITMENT_BYTES, PACKED_L2_BLOCK_TIMESTAMP_MASK, PUBLIC_INPUT_SHIFT, POINT_EVALUATION_PRECOMPILE_ADDR} from "../../../common/Config.sol";

7: 		import {IExecutor, L2_LOG_ADDRESS_OFFSET, L2_LOG_KEY_OFFSET, L2_LOG_VALUE_OFFSET, SystemLogKey, LogProcessingOutput, PubdataSource, BLS_MODULUS, PUBDATA_COMMITMENT_SIZE, PUBDATA_COMMITMENT_CLAIMED_VALUE_OFFSET, PUBDATA_COMMITMENT_COMMITMENT_OFFSET, MAX_NUMBER_OF_BLOBS, TOTAL_BLOBS_IN_COMMITMENT} from "../../chain-interfaces/IExecutor.sol";

12: 		import {L2_BOOTLOADER_ADDRESS, L2_TO_L1_MESSENGER_SYSTEM_CONTRACT_ADDR, L2_SYSTEM_CONTEXT_SYSTEM_CONTRACT_ADDR, L2_PUBDATA_CHUNK_PUBLISHER_ADDR} from "../../../common/L2ContractAddresses.sol";

57: 		            // In this scenario, pubdataCommitments is a list of: opening point (16 bytes) || claimed value (32 bytes) || commitment (48 bytes) || proof (48 bytes)) = 144 bytes

60: 		            // In this scenario pubdataCommitments is actual pubdata consisting of l2 to l1 logs, l2 to l1 message, compressed smart contract bytecode, and compressed state diffs

100: 		    /// @param _packedBatchAndL2BlockTimestamp - packed batch and L2 block timestamp in a format of batchTimestamp * 2**128 + l2BatchTimestamp

123: 		        require(lastL2BlockTimestamp <= block.timestamp + COMMIT_TIMESTAMP_APPROXIMATION_DELTA, "h2"); // The last L2 block timestamp is too big

221: 		        // 1. A chain has to keep their protocol version up to date, as processing a block requires the latest or previous protocol version

222: 		        // to solve this we will need to add the feature to create batches with only the protocol upgrade tx, without any other txs.

223: 		        // 2. A chain might become out of sync if it launches while we are in the middle of a protocol upgrade. This would mean they cannot process their genesis upgrade

224: 		        // as thier protocolversion would be outdated, and they also cannot process the protocol upgrade tx as they have a pending upgrade.

225: 		        // 3. The protocol upgrade is increased in the BaseZkSyncUpgrade, in the executor only the systemContractsUpgradeTxHash is checked

230: 		        // With the new changes for EIP-4844, namely the restriction on number of blobs per block, we only allow for a single batch to be committed at a time.

233: 		        require(s.storedBatchHashes[s.totalBatchesCommitted] == _hashStoredBatchInfo(_lastCommittedBatchData), "i"); // incorrect previous batch data

282: 		        // While the logic of the contract ensures that the s.l2SystemContractsUpgradeBatchNumber is 0 when this function is called,

330: 		        require(priorityOperationsHash == _storedBatch.priorityOperationsHash, "x"); // priority operations hash does not match to expected

358: 		        require(newTotalBatchesExecuted <= s.totalBatchesVerified, "n"); // Can't execute batches more than committed and proven currently.

621: 		    /// @dev Verifies that the blobs contain the correct data by calling the point evaluation precompile. For the precompile we need:

624: 		    /// pubdataCommitments is a list of: opening point (16 bytes) || claimed value (32 bytes) || commitment (48 bytes) || proof (48 bytes)) = 144 bytes
```
[[6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L6), [7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L7), [12](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L12), [57](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L57), [60](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L60), [100](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L100), [123](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L123), [221](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L221), [222](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L222), [223](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L223), [224](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L224), [225](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L225), [230](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L230), [233](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L233), [282](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L282), [330](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L330), [358](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L358), [621](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L621), [624](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L624)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

11: 		import {WritePriorityOpParams, L2CanonicalTransaction, L2Message, L2Log, TxStatus, BridgehubL2TransactionRequest} from "../../../common/Messaging.sol";

18: 		import {REQUIRED_L2_GAS_PRICE_PER_PUBDATA, L1_GAS_PER_PUBDATA_BYTE, L2_L1_LOGS_TREE_DEFAULT_LEAF_HASH, PRIORITY_OPERATION_L2_TX_TYPE, PRIORITY_EXPIRATION, MAX_NEW_FACTORY_DEPS, ETH_TOKEN_ADDRESS, ERA_CHAIN_ID} from "../../../common/Config.sol";

19: 		import {L2_BOOTLOADER_ADDRESS, L2_TO_L1_MESSENGER_SYSTEM_CONTRACT_ADDR, L2_BASE_TOKEN_SYSTEM_CONTRACT_ADDR} from "../../../common/L2ContractAddresses.sol";

90: 		        // - l2ShardId = 0 (means that L1 -> L2 transaction was processed in a rollup shard, other shards are not available yet anyway)

232: 		        // Please note, currently zkSync address derivation is different from Ethereum one, but it may be changed in the future.

240: 		        // VERY IMPORTANT: nobody should rely on this constant to be fixed and every contract should give their users the ability to provide the
```
[[11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L11), [18](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L18), [19](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L19), [90](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L90), [232](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L232), [240](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L240)]

</details>

---

### [N-79] Some variables have a implicit default visibility

Consider always adding an explicit visibility modifier for variables, as the default is `internal`.

*There are 11 instances of this issue.*

<details>
<summary>Expand findings</summary>


```solidity
File: code/system-contracts/contracts/AccountCodeStorage.sol

23: 		    bytes32 constant EMPTY_STRING_KECCAK = 0xc5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470;
```
[[23](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L23)]



```solidity
File: code/system-contracts/contracts/GasBoundCaller.sol

18: 		    uint256 constant CALL_ENTRY_OVERHEAD = 800;

21: 		    uint256 constant CALL_RETURN_OVERHEAD = 200;
```
[[18](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/GasBoundCaller.sol#L18), [21](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/GasBoundCaller.sol#L21)]



```solidity
File: code/system-contracts/contracts/MsgValueSimulator.sol

36: 		    uint256 constant GAS_TO_PASS = 2300;

41: 		    uint256 constant MSG_VALUE_SIMULATOR_STIPEND_GAS = 27000;
```
[[36](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/MsgValueSimulator.sol#L36), [41](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/MsgValueSimulator.sol#L41)]



```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

82: 		    bytes32 constant EIP712_DOMAIN_TYPEHASH = keccak256("EIP712Domain(string name,string version,uint256 chainId)");

84: 		    bytes32 constant EIP712_TRANSACTION_TYPE_HASH =
```
[[82](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L82), [84](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L84)]



```solidity
File: code/system-contracts/contracts/libraries/Utils.sol

13: 		    bytes32 constant IS_CONSTRUCTOR_BYTECODE_HASH_BIT_MASK =

17: 		    bytes32 constant SET_IS_CONSTRUCTOR_MARKER_BIT_MASK =
```
[[13](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L13), [17](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L17)]



```solidity
File: code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol

22: 		    uint160 constant offset = uint160(0x1111000000000000000000000000000000001111);
```
[[22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol#L22)]



```solidity
File: code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol

22: 		    uint160 constant offset = uint160(0x1111000000000000000000000000000000001111);
```
[[22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol#L22)]

</details>

---

### [N-80] Consider adding a block/deny-list

This can help to prevent hackers from using stolen tokens, but as a side effect it will increase the project centralization.

*There are 10 instances of this issue.*

<details>
<summary>Expand findings</summary>


```solidity
File: code/system-contracts/contracts/AccountCodeStorage.sol

22: 		contract AccountCodeStorage is IAccountCodeStorage {
```
[[22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L22)]



```solidity
File: code/system-contracts/contracts/DefaultAccount.sol

19: 		contract DefaultAccount is IAccount {
```
[[19](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L19)]



```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

19: 		contract L1ERC20Bridge is IL1ERC20Bridge, ReentrancyGuard {
```
[[19](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L19)]



```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

30: 		contract L1SharedBridge is IL1SharedBridge, ReentrancyGuard, Initializable, Ownable2Step {
```
[[30](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L30)]



```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

16: 		contract Bridgehub is IBridgehub, ReentrancyGuard, Ownable2Step {
```
[[16](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L16)]



```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

20: 		contract Governance is IGovernance, Ownable2Step {
```
[[20](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L20)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

25: 		contract StateTransitionManager is IStateTransitionManager, ReentrancyGuard, Ownable2Step {
```
[[25](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L25)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

22: 		contract ValidatorTimelock is IExecutor, Ownable2Step {
```
[[22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L22)]



```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

23: 		contract L2SharedBridge is IL2SharedBridge, Initializable {
```
[[23](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L23)]



```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

15: 		contract L2StandardERC20 is ERC20PermitUpgradeable, IL2StandardToken, ERC1967Upgrade {
```
[[15](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L15)]

</details>

---

### [N-81] Use of `override` is unnecessary

Starting with Solidity version [0.8.8](https://docs.soliditylang.org/en/latest/contracts.html#function-overriding), using the override keyword when the function solely overrides an interface function, and the function doesn't exist in multiple base contracts, is unnecessary.

*There are 54 instances of this issue.*

<details>
<summary>Expand findings</summary>


```solidity
File: code/system-contracts/contracts/AccountCodeStorage.sol

35: 		    function storeAccountConstructingCodeHash(address _address, bytes32 _hash) external override onlyDeployer {

46: 		    function storeAccountConstructedCodeHash(address _address, bytes32 _hash) external override onlyDeployer {

54: 		    function markAccountCodeHashAsConstructed(address _address) external override onlyDeployer {

78: 		    function getRawCodeHash(address _address) public view override returns (bytes32 codeHash) {

89: 		    function getCodeHash(uint256 _input) external view override returns (bytes32) {

117: 		    function getCodeSize(uint256 _input) external view override returns (uint256 codeSize) {
```
[[35](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L35), [46](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L46), [54](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L54), [78](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L78), [89](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L89), [117](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L117)]



```solidity
File: code/system-contracts/contracts/BootloaderUtilities.sol

24: 		    function getTransactionHashes(
```
[[24](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L24)]



```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

95: 		    function getNewAddressCreate2(

115: 		    function getNewAddressCreate(

132: 		    function create2(

147: 		    function create(

162: 		    function create2Account(

182: 		    function createAccount(
```
[[95](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L95), [115](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L115), [132](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L132), [147](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L147), [162](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L162), [182](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L182)]



```solidity
File: code/system-contracts/contracts/DefaultAccount.sol

67: 		    function validateTransaction(

112: 		    function executeTransaction(

125: 		    function executeTransactionFromOutside(Transaction calldata _transaction) external payable override {
```
[[67](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L67), [112](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L112), [125](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L125)]



```solidity
File: code/system-contracts/contracts/ImmutableSimulator.sol

27: 		    function getImmutable(address _dest, uint256 _index) external view override returns (bytes32) {

34: 		    function setImmutables(address _dest, ImmutableData[] calldata _immutables) external override {
```
[[27](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ImmutableSimulator.sol#L27), [34](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ImmutableSimulator.sol#L34)]



```solidity
File: code/system-contracts/contracts/KnownCodesStorage.sol

65: 		    function getMarker(bytes32 _hash) public view override returns (uint256 marker) {
```
[[65](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/KnownCodesStorage.sol#L65)]



```solidity
File: code/system-contracts/contracts/L1Messenger.sol

116: 		    function sendToL1(bytes calldata _message) external override returns (bytes32 hash) {

161: 		    function requestBytecodeL1Publication(
```
[[116](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L116), [161](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L161)]



```solidity
File: code/system-contracts/contracts/L2BaseToken.sol

32: 		    function transferFromTo(address _from, address _to, uint256 _amount) external override {

56: 		    function balanceOf(uint256 _account) external view override returns (uint256) {

64: 		    function mint(address _account, uint256 _amount) external override onlyCallFromBootloader {

72: 		    function withdraw(address _l1Receiver) external payable override {

85: 		    function withdrawWithMessage(address _l1Receiver, bytes memory _additionalData) external payable override {

128: 		    function name() external pure override returns (string memory) {

134: 		    function symbol() external pure override returns (string memory) {

140: 		    function decimals() external pure override returns (uint8) {
```
[[32](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L2BaseToken.sol#L32), [56](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L2BaseToken.sol#L56), [64](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L2BaseToken.sol#L64), [72](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L2BaseToken.sol#L72), [85](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L2BaseToken.sol#L85), [128](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L2BaseToken.sol#L128), [134](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L2BaseToken.sol#L134), [140](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L2BaseToken.sol#L140)]



```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

182: 		    function bridgehubDeposit(

232: 		    function bridgehubConfirmL2Transaction(

277: 		    function claimFailedDeposit(

385: 		    function finalizeWithdrawal(

554: 		    function depositLegacyErc20Bridge(

615: 		    function finalizeWithdrawalLegacyErc20Bridge(

644: 		    function claimFailedDepositLegacyErc20Bridge(
```
[[182](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L182), [232](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L232), [277](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L277), [385](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L385), [554](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L554), [615](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L615), [644](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L644)]



```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

152: 		    function proveL2MessageInclusion(

164: 		    function proveL2LogInclusion(

176: 		    function proveL1ToL2TransactionStatus(

217: 		    function requestL2TransactionDirect(

262: 		    function requestL2TransactionTwoBridges(
```
[[152](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L152), [164](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L164), [176](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L176), [217](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L217), [262](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L262)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

74: 		    function getChainAdmin(uint256 _chainId) external view override returns (address) {
```
[[74](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L74)]



```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol

20: 		    function _setNewProtocolVersion(uint256 _newProtocolVersion) internal override {

47: 		    function upgrade(ProposedUpgrade calldata _proposedUpgrade) public virtual override returns (bytes32) {
```
[[20](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L20), [47](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L47)]



```solidity
File: code/contracts/ethereum/contracts/upgrades/DefaultUpgrade.sol

13: 		    function upgrade(ProposedUpgrade calldata _proposedUpgrade) public override returns (bytes32) {
```
[[13](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/DefaultUpgrade.sol#L13)]



```solidity
File: code/contracts/ethereum/contracts/upgrades/GenesisUpgrade.sol

14: 		    function upgrade(ProposedUpgrade calldata _proposedUpgrade) public override returns (bytes32) {
```
[[14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/GenesisUpgrade.sol#L14)]



```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

79: 		    function finalizeDeposit(

123: 		    function withdraw(address _l1Receiver, address _l2Token, uint256 _amount) external override {

149: 		    function l2TokenAddress(address _l1Token) public view override returns (address) {
```
[[79](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L79), [123](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L123), [149](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L149)]



```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

145: 		    function bridgeMint(address _to, uint256 _amount) external override onlyBridge {

154: 		    function bridgeBurn(address _from, uint256 _amount) external override onlyBridge {

159: 		    function name() public view override returns (string memory) {

165: 		    function symbol() public view override returns (string memory) {

171: 		    function decimals() public view override returns (uint8) {
```
[[145](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L145), [154](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L154), [159](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L159), [165](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L165), [171](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L171)]

</details>

---

### [N-82] Missing variable names

Consider adding a comment with the variable name even if it's not used, to improve the code readability.

*There are 13 instances of this issue.*


```solidity
File: code/system-contracts/contracts/interfaces/IBaseToken.sol

6: 		    function balanceOf(uint256) external view returns (uint256);
```
[[6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBaseToken.sol#L6)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

109: 		        StoredBatchInfo calldata,

128: 		        StoredBatchInfo calldata,

146: 		    function revertBatches(uint256) external onlyValidator(ERA_CHAIN_ID) {

153: 		    function revertBatchesSharedBridge(uint256 _chainId, uint256) external onlyValidator(_chainId) {

161: 		        StoredBatchInfo calldata,

162: 		        StoredBatchInfo[] calldata,

163: 		        ProofInput calldata

173: 		        StoredBatchInfo calldata,

174: 		        StoredBatchInfo[] calldata,

175: 		        ProofInput calldata
```
[[109](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L109), [128](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L128), [146](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L146), [153](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L153), [161](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L161), [162](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L162), [163](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L163), [173](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L173), [174](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L174), [175](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L175)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

338: 		        uint256,

477: 		    function revertBatchesSharedBridge(uint256, uint256 _newLastBatch) external nonReentrant onlyValidator {
```
[[338](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L338), [477](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L477)]


---

### [N-83] Contracts should have full test coverage

A 100% test coverage is not foolproof, but it helps immensely in reducing the amount of bugs that may occur.



---

### [N-84] Large or complicated code bases should implement invariant tests

This includes: large code bases, or code with lots of inline-assembly, complicated math, or complicated interactions between multiple contracts.

Invariant fuzzers such as Echidna require the test writer to come up with invariants which should not be violated under any circumstances, and the fuzzer tests various inputs and function calls to ensure that the invariants always hold.

Even code with 100% code coverage can still have bugs due to the order of the operations a user performs, and invariant fuzzers may help significantly.



---

### [N-85] Codebase should implement formal verification testing

Formal verification is the act of proving or disproving the correctness of intended algorithms underlying a system with respect to a certain formal specification/property/invariant, using formal methods of mathematics.

Some tools that are currently available to perform these tests on smart contracts are [SMTChecker](https://docs.soliditylang.org/en/latest/smtchecker.html) and [Certora Prover](https://www.certora.com/).



---

### [N-86] State variables should include comments

Consider adding some comments on critical state variables to explain what they are supposed to do: this will help for future code reviews.

*There are 8 instances of this issue.*

<details>
<summary>Expand findings</summary>


```solidity
File: code/system-contracts/contracts/AccountCodeStorage.sol

23: 		    bytes32 constant EMPTY_STRING_KECCAK = 0xc5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470;
```
[[23](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L23)]



```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

84: 		    bytes32 constant EIP712_TRANSACTION_TYPE_HASH =
85: 		        keccak256(
86: 		            "Transaction(uint256 txType,uint256 from,uint256 to,uint256 gasLimit,uint256 gasPerPubdataByteLimit,uint256 maxFeePerGas,uint256 maxPriorityFeePerGas,uint256 paymaster,uint256 nonce,uint256 value,bytes data,bytes32[] factoryDeps,bytes paymasterInput)"
87: 		        );
```
[[84-87](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L84-L87)]



```solidity
File: code/contracts/ethereum/contracts/common/ReentrancyGuard.sol

39: 		    uint256 private constant _ENTERED = 2;
```
[[39](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/ReentrancyGuard.sol#L39)]



```solidity
File: code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol

22: 		    uint160 constant offset = uint160(0x1111000000000000000000000000000000001111);
```
[[22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol#L22)]



```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

37: 		    address private l1LegacyBridge;
```
[[37](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L37)]



```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

26: 		    ERC20Getters private availableGetters;
```
[[26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L26)]



```solidity
File: code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol

22: 		    uint160 constant offset = uint160(0x1111000000000000000000000000000000001111);
```
[[22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol#L22)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol

12: 		    ZkSyncStateTransitionStorage internal s;
```
[[12](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L12)]

</details>

---

### [N-87] Complex functions should have explicit comments

Large and/or complex functions should have more comments to better explain the purpose of each logic step.

*There are 9 instances of this issue.*

<details>
<summary>Expand findings</summary>


```solidity
File: code/system-contracts/contracts/BootloaderUtilities.sol

44: 		    function encodeLegacyTransactionHash(Transaction calldata _transaction) internal view returns (bytes32 txHash) {

139: 		    function encodeEIP2930TransactionHash(Transaction calldata _transaction) internal view returns (bytes32) {

229: 		    function encodeEIP1559TransactionHash(Transaction calldata _transaction) internal view returns (bytes32) {
```
[[44](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L44), [139](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L139), [229](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L229)]



```solidity
File: code/system-contracts/contracts/Compressor.sol

110: 		    function verifyCompressedStateDiffs(
```
[[110](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L110)]



```solidity
File: code/system-contracts/contracts/L1Messenger.sol

194: 		    function publishPubdataAndClearState(
```
[[194](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L194)]



```solidity
File: code/contracts/zksync/contracts/SystemContractsCaller.sol

37: 		    function systemCall(uint32 gasLimit, address to, uint256 value, bytes memory data) internal returns (bool success) {
```
[[37](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/SystemContractsCaller.sol#L37)]



```solidity
File: code/system-contracts/contracts/libraries/SystemContractsCaller.sol

76: 		    function systemCall(uint32 gasLimit, address to, uint256 value, bytes memory data) internal returns (bool success) {
```
[[76](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L76)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

225: 		    function _propagateToZkSyncStateTransition(uint256 _chainId) internal {
```
[[225](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L225)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol

20: 		    fallback() external payable {
```
[[20](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol#L20)]

</details>

---

### [N-88] Assembly code should have explicit comments

Low-level languages like assembly should require extensive documentation and comments to clarify the purpose of each instruction.

*There are 48 instances of this issue.*

<details>
<summary>Expand findings</summary>


```solidity
File: code/system-contracts/contracts/AccountCodeStorage.sol

70: 		        assembly {

81: 		        assembly {
```
[[70](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L70), [81](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L81)]



```solidity
File: code/system-contracts/contracts/ComplexUpgrader.sol

26: 		        assembly {
```
[[26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ComplexUpgrader.sol#L26)]



```solidity
File: code/system-contracts/contracts/GasBoundCaller.sol

79: 		        assembly {
```
[[79](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/GasBoundCaller.sol#L79)]



```solidity
File: code/system-contracts/contracts/KnownCodesStorage.sol

66: 		        assembly {
```
[[66](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/KnownCodesStorage.sol#L66)]



```solidity
File: code/system-contracts/contracts/PubdataChunkPublisher.sol

46: 		            assembly {
```
[[46](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/PubdataChunkPublisher.sol#L46)]



```solidity
File: code/contracts/zksync/contracts/SystemContractsCaller.sol

41: 		        assembly {

85: 		        assembly {

90: 		        assembly {
```
[[41](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/SystemContractsCaller.sol#L41), [85](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/SystemContractsCaller.sol#L85), [90](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/SystemContractsCaller.sol#L90)]



```solidity
File: code/system-contracts/contracts/libraries/EfficientCall.sol

135: 		            assembly {

163: 		        assembly {

177: 		        assembly {

203: 		        assembly {

218: 		            assembly {

223: 		            assembly {

254: 		        assembly {
```
[[135](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L135), [163](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L163), [177](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L177), [203](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L203), [218](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L218), [223](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L223), [254](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L254)]



```solidity
File: code/system-contracts/contracts/libraries/RLPEncoder.sol

16: 		        assembly {

39: 		                assembly {

74: 		                assembly {
```
[[16](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/RLPEncoder.sol#L16), [39](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/RLPEncoder.sol#L39), [74](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/RLPEncoder.sol#L74)]



```solidity
File: code/system-contracts/contracts/libraries/SystemContractHelper.sol

50: 		        assembly {

65: 		        assembly {

97: 		        assembly {

109: 		        assembly {

158: 		        assembly {

171: 		        assembly {

183: 		        assembly {

193: 		        assembly {

205: 		        assembly {

298: 		        assembly {

309: 		        assembly {

322: 		        assembly {
```
[[50](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L50), [65](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L65), [97](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L97), [109](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L109), [158](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L158), [171](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L171), [183](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L183), [193](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L193), [205](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L205), [298](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L298), [309](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L309), [322](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L322)]



```solidity
File: code/system-contracts/contracts/libraries/SystemContractsCaller.sol

80: 		        assembly {

132: 		        assembly {

137: 		        assembly {

160: 		            assembly {
```
[[80](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L80), [132](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L132), [137](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L137), [160](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L160)]



```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

399: 		        assembly {
```
[[399](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L399)]



```solidity
File: code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol

20: 		        assembly {

27: 		        assembly {

34: 		        assembly {

41: 		        assembly {

47: 		        assembly {
```
[[20](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol#L20), [27](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol#L27), [34](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol#L34), [41](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol#L41), [47](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol#L47)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

227: 		        assembly {
```
[[227](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L227)]



```solidity
File: code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol

20: 		        assembly {

27: 		        assembly {

34: 		        assembly {

41: 		        assembly {
```
[[20](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol#L20), [27](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol#L27), [34](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol#L34), [41](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol#L41)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol

89: 		        assembly {
```
[[89](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L89)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol

41: 		        assembly {
```
[[41](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol#L41)]

</details>

---

### [N-89] Use `@inheritdoc` for overridden functions

`@inheritdoc` Copies all missing tags from the base function. [Documentation](https://docs.soliditylang.org/en/latest/natspec-format.html#tags)

*There are 54 instances of this issue.*

<details>
<summary>Expand findings</summary>


```solidity
File: code/system-contracts/contracts/AccountCodeStorage.sol

35: 		    function storeAccountConstructingCodeHash(address _address, bytes32 _hash) external override onlyDeployer {

46: 		    function storeAccountConstructedCodeHash(address _address, bytes32 _hash) external override onlyDeployer {

54: 		    function markAccountCodeHashAsConstructed(address _address) external override onlyDeployer {

78: 		    function getRawCodeHash(address _address) public view override returns (bytes32 codeHash) {

89: 		    function getCodeHash(uint256 _input) external view override returns (bytes32) {

117: 		    function getCodeSize(uint256 _input) external view override returns (uint256 codeSize) {
```
[[35](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L35), [46](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L46), [54](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L54), [78](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L78), [89](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L89), [117](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L117)]



```solidity
File: code/system-contracts/contracts/BootloaderUtilities.sol

24: 		    function getTransactionHashes(
```
[[24](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L24)]



```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

95: 		    function getNewAddressCreate2(

115: 		    function getNewAddressCreate(

132: 		    function create2(

147: 		    function create(

162: 		    function create2Account(

182: 		    function createAccount(
```
[[95](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L95), [115](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L115), [132](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L132), [147](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L147), [162](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L162), [182](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L182)]



```solidity
File: code/system-contracts/contracts/DefaultAccount.sol

67: 		    function validateTransaction(

112: 		    function executeTransaction(

125: 		    function executeTransactionFromOutside(Transaction calldata _transaction) external payable override {
```
[[67](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L67), [112](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L112), [125](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L125)]



```solidity
File: code/system-contracts/contracts/ImmutableSimulator.sol

27: 		    function getImmutable(address _dest, uint256 _index) external view override returns (bytes32) {

34: 		    function setImmutables(address _dest, ImmutableData[] calldata _immutables) external override {
```
[[27](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ImmutableSimulator.sol#L27), [34](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ImmutableSimulator.sol#L34)]



```solidity
File: code/system-contracts/contracts/KnownCodesStorage.sol

65: 		    function getMarker(bytes32 _hash) public view override returns (uint256 marker) {
```
[[65](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/KnownCodesStorage.sol#L65)]



```solidity
File: code/system-contracts/contracts/L1Messenger.sol

116: 		    function sendToL1(bytes calldata _message) external override returns (bytes32 hash) {

161: 		    function requestBytecodeL1Publication(
```
[[116](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L116), [161](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L161)]



```solidity
File: code/system-contracts/contracts/L2BaseToken.sol

32: 		    function transferFromTo(address _from, address _to, uint256 _amount) external override {

56: 		    function balanceOf(uint256 _account) external view override returns (uint256) {

64: 		    function mint(address _account, uint256 _amount) external override onlyCallFromBootloader {

72: 		    function withdraw(address _l1Receiver) external payable override {

85: 		    function withdrawWithMessage(address _l1Receiver, bytes memory _additionalData) external payable override {

128: 		    function name() external pure override returns (string memory) {

134: 		    function symbol() external pure override returns (string memory) {

140: 		    function decimals() external pure override returns (uint8) {
```
[[32](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L2BaseToken.sol#L32), [56](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L2BaseToken.sol#L56), [64](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L2BaseToken.sol#L64), [72](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L2BaseToken.sol#L72), [85](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L2BaseToken.sol#L85), [128](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L2BaseToken.sol#L128), [134](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L2BaseToken.sol#L134), [140](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L2BaseToken.sol#L140)]



```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

182: 		    function bridgehubDeposit(

232: 		    function bridgehubConfirmL2Transaction(

277: 		    function claimFailedDeposit(

385: 		    function finalizeWithdrawal(

554: 		    function depositLegacyErc20Bridge(

615: 		    function finalizeWithdrawalLegacyErc20Bridge(

644: 		    function claimFailedDepositLegacyErc20Bridge(
```
[[182](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L182), [232](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L232), [277](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L277), [385](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L385), [554](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L554), [615](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L615), [644](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L644)]



```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

152: 		    function proveL2MessageInclusion(

164: 		    function proveL2LogInclusion(

176: 		    function proveL1ToL2TransactionStatus(

217: 		    function requestL2TransactionDirect(

262: 		    function requestL2TransactionTwoBridges(
```
[[152](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L152), [164](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L164), [176](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L176), [217](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L217), [262](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L262)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

74: 		    function getChainAdmin(uint256 _chainId) external view override returns (address) {
```
[[74](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L74)]



```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol

20: 		    function _setNewProtocolVersion(uint256 _newProtocolVersion) internal override {

47: 		    function upgrade(ProposedUpgrade calldata _proposedUpgrade) public virtual override returns (bytes32) {
```
[[20](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L20), [47](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L47)]



```solidity
File: code/contracts/ethereum/contracts/upgrades/DefaultUpgrade.sol

13: 		    function upgrade(ProposedUpgrade calldata _proposedUpgrade) public override returns (bytes32) {
```
[[13](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/DefaultUpgrade.sol#L13)]



```solidity
File: code/contracts/ethereum/contracts/upgrades/GenesisUpgrade.sol

14: 		    function upgrade(ProposedUpgrade calldata _proposedUpgrade) public override returns (bytes32) {
```
[[14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/GenesisUpgrade.sol#L14)]



```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

79: 		    function finalizeDeposit(

123: 		    function withdraw(address _l1Receiver, address _l2Token, uint256 _amount) external override {

149: 		    function l2TokenAddress(address _l1Token) public view override returns (address) {
```
[[79](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L79), [123](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L123), [149](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L149)]



```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

145: 		    function bridgeMint(address _to, uint256 _amount) external override onlyBridge {

154: 		    function bridgeBurn(address _from, uint256 _amount) external override onlyBridge {

159: 		    function name() public view override returns (string memory) {

165: 		    function symbol() public view override returns (string memory) {

171: 		    function decimals() public view override returns (uint8) {
```
[[145](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L145), [154](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L154), [159](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L159), [165](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L165), [171](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L171)]

</details>

---

### [N-90] Some functions don't follow the Solidity naming convention

Functions should use mixedCase. Examples: `getBalance, transfer, verifyOwner, addMember, changeOwner`. [Documentation] (https://docs.soliditylang.org/en/latest/style-guide.html#function-names)

*There is 1 instance of this issue.*


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

130: 		    function _L2MessageToLog(L2Message memory _message) internal pure returns (L2Log memory) {
```
[[130](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L130)]


---

### [N-91] Variable names don't follow the Solidity naming convention

Use `mixedCase` for local and state variables that are not constants, and add a trailing underscore for non-external variables. [Documentation](https://docs.soliditylang.org/en/latest/style-guide.html#local-and-state-variable-names)

*There are 3 instances of this issue.*


```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

// @audit __DEPRECATED_lastWithdrawalLimitReset
45: 		    mapping(address => uint256) private __DEPRECATED_lastWithdrawalLimitReset;

// @audit __DEPRECATED_withdrawnAmountInWindow
48: 		    mapping(address => uint256) private __DEPRECATED_withdrawnAmountInWindow;

// @audit __DEPRECATED_totalDepositedAmountPerUser
51: 		    mapping(address => mapping(address => uint256)) private __DEPRECATED_totalDepositedAmountPerUser;
```
[[45](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L45), [48](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L48), [51](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L51)]


---

### [N-92] Constant names should be uppercase

Constants should be named with all capital letters with underscores separating words. Examples: `MAX_BLOCKS`, `TOKEN_NAME`. [Documentation](https://docs.soliditylang.org/en/latest/style-guide.html#constants)

*There are 7 instances of this issue.*

<details>
<summary>Expand findings</summary>


```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

26: 		    string public constant override getName = "ValidatorTimelock";
```
[[26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L26)]



```solidity
File: code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol

22: 		    uint160 constant offset = uint160(0x1111000000000000000000000000000000001111);
```
[[22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol#L22)]



```solidity
File: code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol

22: 		    uint160 constant offset = uint160(0x1111000000000000000000000000000000001111);
```
[[22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol#L22)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol

20: 		    string public constant override getName = "AdminFacet";
```
[[20](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L20)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

27: 		    string public constant override getName = "ExecutorFacet";
```
[[27](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L27)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol

25: 		    string public constant override getName = "GettersFacet";
```
[[25](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L25)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

35: 		    string public constant override getName = "MailboxFacet";
```
[[35](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L35)]

</details>

---

### [N-93] `immutable` variable names should be uppercase

`immutable` variables should be named with all capital letters with underscores separating words. Examples: `TOKEN_ADDRESS`, `ROOT`. [Documentation](https://docs.soliditylang.org/en/latest/style-guide.html#constants)

*There are 5 instances of this issue.*


```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

23: 		    IL1SharedBridge public immutable override sharedBridge;
```
[[23](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L23)]



```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

34: 		    address public immutable override l1WethAddress;

37: 		    IBridgehub public immutable override bridgehub;

40: 		    IL1ERC20Bridge public immutable override legacyBridge;
```
[[34](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L34), [37](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L37), [40](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L40)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

27: 		    address public immutable bridgehub;
```
[[27](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L27)]


---

### [N-94] Missing underscore prefix for non-external functions

This convention is suggested for non-external functions (private or internal). [Documentation](https://docs.soliditylang.org/en/latest/style-guide.html#underscore-prefix-for-non-external-functions-and-variables)

*There are 109 instances of this issue.*

<details>
<summary>Expand findings</summary>


```solidity
File: code/system-contracts/contracts/BootloaderUtilities.sol

44: 		    function encodeLegacyTransactionHash(Transaction calldata _transaction) internal view returns (bytes32 txHash) {

139: 		    function encodeEIP2930TransactionHash(Transaction calldata _transaction) internal view returns (bytes32) {

229: 		    function encodeEIP1559TransactionHash(Transaction calldata _transaction) internal view returns (bytes32) {
```
[[44](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L44), [139](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L139), [229](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L229)]



```solidity
File: code/system-contracts/contracts/L1Messenger.sol

50: 		    function keccakGasCost(uint256 _length) internal pure returns (uint256) {

61: 		    function sha256GasCost(uint256 _length) internal pure returns (uint256) {
```
[[50](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L50), [61](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L61)]



```solidity
File: code/contracts/zksync/contracts/L2ContractHelper.sol

90: 		    function sendMessageToL1(bytes memory _message) internal returns (bytes32) {

101: 		    function computeCreate2Address(
```
[[90](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/L2ContractHelper.sol#L90), [101](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/L2ContractHelper.sol#L101)]



```solidity
File: code/contracts/zksync/contracts/SystemContractsCaller.sol

27: 		    function safeCastToU32(uint256 _x) internal pure returns (uint32) {

37: 		    function systemCall(uint32 gasLimit, address to, uint256 value, bytes memory data) internal returns (bool success) {

76: 		    function systemCallWithReturndata(

95: 		    function getFarCallABI(

121: 		    function getFarCallABIWithEmptyFatPointer(
```
[[27](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/SystemContractsCaller.sol#L27), [37](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/SystemContractsCaller.sol#L37), [76](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/SystemContractsCaller.sol#L76), [95](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/SystemContractsCaller.sol#L95), [121](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/SystemContractsCaller.sol#L121)]



```solidity
File: code/system-contracts/contracts/libraries/EfficientCall.sol

36: 		    function keccak(bytes calldata _data) internal view returns (bytes32) {

45: 		    function sha(bytes calldata _data) internal view returns (bytes32) {

58: 		    function call(

74: 		    function staticCall(

88: 		    function delegateCall(

105: 		    function mimicCall(

124: 		    function rawCall(

159: 		    function rawStaticCall(uint256 _gas, address _address, bytes calldata _data) internal view returns (bool success) {

173: 		    function rawDelegateCall(uint256 _gas, address _address, bytes calldata _data) internal returns (bool success) {

191: 		    function rawMimicCall(

232: 		    function propagateRevert() internal pure {
```
[[36](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L36), [45](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L45), [58](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L58), [74](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L74), [88](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L88), [105](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L105), [124](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L124), [159](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L159), [173](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L173), [191](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L191), [232](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L232)]



```solidity
File: code/system-contracts/contracts/libraries/RLPEncoder.sol

11: 		    function encodeAddress(address _val) internal pure returns (bytes memory encoded) {

24: 		    function encodeUint256(uint256 _val) internal pure returns (bytes memory encoded) {

49: 		    function encodeNonSingleBytesLen(uint64 _len) internal pure returns (bytes memory) {

56: 		    function encodeListLen(uint64 _len) internal pure returns (bytes memory) {
```
[[11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/RLPEncoder.sol#L11), [24](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/RLPEncoder.sol#L24), [49](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/RLPEncoder.sol#L49), [56](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/RLPEncoder.sol#L56)]



```solidity
File: code/system-contracts/contracts/libraries/SystemContractHelper.sol

48: 		    function toL1(bool _isService, bytes32 _key, bytes32 _value) internal {

63: 		    function getCodeAddress() internal view returns (address addr) {

74: 		    function loadCalldataIntoActivePtr() internal view {

85: 		    function ptrPackIntoActivePtr(uint256 _farCallAbi) internal view {

94: 		    function ptrAddIntoActive(uint32 _value) internal view {

106: 		    function ptrShrinkIntoActive(uint32 _shrink) internal view {

124: 		    function packPrecompileParams(

148: 		    function unsafePrecompileCall(

168: 		    function setValueForNextFarCall(uint128 _value) internal returns (bool success) {

181: 		    function eventInitialize(uint256 initializer, uint256 value1) internal {

191: 		    function eventWrite(uint256 value1, uint256 value2) internal {

203: 		    function getZkSyncMetaBytes() internal view returns (uint256 meta) {

215: 		    function extractNumberFromMeta(uint256 meta, uint256 offset, uint256 size) internal pure returns (uint256 result) {

227: 		    function getPubdataPublishedFromMeta(uint256 meta) internal pure returns (uint32 pubdataPublished) {

237: 		    function getHeapSizeFromMeta(uint256 meta) internal pure returns (uint32 heapSize) {

246: 		    function getAuxHeapSizeFromMeta(uint256 meta) internal pure returns (uint32 auxHeapSize) {

254: 		    function getShardIdFromMeta(uint256 meta) internal pure returns (uint8 shardId) {

263: 		    function getCallerShardIdFromMeta(uint256 meta) internal pure returns (uint8 callerShardId) {

272: 		    function getCodeShardIdFromMeta(uint256 meta) internal pure returns (uint8 codeShardId) {

279: 		    function getZkSyncMeta() internal view returns (ZkSyncMeta memory meta) {

296: 		    function getCallFlags() internal view returns (uint256 callFlags) {

307: 		    function getCalldataPtr() internal view returns (uint256 ptr) {

318: 		    function getExtraAbiData(uint256 index) internal view returns (uint256 extraAbiData) {

329: 		    function isSystemCall() internal view returns (bool) {

338: 		    function isSystemContract(address _address) internal pure returns (bool) {

344: 		    function burnGas(uint32 _gasToPay, uint32 _pubdataToSpend) internal view {
```
[[48](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L48), [63](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L63), [74](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L74), [85](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L85), [94](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L94), [106](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L106), [124](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L124), [148](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L148), [168](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L168), [181](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L181), [191](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L191), [203](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L203), [215](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L215), [227](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L227), [237](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L237), [246](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L246), [254](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L254), [263](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L263), [272](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L272), [279](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L279), [296](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L296), [307](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L307), [318](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L318), [329](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L329), [338](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L338), [344](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L344)]



```solidity
File: code/system-contracts/contracts/libraries/SystemContractsCaller.sol

76: 		    function systemCall(uint32 gasLimit, address to, uint256 value, bytes memory data) internal returns (bool success) {

123: 		    function systemCallWithReturndata(

150: 		    function systemCallWithPropagatedRevert(

214: 		    function getFarCallABI(

250: 		    function getFarCallABIWithEmptyFatPointer(
```
[[76](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L76), [123](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L123), [150](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L150), [214](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L214), [250](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L250)]



```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

94: 		    function isEthToken(uint256 _addr) internal pure returns (bool) {

100: 		    function encodeHash(Transaction calldata _transaction) internal view returns (bytes32 resultHash) {

362: 		    function processPaymasterInput(Transaction calldata _transaction) internal {

395: 		    function payToTheBootloader(Transaction calldata _transaction) internal returns (bool success) {

405: 		    function totalRequiredBalance(Transaction calldata _transaction) internal pure returns (uint256 requiredBalance) {
```
[[94](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L94), [100](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L100), [362](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L362), [395](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L395), [405](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L405)]



```solidity
File: code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol

19: 		    function readUint16(bytes calldata _bytes, uint256 _start) internal pure returns (uint16 result) {

26: 		    function readUint32(bytes calldata _bytes, uint256 _start) internal pure returns (uint32 result) {

33: 		    function readUint64(bytes calldata _bytes, uint256 _start) internal pure returns (uint64 result) {

40: 		    function readBytes32(bytes calldata _bytes, uint256 _start) internal pure returns (bytes32 result) {

46: 		    function readUint256(bytes calldata _bytes, uint256 _start) internal pure returns (uint256 result) {
```
[[19](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol#L19), [26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol#L26), [33](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol#L33), [40](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol#L40), [46](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol#L46)]



```solidity
File: code/system-contracts/contracts/libraries/Utils.sol

20: 		    function safeCastToU128(uint256 _x) internal pure returns (uint128) {

26: 		    function safeCastToU32(uint256 _x) internal pure returns (uint32) {

32: 		    function safeCastToU24(uint256 _x) internal pure returns (uint24) {

39: 		    function bytecodeLenInBytes(bytes32 _bytecodeHash) internal pure returns (uint256 codeLength) {

44: 		    function bytecodeLenInWords(bytes32 _bytecodeHash) internal pure returns (uint256 codeLengthInWords) {

51: 		    function isContractConstructed(bytes32 _bytecodeHash) internal pure returns (bool) {

56: 		    function isContractConstructing(bytes32 _bytecodeHash) internal pure returns (bool) {

63: 		    function constructingBytecodeHash(bytes32 _bytecodeHash) internal pure returns (bytes32) {

71: 		    function constructedBytecodeHash(bytes32 _bytecodeHash) internal pure returns (bytes32) {

82: 		    function hashL2Bytecode(bytes calldata _bytecode) internal view returns (bytes32 hashedBytecode) {
```
[[20](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L20), [26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L26), [32](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L32), [39](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L39), [44](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L44), [51](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L51), [56](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L56), [63](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L63), [71](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L71), [82](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L82)]



```solidity
File: code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol

28: 		    function applyL1ToL2Alias(address l1Address) internal pure returns (address l2Address) {

38: 		    function undoL1ToL2Alias(address l2Address) internal pure returns (address l1Address) {
```
[[28](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol#L28), [38](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol#L38)]



```solidity
File: code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol

28: 		    function applyL1ToL2Alias(address l1Address) internal pure returns (address l2Address) {

38: 		    function undoL1ToL2Alias(address l2Address) internal pure returns (address l1Address) {
```
[[28](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol#L28), [38](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol#L38)]



```solidity
File: code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol

21: 		    function hashL2Bytecode(bytes memory _bytecode) internal pure returns (bytes32 hashedBytecode) {

39: 		    function validateBytecodeHash(bytes32 _bytecodeHash) internal pure {

49: 		    function bytecodeLen(bytes32 _bytecodeHash) internal pure returns (uint256 codeLengthInWords) {

60: 		    function computeCreate2Address(
```
[[21](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L21), [39](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L39), [49](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L49), [60](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L60)]



```solidity
File: code/contracts/ethereum/contracts/common/libraries/UncheckedMath.sol

11: 		    function uncheckedInc(uint256 _number) internal pure returns (uint256) {

17: 		    function uncheckedAdd(uint256 _lhs, uint256 _rhs) internal pure returns (uint256) {
```
[[11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/UncheckedMath.sol#L11), [17](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/UncheckedMath.sol#L17)]



```solidity
File: code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol

19: 		    function readUint32(bytes memory _bytes, uint256 _start) internal pure returns (uint32 result, uint256 offset) {

26: 		    function readAddress(bytes memory _bytes, uint256 _start) internal pure returns (address result, uint256 offset) {

33: 		    function readUint256(bytes memory _bytes, uint256 _start) internal pure returns (uint256 result, uint256 offset) {

40: 		    function readBytes32(bytes memory _bytes, uint256 _start) internal pure returns (bytes32 result, uint256 offset) {
```
[[19](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol#L19), [26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol#L26), [33](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol#L33), [40](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol#L40)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol

87: 		    function getDiamondStorage() internal pure returns (DiamondStorage storage diamondStorage) {

96: 		    function diamondCut(DiamondCutData memory _diamondCut) internal {
```
[[87](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L87), [96](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L96)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/LibMap.sol

18: 		    function get(Uint32Map storage _map, uint256 _index) internal view returns (uint32 result) {

38: 		    function set(Uint32Map storage _map, uint256 _index, uint32 _value) internal {
```
[[18](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/LibMap.sol#L18), [38](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/LibMap.sol#L38)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol

18: 		    function calculateRoot(
```
[[18](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol#L18)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol

35: 		    function getFirstUnprocessedPriorityTx(Queue storage _queue) internal view returns (uint256) {

40: 		    function getTotalPriorityTxs(Queue storage _queue) internal view returns (uint256) {

45: 		    function getSize(Queue storage _queue) internal view returns (uint256) {

50: 		    function isEmpty(Queue storage _queue) internal view returns (bool) {

55: 		    function pushBack(Queue storage _queue, PriorityOperation memory _operation) internal {

64: 		    function front(Queue storage _queue) internal view returns (PriorityOperation memory) {

72: 		    function popFront(Queue storage _queue) internal returns (PriorityOperation memory priorityOperation) {
```
[[35](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L35), [40](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L40), [45](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L45), [50](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L50), [55](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L55), [64](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L64), [72](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L72)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol

19: 		    function validateL1ToL2Transaction(

46: 		    function validateUpgradeTransaction(L2CanonicalTransaction memory _transaction) internal pure {

69: 		    function getMinimalPriorityTransactionGasLimit(

109: 		    function getTransactionBodyGasLimit(

128: 		    function getOverheadForTransaction(
```
[[19](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L19), [46](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L46), [69](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L69), [109](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L109), [128](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L128)]

</details>

---

### [N-95] Missing underscore prefix for non-external variables

This convention is suggested for non-external state variables (private or internal). [Documentation](https://docs.soliditylang.org/en/latest/style-guide.html#underscore-prefix-for-non-external-functions-and-variables)

*There are 28 instances of this issue.*

<details>
<summary>Expand findings</summary>


```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

26: 		    mapping(address => AccountInfo) internal accountInfo;
```
[[26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L26)]



```solidity
File: code/system-contracts/contracts/ImmutableSimulator.sol

21: 		    mapping(uint256 contractAddress => mapping(uint256 index => bytes32 value)) internal immutableDataStorage;
```
[[21](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ImmutableSimulator.sol#L21)]



```solidity
File: code/system-contracts/contracts/L1Messenger.sol

28: 		    bytes32 internal chainedLogsHash;

32: 		    uint256 internal numberOfLogsToProcess;

36: 		    bytes32 internal chainedMessagesHash;

41: 		    bytes32 internal chainedL1BytecodesRevealDataHash;
```
[[28](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L28), [32](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L32), [36](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L36), [41](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L41)]



```solidity
File: code/system-contracts/contracts/L2BaseToken.sol

20: 		    mapping(address account => uint256 balance) internal balance;
```
[[20](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L2BaseToken.sol#L20)]



```solidity
File: code/system-contracts/contracts/NonceHolder.sol

36: 		    mapping(uint256 account => uint256 packedMinAndDeploymentNonce) internal rawNonces;

41: 		    mapping(uint256 account => mapping(uint256 nonceKey => uint256 value)) internal nonceValues;
```
[[36](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/NonceHolder.sol#L36), [41](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/NonceHolder.sol#L41)]



```solidity
File: code/system-contracts/contracts/SystemContext.sol

51: 		    BlockInfo internal currentBatchInfo;

55: 		    mapping(uint256 batchNumber => bytes32 batchHash) internal batchHashes;

58: 		    BlockInfo internal currentL2BlockInfo;

61: 		    bytes32 internal currentL2BlockTxsRollingHash;

70: 		    bytes32[MINIBLOCK_HASHES_TO_STORE] internal l2BlockHash;

77: 		    BlockInfo internal currentVirtualL2BlockInfo;

80: 		    VirtualBlockUpgradeInfo internal virtualBlockUpgradeInfo;

95: 		    uint256 internal basePubdataSpent;
```
[[51](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L51), [55](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L55), [58](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L58), [61](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L61), [70](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L70), [77](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L77), [80](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L80), [95](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L95)]



```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

45: 		    uint256 internal eraFirstPostUpgradeBatch;

61: 		    mapping(uint256 chainId => bool enabled) internal hyperbridgingEnabled;

65: 		    mapping(uint256 chainId => mapping(address l1Token => uint256 balance)) internal chainBalance;
```
[[45](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L45), [61](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L61), [65](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L65)]



```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

35: 		    address private pendingAdmin;
```
[[35](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L35)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

54: 		    address private pendingAdmin;
```
[[54](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L54)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

47: 		    mapping(uint256 => LibMap.Uint32Map) internal committedBatchTimestamp;
```
[[47](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L47)]



```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

32: 		    bytes32 internal l2TokenProxyBytecodeHash;

37: 		    address private l1LegacyBridge;
```
[[32](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L32), [37](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L37)]



```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

26: 		    ERC20Getters private availableGetters;

31: 		    uint8 private decimals_;
```
[[26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L26), [31](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L31)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol

12: 		    ZkSyncStateTransitionStorage internal s;
```
[[12](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L12)]

</details>

---

### [N-96] Missing NatSpec from contract declarations

Some contracts miss a `@dev/@notice` NatSpec, which should be a [best practice](https://docs.soliditylang.org/en/latest/natspec-format.html) to add as a documentation.

*There are 22 instances of this issue.*

<details>
<summary>Expand findings</summary>


```solidity
File: code/contracts/zksync/contracts/SystemContractsCaller.sol

26: 		library Utils {
```
[[26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/SystemContractsCaller.sol#L26)]



```solidity
File: code/system-contracts/contracts/interfaces/IAccount.sol

9: 		interface IAccount {
```
[[9](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IAccount.sol#L9)]



```solidity
File: code/system-contracts/contracts/interfaces/IAccountCodeStorage.sol

5: 		interface IAccountCodeStorage {
```
[[5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IAccountCodeStorage.sol#L5)]



```solidity
File: code/system-contracts/contracts/interfaces/IBaseToken.sol

5: 		interface IBaseToken {
```
[[5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBaseToken.sol#L5)]



```solidity
File: code/system-contracts/contracts/interfaces/IBootloaderUtilities.sol

7: 		interface IBootloaderUtilities {
```
[[7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBootloaderUtilities.sol#L7)]



```solidity
File: code/system-contracts/contracts/interfaces/IContractDeployer.sol

5: 		interface IContractDeployer {
```
[[5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L5)]



```solidity
File: code/system-contracts/contracts/interfaces/IImmutableSimulator.sol

10: 		interface IImmutableSimulator {
```
[[10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IImmutableSimulator.sol#L10)]



```solidity
File: code/system-contracts/contracts/interfaces/IL2StandardToken.sol

5: 		interface IL2StandardToken {
```
[[5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL2StandardToken.sol#L5)]



```solidity
File: code/system-contracts/contracts/interfaces/IMailbox.sol

5: 		interface IMailbox {
```
[[5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IMailbox.sol#L5)]



```solidity
File: code/system-contracts/contracts/interfaces/IPaymaster.sol

14: 		interface IPaymaster {
```
[[14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IPaymaster.sol#L14)]



```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

16: 		contract Bridgehub is IBridgehub, ReentrancyGuard, Ownable2Step {
```
[[16](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L16)]



```solidity
File: code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol

42: 		interface IBridgehub {
```
[[42](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L42)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol

26: 		interface IStateTransitionManager {
```
[[26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L26)]



```solidity
File: code/contracts/ethereum/contracts/upgrades/IDefaultUpgrade.sol

7: 		interface IDefaultUpgrade {
```
[[7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/IDefaultUpgrade.sol#L7)]



```solidity
File: code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol

21: 		library AddressAliasHelper {
```
[[21](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol#L21)]



```solidity
File: code/contracts/zksync/contracts/interfaces/IPaymaster.sol

14: 		interface IPaymaster {
```
[[14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/interfaces/IPaymaster.sol#L14)]



```solidity
File: code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol

21: 		library AddressAliasHelper {
```
[[21](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol#L21)]



```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IWETH9.sol

4: 		interface IWETH9 {
```
[[4](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IWETH9.sol#L4)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol

61: 		interface IDiamondInit {
```
[[61](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol#L61)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol

15: 		interface IZkSyncStateTransition is IAdmin, IExecutor, IGetters, IMailbox {
```
[[15](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol#L15)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/l2-deps/ISystemContext.sol

4: 		interface ISystemContext {
```
[[4](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/l2-deps/ISystemContext.sol#L4)]



```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol

5: 		interface IL2StandardToken {
```
[[5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol#L5)]

</details>

---

### [N-97] Missing NatSpec `@author` from contract declaration

Some contract definitions have an incomplete NatSpec: add a `@author` notation to improve the code documentation.

*There are 25 instances of this issue.*

<details>
<summary>Expand findings</summary>


```solidity
File: code/contracts/zksync/contracts/ForceDeployUpgrader.sol

10: 		contract ForceDeployUpgrader {
```
[[10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/ForceDeployUpgrader.sol#L10)]



```solidity
File: code/contracts/zksync/contracts/SystemContractsCaller.sol

26: 		library Utils {

36: 		library SystemContractsCaller {
```
[[26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/SystemContractsCaller.sol#L26), [36](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/SystemContractsCaller.sol#L36)]



```solidity
File: code/system-contracts/contracts/interfaces/IAccount.sol

9: 		interface IAccount {
```
[[9](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IAccount.sol#L9)]



```solidity
File: code/system-contracts/contracts/interfaces/IAccountCodeStorage.sol

5: 		interface IAccountCodeStorage {
```
[[5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IAccountCodeStorage.sol#L5)]



```solidity
File: code/system-contracts/contracts/interfaces/IBaseToken.sol

5: 		interface IBaseToken {
```
[[5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBaseToken.sol#L5)]



```solidity
File: code/system-contracts/contracts/interfaces/IBootloaderUtilities.sol

7: 		interface IBootloaderUtilities {
```
[[7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBootloaderUtilities.sol#L7)]



```solidity
File: code/system-contracts/contracts/interfaces/IContractDeployer.sol

5: 		interface IContractDeployer {
```
[[5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L5)]



```solidity
File: code/system-contracts/contracts/interfaces/IImmutableSimulator.sol

10: 		interface IImmutableSimulator {
```
[[10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IImmutableSimulator.sol#L10)]



```solidity
File: code/system-contracts/contracts/interfaces/IL2StandardToken.sol

5: 		interface IL2StandardToken {
```
[[5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL2StandardToken.sol#L5)]



```solidity
File: code/system-contracts/contracts/interfaces/IMailbox.sol

5: 		interface IMailbox {
```
[[5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IMailbox.sol#L5)]



```solidity
File: code/system-contracts/contracts/interfaces/IPaymaster.sol

14: 		interface IPaymaster {
```
[[14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IPaymaster.sol#L14)]



```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

16: 		contract Bridgehub is IBridgehub, ReentrancyGuard, Ownable2Step {
```
[[16](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L16)]



```solidity
File: code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol

42: 		interface IBridgehub {
```
[[42](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L42)]



```solidity
File: code/contracts/ethereum/contracts/common/ReentrancyGuard.sol

25: 		abstract contract ReentrancyGuard {
```
[[25](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/ReentrancyGuard.sol#L25)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol

26: 		interface IStateTransitionManager {
```
[[26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L26)]



```solidity
File: code/contracts/ethereum/contracts/upgrades/IDefaultUpgrade.sol

7: 		interface IDefaultUpgrade {
```
[[7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/IDefaultUpgrade.sol#L7)]



```solidity
File: code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol

21: 		library AddressAliasHelper {
```
[[21](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol#L21)]



```solidity
File: code/contracts/zksync/contracts/interfaces/IPaymaster.sol

14: 		interface IPaymaster {
```
[[14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/interfaces/IPaymaster.sol#L14)]



```solidity
File: code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol

21: 		library AddressAliasHelper {
```
[[21](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol#L21)]



```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IWETH9.sol

4: 		interface IWETH9 {
```
[[4](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IWETH9.sol#L4)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol

61: 		interface IDiamondInit {
```
[[61](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol#L61)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol

15: 		interface IZkSyncStateTransition is IAdmin, IExecutor, IGetters, IMailbox {
```
[[15](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol#L15)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/l2-deps/ISystemContext.sol

4: 		interface ISystemContext {
```
[[4](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/l2-deps/ISystemContext.sol#L4)]



```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol

5: 		interface IL2StandardToken {
```
[[5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol#L5)]

</details>

---

### [N-98] Missing NatSpec `@dev` from contract declaration

Some contract definitions have an incomplete NatSpec: add a `@dev` notation to describe the contract to improve the code documentation.

*There are 72 instances of this issue.*

<details>
<summary>Expand findings</summary>


```solidity
File: code/system-contracts/contracts/BootloaderUtilities.sol

16: 		contract BootloaderUtilities is IBootloaderUtilities {
```
[[16](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L16)]



```solidity
File: code/system-contracts/contracts/ComplexUpgrader.sol

14: 		contract ComplexUpgrader is IComplexUpgrader {
```
[[14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ComplexUpgrader.sol#L14)]



```solidity
File: code/system-contracts/contracts/EmptyContract.sol

10: 		contract EmptyContract {
```
[[10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/EmptyContract.sol#L10)]



```solidity
File: code/system-contracts/contracts/PubdataChunkPublisher.sol

16: 		contract PubdataChunkPublisher is IPubdataChunkPublisher, ISystemContract {
```
[[16](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/PubdataChunkPublisher.sol#L16)]



```solidity
File: code/system-contracts/contracts/SystemContext.sol

17: 		contract SystemContext is ISystemContext, ISystemContextDeprecated, ISystemContract {
```
[[17](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L17)]



```solidity
File: code/contracts/zksync/contracts/ForceDeployUpgrader.sol

10: 		contract ForceDeployUpgrader {
```
[[10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/ForceDeployUpgrader.sol#L10)]



```solidity
File: code/contracts/zksync/contracts/L2ContractHelper.sol

30: 		interface IContractDeployer {

61: 		interface IBaseToken {

83: 		library L2ContractHelper {
```
[[30](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/L2ContractHelper.sol#L30), [61](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/L2ContractHelper.sol#L61), [83](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/L2ContractHelper.sol#L83)]



```solidity
File: code/contracts/zksync/contracts/SystemContractsCaller.sol

26: 		library Utils {
```
[[26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/SystemContractsCaller.sol#L26)]



```solidity
File: code/system-contracts/contracts/interfaces/IAccount.sol

9: 		interface IAccount {
```
[[9](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IAccount.sol#L9)]



```solidity
File: code/system-contracts/contracts/interfaces/IAccountCodeStorage.sol

5: 		interface IAccountCodeStorage {
```
[[5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IAccountCodeStorage.sol#L5)]



```solidity
File: code/system-contracts/contracts/interfaces/IBaseToken.sol

5: 		interface IBaseToken {
```
[[5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBaseToken.sol#L5)]



```solidity
File: code/system-contracts/contracts/interfaces/IBootloaderUtilities.sol

7: 		interface IBootloaderUtilities {
```
[[7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBootloaderUtilities.sol#L7)]



```solidity
File: code/system-contracts/contracts/interfaces/IComplexUpgrader.sol

10: 		interface IComplexUpgrader {
```
[[10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IComplexUpgrader.sol#L10)]



```solidity
File: code/system-contracts/contracts/interfaces/ICompressor.sol

18: 		interface ICompressor {
```
[[18](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ICompressor.sol#L18)]



```solidity
File: code/system-contracts/contracts/interfaces/IContractDeployer.sol

5: 		interface IContractDeployer {
```
[[5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L5)]



```solidity
File: code/system-contracts/contracts/interfaces/IImmutableSimulator.sol

10: 		interface IImmutableSimulator {
```
[[10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IImmutableSimulator.sol#L10)]



```solidity
File: code/system-contracts/contracts/interfaces/IKnownCodesStorage.sol

11: 		interface IKnownCodesStorage {
```
[[11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IKnownCodesStorage.sol#L11)]



```solidity
File: code/system-contracts/contracts/interfaces/IL1Messenger.sol

40: 		interface IL1Messenger {
```
[[40](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL1Messenger.sol#L40)]



```solidity
File: code/system-contracts/contracts/interfaces/IL2StandardToken.sol

5: 		interface IL2StandardToken {
```
[[5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL2StandardToken.sol#L5)]



```solidity
File: code/system-contracts/contracts/interfaces/IMailbox.sol

5: 		interface IMailbox {
```
[[5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IMailbox.sol#L5)]



```solidity
File: code/system-contracts/contracts/interfaces/IPaymaster.sol

14: 		interface IPaymaster {
```
[[14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IPaymaster.sol#L14)]



```solidity
File: code/system-contracts/contracts/interfaces/IPubdataChunkPublisher.sol

9: 		interface IPubdataChunkPublisher {
```
[[9](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IPubdataChunkPublisher.sol#L9)]



```solidity
File: code/system-contracts/contracts/interfaces/ISystemContext.sol

11: 		interface ISystemContext {
```
[[11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L11)]



```solidity
File: code/system-contracts/contracts/interfaces/ISystemContextDeprecated.sol

10: 		interface ISystemContextDeprecated {
```
[[10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContextDeprecated.sol#L10)]



```solidity
File: code/system-contracts/contracts/libraries/RLPEncoder.sol

10: 		library RLPEncoder {
```
[[10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/RLPEncoder.sol#L10)]



```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

78: 		library TransactionHelper {
```
[[78](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L78)]



```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

16: 		contract Bridgehub is IBridgehub, ReentrancyGuard, Ownable2Step {
```
[[16](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L16)]



```solidity
File: code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol

42: 		interface IBridgehub {
```
[[42](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L42)]



```solidity
File: code/contracts/ethereum/contracts/governance/IGovernance.sol

8: 		interface IGovernance {
```
[[8](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L8)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol

26: 		interface IStateTransitionManager {
```
[[26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L26)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

25: 		contract StateTransitionManager is IStateTransitionManager, ReentrancyGuard, Ownable2Step {
```
[[25](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L25)]



```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol

44: 		abstract contract BaseZkSyncUpgrade is ZkSyncStateTransitionBase {
```
[[44](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L44)]



```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol

17: 		abstract contract BaseZkSyncUpgradeGenesis is BaseZkSyncUpgrade {
```
[[17](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L17)]



```solidity
File: code/contracts/ethereum/contracts/upgrades/DefaultUpgrade.sol

10: 		contract DefaultUpgrade is BaseZkSyncUpgrade {
```
[[10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/DefaultUpgrade.sol#L10)]



```solidity
File: code/contracts/ethereum/contracts/upgrades/GenesisUpgrade.sol

11: 		contract GenesisUpgrade is BaseZkSyncUpgradeGenesis {
```
[[11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/GenesisUpgrade.sol#L11)]



```solidity
File: code/contracts/ethereum/contracts/upgrades/IDefaultUpgrade.sol

7: 		interface IDefaultUpgrade {
```
[[7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/IDefaultUpgrade.sol#L7)]



```solidity
File: code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol

21: 		library AddressAliasHelper {
```
[[21](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol#L21)]



```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

23: 		contract L2SharedBridge is IL2SharedBridge, Initializable {
```
[[23](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L23)]



```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

15: 		contract L2StandardERC20 is ERC20PermitUpgradeable, IL2StandardToken, ERC1967Upgrade {
```
[[15](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L15)]



```solidity
File: code/contracts/zksync/contracts/interfaces/IPaymaster.sol

14: 		interface IPaymaster {
```
[[14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/interfaces/IPaymaster.sol#L14)]



```solidity
File: code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol

21: 		library AddressAliasHelper {
```
[[21](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol#L21)]



```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol

11: 		interface IL1ERC20Bridge {
```
[[11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L11)]



```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol

12: 		interface IL1SharedBridge {
```
[[12](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L12)]



```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL2Bridge.sol

6: 		interface IL2Bridge {
```
[[6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL2Bridge.sol#L6)]



```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IWETH9.sol

4: 		interface IWETH9 {
```
[[4](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IWETH9.sol#L4)]



```solidity
File: code/contracts/ethereum/contracts/common/interfaces/IL2ContractDeployer.sol

9: 		interface IL2ContractDeployer {
```
[[9](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/interfaces/IL2ContractDeployer.sol#L9)]



```solidity
File: code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol

10: 		library L2ContractHelper {
```
[[10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L10)]



```solidity
File: code/contracts/ethereum/contracts/common/libraries/UncheckedMath.sol

10: 		library UncheckedMath {
```
[[10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/UncheckedMath.sol#L10)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol

10: 		contract DiamondProxy {
```
[[10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol#L10)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol

13: 		interface IAdmin is IZkSyncStateTransitionBase {
```
[[13](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L13)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol

61: 		interface IDiamondInit {
```
[[61](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol#L61)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol

73: 		interface IExecutor is IZkSyncStateTransitionBase {
```
[[73](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L73)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol

13: 		interface IGetters is IZkSyncStateTransitionBase {
```
[[13](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L13)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol

11: 		interface IMailbox is IZkSyncStateTransitionBase {
```
[[11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L11)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IVerifier.sol

15: 		interface IVerifier {
```
[[15](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IVerifier.sol#L15)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol

15: 		interface IZkSyncStateTransition is IAdmin, IExecutor, IGetters, IMailbox {
```
[[15](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol#L15)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransitionBase.sol

7: 		interface IZkSyncStateTransitionBase {
```
[[7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransitionBase.sol#L7)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/l2-deps/ISystemContext.sol

4: 		interface ISystemContext {
```
[[4](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/l2-deps/ISystemContext.sol#L4)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol

11: 		library Diamond {
```
[[11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L11)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol

9: 		library Merkle {
```
[[9](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol#L9)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol

13: 		library TransactionValidator {
```
[[13](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L13)]



```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL1ERC20Bridge.sol

8: 		interface IL1ERC20Bridge {
```
[[8](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L8)]



```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL1SharedBridge.sol

8: 		interface IL1SharedBridge {
```
[[8](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL1SharedBridge.sol#L8)]



```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol

6: 		interface IL2SharedBridge {
```
[[6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol#L6)]



```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol

5: 		interface IL2StandardToken {
```
[[5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol#L5)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol

18: 		contract AdminFacet is ZkSyncStateTransitionBase, IAdmin {
```
[[18](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L18)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

22: 		contract ExecutorFacet is ZkSyncStateTransitionBase, IExecutor {
```
[[22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L22)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol

20: 		contract GettersFacet is ZkSyncStateTransitionBase, IGetters, ILegacyGetters {
```
[[20](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L20)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

30: 		contract MailboxFacet is ZkSyncStateTransitionBase, IMailbox {
```
[[30](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L30)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol

11: 		contract ZkSyncStateTransitionBase is ReentrancyGuard {
```
[[11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L11)]

</details>

---

### [N-99] Missing NatSpec `@notice` from contract declaration

Some contract definitions have an incomplete NatSpec: add a `@notice` notation to describe the contract to improve the code documentation.

*There are 54 instances of this issue.*

<details>
<summary>Expand findings</summary>


```solidity
File: code/contracts/zksync/contracts/SystemContractsCaller.sol

26: 		library Utils {
```
[[26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/SystemContractsCaller.sol#L26)]



```solidity
File: code/system-contracts/contracts/interfaces/IAccount.sol

9: 		interface IAccount {
```
[[9](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IAccount.sol#L9)]



```solidity
File: code/system-contracts/contracts/interfaces/IAccountCodeStorage.sol

5: 		interface IAccountCodeStorage {
```
[[5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IAccountCodeStorage.sol#L5)]



```solidity
File: code/system-contracts/contracts/interfaces/IBaseToken.sol

5: 		interface IBaseToken {
```
[[5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBaseToken.sol#L5)]



```solidity
File: code/system-contracts/contracts/interfaces/IBootloaderUtilities.sol

7: 		interface IBootloaderUtilities {
```
[[7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBootloaderUtilities.sol#L7)]



```solidity
File: code/system-contracts/contracts/interfaces/IContractDeployer.sol

5: 		interface IContractDeployer {
```
[[5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L5)]



```solidity
File: code/system-contracts/contracts/interfaces/IImmutableSimulator.sol

10: 		interface IImmutableSimulator {
```
[[10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IImmutableSimulator.sol#L10)]



```solidity
File: code/system-contracts/contracts/interfaces/IL2StandardToken.sol

5: 		interface IL2StandardToken {
```
[[5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL2StandardToken.sol#L5)]



```solidity
File: code/system-contracts/contracts/interfaces/IMailbox.sol

5: 		interface IMailbox {
```
[[5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IMailbox.sol#L5)]



```solidity
File: code/system-contracts/contracts/interfaces/INonceHolder.sol

13: 		interface INonceHolder {
```
[[13](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/INonceHolder.sol#L13)]



```solidity
File: code/system-contracts/contracts/interfaces/IPaymaster.sol

14: 		interface IPaymaster {
```
[[14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IPaymaster.sol#L14)]



```solidity
File: code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol

18: 		library UnsafeBytesCalldata {
```
[[18](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol#L18)]



```solidity
File: code/system-contracts/contracts/libraries/Utils.sol

11: 		library Utils {
```
[[11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L11)]



```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

30: 		contract L1SharedBridge is IL1SharedBridge, ReentrancyGuard, Initializable, Ownable2Step {
```
[[30](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L30)]



```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

16: 		contract Bridgehub is IBridgehub, ReentrancyGuard, Ownable2Step {
```
[[16](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L16)]



```solidity
File: code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol

42: 		interface IBridgehub {
```
[[42](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L42)]



```solidity
File: code/contracts/ethereum/contracts/common/ReentrancyGuard.sol

25: 		abstract contract ReentrancyGuard {
```
[[25](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/ReentrancyGuard.sol#L25)]



```solidity
File: code/contracts/ethereum/contracts/governance/IGovernance.sol

8: 		interface IGovernance {
```
[[8](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L8)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol

26: 		interface IStateTransitionManager {
```
[[26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L26)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

25: 		contract StateTransitionManager is IStateTransitionManager, ReentrancyGuard, Ownable2Step {
```
[[25](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L25)]



```solidity
File: code/contracts/ethereum/contracts/upgrades/DefaultUpgrade.sol

10: 		contract DefaultUpgrade is BaseZkSyncUpgrade {
```
[[10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/DefaultUpgrade.sol#L10)]



```solidity
File: code/contracts/ethereum/contracts/upgrades/GenesisUpgrade.sol

11: 		contract GenesisUpgrade is BaseZkSyncUpgradeGenesis {
```
[[11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/GenesisUpgrade.sol#L11)]



```solidity
File: code/contracts/ethereum/contracts/upgrades/IDefaultUpgrade.sol

7: 		interface IDefaultUpgrade {
```
[[7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/IDefaultUpgrade.sol#L7)]



```solidity
File: code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol

21: 		library AddressAliasHelper {
```
[[21](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol#L21)]



```solidity
File: code/contracts/zksync/contracts/interfaces/IPaymaster.sol

14: 		interface IPaymaster {
```
[[14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/interfaces/IPaymaster.sol#L14)]



```solidity
File: code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol

21: 		library AddressAliasHelper {
```
[[21](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol#L21)]



```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol

12: 		interface IL1SharedBridge {
```
[[12](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L12)]



```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL2Bridge.sol

6: 		interface IL2Bridge {
```
[[6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL2Bridge.sol#L6)]



```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IWETH9.sol

4: 		interface IWETH9 {
```
[[4](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IWETH9.sol#L4)]



```solidity
File: code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol

18: 		library UnsafeBytes {
```
[[18](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol#L18)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol

17: 		contract DiamondInit is ZkSyncStateTransitionBase, IDiamondInit {
```
[[17](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol#L17)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol

10: 		contract DiamondProxy {
```
[[10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol#L10)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol

13: 		interface IAdmin is IZkSyncStateTransitionBase {
```
[[13](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L13)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol

61: 		interface IDiamondInit {
```
[[61](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol#L61)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol

73: 		interface IExecutor is IZkSyncStateTransitionBase {
```
[[73](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L73)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol

13: 		interface IGetters is IZkSyncStateTransitionBase {
```
[[13](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L13)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/ILegacyGetters.sol

11: 		interface ILegacyGetters is IZkSyncStateTransitionBase {
```
[[11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/ILegacyGetters.sol#L11)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol

11: 		interface IMailbox is IZkSyncStateTransitionBase {
```
[[11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L11)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IVerifier.sol

15: 		interface IVerifier {
```
[[15](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IVerifier.sol#L15)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol

15: 		interface IZkSyncStateTransition is IAdmin, IExecutor, IGetters, IMailbox {
```
[[15](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol#L15)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransitionBase.sol

7: 		interface IZkSyncStateTransitionBase {
```
[[7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransitionBase.sol#L7)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/l2-deps/ISystemContext.sol

4: 		interface ISystemContext {
```
[[4](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/l2-deps/ISystemContext.sol#L4)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol

9: 		library Merkle {
```
[[9](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol#L9)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol

20: 		library PriorityQueue {
```
[[20](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L20)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol

13: 		library TransactionValidator {
```
[[13](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L13)]



```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL1ERC20Bridge.sol

8: 		interface IL1ERC20Bridge {
```
[[8](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L8)]



```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL1SharedBridge.sol

8: 		interface IL1SharedBridge {
```
[[8](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL1SharedBridge.sol#L8)]



```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol

6: 		interface IL2SharedBridge {
```
[[6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol#L6)]



```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol

5: 		interface IL2StandardToken {
```
[[5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol#L5)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol

18: 		contract AdminFacet is ZkSyncStateTransitionBase, IAdmin {
```
[[18](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L18)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

22: 		contract ExecutorFacet is ZkSyncStateTransitionBase, IExecutor {
```
[[22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L22)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol

20: 		contract GettersFacet is ZkSyncStateTransitionBase, IGetters, ILegacyGetters {
```
[[20](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L20)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

30: 		contract MailboxFacet is ZkSyncStateTransitionBase, IMailbox {
```
[[30](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L30)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol

11: 		contract ZkSyncStateTransitionBase is ReentrancyGuard {
```
[[11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L11)]

</details>

---

### [N-100] Missing NatSpec `@title` from contract declaration

Some contract definitions have an incomplete NatSpec: add a `@title` notation to describe the contract to improve the code documentation.

*There are 86 instances of this issue.*

<details>
<summary>Expand findings</summary>


```solidity
File: code/system-contracts/contracts/AccountCodeStorage.sol

22: 		contract AccountCodeStorage is IAccountCodeStorage {
```
[[22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L22)]



```solidity
File: code/system-contracts/contracts/BootloaderUtilities.sol

16: 		contract BootloaderUtilities is IBootloaderUtilities {
```
[[16](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L16)]



```solidity
File: code/system-contracts/contracts/ComplexUpgrader.sol

14: 		contract ComplexUpgrader is IComplexUpgrader {
```
[[14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ComplexUpgrader.sol#L14)]



```solidity
File: code/system-contracts/contracts/Compressor.sol

22: 		contract Compressor is ICompressor, ISystemContract {
```
[[22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L22)]



```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

23: 		contract ContractDeployer is IContractDeployer, ISystemContract {
```
[[23](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L23)]



```solidity
File: code/system-contracts/contracts/DefaultAccount.sol

19: 		contract DefaultAccount is IAccount {
```
[[19](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L19)]



```solidity
File: code/system-contracts/contracts/EmptyContract.sol

10: 		contract EmptyContract {
```
[[10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/EmptyContract.sol#L10)]



```solidity
File: code/system-contracts/contracts/GasBoundCaller.sol

15: 		contract GasBoundCaller {
```
[[15](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/GasBoundCaller.sol#L15)]



```solidity
File: code/system-contracts/contracts/ImmutableSimulator.sol

18: 		contract ImmutableSimulator is IImmutableSimulator {
```
[[18](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ImmutableSimulator.sol#L18)]



```solidity
File: code/system-contracts/contracts/KnownCodesStorage.sol

18: 		contract KnownCodesStorage is IKnownCodesStorage, ISystemContract {
```
[[18](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/KnownCodesStorage.sol#L18)]



```solidity
File: code/system-contracts/contracts/L1Messenger.sol

25: 		contract L1Messenger is IL1Messenger, ISystemContract {
```
[[25](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L25)]



```solidity
File: code/system-contracts/contracts/L2BaseToken.sol

18: 		contract L2BaseToken is IBaseToken, ISystemContract {
```
[[18](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L2BaseToken.sol#L18)]



```solidity
File: code/system-contracts/contracts/MsgValueSimulator.sol

19: 		contract MsgValueSimulator is ISystemContract {
```
[[19](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/MsgValueSimulator.sol#L19)]



```solidity
File: code/system-contracts/contracts/NonceHolder.sol

27: 		contract NonceHolder is INonceHolder, ISystemContract {
```
[[27](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/NonceHolder.sol#L27)]



```solidity
File: code/system-contracts/contracts/PubdataChunkPublisher.sol

16: 		contract PubdataChunkPublisher is IPubdataChunkPublisher, ISystemContract {
```
[[16](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/PubdataChunkPublisher.sol#L16)]



```solidity
File: code/system-contracts/contracts/SystemContext.sol

17: 		contract SystemContext is ISystemContext, ISystemContextDeprecated, ISystemContract {
```
[[17](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L17)]



```solidity
File: code/contracts/zksync/contracts/ForceDeployUpgrader.sol

10: 		contract ForceDeployUpgrader {
```
[[10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/ForceDeployUpgrader.sol#L10)]



```solidity
File: code/contracts/zksync/contracts/L2ContractHelper.sol

18: 		interface IL2Messenger {

30: 		interface IContractDeployer {

61: 		interface IBaseToken {

83: 		library L2ContractHelper {
```
[[18](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/L2ContractHelper.sol#L18), [30](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/L2ContractHelper.sol#L30), [61](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/L2ContractHelper.sol#L61), [83](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/L2ContractHelper.sol#L83)]



```solidity
File: code/contracts/zksync/contracts/SystemContractsCaller.sol

26: 		library Utils {

36: 		library SystemContractsCaller {
```
[[26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/SystemContractsCaller.sol#L26), [36](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/SystemContractsCaller.sol#L36)]



```solidity
File: code/system-contracts/contracts/interfaces/IAccount.sol

9: 		interface IAccount {
```
[[9](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IAccount.sol#L9)]



```solidity
File: code/system-contracts/contracts/interfaces/IAccountCodeStorage.sol

5: 		interface IAccountCodeStorage {
```
[[5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IAccountCodeStorage.sol#L5)]



```solidity
File: code/system-contracts/contracts/interfaces/IBaseToken.sol

5: 		interface IBaseToken {
```
[[5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBaseToken.sol#L5)]



```solidity
File: code/system-contracts/contracts/interfaces/IBootloaderUtilities.sol

7: 		interface IBootloaderUtilities {
```
[[7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBootloaderUtilities.sol#L7)]



```solidity
File: code/system-contracts/contracts/interfaces/IComplexUpgrader.sol

10: 		interface IComplexUpgrader {
```
[[10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IComplexUpgrader.sol#L10)]



```solidity
File: code/system-contracts/contracts/interfaces/ICompressor.sol

18: 		interface ICompressor {
```
[[18](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ICompressor.sol#L18)]



```solidity
File: code/system-contracts/contracts/interfaces/IContractDeployer.sol

5: 		interface IContractDeployer {
```
[[5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L5)]



```solidity
File: code/system-contracts/contracts/interfaces/IImmutableSimulator.sol

10: 		interface IImmutableSimulator {
```
[[10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IImmutableSimulator.sol#L10)]



```solidity
File: code/system-contracts/contracts/interfaces/IKnownCodesStorage.sol

11: 		interface IKnownCodesStorage {
```
[[11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IKnownCodesStorage.sol#L11)]



```solidity
File: code/system-contracts/contracts/interfaces/IL1Messenger.sol

40: 		interface IL1Messenger {
```
[[40](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL1Messenger.sol#L40)]



```solidity
File: code/system-contracts/contracts/interfaces/IL2StandardToken.sol

5: 		interface IL2StandardToken {
```
[[5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL2StandardToken.sol#L5)]



```solidity
File: code/system-contracts/contracts/interfaces/IMailbox.sol

5: 		interface IMailbox {
```
[[5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IMailbox.sol#L5)]



```solidity
File: code/system-contracts/contracts/interfaces/INonceHolder.sol

13: 		interface INonceHolder {
```
[[13](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/INonceHolder.sol#L13)]



```solidity
File: code/system-contracts/contracts/interfaces/IPaymaster.sol

14: 		interface IPaymaster {
```
[[14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IPaymaster.sol#L14)]



```solidity
File: code/system-contracts/contracts/interfaces/IPaymasterFlow.sol

12: 		interface IPaymasterFlow {
```
[[12](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IPaymasterFlow.sol#L12)]



```solidity
File: code/system-contracts/contracts/interfaces/IPubdataChunkPublisher.sol

9: 		interface IPubdataChunkPublisher {
```
[[9](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IPubdataChunkPublisher.sol#L9)]



```solidity
File: code/system-contracts/contracts/interfaces/ISystemContext.sol

11: 		interface ISystemContext {
```
[[11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L11)]



```solidity
File: code/system-contracts/contracts/interfaces/ISystemContextDeprecated.sol

10: 		interface ISystemContextDeprecated {
```
[[10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContextDeprecated.sol#L10)]



```solidity
File: code/system-contracts/contracts/interfaces/ISystemContract.sol

17: 		abstract contract ISystemContract {
```
[[17](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContract.sol#L17)]



```solidity
File: code/system-contracts/contracts/libraries/EfficientCall.sol

32: 		library EfficientCall {
```
[[32](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L32)]



```solidity
File: code/system-contracts/contracts/libraries/RLPEncoder.sol

10: 		library RLPEncoder {
```
[[10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/RLPEncoder.sol#L10)]



```solidity
File: code/system-contracts/contracts/libraries/SystemContractHelper.sol

41: 		library SystemContractHelper {
```
[[41](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L41)]



```solidity
File: code/system-contracts/contracts/libraries/SystemContractsCaller.sol

68: 		library SystemContractsCaller {
```
[[68](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L68)]



```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

78: 		library TransactionHelper {
```
[[78](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L78)]



```solidity
File: code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol

18: 		library UnsafeBytesCalldata {
```
[[18](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol#L18)]



```solidity
File: code/system-contracts/contracts/libraries/Utils.sol

11: 		library Utils {
```
[[11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L11)]



```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

19: 		contract L1ERC20Bridge is IL1ERC20Bridge, ReentrancyGuard {
```
[[19](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L19)]



```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

30: 		contract L1SharedBridge is IL1SharedBridge, ReentrancyGuard, Initializable, Ownable2Step {
```
[[30](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L30)]



```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

16: 		contract Bridgehub is IBridgehub, ReentrancyGuard, Ownable2Step {
```
[[16](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L16)]



```solidity
File: code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol

42: 		interface IBridgehub {
```
[[42](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L42)]



```solidity
File: code/contracts/ethereum/contracts/common/ReentrancyGuard.sol

25: 		abstract contract ReentrancyGuard {
```
[[25](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/ReentrancyGuard.sol#L25)]



```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

20: 		contract Governance is IGovernance, Ownable2Step {
```
[[20](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L20)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol

26: 		interface IStateTransitionManager {
```
[[26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L26)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

22: 		contract ValidatorTimelock is IExecutor, Ownable2Step {
```
[[22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L22)]



```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol

44: 		abstract contract BaseZkSyncUpgrade is ZkSyncStateTransitionBase {
```
[[44](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L44)]



```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol

17: 		abstract contract BaseZkSyncUpgradeGenesis is BaseZkSyncUpgrade {
```
[[17](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L17)]



```solidity
File: code/contracts/ethereum/contracts/upgrades/DefaultUpgrade.sol

10: 		contract DefaultUpgrade is BaseZkSyncUpgrade {
```
[[10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/DefaultUpgrade.sol#L10)]



```solidity
File: code/contracts/ethereum/contracts/upgrades/GenesisUpgrade.sol

11: 		contract GenesisUpgrade is BaseZkSyncUpgradeGenesis {
```
[[11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/GenesisUpgrade.sol#L11)]



```solidity
File: code/contracts/ethereum/contracts/upgrades/IDefaultUpgrade.sol

7: 		interface IDefaultUpgrade {
```
[[7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/IDefaultUpgrade.sol#L7)]



```solidity
File: code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol

21: 		library AddressAliasHelper {
```
[[21](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol#L21)]



```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

23: 		contract L2SharedBridge is IL2SharedBridge, Initializable {
```
[[23](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L23)]



```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

15: 		contract L2StandardERC20 is ERC20PermitUpgradeable, IL2StandardToken, ERC1967Upgrade {
```
[[15](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L15)]



```solidity
File: code/contracts/zksync/contracts/interfaces/IPaymaster.sol

14: 		interface IPaymaster {
```
[[14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/interfaces/IPaymaster.sol#L14)]



```solidity
File: code/contracts/zksync/contracts/interfaces/IPaymasterFlow.sol

13: 		interface IPaymasterFlow {
```
[[13](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/interfaces/IPaymasterFlow.sol#L13)]



```solidity
File: code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol

21: 		library AddressAliasHelper {
```
[[21](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol#L21)]



```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL2Bridge.sol

6: 		interface IL2Bridge {
```
[[6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL2Bridge.sol#L6)]



```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IWETH9.sol

4: 		interface IWETH9 {
```
[[4](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IWETH9.sol#L4)]



```solidity
File: code/contracts/ethereum/contracts/common/interfaces/IL2ContractDeployer.sol

9: 		interface IL2ContractDeployer {
```
[[9](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/interfaces/IL2ContractDeployer.sol#L9)]



```solidity
File: code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol

10: 		library L2ContractHelper {
```
[[10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L10)]



```solidity
File: code/contracts/ethereum/contracts/common/libraries/UncheckedMath.sol

10: 		library UncheckedMath {
```
[[10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/UncheckedMath.sol#L10)]



```solidity
File: code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol

18: 		library UnsafeBytes {
```
[[18](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol#L18)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol

17: 		contract DiamondInit is ZkSyncStateTransitionBase, IDiamondInit {
```
[[17](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol#L17)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol

61: 		interface IDiamondInit {
```
[[61](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol#L61)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/ILegacyGetters.sol

11: 		interface ILegacyGetters is IZkSyncStateTransitionBase {
```
[[11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/ILegacyGetters.sol#L11)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol

15: 		interface IZkSyncStateTransition is IAdmin, IExecutor, IGetters, IMailbox {
```
[[15](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol#L15)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/l2-deps/ISystemContext.sol

4: 		interface ISystemContext {
```
[[4](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/l2-deps/ISystemContext.sol#L4)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol

11: 		library Diamond {
```
[[11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L11)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/LibMap.sol

8: 		library LibMap {
```
[[8](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/LibMap.sol#L8)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol

9: 		library Merkle {
```
[[9](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol#L9)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol

20: 		library PriorityQueue {
```
[[20](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L20)]



```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL1ERC20Bridge.sol

8: 		interface IL1ERC20Bridge {
```
[[8](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L8)]



```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol

6: 		interface IL2SharedBridge {
```
[[6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol#L6)]



```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol

5: 		interface IL2StandardToken {
```
[[5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol#L5)]

</details>

---

### [N-101] Missing NatSpec `@dev` from error declaration

Some errors have an incomplete NatSpec: add a `@dev` notation to describe the error to improve the code documentation.

*There are 2 instances of this issue.*


```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

38: 		    error AddressAlreadyValidator(uint256 _chainId);

41: 		    error ValidatorDoesNotExist(uint256 _chainId);
```
[[38](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L38), [41](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L41)]


---

### [N-102] Missing NatSpec `@param` from error declaration

Some errors have an incomplete NatSpec: add a `@param` notation to describe the error parameters to improve the code documentation.

*There are 2 instances of this issue.*


```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

// @audit missing _chainId
38: 		    error AddressAlreadyValidator(uint256 _chainId);

// @audit missing _chainId
41: 		    error ValidatorDoesNotExist(uint256 _chainId);
```
[[38](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L38), [41](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L41)]


---

### [N-103] Missing NatSpec from event declaration

Consider adding some comments on event declarations to explain what they are supposed to do: this will help for future code reviews.

*There are 33 instances of this issue.*

<details>
<summary>Expand findings</summary>


```solidity
File: code/system-contracts/contracts/interfaces/IBaseToken.sol

24: 		    event Mint(address indexed account, uint256 amount);

26: 		    event Transfer(address indexed from, address indexed to, uint256 value);

28: 		    event Withdrawal(address indexed _l2Sender, address indexed _l1Receiver, uint256 _amount);

30: 		    event WithdrawalWithMessage(
```
[[24](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBaseToken.sol#L24), [26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBaseToken.sol#L26), [28](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBaseToken.sol#L28), [30](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBaseToken.sol#L30)]



```solidity
File: code/system-contracts/contracts/interfaces/IContractDeployer.sol

33: 		    event ContractDeployed(

39: 		    event AccountNonceOrderingUpdated(address indexed accountAddress, AccountNonceOrdering nonceOrdering);

41: 		    event AccountVersionUpdated(address indexed accountAddress, AccountAbstractionVersion aaVersion);
```
[[33](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L33), [39](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L39), [41](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L41)]



```solidity
File: code/system-contracts/contracts/interfaces/IKnownCodesStorage.sol

12: 		    event MarkedAsKnown(bytes32 indexed bytecodeHash, bool indexed sendBytecodeToL1);
```
[[12](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IKnownCodesStorage.sol#L12)]



```solidity
File: code/system-contracts/contracts/interfaces/IL1Messenger.sol

43: 		    event L1MessageSent(address indexed _sender, bytes32 indexed _hash, bytes _message);

45: 		    event L2ToL1LogSent(L2ToL1Log _l2log);

47: 		    event BytecodeL1PublicationRequested(bytes32 _bytecodeHash);
```
[[43](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL1Messenger.sol#L43), [45](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL1Messenger.sol#L45), [47](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL1Messenger.sol#L47)]



```solidity
File: code/system-contracts/contracts/interfaces/IL2StandardToken.sol

6: 		    event BridgeMint(address indexed _account, uint256 _amount);

8: 		    event BridgeBurn(address indexed _account, uint256 _amount);
```
[[6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL2StandardToken.sol#L6), [8](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL2StandardToken.sol#L8)]



```solidity
File: code/system-contracts/contracts/interfaces/INonceHolder.sol

14: 		    event ValueSetUnderNonce(address indexed accountAddress, uint256 indexed key, uint256 value);
```
[[14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/INonceHolder.sol#L14)]



```solidity
File: code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol

133: 		    event NewChain(uint256 indexed chainId, address stateTransitionManager, address indexed chainGovernance);
```
[[133](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L133)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol

28: 		    event StateTransitionNewChain(uint256 indexed _chainId, address indexed _stateTransitionContract);

30: 		    event SetChainIdUpgrade(
```
[[28](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L28), [30](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L30)]



```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol

12: 		    event DepositInitiated(

20: 		    event WithdrawalFinalized(address indexed to, address indexed l1Token, uint256 amount);

22: 		    event ClaimedFailedDeposit(address indexed to, address indexed l1Token, uint256 amount);
```
[[12](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L12), [20](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L20), [22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L22)]



```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol

13: 		    event LegacyDepositInitiated(

22: 		    event BridgehubDepositInitiated(

31: 		    event BridgehubDepositBaseTokenInitiated(

38: 		    event BridgehubDepositFinalized(

44: 		    event WithdrawalFinalizedSharedBridge(

51: 		    event ClaimedFailedDepositSharedBridge(
```
[[13](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L13), [22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L22), [31](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L31), [38](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L38), [44](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L44), [51](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L51)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol

17: 		    event ProposeTransparentUpgrade(
```
[[17](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol#L17)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol

24: 		    event DiamondCut(FacetCut[] facetCuts, address initAddress, bytes initCalldata);
```
[[24](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L24)]



```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol

7: 		    event FinalizeDeposit(

14: 		    event WithdrawalInitiated(
```
[[7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol#L7), [14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol#L14)]



```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol

6: 		    event BridgeInitialize(address indexed l1Token, string name, string symbol, uint8 decimals);

8: 		    event BridgeMint(address indexed _account, uint256 _amount);

10: 		    event BridgeBurn(address indexed _account, uint256 _amount);
```
[[6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol#L6), [8](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol#L8), [10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol#L10)]

</details>

---

### [N-104] Missing NatSpec `@dev` from event declaration

Some events have an incomplete NatSpec: add a `@dev` notation to describe the event to improve the code documentation.

*There are 62 instances of this issue.*

<details>
<summary>Expand findings</summary>


```solidity
File: code/system-contracts/contracts/interfaces/IBaseToken.sol

24: 		    event Mint(address indexed account, uint256 amount);

26: 		    event Transfer(address indexed from, address indexed to, uint256 value);

28: 		    event Withdrawal(address indexed _l2Sender, address indexed _l1Receiver, uint256 _amount);

30: 		    event WithdrawalWithMessage(
```
[[24](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBaseToken.sol#L24), [26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBaseToken.sol#L26), [28](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBaseToken.sol#L28), [30](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBaseToken.sol#L30)]



```solidity
File: code/system-contracts/contracts/interfaces/IContractDeployer.sol

33: 		    event ContractDeployed(

39: 		    event AccountNonceOrderingUpdated(address indexed accountAddress, AccountNonceOrdering nonceOrdering);

41: 		    event AccountVersionUpdated(address indexed accountAddress, AccountAbstractionVersion aaVersion);
```
[[33](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L33), [39](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L39), [41](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L41)]



```solidity
File: code/system-contracts/contracts/interfaces/IKnownCodesStorage.sol

12: 		    event MarkedAsKnown(bytes32 indexed bytecodeHash, bool indexed sendBytecodeToL1);
```
[[12](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IKnownCodesStorage.sol#L12)]



```solidity
File: code/system-contracts/contracts/interfaces/IL1Messenger.sol

43: 		    event L1MessageSent(address indexed _sender, bytes32 indexed _hash, bytes _message);

45: 		    event L2ToL1LogSent(L2ToL1Log _l2log);

47: 		    event BytecodeL1PublicationRequested(bytes32 _bytecodeHash);
```
[[43](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL1Messenger.sol#L43), [45](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL1Messenger.sol#L45), [47](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL1Messenger.sol#L47)]



```solidity
File: code/system-contracts/contracts/interfaces/IL2StandardToken.sol

6: 		    event BridgeMint(address indexed _account, uint256 _amount);

8: 		    event BridgeBurn(address indexed _account, uint256 _amount);
```
[[6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL2StandardToken.sol#L6), [8](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL2StandardToken.sol#L8)]



```solidity
File: code/system-contracts/contracts/interfaces/INonceHolder.sol

14: 		    event ValueSetUnderNonce(address indexed accountAddress, uint256 indexed key, uint256 value);
```
[[14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/INonceHolder.sol#L14)]



```solidity
File: code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol

48: 		    event NewAdmin(address indexed oldAdmin, address indexed newAdmin);

133: 		    event NewChain(uint256 indexed chainId, address stateTransitionManager, address indexed chainGovernance);
```
[[48](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L48), [133](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L133)]



```solidity
File: code/contracts/ethereum/contracts/governance/IGovernance.sol

68: 		    event TransparentOperationScheduled(bytes32 indexed _id, uint256 delay, Operation _operation);

71: 		    event ShadowOperationScheduled(bytes32 indexed _id, uint256 delay);

74: 		    event OperationExecuted(bytes32 indexed _id);

77: 		    event ChangeSecurityCouncil(address _securityCouncilBefore, address _securityCouncilAfter);

80: 		    event ChangeMinDelay(uint256 _delayBefore, uint256 _delayAfter);

83: 		    event OperationCancelled(bytes32 indexed _id);
```
[[68](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L68), [71](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L71), [74](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L74), [77](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L77), [80](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L80), [83](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L83)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol

28: 		    event StateTransitionNewChain(uint256 indexed _chainId, address indexed _stateTransitionContract);

30: 		    event SetChainIdUpgrade(

41: 		    event NewAdmin(address indexed oldAdmin, address indexed newAdmin);
```
[[28](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L28), [30](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L30), [41](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L41)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

29: 		    event NewExecutionDelay(uint256 _newExecutionDelay);

32: 		    event ValidatorAdded(uint256 _chainId, address _addedValidator);

35: 		    event ValidatorRemoved(uint256 _chainId, address _removedValidator);
```
[[29](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L29), [32](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L32), [35](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L35)]



```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol

46: 		    event NewProtocolVersion(uint256 indexed previousProtocolVersion, uint256 indexed newProtocolVersion);

49: 		    event NewL2BootloaderBytecodeHash(bytes32 indexed previousBytecodeHash, bytes32 indexed newBytecodeHash);

52: 		    event NewL2DefaultAccountBytecodeHash(bytes32 indexed previousBytecodeHash, bytes32 indexed newBytecodeHash);

55: 		    event NewVerifier(address indexed oldVerifier, address indexed newVerifier);

58: 		    event NewVerifierParams(VerifierParams oldVerifierParams, VerifierParams newVerifierParams);

61: 		    event UpgradeComplete(uint256 indexed newProtocolVersion, bytes32 indexed l2UpgradeTxHash, ProposedUpgrade upgrade);
```
[[46](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L46), [49](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L49), [52](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L52), [55](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L55), [58](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L58), [61](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L61)]



```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol

12: 		    event DepositInitiated(

20: 		    event WithdrawalFinalized(address indexed to, address indexed l1Token, uint256 amount);

22: 		    event ClaimedFailedDeposit(address indexed to, address indexed l1Token, uint256 amount);
```
[[12](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L12), [20](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L20), [22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L22)]



```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol

13: 		    event LegacyDepositInitiated(

22: 		    event BridgehubDepositInitiated(

31: 		    event BridgehubDepositBaseTokenInitiated(

38: 		    event BridgehubDepositFinalized(

44: 		    event WithdrawalFinalizedSharedBridge(

51: 		    event ClaimedFailedDepositSharedBridge(
```
[[13](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L13), [22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L22), [31](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L31), [38](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L38), [44](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L44), [51](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L51)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol

61: 		    event IsPorterAvailableStatusUpdate(bool isPorterAvailable);

64: 		    event ValidatorStatusUpdate(address indexed validatorAddress, bool isActive);

71: 		    event NewAdmin(address indexed oldAdmin, address indexed newAdmin);

74: 		    event NewPriorityTxMaxGasLimit(uint256 oldPriorityTxMaxGasLimit, uint256 newPriorityTxMaxGasLimit);

77: 		    event NewFeeParams(FeeParams oldFeeParams, FeeParams newFeeParams);

80: 		    event ValidiumModeStatusUpdate(PubdataPricingMode validiumMode);

83: 		    event NewBaseTokenMultiplier(

91: 		    event ExecuteUpgrade(Diamond.DiamondCutData diamondCut);

94: 		    event Freeze();

97: 		    event Unfreeze();
```
[[61](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L61), [64](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L64), [71](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L71), [74](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L74), [77](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L77), [80](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L80), [83](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L83), [91](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L91), [94](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L94), [97](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L97)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol

123: 		    event NewPriorityRequest(

134: 		    event EthWithdrawalFinalized(address indexed to, uint256 amount);
```
[[123](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L123), [134](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L134)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol

17: 		    event ProposeTransparentUpgrade(
```
[[17](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol#L17)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol

24: 		    event DiamondCut(FacetCut[] facetCuts, address initAddress, bytes initCalldata);
```
[[24](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L24)]



```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol

7: 		    event FinalizeDeposit(

14: 		    event WithdrawalInitiated(
```
[[7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol#L7), [14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol#L14)]



```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol

6: 		    event BridgeInitialize(address indexed l1Token, string name, string symbol, uint8 decimals);

8: 		    event BridgeMint(address indexed _account, uint256 _amount);

10: 		    event BridgeBurn(address indexed _account, uint256 _amount);
```
[[6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol#L6), [8](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol#L8), [10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol#L10)]

</details>

---

### [N-105] Missing NatSpec `@notice` from event declaration

Some events have an incomplete NatSpec: add a `@notice` notation to describe the event to improve the code documentation.

*There are 34 instances of this issue.*

<details>
<summary>Expand findings</summary>


```solidity
File: code/system-contracts/contracts/interfaces/IBaseToken.sol

24: 		    event Mint(address indexed account, uint256 amount);

26: 		    event Transfer(address indexed from, address indexed to, uint256 value);

28: 		    event Withdrawal(address indexed _l2Sender, address indexed _l1Receiver, uint256 _amount);

30: 		    event WithdrawalWithMessage(
```
[[24](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBaseToken.sol#L24), [26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBaseToken.sol#L26), [28](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBaseToken.sol#L28), [30](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBaseToken.sol#L30)]



```solidity
File: code/system-contracts/contracts/interfaces/IContractDeployer.sol

33: 		    event ContractDeployed(

39: 		    event AccountNonceOrderingUpdated(address indexed accountAddress, AccountNonceOrdering nonceOrdering);

41: 		    event AccountVersionUpdated(address indexed accountAddress, AccountAbstractionVersion aaVersion);
```
[[33](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L33), [39](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L39), [41](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L41)]



```solidity
File: code/system-contracts/contracts/interfaces/IKnownCodesStorage.sol

12: 		    event MarkedAsKnown(bytes32 indexed bytecodeHash, bool indexed sendBytecodeToL1);
```
[[12](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IKnownCodesStorage.sol#L12)]



```solidity
File: code/system-contracts/contracts/interfaces/IL1Messenger.sol

43: 		    event L1MessageSent(address indexed _sender, bytes32 indexed _hash, bytes _message);

45: 		    event L2ToL1LogSent(L2ToL1Log _l2log);

47: 		    event BytecodeL1PublicationRequested(bytes32 _bytecodeHash);
```
[[43](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL1Messenger.sol#L43), [45](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL1Messenger.sol#L45), [47](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL1Messenger.sol#L47)]



```solidity
File: code/system-contracts/contracts/interfaces/IL2StandardToken.sol

6: 		    event BridgeMint(address indexed _account, uint256 _amount);

8: 		    event BridgeBurn(address indexed _account, uint256 _amount);
```
[[6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL2StandardToken.sol#L6), [8](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL2StandardToken.sol#L8)]



```solidity
File: code/system-contracts/contracts/interfaces/INonceHolder.sol

14: 		    event ValueSetUnderNonce(address indexed accountAddress, uint256 indexed key, uint256 value);
```
[[14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/INonceHolder.sol#L14)]



```solidity
File: code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol

133: 		    event NewChain(uint256 indexed chainId, address stateTransitionManager, address indexed chainGovernance);
```
[[133](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L133)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol

28: 		    event StateTransitionNewChain(uint256 indexed _chainId, address indexed _stateTransitionContract);

30: 		    event SetChainIdUpgrade(
```
[[28](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L28), [30](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L30)]



```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol

12: 		    event DepositInitiated(

20: 		    event WithdrawalFinalized(address indexed to, address indexed l1Token, uint256 amount);

22: 		    event ClaimedFailedDeposit(address indexed to, address indexed l1Token, uint256 amount);
```
[[12](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L12), [20](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L20), [22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L22)]



```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol

13: 		    event LegacyDepositInitiated(

22: 		    event BridgehubDepositInitiated(

31: 		    event BridgehubDepositBaseTokenInitiated(

38: 		    event BridgehubDepositFinalized(

44: 		    event WithdrawalFinalizedSharedBridge(

51: 		    event ClaimedFailedDepositSharedBridge(
```
[[13](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L13), [22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L22), [31](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L31), [38](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L38), [44](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L44), [51](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L51)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol

17: 		    event ProposeTransparentUpgrade(
```
[[17](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol#L17)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol

24: 		    event DiamondCut(FacetCut[] facetCuts, address initAddress, bytes initCalldata);
```
[[24](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L24)]



```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol

7: 		    event FinalizeDeposit(

14: 		    event WithdrawalInitiated(

22: 		    event BaseTokenReceived(uint256 amount);
```
[[7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol#L7), [14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol#L14), [22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol#L22)]



```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol

6: 		    event BridgeInitialize(address indexed l1Token, string name, string symbol, uint8 decimals);

8: 		    event BridgeMint(address indexed _account, uint256 _amount);

10: 		    event BridgeBurn(address indexed _account, uint256 _amount);
```
[[6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol#L6), [8](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol#L8), [10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol#L10)]

</details>

---

### [N-106] Missing NatSpec `@param` from event declaration

Some events have an incomplete NatSpec: add a `@param` notation to describe the event to improve the code documentation.

*There are 64 instances of this issue.*

<details>
<summary>Expand findings</summary>


```solidity
File: code/system-contracts/contracts/interfaces/IBaseToken.sol

// @audit missing account, amount
24: 		    event Mint(address indexed account, uint256 amount);

// @audit missing from, to, value
26: 		    event Transfer(address indexed from, address indexed to, uint256 value);

// @audit missing _l2Sender, _l1Receiver, _amount
28: 		    event Withdrawal(address indexed _l2Sender, address indexed _l1Receiver, uint256 _amount);

// @audit missing _l2Sender, _l1Receiver, _amount, _additionalData
30: 		    event WithdrawalWithMessage(
```
[[24](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBaseToken.sol#L24), [26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBaseToken.sol#L26), [28](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBaseToken.sol#L28), [30](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBaseToken.sol#L30)]



```solidity
File: code/system-contracts/contracts/interfaces/IContractDeployer.sol

// @audit missing deployerAddress, bytecodeHash, contractAddress
33: 		    event ContractDeployed(

// @audit missing accountAddress, nonceOrdering
39: 		    event AccountNonceOrderingUpdated(address indexed accountAddress, AccountNonceOrdering nonceOrdering);

// @audit missing accountAddress, aaVersion
41: 		    event AccountVersionUpdated(address indexed accountAddress, AccountAbstractionVersion aaVersion);
```
[[33](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L33), [39](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L39), [41](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L41)]



```solidity
File: code/system-contracts/contracts/interfaces/IKnownCodesStorage.sol

// @audit missing bytecodeHash, sendBytecodeToL1
12: 		    event MarkedAsKnown(bytes32 indexed bytecodeHash, bool indexed sendBytecodeToL1);
```
[[12](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IKnownCodesStorage.sol#L12)]



```solidity
File: code/system-contracts/contracts/interfaces/IL1Messenger.sol

// @audit missing _sender, _hash, _message
43: 		    event L1MessageSent(address indexed _sender, bytes32 indexed _hash, bytes _message);

// @audit missing _l2log
45: 		    event L2ToL1LogSent(L2ToL1Log _l2log);

// @audit missing _bytecodeHash
47: 		    event BytecodeL1PublicationRequested(bytes32 _bytecodeHash);
```
[[43](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL1Messenger.sol#L43), [45](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL1Messenger.sol#L45), [47](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL1Messenger.sol#L47)]



```solidity
File: code/system-contracts/contracts/interfaces/IL2StandardToken.sol

// @audit missing _account, _amount
6: 		    event BridgeMint(address indexed _account, uint256 _amount);

// @audit missing _account, _amount
8: 		    event BridgeBurn(address indexed _account, uint256 _amount);
```
[[6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL2StandardToken.sol#L6), [8](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL2StandardToken.sol#L8)]



```solidity
File: code/system-contracts/contracts/interfaces/INonceHolder.sol

// @audit missing accountAddress, key, value
14: 		    event ValueSetUnderNonce(address indexed accountAddress, uint256 indexed key, uint256 value);
```
[[14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/INonceHolder.sol#L14)]



```solidity
File: code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol

// @audit missing oldPendingAdmin, newPendingAdmin
45: 		    event NewPendingAdmin(address indexed oldPendingAdmin, address indexed newPendingAdmin);

// @audit missing oldAdmin, newAdmin
48: 		    event NewAdmin(address indexed oldAdmin, address indexed newAdmin);

// @audit missing chainId, stateTransitionManager, chainGovernance
133: 		    event NewChain(uint256 indexed chainId, address stateTransitionManager, address indexed chainGovernance);
```
[[45](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L45), [48](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L48), [133](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L133)]



```solidity
File: code/contracts/ethereum/contracts/governance/IGovernance.sol

// @audit missing _id, delay, _operation
68: 		    event TransparentOperationScheduled(bytes32 indexed _id, uint256 delay, Operation _operation);

// @audit missing _id, delay
71: 		    event ShadowOperationScheduled(bytes32 indexed _id, uint256 delay);

// @audit missing _id
74: 		    event OperationExecuted(bytes32 indexed _id);

// @audit missing _securityCouncilBefore, _securityCouncilAfter
77: 		    event ChangeSecurityCouncil(address _securityCouncilBefore, address _securityCouncilAfter);

// @audit missing _delayBefore, _delayAfter
80: 		    event ChangeMinDelay(uint256 _delayBefore, uint256 _delayAfter);

// @audit missing _id
83: 		    event OperationCancelled(bytes32 indexed _id);
```
[[68](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L68), [71](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L71), [74](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L74), [77](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L77), [80](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L80), [83](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L83)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol

// @audit missing _chainId, _stateTransitionContract
28: 		    event StateTransitionNewChain(uint256 indexed _chainId, address indexed _stateTransitionContract);

// @audit missing _stateTransitionChain, _l2Transaction, _protocolVersion
30: 		    event SetChainIdUpgrade(

// @audit missing oldPendingAdmin, newPendingAdmin
38: 		    event NewPendingAdmin(address indexed oldPendingAdmin, address indexed newPendingAdmin);

// @audit missing oldAdmin, newAdmin
41: 		    event NewAdmin(address indexed oldAdmin, address indexed newAdmin);
```
[[28](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L28), [30](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L30), [38](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L38), [41](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L41)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

// @audit missing _newExecutionDelay
29: 		    event NewExecutionDelay(uint256 _newExecutionDelay);

// @audit missing _chainId, _addedValidator
32: 		    event ValidatorAdded(uint256 _chainId, address _addedValidator);

// @audit missing _chainId, _removedValidator
35: 		    event ValidatorRemoved(uint256 _chainId, address _removedValidator);
```
[[29](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L29), [32](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L32), [35](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L35)]



```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol

// @audit missing previousProtocolVersion, newProtocolVersion
46: 		    event NewProtocolVersion(uint256 indexed previousProtocolVersion, uint256 indexed newProtocolVersion);

// @audit missing previousBytecodeHash, newBytecodeHash
49: 		    event NewL2BootloaderBytecodeHash(bytes32 indexed previousBytecodeHash, bytes32 indexed newBytecodeHash);

// @audit missing previousBytecodeHash, newBytecodeHash
52: 		    event NewL2DefaultAccountBytecodeHash(bytes32 indexed previousBytecodeHash, bytes32 indexed newBytecodeHash);

// @audit missing oldVerifier, newVerifier
55: 		    event NewVerifier(address indexed oldVerifier, address indexed newVerifier);

// @audit missing oldVerifierParams, newVerifierParams
58: 		    event NewVerifierParams(VerifierParams oldVerifierParams, VerifierParams newVerifierParams);

// @audit missing newProtocolVersion, l2UpgradeTxHash, upgrade
61: 		    event UpgradeComplete(uint256 indexed newProtocolVersion, bytes32 indexed l2UpgradeTxHash, ProposedUpgrade upgrade);
```
[[46](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L46), [49](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L49), [52](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L52), [55](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L55), [58](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L58), [61](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L61)]



```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol

// @audit missing l2DepositTxHash, from, to, l1Token, amount
12: 		    event DepositInitiated(

// @audit missing to, l1Token, amount
20: 		    event WithdrawalFinalized(address indexed to, address indexed l1Token, uint256 amount);

// @audit missing to, l1Token, amount
22: 		    event ClaimedFailedDeposit(address indexed to, address indexed l1Token, uint256 amount);
```
[[12](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L12), [20](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L20), [22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L22)]



```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol

// @audit missing chainId, l2DepositTxHash, from, to, l1Token, amount
13: 		    event LegacyDepositInitiated(

// @audit missing chainId, txDataHash, from, to, l1Token, amount
22: 		    event BridgehubDepositInitiated(

// @audit missing chainId, from, l1Token, amount
31: 		    event BridgehubDepositBaseTokenInitiated(

// @audit missing chainId, txDataHash, l2DepositTxHash
38: 		    event BridgehubDepositFinalized(

// @audit missing chainId, to, l1Token, amount
44: 		    event WithdrawalFinalizedSharedBridge(

// @audit missing chainId, to, l1Token, amount
51: 		    event ClaimedFailedDepositSharedBridge(
```
[[13](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L13), [22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L22), [31](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L31), [38](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L38), [44](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L44), [51](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L51)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol

// @audit missing isPorterAvailable
61: 		    event IsPorterAvailableStatusUpdate(bool isPorterAvailable);

// @audit missing validatorAddress, isActive
64: 		    event ValidatorStatusUpdate(address indexed validatorAddress, bool isActive);

// @audit missing oldPendingAdmin, newPendingAdmin
68: 		    event NewPendingAdmin(address indexed oldPendingAdmin, address indexed newPendingAdmin);

// @audit missing oldAdmin, newAdmin
71: 		    event NewAdmin(address indexed oldAdmin, address indexed newAdmin);

// @audit missing oldPriorityTxMaxGasLimit, newPriorityTxMaxGasLimit
74: 		    event NewPriorityTxMaxGasLimit(uint256 oldPriorityTxMaxGasLimit, uint256 newPriorityTxMaxGasLimit);

// @audit missing oldFeeParams, newFeeParams
77: 		    event NewFeeParams(FeeParams oldFeeParams, FeeParams newFeeParams);

// @audit missing validiumMode
80: 		    event ValidiumModeStatusUpdate(PubdataPricingMode validiumMode);

// @audit missing oldNominator, oldDenominator, newNominator, newDenominator
83: 		    event NewBaseTokenMultiplier(

// @audit missing diamondCut
91: 		    event ExecuteUpgrade(Diamond.DiamondCutData diamondCut);

94: 		    event Freeze();

97: 		    event Unfreeze();
```
[[61](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L61), [64](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L64), [68](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L68), [71](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L71), [74](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L74), [77](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L77), [80](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L80), [83](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L83), [91](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L91), [94](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L94), [97](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L97)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol

// @audit missing diamondCut, proposalId, proposalSalt
17: 		    event ProposeTransparentUpgrade(
```
[[17](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol#L17)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol

// @audit missing facetCuts, initAddress, initCalldata
24: 		    event DiamondCut(FacetCut[] facetCuts, address initAddress, bytes initCalldata);
```
[[24](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L24)]



```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol

// @audit missing l1Sender, l2Receiver, l2Token, amount
7: 		    event FinalizeDeposit(

// @audit missing l2Sender, l1Receiver, l2Token, amount
14: 		    event WithdrawalInitiated(

// @audit missing amount
22: 		    event BaseTokenReceived(uint256 amount);
```
[[7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol#L7), [14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol#L14), [22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol#L22)]



```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol

// @audit missing l1Token, name, symbol, decimals
6: 		    event BridgeInitialize(address indexed l1Token, string name, string symbol, uint8 decimals);

// @audit missing _account, _amount
8: 		    event BridgeMint(address indexed _account, uint256 _amount);

// @audit missing _account, _amount
10: 		    event BridgeBurn(address indexed _account, uint256 _amount);
```
[[6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol#L6), [8](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol#L8), [10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol#L10)]

</details>

---

### [N-107] Missing NatSpec from modifiers definitions

Consider adding some comments on modifier declarations to explain what they are supposed to do: this will help for future code reviews.

*There are 12 instances of this issue.*

<details>
<summary>Expand findings</summary>


```solidity
File: code/system-contracts/contracts/AccountCodeStorage.sol

25: 		    modifier onlyDeployer() {
```
[[25](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L25)]



```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

28: 		    modifier onlySelf() {
```
[[28](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L28)]



```solidity
File: code/system-contracts/contracts/KnownCodesStorage.sol

19: 		    modifier onlyCompressor() {
```
[[19](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/KnownCodesStorage.sol#L19)]



```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

45: 		    modifier onlyOwnerOrAdmin() {
```
[[45](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L45)]



```solidity
File: code/contracts/ethereum/contracts/common/ReentrancyGuard.sol

41: 		    modifier reentrancyGuardInitializer() {
```
[[41](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/ReentrancyGuard.sol#L41)]



```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

129: 		    modifier onlyBridge() {

134: 		    modifier onlyNextVersion(uint8 _version) {
```
[[129](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L129), [134](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L134)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol

26: 		    modifier onlyStateTransitionManager() {

31: 		    modifier onlyBridgehub() {

36: 		    modifier onlyAdminOrStateTransitionManager() {

44: 		    modifier onlyValidatorOrStateTransitionManager() {

52: 		    modifier onlyBaseTokenBridge() {
```
[[26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L26), [31](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L31), [36](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L36), [44](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L44), [52](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L52)]

</details>

---

### [N-108] Missing NatSpec `@dev` from modifier declaration

Some modifiers have an incomplete NatSpec: add a `@dev` notation to describe the modifier to improve the code documentation.

*There are 29 instances of this issue.*

<details>
<summary>Expand findings</summary>


```solidity
File: code/system-contracts/contracts/AccountCodeStorage.sol

25: 		    modifier onlyDeployer() {
```
[[25](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L25)]



```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

28: 		    modifier onlySelf() {
```
[[28](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L28)]



```solidity
File: code/system-contracts/contracts/KnownCodesStorage.sol

19: 		    modifier onlyCompressor() {
```
[[19](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/KnownCodesStorage.sol#L19)]



```solidity
File: code/system-contracts/contracts/interfaces/ISystemContract.sol

20: 		    modifier onlySystemCall() {

30: 		    modifier onlyCallFromSystemContract() {

40: 		    modifier onlyCallFrom(address caller) {

47: 		    modifier onlyCallFromBootloader() {

54: 		    modifier onlyCallFromForceDeployer() {
```
[[20](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContract.sol#L20), [30](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContract.sol#L30), [40](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContract.sol#L40), [47](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContract.sol#L47), [54](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContract.sol#L54)]



```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

68: 		    modifier onlyBridgehub() {

74: 		    modifier onlyBridgehubOrEra(uint256 _chainId) {

83: 		    modifier onlyLegacyBridge() {
```
[[68](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L68), [74](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L74), [83](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L83)]



```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

45: 		    modifier onlyOwnerOrAdmin() {
```
[[45](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L45)]



```solidity
File: code/contracts/ethereum/contracts/common/ReentrancyGuard.sol

41: 		    modifier reentrancyGuardInitializer() {
```
[[41](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/ReentrancyGuard.sol#L41)]



```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

58: 		    modifier onlySelf() {

64: 		    modifier onlySecurityCouncil() {

70: 		    modifier onlyOwnerOrSecurityCouncil() {
```
[[58](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L58), [64](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L64), [70](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L70)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

63: 		    modifier onlyBridgehub() {

69: 		    modifier onlyOwnerOrAdmin() {
```
[[63](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L63), [69](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L69)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

61: 		    modifier onlyChainAdmin(uint256 _chainId) {

67: 		    modifier onlyValidator(uint256 _chainId) {
```
[[61](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L61), [67](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L67)]



```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

129: 		    modifier onlyBridge() {

134: 		    modifier onlyNextVersion(uint8 _version) {
```
[[129](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L129), [134](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L134)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol

15: 		    modifier onlyAdmin() {

21: 		    modifier onlyValidator() {

26: 		    modifier onlyStateTransitionManager() {

31: 		    modifier onlyBridgehub() {

36: 		    modifier onlyAdminOrStateTransitionManager() {

44: 		    modifier onlyValidatorOrStateTransitionManager() {

52: 		    modifier onlyBaseTokenBridge() {
```
[[15](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L15), [21](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L21), [26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L26), [31](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L31), [36](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L36), [44](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L44), [52](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L52)]

</details>

---

### [N-109] Missing NatSpec `@notice` from modifier declaration

Some modifiers have an incomplete NatSpec: add a `@notice` notation to describe the modifier to improve the code documentation.

*There are 15 instances of this issue.*

<details>
<summary>Expand findings</summary>


```solidity
File: code/system-contracts/contracts/AccountCodeStorage.sol

25: 		    modifier onlyDeployer() {
```
[[25](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L25)]



```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

28: 		    modifier onlySelf() {
```
[[28](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L28)]



```solidity
File: code/system-contracts/contracts/DefaultAccount.sol

28: 		    modifier ignoreNonBootloader() {

45: 		    modifier ignoreInDelegateCall() {
```
[[28](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L28), [45](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L45)]



```solidity
File: code/system-contracts/contracts/KnownCodesStorage.sol

19: 		    modifier onlyCompressor() {
```
[[19](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/KnownCodesStorage.sol#L19)]



```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

45: 		    modifier onlyOwnerOrAdmin() {
```
[[45](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L45)]



```solidity
File: code/contracts/ethereum/contracts/common/ReentrancyGuard.sol

41: 		    modifier reentrancyGuardInitializer() {

68: 		    modifier nonReentrant() {
```
[[41](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/ReentrancyGuard.sol#L41), [68](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/ReentrancyGuard.sol#L68)]



```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

129: 		    modifier onlyBridge() {

134: 		    modifier onlyNextVersion(uint8 _version) {
```
[[129](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L129), [134](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L134)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol

26: 		    modifier onlyStateTransitionManager() {

31: 		    modifier onlyBridgehub() {

36: 		    modifier onlyAdminOrStateTransitionManager() {

44: 		    modifier onlyValidatorOrStateTransitionManager() {

52: 		    modifier onlyBaseTokenBridge() {
```
[[26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L26), [31](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L31), [36](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L36), [44](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L44), [52](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L52)]

</details>

---

### [N-110] Missing NatSpec `@param` from modifier declaration

Some modifiers have an incomplete NatSpec: add a `@param` notation to describe the modifier parameters to improve the code documentation.

*There are 32 instances of this issue.*

<details>
<summary>Expand findings</summary>


```solidity
File: code/system-contracts/contracts/AccountCodeStorage.sol

25: 		    modifier onlyDeployer() {
```
[[25](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L25)]



```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

28: 		    modifier onlySelf() {
```
[[28](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L28)]



```solidity
File: code/system-contracts/contracts/DefaultAccount.sol

28: 		    modifier ignoreNonBootloader() {

45: 		    modifier ignoreInDelegateCall() {
```
[[28](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L28), [45](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L45)]



```solidity
File: code/system-contracts/contracts/KnownCodesStorage.sol

19: 		    modifier onlyCompressor() {
```
[[19](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/KnownCodesStorage.sol#L19)]



```solidity
File: code/system-contracts/contracts/interfaces/ISystemContract.sol

20: 		    modifier onlySystemCall() {

30: 		    modifier onlyCallFromSystemContract() {

// @audit missing caller
40: 		    modifier onlyCallFrom(address caller) {

47: 		    modifier onlyCallFromBootloader() {

54: 		    modifier onlyCallFromForceDeployer() {
```
[[20](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContract.sol#L20), [30](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContract.sol#L30), [40](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContract.sol#L40), [47](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContract.sol#L47), [54](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContract.sol#L54)]



```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

68: 		    modifier onlyBridgehub() {

// @audit missing _chainId
74: 		    modifier onlyBridgehubOrEra(uint256 _chainId) {

83: 		    modifier onlyLegacyBridge() {
```
[[68](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L68), [74](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L74), [83](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L83)]



```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

45: 		    modifier onlyOwnerOrAdmin() {
```
[[45](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L45)]



```solidity
File: code/contracts/ethereum/contracts/common/ReentrancyGuard.sol

41: 		    modifier reentrancyGuardInitializer() {

68: 		    modifier nonReentrant() {
```
[[41](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/ReentrancyGuard.sol#L41), [68](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/ReentrancyGuard.sol#L68)]



```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

58: 		    modifier onlySelf() {

64: 		    modifier onlySecurityCouncil() {

70: 		    modifier onlyOwnerOrSecurityCouncil() {
```
[[58](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L58), [64](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L64), [70](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L70)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

63: 		    modifier onlyBridgehub() {

69: 		    modifier onlyOwnerOrAdmin() {
```
[[63](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L63), [69](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L69)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

// @audit missing _chainId
61: 		    modifier onlyChainAdmin(uint256 _chainId) {

// @audit missing _chainId
67: 		    modifier onlyValidator(uint256 _chainId) {
```
[[61](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L61), [67](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L67)]



```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

129: 		    modifier onlyBridge() {

// @audit missing _version
134: 		    modifier onlyNextVersion(uint8 _version) {
```
[[129](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L129), [134](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L134)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol

15: 		    modifier onlyAdmin() {

21: 		    modifier onlyValidator() {

26: 		    modifier onlyStateTransitionManager() {

31: 		    modifier onlyBridgehub() {

36: 		    modifier onlyAdminOrStateTransitionManager() {

44: 		    modifier onlyValidatorOrStateTransitionManager() {

52: 		    modifier onlyBaseTokenBridge() {
```
[[15](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L15), [21](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L21), [26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L26), [31](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L31), [36](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L36), [44](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L44), [52](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L52)]

</details>

---

### [N-111] Missing NatSpec from function definitions

Some functions miss a NatSpec, which should be a [best practice](https://docs.soliditylang.org/en/latest/natspec-format.html) to add as a documentation.

Even if Natspec for internal and private function is not parsed (but this may change in the future, according to the official docs), it still helps while reviewing the codebase.

*There are 214 instances of this issue.*

<details>
<summary>Expand findings</summary>


```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

258: 		    function _nonSystemDeployOnAddress(
```
[[258](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L258)]



```solidity
File: code/system-contracts/contracts/DefaultAccount.sol

220: 		    fallback() external payable ignoreInDelegateCall {

227: 		    receive() external payable {
```
[[220](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L220), [227](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L227)]



```solidity
File: code/system-contracts/contracts/EmptyContract.sol

11: 		    fallback() external payable {}

13: 		    receive() external payable {}
```
[[11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/EmptyContract.sol#L11), [13](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/EmptyContract.sol#L13)]



```solidity
File: code/system-contracts/contracts/L1Messenger.sol

50: 		    function keccakGasCost(uint256 _length) internal pure returns (uint256) {

61: 		    function sha256GasCost(uint256 _length) internal pure returns (uint256) {
```
[[50](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L50), [61](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L61)]



```solidity
File: code/system-contracts/contracts/SystemContext.sol

117: 		    function getCurrentPubdataSpent() public view returns (uint256) {

122: 		    function getCurrentPubdataCost() external view returns (uint256) {

482: 		    function incrementTxNumberInBatch() external onlyCallFromBootloader {

486: 		    function resetTxNumberInBatch() external onlyCallFromBootloader {
```
[[117](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L117), [122](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L122), [482](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L482), [486](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L486)]



```solidity
File: code/contracts/zksync/contracts/SystemContractsCaller.sol

27: 		    function safeCastToU32(uint256 _x) internal pure returns (uint32) {

37: 		    function systemCall(uint32 gasLimit, address to, uint256 value, bytes memory data) internal returns (bool success) {

76: 		    function systemCallWithReturndata(

95: 		    function getFarCallABI(

121: 		    function getFarCallABIWithEmptyFatPointer(
```
[[27](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/SystemContractsCaller.sol#L27), [37](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/SystemContractsCaller.sol#L37), [76](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/SystemContractsCaller.sol#L76), [95](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/SystemContractsCaller.sol#L95), [121](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/SystemContractsCaller.sol#L121)]



```solidity
File: code/system-contracts/contracts/interfaces/IAccount.sol

26: 		    function executeTransaction(

34: 		    function executeTransactionFromOutside(Transaction calldata _transaction) external payable;

36: 		    function payForTransaction(

42: 		    function prepareForPaymaster(
```
[[26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IAccount.sol#L26), [34](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IAccount.sol#L34), [36](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IAccount.sol#L36), [42](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IAccount.sol#L42)]



```solidity
File: code/system-contracts/contracts/interfaces/IAccountCodeStorage.sol

6: 		    function storeAccountConstructingCodeHash(address _address, bytes32 _hash) external;

8: 		    function storeAccountConstructedCodeHash(address _address, bytes32 _hash) external;

10: 		    function markAccountCodeHashAsConstructed(address _address) external;

12: 		    function getRawCodeHash(address _address) external view returns (bytes32 codeHash);

14: 		    function getCodeHash(uint256 _input) external view returns (bytes32 codeHash);

16: 		    function getCodeSize(uint256 _input) external view returns (uint256 codeSize);
```
[[6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IAccountCodeStorage.sol#L6), [8](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IAccountCodeStorage.sol#L8), [10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IAccountCodeStorage.sol#L10), [12](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IAccountCodeStorage.sol#L12), [14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IAccountCodeStorage.sol#L14), [16](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IAccountCodeStorage.sol#L16)]



```solidity
File: code/system-contracts/contracts/interfaces/IBaseToken.sol

6: 		    function balanceOf(uint256) external view returns (uint256);

8: 		    function transferFromTo(address _from, address _to, uint256 _amount) external;

10: 		    function totalSupply() external view returns (uint256);

12: 		    function name() external pure returns (string memory);

14: 		    function symbol() external pure returns (string memory);

16: 		    function decimals() external pure returns (uint8);

18: 		    function mint(address _account, uint256 _amount) external;

20: 		    function withdraw(address _l1Receiver) external payable;

22: 		    function withdrawWithMessage(address _l1Receiver, bytes calldata _additionalData) external payable;
```
[[6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBaseToken.sol#L6), [8](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBaseToken.sol#L8), [10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBaseToken.sol#L10), [12](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBaseToken.sol#L12), [14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBaseToken.sol#L14), [16](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBaseToken.sol#L16), [18](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBaseToken.sol#L18), [20](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBaseToken.sol#L20), [22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBaseToken.sol#L22)]



```solidity
File: code/system-contracts/contracts/interfaces/IBootloaderUtilities.sol

8: 		    function getTransactionHashes(
```
[[8](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBootloaderUtilities.sol#L8)]



```solidity
File: code/system-contracts/contracts/interfaces/IComplexUpgrader.sol

11: 		    function upgrade(address _delegateTo, bytes calldata _calldata) external payable;
```
[[11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IComplexUpgrader.sol#L11)]



```solidity
File: code/system-contracts/contracts/interfaces/ICompressor.sol

19: 		    function publishCompressedBytecode(

24: 		    function verifyCompressedStateDiffs(
```
[[19](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ICompressor.sol#L19), [24](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ICompressor.sol#L24)]



```solidity
File: code/system-contracts/contracts/interfaces/IContractDeployer.sol

43: 		    function getNewAddressCreate2(

50: 		    function getNewAddressCreate(address _sender, uint256 _senderNonce) external pure returns (address newAddress);

52: 		    function create2(

58: 		    function create2Account(
```
[[43](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L43), [50](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L50), [52](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L52), [58](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L58)]



```solidity
File: code/system-contracts/contracts/interfaces/IImmutableSimulator.sol

11: 		    function getImmutable(address _dest, uint256 _index) external view returns (bytes32);

13: 		    function setImmutables(address _dest, ImmutableData[] calldata _immutables) external;
```
[[11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IImmutableSimulator.sol#L11), [13](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IImmutableSimulator.sol#L13)]



```solidity
File: code/system-contracts/contracts/interfaces/IKnownCodesStorage.sol

14: 		    function markFactoryDeps(bool _shouldSendToL1, bytes32[] calldata _hashes) external;

16: 		    function markBytecodeAsPublished(bytes32 _bytecodeHash) external;

18: 		    function getMarker(bytes32 _hash) external view returns (uint256);
```
[[14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IKnownCodesStorage.sol#L14), [16](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IKnownCodesStorage.sol#L16), [18](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IKnownCodesStorage.sol#L18)]



```solidity
File: code/system-contracts/contracts/interfaces/IL1Messenger.sol

49: 		    function sendToL1(bytes memory _message) external returns (bytes32);

51: 		    function sendL2ToL1Log(bool _isService, bytes32 _key, bytes32 _value) external returns (uint256 logIdInMerkleTree);

54: 		    function requestBytecodeL1Publication(bytes32 _bytecodeHash) external;
```
[[49](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL1Messenger.sol#L49), [51](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL1Messenger.sol#L51), [54](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL1Messenger.sol#L54)]



```solidity
File: code/system-contracts/contracts/interfaces/IL2StandardToken.sol

10: 		    function bridgeMint(address _account, uint256 _amount) external;

12: 		    function bridgeBurn(address _account, uint256 _amount) external;

14: 		    function l1Address() external view returns (address);

16: 		    function l2Bridge() external view returns (address);
```
[[10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL2StandardToken.sol#L10), [12](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL2StandardToken.sol#L12), [14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL2StandardToken.sol#L14), [16](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL2StandardToken.sol#L16)]



```solidity
File: code/system-contracts/contracts/interfaces/IMailbox.sol

6: 		    function finalizeEthWithdrawal(
```
[[6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IMailbox.sol#L6)]



```solidity
File: code/system-contracts/contracts/interfaces/IPaymasterFlow.sol

13: 		    function general(bytes calldata input) external;

15: 		    function approvalBased(address _token, uint256 _minAllowance, bytes calldata _innerInput) external;
```
[[13](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IPaymasterFlow.sol#L13), [15](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IPaymasterFlow.sol#L15)]



```solidity
File: code/system-contracts/contracts/interfaces/ISystemContext.sol

30: 		    function chainId() external view returns (uint256);

32: 		    function origin() external view returns (address);

34: 		    function gasPrice() external view returns (uint256);

36: 		    function blockGasLimit() external view returns (uint256);

38: 		    function coinbase() external view returns (address);

40: 		    function difficulty() external view returns (uint256);

42: 		    function baseFee() external view returns (uint256);

44: 		    function txNumberInBlock() external view returns (uint16);

46: 		    function getBlockHashEVM(uint256 _block) external view returns (bytes32);

48: 		    function getBatchHash(uint256 _batchNumber) external view returns (bytes32 hash);

50: 		    function getBlockNumber() external view returns (uint128);

52: 		    function getBlockTimestamp() external view returns (uint128);

54: 		    function getBatchNumberAndTimestamp() external view returns (uint128 blockNumber, uint128 blockTimestamp);

56: 		    function getL2BlockNumberAndTimestamp() external view returns (uint128 blockNumber, uint128 blockTimestamp);

58: 		    function gasPerPubdataByte() external view returns (uint256 gasPerPubdataByte);

60: 		    function getCurrentPubdataSpent() external view returns (uint256 currentPubdataSpent);
```
[[30](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L30), [32](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L32), [34](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L34), [36](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L36), [38](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L38), [40](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L40), [42](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L42), [44](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L44), [46](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L46), [48](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L48), [50](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L50), [52](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L52), [54](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L54), [56](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L56), [58](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L58), [60](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L60)]



```solidity
File: code/system-contracts/contracts/interfaces/ISystemContextDeprecated.sol

11: 		    function currentBlockInfo() external view returns (uint256);

13: 		    function getBlockNumberAndTimestamp() external view returns (uint256 blockNumber, uint256 blockTimestamp);

15: 		    function blockHash(uint256 _blockNumber) external view returns (bytes32 hash);
```
[[11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContextDeprecated.sol#L11), [13](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContextDeprecated.sol#L13), [15](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContextDeprecated.sol#L15)]



```solidity
File: code/system-contracts/contracts/libraries/RLPEncoder.sol

11: 		    function encodeAddress(address _val) internal pure returns (bytes memory encoded) {

24: 		    function encodeUint256(uint256 _val) internal pure returns (bytes memory encoded) {

60: 		    function _encodeLength(uint64 _len, uint256 _offset) private pure returns (bytes memory encoded) {
```
[[11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/RLPEncoder.sol#L11), [24](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/RLPEncoder.sol#L24), [60](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/RLPEncoder.sol#L60)]



```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

405: 		    function totalRequiredBalance(Transaction calldata _transaction) internal pure returns (uint256 requiredBalance) {
```
[[405](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L405)]



```solidity
File: code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol

19: 		    function readUint16(bytes calldata _bytes, uint256 _start) internal pure returns (uint16 result) {

26: 		    function readUint32(bytes calldata _bytes, uint256 _start) internal pure returns (uint32 result) {

33: 		    function readUint64(bytes calldata _bytes, uint256 _start) internal pure returns (uint64 result) {

40: 		    function readBytes32(bytes calldata _bytes, uint256 _start) internal pure returns (bytes32 result) {

46: 		    function readUint256(bytes calldata _bytes, uint256 _start) internal pure returns (uint256 result) {
```
[[19](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol#L19), [26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol#L26), [33](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol#L33), [40](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol#L40), [46](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol#L46)]



```solidity
File: code/system-contracts/contracts/libraries/Utils.sol

20: 		    function safeCastToU128(uint256 _x) internal pure returns (uint128) {

26: 		    function safeCastToU32(uint256 _x) internal pure returns (uint32) {

32: 		    function safeCastToU24(uint256 _x) internal pure returns (uint24) {
```
[[20](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L20), [26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L26), [32](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L32)]



```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

137: 		    function receiveEth(uint256 _chainId) external payable {

487: 		    function _parseL2WithdrawalMessage(
```
[[137](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L137), [487](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L487)]



```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

325: 		    function _actualRefundRecipient(address _refundRecipient) internal view returns (address _recipient) {
```
[[325](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L325)]



```solidity
File: code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol

59: 		    function stateTransitionManagerIsRegistered(address _stateTransitionManager) external view returns (bool);

61: 		    function stateTransitionManager(uint256 _chainId) external view returns (address);

63: 		    function tokenIsRegistered(address _baseToken) external view returns (bool);

65: 		    function baseToken(uint256 _chainId) external view returns (address);

67: 		    function sharedBridge() external view returns (IL1SharedBridge);

69: 		    function getStateTransition(uint256 _chainId) external view returns (address);

73: 		    function proveL2MessageInclusion(

81: 		    function proveL2LogInclusion(

89: 		    function proveL1ToL2TransactionStatus(

99: 		    function requestL2TransactionDirect(

103: 		    function requestL2TransactionTwoBridges(

107: 		    function l2TransactionBaseCost(

116: 		    function createNewChain(

125: 		    function addStateTransitionManager(address _stateTransitionManager) external;

127: 		    function removeStateTransitionManager(address _stateTransitionManager) external;

129: 		    function addToken(address _token) external;

131: 		    function setSharedBridge(address _sharedBridge) external;
```
[[59](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L59), [61](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L61), [63](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L63), [65](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L65), [67](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L67), [69](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L69), [73](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L73), [81](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L81), [89](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L89), [99](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L99), [103](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L103), [107](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L107), [116](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L116), [125](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L125), [127](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L127), [129](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L129), [131](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L131)]



```solidity
File: code/contracts/ethereum/contracts/common/ReentrancyGuard.sol

46: 		    function _initializeReentrancyGuard() private {
```
[[46](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/ReentrancyGuard.sol#L46)]



```solidity
File: code/contracts/ethereum/contracts/governance/IGovernance.sol

41: 		    function isOperation(bytes32 _id) external view returns (bool);

43: 		    function isOperationPending(bytes32 _id) external view returns (bool);

45: 		    function isOperationReady(bytes32 _id) external view returns (bool);

47: 		    function isOperationDone(bytes32 _id) external view returns (bool);

49: 		    function getOperationState(bytes32 _id) external view returns (OperationState);

51: 		    function scheduleTransparent(Operation calldata _operation, uint256 _delay) external;

53: 		    function scheduleShadow(bytes32 _id, uint256 _delay) external;

55: 		    function cancel(bytes32 _id) external;

57: 		    function execute(Operation calldata _operation) external payable;

59: 		    function executeInstant(Operation calldata _operation) external payable;

61: 		    function hashOperation(Operation calldata _operation) external pure returns (bytes32);

63: 		    function updateDelay(uint256 _newDelay) external;

65: 		    function updateSecurityCouncil(address _newSecurityCouncil) external;
```
[[41](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L41), [43](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L43), [45](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L45), [47](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L47), [49](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L49), [51](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L51), [53](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L53), [55](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L55), [57](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L57), [59](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L59), [61](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L61), [63](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L63), [65](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L65)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol

43: 		    function bridgehub() external view returns (address);

53: 		    function stateTransition(uint256 _chainId) external view returns (address);

55: 		    function storedBatchZero() external view returns (bytes32);

57: 		    function initialCutHash() external view returns (bytes32);

59: 		    function genesisUpgrade() external view returns (address);

61: 		    function upgradeCutHash(uint256 _protocolVersion) external view returns (bytes32);

63: 		    function protocolVersion() external view returns (uint256);

65: 		    function initialize(StateTransitionManagerInitializeData calldata _initalizeData) external;

67: 		    function setInitialCutHash(Diamond.DiamondCutData calldata _diamondCut) external;

69: 		    function setValidatorTimelock(address _validatorTimelock) external;

71: 		    function getChainAdmin(uint256 _chainId) external view returns (address);

82: 		    function registerAlreadyDeployedStateTransition(uint256 _chainId, address _stateTransitionContract) external;

84: 		    function setNewVersionUpgrade(

90: 		    function setUpgradeDiamondCut(Diamond.DiamondCutData calldata _cutData, uint256 _oldProtocolVersion) external;

92: 		    function freezeChain(uint256 _chainId) external;

94: 		    function unfreezeChain(uint256 _chainId) external;
```
[[43](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L43), [53](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L53), [55](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L55), [57](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L57), [59](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L59), [61](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L61), [63](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L63), [65](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L65), [67](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L67), [69](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L69), [71](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L71), [82](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L82), [84](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L84), [90](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L90), [92](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L92), [94](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L94)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

74: 		    function getChainAdmin(uint256 _chainId) external view override returns (address) {

230: 		    function registerAlreadyDeployedStateTransition(
```
[[74](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L74), [230](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L230)]



```solidity
File: code/contracts/ethereum/contracts/upgrades/IDefaultUpgrade.sol

8: 		    function upgrade(ProposedUpgrade calldata _upgrade) external returns (bytes32);
```
[[8](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/IDefaultUpgrade.sol#L8)]



```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

159: 		    function name() public view override returns (string memory) {

165: 		    function symbol() public view override returns (string memory) {

171: 		    function decimals() public view override returns (uint8) {
```
[[159](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L159), [165](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L165), [171](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L171)]



```solidity
File: code/contracts/zksync/contracts/interfaces/IPaymasterFlow.sol

14: 		    function general(bytes calldata input) external;

16: 		    function approvalBased(address _token, uint256 _minAllowance, bytes calldata _innerInput) external;
```
[[14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/interfaces/IPaymasterFlow.sol#L14), [16](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/interfaces/IPaymasterFlow.sol#L16)]



```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol

24: 		    function isWithdrawalFinalized(uint256 _l2BatchNumber, uint256 _l2MessageIndex) external view returns (bool);

26: 		    function deposit(

35: 		    function deposit(

43: 		    function claimFailedDeposit(

53: 		    function finalizeWithdrawal(

61: 		    function l2TokenAddress(address _l1Token) external view returns (address);

63: 		    function sharedBridge() external view returns (IL1SharedBridge);

65: 		    function l2TokenBeacon() external view returns (address);

67: 		    function l2Bridge() external view returns (address);

69: 		    function depositAmount(

75: 		    function tranferTokenToSharedBridge(address _token, uint256 _amount) external;
```
[[24](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L24), [26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L26), [35](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L35), [43](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L43), [53](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L53), [61](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L61), [63](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L63), [65](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L65), [67](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L67), [69](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L69), [75](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L75)]



```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol

58: 		    function isWithdrawalFinalized(

64: 		    function depositLegacyErc20Bridge(

74: 		    function claimFailedDepositLegacyErc20Bridge(

85: 		    function claimFailedDeposit(

97: 		    function finalizeWithdrawalLegacyErc20Bridge(

105: 		    function finalizeWithdrawal(

114: 		    function l1WethAddress() external view returns (address);

116: 		    function bridgehub() external view returns (IBridgehub);

118: 		    function legacyBridge() external view returns (IL1ERC20Bridge);

120: 		    function l2BridgeAddress(uint256 _chainId) external view returns (address);

122: 		    function depositHappened(uint256 _chainId, bytes32 _l2TxHash) external view returns (bytes32);

128: 		    function bridgehubDeposit(

135: 		    function bridgehubDepositBaseToken(

142: 		    function bridgehubConfirmL2Transaction(uint256 _chainId, bytes32 _txDataHash, bytes32 _txHash) external;

144: 		    function receiveEth(uint256 _chainId) external payable;
```
[[58](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L58), [64](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L64), [74](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L74), [85](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L85), [97](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L97), [105](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L105), [114](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L114), [116](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L116), [118](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L118), [120](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L120), [122](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L122), [128](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L128), [135](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L135), [142](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L142), [144](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L144)]



```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL2Bridge.sol

7: 		    function finalizeDeposit(

15: 		    function withdraw(address _l1Receiver, address _l2Token, uint256 _amount) external;

17: 		    function l1TokenAddress(address _l2Token) external view returns (address);

19: 		    function l2TokenAddress(address _l1Token) external view returns (address);

21: 		    function l1Bridge() external view returns (address);
```
[[7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL2Bridge.sol#L7), [15](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL2Bridge.sol#L15), [17](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL2Bridge.sol#L17), [19](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL2Bridge.sol#L19), [21](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL2Bridge.sol#L21)]



```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IWETH9.sol

5: 		    function deposit() external payable;

7: 		    function withdraw(uint256 wad) external;
```
[[5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IWETH9.sol#L5), [7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IWETH9.sol#L7)]



```solidity
File: code/contracts/ethereum/contracts/common/libraries/UncheckedMath.sol

11: 		    function uncheckedInc(uint256 _number) internal pure returns (uint256) {

17: 		    function uncheckedAdd(uint256 _lhs, uint256 _rhs) internal pure returns (uint256) {
```
[[11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/UncheckedMath.sol#L11), [17](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/UncheckedMath.sol#L17)]



```solidity
File: code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol

19: 		    function readUint32(bytes memory _bytes, uint256 _start) internal pure returns (uint32 result, uint256 offset) {

26: 		    function readAddress(bytes memory _bytes, uint256 _start) internal pure returns (address result, uint256 offset) {

33: 		    function readUint256(bytes memory _bytes, uint256 _start) internal pure returns (uint256 result, uint256 offset) {

40: 		    function readBytes32(bytes memory _bytes, uint256 _start) internal pure returns (bytes32 result, uint256 offset) {
```
[[19](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol#L19), [26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol#L26), [33](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol#L33), [40](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol#L40)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol

45: 		    function upgradeChainFromVersion(uint256 _protocolVersion, Diamond.DiamondCutData calldata _cutData) external;
```
[[45](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L45)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol

62: 		    function initialize(InitializeData calldata _initData) external returns (bytes32);
```
[[62](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol#L62)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol

98: 		    function bridgehubRequestL2Transaction(
```
[[98](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L98)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/l2-deps/ISystemContext.sol

5: 		    function setChainId(uint256 _newChainId) external;
```
[[5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/l2-deps/ISystemContext.sol#L5)]



```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL1ERC20Bridge.sol

9: 		    function finalizeWithdrawal(
```
[[9](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L9)]



```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL1SharedBridge.sol

9: 		    function finalizeWithdrawal(
```
[[9](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL1SharedBridge.sol#L9)]



```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol

24: 		    function finalizeDeposit(

32: 		    function withdraw(address _l1Receiver, address _l2Token, uint256 _amount) external;

34: 		    function l1TokenAddress(address _l2Token) external view returns (address);

36: 		    function l2TokenAddress(address _l1Token) external view returns (address);

38: 		    function l1Bridge() external view returns (address);
```
[[24](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol#L24), [32](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol#L32), [34](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol#L34), [36](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol#L36), [38](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol#L38)]



```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol

12: 		    function bridgeMint(address _account, uint256 _amount) external;

14: 		    function bridgeBurn(address _account, uint256 _amount) external;

16: 		    function l1Address() external view returns (address);

18: 		    function l2Bridge() external view returns (address);
```
[[12](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol#L12), [14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol#L14), [16](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol#L16), [18](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol#L18)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol

89: 		    function setValidiumMode(PubdataPricingMode _validiumMode) external onlyAdmin {

100: 		    function upgradeChainFromVersion(
```
[[89](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L89), [100](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L100)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

215: 		    function _commitBatches(

349: 		    function _executeBatches(StoredBatchInfo[] calldata _batchesData) internal {

386: 		    function _proveBatches(

440: 		    function _verifyProof(uint256[] memory proofPublicInput, ProofInput calldata _proof) internal view {

481: 		    function _revertBatches(uint256 _newLastBatch) internal {

515: 		    function _batchPassThroughData(CommitBatchInfo calldata _batch) internal pure returns (bytes memory) {

525: 		    function _batchMetaParameters() internal view returns (bytes memory) {

537: 		    function _batchAuxiliaryOutput(
```
[[215](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L215), [349](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L349), [386](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L386), [440](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L440), [481](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L481), [515](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L515), [525](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L525), [537](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L537)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

228: 		    function _requestL2TransactionSender(

258: 		    function _requestL2Transaction(

289: 		    function _serializeL2Transaction(
```
[[228](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L228), [258](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L258), [289](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L289)]

</details>

---

### [N-112] Missing NatSpec `@dev` from function declaration

Some functions have an incomplete NatSpec: add a `@dev` notation to describe the function to improve the code documentation.

*There are 443 instances of this issue.*

<details>
<summary>Expand findings</summary>


```solidity
File: code/system-contracts/contracts/AccountCodeStorage.sol

54: 		    function markAccountCodeHashAsConstructed(address _address) external override onlyDeployer {

78: 		    function getRawCodeHash(address _address) public view override returns (bytes32 codeHash) {

89: 		    function getCodeHash(uint256 _input) external view override returns (bytes32) {

117: 		    function getCodeSize(uint256 _input) external view override returns (uint256 codeSize) {
```
[[54](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L54), [78](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L78), [89](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L89), [117](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L117)]



```solidity
File: code/system-contracts/contracts/BootloaderUtilities.sol

44: 		    function encodeLegacyTransactionHash(Transaction calldata _transaction) internal view returns (bytes32 txHash) {

139: 		    function encodeEIP2930TransactionHash(Transaction calldata _transaction) internal view returns (bytes32) {

229: 		    function encodeEIP1559TransactionHash(Transaction calldata _transaction) internal view returns (bytes32) {
```
[[44](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L44), [139](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L139), [229](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L229)]



```solidity
File: code/system-contracts/contracts/Compressor.sol

197: 		    function _decodeRawBytecode(

251: 		    function _sliceToUint256(bytes calldata _calldataSlice) internal pure returns (uint256 number) {
```
[[197](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L197), [251](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L251)]



```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

34: 		    function getAccountInfo(address _address) external view returns (AccountInfo memory info) {

40: 		    function extendedAccountVersion(address _address) public view returns (AccountAbstractionVersion) {

58: 		    function _storeAccountInfo(address _address, AccountInfo memory _newInfo) internal {

74: 		    function updateNonceOrdering(AccountNonceOrdering _nonceOrdering) external onlySystemCall {

95: 		    function getNewAddressCreate2(

115: 		    function getNewAddressCreate(

132: 		    function create2(

162: 		    function create2Account(

213: 		    function forceDeployOnAddress(ForceDeployment calldata _deployment, address _sender) external payable onlySelf {

258: 		    function _nonSystemDeployOnAddress(

283: 		    function _performDeployOnAddress(

301: 		    function _ensureBytecodeIsKnown(bytes32 _bytecodeHash) internal view {

309: 		    function _storeConstructingByteCodeHashOnAddress(address _newAddress, bytes32 _bytecodeHash) internal {

321: 		    function _constructContract(
```
[[34](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L34), [40](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L40), [58](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L58), [74](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L74), [95](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L95), [115](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L115), [132](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L132), [162](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L162), [213](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L213), [258](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L258), [283](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L283), [301](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L301), [309](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L309), [321](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L321)]



```solidity
File: code/system-contracts/contracts/DefaultAccount.sol

78: 		    function _validateTransaction(

131: 		    function _execute(Transaction calldata _transaction) internal {

159: 		    function _isValidSignature(bytes32 _hash, bytes memory _signature) internal view returns (bool) {

220: 		    fallback() external payable ignoreInDelegateCall {

227: 		    receive() external payable {
```
[[78](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L78), [131](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L131), [159](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L159), [220](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L220), [227](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L227)]



```solidity
File: code/system-contracts/contracts/EmptyContract.sol

11: 		    fallback() external payable {}

13: 		    receive() external payable {}
```
[[11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/EmptyContract.sol#L11), [13](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/EmptyContract.sol#L13)]



```solidity
File: code/system-contracts/contracts/ImmutableSimulator.sol

27: 		    function getImmutable(address _dest, uint256 _index) external view override returns (bytes32) {

34: 		    function setImmutables(address _dest, ImmutableData[] calldata _immutables) external override {
```
[[27](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ImmutableSimulator.sol#L27), [34](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ImmutableSimulator.sol#L34)]



```solidity
File: code/system-contracts/contracts/KnownCodesStorage.sol

27: 		    function markFactoryDeps(bool _shouldSendToL1, bytes32[] calldata _hashes) external onlyCallFromBootloader {

46: 		    function _markBytecodeAsPublished(bytes32 _bytecodeHash, bool _shouldSendToL1) internal {

65: 		    function getMarker(bytes32 _hash) public view override returns (uint256 marker) {
```
[[27](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/KnownCodesStorage.sol#L27), [46](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/KnownCodesStorage.sol#L46), [65](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/KnownCodesStorage.sol#L65)]



```solidity
File: code/system-contracts/contracts/L1Messenger.sol

50: 		    function keccakGasCost(uint256 _length) internal pure returns (uint256) {

61: 		    function sha256GasCost(uint256 _length) internal pure returns (uint256) {

94: 		    function _processL2ToL1Log(L2ToL1Log memory _l2ToL1Log) internal returns (uint256 logIdInMerkleTree) {

116: 		    function sendToL1(bytes calldata _message) external override returns (bytes32 hash) {
```
[[50](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L50), [61](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L61), [94](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L94), [116](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L116)]



```solidity
File: code/system-contracts/contracts/L2BaseToken.sol

72: 		    function withdraw(address _l1Receiver) external payable override {

85: 		    function withdrawWithMessage(address _l1Receiver, bytes memory _additionalData) external payable override {
```
[[72](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L2BaseToken.sol#L72), [85](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L2BaseToken.sol#L85)]



```solidity
File: code/system-contracts/contracts/NonceHolder.sol

46: 		    function getMinNonce(address _address) public view returns (uint256) {

65: 		    function increaseMinNonce(uint256 _value) public onlySystemCall returns (uint256 oldMinNonce) {

102: 		    function getValueUnderNonce(uint256 _key) public view returns (uint256) {

110: 		    function incrementMinNonceIfEquals(uint256 _expectedNonce) external onlySystemCall {

125: 		    function getDeploymentNonce(address _address) external view returns (uint256 deploymentNonce) {

135: 		    function incrementDeploymentNonce(address _address) external returns (uint256 prevDeploymentNonce) {

154: 		    function isNonceUsed(address _address, uint256 _nonce) public view returns (bool) {

179: 		    function _splitRawNonce(uint256 _rawMinNonce) internal pure returns (uint256 deploymentNonce, uint256 minNonce) {
```
[[46](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/NonceHolder.sol#L46), [65](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/NonceHolder.sol#L65), [102](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/NonceHolder.sol#L102), [110](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/NonceHolder.sol#L110), [125](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/NonceHolder.sol#L125), [135](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/NonceHolder.sol#L135), [154](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/NonceHolder.sol#L154), [179](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/NonceHolder.sol#L179)]



```solidity
File: code/system-contracts/contracts/SystemContext.sol

84: 		    function setChainId(uint256 _newChainId) external onlyCallFromForceDeployer {

99: 		    function setTxOrigin(address _newOrigin) external onlyCallFromBootloader {

105: 		    function setGasPrice(uint256 _gasPrice) external onlyCallFromBootloader {

117: 		    function getCurrentPubdataSpent() public view returns (uint256) {

122: 		    function getCurrentPubdataCost() external view returns (uint256) {

166: 		    function getBatchHash(uint256 _batchNumber) external view returns (bytes32 hash) {

172: 		    function getBatchNumberAndTimestamp() public view returns (uint128 batchNumber, uint128 batchTimestamp) {

180: 		    function getL2BlockNumberAndTimestamp() public view returns (uint128 blockNumber, uint128 blockTimestamp) {

205: 		    function _getLatest257L2blockHash(uint256 _block) internal view returns (bytes32) {

212: 		    function _setL2BlockHash(uint256 _block, bytes32 _hash) internal {

221: 		    function _calculateL2BlockHash(

233: 		    function _calculateLegacyL2BlockHash(uint128 _blockNumber) internal pure returns (bytes32) {

241: 		    function _upgradeL2Blocks(uint128 _l2BlockNumber, bytes32 _expectedPrevL2BlockHash, bool _isFirstInBatch) internal {

263: 		    function _setVirtualBlock(

314: 		    function _setNewL2BlockData(uint128 _l2BlockNumber, uint128 _l2BlockTimestamp, bytes32 _prevL2BlockHash) internal {

402: 		    function appendTransactionToCurrentL2Block(bytes32 _txHash) external onlyCallFromBootloader {

427: 		    function _ensureBatchConsistentWithL2Block(uint128 _newTimestamp) internal view {

482: 		    function incrementTxNumberInBatch() external onlyCallFromBootloader {

486: 		    function resetTxNumberInBatch() external onlyCallFromBootloader {
```
[[84](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L84), [99](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L99), [105](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L105), [117](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L117), [122](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L122), [166](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L166), [172](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L172), [180](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L180), [205](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L205), [212](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L212), [221](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L221), [233](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L233), [241](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L241), [263](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L263), [314](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L314), [402](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L402), [427](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L427), [482](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L482), [486](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L486)]



```solidity
File: code/contracts/zksync/contracts/ForceDeployUpgrader.sol

13: 		    function forceDeploy(IContractDeployer.ForceDeployment[] calldata _forceDeployments) external payable {
```
[[13](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/ForceDeployUpgrader.sol#L13)]



```solidity
File: code/contracts/zksync/contracts/L2ContractHelper.sol

22: 		    function sendToL1(bytes memory _message) external returns (bytes32);

47: 		    function forceDeployOnAddresses(ForceDeployment[] calldata _deployParams) external payable;

53: 		    function create2(bytes32 _salt, bytes32 _bytecodeHash, bytes calldata _input) external returns (address);

65: 		    function withdrawWithMessage(address _l1Receiver, bytes memory _additionalData) external payable;

90: 		    function sendMessageToL1(bytes memory _message) internal returns (bytes32) {

101: 		    function computeCreate2Address(
```
[[22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/L2ContractHelper.sol#L22), [47](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/L2ContractHelper.sol#L47), [53](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/L2ContractHelper.sol#L53), [65](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/L2ContractHelper.sol#L65), [90](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/L2ContractHelper.sol#L90), [101](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/L2ContractHelper.sol#L101)]



```solidity
File: code/contracts/zksync/contracts/SystemContractsCaller.sol

27: 		    function safeCastToU32(uint256 _x) internal pure returns (uint32) {

37: 		    function systemCall(uint32 gasLimit, address to, uint256 value, bytes memory data) internal returns (bool success) {

76: 		    function systemCallWithReturndata(

95: 		    function getFarCallABI(

121: 		    function getFarCallABIWithEmptyFatPointer(
```
[[27](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/SystemContractsCaller.sol#L27), [37](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/SystemContractsCaller.sol#L37), [76](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/SystemContractsCaller.sol#L76), [95](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/SystemContractsCaller.sol#L95), [121](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/SystemContractsCaller.sol#L121)]



```solidity
File: code/system-contracts/contracts/interfaces/IAccount.sol

26: 		    function executeTransaction(

34: 		    function executeTransactionFromOutside(Transaction calldata _transaction) external payable;

36: 		    function payForTransaction(

42: 		    function prepareForPaymaster(
```
[[26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IAccount.sol#L26), [34](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IAccount.sol#L34), [36](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IAccount.sol#L36), [42](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IAccount.sol#L42)]



```solidity
File: code/system-contracts/contracts/interfaces/IAccountCodeStorage.sol

6: 		    function storeAccountConstructingCodeHash(address _address, bytes32 _hash) external;

8: 		    function storeAccountConstructedCodeHash(address _address, bytes32 _hash) external;

10: 		    function markAccountCodeHashAsConstructed(address _address) external;

12: 		    function getRawCodeHash(address _address) external view returns (bytes32 codeHash);

14: 		    function getCodeHash(uint256 _input) external view returns (bytes32 codeHash);

16: 		    function getCodeSize(uint256 _input) external view returns (uint256 codeSize);
```
[[6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IAccountCodeStorage.sol#L6), [8](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IAccountCodeStorage.sol#L8), [10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IAccountCodeStorage.sol#L10), [12](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IAccountCodeStorage.sol#L12), [14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IAccountCodeStorage.sol#L14), [16](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IAccountCodeStorage.sol#L16)]



```solidity
File: code/system-contracts/contracts/interfaces/IBaseToken.sol

6: 		    function balanceOf(uint256) external view returns (uint256);

8: 		    function transferFromTo(address _from, address _to, uint256 _amount) external;

10: 		    function totalSupply() external view returns (uint256);

12: 		    function name() external pure returns (string memory);

14: 		    function symbol() external pure returns (string memory);

16: 		    function decimals() external pure returns (uint8);

18: 		    function mint(address _account, uint256 _amount) external;

20: 		    function withdraw(address _l1Receiver) external payable;

22: 		    function withdrawWithMessage(address _l1Receiver, bytes calldata _additionalData) external payable;
```
[[6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBaseToken.sol#L6), [8](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBaseToken.sol#L8), [10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBaseToken.sol#L10), [12](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBaseToken.sol#L12), [14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBaseToken.sol#L14), [16](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBaseToken.sol#L16), [18](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBaseToken.sol#L18), [20](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBaseToken.sol#L20), [22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBaseToken.sol#L22)]



```solidity
File: code/system-contracts/contracts/interfaces/IBootloaderUtilities.sol

8: 		    function getTransactionHashes(
```
[[8](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBootloaderUtilities.sol#L8)]



```solidity
File: code/system-contracts/contracts/interfaces/IComplexUpgrader.sol

11: 		    function upgrade(address _delegateTo, bytes calldata _calldata) external payable;
```
[[11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IComplexUpgrader.sol#L11)]



```solidity
File: code/system-contracts/contracts/interfaces/ICompressor.sol

19: 		    function publishCompressedBytecode(

24: 		    function verifyCompressedStateDiffs(
```
[[19](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ICompressor.sol#L19), [24](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ICompressor.sol#L24)]



```solidity
File: code/system-contracts/contracts/interfaces/IContractDeployer.sol

43: 		    function getNewAddressCreate2(

50: 		    function getNewAddressCreate(address _sender, uint256 _senderNonce) external pure returns (address newAddress);

52: 		    function create2(

58: 		    function create2Account(

84: 		    function getAccountInfo(address _address) external view returns (AccountInfo memory info);

87: 		    function updateAccountVersion(AccountAbstractionVersion _version) external;

90: 		    function updateNonceOrdering(AccountNonceOrdering _nonceOrdering) external;
```
[[43](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L43), [50](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L50), [52](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L52), [58](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L58), [84](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L84), [87](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L87), [90](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L90)]



```solidity
File: code/system-contracts/contracts/interfaces/IImmutableSimulator.sol

11: 		    function getImmutable(address _dest, uint256 _index) external view returns (bytes32);

13: 		    function setImmutables(address _dest, ImmutableData[] calldata _immutables) external;
```
[[11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IImmutableSimulator.sol#L11), [13](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IImmutableSimulator.sol#L13)]



```solidity
File: code/system-contracts/contracts/interfaces/IKnownCodesStorage.sol

14: 		    function markFactoryDeps(bool _shouldSendToL1, bytes32[] calldata _hashes) external;

16: 		    function markBytecodeAsPublished(bytes32 _bytecodeHash) external;

18: 		    function getMarker(bytes32 _hash) external view returns (uint256);
```
[[14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IKnownCodesStorage.sol#L14), [16](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IKnownCodesStorage.sol#L16), [18](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IKnownCodesStorage.sol#L18)]



```solidity
File: code/system-contracts/contracts/interfaces/IL1Messenger.sol

49: 		    function sendToL1(bytes memory _message) external returns (bytes32);

51: 		    function sendL2ToL1Log(bool _isService, bytes32 _key, bytes32 _value) external returns (uint256 logIdInMerkleTree);

54: 		    function requestBytecodeL1Publication(bytes32 _bytecodeHash) external;
```
[[49](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL1Messenger.sol#L49), [51](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL1Messenger.sol#L51), [54](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL1Messenger.sol#L54)]



```solidity
File: code/system-contracts/contracts/interfaces/IL2StandardToken.sol

10: 		    function bridgeMint(address _account, uint256 _amount) external;

12: 		    function bridgeBurn(address _account, uint256 _amount) external;

14: 		    function l1Address() external view returns (address);

16: 		    function l2Bridge() external view returns (address);
```
[[10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL2StandardToken.sol#L10), [12](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL2StandardToken.sol#L12), [14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL2StandardToken.sol#L14), [16](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL2StandardToken.sol#L16)]



```solidity
File: code/system-contracts/contracts/interfaces/IMailbox.sol

6: 		    function finalizeEthWithdrawal(
```
[[6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IMailbox.sol#L6)]



```solidity
File: code/system-contracts/contracts/interfaces/IPaymasterFlow.sol

13: 		    function general(bytes calldata input) external;

15: 		    function approvalBased(address _token, uint256 _minAllowance, bytes calldata _innerInput) external;
```
[[13](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IPaymasterFlow.sol#L13), [15](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IPaymasterFlow.sol#L15)]



```solidity
File: code/system-contracts/contracts/interfaces/IPubdataChunkPublisher.sol

12: 		    function chunkAndPublishPubdata(bytes calldata _pubdata) external;
```
[[12](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IPubdataChunkPublisher.sol#L12)]



```solidity
File: code/system-contracts/contracts/interfaces/ISystemContext.sol

30: 		    function chainId() external view returns (uint256);

32: 		    function origin() external view returns (address);

34: 		    function gasPrice() external view returns (uint256);

36: 		    function blockGasLimit() external view returns (uint256);

38: 		    function coinbase() external view returns (address);

40: 		    function difficulty() external view returns (uint256);

42: 		    function baseFee() external view returns (uint256);

44: 		    function txNumberInBlock() external view returns (uint16);

46: 		    function getBlockHashEVM(uint256 _block) external view returns (bytes32);

48: 		    function getBatchHash(uint256 _batchNumber) external view returns (bytes32 hash);

50: 		    function getBlockNumber() external view returns (uint128);

52: 		    function getBlockTimestamp() external view returns (uint128);

54: 		    function getBatchNumberAndTimestamp() external view returns (uint128 blockNumber, uint128 blockTimestamp);

56: 		    function getL2BlockNumberAndTimestamp() external view returns (uint128 blockNumber, uint128 blockTimestamp);

58: 		    function gasPerPubdataByte() external view returns (uint256 gasPerPubdataByte);

60: 		    function getCurrentPubdataSpent() external view returns (uint256 currentPubdataSpent);
```
[[30](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L30), [32](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L32), [34](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L34), [36](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L36), [38](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L38), [40](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L40), [42](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L42), [44](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L44), [46](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L46), [48](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L48), [50](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L50), [52](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L52), [54](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L54), [56](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L56), [58](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L58), [60](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L60)]



```solidity
File: code/system-contracts/contracts/interfaces/ISystemContextDeprecated.sol

11: 		    function currentBlockInfo() external view returns (uint256);

13: 		    function getBlockNumberAndTimestamp() external view returns (uint256 blockNumber, uint256 blockTimestamp);

15: 		    function blockHash(uint256 _blockNumber) external view returns (bytes32 hash);
```
[[11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContextDeprecated.sol#L11), [13](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContextDeprecated.sol#L13), [15](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContextDeprecated.sol#L15)]



```solidity
File: code/system-contracts/contracts/libraries/EfficientCall.sol

36: 		    function keccak(bytes calldata _data) internal view returns (bytes32) {

45: 		    function sha(bytes calldata _data) internal view returns (bytes32) {

58: 		    function call(

74: 		    function staticCall(

88: 		    function delegateCall(

105: 		    function mimicCall(

124: 		    function rawCall(

159: 		    function rawStaticCall(uint256 _gas, address _address, bytes calldata _data) internal view returns (bool success) {

173: 		    function rawDelegateCall(uint256 _gas, address _address, bytes calldata _data) internal returns (bool success) {
```
[[36](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L36), [45](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L45), [58](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L58), [74](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L74), [88](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L88), [105](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L105), [124](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L124), [159](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L159), [173](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L173)]



```solidity
File: code/system-contracts/contracts/libraries/RLPEncoder.sol

11: 		    function encodeAddress(address _val) internal pure returns (bytes memory encoded) {

24: 		    function encodeUint256(uint256 _val) internal pure returns (bytes memory encoded) {

49: 		    function encodeNonSingleBytesLen(uint64 _len) internal pure returns (bytes memory) {

56: 		    function encodeListLen(uint64 _len) internal pure returns (bytes memory) {

60: 		    function _encodeLength(uint64 _len, uint256 _offset) private pure returns (bytes memory encoded) {

84: 		    function _highestByteSet(uint256 _number) private pure returns (uint256 hbs) {
```
[[11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/RLPEncoder.sol#L11), [24](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/RLPEncoder.sol#L24), [49](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/RLPEncoder.sol#L49), [56](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/RLPEncoder.sol#L56), [60](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/RLPEncoder.sol#L60), [84](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/RLPEncoder.sol#L84)]



```solidity
File: code/system-contracts/contracts/libraries/SystemContractHelper.sol

124: 		    function packPrecompileParams(

181: 		    function eventInitialize(uint256 initializer, uint256 value1) internal {

191: 		    function eventWrite(uint256 value1, uint256 value2) internal {

215: 		    function extractNumberFromMeta(uint256 meta, uint256 offset, uint256 size) internal pure returns (uint256 result) {

227: 		    function getPubdataPublishedFromMeta(uint256 meta) internal pure returns (uint32 pubdataPublished) {

279: 		    function getZkSyncMeta() internal view returns (ZkSyncMeta memory meta) {

329: 		    function isSystemCall() internal view returns (bool) {

338: 		    function isSystemContract(address _address) internal pure returns (bool) {

344: 		    function burnGas(uint32 _gasToPay, uint32 _pubdataToSpend) internal view {
```
[[124](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L124), [181](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L181), [191](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L191), [215](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L215), [227](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L227), [279](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L279), [329](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L329), [338](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L338), [344](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L344)]



```solidity
File: code/system-contracts/contracts/libraries/SystemContractsCaller.sol

250: 		    function getFarCallABIWithEmptyFatPointer(
```
[[250](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L250)]



```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

100: 		    function encodeHash(Transaction calldata _transaction) internal view returns (bytes32 resultHash) {

118: 		    function _encodeHashEIP712Transaction(Transaction calldata _transaction) private view returns (bytes32) {

147: 		    function _encodeHashLegacyTransaction(Transaction calldata _transaction) private view returns (bytes32) {

219: 		    function _encodeHashEIP2930Transaction(Transaction calldata _transaction) private view returns (bytes32) {

289: 		    function _encodeHashEIP1559Transaction(Transaction calldata _transaction) private view returns (bytes32) {

362: 		    function processPaymasterInput(Transaction calldata _transaction) internal {

405: 		    function totalRequiredBalance(Transaction calldata _transaction) internal pure returns (uint256 requiredBalance) {
```
[[100](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L100), [118](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L118), [147](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L147), [219](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L219), [289](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L289), [362](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L362), [405](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L405)]



```solidity
File: code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol

19: 		    function readUint16(bytes calldata _bytes, uint256 _start) internal pure returns (uint16 result) {

26: 		    function readUint32(bytes calldata _bytes, uint256 _start) internal pure returns (uint32 result) {

33: 		    function readUint64(bytes calldata _bytes, uint256 _start) internal pure returns (uint64 result) {

40: 		    function readBytes32(bytes calldata _bytes, uint256 _start) internal pure returns (bytes32 result) {

46: 		    function readUint256(bytes calldata _bytes, uint256 _start) internal pure returns (uint256 result) {
```
[[19](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol#L19), [26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol#L26), [33](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol#L33), [40](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol#L40), [46](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol#L46)]



```solidity
File: code/system-contracts/contracts/libraries/Utils.sol

20: 		    function safeCastToU128(uint256 _x) internal pure returns (uint128) {

26: 		    function safeCastToU32(uint256 _x) internal pure returns (uint32) {

32: 		    function safeCastToU24(uint256 _x) internal pure returns (uint24) {

39: 		    function bytecodeLenInBytes(bytes32 _bytecodeHash) internal pure returns (uint256 codeLength) {

44: 		    function bytecodeLenInWords(bytes32 _bytecodeHash) internal pure returns (uint256 codeLengthInWords) {

51: 		    function isContractConstructed(bytes32 _bytecodeHash) internal pure returns (bool) {

56: 		    function isContractConstructing(bytes32 _bytecodeHash) internal pure returns (bool) {

63: 		    function constructingBytecodeHash(bytes32 _bytecodeHash) internal pure returns (bytes32) {

71: 		    function constructedBytecodeHash(bytes32 _bytecodeHash) internal pure returns (bytes32) {

82: 		    function hashL2Bytecode(bytes calldata _bytecode) internal view returns (bytes32 hashedBytecode) {
```
[[20](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L20), [26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L26), [32](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L32), [39](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L39), [44](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L44), [51](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L51), [56](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L56), [63](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L63), [71](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L71), [82](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L82)]



```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

75: 		    function l2TokenAddress(address _l1Token) external view returns (address) {

208: 		    function finalizeWithdrawal(
```
[[75](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L75), [208](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L208)]



```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

137: 		    function receiveEth(uint256 _chainId) external payable {

182: 		    function bridgehubDeposit(

232: 		    function bridgehubConfirmL2Transaction(

385: 		    function finalizeWithdrawal(

487: 		    function _parseL2WithdrawalMessage(

615: 		    function finalizeWithdrawalLegacyErc20Bridge(

644: 		    function claimFailedDepositLegacyErc20Bridge(
```
[[137](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L137), [182](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L182), [232](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L232), [385](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L385), [487](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L487), [615](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L615), [644](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L644)]



```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

41: 		    function initialize(address _owner) external reentrancyGuardInitializer {

75: 		    function getStateTransition(uint256 _chainId) public view returns (address) {

82: 		    function addStateTransitionManager(address _stateTransitionManager) external onlyOwner {

92: 		    function removeStateTransitionManager(address _stateTransitionManager) external onlyOwner {

101: 		    function addToken(address _token) external onlyOwner {

108: 		    function setSharedBridge(address _sharedBridge) external onlyOwner {

114: 		    function createNewChain(

152: 		    function proveL2MessageInclusion(

164: 		    function proveL2LogInclusion(

176: 		    function proveL1ToL2TransactionStatus(

198: 		    function l2TransactionBaseCost(

217: 		    function requestL2TransactionDirect(

262: 		    function requestL2TransactionTwoBridges(

325: 		    function _actualRefundRecipient(address _refundRecipient) internal view returns (address _recipient) {
```
[[41](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L41), [75](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L75), [82](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L82), [92](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L92), [101](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L101), [108](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L108), [114](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L114), [152](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L152), [164](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L164), [176](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L176), [198](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L198), [217](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L217), [262](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L262), [325](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L325)]



```solidity
File: code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol

53: 		    function setPendingAdmin(address _newPendingAdmin) external;

56: 		    function acceptAdmin() external;

59: 		    function stateTransitionManagerIsRegistered(address _stateTransitionManager) external view returns (bool);

61: 		    function stateTransitionManager(uint256 _chainId) external view returns (address);

63: 		    function tokenIsRegistered(address _baseToken) external view returns (bool);

65: 		    function baseToken(uint256 _chainId) external view returns (address);

67: 		    function sharedBridge() external view returns (IL1SharedBridge);

69: 		    function getStateTransition(uint256 _chainId) external view returns (address);

73: 		    function proveL2MessageInclusion(

81: 		    function proveL2LogInclusion(

89: 		    function proveL1ToL2TransactionStatus(

99: 		    function requestL2TransactionDirect(

103: 		    function requestL2TransactionTwoBridges(

107: 		    function l2TransactionBaseCost(

116: 		    function createNewChain(

125: 		    function addStateTransitionManager(address _stateTransitionManager) external;

127: 		    function removeStateTransitionManager(address _stateTransitionManager) external;

129: 		    function addToken(address _token) external;

131: 		    function setSharedBridge(address _sharedBridge) external;
```
[[53](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L53), [56](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L56), [59](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L59), [61](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L61), [63](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L63), [65](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L65), [67](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L67), [69](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L69), [73](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L73), [81](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L81), [89](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L89), [99](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L99), [103](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L103), [107](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L107), [116](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L116), [125](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L125), [127](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L127), [129](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L129), [131](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L131)]



```solidity
File: code/contracts/ethereum/contracts/common/ReentrancyGuard.sol

46: 		    function _initializeReentrancyGuard() private {
```
[[46](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/ReentrancyGuard.sol#L46)]



```solidity
File: code/contracts/ethereum/contracts/governance/IGovernance.sol

41: 		    function isOperation(bytes32 _id) external view returns (bool);

43: 		    function isOperationPending(bytes32 _id) external view returns (bool);

45: 		    function isOperationReady(bytes32 _id) external view returns (bool);

47: 		    function isOperationDone(bytes32 _id) external view returns (bool);

49: 		    function getOperationState(bytes32 _id) external view returns (OperationState);

51: 		    function scheduleTransparent(Operation calldata _operation, uint256 _delay) external;

53: 		    function scheduleShadow(bytes32 _id, uint256 _delay) external;

55: 		    function cancel(bytes32 _id) external;

57: 		    function execute(Operation calldata _operation) external payable;

59: 		    function executeInstant(Operation calldata _operation) external payable;

61: 		    function hashOperation(Operation calldata _operation) external pure returns (bytes32);

63: 		    function updateDelay(uint256 _newDelay) external;

65: 		    function updateSecurityCouncil(address _newSecurityCouncil) external;
```
[[41](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L41), [43](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L43), [45](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L45), [47](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L47), [49](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L49), [51](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L51), [53](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L53), [55](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L55), [57](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L57), [59](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L59), [61](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L61), [63](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L63), [65](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L65)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol

43: 		    function bridgehub() external view returns (address);

48: 		    function setPendingAdmin(address _newPendingAdmin) external;

51: 		    function acceptAdmin() external;

53: 		    function stateTransition(uint256 _chainId) external view returns (address);

55: 		    function storedBatchZero() external view returns (bytes32);

57: 		    function initialCutHash() external view returns (bytes32);

59: 		    function genesisUpgrade() external view returns (address);

61: 		    function upgradeCutHash(uint256 _protocolVersion) external view returns (bytes32);

63: 		    function protocolVersion() external view returns (uint256);

65: 		    function initialize(StateTransitionManagerInitializeData calldata _initalizeData) external;

67: 		    function setInitialCutHash(Diamond.DiamondCutData calldata _diamondCut) external;

69: 		    function setValidatorTimelock(address _validatorTimelock) external;

71: 		    function getChainAdmin(uint256 _chainId) external view returns (address);

74: 		    function createNewChain(

82: 		    function registerAlreadyDeployedStateTransition(uint256 _chainId, address _stateTransitionContract) external;

84: 		    function setNewVersionUpgrade(

90: 		    function setUpgradeDiamondCut(Diamond.DiamondCutData calldata _cutData, uint256 _oldProtocolVersion) external;

92: 		    function freezeChain(uint256 _chainId) external;

94: 		    function unfreezeChain(uint256 _chainId) external;
```
[[43](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L43), [48](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L48), [51](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L51), [53](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L53), [55](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L55), [57](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L57), [59](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L59), [61](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L61), [63](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L63), [65](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L65), [67](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L67), [69](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L69), [71](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L71), [74](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L74), [82](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L82), [84](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L84), [90](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L90), [92](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L92), [94](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L94)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

74: 		    function getChainAdmin(uint256 _chainId) external view override returns (address) {

230: 		    function registerAlreadyDeployedStateTransition(

239: 		    function createNewChain(
```
[[74](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L74), [230](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L230), [239](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L239)]



```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol

92: 		    function _setL2DefaultAccountBytecodeHash(bytes32 _l2DefaultAccountBytecodeHash) private {

109: 		    function _setL2BootloaderBytecodeHash(bytes32 _l2BootloaderBytecodeHash) private {

126: 		    function _setVerifier(IVerifier _newVerifier) private {

142: 		    function _setVerifierParams(VerifierParams calldata _newVerifierParams) private {

163: 		    function _upgradeVerifier(address _newVerifier, VerifierParams calldata _verifierParams) internal {

171: 		    function _setBaseSystemContracts(bytes32 _bootloaderHash, bytes32 _defaultAccountHash) internal {

222: 		    function _verifyFactoryDeps(bytes[] calldata _factoryDeps, uint256[] calldata _expectedHashes) private pure {

236: 		    function _setNewProtocolVersion(uint256 _newProtocolVersion) internal virtual {

263: 		    function _upgradeL1Contract(bytes calldata _customCallDataForUpgrade) internal virtual {}

269: 		    function _postUpgrade(bytes calldata _customCallDataForUpgrade) internal virtual {}
```
[[92](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L92), [109](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L109), [126](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L126), [142](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L142), [163](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L163), [171](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L171), [222](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L222), [236](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L236), [263](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L263), [269](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L269)]



```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol

20: 		    function _setNewProtocolVersion(uint256 _newProtocolVersion) internal override {
```
[[20](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L20)]



```solidity
File: code/contracts/ethereum/contracts/upgrades/DefaultUpgrade.sol

13: 		    function upgrade(ProposedUpgrade calldata _proposedUpgrade) public override returns (bytes32) {
```
[[13](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/DefaultUpgrade.sol#L13)]



```solidity
File: code/contracts/ethereum/contracts/upgrades/GenesisUpgrade.sol

14: 		    function upgrade(ProposedUpgrade calldata _proposedUpgrade) public override returns (bytes32) {
```
[[14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/GenesisUpgrade.sol#L14)]



```solidity
File: code/contracts/ethereum/contracts/upgrades/IDefaultUpgrade.sol

8: 		    function upgrade(ProposedUpgrade calldata _upgrade) external returns (bytes32);
```
[[8](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/IDefaultUpgrade.sol#L8)]



```solidity
File: code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol

28: 		    function applyL1ToL2Alias(address l1Address) internal pure returns (address l2Address) {

38: 		    function undoL1ToL2Alias(address l2Address) internal pure returns (address l1Address) {
```
[[28](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol#L28), [38](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol#L38)]



```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

49: 		    function initialize(

79: 		    function finalizeDeposit(

123: 		    function withdraw(address _l1Receiver, address _l2Token, uint256 _amount) external override {

149: 		    function l2TokenAddress(address _l1Token) public view override returns (address) {
```
[[49](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L49), [79](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L79), [123](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L123), [149](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L149)]



```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

159: 		    function name() public view override returns (string memory) {

165: 		    function symbol() public view override returns (string memory) {

171: 		    function decimals() public view override returns (uint8) {
```
[[159](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L159), [165](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L165), [171](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L171)]



```solidity
File: code/contracts/zksync/contracts/interfaces/IPaymasterFlow.sol

14: 		    function general(bytes calldata input) external;

16: 		    function approvalBased(address _token, uint256 _minAllowance, bytes calldata _innerInput) external;
```
[[14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/interfaces/IPaymasterFlow.sol#L14), [16](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/interfaces/IPaymasterFlow.sol#L16)]



```solidity
File: code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol

28: 		    function applyL1ToL2Alias(address l1Address) internal pure returns (address l2Address) {

38: 		    function undoL1ToL2Alias(address l2Address) internal pure returns (address l1Address) {
```
[[28](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol#L28), [38](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol#L38)]



```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol

24: 		    function isWithdrawalFinalized(uint256 _l2BatchNumber, uint256 _l2MessageIndex) external view returns (bool);

26: 		    function deposit(

35: 		    function deposit(

43: 		    function claimFailedDeposit(

53: 		    function finalizeWithdrawal(

61: 		    function l2TokenAddress(address _l1Token) external view returns (address);

63: 		    function sharedBridge() external view returns (IL1SharedBridge);

65: 		    function l2TokenBeacon() external view returns (address);

67: 		    function l2Bridge() external view returns (address);

69: 		    function depositAmount(

75: 		    function tranferTokenToSharedBridge(address _token, uint256 _amount) external;
```
[[24](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L24), [26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L26), [35](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L35), [43](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L43), [53](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L53), [61](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L61), [63](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L63), [65](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L65), [67](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L67), [69](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L69), [75](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L75)]



```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol

58: 		    function isWithdrawalFinalized(

64: 		    function depositLegacyErc20Bridge(

74: 		    function claimFailedDepositLegacyErc20Bridge(

85: 		    function claimFailedDeposit(

97: 		    function finalizeWithdrawalLegacyErc20Bridge(

105: 		    function finalizeWithdrawal(

114: 		    function l1WethAddress() external view returns (address);

116: 		    function bridgehub() external view returns (IBridgehub);

118: 		    function legacyBridge() external view returns (IL1ERC20Bridge);

120: 		    function l2BridgeAddress(uint256 _chainId) external view returns (address);

122: 		    function depositHappened(uint256 _chainId, bytes32 _l2TxHash) external view returns (bytes32);

128: 		    function bridgehubDeposit(

135: 		    function bridgehubDepositBaseToken(

142: 		    function bridgehubConfirmL2Transaction(uint256 _chainId, bytes32 _txDataHash, bytes32 _txHash) external;

144: 		    function receiveEth(uint256 _chainId) external payable;
```
[[58](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L58), [64](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L64), [74](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L74), [85](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L85), [97](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L97), [105](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L105), [114](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L114), [116](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L116), [118](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L118), [120](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L120), [122](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L122), [128](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L128), [135](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L135), [142](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L142), [144](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L144)]



```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL2Bridge.sol

7: 		    function finalizeDeposit(

15: 		    function withdraw(address _l1Receiver, address _l2Token, uint256 _amount) external;

17: 		    function l1TokenAddress(address _l2Token) external view returns (address);

19: 		    function l2TokenAddress(address _l1Token) external view returns (address);

21: 		    function l1Bridge() external view returns (address);
```
[[7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL2Bridge.sol#L7), [15](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL2Bridge.sol#L15), [17](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL2Bridge.sol#L17), [19](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL2Bridge.sol#L19), [21](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL2Bridge.sol#L21)]



```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IWETH9.sol

5: 		    function deposit() external payable;

7: 		    function withdraw(uint256 wad) external;
```
[[5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IWETH9.sol#L5), [7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IWETH9.sol#L7)]



```solidity
File: code/contracts/ethereum/contracts/common/interfaces/IL2ContractDeployer.sol

25: 		    function forceDeployOnAddresses(ForceDeployment[] calldata _deployParams) external;

31: 		    function create2(bytes32 _salt, bytes32 _bytecodeHash, bytes calldata _input) external;
```
[[25](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/interfaces/IL2ContractDeployer.sol#L25), [31](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/interfaces/IL2ContractDeployer.sol#L31)]



```solidity
File: code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol

21: 		    function hashL2Bytecode(bytes memory _bytecode) internal pure returns (bytes32 hashedBytecode) {

49: 		    function bytecodeLen(bytes32 _bytecodeHash) internal pure returns (uint256 codeLengthInWords) {

60: 		    function computeCreate2Address(
```
[[21](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L21), [49](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L49), [60](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L60)]



```solidity
File: code/contracts/ethereum/contracts/common/libraries/UncheckedMath.sol

11: 		    function uncheckedInc(uint256 _number) internal pure returns (uint256) {

17: 		    function uncheckedAdd(uint256 _lhs, uint256 _rhs) internal pure returns (uint256) {
```
[[11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/UncheckedMath.sol#L11), [17](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/UncheckedMath.sol#L17)]



```solidity
File: code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol

19: 		    function readUint32(bytes memory _bytes, uint256 _start) internal pure returns (uint32 result, uint256 offset) {

26: 		    function readAddress(bytes memory _bytes, uint256 _start) internal pure returns (address result, uint256 offset) {

33: 		    function readUint256(bytes memory _bytes, uint256 _start) internal pure returns (uint256 result, uint256 offset) {

40: 		    function readBytes32(bytes memory _bytes, uint256 _start) internal pure returns (bytes32 result, uint256 offset) {
```
[[19](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol#L19), [26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol#L26), [33](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol#L33), [40](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol#L40)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol

24: 		    function initialize(InitializeData calldata _initializeData) external reentrancyGuardInitializer returns (bytes32) {
```
[[24](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol#L24)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol

17: 		    function setPendingAdmin(address _newPendingAdmin) external;

20: 		    function acceptAdmin() external;

25: 		    function setValidator(address _validator, bool _active) external;

29: 		    function setPorterAvailability(bool _zkPorterIsAvailable) external;

33: 		    function setPriorityTxMaxGasLimit(uint256 _newPriorityTxMaxGasLimit) external;

37: 		    function changeFeeParams(FeeParams calldata _newFeeParams) external;

40: 		    function setTokenMultiplier(uint128 _nominator, uint128 _denominator) external;

43: 		    function setValidiumMode(PubdataPricingMode _validiumMode) external;

45: 		    function upgradeChainFromVersion(uint256 _protocolVersion, Diamond.DiamondCutData calldata _cutData) external;
```
[[17](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L17), [20](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L20), [25](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L25), [29](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L29), [33](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L33), [37](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L37), [40](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L40), [43](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L43), [45](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L45)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol

62: 		    function initialize(InitializeData calldata _initData) external returns (bytes32);
```
[[62](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol#L62)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol

137: 		    function commitBatches(

143: 		    function commitBatchesSharedBridge(

161: 		    function proveBatchesSharedBridge(

172: 		    function executeBatches(StoredBatchInfo[] calldata _batchesData) external;

175: 		    function executeBatchesSharedBridge(uint256 _chainId, StoredBatchInfo[] calldata _batchesData) external;

181: 		    function revertBatches(uint256 _newLastBatch) external;

184: 		    function revertBatchesSharedBridge(uint256 _chainId, uint256 _newLastBatch) external;
```
[[137](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L137), [143](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L143), [161](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L161), [172](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L172), [175](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L175), [181](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L181), [184](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L184)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol

19: 		    function getVerifier() external view returns (address);

22: 		    function getAdmin() external view returns (address);

25: 		    function getPendingAdmin() external view returns (address);

28: 		    function getBridgehub() external view returns (address);

31: 		    function getStateTransitionManager() external view returns (address);

34: 		    function getBaseToken() external view returns (address);

37: 		    function getBaseTokenBridge() external view returns (address);

40: 		    function getTotalBatchesCommitted() external view returns (uint256);

43: 		    function getTotalBatchesVerified() external view returns (uint256);

46: 		    function getTotalBatchesExecuted() external view returns (uint256);

49: 		    function getTotalPriorityTxs() external view returns (uint256);

59: 		    function getPriorityQueueSize() external view returns (uint256);

62: 		    function priorityQueueFrontOperation() external view returns (PriorityOperation memory);

65: 		    function isValidator(address _address) external view returns (bool);

68: 		    function l2LogsRootHash(uint256 _batchNumber) external view returns (bytes32 merkleRoot);

76: 		    function getL2BootloaderBytecodeHash() external view returns (bytes32);

79: 		    function getL2DefaultAccountBytecodeHash() external view returns (bytes32);

82: 		    function getVerifierParams() external view returns (VerifierParams memory);

85: 		    function isDiamondStorageFrozen() external view returns (bool);

88: 		    function getProtocolVersion() external view returns (uint256);

91: 		    function getL2SystemContractsUpgradeTxHash() external view returns (bytes32);

101: 		    function getPriorityTxMaxGasLimit() external view returns (uint256);

106: 		    function isEthWithdrawalFinalized(uint256 _l2BatchNumber, uint256 _l2MessageIndex) external view returns (bool);

109: 		    function getPubdataPricingMode() external view returns (PubdataPricingMode);

112: 		    function baseTokenGasPriceMultiplierNominator() external view returns (uint128);

115: 		    function baseTokenGasPriceMultiplierDenominator() external view returns (uint128);

130: 		    function facets() external view returns (Facet[] memory);

133: 		    function facetFunctionSelectors(address _facet) external view returns (bytes4[] memory);

136: 		    function facetAddresses() external view returns (address[] memory facets);

139: 		    function facetAddress(bytes4 _selector) external view returns (address facet);

142: 		    function isFunctionFreezable(bytes4 _selector) external view returns (bool);

145: 		    function isFacetFreezable(address _facet) external view returns (bool isFreezable);
```
[[19](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L19), [22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L22), [25](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L25), [28](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L28), [31](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L31), [34](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L34), [37](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L37), [40](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L40), [43](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L43), [46](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L46), [49](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L49), [59](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L59), [62](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L62), [65](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L65), [68](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L68), [76](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L76), [79](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L79), [82](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L82), [85](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L85), [88](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L88), [91](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L91), [101](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L101), [106](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L106), [109](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L109), [112](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L112), [115](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L115), [130](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L130), [133](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L133), [136](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L136), [139](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L139), [142](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L142), [145](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L145)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol

18: 		    function proveL2MessageInclusion(

31: 		    function proveL2LogInclusion(

47: 		    function proveL1ToL2TransactionStatus(

62: 		    function finalizeEthWithdrawal(

98: 		    function bridgehubRequestL2Transaction(

107: 		    function l2TransactionBaseCost(

114: 		    function transferEthToSharedBridge() external;
```
[[18](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L18), [31](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L31), [47](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L47), [62](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L62), [98](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L98), [107](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L107), [114](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L114)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IVerifier.sol

27: 		    function verificationKeyHash() external pure returns (bytes32);
```
[[27](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IVerifier.sol#L27)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransitionBase.sol

9: 		    function getName() external view returns (string memory);
```
[[9](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransitionBase.sol#L9)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/l2-deps/ISystemContext.sol

5: 		    function setChainId(uint256 _newChainId) external;
```
[[5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/l2-deps/ISystemContext.sol#L5)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol

87: 		    function getDiamondStorage() internal pure returns (DiamondStorage storage diamondStorage) {
```
[[87](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L87)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol

35: 		    function getFirstUnprocessedPriorityTx(Queue storage _queue) internal view returns (uint256) {

40: 		    function getTotalPriorityTxs(Queue storage _queue) internal view returns (uint256) {

45: 		    function getSize(Queue storage _queue) internal view returns (uint256) {

50: 		    function isEmpty(Queue storage _queue) internal view returns (bool) {

55: 		    function pushBack(Queue storage _queue, PriorityOperation memory _operation) internal {

64: 		    function front(Queue storage _queue) internal view returns (PriorityOperation memory) {

72: 		    function popFront(Queue storage _queue) internal returns (PriorityOperation memory priorityOperation) {
```
[[35](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L35), [40](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L40), [45](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L45), [50](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L50), [55](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L55), [64](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L64), [72](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L72)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol

109: 		    function getTransactionBodyGasLimit(
```
[[109](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L109)]



```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL1ERC20Bridge.sol

9: 		    function finalizeWithdrawal(
```
[[9](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L9)]



```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL1SharedBridge.sol

9: 		    function finalizeWithdrawal(
```
[[9](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL1SharedBridge.sol#L9)]



```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol

24: 		    function finalizeDeposit(

32: 		    function withdraw(address _l1Receiver, address _l2Token, uint256 _amount) external;

34: 		    function l1TokenAddress(address _l2Token) external view returns (address);

36: 		    function l2TokenAddress(address _l1Token) external view returns (address);

38: 		    function l1Bridge() external view returns (address);
```
[[24](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol#L24), [32](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol#L32), [34](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol#L34), [36](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol#L36), [38](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol#L38)]



```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol

12: 		    function bridgeMint(address _account, uint256 _amount) external;

14: 		    function bridgeBurn(address _account, uint256 _amount) external;

16: 		    function l1Address() external view returns (address);

18: 		    function l2Bridge() external view returns (address);
```
[[12](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol#L12), [14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol#L14), [16](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol#L16), [18](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol#L18)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol

89: 		    function setValidiumMode(PubdataPricingMode _validiumMode) external onlyAdmin {

100: 		    function upgradeChainFromVersion(
```
[[89](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L89), [100](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L100)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

103: 		    function _verifyBatchTimestamp(

215: 		    function _commitBatches(

349: 		    function _executeBatches(StoredBatchInfo[] calldata _batchesData) internal {

386: 		    function _proveBatches(

440: 		    function _verifyProof(uint256[] memory proofPublicInput, ProofInput calldata _proof) internal view {

481: 		    function _revertBatches(uint256 _newLastBatch) internal {

515: 		    function _batchPassThroughData(CommitBatchInfo calldata _batch) internal pure returns (bytes memory) {

525: 		    function _batchMetaParameters() internal view returns (bytes memory) {

537: 		    function _batchAuxiliaryOutput(

587: 		    function _hashStoredBatchInfo(StoredBatchInfo memory _storedBatchInfo) internal pure returns (bytes32) {

592: 		    function _checkBit(uint256 _bitMap, uint8 _index) internal pure returns (bool) {

597: 		    function _setBit(uint256 _bitMap, uint8 _index) internal pure returns (uint256) {

605: 		    function _pointEvaluationPrecompile(
```
[[103](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L103), [215](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L215), [349](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L349), [386](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L386), [440](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L440), [481](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L481), [515](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L515), [525](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L525), [537](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L537), [587](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L587), [592](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L592), [597](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L597), [605](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L605)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

47: 		    function bridgehubRequestL2Transaction(

156: 		    function _deriveL2GasPrice(uint256 _l1GasPrice, uint256 _gasPerPubdata) internal view returns (uint256) {

228: 		    function _requestL2TransactionSender(

258: 		    function _requestL2Transaction(

289: 		    function _serializeL2Transaction(

316: 		    function _writePriorityOp(

353: 		    function _hashFactoryDeps(bytes[] memory _factoryDeps) internal pure returns (uint256[] memory hashedFactoryDeps) {
```
[[47](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L47), [156](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L156), [228](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L228), [258](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L258), [289](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L289), [316](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L316), [353](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L353)]

</details>

---

### [N-113] Missing NatSpec `@notice` from function declaration

Some functions have an incomplete NatSpec: add a `@notice` notation to describe the function to improve the code documentation.

*There are 374 instances of this issue.*

<details>
<summary>Expand findings</summary>


```solidity
File: code/system-contracts/contracts/AccountCodeStorage.sol

68: 		    function _storeCodeHash(address _address, bytes32 _hash) internal {
```
[[68](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L68)]



```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

258: 		    function _nonSystemDeployOnAddress(
```
[[258](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L258)]



```solidity
File: code/system-contracts/contracts/DefaultAccount.sol

220: 		    fallback() external payable ignoreInDelegateCall {

227: 		    receive() external payable {
```
[[220](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L220), [227](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L227)]



```solidity
File: code/system-contracts/contracts/EmptyContract.sol

11: 		    fallback() external payable {}

13: 		    receive() external payable {}
```
[[11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/EmptyContract.sol#L11), [13](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/EmptyContract.sol#L13)]



```solidity
File: code/system-contracts/contracts/L1Messenger.sol

50: 		    function keccakGasCost(uint256 _length) internal pure returns (uint256) {

61: 		    function sha256GasCost(uint256 _length) internal pure returns (uint256) {

161: 		    function requestBytecodeL1Publication(
```
[[50](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L50), [61](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L61), [161](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L161)]



```solidity
File: code/system-contracts/contracts/L2BaseToken.sol

99: 		    function _burnMsgValue() internal returns (uint256 amount) {

112: 		    function _getL1WithdrawMessage(address _to, uint256 _amount) internal pure returns (bytes memory) {

117: 		    function _getExtendedWithdrawMessage(

128: 		    function name() external pure override returns (string memory) {

134: 		    function symbol() external pure override returns (string memory) {

140: 		    function decimals() external pure override returns (uint8) {
```
[[99](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L2BaseToken.sol#L99), [112](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L2BaseToken.sol#L112), [117](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L2BaseToken.sol#L117), [128](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L2BaseToken.sol#L128), [134](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L2BaseToken.sol#L134), [140](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L2BaseToken.sol#L140)]



```solidity
File: code/system-contracts/contracts/SystemContext.sol

117: 		    function getCurrentPubdataSpent() public view returns (uint256) {

122: 		    function getCurrentPubdataCost() external view returns (uint256) {

482: 		    function incrementTxNumberInBatch() external onlyCallFromBootloader {

486: 		    function resetTxNumberInBatch() external onlyCallFromBootloader {
```
[[117](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L117), [122](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L122), [482](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L482), [486](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L486)]



```solidity
File: code/contracts/zksync/contracts/SystemContractsCaller.sol

27: 		    function safeCastToU32(uint256 _x) internal pure returns (uint32) {

37: 		    function systemCall(uint32 gasLimit, address to, uint256 value, bytes memory data) internal returns (bool success) {

76: 		    function systemCallWithReturndata(

95: 		    function getFarCallABI(

121: 		    function getFarCallABIWithEmptyFatPointer(
```
[[27](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/SystemContractsCaller.sol#L27), [37](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/SystemContractsCaller.sol#L37), [76](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/SystemContractsCaller.sol#L76), [95](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/SystemContractsCaller.sol#L95), [121](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/SystemContractsCaller.sol#L121)]



```solidity
File: code/system-contracts/contracts/interfaces/IAccount.sol

26: 		    function executeTransaction(

34: 		    function executeTransactionFromOutside(Transaction calldata _transaction) external payable;

36: 		    function payForTransaction(

42: 		    function prepareForPaymaster(
```
[[26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IAccount.sol#L26), [34](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IAccount.sol#L34), [36](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IAccount.sol#L36), [42](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IAccount.sol#L42)]



```solidity
File: code/system-contracts/contracts/interfaces/IAccountCodeStorage.sol

6: 		    function storeAccountConstructingCodeHash(address _address, bytes32 _hash) external;

8: 		    function storeAccountConstructedCodeHash(address _address, bytes32 _hash) external;

10: 		    function markAccountCodeHashAsConstructed(address _address) external;

12: 		    function getRawCodeHash(address _address) external view returns (bytes32 codeHash);

14: 		    function getCodeHash(uint256 _input) external view returns (bytes32 codeHash);

16: 		    function getCodeSize(uint256 _input) external view returns (uint256 codeSize);
```
[[6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IAccountCodeStorage.sol#L6), [8](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IAccountCodeStorage.sol#L8), [10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IAccountCodeStorage.sol#L10), [12](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IAccountCodeStorage.sol#L12), [14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IAccountCodeStorage.sol#L14), [16](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IAccountCodeStorage.sol#L16)]



```solidity
File: code/system-contracts/contracts/interfaces/IBaseToken.sol

6: 		    function balanceOf(uint256) external view returns (uint256);

8: 		    function transferFromTo(address _from, address _to, uint256 _amount) external;

10: 		    function totalSupply() external view returns (uint256);

12: 		    function name() external pure returns (string memory);

14: 		    function symbol() external pure returns (string memory);

16: 		    function decimals() external pure returns (uint8);

18: 		    function mint(address _account, uint256 _amount) external;

20: 		    function withdraw(address _l1Receiver) external payable;

22: 		    function withdrawWithMessage(address _l1Receiver, bytes calldata _additionalData) external payable;
```
[[6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBaseToken.sol#L6), [8](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBaseToken.sol#L8), [10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBaseToken.sol#L10), [12](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBaseToken.sol#L12), [14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBaseToken.sol#L14), [16](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBaseToken.sol#L16), [18](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBaseToken.sol#L18), [20](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBaseToken.sol#L20), [22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBaseToken.sol#L22)]



```solidity
File: code/system-contracts/contracts/interfaces/IBootloaderUtilities.sol

8: 		    function getTransactionHashes(
```
[[8](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBootloaderUtilities.sol#L8)]



```solidity
File: code/system-contracts/contracts/interfaces/IComplexUpgrader.sol

11: 		    function upgrade(address _delegateTo, bytes calldata _calldata) external payable;
```
[[11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IComplexUpgrader.sol#L11)]



```solidity
File: code/system-contracts/contracts/interfaces/ICompressor.sol

19: 		    function publishCompressedBytecode(

24: 		    function verifyCompressedStateDiffs(
```
[[19](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ICompressor.sol#L19), [24](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ICompressor.sol#L24)]



```solidity
File: code/system-contracts/contracts/interfaces/IContractDeployer.sol

43: 		    function getNewAddressCreate2(

50: 		    function getNewAddressCreate(address _sender, uint256 _senderNonce) external pure returns (address newAddress);

52: 		    function create2(

58: 		    function create2Account(

68: 		    function create(

76: 		    function createAccount(
```
[[43](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L43), [50](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L50), [52](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L52), [58](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L58), [68](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L68), [76](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L76)]



```solidity
File: code/system-contracts/contracts/interfaces/IImmutableSimulator.sol

11: 		    function getImmutable(address _dest, uint256 _index) external view returns (bytes32);

13: 		    function setImmutables(address _dest, ImmutableData[] calldata _immutables) external;
```
[[11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IImmutableSimulator.sol#L11), [13](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IImmutableSimulator.sol#L13)]



```solidity
File: code/system-contracts/contracts/interfaces/IKnownCodesStorage.sol

14: 		    function markFactoryDeps(bool _shouldSendToL1, bytes32[] calldata _hashes) external;

16: 		    function markBytecodeAsPublished(bytes32 _bytecodeHash) external;

18: 		    function getMarker(bytes32 _hash) external view returns (uint256);
```
[[14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IKnownCodesStorage.sol#L14), [16](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IKnownCodesStorage.sol#L16), [18](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IKnownCodesStorage.sol#L18)]



```solidity
File: code/system-contracts/contracts/interfaces/IL1Messenger.sol

49: 		    function sendToL1(bytes memory _message) external returns (bytes32);

51: 		    function sendL2ToL1Log(bool _isService, bytes32 _key, bytes32 _value) external returns (uint256 logIdInMerkleTree);

54: 		    function requestBytecodeL1Publication(bytes32 _bytecodeHash) external;
```
[[49](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL1Messenger.sol#L49), [51](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL1Messenger.sol#L51), [54](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL1Messenger.sol#L54)]



```solidity
File: code/system-contracts/contracts/interfaces/IL2StandardToken.sol

10: 		    function bridgeMint(address _account, uint256 _amount) external;

12: 		    function bridgeBurn(address _account, uint256 _amount) external;

14: 		    function l1Address() external view returns (address);

16: 		    function l2Bridge() external view returns (address);
```
[[10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL2StandardToken.sol#L10), [12](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL2StandardToken.sol#L12), [14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL2StandardToken.sol#L14), [16](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL2StandardToken.sol#L16)]



```solidity
File: code/system-contracts/contracts/interfaces/IMailbox.sol

6: 		    function finalizeEthWithdrawal(
```
[[6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IMailbox.sol#L6)]



```solidity
File: code/system-contracts/contracts/interfaces/INonceHolder.sol

17: 		    function getMinNonce(address _address) external view returns (uint256);

21: 		    function getRawNonce(address _address) external view returns (uint256);

24: 		    function increaseMinNonce(uint256 _value) external returns (uint256);

27: 		    function setValueUnderNonce(uint256 _key, uint256 _value) external;

30: 		    function getValueUnderNonce(uint256 _key) external view returns (uint256);

34: 		    function incrementMinNonceIfEquals(uint256 _expectedNonce) external;

37: 		    function getDeploymentNonce(address _address) external view returns (uint256);

40: 		    function incrementDeploymentNonce(address _address) external returns (uint256);

43: 		    function validateNonceUsage(address _address, uint256 _key, bool _shouldBeUsed) external view;

46: 		    function isNonceUsed(address _address, uint256 _nonce) external view returns (bool);
```
[[17](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/INonceHolder.sol#L17), [21](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/INonceHolder.sol#L21), [24](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/INonceHolder.sol#L24), [27](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/INonceHolder.sol#L27), [30](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/INonceHolder.sol#L30), [34](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/INonceHolder.sol#L34), [37](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/INonceHolder.sol#L37), [40](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/INonceHolder.sol#L40), [43](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/INonceHolder.sol#L43), [46](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/INonceHolder.sol#L46)]



```solidity
File: code/system-contracts/contracts/interfaces/IPaymaster.sol

28: 		    function validateAndPayForPaymasterTransaction(

43: 		    function postTransaction(
```
[[28](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IPaymaster.sol#L28), [43](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IPaymaster.sol#L43)]



```solidity
File: code/system-contracts/contracts/interfaces/IPaymasterFlow.sol

13: 		    function general(bytes calldata input) external;

15: 		    function approvalBased(address _token, uint256 _minAllowance, bytes calldata _innerInput) external;
```
[[13](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IPaymasterFlow.sol#L13), [15](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IPaymasterFlow.sol#L15)]



```solidity
File: code/system-contracts/contracts/interfaces/ISystemContext.sol

30: 		    function chainId() external view returns (uint256);

32: 		    function origin() external view returns (address);

34: 		    function gasPrice() external view returns (uint256);

36: 		    function blockGasLimit() external view returns (uint256);

38: 		    function coinbase() external view returns (address);

40: 		    function difficulty() external view returns (uint256);

42: 		    function baseFee() external view returns (uint256);

44: 		    function txNumberInBlock() external view returns (uint16);

46: 		    function getBlockHashEVM(uint256 _block) external view returns (bytes32);

48: 		    function getBatchHash(uint256 _batchNumber) external view returns (bytes32 hash);

50: 		    function getBlockNumber() external view returns (uint128);

52: 		    function getBlockTimestamp() external view returns (uint128);

54: 		    function getBatchNumberAndTimestamp() external view returns (uint128 blockNumber, uint128 blockTimestamp);

56: 		    function getL2BlockNumberAndTimestamp() external view returns (uint128 blockNumber, uint128 blockTimestamp);

58: 		    function gasPerPubdataByte() external view returns (uint256 gasPerPubdataByte);

60: 		    function getCurrentPubdataSpent() external view returns (uint256 currentPubdataSpent);
```
[[30](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L30), [32](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L32), [34](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L34), [36](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L36), [38](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L38), [40](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L40), [42](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L42), [44](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L44), [46](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L46), [48](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L48), [50](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L50), [52](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L52), [54](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L54), [56](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L56), [58](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L58), [60](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L60)]



```solidity
File: code/system-contracts/contracts/interfaces/ISystemContextDeprecated.sol

11: 		    function currentBlockInfo() external view returns (uint256);

13: 		    function getBlockNumberAndTimestamp() external view returns (uint256 blockNumber, uint256 blockTimestamp);

15: 		    function blockHash(uint256 _blockNumber) external view returns (bytes32 hash);
```
[[11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContextDeprecated.sol#L11), [13](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContextDeprecated.sol#L13), [15](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContextDeprecated.sol#L15)]



```solidity
File: code/system-contracts/contracts/libraries/EfficientCall.sol

215: 		    function _verifyCallResult(bool _success) private pure returns (bytes memory returnData) {

232: 		    function propagateRevert() internal pure {

245: 		    function _loadFarCallABIIntoActivePtr(
```
[[215](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L215), [232](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L232), [245](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L245)]



```solidity
File: code/system-contracts/contracts/libraries/RLPEncoder.sol

11: 		    function encodeAddress(address _val) internal pure returns (bytes memory encoded) {

24: 		    function encodeUint256(uint256 _val) internal pure returns (bytes memory encoded) {

60: 		    function _encodeLength(uint64 _len, uint256 _offset) private pure returns (bytes memory encoded) {
```
[[11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/RLPEncoder.sol#L11), [24](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/RLPEncoder.sol#L24), [60](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/RLPEncoder.sol#L60)]



```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

405: 		    function totalRequiredBalance(Transaction calldata _transaction) internal pure returns (uint256 requiredBalance) {
```
[[405](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L405)]



```solidity
File: code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol

19: 		    function readUint16(bytes calldata _bytes, uint256 _start) internal pure returns (uint16 result) {

26: 		    function readUint32(bytes calldata _bytes, uint256 _start) internal pure returns (uint32 result) {

33: 		    function readUint64(bytes calldata _bytes, uint256 _start) internal pure returns (uint64 result) {

40: 		    function readBytes32(bytes calldata _bytes, uint256 _start) internal pure returns (bytes32 result) {

46: 		    function readUint256(bytes calldata _bytes, uint256 _start) internal pure returns (uint256 result) {
```
[[19](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol#L19), [26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol#L26), [33](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol#L33), [40](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol#L40), [46](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol#L46)]



```solidity
File: code/system-contracts/contracts/libraries/Utils.sol

20: 		    function safeCastToU128(uint256 _x) internal pure returns (uint128) {

26: 		    function safeCastToU32(uint256 _x) internal pure returns (uint32) {

32: 		    function safeCastToU24(uint256 _x) internal pure returns (uint24) {

39: 		    function bytecodeLenInBytes(bytes32 _bytecodeHash) internal pure returns (uint256 codeLength) {

44: 		    function bytecodeLenInWords(bytes32 _bytecodeHash) internal pure returns (uint256 codeLengthInWords) {
```
[[20](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L20), [26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L26), [32](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L32), [39](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L39), [44](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L44)]



```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

60: 		    function initialize() external reentrancyGuardInitializer {}

63: 		    function tranferTokenToSharedBridge(address _token, uint256 _amount) external {

75: 		    function l2TokenAddress(address _l1Token) external view returns (address) {

160: 		    function _depositFundsToSharedBridge(address _from, IERC20 _token, uint256 _amount) internal returns (uint256) {

176: 		    function claimFailedDeposit(
```
[[60](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L60), [63](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L63), [75](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L75), [160](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L160), [176](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L176)]



```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

104: 		    function initialize(

116: 		    function transferFundsFromLegacy(address _token, address _target, uint256 _targetChainId) external onlyOwner {

137: 		    function receiveEth(uint256 _chainId) external payable {

142: 		    function initializeChainGovernance(uint256 _chainId, address _l2BridgeAddress) external onlyOwner {

173: 		    function _depositFunds(address _from, IERC20 _token, uint256 _amount) internal returns (uint256) {

243: 		    function _getDepositL2Calldata(

254: 		    function _getERC20Getters(address _token) internal view returns (bytes memory) {

277: 		    function claimFailedDeposit(

303: 		    function _claimFailedDeposit(

374: 		    function _isEraLegacyWithdrawal(uint256 _chainId, uint256 _l2BatchNumber) internal view returns (bool) {

409: 		    function _finalizeWithdrawal(

458: 		    function _checkWithdrawal(

487: 		    function _parseL2WithdrawalMessage(
```
[[104](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L104), [116](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L116), [137](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L137), [142](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L142), [173](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L173), [243](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L243), [254](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L254), [277](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L277), [303](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L303), [374](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L374), [409](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L409), [458](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L458), [487](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L487)]



```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

325: 		    function _actualRefundRecipient(address _refundRecipient) internal view returns (address _recipient) {
```
[[325](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L325)]



```solidity
File: code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol

59: 		    function stateTransitionManagerIsRegistered(address _stateTransitionManager) external view returns (bool);

61: 		    function stateTransitionManager(uint256 _chainId) external view returns (address);

63: 		    function tokenIsRegistered(address _baseToken) external view returns (bool);

65: 		    function baseToken(uint256 _chainId) external view returns (address);

67: 		    function sharedBridge() external view returns (IL1SharedBridge);

69: 		    function getStateTransition(uint256 _chainId) external view returns (address);

73: 		    function proveL2MessageInclusion(

81: 		    function proveL2LogInclusion(

89: 		    function proveL1ToL2TransactionStatus(

99: 		    function requestL2TransactionDirect(

103: 		    function requestL2TransactionTwoBridges(

107: 		    function l2TransactionBaseCost(

116: 		    function createNewChain(

125: 		    function addStateTransitionManager(address _stateTransitionManager) external;

127: 		    function removeStateTransitionManager(address _stateTransitionManager) external;

129: 		    function addToken(address _token) external;

131: 		    function setSharedBridge(address _sharedBridge) external;
```
[[59](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L59), [61](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L61), [63](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L63), [65](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L65), [67](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L67), [69](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L69), [73](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L73), [81](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L81), [89](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L89), [99](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L99), [103](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L103), [107](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L107), [116](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L116), [125](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L125), [127](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L127), [129](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L129), [131](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L131)]



```solidity
File: code/contracts/ethereum/contracts/common/ReentrancyGuard.sol

46: 		    function _initializeReentrancyGuard() private {
```
[[46](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/ReentrancyGuard.sol#L46)]



```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

84: 		    function isOperation(bytes32 _id) public view returns (bool) {

89: 		    function isOperationPending(bytes32 _id) public view returns (bool) {

95: 		    function isOperationReady(bytes32 _id) public view returns (bool) {

100: 		    function isOperationDone(bytes32 _id) public view returns (bool) {

105: 		    function getOperationState(bytes32 _id) public view returns (OperationState) {

154: 		    function cancel(bytes32 _id) external onlyOwner {

204: 		    function hashOperation(Operation calldata _operation) public pure returns (bytes32) {

215: 		    function _schedule(bytes32 _id, uint256 _delay) internal {

224: 		    function _execute(Call[] calldata _calls) internal {

249: 		    function updateDelay(uint256 _newDelay) external onlySelf {

256: 		    function updateSecurityCouncil(address _newSecurityCouncil) external onlySelf {

262: 		    receive() external payable {}
```
[[84](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L84), [89](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L89), [95](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L95), [100](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L100), [105](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L105), [154](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L154), [204](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L204), [215](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L215), [224](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L224), [249](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L249), [256](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L256), [262](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L262)]



```solidity
File: code/contracts/ethereum/contracts/governance/IGovernance.sol

41: 		    function isOperation(bytes32 _id) external view returns (bool);

43: 		    function isOperationPending(bytes32 _id) external view returns (bool);

45: 		    function isOperationReady(bytes32 _id) external view returns (bool);

47: 		    function isOperationDone(bytes32 _id) external view returns (bool);

49: 		    function getOperationState(bytes32 _id) external view returns (OperationState);

51: 		    function scheduleTransparent(Operation calldata _operation, uint256 _delay) external;

53: 		    function scheduleShadow(bytes32 _id, uint256 _delay) external;

55: 		    function cancel(bytes32 _id) external;

57: 		    function execute(Operation calldata _operation) external payable;

59: 		    function executeInstant(Operation calldata _operation) external payable;

61: 		    function hashOperation(Operation calldata _operation) external pure returns (bytes32);

63: 		    function updateDelay(uint256 _newDelay) external;

65: 		    function updateSecurityCouncil(address _newSecurityCouncil) external;
```
[[41](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L41), [43](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L43), [45](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L45), [47](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L47), [49](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L49), [51](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L51), [53](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L53), [55](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L55), [57](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L57), [59](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L59), [61](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L61), [63](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L63), [65](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L65)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol

43: 		    function bridgehub() external view returns (address);

53: 		    function stateTransition(uint256 _chainId) external view returns (address);

55: 		    function storedBatchZero() external view returns (bytes32);

57: 		    function initialCutHash() external view returns (bytes32);

59: 		    function genesisUpgrade() external view returns (address);

61: 		    function upgradeCutHash(uint256 _protocolVersion) external view returns (bytes32);

63: 		    function protocolVersion() external view returns (uint256);

65: 		    function initialize(StateTransitionManagerInitializeData calldata _initalizeData) external;

67: 		    function setInitialCutHash(Diamond.DiamondCutData calldata _diamondCut) external;

69: 		    function setValidatorTimelock(address _validatorTimelock) external;

71: 		    function getChainAdmin(uint256 _chainId) external view returns (address);

82: 		    function registerAlreadyDeployedStateTransition(uint256 _chainId, address _stateTransitionContract) external;

84: 		    function setNewVersionUpgrade(

90: 		    function setUpgradeDiamondCut(Diamond.DiamondCutData calldata _cutData, uint256 _oldProtocolVersion) external;

92: 		    function freezeChain(uint256 _chainId) external;

94: 		    function unfreezeChain(uint256 _chainId) external;
```
[[43](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L43), [53](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L53), [55](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L55), [57](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L57), [59](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L59), [61](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L61), [63](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L63), [65](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L65), [67](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L67), [69](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L69), [71](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L71), [82](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L82), [84](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L84), [90](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L90), [92](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L92), [94](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L94)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

74: 		    function getChainAdmin(uint256 _chainId) external view override returns (address) {

79: 		    function initialize(

132: 		    function setValidatorTimelock(address _validatorTimelock) external onlyOwnerOrAdmin {

137: 		    function setInitialCutHash(Diamond.DiamondCutData calldata _diamondCut) external onlyOwner {

142: 		    function setNewVersionUpgrade(

152: 		    function setUpgradeDiamondCut(

160: 		    function freezeChain(uint256 _chainId) external onlyOwner {

165: 		    function unfreezeChain(uint256 _chainId) external onlyOwner {

170: 		    function revertBatches(uint256 _chainId, uint256 _newLastBatch) external onlyOwnerOrAdmin {

177: 		    function _setChainIdUpgrade(uint256 _chainId, address _chainContract) internal {

230: 		    function registerAlreadyDeployedStateTransition(
```
[[74](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L74), [79](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L79), [132](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L132), [137](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L137), [142](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L142), [152](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L152), [160](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L160), [165](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L165), [170](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L170), [177](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L177), [230](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L230)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

73: 		    function setStateTransitionManager(IStateTransitionManager _stateTransitionManager) external onlyOwner {

78: 		    function addValidator(uint256 _chainId, address _newValidator) external onlyChainAdmin(_chainId) {

87: 		    function removeValidator(uint256 _chainId, address _validator) external onlyChainAdmin(_chainId) {

96: 		    function setExecutionDelay(uint32 _executionDelay) external onlyOwner {

102: 		    function getCommittedBatchTimestamp(uint256 _chainId, uint256 _l2BatchNumber) external view returns (uint256) {

108: 		    function commitBatches(

126: 		    function commitBatchesSharedBridge(

146: 		    function revertBatches(uint256) external onlyValidator(ERA_CHAIN_ID) {

153: 		    function revertBatchesSharedBridge(uint256 _chainId, uint256) external onlyValidator(_chainId) {

160: 		    function proveBatches(

171: 		    function proveBatchesSharedBridge(

182: 		    function executeBatches(StoredBatchInfo[] calldata _newBatchesData) external onlyValidator(ERA_CHAIN_ID) {

203: 		    function executeBatchesSharedBridge(

225: 		    function _propagateToZkSyncStateTransition(uint256 _chainId) internal {
```
[[73](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L73), [78](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L78), [87](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L87), [96](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L96), [102](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L102), [108](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L108), [126](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L126), [146](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L146), [153](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L153), [160](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L160), [171](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L171), [182](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L182), [203](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L203), [225](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L225)]



```solidity
File: code/contracts/ethereum/contracts/upgrades/IDefaultUpgrade.sol

8: 		    function upgrade(ProposedUpgrade calldata _upgrade) external returns (bytes32);
```
[[8](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/IDefaultUpgrade.sol#L8)]



```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

109: 		    function _deployL2Token(address _l1Token, bytes calldata _data) internal returns (address) {

138: 		    function _getL1WithdrawMessage(

149: 		    function l2TokenAddress(address _l1Token) public view override returns (address) {

157: 		    function _getCreate2Salt(address _l1Token) internal pure returns (bytes32 salt) {

164: 		    function _deployBeaconProxy(bytes32 salt) internal returns (BeaconProxy proxy) {
```
[[109](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L109), [138](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L138), [149](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L149), [157](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L157), [164](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L164)]



```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

159: 		    function name() public view override returns (string memory) {

165: 		    function symbol() public view override returns (string memory) {

171: 		    function decimals() public view override returns (uint8) {

178: 		    function decodeString(bytes memory _input) external pure returns (string memory result) {

183: 		    function decodeUint8(bytes memory _input) external pure returns (uint8 result) {
```
[[159](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L159), [165](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L165), [171](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L171), [178](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L178), [183](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L183)]



```solidity
File: code/contracts/zksync/contracts/interfaces/IPaymaster.sol

28: 		    function validateAndPayForPaymasterTransaction(

43: 		    function postTransaction(
```
[[28](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/interfaces/IPaymaster.sol#L28), [43](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/interfaces/IPaymaster.sol#L43)]



```solidity
File: code/contracts/zksync/contracts/interfaces/IPaymasterFlow.sol

14: 		    function general(bytes calldata input) external;

16: 		    function approvalBased(address _token, uint256 _minAllowance, bytes calldata _innerInput) external;
```
[[14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/interfaces/IPaymasterFlow.sol#L14), [16](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/interfaces/IPaymasterFlow.sol#L16)]



```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol

24: 		    function isWithdrawalFinalized(uint256 _l2BatchNumber, uint256 _l2MessageIndex) external view returns (bool);

26: 		    function deposit(

35: 		    function deposit(

43: 		    function claimFailedDeposit(

53: 		    function finalizeWithdrawal(

61: 		    function l2TokenAddress(address _l1Token) external view returns (address);

63: 		    function sharedBridge() external view returns (IL1SharedBridge);

65: 		    function l2TokenBeacon() external view returns (address);

67: 		    function l2Bridge() external view returns (address);

69: 		    function depositAmount(

75: 		    function tranferTokenToSharedBridge(address _token, uint256 _amount) external;
```
[[24](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L24), [26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L26), [35](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L35), [43](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L43), [53](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L53), [61](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L61), [63](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L63), [65](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L65), [67](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L67), [69](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L69), [75](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L75)]



```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol

58: 		    function isWithdrawalFinalized(

64: 		    function depositLegacyErc20Bridge(

74: 		    function claimFailedDepositLegacyErc20Bridge(

85: 		    function claimFailedDeposit(

97: 		    function finalizeWithdrawalLegacyErc20Bridge(

105: 		    function finalizeWithdrawal(

114: 		    function l1WethAddress() external view returns (address);

116: 		    function bridgehub() external view returns (IBridgehub);

118: 		    function legacyBridge() external view returns (IL1ERC20Bridge);

120: 		    function l2BridgeAddress(uint256 _chainId) external view returns (address);

122: 		    function depositHappened(uint256 _chainId, bytes32 _l2TxHash) external view returns (bytes32);

128: 		    function bridgehubDeposit(

135: 		    function bridgehubDepositBaseToken(

142: 		    function bridgehubConfirmL2Transaction(uint256 _chainId, bytes32 _txDataHash, bytes32 _txHash) external;

144: 		    function receiveEth(uint256 _chainId) external payable;
```
[[58](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L58), [64](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L64), [74](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L74), [85](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L85), [97](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L97), [105](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L105), [114](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L114), [116](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L116), [118](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L118), [120](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L120), [122](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L122), [128](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L128), [135](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L135), [142](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L142), [144](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L144)]



```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL2Bridge.sol

7: 		    function finalizeDeposit(

15: 		    function withdraw(address _l1Receiver, address _l2Token, uint256 _amount) external;

17: 		    function l1TokenAddress(address _l2Token) external view returns (address);

19: 		    function l2TokenAddress(address _l1Token) external view returns (address);

21: 		    function l1Bridge() external view returns (address);
```
[[7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL2Bridge.sol#L7), [15](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL2Bridge.sol#L15), [17](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL2Bridge.sol#L17), [19](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL2Bridge.sol#L19), [21](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL2Bridge.sol#L21)]



```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IWETH9.sol

5: 		    function deposit() external payable;

7: 		    function withdraw(uint256 wad) external;
```
[[5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IWETH9.sol#L5), [7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IWETH9.sol#L7)]



```solidity
File: code/contracts/ethereum/contracts/common/libraries/UncheckedMath.sol

11: 		    function uncheckedInc(uint256 _number) internal pure returns (uint256) {

17: 		    function uncheckedAdd(uint256 _lhs, uint256 _rhs) internal pure returns (uint256) {
```
[[11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/UncheckedMath.sol#L11), [17](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/UncheckedMath.sol#L17)]



```solidity
File: code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol

19: 		    function readUint32(bytes memory _bytes, uint256 _start) internal pure returns (uint32 result, uint256 offset) {

26: 		    function readAddress(bytes memory _bytes, uint256 _start) internal pure returns (address result, uint256 offset) {

33: 		    function readUint256(bytes memory _bytes, uint256 _start) internal pure returns (uint256 result, uint256 offset) {

40: 		    function readBytes32(bytes memory _bytes, uint256 _start) internal pure returns (bytes32 result, uint256 offset) {
```
[[19](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol#L19), [26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol#L26), [33](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol#L33), [40](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol#L40)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol

20: 		    fallback() external payable {
```
[[20](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol#L20)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol

45: 		    function upgradeChainFromVersion(uint256 _protocolVersion, Diamond.DiamondCutData calldata _cutData) external;
```
[[45](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L45)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol

62: 		    function initialize(InitializeData calldata _initData) external returns (bytes32);
```
[[62](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol#L62)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol

19: 		    function getVerifier() external view returns (address);

22: 		    function getAdmin() external view returns (address);

25: 		    function getPendingAdmin() external view returns (address);

28: 		    function getBridgehub() external view returns (address);

31: 		    function getStateTransitionManager() external view returns (address);

34: 		    function getBaseToken() external view returns (address);

37: 		    function getBaseTokenBridge() external view returns (address);

40: 		    function getTotalBatchesCommitted() external view returns (uint256);

43: 		    function getTotalBatchesVerified() external view returns (uint256);

46: 		    function getTotalBatchesExecuted() external view returns (uint256);

49: 		    function getTotalPriorityTxs() external view returns (uint256);

59: 		    function getPriorityQueueSize() external view returns (uint256);

62: 		    function priorityQueueFrontOperation() external view returns (PriorityOperation memory);

65: 		    function isValidator(address _address) external view returns (bool);

68: 		    function l2LogsRootHash(uint256 _batchNumber) external view returns (bytes32 merkleRoot);

76: 		    function getL2BootloaderBytecodeHash() external view returns (bytes32);

79: 		    function getL2DefaultAccountBytecodeHash() external view returns (bytes32);

82: 		    function getVerifierParams() external view returns (VerifierParams memory);

85: 		    function isDiamondStorageFrozen() external view returns (bool);

88: 		    function getProtocolVersion() external view returns (uint256);

91: 		    function getL2SystemContractsUpgradeTxHash() external view returns (bytes32);

98: 		    function getL2SystemContractsUpgradeBatchNumber() external view returns (uint256);

101: 		    function getPriorityTxMaxGasLimit() external view returns (uint256);

106: 		    function isEthWithdrawalFinalized(uint256 _l2BatchNumber, uint256 _l2MessageIndex) external view returns (bool);

109: 		    function getPubdataPricingMode() external view returns (PubdataPricingMode);

112: 		    function baseTokenGasPriceMultiplierNominator() external view returns (uint128);

115: 		    function baseTokenGasPriceMultiplierDenominator() external view returns (uint128);

130: 		    function facets() external view returns (Facet[] memory);

133: 		    function facetFunctionSelectors(address _facet) external view returns (bytes4[] memory);

136: 		    function facetAddresses() external view returns (address[] memory facets);

139: 		    function facetAddress(bytes4 _selector) external view returns (address facet);

142: 		    function isFunctionFreezable(bytes4 _selector) external view returns (bool);

145: 		    function isFacetFreezable(address _facet) external view returns (bool isFreezable);
```
[[19](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L19), [22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L22), [25](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L25), [28](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L28), [31](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L31), [34](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L34), [37](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L37), [40](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L40), [43](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L43), [46](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L46), [49](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L49), [59](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L59), [62](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L62), [65](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L65), [68](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L68), [76](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L76), [79](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L79), [82](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L82), [85](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L85), [88](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L88), [91](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L91), [98](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L98), [101](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L101), [106](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L106), [109](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L109), [112](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L112), [115](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L115), [130](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L130), [133](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L133), [136](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L136), [139](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L139), [142](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L142), [145](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L145)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/ILegacyGetters.sol

14: 		    function getTotalBlocksCommitted() external view returns (uint256);

18: 		    function getTotalBlocksVerified() external view returns (uint256);

22: 		    function getTotalBlocksExecuted() external view returns (uint256);

36: 		    function getL2SystemContractsUpgradeBlockNumber() external view returns (uint256);
```
[[14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/ILegacyGetters.sol#L14), [18](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/ILegacyGetters.sol#L18), [22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/ILegacyGetters.sol#L22), [36](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/ILegacyGetters.sol#L36)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol

98: 		    function bridgehubRequestL2Transaction(
```
[[98](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L98)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IVerifier.sol

19: 		    function verify(
```
[[19](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IVerifier.sol#L19)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransitionBase.sol

9: 		    function getName() external view returns (string memory);
```
[[9](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransitionBase.sol#L9)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/l2-deps/ISystemContext.sol

5: 		    function setChainId(uint256 _newChainId) external;
```
[[5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/l2-deps/ISystemContext.sol#L5)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol

87: 		    function getDiamondStorage() internal pure returns (DiamondStorage storage diamondStorage) {

96: 		    function diamondCut(DiamondCutData memory _diamondCut) internal {

126: 		    function _addFunctions(address _facet, bytes4[] memory _selectors, bool _isFacetFreezable) private {

149: 		    function _replaceFunctions(address _facet, bytes4[] memory _selectors, bool _isFacetFreezable) private {

172: 		    function _removeFunctions(address _facet, bytes4[] memory _selectors) private {

189: 		    function _saveFacetIfNew(address _facet) private {

205: 		    function _addOneFunction(address _facet, bytes4 _selector, bool _isSelectorFreezable) private {

228: 		    function _removeOneFunction(address _facet, bytes4 _selector) private {

257: 		    function _removeFacet(address _facet) private {

278: 		    function _initializeDiamondCut(address _init, bytes memory _calldata) private {
```
[[87](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L87), [96](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L96), [126](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L126), [149](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L149), [172](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L172), [189](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L189), [205](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L205), [228](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L228), [257](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L257), [278](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L278)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/LibMap.sol

18: 		    function get(Uint32Map storage _map, uint256 _index) internal view returns (uint32 result) {

38: 		    function set(Uint32Map storage _map, uint256 _index, uint32 _value) internal {
```
[[18](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/LibMap.sol#L18), [38](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/LibMap.sol#L38)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol

18: 		    function calculateRoot(

40: 		    function _efficientHash(bytes32 _lhs, bytes32 _rhs) private pure returns (bytes32 result) {
```
[[18](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol#L18), [40](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol#L40)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol

40: 		    function getTotalPriorityTxs(Queue storage _queue) internal view returns (uint256) {

45: 		    function getSize(Queue storage _queue) internal view returns (uint256) {

50: 		    function isEmpty(Queue storage _queue) internal view returns (bool) {

64: 		    function front(Queue storage _queue) internal view returns (PriorityOperation memory) {
```
[[40](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L40), [45](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L45), [50](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L50), [64](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L64)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol

19: 		    function validateL1ToL2Transaction(

46: 		    function validateUpgradeTransaction(L2CanonicalTransaction memory _transaction) internal pure {

69: 		    function getMinimalPriorityTransactionGasLimit(
```
[[19](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L19), [46](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L46), [69](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L69)]



```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL1ERC20Bridge.sol

9: 		    function finalizeWithdrawal(
```
[[9](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L9)]



```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL1SharedBridge.sol

9: 		    function finalizeWithdrawal(
```
[[9](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL1SharedBridge.sol#L9)]



```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol

24: 		    function finalizeDeposit(

32: 		    function withdraw(address _l1Receiver, address _l2Token, uint256 _amount) external;

34: 		    function l1TokenAddress(address _l2Token) external view returns (address);

36: 		    function l2TokenAddress(address _l1Token) external view returns (address);

38: 		    function l1Bridge() external view returns (address);
```
[[24](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol#L24), [32](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol#L32), [34](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol#L34), [36](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol#L36), [38](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol#L38)]



```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol

12: 		    function bridgeMint(address _account, uint256 _amount) external;

14: 		    function bridgeBurn(address _account, uint256 _amount) external;

16: 		    function l1Address() external view returns (address);

18: 		    function l2Bridge() external view returns (address);
```
[[12](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol#L12), [14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol#L14), [16](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol#L16), [18](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol#L18)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol

89: 		    function setValidiumMode(PubdataPricingMode _validiumMode) external onlyAdmin {

100: 		    function upgradeChainFromVersion(
```
[[89](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L89), [100](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L100)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

130: 		    function _processL2Logs(

215: 		    function _commitBatches(

253: 		    function _commitBatchesWithoutSystemContractsUpgrade(

273: 		    function _commitBatchesWithSystemContractsUpgrade(

308: 		    function _collectOperationsFromPriorityQueue(uint256 _nPriorityOps) internal returns (bytes32 concatHash) {

321: 		    function _executeOneBatch(StoredBatchInfo memory _storedBatch, uint256 _executedBatchIdx) internal {

349: 		    function _executeBatches(StoredBatchInfo[] calldata _batchesData) internal {

386: 		    function _proveBatches(

440: 		    function _verifyProof(uint256[] memory proofPublicInput, ProofInput calldata _proof) internal view {

453: 		    function _getBatchProofPublicInput(

481: 		    function _revertBatches(uint256 _newLastBatch) internal {

500: 		    function _createBatchCommitment(

515: 		    function _batchPassThroughData(CommitBatchInfo calldata _batch) internal pure returns (bytes memory) {

525: 		    function _batchMetaParameters() internal view returns (bytes memory) {

537: 		    function _batchAuxiliaryOutput(

561: 		    function _encodeBlobAuxilaryOutput(

625: 		    function _verifyBlobInformation(

679: 		    function _getBlobVersionedHash(uint256 _index) internal view returns (bytes32 versionedHash) {
```
[[130](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L130), [215](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L215), [253](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L253), [273](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L273), [308](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L308), [321](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L321), [349](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L349), [386](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L386), [440](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L440), [453](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L453), [481](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L481), [500](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L500), [515](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L515), [525](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L525), [537](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L537), [561](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L561), [625](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L625), [679](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L679)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

104: 		    function _proveL2LogInclusion(

130: 		    function _L2MessageToLog(L2Message memory _message) internal pure returns (L2Log memory) {

228: 		    function _requestL2TransactionSender(

258: 		    function _requestL2Transaction(

289: 		    function _serializeL2Transaction(
```
[[104](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L104), [130](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L130), [228](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L228), [258](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L258), [289](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L289)]

</details>

---

### [N-114] Missing NatSpec `@param` from function declaration

Some functions have an incomplete NatSpec: add a `@param` notation to describe the function parameters to improve the code documentation.

*There are 453 instances of this issue.*

<details>
<summary>Expand findings</summary>


```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

// @audit missing _address
34: 		    function getAccountInfo(address _address) external view returns (AccountInfo memory info) {

// @audit missing _address
40: 		    function extendedAccountVersion(address _address) public view returns (AccountAbstractionVersion) {

// @audit missing _address, _newInfo
58: 		    function _storeAccountInfo(address _address, AccountInfo memory _newInfo) internal {

// @audit missing _salt
147: 		    function create(

182: 		    function createAccount(

// @audit missing _deployments
238: 		    function forceDeployOnAddresses(ForceDeployment[] calldata _deployments) external payable {

// @audit missing _bytecodeHash, _newAddress, _aaVersion, _input
258: 		    function _nonSystemDeployOnAddress(

// @audit missing _bytecodeHash
301: 		    function _ensureBytecodeIsKnown(bytes32 _bytecodeHash) internal view {

// @audit missing _bytecodeHash, _callConstructor
321: 		    function _constructContract(
```
[[34](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L34), [40](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L40), [58](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L58), [147](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L147), [182](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L182), [238](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L238), [258](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L258), [301](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L301), [321](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L321)]



```solidity
File: code/system-contracts/contracts/DefaultAccount.sol

67: 		    function validateTransaction(

112: 		    function executeTransaction(

196: 		    function payForTransaction(

212: 		    function prepareForPaymaster(

220: 		    fallback() external payable ignoreInDelegateCall {

227: 		    receive() external payable {
```
[[67](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L67), [112](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L112), [196](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L196), [212](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L212), [220](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L220), [227](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L227)]



```solidity
File: code/system-contracts/contracts/EmptyContract.sol

11: 		    fallback() external payable {}

13: 		    receive() external payable {}
```
[[11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/EmptyContract.sol#L11), [13](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/EmptyContract.sol#L13)]



```solidity
File: code/system-contracts/contracts/KnownCodesStorage.sol

// @audit missing _hash
65: 		    function getMarker(bytes32 _hash) public view override returns (uint256 marker) {

// @audit missing _bytecodeHash
74: 		    function _validateBytecode(bytes32 _bytecodeHash) internal pure {
```
[[65](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/KnownCodesStorage.sol#L65), [74](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/KnownCodesStorage.sol#L74)]



```solidity
File: code/system-contracts/contracts/L1Messenger.sol

// @audit missing _length
50: 		    function keccakGasCost(uint256 _length) internal pure returns (uint256) {

// @audit missing _length
61: 		    function sha256GasCost(uint256 _length) internal pure returns (uint256) {

// @audit missing _l2ToL1Log
94: 		    function _processL2ToL1Log(L2ToL1Log memory _l2ToL1Log) internal returns (uint256 logIdInMerkleTree) {
```
[[50](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L50), [61](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L61), [94](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L94)]



```solidity
File: code/system-contracts/contracts/L2BaseToken.sol

99: 		    function _burnMsgValue() internal returns (uint256 amount) {

// @audit missing _to, _amount
112: 		    function _getL1WithdrawMessage(address _to, uint256 _amount) internal pure returns (bytes memory) {

// @audit missing _to, _amount, _sender, _additionalData
117: 		    function _getExtendedWithdrawMessage(

128: 		    function name() external pure override returns (string memory) {

134: 		    function symbol() external pure override returns (string memory) {

140: 		    function decimals() external pure override returns (uint8) {
```
[[99](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L2BaseToken.sol#L99), [112](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L2BaseToken.sol#L112), [117](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L2BaseToken.sol#L117), [128](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L2BaseToken.sol#L128), [134](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L2BaseToken.sol#L134), [140](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L2BaseToken.sol#L140)]



```solidity
File: code/system-contracts/contracts/MsgValueSimulator.sol

25: 		    function _getAbiParams() internal view returns (uint256 value, bool isSystemCall, address to) {
```
[[25](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/MsgValueSimulator.sol#L25)]



```solidity
File: code/system-contracts/contracts/SystemContext.sol

// @audit missing _gasPerPubdataByte, _basePubdataSpent
112: 		    function setPubdataInfo(uint256 _gasPerPubdataByte, uint256 _basePubdataSpent) external onlyCallFromBootloader {

117: 		    function getCurrentPubdataSpent() public view returns (uint256) {

122: 		    function getCurrentPubdataCost() external view returns (uint256) {

// @audit missing _block
132: 		    function getBlockHashEVM(uint256 _block) external view returns (bytes32 hash) {

172: 		    function getBatchNumberAndTimestamp() public view returns (uint128 batchNumber, uint128 batchTimestamp) {

180: 		    function getL2BlockNumberAndTimestamp() public view returns (uint128 blockNumber, uint128 blockTimestamp) {

190: 		    function getBlockNumber() public view returns (uint128) {

198: 		    function getBlockTimestamp() public view returns (uint128) {

408: 		    function publishTimestampDataToL1() external onlyCallFromBootloader {

// @audit missing _newTimestamp, _number, _baseFee
471: 		    function unsafeOverrideBatch(

482: 		    function incrementTxNumberInBatch() external onlyCallFromBootloader {

486: 		    function resetTxNumberInBatch() external onlyCallFromBootloader {

496: 		    function currentBlockInfo() external view returns (uint256 blockInfo) {

503: 		    function getBlockNumberAndTimestamp() external view returns (uint256 blockNumber, uint256 blockTimestamp) {

// @audit missing _blockNumber
509: 		    function blockHash(uint256 _blockNumber) external view returns (bytes32 hash) {
```
[[112](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L112), [117](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L117), [122](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L122), [132](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L132), [172](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L172), [180](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L180), [190](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L190), [198](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L198), [408](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L408), [471](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L471), [482](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L482), [486](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L486), [496](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L496), [503](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L503), [509](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L509)]



```solidity
File: code/contracts/zksync/contracts/SystemContractsCaller.sol

// @audit missing _x
27: 		    function safeCastToU32(uint256 _x) internal pure returns (uint32) {

// @audit missing gasLimit, to, value, data
37: 		    function systemCall(uint32 gasLimit, address to, uint256 value, bytes memory data) internal returns (bool success) {

// @audit missing gasLimit, to, value, data
76: 		    function systemCallWithReturndata(

// @audit missing dataOffset, memoryPage, dataStart, dataLength, gasPassed, shardId, forwardingMode, isConstructorCall, isSystemCall
95: 		    function getFarCallABI(

// @audit missing gasPassed, shardId, forwardingMode, isConstructorCall, isSystemCall
121: 		    function getFarCallABIWithEmptyFatPointer(
```
[[27](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/SystemContractsCaller.sol#L27), [37](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/SystemContractsCaller.sol#L37), [76](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/SystemContractsCaller.sol#L76), [95](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/SystemContractsCaller.sol#L95), [121](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/SystemContractsCaller.sol#L121)]



```solidity
File: code/system-contracts/contracts/interfaces/IAccount.sol

// @audit missing _txHash, _suggestedSignedHash, _transaction
26: 		    function executeTransaction(

// @audit missing _transaction
34: 		    function executeTransactionFromOutside(Transaction calldata _transaction) external payable;

// @audit missing _txHash, _suggestedSignedHash, _transaction
36: 		    function payForTransaction(

// @audit missing _txHash, _possibleSignedHash, _transaction
42: 		    function prepareForPaymaster(
```
[[26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IAccount.sol#L26), [34](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IAccount.sol#L34), [36](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IAccount.sol#L36), [42](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IAccount.sol#L42)]



```solidity
File: code/system-contracts/contracts/interfaces/IAccountCodeStorage.sol

// @audit missing _address, _hash
6: 		    function storeAccountConstructingCodeHash(address _address, bytes32 _hash) external;

// @audit missing _address, _hash
8: 		    function storeAccountConstructedCodeHash(address _address, bytes32 _hash) external;

// @audit missing _address
10: 		    function markAccountCodeHashAsConstructed(address _address) external;

// @audit missing _address
12: 		    function getRawCodeHash(address _address) external view returns (bytes32 codeHash);

// @audit missing _input
14: 		    function getCodeHash(uint256 _input) external view returns (bytes32 codeHash);

// @audit missing _input
16: 		    function getCodeSize(uint256 _input) external view returns (uint256 codeSize);
```
[[6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IAccountCodeStorage.sol#L6), [8](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IAccountCodeStorage.sol#L8), [10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IAccountCodeStorage.sol#L10), [12](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IAccountCodeStorage.sol#L12), [14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IAccountCodeStorage.sol#L14), [16](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IAccountCodeStorage.sol#L16)]



```solidity
File: code/system-contracts/contracts/interfaces/IBaseToken.sol

6: 		    function balanceOf(uint256) external view returns (uint256);

// @audit missing _from, _to, _amount
8: 		    function transferFromTo(address _from, address _to, uint256 _amount) external;

10: 		    function totalSupply() external view returns (uint256);

12: 		    function name() external pure returns (string memory);

14: 		    function symbol() external pure returns (string memory);

16: 		    function decimals() external pure returns (uint8);

// @audit missing _account, _amount
18: 		    function mint(address _account, uint256 _amount) external;

// @audit missing _l1Receiver
20: 		    function withdraw(address _l1Receiver) external payable;

// @audit missing _l1Receiver, _additionalData
22: 		    function withdrawWithMessage(address _l1Receiver, bytes calldata _additionalData) external payable;
```
[[6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBaseToken.sol#L6), [8](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBaseToken.sol#L8), [10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBaseToken.sol#L10), [12](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBaseToken.sol#L12), [14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBaseToken.sol#L14), [16](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBaseToken.sol#L16), [18](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBaseToken.sol#L18), [20](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBaseToken.sol#L20), [22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBaseToken.sol#L22)]



```solidity
File: code/system-contracts/contracts/interfaces/IBootloaderUtilities.sol

// @audit missing _transaction
8: 		    function getTransactionHashes(
```
[[8](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBootloaderUtilities.sol#L8)]



```solidity
File: code/system-contracts/contracts/interfaces/IComplexUpgrader.sol

// @audit missing _delegateTo, _calldata
11: 		    function upgrade(address _delegateTo, bytes calldata _calldata) external payable;
```
[[11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IComplexUpgrader.sol#L11)]



```solidity
File: code/system-contracts/contracts/interfaces/ICompressor.sol

// @audit missing _bytecode, _rawCompressedData
19: 		    function publishCompressedBytecode(

// @audit missing _numberOfStateDiffs, _enumerationIndexSize, _stateDiffs, _compressedStateDiffs
24: 		    function verifyCompressedStateDiffs(
```
[[19](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ICompressor.sol#L19), [24](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ICompressor.sol#L24)]



```solidity
File: code/system-contracts/contracts/interfaces/IContractDeployer.sol

// @audit missing _sender, _bytecodeHash, _salt, _input
43: 		    function getNewAddressCreate2(

// @audit missing _sender, _senderNonce
50: 		    function getNewAddressCreate(address _sender, uint256 _senderNonce) external pure returns (address newAddress);

// @audit missing _salt, _bytecodeHash, _input
52: 		    function create2(

// @audit missing _salt, _bytecodeHash, _input, _aaVersion
58: 		    function create2Account(

// @audit missing _salt, _bytecodeHash, _input
68: 		    function create(

// @audit missing _salt, _bytecodeHash, _input, _aaVersion
76: 		    function createAccount(

// @audit missing _address
84: 		    function getAccountInfo(address _address) external view returns (AccountInfo memory info);

// @audit missing _version
87: 		    function updateAccountVersion(AccountAbstractionVersion _version) external;

// @audit missing _nonceOrdering
90: 		    function updateNonceOrdering(AccountNonceOrdering _nonceOrdering) external;
```
[[43](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L43), [50](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L50), [52](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L52), [58](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L58), [68](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L68), [76](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L76), [84](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L84), [87](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L87), [90](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L90)]



```solidity
File: code/system-contracts/contracts/interfaces/IImmutableSimulator.sol

// @audit missing _dest, _index
11: 		    function getImmutable(address _dest, uint256 _index) external view returns (bytes32);

// @audit missing _dest, _immutables
13: 		    function setImmutables(address _dest, ImmutableData[] calldata _immutables) external;
```
[[11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IImmutableSimulator.sol#L11), [13](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IImmutableSimulator.sol#L13)]



```solidity
File: code/system-contracts/contracts/interfaces/IKnownCodesStorage.sol

// @audit missing _shouldSendToL1, _hashes
14: 		    function markFactoryDeps(bool _shouldSendToL1, bytes32[] calldata _hashes) external;

// @audit missing _bytecodeHash
16: 		    function markBytecodeAsPublished(bytes32 _bytecodeHash) external;

// @audit missing _hash
18: 		    function getMarker(bytes32 _hash) external view returns (uint256);
```
[[14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IKnownCodesStorage.sol#L14), [16](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IKnownCodesStorage.sol#L16), [18](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IKnownCodesStorage.sol#L18)]



```solidity
File: code/system-contracts/contracts/interfaces/IL1Messenger.sol

// @audit missing _message
49: 		    function sendToL1(bytes memory _message) external returns (bytes32);

// @audit missing _isService, _key, _value
51: 		    function sendL2ToL1Log(bool _isService, bytes32 _key, bytes32 _value) external returns (uint256 logIdInMerkleTree);

// @audit missing _bytecodeHash
54: 		    function requestBytecodeL1Publication(bytes32 _bytecodeHash) external;
```
[[49](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL1Messenger.sol#L49), [51](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL1Messenger.sol#L51), [54](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL1Messenger.sol#L54)]



```solidity
File: code/system-contracts/contracts/interfaces/IL2StandardToken.sol

// @audit missing _account, _amount
10: 		    function bridgeMint(address _account, uint256 _amount) external;

// @audit missing _account, _amount
12: 		    function bridgeBurn(address _account, uint256 _amount) external;

14: 		    function l1Address() external view returns (address);

16: 		    function l2Bridge() external view returns (address);
```
[[10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL2StandardToken.sol#L10), [12](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL2StandardToken.sol#L12), [14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL2StandardToken.sol#L14), [16](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL2StandardToken.sol#L16)]



```solidity
File: code/system-contracts/contracts/interfaces/IMailbox.sol

// @audit missing _l2BatchNumber, _l2MessageIndex, _l2TxNumberInBlock, _message, _merkleProof
6: 		    function finalizeEthWithdrawal(
```
[[6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IMailbox.sol#L6)]



```solidity
File: code/system-contracts/contracts/interfaces/INonceHolder.sol

// @audit missing _address
17: 		    function getMinNonce(address _address) external view returns (uint256);

// @audit missing _address
21: 		    function getRawNonce(address _address) external view returns (uint256);

// @audit missing _value
24: 		    function increaseMinNonce(uint256 _value) external returns (uint256);

// @audit missing _key, _value
27: 		    function setValueUnderNonce(uint256 _key, uint256 _value) external;

// @audit missing _key
30: 		    function getValueUnderNonce(uint256 _key) external view returns (uint256);

// @audit missing _expectedNonce
34: 		    function incrementMinNonceIfEquals(uint256 _expectedNonce) external;

// @audit missing _address
37: 		    function getDeploymentNonce(address _address) external view returns (uint256);

// @audit missing _address
40: 		    function incrementDeploymentNonce(address _address) external returns (uint256);

// @audit missing _address, _key, _shouldBeUsed
43: 		    function validateNonceUsage(address _address, uint256 _key, bool _shouldBeUsed) external view;

// @audit missing _address, _nonce
46: 		    function isNonceUsed(address _address, uint256 _nonce) external view returns (bool);
```
[[17](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/INonceHolder.sol#L17), [21](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/INonceHolder.sol#L21), [24](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/INonceHolder.sol#L24), [27](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/INonceHolder.sol#L27), [30](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/INonceHolder.sol#L30), [34](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/INonceHolder.sol#L34), [37](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/INonceHolder.sol#L37), [40](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/INonceHolder.sol#L40), [43](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/INonceHolder.sol#L43), [46](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/INonceHolder.sol#L46)]



```solidity
File: code/system-contracts/contracts/interfaces/IPaymaster.sol

// @audit missing _txHash, _suggestedSignedHash
43: 		    function postTransaction(
```
[[43](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IPaymaster.sol#L43)]



```solidity
File: code/system-contracts/contracts/interfaces/IPaymasterFlow.sol

// @audit missing input
13: 		    function general(bytes calldata input) external;

// @audit missing _token, _minAllowance, _innerInput
15: 		    function approvalBased(address _token, uint256 _minAllowance, bytes calldata _innerInput) external;
```
[[13](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IPaymasterFlow.sol#L13), [15](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IPaymasterFlow.sol#L15)]



```solidity
File: code/system-contracts/contracts/interfaces/ISystemContext.sol

30: 		    function chainId() external view returns (uint256);

32: 		    function origin() external view returns (address);

34: 		    function gasPrice() external view returns (uint256);

36: 		    function blockGasLimit() external view returns (uint256);

38: 		    function coinbase() external view returns (address);

40: 		    function difficulty() external view returns (uint256);

42: 		    function baseFee() external view returns (uint256);

44: 		    function txNumberInBlock() external view returns (uint16);

// @audit missing _block
46: 		    function getBlockHashEVM(uint256 _block) external view returns (bytes32);

// @audit missing _batchNumber
48: 		    function getBatchHash(uint256 _batchNumber) external view returns (bytes32 hash);

50: 		    function getBlockNumber() external view returns (uint128);

52: 		    function getBlockTimestamp() external view returns (uint128);

54: 		    function getBatchNumberAndTimestamp() external view returns (uint128 blockNumber, uint128 blockTimestamp);

56: 		    function getL2BlockNumberAndTimestamp() external view returns (uint128 blockNumber, uint128 blockTimestamp);

58: 		    function gasPerPubdataByte() external view returns (uint256 gasPerPubdataByte);

60: 		    function getCurrentPubdataSpent() external view returns (uint256 currentPubdataSpent);
```
[[30](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L30), [32](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L32), [34](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L34), [36](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L36), [38](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L38), [40](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L40), [42](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L42), [44](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L44), [46](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L46), [48](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L48), [50](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L50), [52](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L52), [54](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L54), [56](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L56), [58](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L58), [60](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L60)]



```solidity
File: code/system-contracts/contracts/interfaces/ISystemContextDeprecated.sol

11: 		    function currentBlockInfo() external view returns (uint256);

13: 		    function getBlockNumberAndTimestamp() external view returns (uint256 blockNumber, uint256 blockTimestamp);

// @audit missing _blockNumber
15: 		    function blockHash(uint256 _blockNumber) external view returns (bytes32 hash);
```
[[11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContextDeprecated.sol#L11), [13](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContextDeprecated.sol#L13), [15](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContextDeprecated.sol#L15)]



```solidity
File: code/system-contracts/contracts/libraries/EfficientCall.sol

232: 		    function propagateRevert() internal pure {
```
[[232](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L232)]



```solidity
File: code/system-contracts/contracts/libraries/RLPEncoder.sol

// @audit missing _val
11: 		    function encodeAddress(address _val) internal pure returns (bytes memory encoded) {

// @audit missing _val
24: 		    function encodeUint256(uint256 _val) internal pure returns (bytes memory encoded) {

// @audit missing _len, _offset
60: 		    function _encodeLength(uint64 _len, uint256 _offset) private pure returns (bytes memory encoded) {

// @audit missing _number
84: 		    function _highestByteSet(uint256 _number) private pure returns (uint256 hbs) {
```
[[11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/RLPEncoder.sol#L11), [24](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/RLPEncoder.sol#L24), [60](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/RLPEncoder.sol#L60), [84](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/RLPEncoder.sol#L84)]



```solidity
File: code/system-contracts/contracts/libraries/SystemContractHelper.sol

63: 		    function getCodeAddress() internal view returns (address addr) {

74: 		    function loadCalldataIntoActivePtr() internal view {

// @audit missing _farCallAbi
85: 		    function ptrPackIntoActivePtr(uint256 _farCallAbi) internal view {

// @audit missing _value
94: 		    function ptrAddIntoActive(uint32 _value) internal view {

// @audit missing _shrink
106: 		    function ptrShrinkIntoActive(uint32 _shrink) internal view {

// @audit missing _pubdataToSpend
148: 		    function unsafePrecompileCall(

203: 		    function getZkSyncMetaBytes() internal view returns (uint256 meta) {

279: 		    function getZkSyncMeta() internal view returns (ZkSyncMeta memory meta) {

296: 		    function getCallFlags() internal view returns (uint256 callFlags) {

307: 		    function getCalldataPtr() internal view returns (uint256 ptr) {

// @audit missing index
318: 		    function getExtraAbiData(uint256 index) internal view returns (uint256 extraAbiData) {

329: 		    function isSystemCall() internal view returns (bool) {

// @audit missing _pubdataToSpend
344: 		    function burnGas(uint32 _gasToPay, uint32 _pubdataToSpend) internal view {
```
[[63](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L63), [74](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L74), [85](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L85), [94](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L94), [106](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L106), [148](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L148), [203](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L203), [279](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L279), [296](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L296), [307](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L307), [318](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L318), [329](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L329), [344](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L344)]



```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

// @audit missing _transaction
100: 		    function encodeHash(Transaction calldata _transaction) internal view returns (bytes32 resultHash) {

// @audit missing _transaction
118: 		    function _encodeHashEIP712Transaction(Transaction calldata _transaction) private view returns (bytes32) {

// @audit missing _transaction
147: 		    function _encodeHashLegacyTransaction(Transaction calldata _transaction) private view returns (bytes32) {

// @audit missing _transaction
219: 		    function _encodeHashEIP2930Transaction(Transaction calldata _transaction) private view returns (bytes32) {

// @audit missing _transaction
289: 		    function _encodeHashEIP1559Transaction(Transaction calldata _transaction) private view returns (bytes32) {

// @audit missing _transaction
362: 		    function processPaymasterInput(Transaction calldata _transaction) internal {

// @audit missing _transaction
395: 		    function payToTheBootloader(Transaction calldata _transaction) internal returns (bool success) {

// @audit missing _transaction
405: 		    function totalRequiredBalance(Transaction calldata _transaction) internal pure returns (uint256 requiredBalance) {
```
[[100](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L100), [118](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L118), [147](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L147), [219](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L219), [289](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L289), [362](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L362), [395](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L395), [405](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L405)]



```solidity
File: code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol

// @audit missing _bytes, _start
19: 		    function readUint16(bytes calldata _bytes, uint256 _start) internal pure returns (uint16 result) {

// @audit missing _bytes, _start
26: 		    function readUint32(bytes calldata _bytes, uint256 _start) internal pure returns (uint32 result) {

// @audit missing _bytes, _start
33: 		    function readUint64(bytes calldata _bytes, uint256 _start) internal pure returns (uint64 result) {

// @audit missing _bytes, _start
40: 		    function readBytes32(bytes calldata _bytes, uint256 _start) internal pure returns (bytes32 result) {

// @audit missing _bytes, _start
46: 		    function readUint256(bytes calldata _bytes, uint256 _start) internal pure returns (uint256 result) {
```
[[19](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol#L19), [26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol#L26), [33](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol#L33), [40](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol#L40), [46](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol#L46)]



```solidity
File: code/system-contracts/contracts/libraries/Utils.sol

// @audit missing _x
20: 		    function safeCastToU128(uint256 _x) internal pure returns (uint128) {

// @audit missing _x
26: 		    function safeCastToU32(uint256 _x) internal pure returns (uint32) {

// @audit missing _x
32: 		    function safeCastToU24(uint256 _x) internal pure returns (uint24) {

// @audit missing _bytecodeHash
39: 		    function bytecodeLenInBytes(bytes32 _bytecodeHash) internal pure returns (uint256 codeLength) {

// @audit missing _bytecodeHash
44: 		    function bytecodeLenInWords(bytes32 _bytecodeHash) internal pure returns (uint256 codeLengthInWords) {

// @audit missing _bytecodeHash
51: 		    function isContractConstructed(bytes32 _bytecodeHash) internal pure returns (bool) {

// @audit missing _bytecodeHash
56: 		    function isContractConstructing(bytes32 _bytecodeHash) internal pure returns (bool) {
```
[[20](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L20), [26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L26), [32](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L32), [39](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L39), [44](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L44), [51](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L51), [56](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L56)]



```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

60: 		    function initialize() external reentrancyGuardInitializer {}

// @audit missing _token, _amount
63: 		    function tranferTokenToSharedBridge(address _token, uint256 _amount) external {

// @audit missing _l1Token
75: 		    function l2TokenAddress(address _l1Token) external view returns (address) {

// @audit missing _from, _token, _amount
160: 		    function _depositFundsToSharedBridge(address _from, IERC20 _token, uint256 _amount) internal returns (uint256) {
```
[[60](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L60), [63](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L63), [75](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L75), [160](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L160)]



```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

// @audit missing _eraFirstPostUpgradeBatch
104: 		    function initialize(

// @audit missing _token, _target, _targetChainId
116: 		    function transferFundsFromLegacy(address _token, address _target, uint256 _targetChainId) external onlyOwner {

// @audit missing _chainId
137: 		    function receiveEth(uint256 _chainId) external payable {

// @audit missing _chainId, _l2BridgeAddress
142: 		    function initializeChainGovernance(uint256 _chainId, address _l2BridgeAddress) external onlyOwner {

// @audit missing _chainId, _prevMsgSender, _l1Token, _amount
148: 		    function bridgehubDepositBaseToken(

// @audit missing _from, _token, _amount
173: 		    function _depositFunds(address _from, IERC20 _token, uint256 _amount) internal returns (uint256) {

// @audit missing _chainId, _prevMsgSender, _data
182: 		    function bridgehubDeposit(

// @audit missing _chainId, _txDataHash, _txHash
232: 		    function bridgehubConfirmL2Transaction(

// @audit missing _l1Sender, _l2Receiver, _l1Token, _amount
243: 		    function _getDepositL2Calldata(

// @audit missing _token
254: 		    function _getERC20Getters(address _token) internal view returns (bytes memory) {

// @audit missing _chainId
277: 		    function claimFailedDeposit(

// @audit missing _checkedInLegacyBridge, _chainId, _depositSender, _l1Token, _amount, _l2TxHash, _l2BatchNumber, _l2MessageIndex, _l2TxNumberInBatch, _merkleProof
303: 		    function _claimFailedDeposit(

// @audit missing _chainId, _l2BatchNumber, _l2MessageIndex, _l2TxNumberInBatch, _message, _merkleProof
409: 		    function _finalizeWithdrawal(

// @audit missing _chainId, _messageParams, _message, _merkleProof
458: 		    function _checkWithdrawal(

// @audit missing _chainId, _l2ToL1message
487: 		    function _parseL2WithdrawalMessage(

// @audit missing _prevMsgSender
554: 		    function depositLegacyErc20Bridge(
```
[[104](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L104), [116](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L116), [137](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L137), [142](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L142), [148](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L148), [173](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L173), [182](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L182), [232](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L232), [243](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L243), [254](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L254), [277](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L277), [303](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L303), [409](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L409), [458](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L458), [487](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L487), [554](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L554)]



```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

// @audit missing _owner
41: 		    function initialize(address _owner) external reentrancyGuardInitializer {

// @audit missing _chainId
75: 		    function getStateTransition(uint256 _chainId) public view returns (address) {

// @audit missing _stateTransitionManager
82: 		    function addStateTransitionManager(address _stateTransitionManager) external onlyOwner {

// @audit missing _stateTransitionManager
92: 		    function removeStateTransitionManager(address _stateTransitionManager) external onlyOwner {

// @audit missing _token
101: 		    function addToken(address _token) external onlyOwner {

// @audit missing _sharedBridge
108: 		    function setSharedBridge(address _sharedBridge) external onlyOwner {

// @audit missing _chainId, _stateTransitionManager, _baseToken, _admin, _initData
114: 		    function createNewChain(

// @audit missing _chainId, _batchNumber, _index, _message, _proof
152: 		    function proveL2MessageInclusion(

// @audit missing _chainId, _batchNumber, _index, _log, _proof
164: 		    function proveL2LogInclusion(

// @audit missing _chainId, _l2TxHash, _l2BatchNumber, _l2MessageIndex, _l2TxNumberInBatch, _merkleProof, _status
176: 		    function proveL1ToL2TransactionStatus(

// @audit missing _chainId, _gasPrice, _l2GasLimit, _l2GasPerPubdataByteLimit
198: 		    function l2TransactionBaseCost(

// @audit missing _request
217: 		    function requestL2TransactionDirect(

// @audit missing _request
262: 		    function requestL2TransactionTwoBridges(

// @audit missing _refundRecipient
325: 		    function _actualRefundRecipient(address _refundRecipient) internal view returns (address _recipient) {
```
[[41](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L41), [75](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L75), [82](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L82), [92](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L92), [101](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L101), [108](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L108), [114](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L114), [152](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L152), [164](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L164), [176](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L176), [198](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L198), [217](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L217), [262](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L262), [325](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L325)]



```solidity
File: code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol

56: 		    function acceptAdmin() external;

// @audit missing _stateTransitionManager
59: 		    function stateTransitionManagerIsRegistered(address _stateTransitionManager) external view returns (bool);

// @audit missing _chainId
61: 		    function stateTransitionManager(uint256 _chainId) external view returns (address);

// @audit missing _baseToken
63: 		    function tokenIsRegistered(address _baseToken) external view returns (bool);

// @audit missing _chainId
65: 		    function baseToken(uint256 _chainId) external view returns (address);

67: 		    function sharedBridge() external view returns (IL1SharedBridge);

// @audit missing _chainId
69: 		    function getStateTransition(uint256 _chainId) external view returns (address);

// @audit missing _chainId, _batchNumber, _index, _message, _proof
73: 		    function proveL2MessageInclusion(

// @audit missing _chainId, _batchNumber, _index, _log, _proof
81: 		    function proveL2LogInclusion(

// @audit missing _chainId, _l2TxHash, _l2BatchNumber, _l2MessageIndex, _l2TxNumberInBatch, _merkleProof, _status
89: 		    function proveL1ToL2TransactionStatus(

// @audit missing _request
99: 		    function requestL2TransactionDirect(

// @audit missing _request
103: 		    function requestL2TransactionTwoBridges(

// @audit missing _chainId, _gasPrice, _l2GasLimit, _l2GasPerPubdataByteLimit
107: 		    function l2TransactionBaseCost(

// @audit missing _chainId, _stateTransitionManager, _baseToken, _salt, _admin, _initData
116: 		    function createNewChain(

// @audit missing _stateTransitionManager
125: 		    function addStateTransitionManager(address _stateTransitionManager) external;

// @audit missing _stateTransitionManager
127: 		    function removeStateTransitionManager(address _stateTransitionManager) external;

// @audit missing _token
129: 		    function addToken(address _token) external;

// @audit missing _sharedBridge
131: 		    function setSharedBridge(address _sharedBridge) external;
```
[[56](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L56), [59](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L59), [61](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L61), [63](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L63), [65](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L65), [67](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L67), [69](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L69), [73](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L73), [81](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L81), [89](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L89), [99](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L99), [103](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L103), [107](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L107), [116](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L116), [125](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L125), [127](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L127), [129](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L129), [131](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L131)]



```solidity
File: code/contracts/ethereum/contracts/common/ReentrancyGuard.sol

46: 		    function _initializeReentrancyGuard() private {
```
[[46](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/ReentrancyGuard.sol#L46)]



```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

// @audit missing _id
84: 		    function isOperation(bytes32 _id) public view returns (bool) {

// @audit missing _id
89: 		    function isOperationPending(bytes32 _id) public view returns (bool) {

// @audit missing _id
95: 		    function isOperationReady(bytes32 _id) public view returns (bool) {

// @audit missing _id
100: 		    function isOperationDone(bytes32 _id) public view returns (bool) {

// @audit missing _id
105: 		    function getOperationState(bytes32 _id) public view returns (OperationState) {

262: 		    receive() external payable {}
```
[[84](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L84), [89](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L89), [95](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L95), [100](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L100), [105](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L105), [262](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L262)]



```solidity
File: code/contracts/ethereum/contracts/governance/IGovernance.sol

// @audit missing _id
41: 		    function isOperation(bytes32 _id) external view returns (bool);

// @audit missing _id
43: 		    function isOperationPending(bytes32 _id) external view returns (bool);

// @audit missing _id
45: 		    function isOperationReady(bytes32 _id) external view returns (bool);

// @audit missing _id
47: 		    function isOperationDone(bytes32 _id) external view returns (bool);

// @audit missing _id
49: 		    function getOperationState(bytes32 _id) external view returns (OperationState);

// @audit missing _operation, _delay
51: 		    function scheduleTransparent(Operation calldata _operation, uint256 _delay) external;

// @audit missing _id, _delay
53: 		    function scheduleShadow(bytes32 _id, uint256 _delay) external;

// @audit missing _id
55: 		    function cancel(bytes32 _id) external;

// @audit missing _operation
57: 		    function execute(Operation calldata _operation) external payable;

// @audit missing _operation
59: 		    function executeInstant(Operation calldata _operation) external payable;

// @audit missing _operation
61: 		    function hashOperation(Operation calldata _operation) external pure returns (bytes32);

// @audit missing _newDelay
63: 		    function updateDelay(uint256 _newDelay) external;

// @audit missing _newSecurityCouncil
65: 		    function updateSecurityCouncil(address _newSecurityCouncil) external;
```
[[41](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L41), [43](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L43), [45](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L45), [47](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L47), [49](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L49), [51](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L51), [53](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L53), [55](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L55), [57](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L57), [59](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L59), [61](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L61), [63](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L63), [65](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L65)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol

43: 		    function bridgehub() external view returns (address);

51: 		    function acceptAdmin() external;

// @audit missing _chainId
53: 		    function stateTransition(uint256 _chainId) external view returns (address);

55: 		    function storedBatchZero() external view returns (bytes32);

57: 		    function initialCutHash() external view returns (bytes32);

59: 		    function genesisUpgrade() external view returns (address);

// @audit missing _protocolVersion
61: 		    function upgradeCutHash(uint256 _protocolVersion) external view returns (bytes32);

63: 		    function protocolVersion() external view returns (uint256);

// @audit missing _initalizeData
65: 		    function initialize(StateTransitionManagerInitializeData calldata _initalizeData) external;

// @audit missing _diamondCut
67: 		    function setInitialCutHash(Diamond.DiamondCutData calldata _diamondCut) external;

// @audit missing _validatorTimelock
69: 		    function setValidatorTimelock(address _validatorTimelock) external;

// @audit missing _chainId
71: 		    function getChainAdmin(uint256 _chainId) external view returns (address);

// @audit missing _chainId, _baseToken, _sharedBridge, _admin, _diamondCut
74: 		    function createNewChain(

// @audit missing _chainId, _stateTransitionContract
82: 		    function registerAlreadyDeployedStateTransition(uint256 _chainId, address _stateTransitionContract) external;

// @audit missing _cutData, _oldProtocolVersion, _newProtocolVersion
84: 		    function setNewVersionUpgrade(

// @audit missing _cutData, _oldProtocolVersion
90: 		    function setUpgradeDiamondCut(Diamond.DiamondCutData calldata _cutData, uint256 _oldProtocolVersion) external;

// @audit missing _chainId
92: 		    function freezeChain(uint256 _chainId) external;

// @audit missing _chainId
94: 		    function unfreezeChain(uint256 _chainId) external;
```
[[43](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L43), [51](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L51), [53](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L53), [55](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L55), [57](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L57), [59](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L59), [61](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L61), [63](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L63), [65](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L65), [67](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L67), [69](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L69), [71](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L71), [74](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L74), [82](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L82), [84](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L84), [90](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L90), [92](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L92), [94](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L94)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

// @audit missing _chainId
74: 		    function getChainAdmin(uint256 _chainId) external view override returns (address) {

// @audit missing _initializeData
79: 		    function initialize(

// @audit missing _validatorTimelock
132: 		    function setValidatorTimelock(address _validatorTimelock) external onlyOwnerOrAdmin {

// @audit missing _diamondCut
137: 		    function setInitialCutHash(Diamond.DiamondCutData calldata _diamondCut) external onlyOwner {

// @audit missing _cutData, _oldProtocolVersion, _newProtocolVersion
142: 		    function setNewVersionUpgrade(

// @audit missing _cutData, _oldProtocolVersion
152: 		    function setUpgradeDiamondCut(

// @audit missing _chainId
160: 		    function freezeChain(uint256 _chainId) external onlyOwner {

// @audit missing _chainId
165: 		    function unfreezeChain(uint256 _chainId) external onlyOwner {

// @audit missing _chainId, _newLastBatch
170: 		    function revertBatches(uint256 _chainId, uint256 _newLastBatch) external onlyOwnerOrAdmin {

// @audit missing _chainId, _chainContract
177: 		    function _setChainIdUpgrade(uint256 _chainId, address _chainContract) internal {

// @audit missing _chainId, _stateTransitionContract
230: 		    function registerAlreadyDeployedStateTransition(

// @audit missing _chainId, _baseToken, _sharedBridge, _admin, _diamondCut
239: 		    function createNewChain(
```
[[74](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L74), [79](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L79), [132](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L132), [137](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L137), [142](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L142), [152](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L152), [160](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L160), [165](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L165), [170](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L170), [177](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L177), [230](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L230), [239](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L239)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

// @audit missing _stateTransitionManager
73: 		    function setStateTransitionManager(IStateTransitionManager _stateTransitionManager) external onlyOwner {

// @audit missing _chainId, _newValidator
78: 		    function addValidator(uint256 _chainId, address _newValidator) external onlyChainAdmin(_chainId) {

// @audit missing _chainId, _validator
87: 		    function removeValidator(uint256 _chainId, address _validator) external onlyChainAdmin(_chainId) {

// @audit missing _executionDelay
96: 		    function setExecutionDelay(uint32 _executionDelay) external onlyOwner {

// @audit missing _chainId, _l2BatchNumber
102: 		    function getCommittedBatchTimestamp(uint256 _chainId, uint256 _l2BatchNumber) external view returns (uint256) {

// @audit missing _newBatchesData
108: 		    function commitBatches(

// @audit missing _chainId, _newBatchesData
126: 		    function commitBatchesSharedBridge(

146: 		    function revertBatches(uint256) external onlyValidator(ERA_CHAIN_ID) {

// @audit missing _chainId
153: 		    function revertBatchesSharedBridge(uint256 _chainId, uint256) external onlyValidator(_chainId) {

160: 		    function proveBatches(

// @audit missing _chainId
171: 		    function proveBatchesSharedBridge(

// @audit missing _newBatchesData
182: 		    function executeBatches(StoredBatchInfo[] calldata _newBatchesData) external onlyValidator(ERA_CHAIN_ID) {

// @audit missing _chainId, _newBatchesData
203: 		    function executeBatchesSharedBridge(

// @audit missing _chainId
225: 		    function _propagateToZkSyncStateTransition(uint256 _chainId) internal {
```
[[73](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L73), [78](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L78), [87](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L87), [96](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L96), [102](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L102), [108](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L108), [126](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L126), [146](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L146), [153](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L153), [160](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L160), [171](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L171), [182](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L182), [203](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L203), [225](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L225)]



```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol

// @audit missing _factoryDeps, _newProtocolVersion
180: 		    function _setL2SystemContractUpgrade(
```
[[180](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L180)]



```solidity
File: code/contracts/ethereum/contracts/upgrades/IDefaultUpgrade.sol

// @audit missing _upgrade
8: 		    function upgrade(ProposedUpgrade calldata _upgrade) external returns (bytes32);
```
[[8](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/IDefaultUpgrade.sol#L8)]



```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

// @audit missing _l1LegecyBridge
49: 		    function initialize(

// @audit missing _l1Token, _data
109: 		    function _deployL2Token(address _l1Token, bytes calldata _data) internal returns (address) {

// @audit missing _to, _l1Token, _amount
138: 		    function _getL1WithdrawMessage(

// @audit missing _l1Token
149: 		    function l2TokenAddress(address _l1Token) public view override returns (address) {

// @audit missing _l1Token
157: 		    function _getCreate2Salt(address _l1Token) internal pure returns (bytes32 salt) {

// @audit missing salt
164: 		    function _deployBeaconProxy(bytes32 salt) internal returns (BeaconProxy proxy) {
```
[[49](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L49), [109](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L109), [138](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L138), [149](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L149), [157](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L157), [164](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L164)]



```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

159: 		    function name() public view override returns (string memory) {

165: 		    function symbol() public view override returns (string memory) {

171: 		    function decimals() public view override returns (uint8) {

// @audit missing _input
178: 		    function decodeString(bytes memory _input) external pure returns (string memory result) {

// @audit missing _input
183: 		    function decodeUint8(bytes memory _input) external pure returns (uint8 result) {
```
[[159](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L159), [165](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L165), [171](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L171), [178](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L178), [183](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L183)]



```solidity
File: code/contracts/zksync/contracts/interfaces/IPaymaster.sol

// @audit missing _txHash, _suggestedSignedHash
43: 		    function postTransaction(
```
[[43](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/interfaces/IPaymaster.sol#L43)]



```solidity
File: code/contracts/zksync/contracts/interfaces/IPaymasterFlow.sol

// @audit missing input
14: 		    function general(bytes calldata input) external;

// @audit missing _token, _minAllowance, _innerInput
16: 		    function approvalBased(address _token, uint256 _minAllowance, bytes calldata _innerInput) external;
```
[[14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/interfaces/IPaymasterFlow.sol#L14), [16](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/interfaces/IPaymasterFlow.sol#L16)]



```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol

// @audit missing _l2BatchNumber, _l2MessageIndex
24: 		    function isWithdrawalFinalized(uint256 _l2BatchNumber, uint256 _l2MessageIndex) external view returns (bool);

// @audit missing _l2Receiver, _l1Token, _amount, _l2TxGasLimit, _l2TxGasPerPubdataByte, _refundRecipient
26: 		    function deposit(

// @audit missing _l2Receiver, _l1Token, _amount, _l2TxGasLimit, _l2TxGasPerPubdataByte
35: 		    function deposit(

// @audit missing _depositSender, _l1Token, _l2TxHash, _l2BatchNumber, _l2MessageIndex, _l2TxNumberInBatch, _merkleProof
43: 		    function claimFailedDeposit(

// @audit missing _l2BatchNumber, _l2MessageIndex, _l2TxNumberInBatch, _message, _merkleProof
53: 		    function finalizeWithdrawal(

// @audit missing _l1Token
61: 		    function l2TokenAddress(address _l1Token) external view returns (address);

63: 		    function sharedBridge() external view returns (IL1SharedBridge);

65: 		    function l2TokenBeacon() external view returns (address);

67: 		    function l2Bridge() external view returns (address);

// @audit missing _account, _l1Token, _depositL2TxHash
69: 		    function depositAmount(

// @audit missing _token, _amount
75: 		    function tranferTokenToSharedBridge(address _token, uint256 _amount) external;
```
[[24](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L24), [26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L26), [35](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L35), [43](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L43), [53](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L53), [61](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L61), [63](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L63), [65](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L65), [67](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L67), [69](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L69), [75](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L75)]



```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol

// @audit missing _chainId, _l2BatchNumber, _l2MessageIndex
58: 		    function isWithdrawalFinalized(

// @audit missing _msgSender, _l2Receiver, _l1Token, _amount, _l2TxGasLimit, _l2TxGasPerPubdataByte, _refundRecipient
64: 		    function depositLegacyErc20Bridge(

// @audit missing _depositSender, _l1Token, _amount, _l2TxHash, _l2BatchNumber, _l2MessageIndex, _l2TxNumberInBatch, _merkleProof
74: 		    function claimFailedDepositLegacyErc20Bridge(

// @audit missing _chainId, _depositSender, _l1Token, _amount, _l2TxHash, _l2BatchNumber, _l2MessageIndex, _l2TxNumberInBatch, _merkleProof
85: 		    function claimFailedDeposit(

// @audit missing _l2BatchNumber, _l2MessageIndex, _l2TxNumberInBatch, _message, _merkleProof
97: 		    function finalizeWithdrawalLegacyErc20Bridge(

// @audit missing _chainId, _l2BatchNumber, _l2MessageIndex, _l2TxNumberInBatch, _message, _merkleProof
105: 		    function finalizeWithdrawal(

114: 		    function l1WethAddress() external view returns (address);

116: 		    function bridgehub() external view returns (IBridgehub);

118: 		    function legacyBridge() external view returns (IL1ERC20Bridge);

// @audit missing _chainId
120: 		    function l2BridgeAddress(uint256 _chainId) external view returns (address);

// @audit missing _chainId, _l2TxHash
122: 		    function depositHappened(uint256 _chainId, bytes32 _l2TxHash) external view returns (bytes32);

// @audit missing _chainId, _prevMsgSender, _l2Value, _data
128: 		    function bridgehubDeposit(

// @audit missing _chainId, _prevMsgSender, _l1Token, _amount
135: 		    function bridgehubDepositBaseToken(

// @audit missing _chainId, _txDataHash, _txHash
142: 		    function bridgehubConfirmL2Transaction(uint256 _chainId, bytes32 _txDataHash, bytes32 _txHash) external;

// @audit missing _chainId
144: 		    function receiveEth(uint256 _chainId) external payable;
```
[[58](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L58), [64](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L64), [74](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L74), [85](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L85), [97](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L97), [105](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L105), [114](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L114), [116](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L116), [118](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L118), [120](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L120), [122](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L122), [128](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L128), [135](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L135), [142](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L142), [144](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L144)]



```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL2Bridge.sol

// @audit missing _l1Sender, _l2Receiver, _l1Token, _amount, _data
7: 		    function finalizeDeposit(

// @audit missing _l1Receiver, _l2Token, _amount
15: 		    function withdraw(address _l1Receiver, address _l2Token, uint256 _amount) external;

// @audit missing _l2Token
17: 		    function l1TokenAddress(address _l2Token) external view returns (address);

// @audit missing _l1Token
19: 		    function l2TokenAddress(address _l1Token) external view returns (address);

21: 		    function l1Bridge() external view returns (address);
```
[[7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL2Bridge.sol#L7), [15](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL2Bridge.sol#L15), [17](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL2Bridge.sol#L17), [19](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL2Bridge.sol#L19), [21](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL2Bridge.sol#L21)]



```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IWETH9.sol

5: 		    function deposit() external payable;

// @audit missing wad
7: 		    function withdraw(uint256 wad) external;
```
[[5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IWETH9.sol#L5), [7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IWETH9.sol#L7)]



```solidity
File: code/contracts/ethereum/contracts/common/interfaces/IL2ContractDeployer.sol

// @audit missing _deployParams
25: 		    function forceDeployOnAddresses(ForceDeployment[] calldata _deployParams) external;
```
[[25](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/interfaces/IL2ContractDeployer.sol#L25)]



```solidity
File: code/contracts/ethereum/contracts/common/libraries/UncheckedMath.sol

// @audit missing _number
11: 		    function uncheckedInc(uint256 _number) internal pure returns (uint256) {

// @audit missing _lhs, _rhs
17: 		    function uncheckedAdd(uint256 _lhs, uint256 _rhs) internal pure returns (uint256) {
```
[[11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/UncheckedMath.sol#L11), [17](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/UncheckedMath.sol#L17)]



```solidity
File: code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol

// @audit missing _bytes, _start
19: 		    function readUint32(bytes memory _bytes, uint256 _start) internal pure returns (uint32 result, uint256 offset) {

// @audit missing _bytes, _start
26: 		    function readAddress(bytes memory _bytes, uint256 _start) internal pure returns (address result, uint256 offset) {

// @audit missing _bytes, _start
33: 		    function readUint256(bytes memory _bytes, uint256 _start) internal pure returns (uint256 result, uint256 offset) {

// @audit missing _bytes, _start
40: 		    function readBytes32(bytes memory _bytes, uint256 _start) internal pure returns (bytes32 result, uint256 offset) {
```
[[19](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol#L19), [26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol#L26), [33](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol#L33), [40](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol#L40)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol

// @audit missing _initializeData
24: 		    function initialize(InitializeData calldata _initializeData) external reentrancyGuardInitializer returns (bytes32) {
```
[[24](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol#L24)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol

20: 		    fallback() external payable {
```
[[20](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol#L20)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol

20: 		    function acceptAdmin() external;

// @audit missing _nominator, _denominator
40: 		    function setTokenMultiplier(uint128 _nominator, uint128 _denominator) external;

// @audit missing _validiumMode
43: 		    function setValidiumMode(PubdataPricingMode _validiumMode) external;

// @audit missing _protocolVersion, _cutData
45: 		    function upgradeChainFromVersion(uint256 _protocolVersion, Diamond.DiamondCutData calldata _cutData) external;

54: 		    function freezeDiamond() external;

58: 		    function unfreezeDiamond() external;
```
[[20](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L20), [40](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L40), [43](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L43), [45](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L45), [54](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L54), [58](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L58)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol

// @audit missing _initData
62: 		    function initialize(InitializeData calldata _initData) external returns (bytes32);
```
[[62](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol#L62)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol

// @audit missing _chainId, _lastCommittedBatchData, _newBatchesData
143: 		    function commitBatchesSharedBridge(

// @audit missing _chainId, _prevBatch, _committedBatches, _proof
161: 		    function proveBatchesSharedBridge(

// @audit missing _chainId, _batchesData
175: 		    function executeBatchesSharedBridge(uint256 _chainId, StoredBatchInfo[] calldata _batchesData) external;

// @audit missing _chainId, _newLastBatch
184: 		    function revertBatchesSharedBridge(uint256 _chainId, uint256 _newLastBatch) external;
```
[[143](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L143), [161](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L161), [175](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L175), [184](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L184)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol

19: 		    function getVerifier() external view returns (address);

22: 		    function getAdmin() external view returns (address);

25: 		    function getPendingAdmin() external view returns (address);

28: 		    function getBridgehub() external view returns (address);

31: 		    function getStateTransitionManager() external view returns (address);

34: 		    function getBaseToken() external view returns (address);

37: 		    function getBaseTokenBridge() external view returns (address);

40: 		    function getTotalBatchesCommitted() external view returns (uint256);

43: 		    function getTotalBatchesVerified() external view returns (uint256);

46: 		    function getTotalBatchesExecuted() external view returns (uint256);

49: 		    function getTotalPriorityTxs() external view returns (uint256);

56: 		    function getFirstUnprocessedPriorityTx() external view returns (uint256);

59: 		    function getPriorityQueueSize() external view returns (uint256);

62: 		    function priorityQueueFrontOperation() external view returns (PriorityOperation memory);

// @audit missing _address
65: 		    function isValidator(address _address) external view returns (bool);

// @audit missing _batchNumber
68: 		    function l2LogsRootHash(uint256 _batchNumber) external view returns (bytes32 merkleRoot);

// @audit missing _batchNumber
73: 		    function storedBatchHash(uint256 _batchNumber) external view returns (bytes32);

76: 		    function getL2BootloaderBytecodeHash() external view returns (bytes32);

79: 		    function getL2DefaultAccountBytecodeHash() external view returns (bytes32);

82: 		    function getVerifierParams() external view returns (VerifierParams memory);

85: 		    function isDiamondStorageFrozen() external view returns (bool);

88: 		    function getProtocolVersion() external view returns (uint256);

91: 		    function getL2SystemContractsUpgradeTxHash() external view returns (bytes32);

98: 		    function getL2SystemContractsUpgradeBatchNumber() external view returns (uint256);

101: 		    function getPriorityTxMaxGasLimit() external view returns (uint256);

109: 		    function getPubdataPricingMode() external view returns (PubdataPricingMode);

112: 		    function baseTokenGasPriceMultiplierNominator() external view returns (uint128);

115: 		    function baseTokenGasPriceMultiplierDenominator() external view returns (uint128);

130: 		    function facets() external view returns (Facet[] memory);

// @audit missing _facet
133: 		    function facetFunctionSelectors(address _facet) external view returns (bytes4[] memory);

136: 		    function facetAddresses() external view returns (address[] memory facets);

// @audit missing _selector
139: 		    function facetAddress(bytes4 _selector) external view returns (address facet);

// @audit missing _selector
142: 		    function isFunctionFreezable(bytes4 _selector) external view returns (bool);

// @audit missing _facet
145: 		    function isFacetFreezable(address _facet) external view returns (bool isFreezable);
```
[[19](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L19), [22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L22), [25](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L25), [28](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L28), [31](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L31), [34](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L34), [37](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L37), [40](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L40), [43](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L43), [46](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L46), [49](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L49), [56](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L56), [59](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L59), [62](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L62), [65](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L65), [68](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L68), [73](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L73), [76](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L76), [79](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L79), [82](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L82), [85](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L85), [88](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L88), [91](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L91), [98](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L98), [101](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L101), [109](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L109), [112](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L112), [115](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L115), [130](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L130), [133](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L133), [136](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L136), [139](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L139), [142](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L142), [145](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L145)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/ILegacyGetters.sol

14: 		    function getTotalBlocksCommitted() external view returns (uint256);

18: 		    function getTotalBlocksVerified() external view returns (uint256);

22: 		    function getTotalBlocksExecuted() external view returns (uint256);

// @audit missing _batchNumber
28: 		    function storedBlockHash(uint256 _batchNumber) external view returns (bytes32);

36: 		    function getL2SystemContractsUpgradeBlockNumber() external view returns (uint256);
```
[[14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/ILegacyGetters.sol#L14), [18](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/ILegacyGetters.sol#L18), [22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/ILegacyGetters.sol#L22), [28](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/ILegacyGetters.sol#L28), [36](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/ILegacyGetters.sol#L36)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol

// @audit missing _request
98: 		    function bridgehubRequestL2Transaction(

114: 		    function transferEthToSharedBridge() external;
```
[[98](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L98), [114](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L114)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IVerifier.sol

// @audit missing _publicInputs, _proof, _recursiveAggregationInput
19: 		    function verify(

27: 		    function verificationKeyHash() external pure returns (bytes32);
```
[[19](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IVerifier.sol#L19), [27](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IVerifier.sol#L27)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransitionBase.sol

9: 		    function getName() external view returns (string memory);
```
[[9](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransitionBase.sol#L9)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/l2-deps/ISystemContext.sol

// @audit missing _newChainId
5: 		    function setChainId(uint256 _newChainId) external;
```
[[5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/l2-deps/ISystemContext.sol#L5)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol

87: 		    function getDiamondStorage() internal pure returns (DiamondStorage storage diamondStorage) {

// @audit missing _facet, _selectors, _isFacetFreezable
126: 		    function _addFunctions(address _facet, bytes4[] memory _selectors, bool _isFacetFreezable) private {

// @audit missing _facet, _selectors, _isFacetFreezable
149: 		    function _replaceFunctions(address _facet, bytes4[] memory _selectors, bool _isFacetFreezable) private {

// @audit missing _facet, _selectors
172: 		    function _removeFunctions(address _facet, bytes4[] memory _selectors) private {

// @audit missing _facet
189: 		    function _saveFacetIfNew(address _facet) private {

// @audit missing _facet, _selector, _isSelectorFreezable
205: 		    function _addOneFunction(address _facet, bytes4 _selector, bool _isSelectorFreezable) private {

// @audit missing _facet, _selector
228: 		    function _removeOneFunction(address _facet, bytes4 _selector) private {

// @audit missing _facet
257: 		    function _removeFacet(address _facet) private {

// @audit missing _init, _calldata
278: 		    function _initializeDiamondCut(address _init, bytes memory _calldata) private {
```
[[87](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L87), [126](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L126), [149](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L149), [172](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L172), [189](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L189), [205](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L205), [228](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L228), [257](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L257), [278](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L278)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol

// @audit missing _lhs, _rhs
40: 		    function _efficientHash(bytes32 _lhs, bytes32 _rhs) private pure returns (bytes32 result) {
```
[[40](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol#L40)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol

// @audit missing _queue
35: 		    function getFirstUnprocessedPriorityTx(Queue storage _queue) internal view returns (uint256) {

// @audit missing _queue
40: 		    function getTotalPriorityTxs(Queue storage _queue) internal view returns (uint256) {

// @audit missing _queue
45: 		    function getSize(Queue storage _queue) internal view returns (uint256) {

// @audit missing _queue
50: 		    function isEmpty(Queue storage _queue) internal view returns (bool) {

// @audit missing _queue, _operation
55: 		    function pushBack(Queue storage _queue, PriorityOperation memory _operation) internal {

// @audit missing _queue
64: 		    function front(Queue storage _queue) internal view returns (PriorityOperation memory) {

// @audit missing _queue
72: 		    function popFront(Queue storage _queue) internal returns (PriorityOperation memory priorityOperation) {
```
[[35](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L35), [40](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L40), [45](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L45), [50](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L50), [55](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L55), [64](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L64), [72](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L72)]



```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL1ERC20Bridge.sol

// @audit missing _l2BatchNumber, _l2MessageIndex, _l2TxNumberInBatch, _message, _merkleProof
9: 		    function finalizeWithdrawal(
```
[[9](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L9)]



```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL1SharedBridge.sol

// @audit missing _chainId, _l2BatchNumber, _l2MessageIndex, _l2TxNumberInBatch, _message, _merkleProof
9: 		    function finalizeWithdrawal(
```
[[9](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL1SharedBridge.sol#L9)]



```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol

// @audit missing _l1Sender, _l2Receiver, _l1Token, _amount, _data
24: 		    function finalizeDeposit(

// @audit missing _l1Receiver, _l2Token, _amount
32: 		    function withdraw(address _l1Receiver, address _l2Token, uint256 _amount) external;

// @audit missing _l2Token
34: 		    function l1TokenAddress(address _l2Token) external view returns (address);

// @audit missing _l1Token
36: 		    function l2TokenAddress(address _l1Token) external view returns (address);

38: 		    function l1Bridge() external view returns (address);
```
[[24](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol#L24), [32](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol#L32), [34](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol#L34), [36](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol#L36), [38](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol#L38)]



```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol

// @audit missing _account, _amount
12: 		    function bridgeMint(address _account, uint256 _amount) external;

// @audit missing _account, _amount
14: 		    function bridgeBurn(address _account, uint256 _amount) external;

16: 		    function l1Address() external view returns (address);

18: 		    function l2Bridge() external view returns (address);
```
[[12](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol#L12), [14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol#L14), [16](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol#L16), [18](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol#L18)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol

// @audit missing _validiumMode
89: 		    function setValidiumMode(PubdataPricingMode _validiumMode) external onlyAdmin {

// @audit missing _oldProtocolVersion, _diamondCut
100: 		    function upgradeChainFromVersion(
```
[[89](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L89), [100](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L100)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

// @audit missing _previousBatch, _newBatch, _expectedSystemContractUpgradeTxHash
32: 		    function _commitOneBatch(

// @audit missing _newBatch, _expectedSystemContractUpgradeTxHash
130: 		    function _processL2Logs(

// @audit missing _lastCommittedBatchData, _newBatchesData
215: 		    function _commitBatches(

// @audit missing _nPriorityOps
308: 		    function _collectOperationsFromPriorityQueue(uint256 _nPriorityOps) internal returns (bytes32 concatHash) {

// @audit missing _storedBatch, _executedBatchIdx
321: 		    function _executeOneBatch(StoredBatchInfo memory _storedBatch, uint256 _executedBatchIdx) internal {

// @audit missing _batchesData
349: 		    function _executeBatches(StoredBatchInfo[] calldata _batchesData) internal {

// @audit missing _prevBatch, _committedBatches, _proof
386: 		    function _proveBatches(

// @audit missing proofPublicInput, _proof
440: 		    function _verifyProof(uint256[] memory proofPublicInput, ProofInput calldata _proof) internal view {

// @audit missing _prevBatchCommitment, _currentBatchCommitment, _verifierParams
453: 		    function _getBatchProofPublicInput(

// @audit missing _newLastBatch
481: 		    function _revertBatches(uint256 _newLastBatch) internal {

// @audit missing _newBatchData, _stateDiffHash, _blobCommitments, _blobHashes
500: 		    function _createBatchCommitment(

// @audit missing _batch
515: 		    function _batchPassThroughData(CommitBatchInfo calldata _batch) internal pure returns (bytes memory) {

525: 		    function _batchMetaParameters() internal view returns (bytes memory) {

// @audit missing _batch, _stateDiffHash, _blobCommitments, _blobHashes
537: 		    function _batchAuxiliaryOutput(

561: 		    function _encodeBlobAuxilaryOutput(

// @audit missing _storedBatchInfo
587: 		    function _hashStoredBatchInfo(StoredBatchInfo memory _storedBatchInfo) internal pure returns (bytes32) {

// @audit missing _bitMap, _index
592: 		    function _checkBit(uint256 _bitMap, uint8 _index) internal pure returns (bool) {

// @audit missing _bitMap, _index
597: 		    function _setBit(uint256 _bitMap, uint8 _index) internal pure returns (uint256) {

// @audit missing _versionedHash, _openingPoint, _openingValueCommitmentProof
605: 		    function _pointEvaluationPrecompile(

// @audit missing _pubdataCommitments, _blobHashes
625: 		    function _verifyBlobInformation(

// @audit missing _index
679: 		    function _getBlobVersionedHash(uint256 _index) internal view returns (bytes32 versionedHash) {
```
[[32](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L32), [130](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L130), [215](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L215), [308](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L308), [321](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L321), [349](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L349), [386](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L386), [440](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L440), [453](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L453), [481](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L481), [500](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L500), [515](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L515), [525](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L525), [537](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L537), [561](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L561), [587](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L587), [592](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L592), [597](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L597), [605](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L605), [625](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L625), [679](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L679)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

// @audit missing _request
47: 		    function bridgehubRequestL2Transaction(

// @audit missing _batchNumber, _index, _log, _proof
104: 		    function _proveL2LogInclusion(

// @audit missing _message
130: 		    function _L2MessageToLog(L2Message memory _message) internal pure returns (L2Log memory) {

// @audit missing _request
228: 		    function _requestL2TransactionSender(

// @audit missing _mintValue, _params, _calldata, _factoryDeps
258: 		    function _requestL2Transaction(

// @audit missing _priorityOpParams, _calldata, _factoryDeps
289: 		    function _serializeL2Transaction(

// @audit missing _priorityOpParams, _calldata, _factoryDeps
316: 		    function _writePriorityOp(

// @audit missing _factoryDeps
353: 		    function _hashFactoryDeps(bytes[] memory _factoryDeps) internal pure returns (uint256[] memory hashedFactoryDeps) {
```
[[47](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L47), [104](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L104), [130](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L130), [228](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L228), [258](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L258), [289](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L289), [316](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L316), [353](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L353)]

</details>

---

### [N-115] Incomplete NatSpec `@return` from function declaration

Some functions have an incomplete NatSpec: add a `@return` notation to describe the function return value to improve the code documentation.

*There are 229 instances of this issue.*

<details>
<summary>Expand findings</summary>


```solidity
File: code/system-contracts/contracts/Compressor.sol

197: 		    function _decodeRawBytecode(
```
[[197](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L197)]



```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

34: 		    function getAccountInfo(address _address) external view returns (AccountInfo memory info) {

40: 		    function extendedAccountVersion(address _address) public view returns (AccountAbstractionVersion) {

115: 		    function getNewAddressCreate(

132: 		    function create2(

147: 		    function create(

162: 		    function create2Account(

182: 		    function createAccount(
```
[[34](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L34), [40](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L40), [115](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L115), [132](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L132), [147](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L147), [162](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L162), [182](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L182)]



```solidity
File: code/system-contracts/contracts/DefaultAccount.sol

67: 		    function validateTransaction(

78: 		    function _validateTransaction(
```
[[67](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L67), [78](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L78)]



```solidity
File: code/system-contracts/contracts/KnownCodesStorage.sol

65: 		    function getMarker(bytes32 _hash) public view override returns (uint256 marker) {
```
[[65](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/KnownCodesStorage.sol#L65)]



```solidity
File: code/system-contracts/contracts/L1Messenger.sol

50: 		    function keccakGasCost(uint256 _length) internal pure returns (uint256) {

61: 		    function sha256GasCost(uint256 _length) internal pure returns (uint256) {

70: 		    function sendL2ToL1Log(

94: 		    function _processL2ToL1Log(L2ToL1Log memory _l2ToL1Log) internal returns (uint256 logIdInMerkleTree) {

116: 		    function sendToL1(bytes calldata _message) external override returns (bytes32 hash) {
```
[[50](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L50), [61](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L61), [70](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L70), [94](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L94), [116](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L116)]



```solidity
File: code/system-contracts/contracts/L2BaseToken.sol

56: 		    function balanceOf(uint256 _account) external view override returns (uint256) {

99: 		    function _burnMsgValue() internal returns (uint256 amount) {

112: 		    function _getL1WithdrawMessage(address _to, uint256 _amount) internal pure returns (bytes memory) {

117: 		    function _getExtendedWithdrawMessage(

128: 		    function name() external pure override returns (string memory) {

134: 		    function symbol() external pure override returns (string memory) {

140: 		    function decimals() external pure override returns (uint8) {
```
[[56](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L2BaseToken.sol#L56), [99](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L2BaseToken.sol#L99), [112](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L2BaseToken.sol#L112), [117](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L2BaseToken.sol#L117), [128](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L2BaseToken.sol#L128), [134](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L2BaseToken.sol#L134), [140](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L2BaseToken.sol#L140)]



```solidity
File: code/system-contracts/contracts/MsgValueSimulator.sol

25: 		    function _getAbiParams() internal view returns (uint256 value, bool isSystemCall, address to) {
```
[[25](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/MsgValueSimulator.sol#L25)]



```solidity
File: code/system-contracts/contracts/SystemContext.sol

117: 		    function getCurrentPubdataSpent() public view returns (uint256) {

122: 		    function getCurrentPubdataCost() external view returns (uint256) {

221: 		    function _calculateL2BlockHash(

233: 		    function _calculateLegacyL2BlockHash(uint128 _blockNumber) internal pure returns (bytes32) {

496: 		    function currentBlockInfo() external view returns (uint256 blockInfo) {

503: 		    function getBlockNumberAndTimestamp() external view returns (uint256 blockNumber, uint256 blockTimestamp) {

509: 		    function blockHash(uint256 _blockNumber) external view returns (bytes32 hash) {
```
[[117](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L117), [122](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L122), [221](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L221), [233](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L233), [496](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L496), [503](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L503), [509](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L509)]



```solidity
File: code/contracts/zksync/contracts/L2ContractHelper.sol

53: 		    function create2(bytes32 _salt, bytes32 _bytecodeHash, bytes calldata _input) external returns (address);
```
[[53](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/L2ContractHelper.sol#L53)]



```solidity
File: code/contracts/zksync/contracts/SystemContractsCaller.sol

27: 		    function safeCastToU32(uint256 _x) internal pure returns (uint32) {

37: 		    function systemCall(uint32 gasLimit, address to, uint256 value, bytes memory data) internal returns (bool success) {

76: 		    function systemCallWithReturndata(

95: 		    function getFarCallABI(

121: 		    function getFarCallABIWithEmptyFatPointer(
```
[[27](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/SystemContractsCaller.sol#L27), [37](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/SystemContractsCaller.sol#L37), [76](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/SystemContractsCaller.sol#L76), [95](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/SystemContractsCaller.sol#L95), [121](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/SystemContractsCaller.sol#L121)]



```solidity
File: code/system-contracts/contracts/interfaces/IAccountCodeStorage.sol

12: 		    function getRawCodeHash(address _address) external view returns (bytes32 codeHash);

14: 		    function getCodeHash(uint256 _input) external view returns (bytes32 codeHash);

16: 		    function getCodeSize(uint256 _input) external view returns (uint256 codeSize);
```
[[12](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IAccountCodeStorage.sol#L12), [14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IAccountCodeStorage.sol#L14), [16](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IAccountCodeStorage.sol#L16)]



```solidity
File: code/system-contracts/contracts/interfaces/IBaseToken.sol

6: 		    function balanceOf(uint256) external view returns (uint256);

10: 		    function totalSupply() external view returns (uint256);

12: 		    function name() external pure returns (string memory);

14: 		    function symbol() external pure returns (string memory);

16: 		    function decimals() external pure returns (uint8);
```
[[6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBaseToken.sol#L6), [10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBaseToken.sol#L10), [12](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBaseToken.sol#L12), [14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBaseToken.sol#L14), [16](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBaseToken.sol#L16)]



```solidity
File: code/system-contracts/contracts/interfaces/IBootloaderUtilities.sol

8: 		    function getTransactionHashes(
```
[[8](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBootloaderUtilities.sol#L8)]



```solidity
File: code/system-contracts/contracts/interfaces/ICompressor.sol

19: 		    function publishCompressedBytecode(

24: 		    function verifyCompressedStateDiffs(
```
[[19](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ICompressor.sol#L19), [24](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ICompressor.sol#L24)]



```solidity
File: code/system-contracts/contracts/interfaces/IContractDeployer.sol

43: 		    function getNewAddressCreate2(

50: 		    function getNewAddressCreate(address _sender, uint256 _senderNonce) external pure returns (address newAddress);

52: 		    function create2(

58: 		    function create2Account(

68: 		    function create(

76: 		    function createAccount(

84: 		    function getAccountInfo(address _address) external view returns (AccountInfo memory info);
```
[[43](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L43), [50](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L50), [52](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L52), [58](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L58), [68](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L68), [76](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L76), [84](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L84)]



```solidity
File: code/system-contracts/contracts/interfaces/IImmutableSimulator.sol

11: 		    function getImmutable(address _dest, uint256 _index) external view returns (bytes32);
```
[[11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IImmutableSimulator.sol#L11)]



```solidity
File: code/system-contracts/contracts/interfaces/IKnownCodesStorage.sol

18: 		    function getMarker(bytes32 _hash) external view returns (uint256);
```
[[18](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IKnownCodesStorage.sol#L18)]



```solidity
File: code/system-contracts/contracts/interfaces/IL1Messenger.sol

49: 		    function sendToL1(bytes memory _message) external returns (bytes32);

51: 		    function sendL2ToL1Log(bool _isService, bytes32 _key, bytes32 _value) external returns (uint256 logIdInMerkleTree);
```
[[49](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL1Messenger.sol#L49), [51](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL1Messenger.sol#L51)]



```solidity
File: code/system-contracts/contracts/interfaces/IL2StandardToken.sol

14: 		    function l1Address() external view returns (address);

16: 		    function l2Bridge() external view returns (address);
```
[[14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL2StandardToken.sol#L14), [16](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL2StandardToken.sol#L16)]



```solidity
File: code/system-contracts/contracts/interfaces/INonceHolder.sol

17: 		    function getMinNonce(address _address) external view returns (uint256);

21: 		    function getRawNonce(address _address) external view returns (uint256);

24: 		    function increaseMinNonce(uint256 _value) external returns (uint256);

30: 		    function getValueUnderNonce(uint256 _key) external view returns (uint256);

37: 		    function getDeploymentNonce(address _address) external view returns (uint256);

40: 		    function incrementDeploymentNonce(address _address) external returns (uint256);

46: 		    function isNonceUsed(address _address, uint256 _nonce) external view returns (bool);
```
[[17](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/INonceHolder.sol#L17), [21](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/INonceHolder.sol#L21), [24](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/INonceHolder.sol#L24), [30](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/INonceHolder.sol#L30), [37](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/INonceHolder.sol#L37), [40](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/INonceHolder.sol#L40), [46](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/INonceHolder.sol#L46)]



```solidity
File: code/system-contracts/contracts/interfaces/ISystemContext.sol

30: 		    function chainId() external view returns (uint256);

32: 		    function origin() external view returns (address);

34: 		    function gasPrice() external view returns (uint256);

36: 		    function blockGasLimit() external view returns (uint256);

38: 		    function coinbase() external view returns (address);

40: 		    function difficulty() external view returns (uint256);

42: 		    function baseFee() external view returns (uint256);

44: 		    function txNumberInBlock() external view returns (uint16);

46: 		    function getBlockHashEVM(uint256 _block) external view returns (bytes32);

48: 		    function getBatchHash(uint256 _batchNumber) external view returns (bytes32 hash);

50: 		    function getBlockNumber() external view returns (uint128);

52: 		    function getBlockTimestamp() external view returns (uint128);

54: 		    function getBatchNumberAndTimestamp() external view returns (uint128 blockNumber, uint128 blockTimestamp);

56: 		    function getL2BlockNumberAndTimestamp() external view returns (uint128 blockNumber, uint128 blockTimestamp);

58: 		    function gasPerPubdataByte() external view returns (uint256 gasPerPubdataByte);

60: 		    function getCurrentPubdataSpent() external view returns (uint256 currentPubdataSpent);
```
[[30](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L30), [32](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L32), [34](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L34), [36](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L36), [38](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L38), [40](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L40), [42](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L42), [44](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L44), [46](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L46), [48](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L48), [50](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L50), [52](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L52), [54](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L54), [56](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L56), [58](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L58), [60](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L60)]



```solidity
File: code/system-contracts/contracts/interfaces/ISystemContextDeprecated.sol

11: 		    function currentBlockInfo() external view returns (uint256);

13: 		    function getBlockNumberAndTimestamp() external view returns (uint256 blockNumber, uint256 blockTimestamp);

15: 		    function blockHash(uint256 _blockNumber) external view returns (bytes32 hash);
```
[[11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContextDeprecated.sol#L11), [13](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContextDeprecated.sol#L13), [15](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContextDeprecated.sol#L15)]



```solidity
File: code/system-contracts/contracts/libraries/RLPEncoder.sol

11: 		    function encodeAddress(address _val) internal pure returns (bytes memory encoded) {

24: 		    function encodeUint256(uint256 _val) internal pure returns (bytes memory encoded) {

49: 		    function encodeNonSingleBytesLen(uint64 _len) internal pure returns (bytes memory) {

56: 		    function encodeListLen(uint64 _len) internal pure returns (bytes memory) {

60: 		    function _encodeLength(uint64 _len, uint256 _offset) private pure returns (bytes memory encoded) {

84: 		    function _highestByteSet(uint256 _number) private pure returns (uint256 hbs) {
```
[[11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/RLPEncoder.sol#L11), [24](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/RLPEncoder.sol#L24), [49](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/RLPEncoder.sol#L49), [56](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/RLPEncoder.sol#L56), [60](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/RLPEncoder.sol#L60), [84](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/RLPEncoder.sol#L84)]



```solidity
File: code/system-contracts/contracts/libraries/SystemContractHelper.sol

63: 		    function getCodeAddress() internal view returns (address addr) {

124: 		    function packPrecompileParams(

168: 		    function setValueForNextFarCall(uint128 _value) internal returns (bool success) {
```
[[63](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L63), [124](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L124), [168](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L168)]



```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

100: 		    function encodeHash(Transaction calldata _transaction) internal view returns (bytes32 resultHash) {

395: 		    function payToTheBootloader(Transaction calldata _transaction) internal returns (bool success) {

405: 		    function totalRequiredBalance(Transaction calldata _transaction) internal pure returns (uint256 requiredBalance) {
```
[[100](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L100), [395](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L395), [405](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L405)]



```solidity
File: code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol

19: 		    function readUint16(bytes calldata _bytes, uint256 _start) internal pure returns (uint16 result) {

26: 		    function readUint32(bytes calldata _bytes, uint256 _start) internal pure returns (uint32 result) {

33: 		    function readUint64(bytes calldata _bytes, uint256 _start) internal pure returns (uint64 result) {

40: 		    function readBytes32(bytes calldata _bytes, uint256 _start) internal pure returns (bytes32 result) {

46: 		    function readUint256(bytes calldata _bytes, uint256 _start) internal pure returns (uint256 result) {
```
[[19](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol#L19), [26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol#L26), [33](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol#L33), [40](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol#L40), [46](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol#L46)]



```solidity
File: code/system-contracts/contracts/libraries/Utils.sol

20: 		    function safeCastToU128(uint256 _x) internal pure returns (uint128) {

26: 		    function safeCastToU32(uint256 _x) internal pure returns (uint32) {

32: 		    function safeCastToU24(uint256 _x) internal pure returns (uint24) {

51: 		    function isContractConstructed(bytes32 _bytecodeHash) internal pure returns (bool) {

56: 		    function isContractConstructing(bytes32 _bytecodeHash) internal pure returns (bool) {
```
[[20](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L20), [26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L26), [32](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L32), [51](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L51), [56](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L56)]



```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

182: 		    function bridgehubDeposit(

243: 		    function _getDepositL2Calldata(

254: 		    function _getERC20Getters(address _token) internal view returns (bytes memory) {

409: 		    function _finalizeWithdrawal(

458: 		    function _checkWithdrawal(

487: 		    function _parseL2WithdrawalMessage(
```
[[182](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L182), [243](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L243), [254](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L254), [409](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L409), [458](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L458), [487](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L487)]



```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

75: 		    function getStateTransition(uint256 _chainId) public view returns (address) {

114: 		    function createNewChain(

152: 		    function proveL2MessageInclusion(

164: 		    function proveL2LogInclusion(

176: 		    function proveL1ToL2TransactionStatus(

198: 		    function l2TransactionBaseCost(

217: 		    function requestL2TransactionDirect(

262: 		    function requestL2TransactionTwoBridges(

325: 		    function _actualRefundRecipient(address _refundRecipient) internal view returns (address _recipient) {
```
[[75](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L75), [114](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L114), [152](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L152), [164](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L164), [176](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L176), [198](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L198), [217](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L217), [262](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L262), [325](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L325)]



```solidity
File: code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol

59: 		    function stateTransitionManagerIsRegistered(address _stateTransitionManager) external view returns (bool);

61: 		    function stateTransitionManager(uint256 _chainId) external view returns (address);

63: 		    function tokenIsRegistered(address _baseToken) external view returns (bool);

65: 		    function baseToken(uint256 _chainId) external view returns (address);

67: 		    function sharedBridge() external view returns (IL1SharedBridge);

69: 		    function getStateTransition(uint256 _chainId) external view returns (address);

73: 		    function proveL2MessageInclusion(

81: 		    function proveL2LogInclusion(

89: 		    function proveL1ToL2TransactionStatus(

99: 		    function requestL2TransactionDirect(

103: 		    function requestL2TransactionTwoBridges(

107: 		    function l2TransactionBaseCost(

116: 		    function createNewChain(
```
[[59](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L59), [61](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L61), [63](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L63), [65](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L65), [67](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L67), [69](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L69), [73](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L73), [81](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L81), [89](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L89), [99](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L99), [103](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L103), [107](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L107), [116](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L116)]



```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

84: 		    function isOperation(bytes32 _id) public view returns (bool) {

89: 		    function isOperationPending(bytes32 _id) public view returns (bool) {

95: 		    function isOperationReady(bytes32 _id) public view returns (bool) {

100: 		    function isOperationDone(bytes32 _id) public view returns (bool) {

105: 		    function getOperationState(bytes32 _id) public view returns (OperationState) {

204: 		    function hashOperation(Operation calldata _operation) public pure returns (bytes32) {
```
[[84](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L84), [89](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L89), [95](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L95), [100](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L100), [105](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L105), [204](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L204)]



```solidity
File: code/contracts/ethereum/contracts/governance/IGovernance.sol

41: 		    function isOperation(bytes32 _id) external view returns (bool);

43: 		    function isOperationPending(bytes32 _id) external view returns (bool);

45: 		    function isOperationReady(bytes32 _id) external view returns (bool);

47: 		    function isOperationDone(bytes32 _id) external view returns (bool);

49: 		    function getOperationState(bytes32 _id) external view returns (OperationState);

61: 		    function hashOperation(Operation calldata _operation) external pure returns (bytes32);
```
[[41](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L41), [43](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L43), [45](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L45), [47](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L47), [49](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L49), [61](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L61)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol

43: 		    function bridgehub() external view returns (address);

53: 		    function stateTransition(uint256 _chainId) external view returns (address);

55: 		    function storedBatchZero() external view returns (bytes32);

57: 		    function initialCutHash() external view returns (bytes32);

59: 		    function genesisUpgrade() external view returns (address);

61: 		    function upgradeCutHash(uint256 _protocolVersion) external view returns (bytes32);

63: 		    function protocolVersion() external view returns (uint256);

71: 		    function getChainAdmin(uint256 _chainId) external view returns (address);
```
[[43](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L43), [53](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L53), [55](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L55), [57](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L57), [59](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L59), [61](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L61), [63](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L63), [71](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L71)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

74: 		    function getChainAdmin(uint256 _chainId) external view override returns (address) {
```
[[74](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L74)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

102: 		    function getCommittedBatchTimestamp(uint256 _chainId, uint256 _l2BatchNumber) external view returns (uint256) {
```
[[102](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L102)]



```solidity
File: code/contracts/ethereum/contracts/upgrades/DefaultUpgrade.sol

13: 		    function upgrade(ProposedUpgrade calldata _proposedUpgrade) public override returns (bytes32) {
```
[[13](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/DefaultUpgrade.sol#L13)]



```solidity
File: code/contracts/ethereum/contracts/upgrades/GenesisUpgrade.sol

14: 		    function upgrade(ProposedUpgrade calldata _proposedUpgrade) public override returns (bytes32) {
```
[[14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/GenesisUpgrade.sol#L14)]



```solidity
File: code/contracts/ethereum/contracts/upgrades/IDefaultUpgrade.sol

8: 		    function upgrade(ProposedUpgrade calldata _upgrade) external returns (bytes32);
```
[[8](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/IDefaultUpgrade.sol#L8)]



```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

109: 		    function _deployL2Token(address _l1Token, bytes calldata _data) internal returns (address) {

138: 		    function _getL1WithdrawMessage(

157: 		    function _getCreate2Salt(address _l1Token) internal pure returns (bytes32 salt) {

164: 		    function _deployBeaconProxy(bytes32 salt) internal returns (BeaconProxy proxy) {
```
[[109](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L109), [138](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L138), [157](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L157), [164](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L164)]



```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

159: 		    function name() public view override returns (string memory) {

165: 		    function symbol() public view override returns (string memory) {

171: 		    function decimals() public view override returns (uint8) {

178: 		    function decodeString(bytes memory _input) external pure returns (string memory result) {

183: 		    function decodeUint8(bytes memory _input) external pure returns (uint8 result) {
```
[[159](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L159), [165](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L165), [171](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L171), [178](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L178), [183](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L183)]



```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol

24: 		    function isWithdrawalFinalized(uint256 _l2BatchNumber, uint256 _l2MessageIndex) external view returns (bool);

26: 		    function deposit(

35: 		    function deposit(

61: 		    function l2TokenAddress(address _l1Token) external view returns (address);

63: 		    function sharedBridge() external view returns (IL1SharedBridge);

65: 		    function l2TokenBeacon() external view returns (address);

67: 		    function l2Bridge() external view returns (address);

69: 		    function depositAmount(
```
[[24](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L24), [26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L26), [35](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L35), [61](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L61), [63](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L63), [65](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L65), [67](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L67), [69](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L69)]



```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol

58: 		    function isWithdrawalFinalized(

64: 		    function depositLegacyErc20Bridge(

97: 		    function finalizeWithdrawalLegacyErc20Bridge(

114: 		    function l1WethAddress() external view returns (address);

116: 		    function bridgehub() external view returns (IBridgehub);

118: 		    function legacyBridge() external view returns (IL1ERC20Bridge);

120: 		    function l2BridgeAddress(uint256 _chainId) external view returns (address);

122: 		    function depositHappened(uint256 _chainId, bytes32 _l2TxHash) external view returns (bytes32);

128: 		    function bridgehubDeposit(
```
[[58](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L58), [64](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L64), [97](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L97), [114](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L114), [116](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L116), [118](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L118), [120](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L120), [122](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L122), [128](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L128)]



```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL2Bridge.sol

17: 		    function l1TokenAddress(address _l2Token) external view returns (address);

19: 		    function l2TokenAddress(address _l1Token) external view returns (address);

21: 		    function l1Bridge() external view returns (address);
```
[[17](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL2Bridge.sol#L17), [19](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL2Bridge.sol#L19), [21](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL2Bridge.sol#L21)]



```solidity
File: code/contracts/ethereum/contracts/common/libraries/UncheckedMath.sol

11: 		    function uncheckedInc(uint256 _number) internal pure returns (uint256) {

17: 		    function uncheckedAdd(uint256 _lhs, uint256 _rhs) internal pure returns (uint256) {
```
[[11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/UncheckedMath.sol#L11), [17](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/UncheckedMath.sol#L17)]



```solidity
File: code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol

19: 		    function readUint32(bytes memory _bytes, uint256 _start) internal pure returns (uint32 result, uint256 offset) {

26: 		    function readAddress(bytes memory _bytes, uint256 _start) internal pure returns (address result, uint256 offset) {

33: 		    function readUint256(bytes memory _bytes, uint256 _start) internal pure returns (uint256 result, uint256 offset) {

40: 		    function readBytes32(bytes memory _bytes, uint256 _start) internal pure returns (bytes32 result, uint256 offset) {
```
[[19](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol#L19), [26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol#L26), [33](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol#L33), [40](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol#L40)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol

62: 		    function initialize(InitializeData calldata _initData) external returns (bytes32);
```
[[62](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol#L62)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol

98: 		    function bridgehubRequestL2Transaction(
```
[[98](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L98)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol

40: 		    function _efficientHash(bytes32 _lhs, bytes32 _rhs) private pure returns (bytes32 result) {
```
[[40](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol#L40)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol

109: 		    function getTransactionBodyGasLimit(

128: 		    function getOverheadForTransaction(
```
[[109](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L109), [128](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L128)]



```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol

34: 		    function l1TokenAddress(address _l2Token) external view returns (address);

36: 		    function l2TokenAddress(address _l1Token) external view returns (address);

38: 		    function l1Bridge() external view returns (address);
```
[[34](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol#L34), [36](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol#L36), [38](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol#L38)]



```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol

16: 		    function l1Address() external view returns (address);

18: 		    function l2Bridge() external view returns (address);
```
[[16](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol#L16), [18](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol#L18)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

32: 		    function _commitOneBatch(

130: 		    function _processL2Logs(

308: 		    function _collectOperationsFromPriorityQueue(uint256 _nPriorityOps) internal returns (bytes32 concatHash) {

453: 		    function _getBatchProofPublicInput(

500: 		    function _createBatchCommitment(

515: 		    function _batchPassThroughData(CommitBatchInfo calldata _batch) internal pure returns (bytes memory) {

525: 		    function _batchMetaParameters() internal view returns (bytes memory) {

537: 		    function _batchAuxiliaryOutput(

561: 		    function _encodeBlobAuxilaryOutput(

587: 		    function _hashStoredBatchInfo(StoredBatchInfo memory _storedBatchInfo) internal pure returns (bytes32) {

592: 		    function _checkBit(uint256 _bitMap, uint8 _index) internal pure returns (bool) {

597: 		    function _setBit(uint256 _bitMap, uint8 _index) internal pure returns (uint256) {

625: 		    function _verifyBlobInformation(

679: 		    function _getBlobVersionedHash(uint256 _index) internal view returns (bytes32 versionedHash) {
```
[[32](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L32), [130](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L130), [308](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L308), [453](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L453), [500](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L500), [515](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L515), [525](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L525), [537](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L537), [561](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L561), [587](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L587), [592](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L592), [597](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L597), [625](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L625), [679](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L679)]



```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

47: 		    function bridgehubRequestL2Transaction(

104: 		    function _proveL2LogInclusion(

130: 		    function _L2MessageToLog(L2Message memory _message) internal pure returns (L2Log memory) {

228: 		    function _requestL2TransactionSender(

258: 		    function _requestL2Transaction(

289: 		    function _serializeL2Transaction(

316: 		    function _writePriorityOp(

353: 		    function _hashFactoryDeps(bytes[] memory _factoryDeps) internal pure returns (uint256[] memory hashedFactoryDeps) {
```
[[47](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L47), [104](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L104), [130](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L130), [228](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L228), [258](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L258), [289](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L289), [316](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L316), [353](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L353)]

</details>