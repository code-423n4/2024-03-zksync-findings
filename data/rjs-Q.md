# Summary


## Low Issues
| # | Title | Instances |
| - | - | - |
| L-01 | [Addition/multiplication in `unchecked` block is unsafe](#l-01-additionmultiplication-in-unchecked-block-is-unsafe) | 71 |
| L-02 | [Arrays can grow in size without a way to shrink them](#l-02-arrays-can-grow-in-size-without-a-way-to-shrink-them) | 2 |
| L-03 | [Code does not follow the best practice of check-effects-interaction](#l-03-code-does-not-follow-the-best-practice-of-check-effects-interaction) | 8 |
| L-04 | [Consider disallowing minting/transfers to `address(this)`](#l-04-consider-disallowing-mintingtransfers-to-addressthis) | 2 |
| L-05 | [Consider implementing two-step procedure for updating protocol addresses](#l-05-consider-implementing-two-step-procedure-for-updating-protocol-addresses) | 34 |
| L-06 | [Contracts can receive value but there's no way to retrieve it](#l-06-contracts-can-receive-value-but-theres-no-way-to-retrieve-it) | 16 |
| L-07 | [Division by zero not prevented](#l-07-division-by-zero-not-prevented) | 4 |
| L-08 | [Division in comparison](#l-08-division-in-comparison) | 2 |
| L-09 | [Draft imports may break in new minor versions](#l-09-draft-imports-may-break-in-new-minor-versions) | 2 |
| L-10 | [ERC-20 `name()` is an optional method](#l-10-erc-20-name-is-an-optional-method) | 1 |
| L-11 | [ERC-20 `symbol()` is an optional method](#l-11-erc-20-symbol-is-an-optional-method) | 1 |
| L-12 | [ERC-20: Large transfers may revert](#l-12-erc-20-large-transfers-may-revert) | 3 |
| L-13 | [ERC-20: `approve()` is deprecated](#l-13-erc-20-approve-is-deprecated) | 2 |
| L-14 | [ERC-20: `safeApprove()` is deprecated](#l-14-erc-20-safeapprove-is-deprecated) | 2 |
| L-15 | [Events may be emitted out of order due to reentrancy](#l-15-events-may-be-emitted-out-of-order-due-to-reentrancy) | 9 |
| L-16 | [External calls in an un-bounded `for-`loop may result in a DOS](#l-16-external-calls-in-an-un-bounded-for-loop-may-result-in-a-dos) | 1 |
| L-17 | [Function calls within for loops](#l-17-function-calls-within-for-loops) | 94 |
| L-18 | [Initialization can be front-run](#l-18-initialization-can-be-front-run) | 8 |
| L-19 | [Input array lengths may differ](#l-19-input-array-lengths-may-differ) | 6 |
| L-20 | [Missing checks for `address(0x0)` in the constructor/initializer](#l-20-missing-checks-for-address0x0-in-the-constructorinitializer) | 4 |
| L-21 | [Missing checks for `address(0x0)` when updating `address` state variables](#l-21-missing-checks-for-address0x0-when-updating-address-state-variables) | 12 |
| L-22 | [Missing checks for `ecrecover()` signature malleability](#l-22-missing-checks-for-ecrecover-signature-malleability) | 1 |
| L-23 | [Missing checks for state variable assignments](#l-23-missing-checks-for-state-variable-assignments) | 11 |
| L-24 | [Missing contract-existence checks before yul `call()`](#l-24-missing-contract-existence-checks-before-yul-call) | 15 |
| L-25 | [Multiplication on the result of a division](#l-25-multiplication-on-the-result-of-a-division) | 2 |
| L-26 | [Numbers downcast to `address`es may result in collisions](#l-26-numbers-downcast-to-addresses-may-result-in-collisions) | 47 |
| L-27 | [Pattern: upgradeable contract is missing an upgrade storage gap](#l-27-pattern-upgradeable-contract-is-missing-an-upgrade-storage-gap) | 2 |
| L-28 | [Potential loss of precision](#l-28-potential-loss-of-precision) | 10 |
| L-29 | [Some tokens may revert when zero value transfers are made](#l-29-some-tokens-may-revert-when-zero-value-transfers-are-made) | 5 |
| L-30 | [State variables should be constrained to validated ranges](#l-30-state-variables-should-be-constrained-to-validated-ranges) | 9 |
| L-31 | [The `owner` is a single point of failure and a centralization risk](#l-31-the-owner-is-a-single-point-of-failure-and-a-centralization-risk) | 19 |
| L-32 | [Unsafe downcast](#l-32-unsafe-downcast) | 61 |
| L-33 | [Upgradeable contract uses non-upgradeable version of the OpenZeppelin libraries/contracts](#l-33-upgradeable-contract-uses-non-upgradeable-version-of-the-openzeppelin-librariescontracts) | 7 |
| L-34 | [Use of `tx.origin` is unsafe in almost every context](#l-34-use-of-txorigin-is-unsafe-in-almost-every-context) | 3 |
| L-35 | [Use of a single-step ownership transfer](#l-35-use-of-a-single-step-ownership-transfer) | 1 |
| L-36 | [Use of low-level `call()` is not recommended](#l-36-use-of-low-level-call-is-not-recommended) | 5 |
| L-37 | [`call()`/`delegatecall()` should check for contract-existence](#l-37-calldelegatecall-should-check-for-contract-existence) | 7 |
| L-38 | [`call()`/`delegatecall()` should specify a gas limit](#l-38-calldelegatecall-should-specify-a-gas-limit) | 7 |
| L-39 | [`receive()`/`fallback()` contains no logic](#l-39-receivefallback-contains-no-logic) | 5 |
| L-40 | [`receive()`/`fallback()` has no authorization](#l-40-receivefallback-has-no-authorization) | 6 |
| L-41 | [`require()` should be used instead of `assert()`](#l-41-require-should-be-used-instead-of-assert) | 5 |
| L-42 | [`unchecked` blocks with subtractions may underflow](#l-42-unchecked-blocks-with-subtractions-may-underflow) | 2 |

## Non-Critical Issues
| # | Title | Instances |
| - | - | - |
| N-01 | [Add inline comments for unnamed variables](#n-01-add-inline-comments-for-unnamed-variables) | 15 |
| N-02 | [Array indices should be referenced via `enum`s rather than via numeric literals](#n-02-array-indices-should-be-referenced-via-enums-rather-than-via-numeric-literals) | 41 |
| N-03 | [Assembly blocks should have extensive comments](#n-03-assembly-blocks-should-have-extensive-comments) | 62 |
| N-04 | [Avoid extraneous whitespace](#n-04-avoid-extraneous-whitespace) | 11 |
| N-05 | [Complex arithmetic expression](#n-05-complex-arithmetic-expression) | 6 |
| N-06 | [Complex casting](#n-06-complex-casting) | 16 |
| N-07 | [Consider adding a block/deny-list](#n-07-consider-adding-a-blockdeny-list) | 7 |
| N-08 | [Consider adding emergency-stop functionality](#n-08-consider-adding-emergency-stop-functionality) | 7 |
| N-09 | [Consider adding formal verification proofs](#n-09-consider-adding-formal-verification-proofs) | 99 |
| N-10 | [Consider adding validation of user inputs](#n-10-consider-adding-validation-of-user-inputs) | 99 |
| N-11 | [Consider emitting an event from `constructor`s](#n-11-consider-emitting-an-event-from-constructors) | 8 |
| N-12 | [Consider making contracts `Upgradeable`](#n-12-consider-making-contracts-upgradeable) | 7 |
| N-13 | [Consider more inclusive language](#n-13-consider-more-inclusive-language) | 2 |
| N-14 | [Consider moving `msg.sender` checks to `modifier`s](#n-14-consider-moving-msgsender-checks-to-modifiers) | 14 |
| N-15 | [Consider splitting complex checks into multiple steps](#n-15-consider-splitting-complex-checks-into-multiple-steps) | 24 |
| N-16 | [Consider upgrading OpenZeppelin dependency to a newer version](#n-16-consider-upgrading-openzeppelin-dependency-to-a-newer-version) | 25 |
| N-17 | [Consider using `delete` rather than assigning zero/false to clear values](#n-17-consider-using-delete-rather-than-assigning-zerofalse-to-clear-values) | 6 |
| N-18 | [Consider using descriptive `constant`s when passing zero as a function argument](#n-18-consider-using-descriptive-constants-when-passing-zero-as-a-function-argument) | 35 |
| N-19 | [Consider using named function arguments](#n-19-consider-using-named-function-arguments) | 42 |
| N-20 | [Consider using named mappings](#n-20-consider-using-named-mappings) | 21 |
| N-21 | [Consider using the `using`-`for` syntax](#n-21-consider-using-the-using-for-syntax) | 99 |
| N-22 | [Constructor / initialization function lacks parameter validation](#n-22-constructor--initialization-function-lacks-parameter-validation) | 7 |
| N-23 | [Contract order does not follow Solidity style guide recommendations](#n-23-contract-order-does-not-follow-solidity-style-guide-recommendations) | 21 |
| N-24 | [Contract should expose an `interface`](#n-24-contract-should-expose-an-interface) | 14 |
| N-25 | [Contracts should have full test coverage](#n-25-contracts-should-have-full-test-coverage) | 99 |
| N-26 | [Critical system parameter changes should be behind a timelock](#n-26-critical-system-parameter-changes-should-be-behind-a-timelock) | 30 |
| N-27 | [Custom errors should be used rather than `revert()`/`require()`](#n-27-custom-errors-should-be-used-rather-than-revertrequire) | 99 |
| N-28 | [Duplicate `require()`/`revert()` checks should be refactored to a modifier or function](#n-28-duplicate-requirerevert-checks-should-be-refactored-to-a-modifier-or-function) | 17 |
| N-29 | [Duplicate functions defined](#n-29-duplicate-functions-defined) | 8 |
| N-30 | [Duplicate strings defined](#n-30-duplicate-strings-defined) | 13 |
| N-31 | [Error messages should be descriptive, rather that cryptic](#n-31-error-messages-should-be-descriptive-rather-that-cryptic) | 99 |
| N-32 | [Event is not fully `indexed`](#n-32-event-is-not-fully-indexed) | 9 |
| N-33 | [Events are missing sender information](#n-33-events-are-missing-sender-information) | 72 |
| N-34 | [Events should use parameters to convey information](#n-34-events-should-use-parameters-to-convey-information) | 2 |
| N-35 | [Events that mark critical parameter changes should contain both the old and the new value](#n-35-events-that-mark-critical-parameter-changes-should-contain-both-the-old-and-the-new-value) | 17 |
| N-36 | [Excessive downcasting of `block.timestamp` reduces contract lifespan](#n-36-excessive-downcasting-of-blocktimestamp-reduces-contract-lifespan) | 2 |
| N-37 | [Expressions for constant values should use `immutable` rather than `constant`](#n-37-expressions-for-constant-values-should-use-immutable-rather-than-constant) | 99 |
| N-38 | [Function has excessive length](#n-38-function-has-excessive-length) | 13 |
| N-39 | [Function is empty](#n-39-function-is-empty) | 7 |
| N-40 | [Function ordering does not follow the Solidity style guide](#n-40-function-ordering-does-not-follow-the-solidity-style-guide) | 49 |
| N-41 | [High cyclomatic complexity](#n-41-high-cyclomatic-complexity) | 5 |
| N-42 | [Import directives should uses aliases](#n-42-import-directives-should-uses-aliases) | 50 |
| N-43 | [Imports should be organized more systematically](#n-43-imports-should-be-organized-more-systematically) | 4 |
| N-44 | [Inconsistent usage of `require()`/`revert()`/`revert <error>`](#n-44-inconsistent-usage-of-requirerevertrevert-error) | 6 |
| N-45 | [Interfaces should use floating version pragmas](#n-45-interfaces-should-use-floating-version-pragmas) | 37 |
| N-46 | [Large multiples of ten should use scientific notation for readability](#n-46-large-multiples-of-ten-should-use-scientific-notation-for-readability) | 17 |
| N-47 | [Large numeric literals should use underscores for readability](#n-47-large-numeric-literals-should-use-underscores-for-readability) | 99 |
| N-48 | [Large or complicated code bases should implement invariant tests](#n-48-large-or-complicated-code-bases-should-implement-invariant-tests) | 99 |
| N-49 | [Missing checks for empty bytes when updating bytes state variables](#n-49-missing-checks-for-empty-bytes-when-updating-bytes-state-variables) | 3 |
| N-50 | [Missing events in initializers](#n-50-missing-events-in-initializers) | 8 |
| N-51 | [Mixed usage of `int`/`uint` with `int256`/`uint256`](#n-51-mixed-usage-of-intuint-with-int256uint256) | 1 |
| N-52 | [Multiple `address`/ID mappings can be combined into a single `mapping` of an `address`/ID to a `struct`, for readability](#n-52-multiple-addressid-mappings-can-be-combined-into-a-single-mapping-of-an-addressid-to-a-struct-for-readability) | 13 |
| N-53 | [Named but unused function parameters in an overridden function](#n-53-named-but-unused-function-parameters-in-an-overridden-function) | 3 |
| N-54 | [Named imports of base contracts are missing](#n-54-named-imports-of-base-contracts-are-missing) | 7 |
| N-55 | [Naming: name immutables using all-uppercase](#n-55-naming-name-immutables-using-all-uppercase) | 5 |
| N-56 | [Naming: use all-uppercase when naming constants](#n-56-naming-use-all-uppercase-when-naming-constants) | 7 |
| N-57 | [NatSpec: Contract declarations should have NatSpec descriptions](#n-57-natspec-contract-declarations-should-have-natspec-descriptions) | 23 |
| N-58 | [NatSpec: Contract declarations should have `@author` tags](#n-58-natspec-contract-declarations-should-have-author-tags) | 26 |
| N-59 | [NatSpec: Contract declarations should have `@dev` tags](#n-59-natspec-contract-declarations-should-have-dev-tags) | 75 |
| N-60 | [NatSpec: Contract declarations should have `@notice` tags](#n-60-natspec-contract-declarations-should-have-notice-tags) | 57 |
| N-61 | [NatSpec: Contract declarations should have `@title` tags](#n-61-natspec-contract-declarations-should-have-title-tags) | 91 |
| N-62 | [NatSpec: Error `@param` is missing](#n-62-natspec-error-param-is-missing) | 2 |
| N-63 | [NatSpec: Error definitions should have `@dev` tags](#n-63-natspec-error-definitions-should-have-dev-tags) | 2 |
| N-64 | [NatSpec: Event `@param` is missing](#n-64-natspec-event-param-is-missing) | 99 |
| N-65 | [NatSpec: Event definitions should have NatSpec descriptions](#n-65-natspec-event-definitions-should-have-natspec-descriptions) | 33 |
| N-66 | [NatSpec: Event definitions should have `@dev` tags](#n-66-natspec-event-definitions-should-have-dev-tags) | 63 |
| N-67 | [NatSpec: Event definitions should have `@notice` tags](#n-67-natspec-event-definitions-should-have-notice-tags) | 35 |
| N-68 | [NatSpec: Function `@param` is missing](#n-68-natspec-function-param-is-missing) | 99 |
| N-69 | [NatSpec: Function `@return` is missing](#n-69-natspec-function-return-is-missing) | 99 |
| N-70 | [NatSpec: Function definitions should have `@dev` tags](#n-70-natspec-function-definitions-should-have-dev-tags) | 99 |
| N-71 | [NatSpec: Function definitions should have `@notice` tags](#n-71-natspec-function-definitions-should-have-notice-tags) | 99 |
| N-72 | [NatSpec: Function definitions should have descriptions](#n-72-natspec-function-definitions-should-have-descriptions) | 99 |
| N-73 | [NatSpec: Modifier `@param` is missing](#n-73-natspec-modifier-param-is-missing) | 5 |
| N-74 | [NatSpec: Modifier definitions should have NatSpec descriptions](#n-74-natspec-modifier-definitions-should-have-natspec-descriptions) | 13 |
| N-75 | [NatSpec: Modifier definitions should have `@dev` tags](#n-75-natspec-modifier-definitions-should-have-dev-tags) | 30 |
| N-76 | [NatSpec: Modifier definitions should have `@notice` tags](#n-76-natspec-modifier-definitions-should-have-notice-tags) | 16 |
| N-77 | [NatSpec: Non-public state variable declarations should use `@dev` tags](#n-77-natspec-non-public-state-variable-declarations-should-use-dev-tags) | 99 |
| N-78 | [NatSpec: State variable declarations should have NatSpec descriptions](#n-78-natspec-state-variable-declarations-should-have-natspec-descriptions) | 99 |
| N-79 | [NatSpec: missing from file](#n-79-natspec-missing-from-file) | 99 |
| N-80 | [NatSpec: public state variable declarations should have @notice tag](#n-80-natspec-public-state-variable-declarations-should-have-notice-tag) | 35 |
| N-81 | [Parameter change does not emit event](#n-81-parameter-change-does-not-emit-event) | 57 |
| N-82 | [Polymorphic functions make security audits more time-consuming and error-prone](#n-82-polymorphic-functions-make-security-audits-more-time-consuming-and-error-prone) | 2 |
| N-83 | [Potential `block.timestamp` off-by-one error](#n-83-potential-blocktimestamp-off-by-one-error) | 6 |
| N-84 | [Setters should prevent re-setting the same value](#n-84-setters-should-prevent-re-setting-the-same-value) | 38 |
| N-85 | [State variables should include comments](#n-85-state-variables-should-include-comments) | 99 |
| N-86 | [Style guide: Contract names should use CamelCase style](#n-86-style-guide-contract-names-should-use-camelcase-style) | 2 |
| N-87 | [Style guide: Non-`external`/`public` function names should begin with an underscore](#n-87-style-guide-non-externalpublic-function-names-should-begin-with-an-underscore) | 99 |
| N-88 | [Style guide: Non-`external`/`public` variable names should begin with an underscore](#n-88-style-guide-non-externalpublic-variable-names-should-begin-with-an-underscore) | 28 |
| N-89 | [Style guide: State and local variables should be named using lowerCamelCase](#n-89-style-guide-state-and-local-variables-should-be-named-using-lowercamelcase) | 11 |
| N-90 | [Style guide: Using underscore at the end of variable name](#n-90-style-guide-using-underscore-at-the-end-of-variable-name) | 3 |
| N-91 | [Style: SPDX-License-Identifier should be on first line](#n-91-style-spdx-license-identifier-should-be-on-first-line) | 5 |
| N-92 | [Style: inconsistent use of leading spacing in comments](#n-92-style-inconsistent-use-of-leading-spacing-in-comments) | 1 |
| N-93 | [Style: line length is too long](#n-93-style-line-length-is-too-long) | 99 |
| N-94 | [Style: surround top level declarations with two blank lines](#n-94-style-surround-top-level-declarations-with-two-blank-lines) | 99 |
| N-95 | [Syntax: place constants on left-hand side of comparisons](#n-95-syntax-place-constants-on-left-hand-side-of-comparisons) | 99 |
| N-96 | [Syntax: unnecessary `override`](#n-96-syntax-unnecessary-override) | 63 |
| N-97 | [The `nonReentrant` `modifier` should occur before all other modifiers](#n-97-the-nonreentrant-modifier-should-occur-before-all-other-modifiers) | 2 |
| N-98 | [Typos](#n-98-typos) | 565 |
| N-99 | [Unnecessary cast](#n-99-unnecessary-cast) | 17 |
| N-100 | [Unresolved TODOs are present](#n-100-unresolved-todos-are-present) | 2 |
| N-101 | [Unused `event` definition](#n-101-unused-event-definition) | 5 |
| N-102 | [Unused `function` definition](#n-102-unused-function-definition) | 72 |
| N-103 | [Unused `struct` definition](#n-103-unused-struct-definition) | 13 |
| N-104 | [Unused function parameter](#n-104-unused-function-parameter) | 3 |
| N-105 | [Unused import](#n-105-unused-import) | 40 |
| N-106 | [Unused named `return` variable](#n-106-unused-named-return-variable) | 4 |
| N-107 | [Use `uint256`/`int256` instead of `uint`/`int`](#n-107-use-uint256int256-instead-of-uintint) | 1 |
| N-108 | [Use a single file for system wide constants](#n-108-use-a-single-file-for-system-wide-constants) | 37 |
| N-109 | [Use a struct to encapsulate multiple function parameters](#n-109-use-a-struct-to-encapsulate-multiple-function-parameters) | 56 |
| N-110 | [Use ternary expressions over `if`/`else` where possible](#n-110-use-ternary-expressions-over-ifelse-where-possible) | 1 |
| N-111 | [Use the latest Solidity version for deployment](#n-111-use-the-latest-solidity-version-for-deployment) | 43 |
| N-112 | [Variables need not be initialized to zero](#n-112-variables-need-not-be-initialized-to-zero) | 38 |
| N-113 | [Visibility should be explicitly set rather than defaulting to `internal`](#n-113-visibility-should-be-explicitly-set-rather-than-defaulting-to-internal) | 11 |
| N-114 | [`2**<n> - 1` should be re-written as `type(uint<n>).max`](#n-114-2n---1-should-be-re-written-as-typeuintnmax) | 3 |
| N-115 | [`abi.encodePacked()` should not be used with dynamic types when passing the result to a hash function such as `keccak256()`](#n-115-abiencodepacked-should-not-be-used-with-dynamic-types-when-passing-the-result-to-a-hash-function-such-as-keccak256) | 8 |
| N-116 | [`constant`s should be defined rather than using magic numbers](#n-116-constants-should-be-defined-rather-than-using-magic-numbers) | 56 |
| N-117 | [`constant`s/`immutable`s redefined elsewhere](#n-117-constantsimmutables-redefined-elsewhere) | 10 |
| N-118 | [`public` functions not called by the contract should be declared `external` instead](#n-118-public-functions-not-called-by-the-contract-should-be-declared-external-instead) | 19 |
| N-119 | [`require()`/`revert()` statements should have descriptive reason strings](#n-119-requirerevert-statements-should-have-descriptive-reason-strings) | 5 |
| N-120 | [`return <parameter>` is redundant when `parameter` is a function return parameter](#n-120-return-parameter-is-redundant-when-parameter-is-a-function-return-parameter) | 1 |

# Low Issues

## [L-01] Addition/multiplication in `unchecked` block is unsafe

The additions/multiplications may silently overflow because they're in `unchecked` blocks with no preceding value checks, which may lead to unexpected results

*Instances: 71*

```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

     |  // @audit-info This unchecked block has risks
 184 |  unchecked {
  :  |
     |          // @audit-issue This unchecked arithmetic operation is unsafe
 195 |          require(block.timestamp >= commitBatchTimestamp + delay, "5c"); // The delay is not passed

     |  // @audit-info This unchecked block has risks
 208 |  unchecked {
  :  |
     |          // @audit-issue This unchecked arithmetic operation is unsafe
 217 |          require(block.timestamp >= commitBatchTimestamp + delay, "5c"); // The delay is not passed
```
GitHub: [195](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L195), [217](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L217)


```solidity
File: code/contracts/ethereum/contracts/common/libraries/UncheckedMath.sol

     |  // @audit-info This unchecked block has risks
  12 |  unchecked {
     |      // @audit-issue This unchecked arithmetic operation is unsafe
  13 |      return _number + 1;

     |  // @audit-info This unchecked block has risks
  18 |  unchecked {
     |      // @audit-issue This unchecked arithmetic operation is unsafe
  19 |      return _lhs + _rhs;
```
GitHub: [13](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/UncheckedMath.sol#L13), [19](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/UncheckedMath.sol#L19)


```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/LibMap.sol

     |  // @audit-info This unchecked block has risks
  19 |  unchecked {
  :  |
     |      // @audit-issue This unchecked arithmetic operation is unsafe
  27 |      uint256 bitOffset = (_index & 7) * 32;

     |  // @audit-info This unchecked block has risks
  39 |  unchecked {
  :  |
     |      // @audit-issue This unchecked arithmetic operation is unsafe
  48 |      uint256 bitOffset = (_index & 7) * 32;
```
GitHub: [27](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/LibMap.sol#L27), [48](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/LibMap.sol#L48)


```solidity
File: code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol

     |  // @audit-info This unchecked block has risks
  29 |  unchecked {
     |      // @audit-issue This unchecked arithmetic operation is unsafe
  30 |      l2Address = address(uint160(l1Address) + offset);
```
GitHub: [30](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol#L30)


```solidity
File: code/system-contracts/contracts/BootloaderUtilities.sol

     |  // @audit-info This unchecked block has risks
 104 |  unchecked {
     |      // @audit-issue This unchecked arithmetic operation is unsafe
 105 |      uint256 listLength = encodedNonce.length +
 106 |          encodedGasParam.length +
 107 |          encodedTo.length +
 108 |          encodedValue.length +
 109 |          encodedDataLength.length +
 110 |          _transaction.data.length +
 111 |          rEncoded.length +
 112 |          sEncoded.length +
 113 |          vEncoded.length;
  :  |
     |      // @audit-issue This unchecked arithmetic operation is unsafe
 105 |      uint256 listLength = encodedNonce.length +
 106 |          encodedGasParam.length +
 107 |          encodedTo.length +
 108 |          encodedValue.length +
 109 |          encodedDataLength.length +
 110 |          _transaction.data.length +
 111 |          rEncoded.length +
 112 |          sEncoded.length +
  :  |
     |      // @audit-issue This unchecked arithmetic operation is unsafe
 105 |      uint256 listLength = encodedNonce.length +
 106 |          encodedGasParam.length +
 107 |          encodedTo.length +
 108 |          encodedValue.length +
 109 |          encodedDataLength.length +
 110 |          _transaction.data.length +
 111 |          rEncoded.length +
  :  |
     |      // @audit-issue This unchecked arithmetic operation is unsafe
 105 |      uint256 listLength = encodedNonce.length +
 106 |          encodedGasParam.length +
 107 |          encodedTo.length +
 108 |          encodedValue.length +
 109 |          encodedDataLength.length +
 110 |          _transaction.data.length +
  :  |
     |      // @audit-issue This unchecked arithmetic operation is unsafe
 105 |      uint256 listLength = encodedNonce.length +
 106 |          encodedGasParam.length +
 107 |          encodedTo.length +
 108 |          encodedValue.length +
 109 |          encodedDataLength.length +
  :  |
     |      // @audit-issue This unchecked arithmetic operation is unsafe
 105 |      uint256 listLength = encodedNonce.length +
 106 |          encodedGasParam.length +
 107 |          encodedTo.length +
 108 |          encodedValue.length +
  :  |
     |      // @audit-issue This unchecked arithmetic operation is unsafe
 105 |      uint256 listLength = encodedNonce.length +
 106 |          encodedGasParam.length +
 107 |          encodedTo.length +
  :  |
     |      // @audit-issue This unchecked arithmetic operation is unsafe
 105 |      uint256 listLength = encodedNonce.length +
 106 |          encodedGasParam.length +

     |  // @audit-info This unchecked block has risks
 197 |  unchecked {
     |      // @audit-issue This unchecked arithmetic operation is unsafe
 198 |      uint256 listLength = encodedFixedLengthParams.length +
 199 |          encodedDataLength.length +
 200 |          _transaction.data.length +
 201 |          encodedAccessListLength.length +
 202 |          rEncoded.length +
 203 |          sEncoded.length +
 204 |          vEncoded.length;
  :  |
     |      // @audit-issue This unchecked arithmetic operation is unsafe
 198 |      uint256 listLength = encodedFixedLengthParams.length +
 199 |          encodedDataLength.length +
 200 |          _transaction.data.length +
 201 |          encodedAccessListLength.length +
 202 |          rEncoded.length +
 203 |          sEncoded.length +
  :  |
     |      // @audit-issue This unchecked arithmetic operation is unsafe
 198 |      uint256 listLength = encodedFixedLengthParams.length +
 199 |          encodedDataLength.length +
 200 |          _transaction.data.length +
 201 |          encodedAccessListLength.length +
 202 |          rEncoded.length +
  :  |
     |      // @audit-issue This unchecked arithmetic operation is unsafe
 198 |      uint256 listLength = encodedFixedLengthParams.length +
 199 |          encodedDataLength.length +
 200 |          _transaction.data.length +
 201 |          encodedAccessListLength.length +
  :  |
     |      // @audit-issue This unchecked arithmetic operation is unsafe
 198 |      uint256 listLength = encodedFixedLengthParams.length +
 199 |          encodedDataLength.length +
 200 |          _transaction.data.length +
  :  |
     |      // @audit-issue This unchecked arithmetic operation is unsafe
 198 |      uint256 listLength = encodedFixedLengthParams.length +
 199 |          encodedDataLength.length +

     |  // @audit-info This unchecked block has risks
 292 |  unchecked {
     |      // @audit-issue This unchecked arithmetic operation is unsafe
 293 |      uint256 listLength = encodedFixedLengthParams.length +
 294 |          encodedDataLength.length +
 295 |          _transaction.data.length +
 296 |          encodedAccessListLength.length +
 297 |          rEncoded.length +
 298 |          sEncoded.length +
 299 |          vEncoded.length;
  :  |
     |      // @audit-issue This unchecked arithmetic operation is unsafe
 293 |      uint256 listLength = encodedFixedLengthParams.length +
 294 |          encodedDataLength.length +
 295 |          _transaction.data.length +
 296 |          encodedAccessListLength.length +
 297 |          rEncoded.length +
 298 |          sEncoded.length +
  :  |
     |      // @audit-issue This unchecked arithmetic operation is unsafe
 293 |      uint256 listLength = encodedFixedLengthParams.length +
 294 |          encodedDataLength.length +
 295 |          _transaction.data.length +
 296 |          encodedAccessListLength.length +
 297 |          rEncoded.length +
  :  |
     |      // @audit-issue This unchecked arithmetic operation is unsafe
 293 |      uint256 listLength = encodedFixedLengthParams.length +
 294 |          encodedDataLength.length +
 295 |          _transaction.data.length +
 296 |          encodedAccessListLength.length +
  :  |
     |      // @audit-issue This unchecked arithmetic operation is unsafe
 293 |      uint256 listLength = encodedFixedLengthParams.length +
 294 |          encodedDataLength.length +
 295 |          _transaction.data.length +
  :  |
     |      // @audit-issue This unchecked arithmetic operation is unsafe
 293 |      uint256 listLength = encodedFixedLengthParams.length +
 294 |          encodedDataLength.length +
```
GitHub: [105-113](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L105-L113), [105-112](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L105-L112), [105-111](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L105-L111), [105-110](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L105-L110), [105-109](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L105-L109), [105-108](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L105-L108), [105-107](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L105-L107), [105-106](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L105-L106), [198-204](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L198-L204), [198-203](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L198-L203), [198-202](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L198-L202), [198-201](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L198-L201), [198-200](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L198-L200), [198-199](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L198-L199), [293-299](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L293-L299), [293-298](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L293-L298), [293-297](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L293-L297), [293-296](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L293-L296), [293-295](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L293-L295), [293-294](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L293-L294)


```solidity
File: code/system-contracts/contracts/Compressor.sol

     |  // @audit-info This unchecked block has risks
  48 |  unchecked {
  :  |
     |          // @audit-issue This unchecked arithmetic operation is unsafe
  52 |          encodedData.length * 4 == _bytecode.length,
  :  |
     |          // @audit-issue This unchecked arithmetic operation is unsafe
  62 |          uint256 indexOfEncodedChunk = uint256(encodedData.readUint16(encodedDataPointer)) * 8;
  :  |
     |          // @audit-issue This unchecked arithmetic operation is unsafe
  66 |          uint64 realChunk = _bytecode.readUint64(encodedDataPointer * 4);
  :  |
     |      // @audit-issue This unchecked arithmetic operation is unsafe
  61 |      for (uint256 encodedDataPointer = 0; encodedDataPointer < encodedData.length; encodedDataPointer += 2) {

     |  // @audit-info This unchecked block has risks
 200 |  unchecked {
  :  |
     |      // @audit-issue This unchecked arithmetic operation is unsafe
     |      // @audit-issue This unchecked arithmetic operation is unsafe
 203 |      dictionary = _rawCompressedData[2:2 + dictionaryLen * 8];
     |      // @audit-issue This unchecked arithmetic operation is unsafe
     |      // @audit-issue This unchecked arithmetic operation is unsafe
 204 |      encodedData = _rawCompressedData[2 + dictionaryLen * 8:];

     |  // @audit-info This unchecked block has risks
 228 |  unchecked {
  :  |
     |              // @audit-issue This unchecked arithmetic operation is unsafe
 233 |              _initialValue + convertedValue == _finalValue,
```
GitHub: [52](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L52), [62](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L62), [66](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L66), [61](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L61), [203](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L203), [203](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L203), [204](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L204), [204](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L204), [233](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L233)


```solidity
File: code/system-contracts/contracts/L1Messenger.sol

     |  // @audit-info This unchecked block has risks
 137 |  unchecked {
  :  |
     |      // @audit-issue This unchecked arithmetic operation is unsafe
     |      // @audit-issue This unchecked arithmetic operation is unsafe
 140 |      pubdataLen = 4 + _message.length + L2_TO_L1_LOG_SERIALIZE_SIZE;

     |  // @audit-info This unchecked block has risks
 169 |  unchecked {
  :  |
     |      // @audit-issue This unchecked arithmetic operation is unsafe
 171 |      pubdataLen = 4 + bytecodeLen;
```
GitHub: [140](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L140), [140](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L140), [171](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L171)


```solidity
File: code/system-contracts/contracts/L2BaseToken.sol

     |  // @audit-info This unchecked block has risks
  42 |  unchecked {
  :  |
     |      // @audit-issue This unchecked arithmetic operation is unsafe
  46 |      balance[_to] += _amount;
```
GitHub: [46](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L2BaseToken.sol#L46)


```solidity
File: code/system-contracts/contracts/NonceHolder.sol

     |  // @audit-info This unchecked block has risks
  71 |  unchecked {
     |      // @audit-issue This unchecked arithmetic operation is unsafe
  72 |      rawNonces[addressAsKey] = (oldRawNonce + _value);

     |  // @audit-info This unchecked block has risks
 117 |  unchecked {
     |      // @audit-issue This unchecked arithmetic operation is unsafe
 118 |      rawNonces[addressAsKey] = oldRawNonce + 1;

     |  // @audit-info This unchecked block has risks
 143 |  unchecked {
     |      // @audit-issue This unchecked arithmetic operation is unsafe
 144 |      rawNonces[addressAsKey] = (oldRawNonce + DEPLOY_NONCE_MULTIPLIER);
```
GitHub: [72](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/NonceHolder.sol#L72), [118](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/NonceHolder.sol#L118), [144](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/NonceHolder.sol#L144)


```solidity
File: code/system-contracts/contracts/libraries/RLPEncoder.sol

     |  // @audit-info This unchecked block has risks
  25 |  unchecked {
  :  |
     |          // @audit-issue This unchecked arithmetic operation is unsafe
  33 |          encoded = new bytes(hbs + 2);
     |          // @audit-issue This unchecked arithmetic operation is unsafe
  34 |          encoded[0] = bytes1(uint8(hbs + 0x81));
  :  |
     |          // @audit-issue This unchecked arithmetic operation is unsafe
  37 |          uint256 shiftedVal = _val << (lbs * 8);

     |  // @audit-info This unchecked block has risks
  61 |  unchecked {
  :  |
     |          // @audit-issue This unchecked arithmetic operation is unsafe
  64 |          encoded[0] = bytes1(uint8(_len + _offset));
  :  |
     |          // @audit-issue This unchecked arithmetic operation is unsafe
  68 |          encoded = new bytes(hbs + 2);
     |          // @audit-issue This unchecked arithmetic operation is unsafe
     |          // @audit-issue This unchecked arithmetic operation is unsafe
  69 |          encoded[0] = bytes1(uint8(_offset + hbs + 56));
  :  |
     |          // @audit-issue This unchecked arithmetic operation is unsafe
  72 |          uint256 shiftedVal = uint256(_len) << (lbs * 8);

     |  // @audit-info This unchecked block has risks
  85 |  unchecked {
  :  |
     |          // @audit-issue This unchecked arithmetic operation is unsafe
  88 |          hbs += 16;
  :  |
     |          // @audit-issue This unchecked arithmetic operation is unsafe
  92 |          hbs += 8;
  :  |
     |          // @audit-issue This unchecked arithmetic operation is unsafe
  96 |          hbs += 4;
  :  |
     |          // @audit-issue This unchecked arithmetic operation is unsafe
 100 |          hbs += 2;
  :  |
     |          // @audit-issue This unchecked arithmetic operation is unsafe
 103 |          hbs += 1;
```
GitHub: [33](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/RLPEncoder.sol#L33), [34](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/RLPEncoder.sol#L34), [37](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/RLPEncoder.sol#L37), [64](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/RLPEncoder.sol#L64), [68](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/RLPEncoder.sol#L68), [69](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/RLPEncoder.sol#L69), [69](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/RLPEncoder.sol#L69), [72](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/RLPEncoder.sol#L72), [88](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/RLPEncoder.sol#L88), [92](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/RLPEncoder.sol#L92), [96](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/RLPEncoder.sol#L96), [100](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/RLPEncoder.sol#L100), [103](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/RLPEncoder.sol#L103)


```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

     |  // @audit-info This unchecked block has risks
 189 |  unchecked {
     |      // @audit-issue This unchecked arithmetic operation is unsafe
 190 |      uint256 listLength = encodedNonce.length +
 191 |          encodedGasParam.length +
 192 |          encodedTo.length +
 193 |          encodedValue.length +
 194 |          encodedDataLength.length +
 195 |          _transaction.data.length +
 196 |          encodedChainId.length;
  :  |
     |      // @audit-issue This unchecked arithmetic operation is unsafe
 190 |      uint256 listLength = encodedNonce.length +
 191 |          encodedGasParam.length +
 192 |          encodedTo.length +
 193 |          encodedValue.length +
 194 |          encodedDataLength.length +
 195 |          _transaction.data.length +
  :  |
     |      // @audit-issue This unchecked arithmetic operation is unsafe
 190 |      uint256 listLength = encodedNonce.length +
 191 |          encodedGasParam.length +
 192 |          encodedTo.length +
 193 |          encodedValue.length +
 194 |          encodedDataLength.length +
  :  |
     |      // @audit-issue This unchecked arithmetic operation is unsafe
 190 |      uint256 listLength = encodedNonce.length +
 191 |          encodedGasParam.length +
 192 |          encodedTo.length +
 193 |          encodedValue.length +
  :  |
     |      // @audit-issue This unchecked arithmetic operation is unsafe
 190 |      uint256 listLength = encodedNonce.length +
 191 |          encodedGasParam.length +
 192 |          encodedTo.length +
  :  |
     |      // @audit-issue This unchecked arithmetic operation is unsafe
 190 |      uint256 listLength = encodedNonce.length +
 191 |          encodedGasParam.length +

     |  // @audit-info This unchecked block has risks
 264 |  unchecked {
     |      // @audit-issue This unchecked arithmetic operation is unsafe
 265 |      uint256 listLength = encodedFixedLengthParams.length +
 266 |          encodedDataLength.length +
 267 |          _transaction.data.length +
 268 |          encodedAccessListLength.length;
  :  |
     |      // @audit-issue This unchecked arithmetic operation is unsafe
 265 |      uint256 listLength = encodedFixedLengthParams.length +
 266 |          encodedDataLength.length +
 267 |          _transaction.data.length +
  :  |
     |      // @audit-issue This unchecked arithmetic operation is unsafe
 265 |      uint256 listLength = encodedFixedLengthParams.length +
 266 |          encodedDataLength.length +

     |  // @audit-info This unchecked block has risks
 336 |  unchecked {
     |      // @audit-issue This unchecked arithmetic operation is unsafe
 337 |      uint256 listLength = encodedFixedLengthParams.length +
 338 |          encodedDataLength.length +
 339 |          _transaction.data.length +
 340 |          encodedAccessListLength.length;
  :  |
     |      // @audit-issue This unchecked arithmetic operation is unsafe
 337 |      uint256 listLength = encodedFixedLengthParams.length +
 338 |          encodedDataLength.length +
 339 |          _transaction.data.length +
  :  |
     |      // @audit-issue This unchecked arithmetic operation is unsafe
 337 |      uint256 listLength = encodedFixedLengthParams.length +
 338 |          encodedDataLength.length +
```
GitHub: [190-196](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L190-L196), [190-195](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L190-L195), [190-194](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L190-L194), [190-193](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L190-L193), [190-192](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L190-L192), [190-191](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L190-L191), [265-268](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L265-L268), [265-267](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L265-L267), [265-266](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L265-L266), [337-340](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L337-L340), [337-339](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L337-L339), [337-338](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L337-L338)


```solidity
File: code/system-contracts/contracts/libraries/Utils.sol

     |  // @audit-info This unchecked block has risks
  45 |  unchecked {
     |      // @audit-issue This unchecked arithmetic operation is unsafe
     |      // @audit-issue This unchecked arithmetic operation is unsafe
  46 |      codeLengthInWords = uint256(uint8(_bytecodeHash[2])) * 256 + uint256(uint8(_bytecodeHash[3]));
```
GitHub: [46](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L46), [46](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L46)


```solidity
File: code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol

     |  // @audit-info This unchecked block has risks
  29 |  unchecked {
     |      // @audit-issue This unchecked arithmetic operation is unsafe
  30 |      l2Address = address(uint160(l1Address) + offset);
```
GitHub: [30](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol#L30)


## [L-02] Arrays can grow in size without a way to shrink them

Array entries are added but are never removed. Consider whether this should be the case, or whether there should be a maximum, or whether old entries should be removed. Cases where there are specific potential problems will be flagged separately under a different issue.

*Instances: 2*

```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol

     |  // @audit-issue No corresponding `pop()` for this `push()`
 196 |  ds.facets.push(_facet);

     |  // @audit-issue No corresponding `pop()` for this `push()`
 223 |  ds.facetToSelectors[_facet].selectors.push(_selector);
```
GitHub: [196](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L196), [223](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L223)


## [L-03] Code does not follow the best practice of check-effects-interaction

Code should follow the best-practice of [check-effects-interaction](https://blockchain-academy.hs-mittweida.de/courses/solidity-coding-beginners-to-intermediate/lessons/solidity-11-coding-patterns/topic/checks-effects-interactions/), where state variables are updated before any external calls are made. Doing so prevents a large class of reentrancy bugs.

*Instances: 8*

```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

     |  // @audit-info External call
 119 |  IMailbox(_target).transferEthToSharedBridge();
  :  |
     |  // @audit-issue State variable assignment after external call
 122 |  chainBalance[_targetChainId][ETH_TOKEN_ADDRESS] =
 123 |      chainBalance[_targetChainId][ETH_TOKEN_ADDRESS] +
 124 |      balanceAfter -
 125 |      balanceBefore;

     |  // @audit-info External call
 130 |  IL1ERC20Bridge(_target).tranferTokenToSharedBridge(_token, amount);
  :  |
     |  // @audit-issue State variable assignment after external call
 133 |  chainBalance[_targetChainId][_token] = chainBalance[_targetChainId][_token] + amount;

     |  // @audit-info External call
 316 |  bool proofValid = bridgehub.proveL1ToL2TransactionStatus(
 317 |      _chainId,
 318 |      _l2TxHash,
 319 |      _l2BatchNumber,
 320 |      _l2MessageIndex,
 321 |      _l2TxNumberInBatch,
 322 |      _merkleProof,
 323 |      TxStatus.Failure
 324 |  );
  :  |
     |  // @audit-issue State variable assignment after external call
 350 |  chainBalance[_chainId][_l1Token] -= _amount;

     |  // @audit-info External call
 423 |  bool alreadyFinalized = IGetters(ERA_DIAMOND_PROXY).isEthWithdrawalFinalized(
 424 |      _l2BatchNumber,
 425 |      _l2MessageIndex
 426 |  );
  :  |
     |  // @audit-issue State variable assignment after external call
 440 |  chainBalance[_chainId][l1Token] -= amount;
```
GitHub: [122-125](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L122-L125), [133](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L133), [350](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L350), [440](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L440)


```solidity
File: code/system-contracts/contracts/L1Messenger.sol

     |  // @audit-info External call
 317 |  PUBDATA_CHUNK_PUBLISHER.chunkAndPublishPubdata(totalL2ToL1Pubdata);
  :  |
     |  // @audit-issue State variable assignment after external call
 329 |  chainedLogsHash = bytes32(0);
     |  // @audit-issue State variable assignment after external call
 330 |  numberOfLogsToProcess = 0;
     |  // @audit-issue State variable assignment after external call
 331 |  chainedMessagesHash = bytes32(0);
     |  // @audit-issue State variable assignment after external call
 332 |  chainedL1BytecodesRevealDataHash = bytes32(0);
```
GitHub: [329](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L329), [330](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L330), [331](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L331), [332](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L332)


## [L-04] Consider disallowing minting/transfers to `address(this)`

A tranfer to the token contract itself is unlikely to be correct and more likely to be a common user error due to a copy & paste mistake. Proceeding with such a transfer will result in the permanent loss of user tokens.

*Instances: 2*

```solidity
File: code/system-contracts/contracts/L2BaseToken.sol

     |  // @audit-issue Check receiver isn't `address(this)`
  64 |  function mint(address _account, uint256 _amount) external override onlyCallFromBootloader {
  65 |      totalSupply += _amount;
  66 |      balance[_account] += _amount;
  67 |      emit Mint(_account, _amount);
  68 |  }
```
GitHub: [64-68](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L2BaseToken.sol#L64-L68)


```solidity
File: code/system-contracts/contracts/interfaces/IBaseToken.sol

     |  // @audit-issue Check receiver isn't `address(this)`
  18 |  function mint(address _account, uint256 _amount) external;
```
GitHub: [18](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBaseToken.sol#L18)


## [L-05] Consider implementing two-step procedure for updating protocol addresses

A copy-paste error or a typo may end up bricking protocol functionality, or sending tokens to an address with no known private key. Consider implementing a two-step procedure for updating protocol addresses, where the recipient is set as pending, and must 'accept' the assignment by making an affirmative call. A straight forward way of doing this would be to have the target contracts implement [EIP-165](https://eips.ethereum.org/EIPS/eip-165), and to have the 'set' functions ensure that the recipient is of the right interface type.
                    
Note: this is different for **non-**`address` parameters, where the recommendation is to use a timelock.

*Instances: 34*

```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

     |  // @audit-issue Consider implementing two-step verification of the new value
  51 |  function setPendingAdmin(address _newPendingAdmin) external onlyOwnerOrAdmin {

     |  // @audit-issue Consider implementing two-step verification of the new value
  82 |  function addStateTransitionManager(address _stateTransitionManager) external onlyOwner {

     |  // @audit-issue Consider implementing two-step verification of the new value
  92 |  function removeStateTransitionManager(address _stateTransitionManager) external onlyOwner {

     |  // @audit-issue Consider implementing two-step verification of the new value
 101 |  function addToken(address _token) external onlyOwner {

     |  // @audit-issue Consider implementing two-step verification of the new value
 108 |  function setSharedBridge(address _sharedBridge) external onlyOwner {
```
GitHub: [51](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L51), [82](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L82), [92](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L92), [101](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L101), [108](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L108)


```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

     |  // @audit-issue Consider implementing two-step verification of the new value
 256 |  function updateSecurityCouncil(address _newSecurityCouncil) external onlySelf {
```
GitHub: [256](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L256)


```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

     |  // @audit-issue Consider implementing two-step verification of the new value
 112 |  function setPendingAdmin(address _newPendingAdmin) external onlyOwnerOrAdmin {

     |  // @audit-issue Consider implementing two-step verification of the new value
 134 |  function setValidatorTimelock(address _validatorTimelock) external onlyOwnerOrAdmin {

     |  // @audit-issue Consider implementing two-step verification of the new value
 179 |  function _setChainIdUpgrade(uint256 _chainId, address _chainContract) internal {
```
GitHub: [112](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L112), [134](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L134), [179](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L179)


```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

     |  // @audit-issue Consider implementing two-step verification of the new value
  73 |  function setStateTransitionManager(IStateTransitionManager _stateTransitionManager) external onlyOwner {

     |  // @audit-issue Consider implementing two-step verification of the new value
  78 |  function addValidator(uint256 _chainId, address _newValidator) external onlyChainAdmin(_chainId) {

     |  // @audit-issue Consider implementing two-step verification of the new value
  87 |  function removeValidator(uint256 _chainId, address _validator) external onlyChainAdmin(_chainId) {
```
GitHub: [73](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L73), [78](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L78), [87](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L87)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol

     |  // @audit-issue Consider implementing two-step verification of the new value
  23 |  function setPendingAdmin(address _newPendingAdmin) external onlyAdmin {

     |  // @audit-issue Consider implementing two-step verification of the new value
  45 |  function setValidator(address _validator, bool _active) external onlyStateTransitionManager {
```
GitHub: [23](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L23), [45](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L45)


```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol

     |  // @audit-issue Consider implementing two-step verification of the new value
 126 |  function _setVerifier(IVerifier _newVerifier) private {

     |  // @audit-issue Consider implementing two-step verification of the new value
 163 |  function _upgradeVerifier(address _newVerifier, VerifierParams calldata _verifierParams) internal {
```
GitHub: [126](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L126), [163](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L163)


```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol

     |  // @audit-issue Consider implementing two-step verification of the new value
 126 |  function _addFunctions(address _facet, bytes4[] memory _selectors, bool _isFacetFreezable) private {

     |  // @audit-issue Consider implementing two-step verification of the new value
 172 |  function _removeFunctions(address _facet, bytes4[] memory _selectors) private {

     |  // @audit-issue Consider implementing two-step verification of the new value
 205 |  function _addOneFunction(address _facet, bytes4 _selector, bool _isSelectorFreezable) private {

     |  // @audit-issue Consider implementing two-step verification of the new value
 228 |  function _removeOneFunction(address _facet, bytes4 _selector) private {

     |  // @audit-issue Consider implementing two-step verification of the new value
 257 |  function _removeFacet(address _facet) private {
```
GitHub: [126](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L126), [172](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L172), [205](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L205), [228](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L228), [257](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L257)


```solidity
File: code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol

     |  // @audit-issue Consider implementing two-step verification of the new value
  53 |  function setPendingAdmin(address _newPendingAdmin) external;

     |  // @audit-issue Consider implementing two-step verification of the new value
 125 |  function addStateTransitionManager(address _stateTransitionManager) external;

     |  // @audit-issue Consider implementing two-step verification of the new value
 127 |  function removeStateTransitionManager(address _stateTransitionManager) external;

     |  // @audit-issue Consider implementing two-step verification of the new value
 129 |  function addToken(address _token) external;

     |  // @audit-issue Consider implementing two-step verification of the new value
 131 |  function setSharedBridge(address _sharedBridge) external;
```
GitHub: [53](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L53), [125](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L125), [127](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L127), [129](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L129), [131](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L131)


```solidity
File: code/contracts/ethereum/contracts/governance/IGovernance.sol

     |  // @audit-issue Consider implementing two-step verification of the new value
  65 |  function updateSecurityCouncil(address _newSecurityCouncil) external;
```
GitHub: [65](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L65)


```solidity
File: code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol

     |  // @audit-issue Consider implementing two-step verification of the new value
  48 |  function setPendingAdmin(address _newPendingAdmin) external;

     |  // @audit-issue Consider implementing two-step verification of the new value
  69 |  function setValidatorTimelock(address _validatorTimelock) external;
```
GitHub: [48](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L48), [69](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L69)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol

     |  // @audit-issue Consider implementing two-step verification of the new value
  17 |  function setPendingAdmin(address _newPendingAdmin) external;

     |  // @audit-issue Consider implementing two-step verification of the new value
  25 |  function setValidator(address _validator, bool _active) external;
```
GitHub: [17](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L17), [25](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L25)


```solidity
File: code/system-contracts/contracts/ImmutableSimulator.sol

     |  // @audit-issue Consider implementing two-step verification of the new value
  34 |  function setImmutables(address _dest, ImmutableData[] calldata _immutables) external override {
```
GitHub: [34](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ImmutableSimulator.sol#L34)


```solidity
File: code/system-contracts/contracts/SystemContext.sol

     |  // @audit-issue Consider implementing two-step verification of the new value
  99 |  function setTxOrigin(address _newOrigin) external onlyCallFromBootloader {
```
GitHub: [99](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L99)


```solidity
File: code/system-contracts/contracts/interfaces/IImmutableSimulator.sol

     |  // @audit-issue Consider implementing two-step verification of the new value
  13 |  function setImmutables(address _dest, ImmutableData[] calldata _immutables) external;
```
GitHub: [13](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IImmutableSimulator.sol#L13)


## [L-06] Contracts can receive value but there's no way to retrieve it

The following contracts contain at least one `payable` function, yet the function does not utilise forwarded value (e.g. ETH), and the contract is missing functionality to withdraw that value again from the contract. This means that funds may become trapped in the contract indefinitely.  Consider adding a withdraw/sweep function to contracts that are capable of receiving ether.

*Instances: 16*

```solidity
File: code/system-contracts/contracts/ComplexUpgrader.sol

     |  // @audit-info No way to utilize received value
  14 |  contract ComplexUpgrader is IComplexUpgrader {
  :  |
     |      // @audit-issue Can receive value
  21 |      function upgrade(address _delegateTo, bytes calldata _calldata) external payable {
```
GitHub: [21](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ComplexUpgrader.sol#L21)


```solidity
File: code/system-contracts/contracts/Compressor.sol

     |  // @audit-info No way to utilize received value
  22 |  contract Compressor is ICompressor, ISystemContract {
  :  |
     |      // @audit-issue Can receive value
  44 |      function publishCompressedBytecode(
  45 |          bytes calldata _bytecode,
  46 |          bytes calldata _rawCompressedData
  47 |      ) external payable onlyCallFromBootloader returns (bytes32 bytecodeHash) {
  :  |
     |      // @audit-issue Can receive value
 110 |      function verifyCompressedStateDiffs(
 111 |          uint256 _numberOfStateDiffs,
 112 |          uint256 _enumerationIndexSize,
 113 |          bytes calldata _stateDiffs,
 114 |          bytes calldata _compressedStateDiffs
 115 |      ) external payable onlyCallFrom(address(L1_MESSENGER_CONTRACT)) returns (bytes32 stateDiffHash) {
```
GitHub: [44-47](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L44-L47), [110-115](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L110-L115)


```solidity
File: code/system-contracts/contracts/DefaultAccount.sol

     |  // @audit-info No way to utilize received value
  19 |  contract DefaultAccount is IAccount {
  :  |
     |      // @audit-issue Can receive value
  67 |      function validateTransaction(
  68 |          bytes32, // _txHash
  69 |          bytes32 _suggestedSignedHash,
  70 |          Transaction calldata _transaction
  71 |      ) external payable override ignoreNonBootloader ignoreInDelegateCall returns (bytes4 magic) {
  :  |
     |      // @audit-issue Can receive value
 112 |      function executeTransaction(
 113 |          bytes32, // _txHash
 114 |          bytes32, // _suggestedSignedHash
 115 |          Transaction calldata _transaction
 116 |      ) external payable override ignoreNonBootloader ignoreInDelegateCall {
  :  |
     |      // @audit-issue Can receive value
 125 |      function executeTransactionFromOutside(Transaction calldata _transaction) external payable override {
  :  |
     |      // @audit-issue Can receive value
 196 |      function payForTransaction(
 197 |          bytes32, // _txHash
 198 |          bytes32, // _suggestedSignedHash
 199 |          Transaction calldata _transaction
 200 |      ) external payable ignoreNonBootloader ignoreInDelegateCall {
  :  |
     |      // @audit-issue Can receive value
 212 |      function prepareForPaymaster(
 213 |          bytes32, // _txHash
 214 |          bytes32, // _suggestedSignedHash
 215 |          Transaction calldata _transaction
 216 |      ) external payable ignoreNonBootloader ignoreInDelegateCall {
  :  |
     |      // @audit-issue Can receive value
 220 |      fallback() external payable ignoreInDelegateCall {
  :  |
     |      // @audit-issue Can receive value
 227 |      receive() external payable {
```
GitHub: [67-71](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L67-L71), [112-116](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L112-L116), [125](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L125), [196-200](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L196-L200), [212-216](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L212-L216), [220](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L220), [227](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L227)


```solidity
File: code/system-contracts/contracts/EmptyContract.sol

     |  // @audit-info No way to utilize received value
  10 |  contract EmptyContract {
     |      // @audit-issue Can receive value
  11 |      fallback() external payable {}
  :  |
     |      // @audit-issue Can receive value
  13 |      receive() external payable {}
```
GitHub: [11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/EmptyContract.sol#L11), [13](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/EmptyContract.sol#L13)


```solidity
File: code/system-contracts/contracts/L2BaseToken.sol

     |  // @audit-info No way to utilize received value
  18 |  contract L2BaseToken is IBaseToken, ISystemContract {
  :  |
     |      // @audit-issue Can receive value
  72 |      function withdraw(address _l1Receiver) external payable override {
  :  |
     |      // @audit-issue Can receive value
  85 |      function withdrawWithMessage(address _l1Receiver, bytes memory _additionalData) external payable override {
```
GitHub: [72](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L2BaseToken.sol#L72), [85](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L2BaseToken.sol#L85)


```solidity
File: code/system-contracts/contracts/GasBoundCaller.sol

     |  // @audit-info No way to utilize received value
  15 |  contract GasBoundCaller {
  :  |
     |      // @audit-issue Can receive value
  35 |      function gasBoundCall(address _to, uint256 _maxTotalGas, bytes calldata _data) external payable {
```
GitHub: [35](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/GasBoundCaller.sol#L35)


```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

     |  // @audit-info No way to utilize received value
  23 |  contract L2SharedBridge is IL2SharedBridge, Initializable {
  :  |
     |      // @audit-issue Can receive value
  79 |      function finalizeDeposit(
  80 |          address _l1Sender,
  81 |          address _l2Receiver,
  82 |          address _l1Token,
  83 |          uint256 _amount,
  84 |          bytes calldata _data
  85 |      ) external payable override {
```
GitHub: [79-85](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L79-L85)


## [L-07] Division by zero not prevented

The divisions below take an input parameter which does not have any zero-value checks, which may lead to the functions reverting when zero is passed.

*Instances: 4*

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

 172 |  uint256 minL2GasPriceBaseToken = (fullPubdataPriceBaseToken + _gasPerPubdata - 1) / _gasPerPubdata;
```
GitHub: [172](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L172)


```solidity
File: code/system-contracts/contracts/L1Messenger.sol

  51 |  return KECCAK_ROUND_GAS_COST * (_length / KECCAK_ROUND_NUMBER_OF_BYTES + 1);

  62 |  return SHA256_ROUND_GAS_COST * ((_length + 8) / SHA256_ROUND_NUMBER_OF_BYTES + 1);
```
GitHub: [51](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L51), [62](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L62)


```solidity
File: code/system-contracts/contracts/NonceHolder.sol

 180 |  deploymentNonce = _rawMinNonce / DEPLOY_NONCE_MULTIPLIER;
```
GitHub: [180](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/NonceHolder.sol#L180)


## [L-08] Division in comparison

To ensure accuracy in comparisons within programming, especially when dealing with integers, it's often more efficient to use multiplication rather than division. This approach stems from the fact that division operations are generally slower and more complex than multiplication. And in the context of solidity they can cause precision errors.

Suppose you want to compare if `a/b` is greater than `c/d` (where `a`, `b`, `c`, and `d` are integers). Instead of performing division, which is prone to precision errors, you can cross-multiply to avoid division. The comparison `a/b > c/d` is equivalent to `a*d > b*c`. This way, you only use multiplication, which is faster and avoids potential inaccuracies or complexities associated with division.

*Instances: 2*

```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol

  30 |  require(l2GasForTxBody / _transaction.gasPerPubdataByteLimit <= _priorityTxMaxPubdata, "uk");
```
GitHub: [30](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L30)


```solidity
File: code/system-contracts/contracts/Compressor.sol

  57 |  dictionary.length / 8 <= encodedData.length / 2,
```
GitHub: [57](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L57)


## [L-09] Draft imports may break in new minor versions

Draft contracts, like those from OpenZeppelin, although audited and safe to use, are based on non-finalized EIPs and may be subject to breaking changes in even minor releases.
        If a bug is found in the version of OpenZeppelin you're using, and the bug-fix release contains breaking changes, this could lead to unnecessary delays in porting and testing replacement contracts.

        It's recommended to have extensive test coverage to detect differences automatically and a plan for testing new versions of these contracts if they change unexpectedly.
        Consider creating a forked version of the file rather than importing it from the package, and manually patching your fork as changes are made, to maintain better control over your dependencies and to mitigate this risk.

*Instances: 2*

```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

     |  // @audit-issue Switch to a production implementation of this contract
   5 |  import {ERC20PermitUpgradeable} from "@openzeppelin/contracts-upgradeable/token/ERC20/extensions/draft-ERC20PermitUpgradeable.sol";
```
GitHub: [5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L5)


```solidity
File: code/contracts/zksync/contracts/bridge/L2WrappedBaseToken.sol

     |  // @audit-issue Switch to a production implementation of this contract
   5 |  import {ERC20PermitUpgradeable} from "@openzeppelin/contracts-upgradeable/token/ERC20/extensions/draft-ERC20PermitUpgradeable.sol";
```
GitHub: [5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2WrappedBaseToken.sol#L5)


## [L-10] ERC-20 `name()` is an optional method

As per the [ERC-20 Token Standard](https://eips.ethereum.org/EIPS/eip-20):

> OPTIONAL - This method can be used to improve usability, but interfaces and other contracts MUST NOT expect these values to be present.

As a result, some ERC20 tokens will not support this interface member and the contract must take steps to ensure the member is present.
            

*Instances: 1*

```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

     |  // @audit-issue Ensure name() is guaranteed to be available
 162 |  return super.name();
```
GitHub: [162](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L162)


## [L-11] ERC-20 `symbol()` is an optional method

As per the [ERC-20 Token Standard](https://eips.ethereum.org/EIPS/eip-20):

> OPTIONAL - This method can be used to improve usability, but interfaces and other contracts MUST NOT expect these values to be present.

As a result, some ERC20 tokens will not support this interface member and the contract must take steps to ensure the member is present.
            

*Instances: 1*

```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

     |  // @audit-issue Ensure symbol() is guaranteed to be available
 168 |  return super.symbol();
```
GitHub: [168](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L168)


## [L-12] ERC-20: Large transfers may revert

Some `IERC20` implementations (e.g `UNI`, `COMP`) may fail if the valued `transferred` is larger than `uint96`. [Source](https://github.com/d-xo/weird-erc20/blob/main/src/Uint96.sol).

*Instances: 3*

```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

     |  // @audit-issue Check balance before & after vs. expected
 162 |  _token.safeTransferFrom(_from, address(sharedBridge), _amount);
```
GitHub: [162](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L162)


```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

     |  // @audit-issue Check balance before & after vs. expected
 175 |  _token.safeTransferFrom(_from, address(this), _amount);
```
GitHub: [175](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L175)


```solidity
File: code/contracts/zksync/contracts/TestnetPaymaster.sol

     |  // @audit-issue Check balance before & after vs. expected
  50 |  try IERC20(token).transferFrom(userAddress, thisAddress, amount) {} catch (bytes memory revertReason) {
```
GitHub: [50](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/TestnetPaymaster.sol#L50)


## [L-13] ERC-20: `approve()` is deprecated

safeApprove should be used in place of the standard approve function in Solidity contracts to enhance security and prevent potential double-spend exploits. The approve function in ERC20 tokens allows users to set an allowance for a third party to spend on their behalf. However, changing an existing allowance without setting it to zero first can be exploited by malicious actors through a front-running attack. safeApprove mitigates this risk by ensuring that the allowance is set to zero before updating it to a new value

*Instances: 2*

```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

     |  // @audit-issue Consider switching OpenZeppelin's SafeERC20's safeIncreaseAllowance()/safeDecreaseAllowance
 382 |  IERC20(token).safeApprove(paymaster, 0);

     |  // @audit-issue Consider switching OpenZeppelin's SafeERC20's safeIncreaseAllowance()/safeDecreaseAllowance
 383 |  IERC20(token).safeApprove(paymaster, minAllowance);
```
GitHub: [382](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L382), [383](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L383)


## [L-14] ERC-20: `safeApprove()` is deprecated

As per OpenZeppelin's [SafeERC20.sol](https://github.com/OpenZeppelin/openzeppelin-contracts/blob/bfff03c0d2a59bcd8e2ead1da9aed9edf0080d05/contracts/token/ERC20/utils/SafeERC20.sol#L38-L45):

> ```
>   /**
>    * @dev Deprecated. This function has issues similar to the ones found in
>    * {IERC20-approve}, and its usage is discouraged.
>    *
>    * Whenever possible, use {safeIncreaseAllowance} and
>    * {safeDecreaseAllowance} instead.
>    */
>   function safeApprove(
> ```
            

*Instances: 2*

```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

     |  // @audit-issue Consider switching OpenZeppelin's SafeERC20's safeIncreaseAllowance()/safeDecreaseAllowance
 382 |  IERC20(token).safeApprove(paymaster, 0);

     |  // @audit-issue Consider switching OpenZeppelin's SafeERC20's safeIncreaseAllowance()/safeDecreaseAllowance
 383 |  IERC20(token).safeApprove(paymaster, minAllowance);
```
GitHub: [382](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L382), [383](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L383)


## [L-15] Events may be emitted out of order due to reentrancy

To strictly conform to the Checks Effects Interactions pattern, it is recommended to emit events before any external interactions.

*Instances: 9*

```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

     |  // @audit-info External call
 189 |  sharedBridge.claimFailedDepositLegacyErc20Bridge(
 190 |      _depositSender,
 191 |      _l1Token,
 192 |      amount,
 193 |      _l2TxHash,
 194 |      _l2BatchNumber,
 195 |      _l2MessageIndex,
 196 |      _l2TxNumberInBatch,
 197 |      _merkleProof
 198 |  );
     |  // @audit-issue Event emitted after external call
 199 |  emit ClaimedFailedDeposit(_depositSender, _l1Token, amount);
```
GitHub: [199](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L199)


```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

     |      // @audit-info External call
 316 |      bool proofValid = bridgehub.proveL1ToL2TransactionStatus(
 317 |          _chainId,
 318 |          _l2TxHash,
 319 |          _l2BatchNumber,
 320 |          _l2MessageIndex,
 321 |          _l2TxNumberInBatch,
 322 |          _merkleProof,
 323 |          TxStatus.Failure
 324 |      );
  :  |
     |      // @audit-info External call
 362 |      IERC20(_l1Token).safeTransfer(_depositSender, _amount);
  :  |
     |  // @audit-issue Event emitted after external call
 367 |  emit ClaimedFailedDepositSharedBridge(_chainId, _depositSender, _l1Token, _amount);

     |      // @audit-info External call
 423 |      bool alreadyFinalized = IGetters(ERA_DIAMOND_PROXY).isEthWithdrawalFinalized(
 424 |          _l2BatchNumber,
 425 |          _l2MessageIndex
 426 |      );
  :  |
     |      // @audit-info External call
 452 |      IERC20(l1Token).safeTransfer(l1Receiver, amount);
  :  |
     |  // @audit-issue Event emitted after external call
 454 |  emit WithdrawalFinalizedSharedBridge(_chainId, l1Receiver, l1Token, amount);
```
GitHub: [367](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L367), [454](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L454)


```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

     |  // @audit-info External call
 137 |  IStateTransitionManager(_stateTransitionManager).createNewChain(
 138 |      _chainId,
 139 |      _baseToken,
 140 |      address(sharedBridge),
 141 |      _admin,
 142 |      _initData
 143 |  );
  :  |
     |  // @audit-issue Event emitted after external call
 145 |  emit NewChain(_chainId, _stateTransitionManager, _admin);
```
GitHub: [145](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L145)


```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

     |  // @audit-info External call
 228 |  IAdmin(_chainContract).executeUpgrade(cutData);
     |  // @audit-issue Event emitted after external call
 229 |  emit SetChainIdUpgrade(_chainContract, l2ProtocolUpgradeTx, protocolVersion);
```
GitHub: [229](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L229)


```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

     |          // @audit-info External call
 333 |          BASE_TOKEN_SYSTEM_CONTRACT.transferFromTo(address(this), _newAddress, value);
  :  |
     |      // @audit-info External call
 345 |      ACCOUNT_CODE_STORAGE_SYSTEM_CONTRACT.markAccountCodeHashAsConstructed(_newAddress);
  :  |
     |      // @audit-info External call
 348 |      IMMUTABLE_SIMULATOR_SYSTEM_CONTRACT.setImmutables(_newAddress, immutables);
  :  |
     |      // @audit-info External call
 352 |      ACCOUNT_CODE_STORAGE_SYSTEM_CONTRACT.storeAccountConstructedCodeHash(_newAddress, _bytecodeHash);
  :  |
     |  // @audit-issue Event emitted after external call
 355 |  emit ContractDeployed(_sender, _bytecodeHash, _newAddress);
```
GitHub: [355](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L355)


```solidity
File: code/system-contracts/contracts/KnownCodesStorage.sol

     |      // @audit-info External call
  51 |      L1_MESSENGER_CONTRACT.requestBytecodeL1Publication(_bytecodeHash);
  :  |
     |  // @audit-issue Event emitted after external call
  59 |  emit MarkedAsKnown(_bytecodeHash, _shouldSendToL1);
```
GitHub: [59](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/KnownCodesStorage.sol#L59)


```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

     |  // @audit-info External call
 104 |  IL2StandardToken(expectedL2Token).bridgeMint(_l2Receiver, _amount);
     |  // @audit-issue Event emitted after external call
 105 |  emit FinalizeDeposit(_l1Sender, _l2Receiver, expectedL2Token, _amount);

     |  // @audit-info External call
 126 |  IL2StandardToken(_l2Token).bridgeBurn(msg.sender, _amount);
  :  |
     |  // @audit-issue Event emitted after external call
 134 |  emit WithdrawalInitiated(msg.sender, _l1Receiver, _l2Token, _amount);
```
GitHub: [105](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L105), [134](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L134)


## [L-16] External calls in an un-bounded `for-`loop may result in a DOS

Consider limiting the number of iterations in `for-`loops that make external calls.

*Instances: 1*

```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

     |  // @audit-info Consider a hard bound on this loop expression value
 253 |  for (uint256 i = 0; i < deploymentsLength; ++i) {
     |      // @audit-issue This external call could exhaust gas in aggregate
 254 |      this.forceDeployOnAddress{value: _deployments[i].value}(_deployments[i], msg.sender);
```
GitHub: [254](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L254)


## [L-17] Function calls within for loops

Making function calls or external calls within loops in Solidity can lead to inefficient gas usage, potential bottlenecks, and increased vulnerability to attacks. Each function call or external call consumes gas, and when executed within a loop, the gas cost multiplies, potentially causing the transaction to run out of gas or exceed block gas limits. This can result in transaction failure or unpredictable behavior.  Consider whether an alternative design is possible that imposes the gas cost on the most directly impacted user of the contract.

*Instances: 94*

```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

     |  // @audit-info Contains function calls
 225 |  for (uint256 i = 0; i < _calls.length; ++i) {
     |      // @audit-issue Move the function call outside the loop or add hard bounds
 226 |      (bool success, bytes memory returnData) = _calls[i].target.call{value: _calls[i].value}(_calls[i].data);
```
GitHub: [226](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L226)


```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

     |  // @audit-info Contains function calls
 116 |  for (uint256 i = 0; i < _newBatchesData.length; ++i) {
     |      // @audit-issue Move the function call outside the loop or add hard bounds
 117 |      committedBatchTimestamp[ERA_CHAIN_ID].set(_newBatchesData[i].batchNumber, timestamp);

     |  // @audit-info Contains function calls
 135 |  for (uint256 i = 0; i < _newBatchesData.length; ++i) {
     |      // @audit-issue Move the function call outside the loop or add hard bounds
 136 |      committedBatchTimestamp[_chainId].set(_newBatchesData[i].batchNumber, timestamp);

     |  // @audit-info Contains function calls
 185 |  for (uint256 i = 0; i < _newBatchesData.length; ++i) {
     |      // @audit-issue Move the function call outside the loop or add hard bounds
 186 |      uint256 commitBatchTimestamp = committedBatchTimestamp[ERA_CHAIN_ID].get(
 187 |          _newBatchesData[i].batchNumber
 188 |      );
  :  |
     |      // @audit-issue Move the function call outside the loop or add hard bounds
 195 |      require(block.timestamp >= commitBatchTimestamp + delay, "5c"); // The delay is not passed

     |  // @audit-info Contains function calls
 209 |  for (uint256 i = 0; i < _newBatchesData.length; ++i) {
     |      // @audit-issue Move the function call outside the loop or add hard bounds
 210 |      uint256 commitBatchTimestamp = committedBatchTimestamp[_chainId].get(_newBatchesData[i].batchNumber);
  :  |
     |      // @audit-issue Move the function call outside the loop or add hard bounds
 217 |      require(block.timestamp >= commitBatchTimestamp + delay, "5c"); // The delay is not passed
```
GitHub: [117](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L117), [136](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L136), [186-188](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L186-L188), [195](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L195), [210](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L210), [217](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L217)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

     |  // @audit-info Contains function calls
     |  // @audit-issue Move the function call outside the loop or add hard bounds
 142 |  for (uint256 i = 0; i < emittedL2Logs.length; i = i.uncheckedAdd(L2_TO_L1_LOG_SERIALIZE_SIZE)) {
  :  |
     |      // @audit-issue Move the function call outside the loop or add hard bounds
 144 |      (address logSender, ) = UnsafeBytes.readAddress(emittedL2Logs, i + L2_LOG_ADDRESS_OFFSET);
     |      // @audit-issue Move the function call outside the loop or add hard bounds
 145 |      (uint256 logKey, ) = UnsafeBytes.readUint256(emittedL2Logs, i + L2_LOG_KEY_OFFSET);
     |      // @audit-issue Move the function call outside the loop or add hard bounds
 146 |      (bytes32 logValue, ) = UnsafeBytes.readBytes32(emittedL2Logs, i + L2_LOG_VALUE_OFFSET);
  :  |
     |      // @audit-issue Move the function call outside the loop or add hard bounds
     |      // @audit-issue Move the function call outside the loop or add hard bounds
     |      // @audit-issue Move the function call outside the loop or add hard bounds
 149 |      require(!_checkBit(processedLogs, uint8(logKey)), "kp");
     |      // @audit-issue Move the function call outside the loop or add hard bounds
     |      // @audit-issue Move the function call outside the loop or add hard bounds
 150 |      processedLogs = _setBit(processedLogs, uint8(logKey));
  :  |
     |      // @audit-issue Move the function call outside the loop or add hard bounds
 153 |      if (logKey == uint256(SystemLogKey.L2_TO_L1_LOGS_TREE_ROOT_KEY)) {
     |          // @audit-issue Move the function call outside the loop or add hard bounds
 154 |          require(logSender == L2_TO_L1_MESSENGER_SYSTEM_CONTRACT_ADDR, "lm");
  :  |
     |      // @audit-issue Move the function call outside the loop or add hard bounds
 156 |      } else if (logKey == uint256(SystemLogKey.TOTAL_L2_TO_L1_PUBDATA_KEY)) {
     |          // @audit-issue Move the function call outside the loop or add hard bounds
 157 |          require(logSender == L2_TO_L1_MESSENGER_SYSTEM_CONTRACT_ADDR, "ln");
  :  |
     |      // @audit-issue Move the function call outside the loop or add hard bounds
 159 |      } else if (logKey == uint256(SystemLogKey.STATE_DIFF_HASH_KEY)) {
     |          // @audit-issue Move the function call outside the loop or add hard bounds
 160 |          require(logSender == L2_TO_L1_MESSENGER_SYSTEM_CONTRACT_ADDR, "lb");
  :  |
     |      // @audit-issue Move the function call outside the loop or add hard bounds
 162 |      } else if (logKey == uint256(SystemLogKey.PACKED_BATCH_AND_L2_BLOCK_TIMESTAMP_KEY)) {
     |          // @audit-issue Move the function call outside the loop or add hard bounds
 163 |          require(logSender == L2_SYSTEM_CONTEXT_SYSTEM_CONTRACT_ADDR, "sc");
     |          // @audit-issue Move the function call outside the loop or add hard bounds
 164 |          logOutput.packedBatchAndL2BlockTimestamp = uint256(logValue);
     |      // @audit-issue Move the function call outside the loop or add hard bounds
 165 |      } else if (logKey == uint256(SystemLogKey.PREV_BATCH_HASH_KEY)) {
     |          // @audit-issue Move the function call outside the loop or add hard bounds
 166 |          require(logSender == L2_SYSTEM_CONTEXT_SYSTEM_CONTRACT_ADDR, "sv");
  :  |
     |      // @audit-issue Move the function call outside the loop or add hard bounds
 168 |      } else if (logKey == uint256(SystemLogKey.CHAINED_PRIORITY_TXN_HASH_KEY)) {
     |          // @audit-issue Move the function call outside the loop or add hard bounds
 169 |          require(logSender == L2_BOOTLOADER_ADDRESS, "bl");
  :  |
     |      // @audit-issue Move the function call outside the loop or add hard bounds
 171 |      } else if (logKey == uint256(SystemLogKey.NUMBER_OF_LAYER_1_TXS_KEY)) {
     |          // @audit-issue Move the function call outside the loop or add hard bounds
 172 |          require(logSender == L2_BOOTLOADER_ADDRESS, "bk");
     |          // @audit-issue Move the function call outside the loop or add hard bounds
 173 |          logOutput.numberOfLayer1Txs = uint256(logValue);
     |      // @audit-issue Move the function call outside the loop or add hard bounds
 174 |      } else if (logKey == uint256(SystemLogKey.BLOB_ONE_HASH_KEY)) {
     |          // @audit-issue Move the function call outside the loop or add hard bounds
 175 |          require(logSender == L2_PUBDATA_CHUNK_PUBLISHER_ADDR, "pc");
  :  |
     |      // @audit-issue Move the function call outside the loop or add hard bounds
 177 |      } else if (logKey == uint256(SystemLogKey.BLOB_TWO_HASH_KEY)) {
     |          // @audit-issue Move the function call outside the loop or add hard bounds
 178 |          require(logSender == L2_PUBDATA_CHUNK_PUBLISHER_ADDR, "pd");
  :  |
     |      // @audit-issue Move the function call outside the loop or add hard bounds
 180 |      } else if (logKey == uint256(SystemLogKey.EXPECTED_SYSTEM_CONTRACT_UPGRADE_TX_HASH_KEY)) {
     |          // @audit-issue Move the function call outside the loop or add hard bounds
 181 |          require(logSender == L2_BOOTLOADER_ADDRESS, "bu");
     |          // @audit-issue Move the function call outside the loop or add hard bounds
 182 |          require(_expectedSystemContractUpgradeTxHash == logValue, "ut");
  :  |
     |          // @audit-issue Move the function call outside the loop or add hard bounds
 184 |          revert("ul");

     |  // @audit-info Contains function calls
     |  // @audit-issue Move the function call outside the loop or add hard bounds
 257 |  for (uint256 i = 0; i < _newBatchesData.length; i = i.uncheckedInc()) {
     |      // @audit-issue Move the function call outside the loop or add hard bounds
     |      // @audit-issue Move the function call outside the loop or add hard bounds
 258 |      _lastCommittedBatchData = _commitOneBatch(_lastCommittedBatchData, _newBatchesData[i], bytes32(0));
  :  |
     |      // @audit-issue Move the function call outside the loop or add hard bounds
 260 |      s.storedBatchHashes[_lastCommittedBatchData.batchNumber] = _hashStoredBatchInfo(_lastCommittedBatchData);
     |      // @audit-issue Move the function call outside the loop or add hard bounds
 261 |      emit BlockCommit(
 262 |          _lastCommittedBatchData.batchNumber,
 263 |          _lastCommittedBatchData.batchHash,
 264 |          _lastCommittedBatchData.commitment
 265 |      );

     |  // @audit-info Contains function calls
     |  // @audit-issue Move the function call outside the loop or add hard bounds
 289 |  for (uint256 i = 0; i < _newBatchesData.length; i = i.uncheckedInc()) {
  :  |
     |      // @audit-issue Move the function call outside the loop or add hard bounds
 291 |      bytes32 expectedUpgradeTxHash = i == 0 ? _systemContractUpgradeTxHash : bytes32(0);
     |      // @audit-issue Move the function call outside the loop or add hard bounds
 292 |      _lastCommittedBatchData = _commitOneBatch(
 293 |          _lastCommittedBatchData,
 294 |          _newBatchesData[i],
 295 |          expectedUpgradeTxHash
 296 |      );
  :  |
     |      // @audit-issue Move the function call outside the loop or add hard bounds
 298 |      s.storedBatchHashes[_lastCommittedBatchData.batchNumber] = _hashStoredBatchInfo(_lastCommittedBatchData);
     |      // @audit-issue Move the function call outside the loop or add hard bounds
 299 |      emit BlockCommit(
 300 |          _lastCommittedBatchData.batchNumber,
 301 |          _lastCommittedBatchData.batchHash,
 302 |          _lastCommittedBatchData.commitment
 303 |      );

     |  // @audit-info Contains function calls
     |  // @audit-issue Move the function call outside the loop or add hard bounds
 311 |  for (uint256 i = 0; i < _nPriorityOps; i = i.uncheckedInc()) {
     |      // @audit-issue Move the function call outside the loop or add hard bounds
 312 |      PriorityOperation memory priorityOp = s.priorityQueue.popFront();
     |      // @audit-issue Move the function call outside the loop or add hard bounds
     |      // @audit-issue Move the function call outside the loop or add hard bounds
 313 |      concatHash = keccak256(abi.encode(concatHash, priorityOp.canonicalTxHash));

     |  // @audit-info Contains function calls
     |  // @audit-issue Move the function call outside the loop or add hard bounds
 351 |  for (uint256 i = 0; i < nBatches; i = i.uncheckedInc()) {
     |      // @audit-issue Move the function call outside the loop or add hard bounds
 352 |      _executeOneBatch(_batchesData[i], i);
     |      // @audit-issue Move the function call outside the loop or add hard bounds
 353 |      emit BlockExecution(_batchesData[i].batchNumber, _batchesData[i].batchHash, _batchesData[i].commitment);

     |  // @audit-info Contains function calls
     |  // @audit-issue Move the function call outside the loop or add hard bounds
 405 |  for (uint256 i = 0; i < committedBatchesLength; i = i.uncheckedInc()) {
     |      // @audit-issue Move the function call outside the loop or add hard bounds
 406 |      currentTotalBatchesVerified = currentTotalBatchesVerified.uncheckedInc();
     |      // @audit-issue Move the function call outside the loop or add hard bounds
 407 |      require(
 408 |          _hashStoredBatchInfo(_committedBatches[i]) == s.storedBatchHashes[currentTotalBatchesVerified],
 409 |          "o1"
 410 |      );
  :  |
     |          // @audit-issue Move the function call outside the loop or add hard bounds
 408 |          _hashStoredBatchInfo(_committedBatches[i]) == s.storedBatchHashes[currentTotalBatchesVerified],
  :  |
     |      // @audit-issue Move the function call outside the loop or add hard bounds
 413 |      proofPublicInput[i] = _getBatchProofPublicInput(
 414 |          prevBatchCommitment,
 415 |          currentBatchCommitment,
 416 |          verifierParams
 417 |      );

     |  // @audit-info Contains function calls
 636 |  for (uint256 i = 0; i < _pubdataCommitments.length; i += PUBDATA_COMMITMENT_SIZE) {
     |      // @audit-issue Move the function call outside the loop or add hard bounds
 637 |      bytes32 blobVersionedHash = _getBlobVersionedHash(versionedHashIndex);
  :  |
     |      // @audit-issue Move the function call outside the loop or add hard bounds
     |      // @audit-issue Move the function call outside the loop or add hard bounds
 639 |      require(blobVersionedHash != bytes32(0), "vh");
  :  |
     |      // @audit-issue Move the function call outside the loop or add hard bounds
 643 |      bytes32 openingPoint = bytes32(
 644 |          uint256(uint128(bytes16(_pubdataCommitments[i:i + PUBDATA_COMMITMENT_CLAIMED_VALUE_OFFSET])))
 645 |      );
  :  |
     |          // @audit-issue Move the function call outside the loop or add hard bounds
     |          // @audit-issue Move the function call outside the loop or add hard bounds
     |          // @audit-issue Move the function call outside the loop or add hard bounds
 644 |          uint256(uint128(bytes16(_pubdataCommitments[i:i + PUBDATA_COMMITMENT_CLAIMED_VALUE_OFFSET])))
  :  |
     |      // @audit-issue Move the function call outside the loop or add hard bounds
 647 |      _pointEvaluationPrecompile(
 648 |          blobVersionedHash,
 649 |          openingPoint,
 650 |          _pubdataCommitments[i + PUBDATA_COMMITMENT_CLAIMED_VALUE_OFFSET:i + PUBDATA_COMMITMENT_SIZE]
 651 |      );
  :  |
     |      // @audit-issue Move the function call outside the loop or add hard bounds
 654 |      blobCommitments[versionedHashIndex] = keccak256(
 655 |          abi.encodePacked(blobVersionedHash, _pubdataCommitments[i:i + PUBDATA_COMMITMENT_COMMITMENT_OFFSET])
 656 |      );
  :  |
     |          // @audit-issue Move the function call outside the loop or add hard bounds
 655 |          abi.encodePacked(blobVersionedHash, _pubdataCommitments[i:i + PUBDATA_COMMITMENT_COMMITMENT_OFFSET])

     |  // @audit-info Contains function calls
 667 |  for (uint256 i = 0; i < MAX_NUMBER_OF_BLOBS; i++) {
     |      // @audit-issue Move the function call outside the loop or add hard bounds
 668 |      require(
 669 |          (_blobHashes[i] == bytes32(0) && blobCommitments[i] == bytes32(0)) ||
 670 |              (_blobHashes[i] != bytes32(0) && blobCommitments[i] != bytes32(0)),
 671 |          "bh"
 672 |      );
  :  |
     |          // @audit-issue Move the function call outside the loop or add hard bounds
     |          // @audit-issue Move the function call outside the loop or add hard bounds
 669 |          (_blobHashes[i] == bytes32(0) && blobCommitments[i] == bytes32(0)) ||
     |              // @audit-issue Move the function call outside the loop or add hard bounds
     |              // @audit-issue Move the function call outside the loop or add hard bounds
 670 |              (_blobHashes[i] != bytes32(0) && blobCommitments[i] != bytes32(0)),
```
GitHub: [142](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L142), [144](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L144), [145](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L145), [146](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L146), [149](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L149), [149](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L149), [149](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L149), [150](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L150), [150](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L150), [153](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L153), [154](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L154), [156](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L156), [157](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L157), [159](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L159), [160](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L160), [162](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L162), [163](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L163), [164](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L164), [165](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L165), [166](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L166), [168](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L168), [169](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L169), [171](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L171), [172](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L172), [173](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L173), [174](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L174), [175](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L175), [177](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L177), [178](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L178), [180](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L180), [181](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L181), [182](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L182), [184](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L184), [257](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L257), [258](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L258), [258](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L258), [260](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L260), [261-265](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L261-L265), [289](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L289), [291](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L291), [292-296](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L292-L296), [298](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L298), [299-303](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L299-L303), [311](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L311), [312](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L312), [313](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L313), [313](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L313), [351](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L351), [352](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L352), [353](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L353), [405](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L405), [406](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L406), [407-410](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L407-L410), [408](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L408), [413-417](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L413-L417), [637](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L637), [639](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L639), [639](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L639), [643-645](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L643-L645), [644](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L644), [644](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L644), [644](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L644), [647-651](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L647-L651), [654-656](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L654-L656), [655](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L655), [668-672](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L668-L672), [669](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L669), [669](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L669), [670](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L670), [670](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L670)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol

     |  // @audit-info Contains function calls
     |  // @audit-issue Move the function call outside the loop or add hard bounds
 208 |  for (uint256 i = 0; i < facetsLen; i = i.uncheckedInc()) {
  :  |
     |      // @audit-issue Move the function call outside the loop or add hard bounds
 212 |      result[i] = Facet(facetAddr, facetToSelectors.selectors);
```
GitHub: [208](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L208), [212](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L212)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

     |  // @audit-info Contains function calls
     |  // @audit-issue Move the function call outside the loop or add hard bounds
 356 |  for (uint256 i = 0; i < factoryDepsLen; i = i.uncheckedInc()) {
     |      // @audit-issue Move the function call outside the loop or add hard bounds
 357 |      bytes32 hashedBytecode = L2ContractHelper.hashL2Bytecode(_factoryDeps[i]);
```
GitHub: [356](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L356), [357](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L357)


```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol

     |  // @audit-info Contains function calls
 226 |  for (uint256 i = 0; i < _factoryDeps.length; ++i) {
     |      // @audit-issue Move the function call outside the loop or add hard bounds
 227 |      require(
 228 |          L2ContractHelper.hashL2Bytecode(_factoryDeps[i]) == bytes32(_expectedHashes[i]),
 229 |          "Wrong factory dep hash"
 230 |      );
  :  |
     |          // @audit-issue Move the function call outside the loop or add hard bounds
     |          // @audit-issue Move the function call outside the loop or add hard bounds
 228 |          L2ContractHelper.hashL2Bytecode(_factoryDeps[i]) == bytes32(_expectedHashes[i]),
```
GitHub: [227-230](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L227-L230), [228](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L228), [228](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L228)


```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol

     |  // @audit-info Contains function calls
     |  // @audit-issue Move the function call outside the loop or add hard bounds
 101 |  for (uint256 i = 0; i < facetCutsLength; i = i.uncheckedInc()) {
  :  |
     |      // @audit-issue Move the function call outside the loop or add hard bounds
 107 |      require(selectors.length > 0, "B"); // no functions for diamond cut
  :  |
     |          // @audit-issue Move the function call outside the loop or add hard bounds
 110 |          _addFunctions(facet, selectors, isFacetFreezable);
  :  |
     |          // @audit-issue Move the function call outside the loop or add hard bounds
 112 |          _replaceFunctions(facet, selectors, isFacetFreezable);
  :  |
     |          // @audit-issue Move the function call outside the loop or add hard bounds
 114 |          _removeFunctions(facet, selectors);
  :  |
     |          // @audit-issue Move the function call outside the loop or add hard bounds
 116 |          revert("C"); // undefined diamond cut action

     |  // @audit-info Contains function calls
     |  // @audit-issue Move the function call outside the loop or add hard bounds
 138 |  for (uint256 i = 0; i < selectorsLength; i = i.uncheckedInc()) {
  :  |
     |      // @audit-issue Move the function call outside the loop or add hard bounds
     |      // @audit-issue Move the function call outside the loop or add hard bounds
 141 |      require(oldFacet.facetAddress == address(0), "J"); // facet for this selector already exists
  :  |
     |      // @audit-issue Move the function call outside the loop or add hard bounds
 143 |      _addOneFunction(_facet, selector, _isFacetFreezable);
```
GitHub: [101](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L101), [107](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L107), [110](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L110), [112](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L112), [114](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L114), [116](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L116), [138](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L138), [141](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L141), [141](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L141), [143](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L143)


## [L-18] Initialization can be front-run

The `initialize()` functions below are not called by another contract atomically after the contract is deployed, so it's possible for a malicious user to call `initialize()` which, if it's noticed in time, would require the project to re-deploy the contract in order to properly initialize. Consider creating a factory contract, which will `new` and `initialize()` each contract atomically.

*Instances: 8*

```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

     |  // @audit-issue Not called atomically by any other contracts
  60 |  function initialize() external reentrancyGuardInitializer {}
```
GitHub: [60](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L60)


```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

     |  // @audit-issue Not called atomically by any other contracts
 104 |  function initialize(
 105 |      address _owner,
 106 |      uint256 _eraFirstPostUpgradeBatch
 107 |  ) external reentrancyGuardInitializer initializer {
```
GitHub: [104-107](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L104-L107)


```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

     |  // @audit-issue Not called atomically by any other contracts
  41 |  function initialize(address _owner) external reentrancyGuardInitializer {
```
GitHub: [41](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L41)


```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

     |  // @audit-issue Not called atomically by any other contracts
  81 |  function initialize(
  82 |      StateTransitionManagerInitializeData calldata _initializeData
  83 |  ) external reentrancyGuardInitializer {
```
GitHub: [81-83](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L81-L83)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol

     |  // @audit-issue Not called atomically by any other contracts
  24 |  function initialize(InitializeData calldata _initializeData) external reentrancyGuardInitializer returns (bytes32) {
```
GitHub: [24](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol#L24)


```solidity
File: code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol

     |  // @audit-issue Not called atomically by any other contracts
  65 |  function initialize(StateTransitionManagerInitializeData calldata _initalizeData) external;
```
GitHub: [65](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L65)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol

     |  // @audit-issue Not called atomically by any other contracts
  62 |  function initialize(InitializeData calldata _initData) external returns (bytes32);
```
GitHub: [62](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol#L62)


```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

     |  // @audit-issue Not called atomically by any other contracts
  49 |  function initialize(
  50 |      address _l1Bridge,
  51 |      address _l1LegecyBridge,
  52 |      bytes32 _l2TokenProxyBytecodeHash,
  53 |      address _aliasedOwner
  54 |  ) external reinitializer(2) {
```
GitHub: [49-54](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L49-L54)


## [L-19] Input array lengths may differ

If the length of the arrays are not required to be of the same length, user operations may not be fully executed due to a mismatch in the number of items iterated over, versus the number of items provided in the second array.

*Instances: 6*

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

     |  // @audit-issue Ensure linked array parameters have equal lengths
 500 |  function _createBatchCommitment(
 501 |      CommitBatchInfo calldata _newBatchData,
 502 |      bytes32 _stateDiffHash,
 503 |      bytes32[] memory _blobCommitments,
 504 |      bytes32[] memory _blobHashes
 505 |  ) internal view returns (bytes32) {

     |  // @audit-issue Ensure linked array parameters have equal lengths
 537 |  function _batchAuxiliaryOutput(
 538 |      CommitBatchInfo calldata _batch,
 539 |      bytes32 _stateDiffHash,
 540 |      bytes32[] memory _blobCommitments,
 541 |      bytes32[] memory _blobHashes
 542 |  ) internal pure returns (bytes memory) {

     |  // @audit-issue Ensure linked array parameters have equal lengths
 561 |  function _encodeBlobAuxilaryOutput(
 562 |      bytes32[] memory _blobCommitments,
 563 |      bytes32[] memory _blobHashes
 564 |  ) internal pure returns (bytes32[] memory blobAuxOutputWords) {
```
GitHub: [500-505](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L500-L505), [537-542](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L537-L542), [561-564](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L561-L564)


```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol

     |  // @audit-issue Ensure linked array parameters have equal lengths
 222 |  function _verifyFactoryDeps(bytes[] calldata _factoryDeps, uint256[] calldata _expectedHashes) private pure {
```
GitHub: [222](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L222)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IVerifier.sol

     |  // @audit-issue Ensure linked array parameters have equal lengths
  19 |  function verify(
  20 |      uint256[] calldata _publicInputs,
  21 |      uint256[] calldata _proof,
  22 |      uint256[] calldata _recursiveAggregationInput
  23 |  ) external view returns (bool);
```
GitHub: [19-23](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IVerifier.sol#L19-L23)


```solidity
File: code/contracts/ethereum/contracts/state-transition/Verifier.sol

     |  // @audit-issue Ensure linked array parameters have equal lengths
 343 |  function verify(
 344 |      uint256[] calldata, // _publicInputs
 345 |      uint256[] calldata, // _proof
 346 |      uint256[] calldata // _recursiveAggregationInput
 347 |  ) external view returns (bool) {
```
GitHub: [343-347](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L343-L347)


## [L-20] Missing checks for `address(0x0)` in the constructor/initializer

Since `address(0x0)` has no private key, it is almost always a mistake when used outside of burning operations, and would result in losing deployment due to the need for redeployment.

*Instances: 4*

```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

     |  // @audit-issue _sharedBridge
  55 |  constructor(IL1SharedBridge _sharedBridge) reentrancyGuardInitializer {
```
GitHub: [55](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L55)


```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

     |  // @audit-issue _l1WethAddress, _bridgehub, _legacyBridge
  90 |  constructor(
  91 |      address _l1WethAddress,
  92 |      IBridgehub _bridgehub,
  93 |      IL1ERC20Bridge _legacyBridge
  94 |  ) reentrancyGuardInitializer {
```
GitHub: [90-94](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L90-L94)


```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

     |  // @audit-issue _securityCouncil
  41 |  constructor(address _admin, address _securityCouncil, uint256 _minDelay) {
```
GitHub: [41](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L41)


```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

     |  // @audit-issue _bridgehub
  60 |  constructor(address _bridgehub) reentrancyGuardInitializer {
```
GitHub: [60](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L60)


## [L-21] Missing checks for `address(0x0)` when updating `address` state variables

Since `address(0x0)` has no private key, it is almost always a mistake when used outside of burning operations.

*Instances: 12*

```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

     |  // @audit-issue Verify `_l2BridgeAddress` != address(0)
 142 |  function initializeChainGovernance(uint256 _chainId, address _l2BridgeAddress) external onlyOwner {
```
GitHub: [142](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L142)


```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

     |  // @audit-issue Verify `_newPendingAdmin` != address(0)
  51 |  function setPendingAdmin(address _newPendingAdmin) external onlyOwnerOrAdmin {

     |  // @audit-issue Verify `_stateTransitionManager` != address(0)
     |  // Verify `_baseToken` != address(0)
 114 |  function createNewChain(
 115 |      uint256 _chainId,
 116 |      address _stateTransitionManager,
 117 |      address _baseToken,
 118 |      uint256, //_salt
 119 |      address _admin,
 120 |      bytes calldata _initData
 121 |  ) external onlyOwnerOrAdmin nonReentrant returns (uint256 chainId) {
```
GitHub: [51](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L51), [114-121](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L114-L121)


```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

     |  // @audit-issue Verify `_newSecurityCouncil` != address(0)
 256 |  function updateSecurityCouncil(address _newSecurityCouncil) external onlySelf {
```
GitHub: [256](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L256)


```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

     |  // @audit-issue Verify `_newPendingAdmin` != address(0)
 112 |  function setPendingAdmin(address _newPendingAdmin) external onlyOwnerOrAdmin {

     |  // @audit-issue Verify `_validatorTimelock` != address(0)
 134 |  function setValidatorTimelock(address _validatorTimelock) external onlyOwnerOrAdmin {

     |  // @audit-issue Verify `_stateTransitionContract` != address(0)
 232 |  function registerAlreadyDeployedStateTransition(
 233 |      uint256 _chainId,
 234 |      address _stateTransitionContract
 235 |  ) external onlyOwner {
```
GitHub: [112](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L112), [134](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L134), [232-235](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L232-L235)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol

     |  // @audit-issue Verify `_newPendingAdmin` != address(0)
  23 |  function setPendingAdmin(address _newPendingAdmin) external onlyAdmin {
```
GitHub: [23](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L23)


```solidity
File: code/system-contracts/contracts/SystemContext.sol

     |  // @audit-issue Verify `_newOrigin` != address(0)
  99 |  function setTxOrigin(address _newOrigin) external onlyCallFromBootloader {
```
GitHub: [99](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L99)


```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

     |  // @audit-issue Verify `_l1Token` != address(0)
  79 |  function finalizeDeposit(
  80 |      address _l1Sender,
  81 |      address _l2Receiver,
  82 |      address _l1Token,
  83 |      uint256 _amount,
  84 |      bytes calldata _data
  85 |  ) external payable override {
```
GitHub: [79-85](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L79-L85)


```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

     |  // @audit-issue Verify `_l1Address` != address(0)
  50 |  function bridgeInitialize(address _l1Address, bytes memory _data) external initializer {
```
GitHub: [50](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L50)


```solidity
File: code/contracts/zksync/contracts/bridge/L2WrappedBaseToken.sol

     |  // @audit-issue Verify `_l2Bridge` != address(0)
     |  // Verify `_l1Address` != address(0)
  44 |  function initializeV2(
  45 |      string memory name_,
  46 |      string memory symbol_,
  47 |      address _l2Bridge,
  48 |      address _l1Address
  49 |  ) external reinitializer(2) {
```
GitHub: [44-49](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2WrappedBaseToken.sol#L44-L49)


## [L-22] Missing checks for `ecrecover()` signature malleability

`ecrecover()` accepts as valid, two versions of signatures, meaning an attacker can use the same signature twice, or an attacker may be able to front-run the original signer with the altered version of the signature, causing the signer's transaction to revert due to nonce reuse. Consider adding checks for signature malleability, or using OpenZeppelin's `ECDSA` library to perform the extra checks necessary in order to prevent malleability.

*Instances: 1*

```solidity
File: code/system-contracts/contracts/DefaultAccount.sol

     |  // @audit-issue Verify s or add a nonce
 186 |  address recoveredAddress = ecrecover(_hash, v, r, s);
```
GitHub: [186](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L186)


## [L-23] Missing checks for state variable assignments

There are some missing checks in these functions, and this could lead to unexpected scenarios. Consider always adding a sanity check for state variables.

*Instances: 11*

```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

     |  // @audit-issue `_l2BridgeAddress` is assigned to a state variable, unvalidated
 142 |  function initializeChainGovernance(uint256 _chainId, address _l2BridgeAddress) external onlyOwner {
```
GitHub: [142](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L142)


```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

     |  // @audit-issue `_newPendingAdmin` is assigned to a state variable, unvalidated
  51 |  function setPendingAdmin(address _newPendingAdmin) external onlyOwnerOrAdmin {

     |  // @audit-issue `_stateTransitionManager` is assigned to a state variable, unvalidated
     |  // `_baseToken` is assigned to a state variable, unvalidated
 114 |  function createNewChain(
 115 |      uint256 _chainId,
 116 |      address _stateTransitionManager,
 117 |      address _baseToken,
 118 |      uint256, //_salt
 119 |      address _admin,
 120 |      bytes calldata _initData
 121 |  ) external onlyOwnerOrAdmin nonReentrant returns (uint256 chainId) {
```
GitHub: [51](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L51), [114-121](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L114-L121)


```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

     |  // @audit-issue `_newSecurityCouncil` is assigned to a state variable, unvalidated
 256 |  function updateSecurityCouncil(address _newSecurityCouncil) external onlySelf {
```
GitHub: [256](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L256)


```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

     |  // @audit-issue `_newPendingAdmin` is assigned to a state variable, unvalidated
 112 |  function setPendingAdmin(address _newPendingAdmin) external onlyOwnerOrAdmin {

     |  // @audit-issue `_validatorTimelock` is assigned to a state variable, unvalidated
 134 |  function setValidatorTimelock(address _validatorTimelock) external onlyOwnerOrAdmin {

     |  // @audit-issue `_stateTransitionContract` is assigned to a state variable, unvalidated
 232 |  function registerAlreadyDeployedStateTransition(
 233 |      uint256 _chainId,
 234 |      address _stateTransitionContract
 235 |  ) external onlyOwner {
```
GitHub: [112](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L112), [134](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L134), [232-235](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L232-L235)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol

     |  // @audit-issue `_newPendingAdmin` is assigned to a state variable, unvalidated
  23 |  function setPendingAdmin(address _newPendingAdmin) external onlyAdmin {
```
GitHub: [23](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L23)


```solidity
File: code/system-contracts/contracts/SystemContext.sol

     |  // @audit-issue `_newOrigin` is assigned to a state variable, unvalidated
  99 |  function setTxOrigin(address _newOrigin) external onlyCallFromBootloader {
```
GitHub: [99](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L99)


```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

     |  // @audit-issue `_l1Address` is assigned to a state variable, unvalidated
  50 |  function bridgeInitialize(address _l1Address, bytes memory _data) external initializer {
```
GitHub: [50](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L50)


```solidity
File: code/contracts/zksync/contracts/bridge/L2WrappedBaseToken.sol

     |  // @audit-issue `_l2Bridge` is assigned to a state variable, unvalidated
     |  // `_l1Address` is assigned to a state variable, unvalidated
  44 |  function initializeV2(
  45 |      string memory name_,
  46 |      string memory symbol_,
  47 |      address _l2Bridge,
  48 |      address _l1Address
  49 |  ) external reinitializer(2) {
```
GitHub: [44-49](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2WrappedBaseToken.sol#L44-L49)


## [L-24] Missing contract-existence checks before yul `call()`

Low-level calls return success if there is no code present at the specified address. In addition to the zero-address checks, add a check to verify that `extcodesize()` is non-zero.

Note that caching the check in another function may not be reliable due to `selfdestruct` being executable at any time by a contract.

*Instances: 15*

```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

     |  // @audit-issue Add contract existence check
 357 |  assembly {
 358 |      callSuccess := call(gas(), _depositSender, _amount, 0, 0, 0, 0)
 359 |  }

     |  // @audit-issue Add contract existence check
 446 |  assembly {
 447 |      callSuccess := call(gas(), l1Receiver, amount, 0, 0, 0, 0)
 448 |  }
```
GitHub: [357-359](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L357-L359), [446-448](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L446-L448)


```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

     |  // @audit-issue Add contract existence check
 227 |  assembly {
 228 |      // Copy function signature and arguments from calldata at zero position into memory at pointer position
 229 |      calldatacopy(0, 0, calldatasize())
 230 |      // Call method of the hyperchain diamond contract returns 0 on error
 231 |      let result := call(gas(), contractAddress, 0, 0, calldatasize(), 0, 0)
 232 |      // Get the size of the last return data
 233 |      let size := returndatasize()
 234 |      // Copy the size length of bytes from return data at zero position to pointer position
 235 |      returndatacopy(0, 0, size)
 236 |      // Depending on the result value
 237 |      switch result
 238 |      case 0 {
 239 |          // End execution and revert state changes
 240 |          revert(0, size)
 241 |      }
 242 |      default {
 243 |          // Return data with length of size at pointers position
 244 |          return(0, size)
 245 |      }
 246 |  }
```
GitHub: [227-246](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L227-L246)


```solidity
File: code/system-contracts/contracts/libraries/EfficientCall.sol

     |  // @audit-issue Add contract existence check
 135 |  assembly {
 136 |      success := call(_address, callAddr, 0, 0, 0xFFFF, 0, 0)
 137 |  }

     |  // @audit-issue Add contract existence check
 148 |  assembly {
 149 |      success := call(msgValueSimulator, callAddr, _value, _address, 0xFFFF, forwardMask, 0)
 150 |  }

     |  // @audit-issue Add contract existence check
 203 |          assembly {
 204 |              // Clearing values before usage in assembly, since Solidity
 205 |              // doesn't do it by default
 206 |              _whoToMimic := and(_whoToMimic, cleanupMask)
 208 |              success := call(_address, callAddr, 0, 0, _whoToMimic, 0, 0)
 209 |          }
```
GitHub: [135-137](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L135-L137), [148-150](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L148-L150), [203-209](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L203-L209)


```solidity
File: code/system-contracts/contracts/libraries/SystemContractHelper.sol

     |  // @audit-issue Add contract existence check
  50 |  assembly {
  51 |      // Ensuring that the type is bool
  52 |      _isService := and(_isService, 1)
  53 |      // This `success` is always 0, but the method always succeeds
  54 |      // (except for the cases when there is not enough gas)
  55 |      let success := call(_isService, callAddr, _key, _value, 0xFFFF, 0, 0)
  56 |  }

     |  // @audit-issue Add contract existence check
 171 |  assembly {
 172 |      // Clearing input params as they are not cleaned by Solidity by default
 173 |      _value := and(_value, cleanupMask)
 174 |      success := call(0, callAddr, _value, 0, 0xFFFF, 0, 0)
 175 |  }

     |  // @audit-issue Add contract existence check
 183 |  assembly {
 184 |      pop(call(initializer, callAddr, value1, 0, 0xFFFF, 0, 0))
 185 |  }

     |  // @audit-issue Add contract existence check
 193 |  assembly {
 194 |      pop(call(value1, callAddr, value2, 0, 0xFFFF, 0, 0))
 195 |  }
```
GitHub: [50-56](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L50-L56), [171-175](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L171-L175), [183-185](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L183-L185), [193-195](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L193-L195)


```solidity
File: code/system-contracts/contracts/libraries/SystemContractsCaller.sol

     |  // @audit-issue Add contract existence check
 100 |  assembly {
 101 |      success := call(to, callAddr, 0, 0, farCallAbi, 0, 0)
 102 |  }

     |  // @audit-issue Add contract existence check
 109 |  assembly {
 110 |      success := call(msgValueSimulator, callAddr, value, to, farCallAbi, forwardMask, 0)
 111 |  }
```
GitHub: [100-102](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L100-L102), [109-111](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L109-L111)


```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

     |  // @audit-issue Add contract existence check
 399 |  assembly {
 400 |      success := call(gas(), bootloaderAddr, amount, 0, 0, 0, 0)
 401 |  }
```
GitHub: [399-401](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L399-L401)


```solidity
File: code/contracts/zksync/contracts/SystemContractsCaller.sol

     |  // @audit-issue Add contract existence check
  61 |  assembly {
  62 |      success := call(to, callAddr, 0, 0, farCallAbi, 0, 0)
  63 |  }

     |  // @audit-issue Add contract existence check
  70 |  assembly {
  71 |      success := call(msgValueSimulator, callAddr, value, to, farCallAbi, forwardMask, 0)
  72 |  }
```
GitHub: [61-63](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/SystemContractsCaller.sol#L61-L63), [70-72](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/SystemContractsCaller.sol#L70-L72)


## [L-25] Multiplication on the result of a division

Dividing an integer by another integer will often result in loss of precision. When the result is multiplied by another number, the loss of precision is magnified, often to material magnitudes. `(X / Z) * Y` should be re-written as `(X * Y) / Z`

*Instances: 2*

```solidity
File: code/system-contracts/contracts/L1Messenger.sol

     |  // @audit-issue Multiply before division to avoid loss of precision
  51 |  return KECCAK_ROUND_GAS_COST * (_length / KECCAK_ROUND_NUMBER_OF_BYTES + 1);

     |  // @audit-issue Multiply before division to avoid loss of precision
  62 |  return SHA256_ROUND_GAS_COST * ((_length + 8) / SHA256_ROUND_NUMBER_OF_BYTES + 1);
```
GitHub: [51](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L51), [62](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L62)


## [L-26] Numbers downcast to `address`es may result in collisions

If a number is downcast to an `address` the upper bytes are truncated, which may mean that more than one value will map to the `address`

*Instances: 47*

```solidity
File: code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol

     |  // @audit-issue Casting from uint160 to address will truncate bits
  71 |  return address(uint160(uint256(data)));
```
GitHub: [71](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L71)


```solidity
File: code/contracts/ethereum/contracts/common/Config.sol

     |  // @audit-issue Casting from uint160 to address will truncate bits
 117 |  address constant BRIDGEHUB_MIN_SECOND_BRIDGE_ADDRESS = address(uint160(type(uint16).max));
```
GitHub: [117](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/Config.sol#L117)


```solidity
File: code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol

     |  // @audit-issue Casting from uint160 to address will truncate bits
  30 |  l2Address = address(uint160(l1Address) + offset);

     |  // @audit-issue Casting from uint160 to address will truncate bits
  40 |  l1Address = address(uint160(l2Address) - offset);
```
GitHub: [30](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol#L30), [40](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol#L40)


```solidity
File: code/system-contracts/contracts/AccountCodeStorage.sol

     |  // @audit-issue Casting from uint160 to address will truncate bits
  92 |  address account = address(uint160(_input));

     |  // @audit-issue Casting from uint160 to address will truncate bits
 120 |  address account = address(uint160(_input));
```
GitHub: [92](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L92), [120](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L120)


```solidity
File: code/system-contracts/contracts/BootloaderUtilities.sol

     |  // @audit-issue Casting from uint160 to address will truncate bits
  61 |  bytes memory encodedTo = RLPEncoder.encodeAddress(address(uint160(_transaction.to)));

     |  // @audit-issue Casting from uint160 to address will truncate bits
 147 |  bytes memory encodedTo = RLPEncoder.encodeAddress(address(uint160(_transaction.to)));

     |  // @audit-issue Casting from uint160 to address will truncate bits
 241 |  bytes memory encodedTo = RLPEncoder.encodeAddress(address(uint160(_transaction.to)));
```
GitHub: [61](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L61), [147](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L147), [241](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L241)


```solidity
File: code/system-contracts/contracts/Constants.sol

     |  // @audit-issue Casting from uint160 to address will truncate bits
  48 |  address payable constant BOOTLOADER_FORMAL_ADDRESS = payable(address(SYSTEM_CONTRACTS_OFFSET + 0x01));

     |  // @audit-issue Casting from uint160 to address will truncate bits
  50 |  address(SYSTEM_CONTRACTS_OFFSET + 0x02)

     |  // @audit-issue Casting from uint160 to address will truncate bits
  52 |  INonceHolder constant NONCE_HOLDER_SYSTEM_CONTRACT = INonceHolder(address(SYSTEM_CONTRACTS_OFFSET + 0x03));

     |  // @audit-issue Casting from uint160 to address will truncate bits
  53 |  IKnownCodesStorage constant KNOWN_CODE_STORAGE_CONTRACT = IKnownCodesStorage(address(SYSTEM_CONTRACTS_OFFSET + 0x04));

     |  // @audit-issue Casting from uint160 to address will truncate bits
  55 |  address(SYSTEM_CONTRACTS_OFFSET + 0x05)

     |  // @audit-issue Casting from uint160 to address will truncate bits
  57 |  IContractDeployer constant DEPLOYER_SYSTEM_CONTRACT = IContractDeployer(address(SYSTEM_CONTRACTS_OFFSET + 0x06));

     |  // @audit-issue Casting from uint160 to address will truncate bits
  61 |  address constant FORCE_DEPLOYER = address(SYSTEM_CONTRACTS_OFFSET + 0x07);

     |  // @audit-issue Casting from uint160 to address will truncate bits
  62 |  IL1Messenger constant L1_MESSENGER_CONTRACT = IL1Messenger(address(SYSTEM_CONTRACTS_OFFSET + 0x08));

     |  // @audit-issue Casting from uint160 to address will truncate bits
  63 |  address constant MSG_VALUE_SYSTEM_CONTRACT = address(SYSTEM_CONTRACTS_OFFSET + 0x09);

     |  // @audit-issue Casting from uint160 to address will truncate bits
  65 |  IBaseToken constant BASE_TOKEN_SYSTEM_CONTRACT = IBaseToken(address(SYSTEM_CONTRACTS_OFFSET + 0x0a));

     |  // @audit-issue Casting from uint160 to address will truncate bits
  66 |  IBaseToken constant REAL_BASE_TOKEN_SYSTEM_CONTRACT = IBaseToken(address(REAL_SYSTEM_CONTRACTS_OFFSET + 0x0a));

     |  // @audit-issue Casting from uint160 to address will truncate bits
  73 |  ISystemContext constant SYSTEM_CONTEXT_CONTRACT = ISystemContext(payable(address(SYSTEM_CONTRACTS_OFFSET + 0x0b)));

     |  // @audit-issue Casting from uint160 to address will truncate bits
  74 |  ISystemContext constant REAL_SYSTEM_CONTEXT_CONTRACT = ISystemContext(payable(address(REAL_SYSTEM_CONTRACTS_OFFSET + 0x0b)));

     |  // @audit-issue Casting from uint160 to address will truncate bits
  76 |  IBootloaderUtilities constant BOOTLOADER_UTILITIES = IBootloaderUtilities(address(SYSTEM_CONTRACTS_OFFSET + 0x0c));

     |  // @audit-issue Casting from uint160 to address will truncate bits
  79 |  address constant EVENT_WRITER_CONTRACT = address(SYSTEM_CONTRACTS_OFFSET + 0x0d);

     |  // @audit-issue Casting from uint160 to address will truncate bits
  81 |  ICompressor constant COMPRESSOR_CONTRACT = ICompressor(address(SYSTEM_CONTRACTS_OFFSET + 0x0e));

     |  // @audit-issue Casting from uint160 to address will truncate bits
  83 |  IComplexUpgrader constant COMPLEX_UPGRADER_CONTRACT = IComplexUpgrader(address(SYSTEM_CONTRACTS_OFFSET + 0x0f));

     |  // @audit-issue Casting from uint160 to address will truncate bits
  86 |  address(SYSTEM_CONTRACTS_OFFSET + 0x11)
```
GitHub: [48](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Constants.sol#L48), [50](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Constants.sol#L50), [52](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Constants.sol#L52), [53](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Constants.sol#L53), [55](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Constants.sol#L55), [57](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Constants.sol#L57), [61](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Constants.sol#L61), [62](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Constants.sol#L62), [63](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Constants.sol#L63), [65](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Constants.sol#L65), [66](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Constants.sol#L66), [73](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Constants.sol#L73), [74](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Constants.sol#L74), [76](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Constants.sol#L76), [79](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Constants.sol#L79), [81](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Constants.sol#L81), [83](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Constants.sol#L83), [86](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Constants.sol#L86)


```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

     |  // @audit-issue Casting from uint160 to address will truncate bits
  48 |  _address > address(MAX_SYSTEM_CONTRACT_ADDRESS) &&

     |  // @audit-issue Casting from uint160 to address will truncate bits
 109 |  newAddress = address(uint160(uint256(hash)));

     |  // @audit-issue Casting from uint160 to address will truncate bits
 125 |  newAddress = address(uint160(uint256(hash)));
```
GitHub: [48](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L48), [109](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L109), [125](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L125)


```solidity
File: code/system-contracts/contracts/DefaultAccount.sol

     |  // @audit-issue Casting from uint160 to address will truncate bits
 132 |  address to = address(uint160(_transaction.to));
```
GitHub: [132](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L132)


```solidity
File: code/system-contracts/contracts/L2BaseToken.sol

     |  // @audit-issue Casting from uint160 to address will truncate bits
  57 |  return balance[address(uint160(_account))];
```
GitHub: [57](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L2BaseToken.sol#L57)


```solidity
File: code/system-contracts/contracts/MsgValueSimulator.sol

     |  // @audit-issue Casting from uint160 to address will truncate bits
  32 |  to = address(uint160(addressAsUint));
```
GitHub: [32](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/MsgValueSimulator.sol#L32)


```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

     |  // @audit-issue Casting from uint160 to address will truncate bits
 164 |  bytes memory encodedTo = RLPEncoder.encodeAddress(address(uint160(_transaction.to)));

     |  // @audit-issue Casting from uint160 to address will truncate bits
 232 |  bytes memory encodedTo = RLPEncoder.encodeAddress(address(uint160(_transaction.to)));

     |  // @audit-issue Casting from uint160 to address will truncate bits
 303 |  bytes memory encodedTo = RLPEncoder.encodeAddress(address(uint160(_transaction.to)));

     |  // @audit-issue Casting from uint160 to address will truncate bits
 375 |  address paymaster = address(uint160(_transaction.paymaster));

     |  // @audit-issue Casting from uint160 to address will truncate bits
 406 |  if (address(uint160(_transaction.paymaster)) != address(0)) {
```
GitHub: [164](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L164), [232](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L232), [303](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L303), [375](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L375), [406](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L406)


```solidity
File: code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol

     |  // @audit-issue Casting from uint160 to address will truncate bits
  30 |  l2Address = address(uint160(l1Address) + offset);

     |  // @audit-issue Casting from uint160 to address will truncate bits
  40 |  l1Address = address(uint160(l2Address) - offset);
```
GitHub: [30](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol#L30), [40](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol#L40)


```solidity
File: code/contracts/zksync/contracts/L2ContractHelper.sol

     |  // @audit-issue Casting from uint160 to address will truncate bits
  70 |  address constant BOOTLOADER_ADDRESS = address(SYSTEM_CONTRACTS_OFFSET + 0x01);

     |  // @audit-issue Casting from uint160 to address will truncate bits
  71 |  address constant MSG_VALUE_SYSTEM_CONTRACT = address(SYSTEM_CONTRACTS_OFFSET + 0x09);

     |  // @audit-issue Casting from uint160 to address will truncate bits
  72 |  address constant DEPLOYER_SYSTEM_CONTRACT = address(SYSTEM_CONTRACTS_OFFSET + 0x06);

     |  // @audit-issue Casting from uint160 to address will truncate bits
  74 |  IL2Messenger constant L2_MESSENGER = IL2Messenger(address(SYSTEM_CONTRACTS_OFFSET + 0x08));

     |  // @audit-issue Casting from uint160 to address will truncate bits
  76 |  IBaseToken constant L2_BASE_TOKEN_ADDRESS = IBaseToken(address(SYSTEM_CONTRACTS_OFFSET + 0x0a));

     |  // @audit-issue Casting from uint160 to address will truncate bits
 112 |  return address(uint160(uint256(data)));
```
GitHub: [70](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/L2ContractHelper.sol#L70), [71](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/L2ContractHelper.sol#L71), [72](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/L2ContractHelper.sol#L72), [74](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/L2ContractHelper.sol#L74), [76](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/L2ContractHelper.sol#L76), [112](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/L2ContractHelper.sol#L112)


```solidity
File: code/contracts/zksync/contracts/TestnetPaymaster.sol

     |  // @audit-issue Casting from uint160 to address will truncate bits
  32 |  address userAddress = address(uint160(_transaction.from));
```
GitHub: [32](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/TestnetPaymaster.sol#L32)


## [L-27] Pattern: upgradeable contract is missing an upgrade storage gap

See [this](https://docs.openzeppelin.com/contracts/4.x/upgradeable#storage_gaps) link for a description of this storage variable. While some contracts may not currently be sub-classed, adding the variable now protects against forgetting to add it in the future.

*Instances: 2*

```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

     |  // @audit-issue Add a storage gap variable for this upgradeable contract
  15 |  contract L2StandardERC20 is ERC20PermitUpgradeable, IL2StandardToken, ERC1967Upgrade {
```
GitHub: [15](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L15)


```solidity
File: code/contracts/zksync/contracts/bridge/L2WrappedBaseToken.sol

     |  // @audit-issue Add a storage gap variable for this upgradeable contract
  23 |  contract L2WrappedBaseToken is ERC20PermitUpgradeable, IL2WrappedBaseToken, IL2StandardToken {
```
GitHub: [23](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2WrappedBaseToken.sol#L23)


## [L-28] Potential loss of precision

Division by large numbers may result in the result being zero, due to solidity not supporting fractions. Consider requiring a minimum amount for the numerator to ensure that it is always larger than the denominator.

*Instances: 10*

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

     |  // @audit-issue Division without corresponding multiplication
 167 |  uint256 fullPubdataPriceBaseToken = pubdataPriceBaseToken +
 168 |      batchOverheadBaseToken /
 169 |      uint256(feeParams.maxPubdataPerBatch);

     |  // @audit-issue Division without corresponding multiplication
 171 |  uint256 l2GasPrice = feeParams.minimalL2GasPrice + batchOverheadBaseToken / uint256(feeParams.maxL2GasPerBatch);

     |  // @audit-issue Division without corresponding multiplication
 172 |  uint256 minL2GasPriceBaseToken = (fullPubdataPriceBaseToken + _gasPerPubdata - 1) / _gasPerPubdata;
```
GitHub: [167-169](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L167-L169), [171](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L171), [172](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L172)


```solidity
File: code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol

     |  // @audit-issue Division without corresponding multiplication
  25 |  uint256 bytecodeLenInWords = _bytecode.length / 32;
```
GitHub: [25](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L25)


```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/LibMap.sol

     |  // @audit-issue Division without corresponding multiplication
  23 |  uint256 mapValue = _map.map[_index / 8];

     |  // @audit-issue Division without corresponding multiplication
  43 |  uint256 mapIndex = _index / 8;
```
GitHub: [23](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/LibMap.sol#L23), [43](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/LibMap.sol#L43)


```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol

     |  // @audit-issue Division without corresponding multiplication
  30 |  require(l2GasForTxBody / _transaction.gasPerPubdataByteLimit <= _priorityTxMaxPubdata, "uk");
```
GitHub: [30](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L30)


```solidity
File: code/system-contracts/contracts/Compressor.sol

     |  // @audit-issue Division without corresponding multiplication
  56 |  require(
  57 |      dictionary.length / 8 <= encodedData.length / 2,
  58 |      "Dictionary should have at most the same number of entries as the encoded data"
  59 |  );
```
GitHub: [56-59](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L56-L59)


```solidity
File: code/system-contracts/contracts/NonceHolder.sol

     |  // @audit-issue Division without corresponding multiplication
 180 |  deploymentNonce = _rawMinNonce / DEPLOY_NONCE_MULTIPLIER;
```
GitHub: [180](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/NonceHolder.sol#L180)


```solidity
File: code/system-contracts/contracts/libraries/Utils.sol

     |  // @audit-issue Division without corresponding multiplication
  86 |  uint256 lengthInWords = _bytecode.length / 32;
```
GitHub: [86](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L86)


## [L-29] Some tokens may revert when zero value transfers are made

In spite of the fact that EIP-20 [states](https://github.com/ethereum/EIPs/blob/46b9b698815abbfa628cd1097311deee77dd45c5/EIPS/eip-20.md?plain=1#L116) that zero-valued transfers must be accepted, some tokens, such as LEND will revert if this is attempted, which may cause transactions that involve other tokens (such as batch operations) to fully revert. Consider skipping the transfer if the amount is zero, which will also save gas.

*Instances: 5*

```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

     |  // @audit-issue Check transfer amount > 0
  67 |  IERC20(_token).safeTransfer(address(sharedBridge), amount);

     |  // @audit-issue Check transfer amount > 0
 162 |  _token.safeTransferFrom(_from, address(sharedBridge), _amount);
```
GitHub: [67](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L67), [162](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L162)


```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

     |  // @audit-issue Check transfer amount > 0
 175 |  _token.safeTransferFrom(_from, address(this), _amount);

     |  // @audit-issue Check transfer amount > 0
 452 |  IERC20(l1Token).safeTransfer(l1Receiver, amount);
```
GitHub: [175](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L175), [452](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L452)


```solidity
File: code/contracts/zksync/contracts/TestnetPaymaster.sol

     |  // @audit-issue Check transfer amount > 0
  50 |  try IERC20(token).transferFrom(userAddress, thisAddress, amount) {} catch (bytes memory revertReason) {
```
GitHub: [50](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/TestnetPaymaster.sol#L50)


## [L-30] State variables should be constrained to validated ranges

Consider adding minimum/maximum value checks to ensure that the state variables below can never be used to excessively harm users, including via griefing

*Instances: 9*

```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

     |  // @audit-issue `_newDelay` is assigned to a state variable, unvalidated
 249 |  function updateDelay(uint256 _newDelay) external onlySelf {
```
GitHub: [249](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L249)


```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

     |  // @audit-issue `_newProtocolVersion` is assigned to a state variable, unvalidated
 144 |  function setNewVersionUpgrade(
 145 |      Diamond.DiamondCutData calldata _cutData,
 146 |      uint256 _oldProtocolVersion,
 147 |      uint256 _newProtocolVersion
 148 |  ) external onlyOwner {
```
GitHub: [144-148](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L144-L148)


```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

     |  // @audit-issue `_executionDelay` is assigned to a state variable, unvalidated
  96 |  function setExecutionDelay(uint32 _executionDelay) external onlyOwner {
```
GitHub: [96](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L96)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol

     |  // @audit-issue `_nominator` is assigned to a state variable, unvalidated
     |  // `_denominator` is assigned to a state variable, unvalidated
  79 |  function setTokenMultiplier(uint128 _nominator, uint128 _denominator) external onlyAdminOrStateTransitionManager {
```
GitHub: [79](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L79)


```solidity
File: code/system-contracts/contracts/NonceHolder.sol

     |  // @audit-issue `_value` is assigned to a state variable, unvalidated
  82 |  function setValueUnderNonce(uint256 _key, uint256 _value) public onlySystemCall {
```
GitHub: [82](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/NonceHolder.sol#L82)


```solidity
File: code/system-contracts/contracts/SystemContext.sol

     |  // @audit-issue `_newChainId` is assigned to a state variable, unvalidated
  84 |  function setChainId(uint256 _newChainId) external onlyCallFromForceDeployer {

     |  // @audit-issue `_gasPrice` is assigned to a state variable, unvalidated
 105 |  function setGasPrice(uint256 _gasPrice) external onlyCallFromBootloader {

     |  // @audit-issue `_gasPerPubdataByte` is assigned to a state variable, unvalidated
     |  // `_basePubdataSpent` is assigned to a state variable, unvalidated
 112 |  function setPubdataInfo(uint256 _gasPerPubdataByte, uint256 _basePubdataSpent) external onlyCallFromBootloader {

     |  // @audit-issue `_baseFee` is assigned to a state variable, unvalidated
 444 |  function setNewBatch(
 445 |      bytes32 _prevBatchHash,
 446 |      uint128 _newTimestamp,
 447 |      uint128 _expectedNewNumber,
 448 |      uint256 _baseFee
 449 |  ) external onlyCallFromBootloader {
```
GitHub: [84](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L84), [105](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L105), [112](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L112), [444-449](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L444-L449)


## [L-31] The `owner` is a single point of failure and a centralization risk

Having a single EOA as the only owner of contracts is a large centralization risk and a single point of failure. A single private key may be taken in a hack, or the sole holder of the key may become unable to retrieve the key when necessary, or the single owner can become malicious and perform a rug-pull. Consider changing to a multi-signature setup, and or having a role-based authorization model.

*Instances: 19*

```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

     |  // @audit-issue Consider more granular roles to limit centralization risks
 116 |  function transferFundsFromLegacy(address _token, address _target, uint256 _targetChainId) external onlyOwner {

     |  // @audit-issue Consider more granular roles to limit centralization risks
 142 |  function initializeChainGovernance(uint256 _chainId, address _l2BridgeAddress) external onlyOwner {
```
GitHub: [116](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L116), [142](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L142)


```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

     |  // @audit-issue Consider more granular roles to limit centralization risks
  82 |  function addStateTransitionManager(address _stateTransitionManager) external onlyOwner {

     |  // @audit-issue Consider more granular roles to limit centralization risks
  92 |  function removeStateTransitionManager(address _stateTransitionManager) external onlyOwner {

     |  // @audit-issue Consider more granular roles to limit centralization risks
 101 |  function addToken(address _token) external onlyOwner {

     |  // @audit-issue Consider more granular roles to limit centralization risks
 108 |  function setSharedBridge(address _sharedBridge) external onlyOwner {
```
GitHub: [82](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L82), [92](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L92), [101](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L101), [108](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L108)


```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

     |  // @audit-issue Consider more granular roles to limit centralization risks
 129 |  function scheduleTransparent(Operation calldata _operation, uint256 _delay) external onlyOwner {

     |  // @audit-issue Consider more granular roles to limit centralization risks
 142 |  function scheduleShadow(bytes32 _id, uint256 _delay) external onlyOwner {

     |  // @audit-issue Consider more granular roles to limit centralization risks
 154 |  function cancel(bytes32 _id) external onlyOwner {
```
GitHub: [129](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L129), [142](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L142), [154](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L154)


```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

     |  // @audit-issue Consider more granular roles to limit centralization risks
 139 |  function setInitialCutHash(Diamond.DiamondCutData calldata _diamondCut) external onlyOwner {

     |  // @audit-issue Consider more granular roles to limit centralization risks
 148 |  ) external onlyOwner {

     |  // @audit-issue Consider more granular roles to limit centralization risks
 157 |  ) external onlyOwner {

     |  // @audit-issue Consider more granular roles to limit centralization risks
 162 |  function freezeChain(uint256 _chainId) external onlyOwner {

     |  // @audit-issue Consider more granular roles to limit centralization risks
 167 |  function unfreezeChain(uint256 _chainId) external onlyOwner {

     |  // @audit-issue Consider more granular roles to limit centralization risks
 235 |  ) external onlyOwner {
```
GitHub: [139](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L139), [148](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L148), [157](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L157), [162](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L162), [167](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L167), [235](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L235)


```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

     |  // @audit-issue Consider more granular roles to limit centralization risks
  73 |  function setStateTransitionManager(IStateTransitionManager _stateTransitionManager) external onlyOwner {

     |  // @audit-issue Consider more granular roles to limit centralization risks
  96 |  function setExecutionDelay(uint32 _executionDelay) external onlyOwner {
```
GitHub: [73](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L73), [96](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L96)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol

     |  // @audit-issue Consider more granular roles to limit centralization risks
  23 |  function setPendingAdmin(address _newPendingAdmin) external onlyAdmin {

     |  // @audit-issue Consider more granular roles to limit centralization risks
  89 |  function setValidiumMode(PubdataPricingMode _validiumMode) external onlyAdmin {
```
GitHub: [23](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L23), [89](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L89)


## [L-32] Unsafe downcast

When a type is downcast to a smaller type, the higher order bits are truncated, effectively applying a modulo to the original value. Without any other checks, this wrapping will lead to unexpected behavior and bugs.

*Instances: 61*

```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

     |  // @audit-issue Casting from uint256 to uint32 will truncate bits
 115 |  uint32 timestamp = uint32(block.timestamp);

     |  // @audit-issue Casting from uint256 to uint32 will truncate bits
 134 |  uint32 timestamp = uint32(block.timestamp);
```
GitHub: [115](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L115), [134](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L134)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

     |  // @audit-issue Casting from uint256 to uint8 will truncate bits
 149 |  require(!_checkBit(processedLogs, uint8(logKey)), "kp");

     |  // @audit-issue Casting from uint256 to uint8 will truncate bits
 150 |  processedLogs = _setBit(processedLogs, uint8(logKey));
```
GitHub: [149](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L149), [150](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L150)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

     |  // @audit-issue Casting from uint256 to uint64 will truncate bits
 283 |  _params.expirationTimestamp = uint64(block.timestamp + PRIORITY_EXPIRATION); // Safe to cast
```
GitHub: [283](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L283)


```solidity
File: code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol

     |  // @audit-issue Casting from uint256 to uint160 will truncate bits
  71 |  return address(uint160(uint256(data)));
```
GitHub: [71](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L71)


```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/LibMap.sol

     |  // @audit-issue Casting from uint256 to uint32 will truncate bits
  30 |  result = uint32(mapValue >> bitOffset);

     |  // @audit-issue Casting from uint256 to uint32 will truncate bits
  54 |  uint32 oldValue = uint32(mapValue >> bitOffset);
```
GitHub: [30](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/LibMap.sol#L30), [54](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/LibMap.sol#L54)


```solidity
File: code/system-contracts/contracts/AccountCodeStorage.sol

     |  // @audit-issue Casting from uint256 to uint160 will truncate bits
  92 |  address account = address(uint160(_input));

     |  // @audit-issue Casting from uint256 to uint160 will truncate bits
 120 |  address account = address(uint160(_input));
```
GitHub: [92](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L92), [120](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L120)


```solidity
File: code/system-contracts/contracts/BootloaderUtilities.sol

     |  // @audit-issue Casting from uint256 to uint160 will truncate bits
  61 |  bytes memory encodedTo = RLPEncoder.encodeAddress(address(uint160(_transaction.to)));

     |  // @audit-issue Casting from uint256 to uint64 will truncate bits
  68 |  uint64 txDataLen = uint64(_transaction.data.length);

     |  // @audit-issue Casting from uint256 to uint64 will truncate bits
 116 |  encodedListLength = RLPEncoder.encodeListLen(uint64(listLength));

     |  // @audit-issue Casting from uint256 to uint160 will truncate bits
 147 |  bytes memory encodedTo = RLPEncoder.encodeAddress(address(uint160(_transaction.to)));

     |  // @audit-issue Casting from uint256 to uint64 will truncate bits
 164 |  uint64 txDataLen = uint64(_transaction.data.length);

     |  // @audit-issue Casting from uint256 to uint64 will truncate bits
 207 |  encodedListLength = RLPEncoder.encodeListLen(uint64(listLength));

     |  // @audit-issue Casting from uint256 to uint160 will truncate bits
 241 |  bytes memory encodedTo = RLPEncoder.encodeAddress(address(uint160(_transaction.to)));

     |  // @audit-issue Casting from uint256 to uint64 will truncate bits
 259 |  uint64 txDataLen = uint64(_transaction.data.length);

     |  // @audit-issue Casting from uint256 to uint64 will truncate bits
 302 |  encodedListLength = RLPEncoder.encodeListLen(uint64(listLength));
```
GitHub: [61](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L61), [68](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L68), [116](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L116), [147](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L147), [164](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L164), [207](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L207), [241](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L241), [259](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L259), [302](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L302)


```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

     |  // @audit-issue Casting from uint256 to uint160 will truncate bits
 109 |  newAddress = address(uint160(uint256(hash)));

     |  // @audit-issue Casting from uint256 to uint160 will truncate bits
 125 |  newAddress = address(uint160(uint256(hash)));

     |  // @audit-issue Casting from uint256 to uint128 will truncate bits
 341 |  SystemContractHelper.setValueForNextFarCall(uint128(value));
```
GitHub: [109](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L109), [125](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L125), [341](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L341)


```solidity
File: code/system-contracts/contracts/DefaultAccount.sol

     |  // @audit-issue Casting from uint256 to uint32 will truncate bits
  84 |  uint32(gasleft()),

     |  // @audit-issue Casting from uint256 to uint160 will truncate bits
 132 |  address to = address(uint160(_transaction.to));
```
GitHub: [84](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L84), [132](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L132)


```solidity
File: code/system-contracts/contracts/L1Messenger.sol

     |  // @audit-issue Casting from uint256 to uint32 will truncate bits
 154 |  SystemContractHelper.burnGas(Utils.safeCastToU32(gasToPay), uint32(pubdataLen));

     |  // @audit-issue Casting from uint256 to uint32 will truncate bits
 179 |  SystemContractHelper.burnGas(Utils.safeCastToU32(gasToPay), uint32(pubdataLen));
```
GitHub: [154](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L154), [179](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L179)


```solidity
File: code/system-contracts/contracts/L2BaseToken.sol

     |  // @audit-issue Casting from uint256 to uint160 will truncate bits
  57 |  return balance[address(uint160(_account))];
```
GitHub: [57](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L2BaseToken.sol#L57)


```solidity
File: code/system-contracts/contracts/MsgValueSimulator.sol

     |  // @audit-issue Casting from uint256 to uint160 will truncate bits
  32 |  to = address(uint160(addressAsUint));
```
GitHub: [32](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/MsgValueSimulator.sol#L32)


```solidity
File: code/system-contracts/contracts/SystemContext.sol

     |  // @audit-issue Casting from uint128 to uint32 will truncate bits
 234 |  return keccak256(abi.encodePacked(uint32(_blockNumber)));

     |  // @audit-issue Casting from uint256 to uint128 will truncate bits
 476 |  BlockInfo memory newBlockInfo = BlockInfo({number: uint128(_number), timestamp: uint128(_newTimestamp)});

     |  // @audit-issue Casting from uint256 to uint128 will truncate bits
 476 |  BlockInfo memory newBlockInfo = BlockInfo({number: uint128(_number), timestamp: uint128(_newTimestamp)});
```
GitHub: [234](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L234), [476](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L476), [476](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L476)


```solidity
File: code/system-contracts/contracts/libraries/EfficientCall.sol

     |  // @audit-issue Casting from uint256 to uint32 will truncate bits
 259 |  SystemContractHelper.ptrAddIntoActive(uint32(dataOffset));

     |  // @audit-issue Casting from uint256 to uint32 will truncate bits
 261 |  uint32 shrinkTo = uint32(msg.data.length - (_data.length + dataOffset));
```
GitHub: [259](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L259), [261](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L261)


```solidity
File: code/system-contracts/contracts/libraries/RLPEncoder.sol

     |  // @audit-issue Casting from uint256 to uint8 will truncate bits
  29 |  encoded[0] = (_val == 0) ? bytes1(uint8(128)) : bytes1(uint8(_val));

     |  // @audit-issue Casting from uint256 to uint8 will truncate bits
  34 |  encoded[0] = bytes1(uint8(hbs + 0x81));

     |  // @audit-issue Casting from uint256 to uint8 will truncate bits
  64 |  encoded[0] = bytes1(uint8(_len + _offset));

     |  // @audit-issue Casting from uint256 to uint8 will truncate bits
  69 |  encoded[0] = bytes1(uint8(_offset + hbs + 56));
```
GitHub: [29](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/RLPEncoder.sol#L29), [34](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/RLPEncoder.sol#L34), [64](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/RLPEncoder.sol#L64), [69](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/RLPEncoder.sol#L69)


```solidity
File: code/system-contracts/contracts/libraries/SystemContractHelper.sol

     |  // @audit-issue Casting from uint256 to uint32 will truncate bits
 228 |  pubdataPublished = uint32(extractNumberFromMeta(meta, META_GAS_PER_PUBDATA_BYTE_OFFSET, 32));

     |  // @audit-issue Casting from uint256 to uint32 will truncate bits
 238 |  heapSize = uint32(extractNumberFromMeta(meta, META_HEAP_SIZE_OFFSET, 32));

     |  // @audit-issue Casting from uint256 to uint32 will truncate bits
 247 |  auxHeapSize = uint32(extractNumberFromMeta(meta, META_AUX_HEAP_SIZE_OFFSET, 32));

     |  // @audit-issue Casting from uint256 to uint8 will truncate bits
 255 |  shardId = uint8(extractNumberFromMeta(meta, META_SHARD_ID_OFFSET, 8));

     |  // @audit-issue Casting from uint256 to uint8 will truncate bits
 264 |  callerShardId = uint8(extractNumberFromMeta(meta, META_CALLER_SHARD_ID_OFFSET, 8));

     |  // @audit-issue Casting from uint256 to uint8 will truncate bits
 273 |  codeShardId = uint8(extractNumberFromMeta(meta, META_CODE_SHARD_ID_OFFSET, 8));
```
GitHub: [228](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L228), [238](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L238), [247](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L247), [255](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L255), [264](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L264), [273](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L273)


```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

     |  // @audit-issue Casting from uint256 to uint160 will truncate bits
 164 |  bytes memory encodedTo = RLPEncoder.encodeAddress(address(uint160(_transaction.to)));

     |  // @audit-issue Casting from uint256 to uint64 will truncate bits
 171 |  uint64 txDataLen = uint64(_transaction.data.length);

     |  // @audit-issue Casting from uint256 to uint64 will truncate bits
 199 |  encodedListLength = RLPEncoder.encodeListLen(uint64(listLength));

     |  // @audit-issue Casting from uint256 to uint160 will truncate bits
 232 |  bytes memory encodedTo = RLPEncoder.encodeAddress(address(uint160(_transaction.to)));

     |  // @audit-issue Casting from uint256 to uint64 will truncate bits
 249 |  uint64 txDataLen = uint64(_transaction.data.length);

     |  // @audit-issue Casting from uint256 to uint64 will truncate bits
 271 |  encodedListLength = RLPEncoder.encodeListLen(uint64(listLength));

     |  // @audit-issue Casting from uint256 to uint160 will truncate bits
 303 |  bytes memory encodedTo = RLPEncoder.encodeAddress(address(uint160(_transaction.to)));

     |  // @audit-issue Casting from uint256 to uint64 will truncate bits
 321 |  uint64 txDataLen = uint64(_transaction.data.length);

     |  // @audit-issue Casting from uint256 to uint64 will truncate bits
 343 |  encodedListLength = RLPEncoder.encodeListLen(uint64(listLength));

     |  // @audit-issue Casting from uint256 to uint160 will truncate bits
 375 |  address paymaster = address(uint160(_transaction.paymaster));

     |  // @audit-issue Casting from uint256 to uint160 will truncate bits
 406 |  if (address(uint160(_transaction.paymaster)) != address(0)) {
```
GitHub: [164](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L164), [171](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L171), [199](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L199), [232](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L232), [249](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L249), [271](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L271), [303](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L303), [321](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L321), [343](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L343), [375](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L375), [406](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L406)


```solidity
File: code/system-contracts/contracts/libraries/Utils.sol

     |  // @audit-issue Casting from uint256 to uint128 will truncate bits
  23 |  return uint128(_x);

     |  // @audit-issue Casting from uint256 to uint32 will truncate bits
  29 |  return uint32(_x);

     |  // @audit-issue Casting from uint256 to uint24 will truncate bits
  35 |  return uint24(_x);
```
GitHub: [23](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L23), [29](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L29), [35](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L35)


```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

     |  // @audit-issue Casting from uint256 to uint32 will truncate bits
 166 |  uint32(gasleft()),
```
GitHub: [166](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L166)


```solidity
File: code/contracts/zksync/contracts/L2ContractHelper.sol

     |  // @audit-issue Casting from uint256 to uint160 will truncate bits
 112 |  return address(uint160(uint256(data)));
```
GitHub: [112](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/L2ContractHelper.sol#L112)


```solidity
File: code/contracts/zksync/contracts/SystemContractsCaller.sol

     |  // @audit-issue Casting from uint256 to uint32 will truncate bits
  30 |  return uint32(_x);
```
GitHub: [30](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/SystemContractsCaller.sol#L30)


```solidity
File: code/contracts/zksync/contracts/TestnetPaymaster.sol

     |  // @audit-issue Casting from uint256 to uint160 will truncate bits
  32 |  address userAddress = address(uint160(_transaction.from));
```
GitHub: [32](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/TestnetPaymaster.sol#L32)


## [L-33] Upgradeable contract uses non-upgradeable version of the OpenZeppelin libraries/contracts

OpenZeppelin has an [Upgradeable](https://github.com/OpenZeppelin/openzeppelin-contracts-upgradeable/tree/master/contracts/utils) variants of each of its libraries and contracts, and upgradeable contracts should use those variants.

*Instances: 7*

```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

   5 |  import {Initializable} from "@openzeppelin/contracts/proxy/utils/Initializable.sol";

   6 |  import {BeaconProxy} from "@openzeppelin/contracts/proxy/beacon/BeaconProxy.sol";

   7 |  import {UpgradeableBeacon} from "@openzeppelin/contracts/proxy/beacon/UpgradeableBeacon.sol";
```
GitHub: [5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L5), [6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L6), [7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L7)


```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

   5 |  import {ERC20PermitUpgradeable} from "@openzeppelin/contracts-upgradeable/token/ERC20/extensions/draft-ERC20PermitUpgradeable.sol";

   6 |  import {UpgradeableBeacon} from "@openzeppelin/contracts/proxy/beacon/UpgradeableBeacon.sol";

   7 |  import {ERC1967Upgrade} from "@openzeppelin/contracts/proxy/ERC1967/ERC1967Upgrade.sol";
```
GitHub: [5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L5), [6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L6), [7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L7)


```solidity
File: code/contracts/zksync/contracts/bridge/L2WrappedBaseToken.sol

   5 |  import {ERC20PermitUpgradeable} from "@openzeppelin/contracts-upgradeable/token/ERC20/extensions/draft-ERC20PermitUpgradeable.sol";
```
GitHub: [5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2WrappedBaseToken.sol#L5)


## [L-34] Use of `tx.origin` is unsafe in almost every context

According to [Vitalik Buterin](https://ethereum.stackexchange.com/questions/196/how-do-i-make-my-dapp-serenity-proof), contracts should _not_ `assume that tx.origin will continue to be usable or meaningful`. An example of this is [EIP-3074](https://eips.ethereum.org/EIPS/eip-3074#allowing-txorigin-as-signer-1) which explicitly mentions the intention to change its semantics when it's used with new op codes. There have also been calls to [remove](https://github.com/ethereum/solidity/issues/683) `tx.origin`, and there are [security issues](solidity.readthedocs.io/en/v0.4.24/security-considerations.html#tx-origin) associated with using it for authorization. For these reasons, it's best to completely avoid the feature.

*Instances: 3*

```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

     |  // @audit-issue tx.origin does not have reliable semantics
 579 |  refundRecipient = _prevMsgSender != tx.origin
```
GitHub: [579](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L579)


```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

     |  // @audit-issue tx.origin does not have reliable semantics
 328 |  _recipient = msg.sender == tx.origin ? msg.sender : AddressAliasHelper.applyL1ToL2Alias(msg.sender);
```
GitHub: [328](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L328)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

     |  // @audit-issue tx.origin does not have reliable semantics
 234 |  if (l2Sender != tx.origin) {
```
GitHub: [234](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L234)


## [L-35] Use of a single-step ownership transfer

The existing `transferOwnership` function immediately transfers ownership to the new address. Consider implementing a two-step variant, where the 'acceptor' of the ownership must call a separate function in order for the transfer to take effect. This can help to prevent mistakes where the wrong address is used, and ownership is irrecoverably lost.

*Instances: 1*

```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

     |  // @audit-issue Use a two-step ownership transfer pattern
  66 |  l2TokenBeacon.transferOwnership(_aliasedOwner);
```
GitHub: [66](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L66)


## [L-36] Use of low-level `call()` is not recommended

Low-level `call()`s are more error prone and difficult to review because they do not clearly define an expected interface on the calling side, and similarly it's difficult to identify all the candidate receiving side contracts without an interface.

*Instances: 5*

```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

     |  // @audit-issue Consider using a high-level function call for clarity
 226 |  (bool success, bytes memory returnData) = _calls[i].target.call{value: _calls[i].value}(_calls[i].data);
```
GitHub: [226](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L226)


```solidity
File: code/system-contracts/contracts/MsgValueSimulator.sol

     |  // @audit-issue Consider using a high-level function call for clarity
  63 |  (bool success, ) = address(REAL_BASE_TOKEN_SYSTEM_CONTRACT).call(
  64 |      abi.encodeCall(REAL_BASE_TOKEN_SYSTEM_CONTRACT.transferFromTo, (msg.sender, to, value))
  65 |  );
```
GitHub: [63-65](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/MsgValueSimulator.sol#L63-L65)


```solidity
File: code/contracts/zksync/contracts/TestnetPaymaster.sol

     |  // @audit-issue Consider using a high-level function call for clarity
  63 |  (bool success, ) = payable(BOOTLOADER_ADDRESS).call{value: requiredETH}("");
```
GitHub: [63](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/TestnetPaymaster.sol#L63)


```solidity
File: code/contracts/zksync/contracts/bridge/L2WrappedBaseToken.sol

     |  // @audit-issue Consider using a high-level function call for clarity
  83 |  (bool success, ) = msg.sender.call{value: _amount}("");

     |  // @audit-issue Consider using a high-level function call for clarity
 108 |  (bool success, ) = _to.call{value: _amount}("");
```
GitHub: [83](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2WrappedBaseToken.sol#L83), [108](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2WrappedBaseToken.sol#L108)


## [L-37] `call()`/`delegatecall()` should check for contract-existence

Low-level calls return success if there is no code present at the specified address. In addition to the zero-address checks, add a check to verify that `<address>.code.length > 0`.

*Instances: 7*

```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

     |  // @audit-issue Add contract existence checks
 226 |  (bool success, bytes memory returnData) = _calls[i].target.call{value: _calls[i].value}(_calls[i].data);
```
GitHub: [226](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L226)


```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol

     |  // @audit-issue Add contract existence checks
 283 |  (bool success, bytes memory data) = _init.delegatecall(_calldata);
```
GitHub: [283](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L283)


```solidity
File: code/system-contracts/contracts/ComplexUpgrader.sol

     |  // @audit-issue Add contract existence checks
  25 |  (bool success, bytes memory returnData) = _delegateTo.delegatecall(_calldata);
```
GitHub: [25](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ComplexUpgrader.sol#L25)


```solidity
File: code/system-contracts/contracts/MsgValueSimulator.sol

     |  // @audit-issue Add contract existence checks
  63 |  (bool success, ) = address(REAL_BASE_TOKEN_SYSTEM_CONTRACT).call(
  64 |      abi.encodeCall(REAL_BASE_TOKEN_SYSTEM_CONTRACT.transferFromTo, (msg.sender, to, value))
  65 |  );
```
GitHub: [63-65](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/MsgValueSimulator.sol#L63-L65)


```solidity
File: code/contracts/zksync/contracts/TestnetPaymaster.sol

     |  // @audit-issue Add contract existence checks
  63 |  (bool success, ) = payable(BOOTLOADER_ADDRESS).call{value: requiredETH}("");
```
GitHub: [63](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/TestnetPaymaster.sol#L63)


```solidity
File: code/contracts/zksync/contracts/bridge/L2WrappedBaseToken.sol

     |  // @audit-issue Add contract existence checks
  83 |  (bool success, ) = msg.sender.call{value: _amount}("");

     |  // @audit-issue Add contract existence checks
 108 |  (bool success, ) = _to.call{value: _amount}("");
```
GitHub: [83](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2WrappedBaseToken.sol#L83), [108](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2WrappedBaseToken.sol#L108)


## [L-38] `call()`/`delegatecall()` should specify a gas limit

There is no limit specified on the amount of gas used, so the recipient can use up all of the transaction's gas, causing it to revert. Use `addr.call{gas: <amount>}("")` or [this](https://github.com/nomad-xyz/ExcessivelySafeCall) library instead.

*Instances: 7*

```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

     |  // @audit-issue Specify { gas: <amount> } option
 226 |  (bool success, bytes memory returnData) = _calls[i].target.call{value: _calls[i].value}(_calls[i].data);
```
GitHub: [226](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L226)


```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol

     |  // @audit-issue Specify { gas: <amount> } option
 283 |  (bool success, bytes memory data) = _init.delegatecall(_calldata);
```
GitHub: [283](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L283)


```solidity
File: code/system-contracts/contracts/ComplexUpgrader.sol

     |  // @audit-issue Specify { gas: <amount> } option
  25 |  (bool success, bytes memory returnData) = _delegateTo.delegatecall(_calldata);
```
GitHub: [25](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ComplexUpgrader.sol#L25)


```solidity
File: code/system-contracts/contracts/MsgValueSimulator.sol

     |  // @audit-issue Specify { gas: <amount> } option
  63 |  (bool success, ) = address(REAL_BASE_TOKEN_SYSTEM_CONTRACT).call(
  64 |      abi.encodeCall(REAL_BASE_TOKEN_SYSTEM_CONTRACT.transferFromTo, (msg.sender, to, value))
  65 |  );
```
GitHub: [63-65](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/MsgValueSimulator.sol#L63-L65)


```solidity
File: code/contracts/zksync/contracts/TestnetPaymaster.sol

     |  // @audit-issue Specify { gas: <amount> } option
  63 |  (bool success, ) = payable(BOOTLOADER_ADDRESS).call{value: requiredETH}("");
```
GitHub: [63](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/TestnetPaymaster.sol#L63)


```solidity
File: code/contracts/zksync/contracts/bridge/L2WrappedBaseToken.sol

     |  // @audit-issue Specify { gas: <amount> } option
  83 |  (bool success, ) = msg.sender.call{value: _amount}("");

     |  // @audit-issue Specify { gas: <amount> } option
 108 |  (bool success, ) = _to.call{value: _amount}("");
```
GitHub: [83](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2WrappedBaseToken.sol#L83), [108](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2WrappedBaseToken.sol#L108)


## [L-39] `receive()`/`fallback()` contains no logic

In Solidity, functions that receive Ether without corresponding functionality to utilize or withdraw these funds can inadvertently lead to a permanent loss of value. This is because if someone sends Ether to the contract, they may be unable to retrieve it. To avoid this, functions receiving Ether should be accompanied by additional methods that process or allow the withdrawal of these funds. If the intent is to use the received Ether, it should trigger a separate function; if not, it should revert the transaction (for instance, via `require(msg.sender == address(weth))`). Access control checks can also prevent unintended Ether transfers, despite the slight gas cost they entail. If concerns over gas costs persist, at minimum, include a rescue function to recover unused Ether. Missteps in handling Ether in smart contracts can lead to irreversible financial losses, hence these precautions are crucial.

*Instances: 5*

```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

     |  // @audit-issue Emit an event at the very least, or reject the value
 262 |  receive() external payable {}
```
GitHub: [262](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L262)


```solidity
File: code/system-contracts/contracts/DefaultAccount.sol

     |  // @audit-issue Emit an event at the very least, or reject the value
 227 |  receive() external payable {
 228 |      // If the contract is called directly, behave like an EOA
 229 |  }
```
GitHub: [227-229](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L227-L229)


```solidity
File: code/system-contracts/contracts/EmptyContract.sol

     |  // @audit-issue Emit an event at the very least, or reject the value
  11 |  fallback() external payable {}

     |  // @audit-issue Emit an event at the very least, or reject the value
  13 |  receive() external payable {}
```
GitHub: [11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/EmptyContract.sol#L11), [13](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/EmptyContract.sol#L13)


```solidity
File: code/contracts/zksync/contracts/TestnetPaymaster.sol

     |  // @audit-issue Emit an event at the very least, or reject the value
  81 |  receive() external payable {}
```
GitHub: [81](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/TestnetPaymaster.sol#L81)


## [L-40] `receive()`/`fallback()` has no authorization

Having no access control on the function (e.g. `require(msg.sender == _owner)`) means that someone may accidentally send value to the contract, and have no way to get anything back out, which is a loss of funds. If the concern is having to spend a small amount of gas to check the sender against an immutable address, the code should at least have a function to rescue mistakenly-sent value.

*Instances: 6*

```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

     |  // @audit-issue Consider adding authorization
 262 |  receive() external payable {}
```
GitHub: [262](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L262)


```solidity
File: code/system-contracts/contracts/DefaultAccount.sol

     |  // @audit-issue Consider adding authorization
 227 |  receive() external payable {
 228 |      // If the contract is called directly, behave like an EOA
 229 |  }
```
GitHub: [227-229](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L227-L229)


```solidity
File: code/system-contracts/contracts/EmptyContract.sol

     |  // @audit-issue Consider adding authorization
  11 |  fallback() external payable {}

     |  // @audit-issue Consider adding authorization
  13 |  receive() external payable {}
```
GitHub: [11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/EmptyContract.sol#L11), [13](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/EmptyContract.sol#L13)


```solidity
File: code/contracts/zksync/contracts/TestnetPaymaster.sol

     |  // @audit-issue Consider adding authorization
  81 |  receive() external payable {}
```
GitHub: [81](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/TestnetPaymaster.sol#L81)


```solidity
File: code/contracts/zksync/contracts/bridge/L2WrappedBaseToken.sol

     |  // @audit-issue Consider adding authorization
 113 |  receive() external payable {
 114 |      depositTo(msg.sender);
 115 |  }
```
GitHub: [113-115](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2WrappedBaseToken.sol#L113-L115)


## [L-41] `require()` should be used instead of `assert()`

Prior to solidity version 0.8.0, hitting an assert consumes the **remainder of the transaction's available gas** rather than returning it, as `require()`/`revert()` do. `assert()` should be avoided even past solidity version 0.8.0 as its [documentation](https://docs.soliditylang.org/en/v0.8.14/control-structures.html#panic-via-assert-and-error-via-require) states that "The assert function creates an error of type Panic(uint256). ... Properly functioning code should never create a Panic, not even on invalid external input. If this happens, then there is a bug in your contract which you should fix".

*Instances: 5*

```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

     |  // @audit-issue Use require() instead
 108 |  assert(L2_TO_L1_LOG_SERIALIZE_SIZE != 2 * 32);
```
GitHub: [108](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L108)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol

     |  // @audit-issue Use require() instead
  51 |  assert(L2_TO_L1_LOG_SERIALIZE_SIZE != 2 * 32);
```
GitHub: [51](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol#L51)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

     |  // @audit-issue Use require() instead
 426 |  assert(block.chainid != 1);
```
GitHub: [426](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L426)


```solidity
File: code/system-contracts/contracts/DefaultAccount.sol

     |  // @audit-issue Use require() instead
 222 |  assert(msg.sender != BOOTLOADER_FORMAL_ADDRESS);
```
GitHub: [222](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L222)


```solidity
File: code/system-contracts/contracts/libraries/RLPEncoder.sol

     |  // @audit-issue Use require() instead
  50 |  assert(_len != 1);
```
GitHub: [50](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/RLPEncoder.sol#L50)


## [L-42] `unchecked` blocks with subtractions may underflow

There aren't any checks to avoid an underflow which can happen inside an `unchecked` block, so the following subtractions may underflow silently.

*Instances: 2*

```solidity
File: code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol

  39 |  unchecked {
     |      // @audit-issue Potential underflow
  40 |      l1Address = address(uint160(l2Address) - offset);
```
GitHub: [40](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol#L40)


```solidity
File: code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol

  39 |  unchecked {
     |      // @audit-issue Potential underflow
  40 |      l1Address = address(uint160(l2Address) - offset);
```
GitHub: [40](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol#L40)

# Non-Critical Issues

## [N-01] Add inline comments for unnamed variables

`function foo(address x, address)` -> `function foo(address x, address /* y */)`

*Instances: 15*

```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

     |  // @audit-issue Consider inline comments for the unnamed variable here
 109 |  StoredBatchInfo calldata,

     |  // @audit-issue Consider inline comments for the unnamed variable here
 128 |  StoredBatchInfo calldata,

     |  // @audit-issue Consider inline comments for the unnamed variable here
 146 |  function revertBatches(uint256) external onlyValidator(ERA_CHAIN_ID) {

     |  // @audit-issue Consider inline comments for the unnamed variable here
 153 |  function revertBatchesSharedBridge(uint256 _chainId, uint256) external onlyValidator(_chainId) {

     |  // @audit-issue Consider inline comments for the unnamed variable here
 161 |  StoredBatchInfo calldata,

     |  // @audit-issue Consider inline comments for the unnamed variable here
 162 |  StoredBatchInfo[] calldata,

     |  // @audit-issue Consider inline comments for the unnamed variable here
 163 |  ProofInput calldata

     |  // @audit-issue Consider inline comments for the unnamed variable here
 173 |  StoredBatchInfo calldata,

     |  // @audit-issue Consider inline comments for the unnamed variable here
 174 |  StoredBatchInfo[] calldata,

     |  // @audit-issue Consider inline comments for the unnamed variable here
 175 |  ProofInput calldata
```
GitHub: [109](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L109), [128](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L128), [146](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L146), [153](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L153), [161](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L161), [162](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L162), [163](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L163), [173](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L173), [174](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L174), [175](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L175)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

     |  // @audit-issue Consider inline comments for the unnamed variable here
 338 |  uint256,

     |  // @audit-issue Consider inline comments for the unnamed variable here
 477 |  function revertBatchesSharedBridge(uint256, uint256 _newLastBatch) external nonReentrant onlyValidator {
```
GitHub: [338](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L338), [477](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L477)


```solidity
File: code/system-contracts/contracts/interfaces/IBaseToken.sol

     |  // @audit-issue Consider inline comments for the unnamed variable here
   6 |  function balanceOf(uint256) external view returns (uint256);
```
GitHub: [6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBaseToken.sol#L6)


```solidity
File: code/contracts/zksync/contracts/TestnetPaymaster.sol

     |  // @audit-issue Consider inline comments for the unnamed variable here
  15 |  bytes32,

     |  // @audit-issue Consider inline comments for the unnamed variable here
  16 |  bytes32,
```
GitHub: [15](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/TestnetPaymaster.sol#L15), [16](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/TestnetPaymaster.sol#L16)


## [N-02] Array indices should be referenced via `enum`s rather than via numeric literals

Numeric literals are error prone and difficult to audit and maintain. Use descriptive, documented enum values instead.

*Instances: 41*

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol

     |  // @audit-issue Use an enum instead of a numeric literal
  41 |  s.storedBatchHashes[0] = _initializeData.storedBatchZero;
```
GitHub: [41](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol#L41)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

     |  // @audit-issue Use an enum instead of a numeric literal
  39 |  uint8 pubdataSource = uint8(bytes1(_newBatch.pubdataCommitments[0]));

     |  // @audit-issue Use an enum instead of a numeric literal
  55 |  blobHashes[0] = logOutput.blob1Hash;

     |  // @audit-issue Use an enum instead of a numeric literal
  56 |  blobHashes[1] = logOutput.blob2Hash;

     |  // @audit-issue Use an enum instead of a numeric literal
  66 |  blobHashes[0] = logOutput.blob1Hash;

     |  // @audit-issue Use an enum instead of a numeric literal
  67 |  blobCommitments[0] = bytes32(

     |  // @audit-issue Use an enum instead of a numeric literal
 287 |  s.l2SystemContractsUpgradeBatchNumber = _newBatchesData[0].batchNumber;
```
GitHub: [39](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L39), [55](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L55), [56](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L56), [66](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L66), [67](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L67), [287](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L287)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol

     |  // @audit-issue Use an enum instead of a numeric literal
 170 |  bytes4 selector0 = ds.facetToSelectors[_facet].selectors[0];
```
GitHub: [170](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L170)


```solidity
File: code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol

     |  // @audit-issue Use an enum instead of a numeric literal
  40 |  uint8 version = uint8(_bytecodeHash[0]);

     |  // @audit-issue Use an enum instead of a numeric literal
  41 |  require(version == 1 && _bytecodeHash[1] == bytes1(0), "zf"); // Incorrectly formatted bytecodeHash

     |  // @audit-issue Use an enum instead of a numeric literal
  50 |  codeLengthInWords = uint256(uint8(_bytecodeHash[2])) * 256 + uint256(uint8(_bytecodeHash[3]));

     |  // @audit-issue Use an enum instead of a numeric literal
  50 |  codeLengthInWords = uint256(uint8(_bytecodeHash[2])) * 256 + uint256(uint8(_bytecodeHash[3]));
```
GitHub: [40](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L40), [41](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L41), [50](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L50), [50](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L50)


```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol

     |  // @audit-issue Use an enum instead of a numeric literal
 214 |  bytes4 selector0 = ds.facetToSelectors[_facet].selectors[0];
```
GitHub: [214](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L214)


```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol

     |  // @audit-issue Use an enum instead of a numeric literal
  54 |  require(_transaction.reserved[0] == 0, "ue");

     |  // @audit-issue Use an enum instead of a numeric literal
  55 |  require(_transaction.reserved[1] <= type(uint160).max, "uf");

     |  // @audit-issue Use an enum instead of a numeric literal
  56 |  require(_transaction.reserved[2] == 0, "ug");

     |  // @audit-issue Use an enum instead of a numeric literal
  57 |  require(_transaction.reserved[3] == 0, "uo");
```
GitHub: [54](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L54), [55](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L55), [56](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L56), [57](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L57)


```solidity
File: code/system-contracts/contracts/BootloaderUtilities.sol

     |  // @audit-issue Use an enum instead of a numeric literal
  72 |  } else if (_transaction.data[0] >= 0x80) {

     |  // @audit-issue Use an enum instead of a numeric literal
  91 |  uint256 vInt = uint256(uint8(_transaction.signature[64]));

     |  // @audit-issue Use an enum instead of a numeric literal
  96 |  if (_transaction.reserved[0] != 0) {

     |  // @audit-issue Use an enum instead of a numeric literal
 168 |  } else if (_transaction.data[0] >= 0x80) {

     |  // @audit-issue Use an enum instead of a numeric literal
 190 |  uint256 vInt = uint256(uint8(_transaction.signature[64]));

     |  // @audit-issue Use an enum instead of a numeric literal
 263 |  } else if (_transaction.data[0] >= 0x80) {

     |  // @audit-issue Use an enum instead of a numeric literal
 285 |  uint256 vInt = uint256(uint8(_transaction.signature[64]));
```
GitHub: [72](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L72), [91](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L91), [96](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L96), [168](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L168), [190](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L190), [263](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L263), [285](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L285)


```solidity
File: code/system-contracts/contracts/KnownCodesStorage.sol

     |  // @audit-issue Use an enum instead of a numeric literal
  75 |  uint8 version = uint8(_bytecodeHash[0]);

     |  // @audit-issue Use an enum instead of a numeric literal
  76 |  require(version == 1 && _bytecodeHash[1] == bytes1(0), "Incorrectly formatted bytecodeHash");
```
GitHub: [75](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/KnownCodesStorage.sol#L75), [76](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/KnownCodesStorage.sol#L76)


```solidity
File: code/system-contracts/contracts/L1Messenger.sol

     |  // @audit-issue Use an enum instead of a numeric literal
 230 |  bytes32 l2ToL1LogsTreeRoot = l2ToL1LogsTreeArray[0];
```
GitHub: [230](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L230)


```solidity
File: code/system-contracts/contracts/PubdataChunkPublisher.sol

     |  // @audit-issue Use an enum instead of a numeric literal
  55 |  SystemContractHelper.toL1(true, bytes32(uint256(SystemLogKey.BLOB_ONE_HASH_KEY)), blobHashes[0]);

     |  // @audit-issue Use an enum instead of a numeric literal
  56 |  SystemContractHelper.toL1(true, bytes32(uint256(SystemLogKey.BLOB_TWO_HASH_KEY)), blobHashes[1]);
```
GitHub: [55](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/PubdataChunkPublisher.sol#L55), [56](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/PubdataChunkPublisher.sol#L56)


```solidity
File: code/system-contracts/contracts/libraries/RLPEncoder.sol

     |  // @audit-issue Use an enum instead of a numeric literal
  29 |  encoded[0] = (_val == 0) ? bytes1(uint8(128)) : bytes1(uint8(_val));

     |  // @audit-issue Use an enum instead of a numeric literal
  34 |  encoded[0] = bytes1(uint8(hbs + 0x81));

     |  // @audit-issue Use an enum instead of a numeric literal
  64 |  encoded[0] = bytes1(uint8(_len + _offset));

     |  // @audit-issue Use an enum instead of a numeric literal
  69 |  encoded[0] = bytes1(uint8(_offset + hbs + 56));
```
GitHub: [29](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/RLPEncoder.sol#L29), [34](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/RLPEncoder.sol#L34), [64](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/RLPEncoder.sol#L64), [69](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/RLPEncoder.sol#L69)


```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

     |  // @audit-issue Use an enum instead of a numeric literal
 175 |  } else if (_transaction.data[0] >= 0x80) {

     |  // @audit-issue Use an enum instead of a numeric literal
 184 |  if (_transaction.reserved[0] != 0) {

     |  // @audit-issue Use an enum instead of a numeric literal
 253 |  } else if (_transaction.data[0] >= 0x80) {

     |  // @audit-issue Use an enum instead of a numeric literal
 325 |  } else if (_transaction.data[0] >= 0x80) {
```
GitHub: [175](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L175), [184](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L184), [253](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L253), [325](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L325)


```solidity
File: code/system-contracts/contracts/libraries/Utils.sol

     |  // @audit-issue Use an enum instead of a numeric literal
  46 |  codeLengthInWords = uint256(uint8(_bytecodeHash[2])) * 256 + uint256(uint8(_bytecodeHash[3]));

     |  // @audit-issue Use an enum instead of a numeric literal
  46 |  codeLengthInWords = uint256(uint8(_bytecodeHash[2])) * 256 + uint256(uint8(_bytecodeHash[3]));

     |  // @audit-issue Use an enum instead of a numeric literal
  52 |  return _bytecodeHash[1] == 0x00;

     |  // @audit-issue Use an enum instead of a numeric literal
  57 |  return _bytecodeHash[1] == 0x01;
```
GitHub: [46](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L46), [46](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L46), [52](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L52), [57](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L57)


## [N-03] Assembly blocks should have extensive comments

Assembly blocks take a lot more time to audit than normal Solidity code, and often have gotchas and side-effects that the Solidity versions of the same code do not. Consider adding more comments explaining what is being done in every step of the assembly code, and describe why assembly is being used instead of Solidity.

*Instances: 62*

```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

     |  // @audit-issue Inline assembly should be heavily commented
 357 |  assembly {
 358 |      callSuccess := call(gas(), _depositSender, _amount, 0, 0, 0, 0)
 359 |  }

     |  // @audit-issue Inline assembly should be heavily commented
 446 |  assembly {
 447 |      callSuccess := call(gas(), l1Receiver, amount, 0, 0, 0, 0)
 448 |  }
```
GitHub: [357-359](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L357-L359), [446-448](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L446-L448)


```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

     |  // @audit-issue Inline assembly should be heavily commented
 229 |  assembly {
 230 |      revert(add(returnData, 0x20), mload(returnData))
 231 |  }
```
GitHub: [229-231](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L229-L231)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

     |  // @audit-issue Inline assembly should be heavily commented
 360 |  assembly {
 361 |      mstore(add(hashedFactoryDeps, mul(add(i, 1), 32)), hashedBytecode)
 362 |  }
```
GitHub: [360-362](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L360-L362)


```solidity
File: code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol

     |  // @audit-issue Inline assembly should be heavily commented
  20 |  assembly {
  21 |      offset := add(_start, 4)
  22 |      result := mload(add(_bytes, offset))
  23 |  }

     |  // @audit-issue Inline assembly should be heavily commented
  27 |  assembly {
  28 |      offset := add(_start, 20)
  29 |      result := mload(add(_bytes, offset))
  30 |  }

     |  // @audit-issue Inline assembly should be heavily commented
  34 |  assembly {
  35 |      offset := add(_start, 32)
  36 |      result := mload(add(_bytes, offset))
  37 |  }

     |  // @audit-issue Inline assembly should be heavily commented
  41 |  assembly {
  42 |      offset := add(_start, 32)
  43 |      result := mload(add(_bytes, offset))
  44 |  }
```
GitHub: [20-23](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol#L20-L23), [27-30](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol#L27-L30), [34-37](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol#L34-L37), [41-44](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol#L41-L44)


```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol

     |  // @audit-issue Inline assembly should be heavily commented
  89 |  assembly {
  90 |      diamondStorage.slot := position
  91 |  }

     |  // @audit-issue Inline assembly should be heavily commented
 290 |  assembly {
 291 |      revert(add(data, 0x20), mload(data))
 292 |  }
```
GitHub: [89-91](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L89-L91), [290-292](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L290-L292)


```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol

     |  // @audit-issue Inline assembly should be heavily commented
  41 |  assembly {
  42 |      mstore(0x00, _lhs)
  43 |      mstore(0x20, _rhs)
  44 |      result := keccak256(0x00, 0x40)
  45 |  }
```
GitHub: [41-45](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol#L41-L45)


```solidity
File: code/contracts/ethereum/contracts/common/ReentrancyGuard.sol

     |  // @audit-issue Inline assembly should be heavily commented
  52 |  assembly {
  53 |      lockSlotOldValue := sload(LOCK_FLAG_ADDRESS)
  54 |      sstore(LOCK_FLAG_ADDRESS, _NOT_ENTERED)
  55 |  }

     |  // @audit-issue Inline assembly should be heavily commented
  70 |  assembly {
  71 |      _status := sload(LOCK_FLAG_ADDRESS)
  72 |  }

     |  // @audit-issue Inline assembly should be heavily commented
  78 |  assembly {
  79 |      sstore(LOCK_FLAG_ADDRESS, _ENTERED)
  80 |  }

     |  // @audit-issue Inline assembly should be heavily commented
  86 |  assembly {
  87 |      sstore(LOCK_FLAG_ADDRESS, _NOT_ENTERED)
  88 |  }
```
GitHub: [52-55](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/ReentrancyGuard.sol#L52-L55), [70-72](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/ReentrancyGuard.sol#L70-L72), [78-80](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/ReentrancyGuard.sol#L78-L80), [86-88](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/ReentrancyGuard.sol#L86-L88)


```solidity
File: code/contracts/ethereum/contracts/state-transition/Verifier.sol

     |  // @audit-issue Inline assembly should be heavily commented
 262 |          assembly {
 263 |              let start := VK_GATE_SETUP_0_X_SLOT
 264 |              let end := VK_RECURSIVE_FLAG_SLOT
 265 |              let length := add(sub(end, start), 0x20)
 267 |              vkHash := keccak256(start, length)
 268 |          }
```
GitHub: [262-268](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L262-L268)


```solidity
File: code/system-contracts/contracts/AccountCodeStorage.sol

     |  // @audit-issue Inline assembly should be heavily commented
  70 |  assembly {
  71 |      sstore(addressAsKey, _hash)
  72 |  }

     |  // @audit-issue Inline assembly should be heavily commented
  81 |  assembly {
  82 |      codeHash := sload(addressAsKey)
  83 |  }
```
GitHub: [70-72](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L70-L72), [81-83](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L81-L83)


```solidity
File: code/system-contracts/contracts/ComplexUpgrader.sol

     |  // @audit-issue Inline assembly should be heavily commented
  26 |  assembly {
  27 |      if iszero(success) {
  28 |          revert(add(returnData, 0x20), mload(returnData))
  29 |      }
  30 |  }
```
GitHub: [26-30](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ComplexUpgrader.sol#L26-L30)


```solidity
File: code/system-contracts/contracts/DefaultAccount.sol

     |  // @audit-issue Inline assembly should be heavily commented
  31 |  assembly {
  32 |      return(0, 0)
  33 |  }

     |  // @audit-issue Inline assembly should be heavily commented
  49 |  assembly {
  50 |      return(0, 0)
  51 |  }

     |  // @audit-issue Inline assembly should be heavily commented
 168 |  assembly {
 169 |      r := mload(add(_signature, 0x20))
 170 |      s := mload(add(_signature, 0x40))
 171 |      v := and(mload(add(_signature, 0x41)), 0xff)
 172 |  }
```
GitHub: [31-33](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L31-L33), [49-51](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L49-L51), [168-172](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L168-L172)


```solidity
File: code/system-contracts/contracts/KnownCodesStorage.sol

     |  // @audit-issue Inline assembly should be heavily commented
  55 |  assembly {
  56 |      sstore(_bytecodeHash, 1)
  57 |  }

     |  // @audit-issue Inline assembly should be heavily commented
  66 |  assembly {
  67 |      marker := sload(_hash)
  68 |  }
```
GitHub: [55-57](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/KnownCodesStorage.sol#L55-L57), [66-68](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/KnownCodesStorage.sol#L66-L68)


```solidity
File: code/system-contracts/contracts/MsgValueSimulator.sol

     |  // @audit-issue Inline assembly should be heavily commented
  69 |  assembly {
  70 |      revert(0, 0)
  71 |  }
```
GitHub: [69-71](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/MsgValueSimulator.sol#L69-L71)


```solidity
File: code/system-contracts/contracts/libraries/EfficientCall.sol

     |  // @audit-issue Inline assembly should be heavily commented
 135 |  assembly {
 136 |      success := call(_address, callAddr, 0, 0, 0xFFFF, 0, 0)
 137 |  }

     |  // @audit-issue Inline assembly should be heavily commented
 148 |  assembly {
 149 |      success := call(msgValueSimulator, callAddr, _value, _address, 0xFFFF, forwardMask, 0)
 150 |  }

     |  // @audit-issue Inline assembly should be heavily commented
 163 |  assembly {
 164 |      success := staticcall(_address, callAddr, 0, 0xFFFF, 0, 0)
 165 |  }

     |  // @audit-issue Inline assembly should be heavily commented
 177 |  assembly {
 178 |      success := delegatecall(_address, callAddr, 0, 0xFFFF, 0, 0)
 179 |  }

     |  // @audit-issue Inline assembly should be heavily commented
 218 |  assembly {
 219 |      size := returndatasize()
 220 |  }

     |  // @audit-issue Inline assembly should be heavily commented
 223 |  assembly {
 224 |      returndatacopy(add(returnData, 0x20), 0, size)
 225 |  }

     |  // @audit-issue Inline assembly should be heavily commented
 233 |  assembly {
 234 |      let size := returndatasize()
 235 |      returndatacopy(0, 0, size)
 236 |      revert(0, size)
 237 |  }

     |  // @audit-issue Inline assembly should be heavily commented
 254 |  assembly {
 255 |      dataOffset := _data.offset
 256 |  }
```
GitHub: [135-137](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L135-L137), [148-150](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L148-L150), [163-165](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L163-L165), [177-179](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L177-L179), [218-220](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L218-L220), [223-225](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L223-L225), [233-237](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L233-L237), [254-256](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L254-L256)


```solidity
File: code/system-contracts/contracts/libraries/RLPEncoder.sol

     |  // @audit-issue Inline assembly should be heavily commented
  39 |  assembly {
  40 |      mstore(add(encoded, 0x21), shiftedVal)
  41 |  }

     |  // @audit-issue Inline assembly should be heavily commented
  74 |  assembly {
  75 |      mstore(add(encoded, 0x21), shiftedVal)
  76 |  }
```
GitHub: [39-41](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/RLPEncoder.sol#L39-L41), [74-76](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/RLPEncoder.sol#L74-L76)


```solidity
File: code/system-contracts/contracts/libraries/SystemContractHelper.sol

     |  // @audit-issue Inline assembly should be heavily commented
  65 |  assembly {
  66 |      addr := staticcall(0, callAddr, 0, 0xFFFF, 0, 0)
  67 |  }

     |  // @audit-issue Inline assembly should be heavily commented
  76 |  assembly {
  77 |      pop(staticcall(0, callAddr, 0, 0xFFFF, 0, 0))
  78 |  }

     |  // @audit-issue Inline assembly should be heavily commented
  87 |  assembly {
  88 |      pop(staticcall(_farCallAbi, callAddr, 0, 0xFFFF, 0, 0))
  89 |  }

     |  // @audit-issue Inline assembly should be heavily commented
 183 |  assembly {
 184 |      pop(call(initializer, callAddr, value1, 0, 0xFFFF, 0, 0))
 185 |  }

     |  // @audit-issue Inline assembly should be heavily commented
 193 |  assembly {
 194 |      pop(call(value1, callAddr, value2, 0, 0xFFFF, 0, 0))
 195 |  }

     |  // @audit-issue Inline assembly should be heavily commented
 205 |  assembly {
 206 |      meta := staticcall(0, callAddr, 0, 0xFFFF, 0, 0)
 207 |  }

     |  // @audit-issue Inline assembly should be heavily commented
 298 |  assembly {
 299 |      callFlags := staticcall(0, callAddr, 0, 0xFFFF, 0, 0)
 300 |  }

     |  // @audit-issue Inline assembly should be heavily commented
 309 |  assembly {
 310 |      ptr := staticcall(0, callAddr, 0, 0xFFFF, 0, 0)
 311 |  }

     |  // @audit-issue Inline assembly should be heavily commented
 322 |  assembly {
 323 |      extraAbiData := staticcall(index, callAddr, 0, 0xFFFF, 0, 0)
 324 |  }
```
GitHub: [65-67](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L65-L67), [76-78](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L76-L78), [87-89](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L87-L89), [183-185](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L183-L185), [193-195](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L193-L195), [205-207](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L205-L207), [298-300](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L298-L300), [309-311](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L309-L311), [322-324](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L322-L324)


```solidity
File: code/system-contracts/contracts/libraries/SystemContractsCaller.sol

     |  // @audit-issue Inline assembly should be heavily commented
  80 |  assembly {
  81 |      dataStart := add(data, 0x20)
  82 |  }

     |  // @audit-issue Inline assembly should be heavily commented
 100 |  assembly {
 101 |      success := call(to, callAddr, 0, 0, farCallAbi, 0, 0)
 102 |  }

     |  // @audit-issue Inline assembly should be heavily commented
 109 |  assembly {
 110 |      success := call(msgValueSimulator, callAddr, value, to, farCallAbi, forwardMask, 0)
 111 |  }

     |  // @audit-issue Inline assembly should be heavily commented
 132 |  assembly {
 133 |      size := returndatasize()
 134 |  }

     |  // @audit-issue Inline assembly should be heavily commented
 137 |  assembly {
 138 |      returndatacopy(add(returnData, 0x20), 0, size)
 139 |  }

     |  // @audit-issue Inline assembly should be heavily commented
 160 |  assembly {
 161 |      let size := mload(returnData)
 162 |      revert(add(returnData, 0x20), size)
 163 |  }
```
GitHub: [80-82](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L80-L82), [100-102](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L100-L102), [109-111](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L109-L111), [132-134](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L132-L134), [137-139](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L137-L139), [160-163](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L160-L163)


```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

     |  // @audit-issue Inline assembly should be heavily commented
 399 |  assembly {
 400 |      success := call(gas(), bootloaderAddr, amount, 0, 0, 0, 0)
 401 |  }
```
GitHub: [399-401](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L399-L401)


```solidity
File: code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol

     |  // @audit-issue Inline assembly should be heavily commented
  20 |  assembly {
  21 |      let offset := sub(_bytes.offset, 30)
  22 |      result := calldataload(add(offset, _start))
  23 |  }

     |  // @audit-issue Inline assembly should be heavily commented
  27 |  assembly {
  28 |      let offset := sub(_bytes.offset, 28)
  29 |      result := calldataload(add(offset, _start))
  30 |  }

     |  // @audit-issue Inline assembly should be heavily commented
  34 |  assembly {
  35 |      let offset := sub(_bytes.offset, 24)
  36 |      result := calldataload(add(offset, _start))
  37 |  }

     |  // @audit-issue Inline assembly should be heavily commented
  41 |  assembly {
  42 |      result := calldataload(add(_bytes.offset, _start))
  43 |  }

     |  // @audit-issue Inline assembly should be heavily commented
  47 |  assembly {
  48 |      result := calldataload(add(_bytes.offset, _start))
  49 |  }
```
GitHub: [20-23](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol#L20-L23), [27-30](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol#L27-L30), [34-37](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol#L34-L37), [41-43](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol#L41-L43), [47-49](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol#L47-L49)


```solidity
File: code/contracts/zksync/contracts/SystemContractsCaller.sol

     |  // @audit-issue Inline assembly should be heavily commented
  41 |  assembly {
  42 |      dataStart := add(data, 0x20)
  43 |  }

     |  // @audit-issue Inline assembly should be heavily commented
  61 |  assembly {
  62 |      success := call(to, callAddr, 0, 0, farCallAbi, 0, 0)
  63 |  }

     |  // @audit-issue Inline assembly should be heavily commented
  70 |  assembly {
  71 |      success := call(msgValueSimulator, callAddr, value, to, farCallAbi, forwardMask, 0)
  72 |  }

     |  // @audit-issue Inline assembly should be heavily commented
  85 |  assembly {
  86 |      size := returndatasize()
  87 |  }

     |  // @audit-issue Inline assembly should be heavily commented
  90 |  assembly {
  91 |      returndatacopy(add(returnData, 0x20), 0, size)
  92 |  }
```
GitHub: [41-43](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/SystemContractsCaller.sol#L41-L43), [61-63](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/SystemContractsCaller.sol#L61-L63), [70-72](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/SystemContractsCaller.sol#L70-L72), [85-87](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/SystemContractsCaller.sol#L85-L87), [90-92](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/SystemContractsCaller.sol#L90-L92)


```solidity
File: code/contracts/zksync/contracts/TestnetPaymaster.sol

     |  // @audit-issue Inline assembly should be heavily commented
  56 |  assembly {
  57 |      revert(add(0x20, revertReason), mload(revertReason))
  58 |  }
```
GitHub: [56-58](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/TestnetPaymaster.sol#L56-L58)


## [N-04] Avoid extraneous whitespace

See the [Solidity style guide](https://docs.soliditylang.org/en/v0.8.16/style-guide.html#whitespace-in-expressions) for more details.

*Instances: 11*

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

     |  // @audit-issue Whitespace before parenthesis
 144 |  (address logSender, ) = UnsafeBytes.readAddress(emittedL2Logs, i + L2_LOG_ADDRESS_OFFSET);

     |  // @audit-issue Whitespace before parenthesis
 145 |  (uint256 logKey, ) = UnsafeBytes.readUint256(emittedL2Logs, i + L2_LOG_KEY_OFFSET);

     |  // @audit-issue Whitespace before parenthesis
 146 |  (bytes32 logValue, ) = UnsafeBytes.readBytes32(emittedL2Logs, i + L2_LOG_VALUE_OFFSET);
```
GitHub: [144](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L144), [145](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L145), [146](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L146)


```solidity
File: code/contracts/ethereum/contracts/state-transition/Verifier.sol

     |  // @audit-issue Whitespace before parenthesis
1277 |  ///                (a(z)*c(z) - d(z)) * alpha^2 )                               /
```
GitHub: [1277](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L1277)


```solidity
File: code/system-contracts/contracts/MsgValueSimulator.sol

     |  // @audit-issue Whitespace before parenthesis
  63 |  (bool success, ) = address(REAL_BASE_TOKEN_SYSTEM_CONTRACT).call(
```
GitHub: [63](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/MsgValueSimulator.sol#L63)


```solidity
File: code/system-contracts/contracts/NonceHolder.sol

     |  // @audit-issue Whitespace before parenthesis
 127 |  (deploymentNonce, ) = _splitRawNonce(rawNonces[addressAsKey]);

     |  // @audit-issue Whitespace before parenthesis
 147 |  (prevDeploymentNonce, ) = _splitRawNonce(oldRawNonce);
```
GitHub: [127](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/NonceHolder.sol#L127), [147](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/NonceHolder.sol#L147)


```solidity
File: code/contracts/zksync/contracts/TestnetPaymaster.sol

     |  // @audit-issue Whitespace before parenthesis
  29 |  (address token, uint256 amount, ) = abi.decode(_transaction.paymasterInput[4:], (address, uint256, bytes));

     |  // @audit-issue Whitespace before parenthesis
  63 |  (bool success, ) = payable(BOOTLOADER_ADDRESS).call{value: requiredETH}("");
```
GitHub: [29](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/TestnetPaymaster.sol#L29), [63](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/TestnetPaymaster.sol#L63)


```solidity
File: code/contracts/zksync/contracts/bridge/L2WrappedBaseToken.sol

     |  // @audit-issue Whitespace before parenthesis
  83 |  (bool success, ) = msg.sender.call{value: _amount}("");

     |  // @audit-issue Whitespace before parenthesis
 108 |  (bool success, ) = _to.call{value: _amount}("");
```
GitHub: [83](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2WrappedBaseToken.sol#L83), [108](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2WrappedBaseToken.sol#L108)


## [N-05] Complex arithmetic expression

To maintain readability in code, particularly in Solidity which can involve complex mathematical operations, it is often recommended to limit the number of arithmetic operations to a maximum of 2-3 per line. Too many operations in a single line can make the code difficult to read and understand, increase the likelihood of mistakes, and complicate the process of debugging and reviewing the code. Consider splitting such operations over more than one line, take special care when dealing with division however. Try to limit the number of arithmetic operations to a maximum of 3 per statement.

*Instances: 6*

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

     |  // @audit-issue Simplify by using intermediate variables
 172 |  uint256 minL2GasPriceBaseToken = (fullPubdataPriceBaseToken + _gasPerPubdata - 1) / _gasPerPubdata;
```
GitHub: [172](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L172)


```solidity
File: code/system-contracts/contracts/L1Messenger.sol

     |  // @audit-issue Simplify by using intermediate variables
  51 |  return KECCAK_ROUND_GAS_COST * (_length / KECCAK_ROUND_NUMBER_OF_BYTES + 1);

     |  // @audit-issue Simplify by using intermediate variables
  62 |  return SHA256_ROUND_GAS_COST * ((_length + 8) / SHA256_ROUND_NUMBER_OF_BYTES + 1);

     |  // @audit-issue Simplify by using intermediate variables
 148 |  uint256 gasToPay = keccakGasCost(L2_TO_L1_LOG_SERIALIZE_SIZE) +
 149 |      3 *
 150 |      keccakGasCost(64) +
 151 |      gasSpentOnMessageHashing +
 152 |      COMPUTATIONAL_PRICE_FOR_PUBDATA *
 153 |      pubdataLen;

     |  // @audit-issue Simplify by using intermediate variables
 175 |  uint256 gasToPay = sha256GasCost(bytecodeLen) +
 176 |      keccakGasCost(64) +
 177 |      COMPUTATIONAL_PRICE_FOR_PUBDATA *
 178 |      pubdataLen;

     |  // @audit-issue Simplify by using intermediate variables
 225 |  l2ToL1LogsTreeArray[i] = keccak256(
 226 |      abi.encode(l2ToL1LogsTreeArray[2 * i], l2ToL1LogsTreeArray[2 * i + 1])
 227 |  );
```
GitHub: [51](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L51), [62](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L62), [148-153](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L148-L153), [175-178](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L175-L178), [225-227](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L225-L227)


## [N-06] Complex casting

Consider whether the number of casts is really necessary, or whether using a different type would be more appropriate. Alternatively, add comments to explain in detail why the casts are necessary, and any implicit reasons why the cast does not introduce an overflow.

*Instances: 16*

```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

     |  // @audit-issue Reconsider complex casting
  77 |  bytes32 salt = bytes32(uint256(uint160(_l1Token)));
```
GitHub: [77](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L77)


```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

     |  // @audit-issue Reconsider complex casting
 272 |  bytes32(uint256(uint160(_sharedBridge))),

     |  // @audit-issue Reconsider complex casting
 271 |  bytes32(uint256(uint160(_baseToken))),

     |  // @audit-issue Reconsider complex casting
 270 |  bytes32(uint256(uint160(validatorTimelock))),

     |  // @audit-issue Reconsider complex casting
 269 |  bytes32(uint256(uint160(_admin))),

     |  // @audit-issue Reconsider complex casting
 267 |  bytes32(uint256(uint160(address(this)))),

     |  // @audit-issue Reconsider complex casting
 267 |  bytes32(uint256(uint160(address(this)))),

     |  // @audit-issue Reconsider complex casting
 266 |  bytes32(uint256(uint160(bridgehub))),
```
GitHub: [272](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L272), [271](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L271), [270](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L270), [269](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L269), [267](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L267), [267](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L267), [266](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L266)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

     |  // @audit-issue Reconsider complex casting
 643 |  bytes32 openingPoint = bytes32(
 644 |      uint256(uint128(bytes16(_pubdataCommitments[i:i + PUBDATA_COMMITMENT_CLAIMED_VALUE_OFFSET])))
 645 |  );

     |  // @audit-issue Reconsider complex casting
 643 |  bytes32 openingPoint = bytes32(
 644 |      uint256(uint128(bytes16(_pubdataCommitments[i:i + PUBDATA_COMMITMENT_CLAIMED_VALUE_OFFSET])))
 645 |  );
```
GitHub: [643-645](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L643-L645), [643-645](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L643-L645)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

     |  // @audit-issue Reconsider complex casting
 137 |  key: bytes32(uint256(uint160(_message.sender))),
```
GitHub: [137](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L137)


```solidity
File: code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol

     |  // @audit-issue Reconsider complex casting
  66 |  bytes32 senderBytes = bytes32(uint256(uint160(_sender)));
```
GitHub: [66](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L66)


```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

     |  // @audit-issue Reconsider complex casting
 122 |  bytes.concat(CREATE_PREFIX, bytes32(uint256(uint160(_sender))), bytes32(_senderNonce))

     |  // @audit-issue Reconsider complex casting
 106 |  bytes.concat(CREATE2_PREFIX, bytes32(uint256(uint160(_sender))), _salt, _bytecodeHash, constructorInputHash)
```
GitHub: [122](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L122), [106](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L106)


```solidity
File: code/system-contracts/contracts/L1Messenger.sol

     |  // @audit-issue Reconsider complex casting
 280 |  uint256(uint8(bytes1(_totalL2ToL1PubdataAndStateDiffs[calldataPtr]))) ==

     |  // @audit-issue Reconsider complex casting
 130 |  key: bytes32(uint256(uint160(msg.sender))),
```
GitHub: [280](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L280), [130](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L130)


## [N-07] Consider adding a block/deny-list

Doing so will significantly increase centralization, but will help to prevent hackers from using stolen tokens.

*Instances: 7*

```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

     |  // @audit-issue Consider adding a block/deny-list
  19 |  contract L1ERC20Bridge is IL1ERC20Bridge, ReentrancyGuard {
```
GitHub: [19](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L19)


```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

     |  // @audit-issue Consider adding a block/deny-list
  20 |  contract Governance is IGovernance, Ownable2Step {
```
GitHub: [20](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L20)


```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

     |  // @audit-issue Consider adding a block/deny-list
  27 |  contract StateTransitionManager is IStateTransitionManager, ReentrancyGuard, Ownable2Step {
```
GitHub: [27](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L27)


```solidity
File: code/system-contracts/contracts/AccountCodeStorage.sol

     |  // @audit-issue Consider adding a block/deny-list
  22 |  contract AccountCodeStorage is IAccountCodeStorage {
```
GitHub: [22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L22)


```solidity
File: code/system-contracts/contracts/DefaultAccount.sol

     |  // @audit-issue Consider adding a block/deny-list
  19 |  contract DefaultAccount is IAccount {
```
GitHub: [19](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L19)


```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

     |  // @audit-issue Consider adding a block/deny-list
  15 |  contract L2StandardERC20 is ERC20PermitUpgradeable, IL2StandardToken, ERC1967Upgrade {
```
GitHub: [15](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L15)


```solidity
File: code/contracts/zksync/contracts/bridge/L2WrappedBaseToken.sol

     |  // @audit-issue Consider adding a block/deny-list
  23 |  contract L2WrappedBaseToken is ERC20PermitUpgradeable, IL2WrappedBaseToken, IL2StandardToken {
```
GitHub: [23](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2WrappedBaseToken.sol#L23)


## [N-08] Consider adding emergency-stop functionality

Adding a way to quickly halt protocol functionality in an emergency, rather than having to pause individual contracts one-by-one, will make in-progress hack mitigation faster and much less stressful.

*Instances: 7*

```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

     |  // @audit-issue Consider adding emergency-stop functionality
  20 |  contract Governance is IGovernance, Ownable2Step {
```
GitHub: [20](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L20)


```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

     |  // @audit-issue Consider adding emergency-stop functionality
  27 |  contract StateTransitionManager is IStateTransitionManager, ReentrancyGuard, Ownable2Step {
```
GitHub: [27](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L27)


```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

     |  // @audit-issue Consider adding emergency-stop functionality
  22 |  contract ValidatorTimelock is IExecutor, Ownable2Step {
```
GitHub: [22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L22)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol

     |  // @audit-issue Consider adding emergency-stop functionality
  10 |  contract DiamondProxy {
```
GitHub: [10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol#L10)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol

     |  // @audit-issue Consider adding emergency-stop functionality
  18 |  contract AdminFacet is ZkSyncStateTransitionBase, IAdmin {
```
GitHub: [18](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L18)


```solidity
File: code/system-contracts/contracts/AccountCodeStorage.sol

     |  // @audit-issue Consider adding emergency-stop functionality
  22 |  contract AccountCodeStorage is IAccountCodeStorage {
```
GitHub: [22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L22)


```solidity
File: code/system-contracts/contracts/DefaultAccount.sol

     |  // @audit-issue Consider adding emergency-stop functionality
  19 |  contract DefaultAccount is IAccount {
```
GitHub: [19](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L19)


## [N-09] Consider adding formal verification proofs

Consider using formal verification to mathematically prove that your code does what is intended, and does not have any edge cases with unexpected behavior. The solidity compiler itself has this functionality [built in](https://docs.soliditylang.org/en/latest/smtchecker.html#smtchecker-and-formal-verification).            
            

*Instances: 99*

```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

     |  // @audit-issue SMT checker was not detected as enabled for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

     |  // @audit-issue SMT checker was not detected as enabled for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

     |  // @audit-issue SMT checker was not detected as enabled for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

     |  // @audit-issue SMT checker was not detected as enabled for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

     |  // @audit-issue SMT checker was not detected as enabled for this file
   1 |  pragma solidity 0.8.20;
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

     |  // @audit-issue SMT checker was not detected as enabled for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol

     |  // @audit-issue SMT checker was not detected as enabled for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol

     |  // @audit-issue SMT checker was not detected as enabled for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol

     |  // @audit-issue SMT checker was not detected as enabled for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol

     |  // @audit-issue SMT checker was not detected as enabled for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

     |  // @audit-issue SMT checker was not detected as enabled for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol

     |  // @audit-issue SMT checker was not detected as enabled for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

     |  // @audit-issue SMT checker was not detected as enabled for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol

     |  // @audit-issue SMT checker was not detected as enabled for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol

     |  // @audit-issue SMT checker was not detected as enabled for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol

     |  // @audit-issue SMT checker was not detected as enabled for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/upgrades/DefaultUpgrade.sol

     |  // @audit-issue SMT checker was not detected as enabled for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/DefaultUpgrade.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/upgrades/GenesisUpgrade.sol

     |  // @audit-issue SMT checker was not detected as enabled for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/GenesisUpgrade.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol

     |  // @audit-issue SMT checker was not detected as enabled for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/common/libraries/UncheckedMath.sol

     |  // @audit-issue SMT checker was not detected as enabled for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/UncheckedMath.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol

     |  // @audit-issue SMT checker was not detected as enabled for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol

     |  // @audit-issue SMT checker was not detected as enabled for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/LibMap.sol

     |  // @audit-issue SMT checker was not detected as enabled for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/LibMap.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol

     |  // @audit-issue SMT checker was not detected as enabled for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol

     |  // @audit-issue SMT checker was not detected as enabled for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol

     |  // @audit-issue SMT checker was not detected as enabled for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol

     |  // @audit-issue SMT checker was not detected as enabled for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol

     |  // @audit-issue SMT checker was not detected as enabled for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL2Bridge.sol

     |  // @audit-issue SMT checker was not detected as enabled for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL2Bridge.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IWETH9.sol

     |  // @audit-issue SMT checker was not detected as enabled for this file
   1 |  // SPDX-License-Identifier: Apache-2.0
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IWETH9.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol

     |  // @audit-issue SMT checker was not detected as enabled for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/common/interfaces/IL2ContractDeployer.sol

     |  // @audit-issue SMT checker was not detected as enabled for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/interfaces/IL2ContractDeployer.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/governance/IGovernance.sol

     |  // @audit-issue SMT checker was not detected as enabled for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol

     |  // @audit-issue SMT checker was not detected as enabled for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol

     |  // @audit-issue SMT checker was not detected as enabled for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol

     |  // @audit-issue SMT checker was not detected as enabled for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol

     |  // @audit-issue SMT checker was not detected as enabled for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol

     |  // @audit-issue SMT checker was not detected as enabled for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/ILegacyGetters.sol

     |  // @audit-issue SMT checker was not detected as enabled for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/ILegacyGetters.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol

     |  // @audit-issue SMT checker was not detected as enabled for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IVerifier.sol

     |  // @audit-issue SMT checker was not detected as enabled for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IVerifier.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol

     |  // @audit-issue SMT checker was not detected as enabled for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransitionBase.sol

     |  // @audit-issue SMT checker was not detected as enabled for this file
   1 |  // SPDX-License-Identifier: UNLICENSED
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransitionBase.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/upgrades/IDefaultUpgrade.sol

     |  // @audit-issue SMT checker was not detected as enabled for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/IDefaultUpgrade.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/common/Config.sol

     |  // @audit-issue SMT checker was not detected as enabled for this file
   1 |  pragma solidity 0.8.20;
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/Config.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/common/L2ContractAddresses.sol

     |  // @audit-issue SMT checker was not detected as enabled for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/L2ContractAddresses.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/common/Messaging.sol

     |  // @audit-issue SMT checker was not detected as enabled for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/Messaging.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/common/ReentrancyGuard.sol

     |  // @audit-issue SMT checker was not detected as enabled for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/ReentrancyGuard.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol

     |  // @audit-issue SMT checker was not detected as enabled for this file
   1 |  // SPDX-License-Identifier: Apache-2.0
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/Verifier.sol

     |  // @audit-issue SMT checker was not detected as enabled for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/upgrades/Upgrade_4844.sol

     |  // @audit-issue SMT checker was not detected as enabled for this file
   1 |  pragma solidity 0.8.20;
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/Upgrade_4844.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/upgrades/Upgrade_v1_4_1.sol

     |  // @audit-issue SMT checker was not detected as enabled for this file
   1 |  pragma solidity 0.8.20;
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/Upgrade_v1_4_1.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/common/Dependencies.sol

     |  // @audit-issue SMT checker was not detected as enabled for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/Dependencies.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/l2-deps/ISystemContext.sol

     |  // @audit-issue SMT checker was not detected as enabled for this file
   1 |  // SPDX-License-Identifier: UNLICENSED
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/l2-deps/ISystemContext.sol#L1)


```solidity
File: code/system-contracts/contracts/AccountCodeStorage.sol

     |  // @audit-issue SMT checker was not detected as enabled for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L1)


```solidity
File: code/system-contracts/contracts/BootloaderUtilities.sol

     |  // @audit-issue SMT checker was not detected as enabled for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L1)


```solidity
File: code/system-contracts/contracts/ComplexUpgrader.sol

     |  // @audit-issue SMT checker was not detected as enabled for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ComplexUpgrader.sol#L1)


```solidity
File: code/system-contracts/contracts/Compressor.sol

     |  // @audit-issue SMT checker was not detected as enabled for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L1)


```solidity
File: code/system-contracts/contracts/Constants.sol

     |  // @audit-issue SMT checker was not detected as enabled for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Constants.sol#L1)


```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

     |  // @audit-issue SMT checker was not detected as enabled for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L1)


```solidity
File: code/system-contracts/contracts/DefaultAccount.sol

     |  // @audit-issue SMT checker was not detected as enabled for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L1)


```solidity
File: code/system-contracts/contracts/EmptyContract.sol

     |  // @audit-issue SMT checker was not detected as enabled for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/EmptyContract.sol#L1)


```solidity
File: code/system-contracts/contracts/ImmutableSimulator.sol

     |  // @audit-issue SMT checker was not detected as enabled for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ImmutableSimulator.sol#L1)


```solidity
File: code/system-contracts/contracts/KnownCodesStorage.sol

     |  // @audit-issue SMT checker was not detected as enabled for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/KnownCodesStorage.sol#L1)


```solidity
File: code/system-contracts/contracts/L1Messenger.sol

     |  // @audit-issue SMT checker was not detected as enabled for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L1)


```solidity
File: code/system-contracts/contracts/L2BaseToken.sol

     |  // @audit-issue SMT checker was not detected as enabled for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L2BaseToken.sol#L1)


```solidity
File: code/system-contracts/contracts/MsgValueSimulator.sol

     |  // @audit-issue SMT checker was not detected as enabled for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/MsgValueSimulator.sol#L1)


```solidity
File: code/system-contracts/contracts/NonceHolder.sol

     |  // @audit-issue SMT checker was not detected as enabled for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/NonceHolder.sol#L1)


```solidity
File: code/system-contracts/contracts/PubdataChunkPublisher.sol

     |  // @audit-issue SMT checker was not detected as enabled for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/PubdataChunkPublisher.sol#L1)


```solidity
File: code/system-contracts/contracts/SystemContext.sol

     |  // @audit-issue SMT checker was not detected as enabled for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L1)


```solidity
File: code/system-contracts/contracts/GasBoundCaller.sol

     |  // @audit-issue SMT checker was not detected as enabled for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/GasBoundCaller.sol#L1)


```solidity
File: code/system-contracts/contracts/libraries/EfficientCall.sol

     |  // @audit-issue SMT checker was not detected as enabled for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L1)


```solidity
File: code/system-contracts/contracts/libraries/RLPEncoder.sol

     |  // @audit-issue SMT checker was not detected as enabled for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/RLPEncoder.sol#L1)


```solidity
File: code/system-contracts/contracts/libraries/SystemContractHelper.sol

     |  // @audit-issue SMT checker was not detected as enabled for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L1)


```solidity
File: code/system-contracts/contracts/libraries/SystemContractsCaller.sol

     |  // @audit-issue SMT checker was not detected as enabled for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L1)


```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

     |  // @audit-issue SMT checker was not detected as enabled for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L1)


```solidity
File: code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol

     |  // @audit-issue SMT checker was not detected as enabled for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol#L1)


```solidity
File: code/system-contracts/contracts/libraries/Utils.sol

     |  // @audit-issue SMT checker was not detected as enabled for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L1)


```solidity
File: code/system-contracts/contracts/interfaces/IAccount.sol

     |  // @audit-issue SMT checker was not detected as enabled for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IAccount.sol#L1)


```solidity
File: code/system-contracts/contracts/interfaces/IAccountCodeStorage.sol

     |  // @audit-issue SMT checker was not detected as enabled for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IAccountCodeStorage.sol#L1)


```solidity
File: code/system-contracts/contracts/interfaces/IBaseToken.sol

     |  // @audit-issue SMT checker was not detected as enabled for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBaseToken.sol#L1)


```solidity
File: code/system-contracts/contracts/interfaces/IBootloaderUtilities.sol

     |  // @audit-issue SMT checker was not detected as enabled for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBootloaderUtilities.sol#L1)


```solidity
File: code/system-contracts/contracts/interfaces/IComplexUpgrader.sol

     |  // @audit-issue SMT checker was not detected as enabled for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IComplexUpgrader.sol#L1)


```solidity
File: code/system-contracts/contracts/interfaces/ICompressor.sol

     |  // @audit-issue SMT checker was not detected as enabled for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ICompressor.sol#L1)


```solidity
File: code/system-contracts/contracts/interfaces/IContractDeployer.sol

     |  // @audit-issue SMT checker was not detected as enabled for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L1)


```solidity
File: code/system-contracts/contracts/interfaces/IImmutableSimulator.sol

     |  // @audit-issue SMT checker was not detected as enabled for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IImmutableSimulator.sol#L1)


```solidity
File: code/system-contracts/contracts/interfaces/IKnownCodesStorage.sol

     |  // @audit-issue SMT checker was not detected as enabled for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IKnownCodesStorage.sol#L1)


```solidity
File: code/system-contracts/contracts/interfaces/IL1Messenger.sol

     |  // @audit-issue SMT checker was not detected as enabled for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL1Messenger.sol#L1)


```solidity
File: code/system-contracts/contracts/interfaces/IL2StandardToken.sol

     |  // @audit-issue SMT checker was not detected as enabled for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL2StandardToken.sol#L1)


```solidity
File: code/system-contracts/contracts/interfaces/IMailbox.sol

     |  // @audit-issue SMT checker was not detected as enabled for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IMailbox.sol#L1)


```solidity
File: code/system-contracts/contracts/interfaces/INonceHolder.sol

     |  // @audit-issue SMT checker was not detected as enabled for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/INonceHolder.sol#L1)


```solidity
File: code/system-contracts/contracts/interfaces/IPaymaster.sol

     |  // @audit-issue SMT checker was not detected as enabled for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IPaymaster.sol#L1)


```solidity
File: code/system-contracts/contracts/interfaces/IPaymasterFlow.sol

     |  // @audit-issue SMT checker was not detected as enabled for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IPaymasterFlow.sol#L1)


```solidity
File: code/system-contracts/contracts/interfaces/IPubdataChunkPublisher.sol

     |  // @audit-issue SMT checker was not detected as enabled for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IPubdataChunkPublisher.sol#L1)


```solidity
File: code/system-contracts/contracts/interfaces/ISystemContext.sol

     |  // @audit-issue SMT checker was not detected as enabled for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L1)


```solidity
File: code/system-contracts/contracts/interfaces/ISystemContextDeprecated.sol

     |  // @audit-issue SMT checker was not detected as enabled for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContextDeprecated.sol#L1)


```solidity
File: code/system-contracts/contracts/interfaces/ISystemContract.sol

     |  // @audit-issue SMT checker was not detected as enabled for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContract.sol#L1)


```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

     |  // @audit-issue SMT checker was not detected as enabled for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L1)


```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

     |  // @audit-issue SMT checker was not detected as enabled for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L1)


## [N-10] Consider adding validation of user inputs

There are no validations done on the arguments below. Consider that the Solidity [documentation](https://docs.soliditylang.org/en/latest/control-structures.html#panic-via-assert-and-error-via-require) states that `Properly functioning code should never create a Panic, not even on invalid external input. If this happens, then there is a bug in your contract which you should fix`. This means that there should be explicit checks for expected ranges of inputs. Underflows/overflows result in panics should not be used as range checks, and allowing funds to be sent to  `0x0`, which is the default value of address variables and has many gotchas, should be avoided.

*Instances: 99*

```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

     |  // @audit-issue Validate `_token`
  63 |  function tranferTokenToSharedBridge(address _token, uint256 _amount) external {

     |  // @audit-issue Validate `_l1Token`
  75 |  function l2TokenAddress(address _l1Token) external view returns (address) {

     |  // @audit-issue Validate `_l2Receiver`
     |  // Validate `_l1Token`
     |  // Validate `_amount`
     |  // Validate `_l2TxGasLimit`
     |  // Validate `_l2TxGasPerPubdataByte`
  98 |  function deposit(
  99 |      address _l2Receiver,
 100 |      address _l1Token,
 101 |      uint256 _amount,
 102 |      uint256 _l2TxGasLimit,
 103 |      uint256 _l2TxGasPerPubdataByte
 104 |  ) external payable returns (bytes32 l2TxHash) {

     |  // @audit-issue Validate `_l2Receiver`
     |  // Validate `_l1Token`
     |  // Validate `_l2TxGasLimit`
     |  // Validate `_l2TxGasPerPubdataByte`
     |  // Validate `_refundRecipient`
 133 |  function deposit(
 134 |      address _l2Receiver,
 135 |      address _l1Token,
 136 |      uint256 _amount,
 137 |      uint256 _l2TxGasLimit,
 138 |      uint256 _l2TxGasPerPubdataByte,
 139 |      address _refundRecipient
 140 |  ) public payable nonReentrant returns (bytes32 l2TxHash) {

     |  // @audit-issue Validate `_depositSender`
     |  // Validate `_l1Token`
     |  // Validate `_l2TxHash`
     |  // Validate `_l2BatchNumber`
     |  // Validate `_l2MessageIndex`
     |  // Validate `_l2TxNumberInBatch`
     |  // Validate `_merkleProof`
 176 |  function claimFailedDeposit(
 177 |      address _depositSender,
 178 |      address _l1Token,
 179 |      bytes32 _l2TxHash,
 180 |      uint256 _l2BatchNumber,
 181 |      uint256 _l2MessageIndex,
 182 |      uint16 _l2TxNumberInBatch,
 183 |      bytes32[] calldata _merkleProof
 184 |  ) external nonReentrant {

     |  // @audit-issue Validate `_l2BatchNumber`
     |  // Validate `_l2MessageIndex`
     |  // Validate `_l2TxNumberInBatch`
     |  // Validate `_message`
     |  // Validate `_merkleProof`
 208 |  function finalizeWithdrawal(
 209 |      uint256 _l2BatchNumber,
 210 |      uint256 _l2MessageIndex,
 211 |      uint16 _l2TxNumberInBatch,
 212 |      bytes calldata _message,
 213 |      bytes32[] calldata _merkleProof
 214 |  ) external nonReentrant {
```
GitHub: [63](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L63), [75](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L75), [98-104](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L98-L104), [133-140](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L133-L140), [176-184](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L176-L184), [208-214](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L208-L214)


```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

     |  // @audit-issue Validate `_chainId`
     |  // Validate `_prevMsgSender`
 148 |  function bridgehubDepositBaseToken(
 149 |      uint256 _chainId,
 150 |      address _prevMsgSender,
 151 |      address _l1Token,
 152 |      uint256 _amount
 153 |  ) external payable virtual onlyBridgehubOrEra(_chainId) {

     |  // @audit-issue Validate `_prevMsgSender`
     |  // Validate ``
     |  // Validate `_data`
 182 |  function bridgehubDeposit(
 183 |      uint256 _chainId,
 184 |      address _prevMsgSender,
 185 |      uint256, // l2Value, needed for Weth deposits in the future
 186 |      bytes calldata _data
 187 |  ) external payable override onlyBridgehub returns (L2TransactionRequestTwoBridgesInner memory request) {

     |  // @audit-issue Validate `_txDataHash`
 232 |  function bridgehubConfirmL2Transaction(
 233 |      uint256 _chainId,
 234 |      bytes32 _txDataHash,
 235 |      bytes32 _txHash
 236 |  ) external override onlyBridgehub {

     |  // @audit-issue Validate `_chainId`
     |  // Validate `_depositSender`
     |  // Validate `_l1Token`
     |  // Validate `_amount`
     |  // Validate `_l2TxHash`
     |  // Validate `_l2BatchNumber`
     |  // Validate `_l2MessageIndex`
     |  // Validate `_l2TxNumberInBatch`
     |  // Validate `_merkleProof`
 277 |  function claimFailedDeposit(
 278 |      uint256 _chainId,
 279 |      address _depositSender,
 280 |      address _l1Token,
 281 |      uint256 _amount,
 282 |      bytes32 _l2TxHash,
 283 |      uint256 _l2BatchNumber,
 284 |      uint256 _l2MessageIndex,
 285 |      uint16 _l2TxNumberInBatch,
 286 |      bytes32[] calldata _merkleProof
 287 |  ) external override {

     |  // @audit-issue Validate `_chainId`
     |  // Validate `_l2BatchNumber`
     |  // Validate `_l2MessageIndex`
     |  // Validate `_l2TxNumberInBatch`
     |  // Validate `_message`
     |  // Validate `_merkleProof`
 385 |  function finalizeWithdrawal(
 386 |      uint256 _chainId,
 387 |      uint256 _l2BatchNumber,
 388 |      uint256 _l2MessageIndex,
 389 |      uint16 _l2TxNumberInBatch,
 390 |      bytes calldata _message,
 391 |      bytes32[] calldata _merkleProof
 392 |  ) external override {

     |  // @audit-issue Validate `_l2Receiver`
     |  // Validate `_amount`
     |  // Validate `_l2TxGasLimit`
     |  // Validate `_l2TxGasPerPubdataByte`
 554 |  function depositLegacyErc20Bridge(
 555 |      address _prevMsgSender,
 556 |      address _l2Receiver,
 557 |      address _l1Token,
 558 |      uint256 _amount,
 559 |      uint256 _l2TxGasLimit,
 560 |      uint256 _l2TxGasPerPubdataByte,
 561 |      address _refundRecipient
 562 |  ) external payable override onlyLegacyBridge nonReentrant returns (bytes32 l2TxHash) {

     |  // @audit-issue Validate `_l2BatchNumber`
     |  // Validate `_l2MessageIndex`
     |  // Validate `_l2TxNumberInBatch`
     |  // Validate `_message`
     |  // Validate `_merkleProof`
 615 |  function finalizeWithdrawalLegacyErc20Bridge(
 616 |      uint256 _l2BatchNumber,
 617 |      uint256 _l2MessageIndex,
 618 |      uint16 _l2TxNumberInBatch,
 619 |      bytes calldata _message,
 620 |      bytes32[] calldata _merkleProof
 621 |  ) external override onlyLegacyBridge returns (address l1Receiver, address l1Token, uint256 amount) {

     |  // @audit-issue Validate `_depositSender`
     |  // Validate `_l1Token`
     |  // Validate `_amount`
     |  // Validate `_l2TxHash`
     |  // Validate `_l2BatchNumber`
     |  // Validate `_l2MessageIndex`
     |  // Validate `_l2TxNumberInBatch`
     |  // Validate `_merkleProof`
 644 |  function claimFailedDepositLegacyErc20Bridge(
 645 |      address _depositSender,
 646 |      address _l1Token,
 647 |      uint256 _amount,
 648 |      bytes32 _l2TxHash,
 649 |      uint256 _l2BatchNumber,
 650 |      uint256 _l2MessageIndex,
 651 |      uint16 _l2TxNumberInBatch,
 652 |      bytes32[] calldata _merkleProof
 653 |  ) external override onlyLegacyBridge {
```
GitHub: [148-153](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L148-L153), [182-187](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L182-L187), [232-236](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L232-L236), [277-287](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L277-L287), [385-392](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L385-L392), [554-562](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L554-L562), [615-621](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L615-L621), [644-653](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L644-L653)


```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

     |  // @audit-issue Validate `_newPendingAdmin`
  51 |  function setPendingAdmin(address _newPendingAdmin) external onlyOwnerOrAdmin {

     |  // @audit-issue Validate `_chainId`
  75 |  function getStateTransition(uint256 _chainId) public view returns (address) {

     |  // @audit-issue Validate `_stateTransitionManager`
     |  // Validate `_baseToken`
     |  // Validate ``
     |  // Validate `_admin`
     |  // Validate `_initData`
 114 |  function createNewChain(
 115 |      uint256 _chainId,
 116 |      address _stateTransitionManager,
 117 |      address _baseToken,
 118 |      uint256, //_salt
 119 |      address _admin,
 120 |      bytes calldata _initData
 121 |  ) external onlyOwnerOrAdmin nonReentrant returns (uint256 chainId) {

     |  // @audit-issue Validate `_chainId`
     |  // Validate `_batchNumber`
     |  // Validate `_index`
     |  // Validate `_message`
     |  // Validate `_proof`
 152 |  function proveL2MessageInclusion(
 153 |      uint256 _chainId,
 154 |      uint256 _batchNumber,
 155 |      uint256 _index,
 156 |      L2Message calldata _message,
 157 |      bytes32[] calldata _proof
 158 |  ) external view override returns (bool) {

     |  // @audit-issue Validate `_chainId`
     |  // Validate `_batchNumber`
     |  // Validate `_index`
     |  // Validate `_log`
     |  // Validate `_proof`
 164 |  function proveL2LogInclusion(
 165 |      uint256 _chainId,
 166 |      uint256 _batchNumber,
 167 |      uint256 _index,
 168 |      L2Log memory _log,
 169 |      bytes32[] calldata _proof
 170 |  ) external view override returns (bool) {

     |  // @audit-issue Validate `_chainId`
     |  // Validate `_l2TxHash`
     |  // Validate `_l2BatchNumber`
     |  // Validate `_l2MessageIndex`
     |  // Validate `_l2TxNumberInBatch`
     |  // Validate `_merkleProof`
     |  // Validate `_status`
 176 |  function proveL1ToL2TransactionStatus(
 177 |      uint256 _chainId,
 178 |      bytes32 _l2TxHash,
 179 |      uint256 _l2BatchNumber,
 180 |      uint256 _l2MessageIndex,
 181 |      uint16 _l2TxNumberInBatch,
 182 |      bytes32[] calldata _merkleProof,
 183 |      TxStatus _status
 184 |  ) external view override returns (bool) {

     |  // @audit-issue Validate `_chainId`
     |  // Validate `_gasPrice`
     |  // Validate `_l2GasLimit`
     |  // Validate `_l2GasPerPubdataByteLimit`
 198 |  function l2TransactionBaseCost(
 199 |      uint256 _chainId,
 200 |      uint256 _gasPrice,
 201 |      uint256 _l2GasLimit,
 202 |      uint256 _l2GasPerPubdataByteLimit
 203 |  ) external view returns (uint256) {
```
GitHub: [51](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L51), [75](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L75), [114-121](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L114-L121), [152-158](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L152-L158), [164-170](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L164-L170), [176-184](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L176-L184), [198-203](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L198-L203)


```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

     |  // @audit-issue Validate `_id`
  89 |  function isOperationPending(bytes32 _id) public view returns (bool) {

     |  // @audit-issue Validate `_id`
 105 |  function getOperationState(bytes32 _id) public view returns (OperationState) {

     |  // @audit-issue Validate `_operation`
 167 |  function execute(Operation calldata _operation) external payable onlyOwnerOrSecurityCouncil {

     |  // @audit-issue Validate `_operation`
 186 |  function executeInstant(Operation calldata _operation) external payable onlySecurityCouncil {

     |  // @audit-issue Validate `_operation`
 204 |  function hashOperation(Operation calldata _operation) public pure returns (bytes32) {

     |  // @audit-issue Validate `_newDelay`
 249 |  function updateDelay(uint256 _newDelay) external onlySelf {

     |  // @audit-issue Validate `_newSecurityCouncil`
 256 |  function updateSecurityCouncil(address _newSecurityCouncil) external onlySelf {
```
GitHub: [89](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L89), [105](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L105), [167](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L167), [186](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L186), [204](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L204), [249](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L249), [256](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L256)


```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

     |  // @audit-issue Validate `_chainId`
  76 |  function getChainAdmin(uint256 _chainId) external view override returns (address) {

     |  // @audit-issue Validate `_newPendingAdmin`
 112 |  function setPendingAdmin(address _newPendingAdmin) external onlyOwnerOrAdmin {

     |  // @audit-issue Validate `_validatorTimelock`
 134 |  function setValidatorTimelock(address _validatorTimelock) external onlyOwnerOrAdmin {

     |  // @audit-issue Validate `_chainId`
     |  // Validate `_newLastBatch`
 172 |  function revertBatches(uint256 _chainId, uint256 _newLastBatch) external onlyOwnerOrAdmin {

     |  // @audit-issue Validate `_baseToken`
     |  // Validate `_sharedBridge`
     |  // Validate `_admin`
     |  // Validate `_diamondCut`
 241 |  function createNewChain(
 242 |      uint256 _chainId,
 243 |      address _baseToken,
 244 |      address _sharedBridge,
 245 |      address _admin,
 246 |      bytes calldata _diamondCut
 247 |  ) external onlyBridgehub {
```
GitHub: [76](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L76), [112](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L112), [134](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L134), [172](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L172), [241-247](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L241-L247)


```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

     |  // @audit-issue Validate `_chainId`
     |  // Validate `_newValidator`
  78 |  function addValidator(uint256 _chainId, address _newValidator) external onlyChainAdmin(_chainId) {

     |  // @audit-issue Validate `_chainId`
     |  // Validate `_validator`
  87 |  function removeValidator(uint256 _chainId, address _validator) external onlyChainAdmin(_chainId) {

     |  // @audit-issue Validate `_chainId`
     |  // Validate `_l2BatchNumber`
 102 |  function getCommittedBatchTimestamp(uint256 _chainId, uint256 _l2BatchNumber) external view returns (uint256) {

     |  // @audit-issue Validate ``
 108 |  function commitBatches(
 109 |      StoredBatchInfo calldata,
 110 |      CommitBatchInfo[] calldata _newBatchesData
 111 |  ) external onlyValidator(ERA_CHAIN_ID) {

     |  // @audit-issue Validate `_chainId`
     |  // Validate ``
 126 |  function commitBatchesSharedBridge(
 127 |      uint256 _chainId,
 128 |      StoredBatchInfo calldata,
 129 |      CommitBatchInfo[] calldata _newBatchesData
 130 |  ) external onlyValidator(_chainId) {

     |  // @audit-issue Validate ``
 146 |  function revertBatches(uint256) external onlyValidator(ERA_CHAIN_ID) {

     |  // @audit-issue Validate `_chainId`
     |  // Validate ``
 153 |  function revertBatchesSharedBridge(uint256 _chainId, uint256) external onlyValidator(_chainId) {

     |  // @audit-issue Validate ``
     |  // Validate ``
     |  // Validate ``
 160 |  function proveBatches(
 161 |      StoredBatchInfo calldata,
 162 |      StoredBatchInfo[] calldata,
 163 |      ProofInput calldata
 164 |  ) external onlyValidator(ERA_CHAIN_ID) {

     |  // @audit-issue Validate `_chainId`
     |  // Validate ``
     |  // Validate ``
     |  // Validate ``
 171 |  function proveBatchesSharedBridge(
 172 |      uint256 _chainId,
 173 |      StoredBatchInfo calldata,
 174 |      StoredBatchInfo[] calldata,
 175 |      ProofInput calldata
 176 |  ) external onlyValidator(_chainId) {

     |  // @audit-issue Validate `_chainId`
 203 |  function executeBatchesSharedBridge(
 204 |      uint256 _chainId,
 205 |      StoredBatchInfo[] calldata _newBatchesData
 206 |  ) external onlyValidator(_chainId) {
```
GitHub: [78](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L78), [87](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L87), [102](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L102), [108-111](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L108-L111), [126-130](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L126-L130), [146](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L146), [153](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L153), [160-164](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L160-L164), [171-176](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L171-L176), [203-206](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L203-L206)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol

     |  // @audit-issue Validate `_validator`
     |  // Validate `_active`
  45 |  function setValidator(address _validator, bool _active) external onlyStateTransitionManager {

     |  // @audit-issue Validate `_zkPorterIsAvailable`
  51 |  function setPorterAvailability(bool _zkPorterIsAvailable) external onlyStateTransitionManager {

     |  // @audit-issue Validate `_nominator`
     |  // Validate `_denominator`
  79 |  function setTokenMultiplier(uint128 _nominator, uint128 _denominator) external onlyAdminOrStateTransitionManager {

     |  // @audit-issue Validate `_diamondCut`
 100 |  function upgradeChainFromVersion(
 101 |      uint256 _oldProtocolVersion,
 102 |      Diamond.DiamondCutData calldata _diamondCut
 103 |  ) external onlyAdminOrStateTransitionManager {

     |  // @audit-issue Validate `_diamondCut`
 123 |  function executeUpgrade(Diamond.DiamondCutData calldata _diamondCut) external onlyStateTransitionManager {
```
GitHub: [45](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L45), [51](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L51), [79](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L79), [100-103](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L100-L103), [123](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L123)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

     |  // @audit-issue Validate `_lastCommittedBatchData`
     |  // Validate `_newBatchesData`
 199 |  function commitBatches(
 200 |      StoredBatchInfo memory _lastCommittedBatchData,
 201 |      CommitBatchInfo[] calldata _newBatchesData
 202 |  ) external nonReentrant onlyValidator {

     |  // @audit-issue Validate ``
     |  // Validate `_lastCommittedBatchData`
     |  // Validate `_newBatchesData`
 207 |  function commitBatchesSharedBridge(
 208 |      uint256, // _chainId
 209 |      StoredBatchInfo memory _lastCommittedBatchData,
 210 |      CommitBatchInfo[] calldata _newBatchesData
 211 |  ) external nonReentrant onlyValidator {

     |  // @audit-issue Validate ``
     |  // Validate `_batchesData`
 337 |  function executeBatchesSharedBridge(
 338 |      uint256,
 339 |      StoredBatchInfo[] calldata _batchesData
 340 |  ) external nonReentrant onlyValidator {

     |  // @audit-issue Validate `_batchesData`
 345 |  function executeBatches(StoredBatchInfo[] calldata _batchesData) external nonReentrant onlyValidator {

     |  // @audit-issue Validate `_prevBatch`
     |  // Validate `_committedBatches`
     |  // Validate `_proof`
 368 |  function proveBatches(
 369 |      StoredBatchInfo calldata _prevBatch,
 370 |      StoredBatchInfo[] calldata _committedBatches,
 371 |      ProofInput calldata _proof
 372 |  ) external nonReentrant onlyValidator {

     |  // @audit-issue Validate ``
     |  // Validate `_prevBatch`
     |  // Validate `_committedBatches`
     |  // Validate `_proof`
 377 |  function proveBatchesSharedBridge(
 378 |      uint256, // _chainId
 379 |      StoredBatchInfo calldata _prevBatch,
 380 |      StoredBatchInfo[] calldata _committedBatches,
 381 |      ProofInput calldata _proof
 382 |  ) external nonReentrant onlyValidator {

     |  // @audit-issue Validate `_newLastBatch`
 472 |  function revertBatches(uint256 _newLastBatch) external nonReentrant onlyValidatorOrStateTransitionManager {

     |  // @audit-issue Validate ``
     |  // Validate `_newLastBatch`
 477 |  function revertBatchesSharedBridge(uint256, uint256 _newLastBatch) external nonReentrant onlyValidator {
```
GitHub: [199-202](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L199-L202), [207-211](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L207-L211), [337-340](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L337-L340), [345](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L345), [368-372](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L368-L372), [377-382](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L377-L382), [472](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L472), [477](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L477)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol

     |  // @audit-issue Validate `_address`
 112 |  function isValidator(address _address) external view returns (bool) {

     |  // @audit-issue Validate `_batchNumber`
 117 |  function l2LogsRootHash(uint256 _batchNumber) external view returns (bytes32) {

     |  // @audit-issue Validate `_batchNumber`
 122 |  function storedBatchHash(uint256 _batchNumber) external view returns (bytes32) {

     |  // @audit-issue Validate `_facet`
 163 |  function isFacetFreezable(address _facet) external view returns (bool isFreezable) {

     |  // @audit-issue Validate `_l2BatchNumber`
     |  // Validate `_l2MessageIndex`
 188 |  function isEthWithdrawalFinalized(uint256 _l2BatchNumber, uint256 _l2MessageIndex) external view returns (bool) {

     |  // @audit-issue Validate `_facet`
 217 |  function facetFunctionSelectors(address _facet) external view returns (bytes4[] memory) {

     |  // @audit-issue Validate `_selector`
 229 |  function facetAddress(bytes4 _selector) external view returns (address) {

     |  // @audit-issue Validate `_batchNumber`
 254 |  function storedBlockHash(uint256 _batchNumber) external view returns (bytes32) {
```
GitHub: [112](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L112), [117](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L117), [122](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L122), [163](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L163), [188](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L188), [217](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L217), [229](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L229), [254](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L254)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

     |  // @audit-issue Validate `_request`
  47 |  function bridgehubRequestL2Transaction(
  48 |      BridgehubL2TransactionRequest memory _request
  49 |  ) external payable onlyBridgehub returns (bytes32 canonicalTxHash) {

     |  // @audit-issue Validate `_batchNumber`
     |  // Validate `_index`
     |  // Validate `_message`
     |  // Validate `_proof`
  54 |  function proveL2MessageInclusion(
  55 |      uint256 _batchNumber,
  56 |      uint256 _index,
  57 |      L2Message memory _message,
  58 |      bytes32[] calldata _proof
  59 |  ) public view returns (bool) {

     |  // @audit-issue Validate `_batchNumber`
     |  // Validate `_index`
     |  // Validate `_log`
     |  // Validate `_proof`
  64 |  function proveL2LogInclusion(
  65 |      uint256 _batchNumber,
  66 |      uint256 _index,
  67 |      L2Log memory _log,
  68 |      bytes32[] calldata _proof
  69 |  ) external view returns (bool) {

     |  // @audit-issue Validate `_l2TxHash`
     |  // Validate `_l2BatchNumber`
     |  // Validate `_l2MessageIndex`
     |  // Validate `_l2TxNumberInBatch`
     |  // Validate `_merkleProof`
     |  // Validate `_status`
  74 |  function proveL1ToL2TransactionStatus(
  75 |      bytes32 _l2TxHash,
  76 |      uint256 _l2BatchNumber,
  77 |      uint256 _l2MessageIndex,
  78 |      uint16 _l2TxNumberInBatch,
  79 |      bytes32[] calldata _merkleProof,
  80 |      TxStatus _status
  81 |  ) public view returns (bool) {

     |  // @audit-issue Validate `_gasPrice`
     |  // Validate `_l2GasPerPubdataByteLimit`
 143 |  function l2TransactionBaseCost(
 144 |      uint256 _gasPrice,
 145 |      uint256 _l2GasLimit,
 146 |      uint256 _l2GasPerPubdataByteLimit
 147 |  ) public view returns (uint256) {

     |  // @audit-issue Validate `_l2BatchNumber`
     |  // Validate `_l2MessageIndex`
     |  // Validate `_l2TxNumberInBatch`
     |  // Validate `_message`
     |  // Validate `_merkleProof`
 178 |  function finalizeEthWithdrawal(
 179 |      uint256 _l2BatchNumber,
 180 |      uint256 _l2MessageIndex,
 181 |      uint16 _l2TxNumberInBatch,
 182 |      bytes calldata _message,
 183 |      bytes32[] calldata _merkleProof
 184 |  ) external nonReentrant {

     |  // @audit-issue Validate `_contractL2`
     |  // Validate `_l2Value`
     |  // Validate `_calldata`
     |  // Validate `_l2GasLimit`
     |  // Validate `_l2GasPerPubdataByteLimit`
     |  // Validate `_factoryDeps`
     |  // Validate `_refundRecipient`
 197 |  function requestL2Transaction(
 198 |      address _contractL2,
 199 |      uint256 _l2Value,
 200 |      bytes calldata _calldata,
 201 |      uint256 _l2GasLimit,
 202 |      uint256 _l2GasPerPubdataByteLimit,
 203 |      bytes[] calldata _factoryDeps,
 204 |      address _refundRecipient
 205 |  ) external payable returns (bytes32 canonicalTxHash) {
```
GitHub: [47-49](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L47-L49), [54-59](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L54-L59), [64-69](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L64-L69), [74-81](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L74-L81), [143-147](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L143-L147), [178-184](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L178-L184), [197-205](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L197-L205)


```solidity
File: code/contracts/ethereum/contracts/upgrades/DefaultUpgrade.sol

     |  // @audit-issue Validate `_proposedUpgrade`
  13 |  function upgrade(ProposedUpgrade calldata _proposedUpgrade) public override returns (bytes32) {
```
GitHub: [13](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/DefaultUpgrade.sol#L13)


```solidity
File: code/contracts/ethereum/contracts/upgrades/GenesisUpgrade.sol

     |  // @audit-issue Validate `_proposedUpgrade`
  14 |  function upgrade(ProposedUpgrade calldata _proposedUpgrade) public override returns (bytes32) {
```
GitHub: [14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/GenesisUpgrade.sol#L14)


```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol

     |  // @audit-issue Validate `_l2BatchNumber`
     |  // Validate `_l2MessageIndex`
  24 |  function isWithdrawalFinalized(uint256 _l2BatchNumber, uint256 _l2MessageIndex) external view returns (bool);

     |  // @audit-issue Validate `_l2Receiver`
     |  // Validate `_l1Token`
     |  // Validate `_amount`
     |  // Validate `_l2TxGasLimit`
     |  // Validate `_l2TxGasPerPubdataByte`
     |  // Validate `_refundRecipient`
  26 |  function deposit(
  27 |      address _l2Receiver,
  28 |      address _l1Token,
  29 |      uint256 _amount,
  30 |      uint256 _l2TxGasLimit,
  31 |      uint256 _l2TxGasPerPubdataByte,
  32 |      address _refundRecipient
  33 |  ) external payable returns (bytes32 txHash);

     |  // @audit-issue Validate `_l2Receiver`
     |  // Validate `_l1Token`
     |  // Validate `_amount`
     |  // Validate `_l2TxGasLimit`
     |  // Validate `_l2TxGasPerPubdataByte`
  35 |  function deposit(
  36 |      address _l2Receiver,
  37 |      address _l1Token,
  38 |      uint256 _amount,
  39 |      uint256 _l2TxGasLimit,
  40 |      uint256 _l2TxGasPerPubdataByte
  41 |  ) external payable returns (bytes32 txHash);

     |  // @audit-issue Validate `_depositSender`
     |  // Validate `_l1Token`
     |  // Validate `_l2TxHash`
     |  // Validate `_l2BatchNumber`
     |  // Validate `_l2MessageIndex`
     |  // Validate `_l2TxNumberInBatch`
     |  // Validate `_merkleProof`
  43 |  function claimFailedDeposit(
  44 |      address _depositSender,
  45 |      address _l1Token,
  46 |      bytes32 _l2TxHash,
  47 |      uint256 _l2BatchNumber,
  48 |      uint256 _l2MessageIndex,
  49 |      uint16 _l2TxNumberInBatch,
  50 |      bytes32[] calldata _merkleProof
  51 |  ) external;

     |  // @audit-issue Validate `_l2BatchNumber`
     |  // Validate `_l2MessageIndex`
     |  // Validate `_l2TxNumberInBatch`
     |  // Validate `_message`
     |  // Validate `_merkleProof`
  53 |  function finalizeWithdrawal(
  54 |      uint256 _l2BatchNumber,
  55 |      uint256 _l2MessageIndex,
  56 |      uint16 _l2TxNumberInBatch,
  57 |      bytes calldata _message,
  58 |      bytes32[] calldata _merkleProof
  59 |  ) external;

     |  // @audit-issue Validate `_l1Token`
  61 |  function l2TokenAddress(address _l1Token) external view returns (address);

     |  // @audit-issue Validate `_account`
     |  // Validate `_l1Token`
     |  // Validate `_depositL2TxHash`
  69 |  function depositAmount(
  70 |      address _account,
  71 |      address _l1Token,
  72 |      bytes32 _depositL2TxHash
  73 |  ) external returns (uint256 amount);

     |  // @audit-issue Validate `_token`
     |  // Validate `_amount`
  75 |  function tranferTokenToSharedBridge(address _token, uint256 _amount) external;
```
GitHub: [24](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L24), [26-33](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L26-L33), [35-41](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L35-L41), [43-51](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L43-L51), [53-59](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L53-L59), [61](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L61), [69-73](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L69-L73), [75](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L75)


```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol

     |  // @audit-issue Validate `_chainId`
     |  // Validate `_l2BatchNumber`
     |  // Validate `_l2MessageIndex`
  58 |  function isWithdrawalFinalized(
  59 |      uint256 _chainId,
  60 |      uint256 _l2BatchNumber,
  61 |      uint256 _l2MessageIndex
  62 |  ) external view returns (bool);

     |  // @audit-issue Validate `_msgSender`
     |  // Validate `_l2Receiver`
     |  // Validate `_l1Token`
     |  // Validate `_amount`
     |  // Validate `_l2TxGasLimit`
     |  // Validate `_l2TxGasPerPubdataByte`
     |  // Validate `_refundRecipient`
  64 |  function depositLegacyErc20Bridge(
  65 |      address _msgSender,
  66 |      address _l2Receiver,
  67 |      address _l1Token,
  68 |      uint256 _amount,
  69 |      uint256 _l2TxGasLimit,
  70 |      uint256 _l2TxGasPerPubdataByte,
  71 |      address _refundRecipient
  72 |  ) external payable returns (bytes32 txHash);

     |  // @audit-issue Validate `_depositSender`
     |  // Validate `_l1Token`
     |  // Validate `_amount`
     |  // Validate `_l2TxHash`
     |  // Validate `_l2BatchNumber`
     |  // Validate `_l2MessageIndex`
     |  // Validate `_l2TxNumberInBatch`
     |  // Validate `_merkleProof`
  74 |  function claimFailedDepositLegacyErc20Bridge(
  75 |      address _depositSender,
  76 |      address _l1Token,
  77 |      uint256 _amount,
  78 |      bytes32 _l2TxHash,
  79 |      uint256 _l2BatchNumber,
  80 |      uint256 _l2MessageIndex,
  81 |      uint16 _l2TxNumberInBatch,
  82 |      bytes32[] calldata _merkleProof
  83 |  ) external;

     |  // @audit-issue Validate `_chainId`
     |  // Validate `_depositSender`
     |  // Validate `_l1Token`
     |  // Validate `_amount`
     |  // Validate `_l2TxHash`
     |  // Validate `_l2BatchNumber`
     |  // Validate `_l2MessageIndex`
     |  // Validate `_l2TxNumberInBatch`
     |  // Validate `_merkleProof`
  85 |  function claimFailedDeposit(
  86 |      uint256 _chainId,
  87 |      address _depositSender,
  88 |      address _l1Token,
  89 |      uint256 _amount,
  90 |      bytes32 _l2TxHash,
  91 |      uint256 _l2BatchNumber,
  92 |      uint256 _l2MessageIndex,
  93 |      uint16 _l2TxNumberInBatch,
  94 |      bytes32[] calldata _merkleProof
  95 |  ) external;

     |  // @audit-issue Validate `_l2BatchNumber`
     |  // Validate `_l2MessageIndex`
     |  // Validate `_l2TxNumberInBatch`
     |  // Validate `_message`
     |  // Validate `_merkleProof`
  97 |  function finalizeWithdrawalLegacyErc20Bridge(
  98 |      uint256 _l2BatchNumber,
  99 |      uint256 _l2MessageIndex,
 100 |      uint16 _l2TxNumberInBatch,
 101 |      bytes calldata _message,
 102 |      bytes32[] calldata _merkleProof
 103 |  ) external returns (address l1Receiver, address l1Token, uint256 amount);

     |  // @audit-issue Validate `_chainId`
     |  // Validate `_l2BatchNumber`
     |  // Validate `_l2MessageIndex`
     |  // Validate `_l2TxNumberInBatch`
     |  // Validate `_message`
     |  // Validate `_merkleProof`
 105 |  function finalizeWithdrawal(
 106 |      uint256 _chainId,
 107 |      uint256 _l2BatchNumber,
 108 |      uint256 _l2MessageIndex,
 109 |      uint16 _l2TxNumberInBatch,
 110 |      bytes calldata _message,
 111 |      bytes32[] calldata _merkleProof
 112 |  ) external;

     |  // @audit-issue Validate `_chainId`
 120 |  function l2BridgeAddress(uint256 _chainId) external view returns (address);

     |  // @audit-issue Validate `_chainId`
     |  // Validate `_l2TxHash`
 122 |  function depositHappened(uint256 _chainId, bytes32 _l2TxHash) external view returns (bytes32);

     |  // @audit-issue Validate `_chainId`
     |  // Validate `_prevMsgSender`
     |  // Validate `_l2Value`
     |  // Validate `_data`
 128 |  function bridgehubDeposit(
 129 |      uint256 _chainId,
 130 |      address _prevMsgSender,
 131 |      uint256 _l2Value,
 132 |      bytes calldata _data
 133 |  ) external payable returns (L2TransactionRequestTwoBridgesInner memory request);

     |  // @audit-issue Validate `_chainId`
     |  // Validate `_prevMsgSender`
     |  // Validate `_l1Token`
     |  // Validate `_amount`
 135 |  function bridgehubDepositBaseToken(
 136 |      uint256 _chainId,
 137 |      address _prevMsgSender,
 138 |      address _l1Token,
 139 |      uint256 _amount
 140 |  ) external payable;

     |  // @audit-issue Validate `_chainId`
     |  // Validate `_txDataHash`
     |  // Validate `_txHash`
 142 |  function bridgehubConfirmL2Transaction(uint256 _chainId, bytes32 _txDataHash, bytes32 _txHash) external;

     |  // @audit-issue Validate `_chainId`
 144 |  function receiveEth(uint256 _chainId) external payable;
```
GitHub: [58-62](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L58-L62), [64-72](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L64-L72), [74-83](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L74-L83), [85-95](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L85-L95), [97-103](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L97-L103), [105-112](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L105-L112), [120](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L120), [122](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L122), [128-133](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L128-L133), [135-140](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L135-L140), [142](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L142), [144](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L144)


```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL2Bridge.sol

     |  // @audit-issue Validate `_l1Sender`
     |  // Validate `_l2Receiver`
     |  // Validate `_l1Token`
     |  // Validate `_amount`
     |  // Validate `_data`
   7 |  function finalizeDeposit(
   8 |      address _l1Sender,
   9 |      address _l2Receiver,
  10 |      address _l1Token,
  11 |      uint256 _amount,
  12 |      bytes calldata _data
  13 |  ) external payable;

     |  // @audit-issue Validate `_l1Receiver`
     |  // Validate `_l2Token`
     |  // Validate `_amount`
  15 |  function withdraw(address _l1Receiver, address _l2Token, uint256 _amount) external;

     |  // @audit-issue Validate `_l2Token`
  17 |  function l1TokenAddress(address _l2Token) external view returns (address);

     |  // @audit-issue Validate `_l1Token`
  19 |  function l2TokenAddress(address _l1Token) external view returns (address);
```
GitHub: [7-13](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL2Bridge.sol#L7-L13), [15](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL2Bridge.sol#L15), [17](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL2Bridge.sol#L17), [19](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL2Bridge.sol#L19)


```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IWETH9.sol

     |  // @audit-issue Validate `wad`
   7 |  function withdraw(uint256 wad) external;
```
GitHub: [7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IWETH9.sol#L7)


```solidity
File: code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol

     |  // @audit-issue Validate `_newPendingAdmin`
  53 |  function setPendingAdmin(address _newPendingAdmin) external;
```
GitHub: [53](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L53)


## [N-11] Consider emitting an event from `constructor`s

Use events to monitor deployments are successful and/or to signal significant changes to off-chain monitoring tools.

*Instances: 8*

```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

     |  // @audit-issue Consider emitting an event
  55 |  constructor(IL1SharedBridge _sharedBridge) reentrancyGuardInitializer {
```
GitHub: [55](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L55)


```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

     |  // @audit-issue Consider emitting an event
  90 |  constructor(
  91 |      address _l1WethAddress,
  92 |      IBridgehub _bridgehub,
  93 |      IL1ERC20Bridge _legacyBridge
  94 |  ) reentrancyGuardInitializer {
```
GitHub: [90-94](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L90-L94)


```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

     |  // @audit-issue Consider emitting an event
  60 |  constructor(address _bridgehub) reentrancyGuardInitializer {
```
GitHub: [60](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L60)


```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

     |  // @audit-issue Consider emitting an event
  55 |  constructor(address _initialOwner, uint32 _executionDelay) {
```
GitHub: [55](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L55)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol

     |  // @audit-issue Consider emitting an event
  11 |  constructor(uint256 _chainId, Diamond.DiamondCutData memory _diamondCut) {
```
GitHub: [11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol#L11)


```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

     |  // @audit-issue Consider emitting an event
  41 |  constructor() {
```
GitHub: [41](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L41)


```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

     |  // @audit-issue Consider emitting an event
  40 |  constructor() {
```
GitHub: [40](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L40)


```solidity
File: code/contracts/zksync/contracts/bridge/L2WrappedBaseToken.sol

     |  // @audit-issue Consider emitting an event
  31 |  constructor() {
```
GitHub: [31](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2WrappedBaseToken.sol#L31)


## [N-12] Consider making contracts `Upgradeable`

This allows for bugs to be fixed in production, at the expense of increased centralization.

*Instances: 7*

```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

     |  // @audit-issue Consider making this critical contract upgradeable
  20 |  contract Governance is IGovernance, Ownable2Step {
```
GitHub: [20](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L20)


```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

     |  // @audit-issue Consider making this critical contract upgradeable
  27 |  contract StateTransitionManager is IStateTransitionManager, ReentrancyGuard, Ownable2Step {
```
GitHub: [27](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L27)


```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

     |  // @audit-issue Consider making this critical contract upgradeable
  22 |  contract ValidatorTimelock is IExecutor, Ownable2Step {
```
GitHub: [22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L22)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol

     |  // @audit-issue Consider making this critical contract upgradeable
  10 |  contract DiamondProxy {
```
GitHub: [10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol#L10)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol

     |  // @audit-issue Consider making this critical contract upgradeable
  18 |  contract AdminFacet is ZkSyncStateTransitionBase, IAdmin {
```
GitHub: [18](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L18)


```solidity
File: code/system-contracts/contracts/AccountCodeStorage.sol

     |  // @audit-issue Consider making this critical contract upgradeable
  22 |  contract AccountCodeStorage is IAccountCodeStorage {
```
GitHub: [22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L22)


```solidity
File: code/system-contracts/contracts/DefaultAccount.sol

     |  // @audit-issue Consider making this critical contract upgradeable
  19 |  contract DefaultAccount is IAccount {
```
GitHub: [19](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L19)


## [N-13] Consider more inclusive language

Use [alternative variants](https://www.zdnet.com/article/mysql-drops-master-slave-and-blacklist-whitelist-terminology/), e.g. allowlist/denylist instead of whitelist/blacklist

*Instances: 2*

```solidity
File: code/system-contracts/contracts/ImmutableSimulator.sol

     |  // @audit-issue Replace `his` with `their`
  12 |  * @dev The contract stores the immutable variables created during deployment by other contracts on his storage.
```
GitHub: [12](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ImmutableSimulator.sol#L12)


```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

     |  // @audit-issue Replace `his` with `their`
 386 |  // Do nothing. general(bytes) paymaster flow means that the paymaster must interpret these bytes on his own.
```
GitHub: [386](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L386)


## [N-14] Consider moving `msg.sender` checks to `modifier`s

Using `modifier`s makes the contract guard intention of the code more clear, and also guarantees no other code can run before the modifier runs.

*Instances: 14*

```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

  63 |  function tranferTokenToSharedBridge(address _token, uint256 _amount) external {
  64 |      require(msg.sender == address(sharedBridge), "Not shared bridge");
```
GitHub: [64](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L64)


```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

 137 |  function receiveEth(uint256 _chainId) external payable {
 138 |      require(bridgehub.getStateTransition(_chainId) == msg.sender, "receiveEth not state transition");
```
GitHub: [138](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L138)


```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

  60 |  function acceptAdmin() external {
  :  |
  62 |      require(msg.sender == currentPendingAdmin, "n42"); // Only proposed by current admin address can claim the admin rights
```
GitHub: [62](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L62)


```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

 121 |  function acceptAdmin() external {
  :  |
 123 |      require(msg.sender == currentPendingAdmin, "n42"); // Only proposed by current admin address can claim the admin rights
```
GitHub: [123](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L123)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol

  32 |  function acceptAdmin() external {
  :  |
  34 |      require(msg.sender == pendingAdmin, "n4"); // Only proposed by current admin address can claim the admin rights
```
GitHub: [34](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L34)


```solidity
File: code/system-contracts/contracts/ComplexUpgrader.sol

  21 |  function upgrade(address _delegateTo, bytes calldata _calldata) external payable {
  22 |      require(msg.sender == FORCE_DEPLOYER, "Can only be called by FORCE_DEPLOYER");
```
GitHub: [22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ComplexUpgrader.sol#L22)


```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

 238 |  function forceDeployOnAddresses(ForceDeployment[] calldata _deployments) external payable {
 239 |      require(
 240 |          msg.sender == FORCE_DEPLOYER || msg.sender == address(COMPLEX_UPGRADER_CONTRACT),
 241 |          "Can only be called by FORCE_DEPLOYER or COMPLEX_UPGRADER_CONTRACT"
 242 |      );
```
GitHub: [239-242](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L239-L242)


```solidity
File: code/system-contracts/contracts/ImmutableSimulator.sol

  34 |  function setImmutables(address _dest, ImmutableData[] calldata _immutables) external override {
  35 |      require(msg.sender == address(DEPLOYER_SYSTEM_CONTRACT), "Callable only by the deployer system contract");
```
GitHub: [35](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ImmutableSimulator.sol#L35)


```solidity
File: code/system-contracts/contracts/L2BaseToken.sol

  32 |  function transferFromTo(address _from, address _to, uint256 _amount) external override {
  33 |      require(
  34 |          msg.sender == MSG_VALUE_SYSTEM_CONTRACT ||
  35 |              msg.sender == address(DEPLOYER_SYSTEM_CONTRACT) ||
  36 |              msg.sender == BOOTLOADER_FORMAL_ADDRESS,
  37 |          "Only system contracts with special access can call this method"
  38 |      );
```
GitHub: [33-38](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L2BaseToken.sol#L33-L38)


```solidity
File: code/system-contracts/contracts/NonceHolder.sol

  82 |  function setValueUnderNonce(uint256 _key, uint256 _value) public onlySystemCall {
  :  |
  89 |          require(isNonceUsed(msg.sender, _key - 1), "Previous nonce has not been used");

 135 |  function incrementDeploymentNonce(address _address) external returns (uint256 prevDeploymentNonce) {
 136 |      require(
 137 |          msg.sender == address(DEPLOYER_SYSTEM_CONTRACT),
 138 |          "Only the contract deployer can increment the deployment nonce"
 139 |      );
```
GitHub: [89](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/NonceHolder.sol#L89), [136-139](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/NonceHolder.sol#L136-L139)


```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

  79 |  function finalizeDeposit(
  80 |      address _l1Sender,
  81 |      address _l2Receiver,
  82 |      address _l1Token,
  83 |      uint256 _amount,
  84 |      bytes calldata _data
  85 |  ) external payable override {
  :  |
  87 |      require(
  88 |          AddressAliasHelper.undoL1ToL2Alias(msg.sender) == l1Bridge ||
  89 |              AddressAliasHelper.undoL1ToL2Alias(msg.sender) == l1LegacyBridge,
  90 |          "mq"
  91 |      );
```
GitHub: [87-91](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L87-L91)


```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

 111 |  function reinitializeToken(
 112 |      ERC20Getters calldata _availableGetters,
 113 |      string memory _newName,
 114 |      string memory _newSymbol,
 115 |      uint8 _version
 116 |  ) external onlyNextVersion(_version) reinitializer(_version) {
  :  |
 120 |      require(msg.sender == UpgradeableBeacon(beaconAddress).owner(), "tt");
```
GitHub: [120](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L120)


```solidity
File: code/contracts/zksync/contracts/TestnetPaymaster.sol

  14 |  function validateAndPayForPaymasterTransaction(
  15 |      bytes32,
  16 |      bytes32,
  17 |      Transaction calldata _transaction
  18 |  ) external payable returns (bytes4 magic, bytes memory context) {
  :  |
  22 |      require(msg.sender == BOOTLOADER_ADDRESS, "Only bootloader can call this contract");
```
GitHub: [22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/TestnetPaymaster.sol#L22)


## [N-15] Consider splitting complex checks into multiple steps

Assign the individual expression operations to intermediate local variables, and check against those instead.

*Instances: 24*

```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

     |  // @audit-issue Refactor sub-expressions into variables
  75 |  require(
  76 |      msg.sender == address(bridgehub) || (_chainId == ERA_CHAIN_ID && msg.sender == ERA_DIAMOND_PROXY),
  77 |      "L1SharedBridge: not bridgehub or era chain"
  78 |  );

     |  // @audit-issue Refactor sub-expressions into variables
 375 |  return (_chainId == ERA_CHAIN_ID) && (_l2BatchNumber < eraFirstPostUpgradeBatch);
```
GitHub: [75-78](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L75-L78), [375](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L375)


```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

     |  // @audit-issue Refactor sub-expressions into variables
  46 |  require(msg.sender == admin || msg.sender == owner(), "Bridgehub: not owner or admin");
```
GitHub: [46](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L46)


```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

     |  // @audit-issue Refactor sub-expressions into variables
  71 |  require(
  72 |      msg.sender == owner() || msg.sender == securityCouncil,
  73 |      "Only the owner and security council are allowed to call this function"
  74 |  );

     |  // @audit-issue Refactor sub-expressions into variables
  91 |  return state == OperationState.Waiting || state == OperationState.Ready;
```
GitHub: [71-74](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L71-L74), [91](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L91)


```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

     |  // @audit-issue Refactor sub-expressions into variables
  72 |  require(msg.sender == admin || msg.sender == owner(), "Bridgehub: not owner or admin");
```
GitHub: [72](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L72)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol

     |  // @audit-issue Refactor sub-expressions into variables
  25 |  require(msg.data.length >= 4 || msg.data.length == 0, "Ut");
```
GitHub: [25](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol#L25)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

     |  // @audit-issue Refactor sub-expressions into variables
  40 |  require(pubdataSource == uint8(PubdataSource.Calldata) || pubdataSource == uint8(PubdataSource.Blob), "us");

     |  // @audit-issue Refactor sub-expressions into variables
 668 |  require(
 669 |      (_blobHashes[i] == bytes32(0) && blobCommitments[i] == bytes32(0)) ||
 670 |          (_blobHashes[i] != bytes32(0) && blobCommitments[i] != bytes32(0)),
 671 |      "bh"
 672 |  );
```
GitHub: [40](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L40), [668-672](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L668-L672)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol

     |  // @audit-issue Refactor sub-expressions into variables
  37 |  require(
  38 |      msg.sender == s.admin || msg.sender == s.stateTransitionManager,
  39 |      "StateTransition Chain: Only by admin or state transition manager"
  40 |  );
```
GitHub: [37-40](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L37-L40)


```solidity
File: code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol

     |  // @audit-issue Refactor sub-expressions into variables
  41 |  require(version == 1 && _bytecodeHash[1] == bytes1(0), "zf"); // Incorrectly formatted bytecodeHash
```
GitHub: [41](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L41)


```solidity
File: code/system-contracts/contracts/BootloaderUtilities.sol

     |  // @audit-issue Refactor sub-expressions into variables
  92 |  require(vInt == 27 || vInt == 28, "Invalid v value");

     |  // @audit-issue Refactor sub-expressions into variables
 191 |  require(vInt == 27 || vInt == 28, "Invalid v value");

     |  // @audit-issue Refactor sub-expressions into variables
 286 |  require(vInt == 27 || vInt == 28, "Invalid v value");
```
GitHub: [92](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L92), [191](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L191), [286](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L286)


```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

     |  // @audit-issue Refactor sub-expressions into variables
  77 |  require(
  78 |      _nonceOrdering == AccountNonceOrdering.Arbitrary &&
  79 |          currentInfo.nonceOrdering == AccountNonceOrdering.Sequential,
  80 |      "It is only possible to change from sequential to arbitrary ordering"
  81 |  );

     |  // @audit-issue Refactor sub-expressions into variables
 239 |  require(
 240 |      msg.sender == FORCE_DEPLOYER || msg.sender == address(COMPLEX_UPGRADER_CONTRACT),
 241 |      "Can only be called by FORCE_DEPLOYER or COMPLEX_UPGRADER_CONTRACT"
 242 |  );
```
GitHub: [77-81](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L77-L81), [239-242](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L239-L242)


```solidity
File: code/system-contracts/contracts/DefaultAccount.sol

     |  // @audit-issue Refactor sub-expressions into variables
 143 |  isSystemCall =
 144 |      selector == DEPLOYER_SYSTEM_CONTRACT.create.selector ||
 145 |      selector == DEPLOYER_SYSTEM_CONTRACT.create2.selector ||
 146 |      selector == DEPLOYER_SYSTEM_CONTRACT.createAccount.selector ||
 147 |      selector == DEPLOYER_SYSTEM_CONTRACT.create2Account.selector;

     |  // @audit-issue Refactor sub-expressions into variables
 173 |  require(v == 27 || v == 28, "v is neither 27 nor 28");

     |  // @audit-issue Refactor sub-expressions into variables
 188 |  return recoveredAddress == address(this) && recoveredAddress != address(0);
```
GitHub: [143-147](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L143-L147), [173](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L173), [188](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L188)


```solidity
File: code/system-contracts/contracts/KnownCodesStorage.sol

     |  // @audit-issue Refactor sub-expressions into variables
  76 |  require(version == 1 && _bytecodeHash[1] == bytes1(0), "Incorrectly formatted bytecodeHash");
```
GitHub: [76](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/KnownCodesStorage.sol#L76)


```solidity
File: code/system-contracts/contracts/L2BaseToken.sol

     |  // @audit-issue Refactor sub-expressions into variables
  33 |  require(
  34 |      msg.sender == MSG_VALUE_SYSTEM_CONTRACT ||
  35 |          msg.sender == address(DEPLOYER_SYSTEM_CONTRACT) ||
  36 |          msg.sender == BOOTLOADER_FORMAL_ADDRESS,
  37 |      "Only system contracts with special access can call this method"
  38 |  );
```
GitHub: [33-38](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L2BaseToken.sol#L33-L38)


```solidity
File: code/system-contracts/contracts/NonceHolder.sol

     |  // @audit-issue Refactor sub-expressions into variables
 156 |  return (_nonce < getMinNonce(_address) || nonceValues[addressAsKey][_nonce] > 0);
```
GitHub: [156](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/NonceHolder.sol#L156)


```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

     |  // @audit-issue Refactor sub-expressions into variables
  95 |  return _addr == uint256(uint160(address(BASE_TOKEN_SYSTEM_CONTRACT))) || _addr == 0;
```
GitHub: [95](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L95)


```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

     |  // @audit-issue Refactor sub-expressions into variables
  87 |  require(
  88 |      AddressAliasHelper.undoL1ToL2Alias(msg.sender) == l1Bridge ||
  89 |          AddressAliasHelper.undoL1ToL2Alias(msg.sender) == l1LegacyBridge,
  90 |      "mq"
  91 |  );
```
GitHub: [87-91](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L87-L91)


## [N-16] Consider upgrading OpenZeppelin dependency to a newer version

The following dependencies can be updated to the versions specified noted.

*Instances: 25*

```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

     |  // @audit-issue OpenZeppelin 4.9.0 can be updated to 4.9.5
     |  // "// OpenZeppelin Contracts (last updated v4.9.0) (token/ERC20/IERC20.sol)"
   5 |  import {IERC20} from "@openzeppelin/contracts/token/ERC20/IERC20.sol";

     |  // @audit-issue OpenZeppelin 4.9.3 can be updated to 4.9.5
     |  // "// OpenZeppelin Contracts (last updated v4.9.3) (token/ERC20/utils/SafeERC20.sol)"
   6 |  import {SafeERC20} from "@openzeppelin/contracts/token/ERC20/utils/SafeERC20.sol";
```
GitHub: [5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L5), [6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L6)


```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

     |  // @audit-issue OpenZeppelin 4.9.0 can be updated to 4.9.5
     |  // "// OpenZeppelin Contracts (last updated v4.9.0) (proxy/utils/Initializable.sol)"
   5 |  import {Initializable} from "@openzeppelin/contracts/proxy/utils/Initializable.sol";

     |  // @audit-issue OpenZeppelin 4.9.0 can be updated to 4.9.5
     |  // "// OpenZeppelin Contracts (last updated v4.9.0) (access/Ownable2Step.sol)"
   6 |  import {Ownable2Step} from "@openzeppelin/contracts/access/Ownable2Step.sol";

     |  // @audit-issue OpenZeppelin 4.9.0 can be updated to 4.9.5
     |  // "// OpenZeppelin Contracts (last updated v4.9.0) (token/ERC20/IERC20.sol)"
   9 |  import {IERC20} from "@openzeppelin/contracts/token/ERC20/IERC20.sol";

     |  // @audit-issue OpenZeppelin 4.9.3 can be updated to 4.9.5
     |  // "// OpenZeppelin Contracts (last updated v4.9.3) (token/ERC20/utils/SafeERC20.sol)"
  10 |  import {SafeERC20} from "@openzeppelin/contracts/token/ERC20/utils/SafeERC20.sol";
```
GitHub: [5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L5), [6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L6), [9](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L9), [10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L10)


```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

     |  // @audit-issue OpenZeppelin 4.9.0 can be updated to 4.9.5
     |  // "// OpenZeppelin Contracts (last updated v4.9.0) (access/Ownable2Step.sol)"
   5 |  import {Ownable2Step} from "@openzeppelin/contracts/access/Ownable2Step.sol";
```
GitHub: [5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L5)


```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

     |  // @audit-issue OpenZeppelin 4.9.0 can be updated to 4.9.5
     |  // "// OpenZeppelin Contracts (last updated v4.9.0) (access/Ownable2Step.sol)"
   5 |  import {Ownable2Step} from "@openzeppelin/contracts/access/Ownable2Step.sol";
```
GitHub: [5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L5)


```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

     |  // @audit-issue OpenZeppelin 4.9.0 can be updated to 4.9.5
     |  // "// OpenZeppelin Contracts (last updated v4.9.0) (access/Ownable2Step.sol)"
  18 |  import {Ownable2Step} from "@openzeppelin/contracts/access/Ownable2Step.sol";
```
GitHub: [18](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L18)


```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

     |  // @audit-issue OpenZeppelin 4.9.0 can be updated to 4.9.5
     |  // "// OpenZeppelin Contracts (last updated v4.9.0) (access/Ownable2Step.sol)"
   5 |  import {Ownable2Step} from "@openzeppelin/contracts/access/Ownable2Step.sol";
```
GitHub: [5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L5)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

     |  // @audit-issue OpenZeppelin 4.9.0 can be updated to 4.9.5
     |  // "// OpenZeppelin Contracts (last updated v4.9.0) (utils/math/Math.sol)"
   5 |  import {Math} from "@openzeppelin/contracts/utils/math/Math.sol";
```
GitHub: [5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L5)


```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol

     |  // @audit-issue OpenZeppelin 4.8.0 can be updated to 4.9.5
     |  // "// OpenZeppelin Contracts (last updated v4.8.0) (utils/math/SafeCast.sol)"
   5 |  import {SafeCast} from "@openzeppelin/contracts/utils/math/SafeCast.sol";
```
GitHub: [5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L5)


```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol

     |  // @audit-issue OpenZeppelin 4.9.0 can be updated to 4.9.5
     |  // "// OpenZeppelin Contracts (last updated v4.9.0) (utils/math/Math.sol)"
   5 |  import {Math} from "@openzeppelin/contracts/utils/math/Math.sol";
```
GitHub: [5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L5)


```solidity
File: code/contracts/ethereum/contracts/common/Dependencies.sol

     |  // @audit-issue OpenZeppelin 4.9.0 can be updated to 4.9.5
     |  // "// OpenZeppelin Contracts (last updated v4.9.0) (proxy/transparent/TransparentUpgradeableProxy.sol)"
   5 |  import "@openzeppelin/contracts/proxy/transparent/TransparentUpgradeableProxy.sol";

     |  // @audit-issue OpenZeppelin 4.8.3 can be updated to 4.9.5
     |  // "// OpenZeppelin Contracts (last updated v4.8.3) (proxy/transparent/ProxyAdmin.sol)"
   6 |  import "@openzeppelin/contracts/proxy/transparent/ProxyAdmin.sol";
```
GitHub: [5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/Dependencies.sol#L5), [6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/Dependencies.sol#L6)


```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

     |  // @audit-issue OpenZeppelin 4.6.0 can be updated to 4.9.5
     |  // "// OpenZeppelin Contracts (last updated v4.6.0) (token/ERC20/IERC20.sol)"
   5 |  import "../openzeppelin/token/ERC20/IERC20.sol";

     |  // @audit-issue OpenZeppelin 4.8.0 can be updated to 4.9.5
     |  // "// OpenZeppelin Contracts (last updated v4.8.0) (token/ERC20/utils/SafeERC20.sol)"
   6 |  import "../openzeppelin/token/ERC20/utils/SafeERC20.sol";
```
GitHub: [5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L5), [6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L6)


```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

     |  // @audit-issue OpenZeppelin 4.9.0 can be updated to 4.9.5
     |  // "// OpenZeppelin Contracts (last updated v4.9.0) (proxy/utils/Initializable.sol)"
   5 |  import {Initializable} from "@openzeppelin/contracts/proxy/utils/Initializable.sol";

     |  // @audit-issue OpenZeppelin 4.7.0 can be updated to 4.9.5
     |  // "// OpenZeppelin Contracts (last updated v4.7.0) (proxy/beacon/BeaconProxy.sol)"
   6 |  import {BeaconProxy} from "@openzeppelin/contracts/proxy/beacon/BeaconProxy.sol";
```
GitHub: [5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L5), [6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L6)


```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

     |  // @audit-issue OpenZeppelin 4.9.0 can be updated to 4.9.5
     |  // "// OpenZeppelin Contracts (last updated v4.9.0) (token/ERC20/extensions/draft-ERC20Permit.sol)"
   5 |  import {ERC20PermitUpgradeable} from "@openzeppelin/contracts-upgradeable/token/ERC20/extensions/draft-ERC20PermitUpgradeable.sol";

     |  // @audit-issue OpenZeppelin 4.9.0 can be updated to 4.9.5
     |  // "// OpenZeppelin Contracts (last updated v4.9.0) (proxy/ERC1967/ERC1967Upgrade.sol)"
   7 |  import {ERC1967Upgrade} from "@openzeppelin/contracts/proxy/ERC1967/ERC1967Upgrade.sol";
```
GitHub: [5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L5), [7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L7)


```solidity
File: code/contracts/zksync/contracts/Dependencies.sol

     |  // @audit-issue OpenZeppelin 4.9.0 can be updated to 4.9.5
     |  // "// OpenZeppelin Contracts (last updated v4.9.0) (proxy/transparent/TransparentUpgradeableProxy.sol)"
   5 |  import "@openzeppelin/contracts/proxy/transparent/TransparentUpgradeableProxy.sol";

     |  // @audit-issue OpenZeppelin 4.8.3 can be updated to 4.9.5
     |  // "// OpenZeppelin Contracts (last updated v4.8.3) (proxy/transparent/ProxyAdmin.sol)"
   6 |  import "@openzeppelin/contracts/proxy/transparent/ProxyAdmin.sol";
```
GitHub: [5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/Dependencies.sol#L5), [6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/Dependencies.sol#L6)


```solidity
File: code/contracts/zksync/contracts/TestnetPaymaster.sol

     |  // @audit-issue OpenZeppelin 4.9.0 can be updated to 4.9.5
     |  // "// OpenZeppelin Contracts (last updated v4.9.0) (token/ERC20/IERC20.sol)"
   5 |  import "@openzeppelin/contracts/token/ERC20/IERC20.sol";
```
GitHub: [5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/TestnetPaymaster.sol#L5)


```solidity
File: code/contracts/zksync/contracts/bridge/L2WrappedBaseToken.sol

     |  // @audit-issue OpenZeppelin 4.9.0 can be updated to 4.9.5
     |  // "// OpenZeppelin Contracts (last updated v4.9.0) (token/ERC20/extensions/draft-ERC20Permit.sol)"
   5 |  import {ERC20PermitUpgradeable} from "@openzeppelin/contracts-upgradeable/token/ERC20/extensions/draft-ERC20PermitUpgradeable.sol";
```
GitHub: [5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2WrappedBaseToken.sol#L5)


## [N-17] Consider using `delete` rather than assigning zero/false to clear values

The delete keyword more closely matches the semantics of what is being done, and draws more attention to the changing of state, which may lead to a more thorough audit of its associated logic.

*Instances: 6*

```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

     |  // @audit-issue Consider using delete
  97 |  stateTransitionManagerIsRegistered[_stateTransitionManager] = false;

     |  // @audit-issue Consider using delete
 276 |  baseTokenMsgValue = 0;
```
GitHub: [97](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L97), [276](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L276)


```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

     |  // @audit-issue Consider using delete
  91 |  validators[_chainId][_validator] = false;
```
GitHub: [91](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L91)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol

     |  // @audit-issue Consider using delete
 147 |  diamondStorage.isFrozen = false;
```
GitHub: [147](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L147)


```solidity
File: code/system-contracts/contracts/L1Messenger.sol

     |  // @audit-issue Consider using delete
 330 |  numberOfLogsToProcess = 0;
```
GitHub: [330](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L330)


```solidity
File: code/system-contracts/contracts/SystemContext.sol

     |  // @audit-issue Consider using delete
 487 |  txNumberInBlock = 0;
```
GitHub: [487](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L487)


## [N-18] Consider using descriptive `constant`s when passing zero as a function argument

Passing `0` or `0x0` as a function argument can sometimes result in a security issue(e.g. passing zero as the slippage parameter). A historical example is the infamous `0x0` address bug where numerous tokens were lost. This happens because `0` can be interpreted as an uninitialized `address`, leading to transfers to the `0x0` `address`, effectively burning tokens. Moreover, `0` as a denominator in division operations would cause a runtime exception. It's also often indicative of a logical error in the caller's code.

Consider using a constant variable with a descriptive name, so it's clear that the argument is intentionally being used, and for the right reasons.

*Instances: 35*

```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

     |  // @audit-issue Replace literal 0 with an explicit constant
 223 |  factoryDeps: new bytes[](0),

     |  // @audit-issue Replace literal 0 with an explicit constant
 503 |  (uint32 functionSignature, uint256 offset) = UnsafeBytes.readUint32(_l2ToL1message, 0);

     |  // @audit-issue Replace literal 0 with an explicit constant
 584 |  L2TransactionRequestDirect memory request = L2TransactionRequestDirect({
 585 |      chainId: ERA_CHAIN_ID,
 586 |      l2Contract: l2BridgeAddress[ERA_CHAIN_ID],
 587 |      mintValue: msg.value, // l2 gas + l2 msg.Value the bridgehub will withdraw the mintValue from the base token bridge for gas
 588 |      l2Value: 0, // L2 msg.value, this contract doesn't support base token deposits or wrapping functionality, for direct deposits use bridgehub
 589 |      l2Calldata: l2TxCalldata,
 590 |      l2GasLimit: _l2TxGasLimit,
 591 |      l2GasPerPubdataByteLimit: _l2TxGasPerPubdataByte,
 592 |      factoryDeps: new bytes[](0),
 593 |      refundRecipient: refundRecipient
 594 |  });

     |  // @audit-issue Replace literal 0 with an explicit constant
 592 |  factoryDeps: new bytes[](0),
```
GitHub: [223](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L223), [503](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L503), [584-594](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L584-L594), [592](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L592)


```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

     |  // @audit-issue Replace literal 0 with an explicit constant
  50 |  emit ChangeMinDelay(0, _minDelay);
```
GitHub: [50](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L50)


```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

     |  // @audit-issue Replace literal 0 with an explicit constant
  92 |  IExecutor.StoredBatchInfo memory batchZero = IExecutor.StoredBatchInfo(
  93 |      0,
  94 |      _initializeData.genesisBatchHash,
  95 |      _initializeData.genesisIndexRepeatedStorageChanges,
  96 |      0,
  97 |      EMPTY_STRING_KECCAK,
  98 |      DEFAULT_L2_LOGS_TREE_ROOT_HASH,
  99 |      0,
 100 |      _initializeData.genesisBatchCommitment
 101 |  );

     |  // @audit-issue Replace literal 0 with an explicit constant
 184 |  L2CanonicalTransaction memory l2ProtocolUpgradeTx = L2CanonicalTransaction({
 185 |      txType: SYSTEM_UPGRADE_L2_TX_TYPE,
 186 |      from: uint256(uint160(L2_FORCE_DEPLOYER_ADDR)),
 187 |      to: uint256(uint160(L2_SYSTEM_CONTEXT_SYSTEM_CONTRACT_ADDR)),
 188 |      gasLimit: 72000000,
 189 |      gasPerPubdataByteLimit: REQUIRED_L2_GAS_PRICE_PER_PUBDATA,
 190 |      maxFeePerGas: uint256(0),
 191 |      maxPriorityFeePerGas: uint256(0),
 192 |      paymaster: uint256(0),
 193 |      // Note, that the priority operation id is used as "nonce" for L1->L2 transactions
 194 |      nonce: protocolVersion,
 195 |      value: 0,
 196 |      reserved: [uint256(0), 0, 0, 0],
 197 |      data: systemContextCalldata,
 198 |      signature: new bytes(0),
 199 |      factoryDeps: uintEmptyArray,
 200 |      paymasterInput: new bytes(0),
 201 |      reservedDynamic: new bytes(0)
 202 |  });

     |  // @audit-issue Replace literal 0 with an explicit constant
 198 |  signature: new bytes(0),

     |  // @audit-issue Replace literal 0 with an explicit constant
 200 |  paymasterInput: new bytes(0),

     |  // @audit-issue Replace literal 0 with an explicit constant
 201 |  reservedDynamic: new bytes(0)

     |  // @audit-issue Replace literal 0 with an explicit constant
 204 |  ProposedUpgrade memory proposedUpgrade = ProposedUpgrade({
 205 |      l2ProtocolUpgradeTx: l2ProtocolUpgradeTx,
 206 |      factoryDeps: bytesEmptyArray,
 207 |      bootloaderHash: bytes32(0),
 208 |      defaultAccountHash: bytes32(0),
 209 |      verifier: address(0),
 210 |      verifierParams: VerifierParams({
 211 |          recursionNodeLevelVkHash: bytes32(0),
 212 |          recursionLeafLevelVkHash: bytes32(0),
 213 |          recursionCircuitsSetVksHash: bytes32(0)
 214 |      }),
 215 |      l1ContractsUpgradeCalldata: new bytes(0),
 216 |      postUpgradeCalldata: new bytes(0),
 217 |      upgradeTimestamp: 0,
 218 |      newProtocolVersion: protocolVersion
 219 |  });

     |  // @audit-issue Replace literal 0 with an explicit constant
 215 |  l1ContractsUpgradeCalldata: new bytes(0),

     |  // @audit-issue Replace literal 0 with an explicit constant
 216 |  postUpgradeCalldata: new bytes(0),
```
GitHub: [92-101](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L92-L101), [184-202](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L184-L202), [198](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L198), [200](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L200), [201](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L201), [204-219](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L204-L219), [215](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L215), [216](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L216)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

     |  // @audit-issue Replace literal 0 with an explicit constant
  92 |  L2Log memory l2Log = L2Log({
  93 |      l2ShardId: 0,
  94 |      isService: true,
  95 |      txNumberInBatch: _l2TxNumberInBatch,
  96 |      sender: L2_BOOTLOADER_ADDRESS,
  97 |      key: _l2TxHash,
  98 |      value: bytes32(uint256(_status))
  99 |  });

     |  // @audit-issue Replace literal 0 with an explicit constant
 132 |  L2Log({
 133 |      l2ShardId: 0,
 134 |      isService: true,
 135 |      txNumberInBatch: _message.txNumberInBatch,
 136 |      sender: L2_TO_L1_MESSENGER_SYSTEM_CONTRACT_ADDR,
 137 |      key: bytes32(uint256(uint160(_message.sender))),
 138 |      value: keccak256(_message.data)
 139 |  });

     |  // @audit-issue Replace literal 0 with an explicit constant
 308 |  signature: new bytes(0),

     |  // @audit-issue Replace literal 0 with an explicit constant
 310 |  paymasterInput: new bytes(0),

     |  // @audit-issue Replace literal 0 with an explicit constant
 311 |  reservedDynamic: new bytes(0)
```
GitHub: [92-99](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L92-L99), [132-139](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L132-L139), [308](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L308), [310](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L310), [311](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L311)


```solidity
File: code/system-contracts/contracts/BootloaderUtilities.sol

     |  // @audit-issue Replace literal 0 with an explicit constant
 176 |  bytes memory encodedAccessListLength = RLPEncoder.encodeListLen(0);

     |  // @audit-issue Replace literal 0 with an explicit constant
 271 |  bytes memory encodedAccessListLength = RLPEncoder.encodeListLen(0);
```
GitHub: [176](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L176), [271](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L271)


```solidity
File: code/system-contracts/contracts/Compressor.sol

     |  // @audit-issue Replace literal 0 with an explicit constant
 121 |  uint256 numberOfInitialWrites = uint256(_compressedStateDiffs.readUint16(0));

     |  // @audit-issue Replace literal 0 with an explicit constant
 202 |  uint256 dictionaryLen = uint256(_rawCompressedData.readUint16(0));
```
GitHub: [121](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L121), [202](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L202)


```solidity
File: code/system-contracts/contracts/DefaultAccount.sol

     |  // @audit-issue Replace literal 0 with an explicit constant
  83 |  SystemContractsCaller.systemCallWithPropagatedRevert(
  84 |      uint32(gasleft()),
  85 |      address(NONCE_HOLDER_SYSTEM_CONTRACT),
  86 |      0,
  87 |      abi.encodeCall(INonceHolder.incrementMinNonceIfEquals, (_transaction.nonce))
  88 |  );
```
GitHub: [83-88](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L83-L88)


```solidity
File: code/system-contracts/contracts/L1Messenger.sol

     |  // @audit-issue Replace literal 0 with an explicit constant
  75 |  L2ToL1Log memory l2ToL1Log = L2ToL1Log({
  76 |      l2ShardId: 0,
  77 |      isService: _isService,
  78 |      txNumberInBlock: SYSTEM_CONTEXT_CONTRACT.txNumberInBlock(),
  79 |      sender: msg.sender,
  80 |      key: _key,
  81 |      value: _value
  82 |  });

     |  // @audit-issue Replace literal 0 with an explicit constant
  90 |  SystemContractHelper.burnGas(Utils.safeCastToU32(gasToPay), 0);

     |  // @audit-issue Replace literal 0 with an explicit constant
 125 |  L2ToL1Log memory l2ToL1Log = L2ToL1Log({
 126 |      l2ShardId: 0,
 127 |      isService: true,
 128 |      txNumberInBlock: SYSTEM_CONTEXT_CONTRACT.txNumberInBlock(),
 129 |      sender: address(this),
 130 |      key: bytes32(uint256(uint160(msg.sender))),
 131 |      value: hash
 132 |  });
```
GitHub: [75-82](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L75-L82), [90](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L90), [125-132](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L125-L132)


```solidity
File: code/system-contracts/contracts/MsgValueSimulator.sol

     |  // @audit-issue Replace literal 0 with an explicit constant
  26 |  value = SystemContractHelper.getExtraAbiData(0);
```
GitHub: [26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/MsgValueSimulator.sol#L26)


```solidity
File: code/system-contracts/contracts/libraries/EfficientCall.sol

     |  // @audit-issue Replace literal 0 with an explicit constant
 265 |  uint256 farCallAbi = SystemContractsCaller.getFarCallABIWithEmptyFatPointer(
 266 |      gas,
 267 |      // Only rollup is supported for now
 268 |      0,
 269 |      CalldataForwardingMode.ForwardFatPointer,
 270 |      _isConstructor,
 271 |      _isSystem
 272 |  );
```
GitHub: [265-272](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L265-L272)


```solidity
File: code/system-contracts/contracts/libraries/SystemContractHelper.sol

     |  // @audit-issue Replace literal 0 with an explicit constant
 345 |  bool precompileCallSuccess = unsafePrecompileCall(
 346 |      0, // The precompile parameters are formal ones. We only need the precompile call to burn gas.
 347 |      _gasToPay,
 348 |      _pubdataToSpend
 349 |  );
```
GitHub: [345-349](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L345-L349)


```solidity
File: code/system-contracts/contracts/libraries/SystemContractsCaller.sol

     |  // @audit-issue Replace literal 0 with an explicit constant
  85 |  uint256 farCallAbi = SystemContractsCaller.getFarCallABI(
  86 |      0,
  87 |      0,
  88 |      dataStart,
  89 |      dataLength,
  90 |      gasLimit,
  91 |      // Only rollup is supported for now
  92 |      0,
  93 |      CalldataForwardingMode.UseHeap,
  94 |      false,
  95 |      true
  96 |  );
```
GitHub: [85-96](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L85-L96)


```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

     |  // @audit-issue Replace literal 0 with an explicit constant
 261 |  bytes memory encodedAccessListLength = RLPEncoder.encodeListLen(0);

     |  // @audit-issue Replace literal 0 with an explicit constant
 333 |  bytes memory encodedAccessListLength = RLPEncoder.encodeListLen(0);

     |  // @audit-issue Replace literal 0 with an explicit constant
 382 |  IERC20(token).safeApprove(paymaster, 0);
```
GitHub: [261](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L261), [333](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L333), [382](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L382)


```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

     |  // @audit-issue Replace literal 0 with an explicit constant
 165 |  (bool success, bytes memory returndata) = SystemContractsCaller.systemCallWithReturndata(
 166 |      uint32(gasleft()),
 167 |      DEPLOYER_SYSTEM_CONTRACT,
 168 |      0,
 169 |      abi.encodeCall(
 170 |          IContractDeployer.create2,
 171 |          (salt, l2TokenProxyBytecodeHash, abi.encode(address(l2TokenBeacon), ""))
 172 |      )
 173 |  );
```
GitHub: [165-173](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L165-L173)


```solidity
File: code/contracts/zksync/contracts/SystemContractsCaller.sol

     |  // @audit-issue Replace literal 0 with an explicit constant
  46 |  uint256 farCallAbi = getFarCallABI(
  47 |      0,
  48 |      0,
  49 |      dataStart,
  50 |      dataLength,
  51 |      gasLimit,
  52 |      // Only rollup is supported for now
  53 |      0,
  54 |      CalldataForwardingMode.UseHeap,
  55 |      false,
  56 |      true
  57 |  );
```
GitHub: [46-57](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/SystemContractsCaller.sol#L46-L57)


## [N-19] Consider using named function arguments

Named function calls in Solidity greatly improve code readability by explicitly mapping arguments to their respective parameter names. This clarity becomes critical when dealing with functions that have numerous or complex parameters, reducing potential errors due to misordered arguments. Therefore, adopting named function calls contributes to more maintainable and less error-prone code. The following findings are for function calls with 4 or more praameters.

*Instances: 42*

```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

     |  // @audit-issue Consider named parameters
  79 |  return L2ContractHelper.computeCreate2Address(l2Bridge, salt, l2TokenProxyBytecodeHash, constructorInputHash);

     |  // @audit-issue Consider named parameters
 105 |  l2TxHash = deposit(_l2Receiver, _l1Token, _amount, _l2TxGasLimit, _l2TxGasPerPubdataByte, address(0));

     |  // @audit-issue Consider named parameters
 155 |  emit DepositInitiated(l2TxHash, msg.sender, _l2Receiver, _l1Token, _amount);

     |  // @audit-issue Consider named parameters
 189 |  sharedBridge.claimFailedDepositLegacyErc20Bridge(
 190 |      _depositSender,
 191 |      _l1Token,
 192 |      amount,
 193 |      _l2TxHash,
 194 |      _l2BatchNumber,
 195 |      _l2MessageIndex,
 196 |      _l2TxNumberInBatch,
 197 |      _merkleProof
 198 |  );

     |  // @audit-issue Consider named parameters
 218 |  (address l1Receiver, address l1Token, uint256 amount) = sharedBridge.finalizeWithdrawalLegacyErc20Bridge(
 219 |      _l2BatchNumber,
 220 |      _l2MessageIndex,
 221 |      _l2TxNumberInBatch,
 222 |      _message,
 223 |      _merkleProof
 224 |  );
```
GitHub: [79](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L79), [105](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L105), [155](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L155), [189-198](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L189-L198), [218-224](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L218-L224)


```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

     |  // @audit-issue Consider named parameters
 168 |  emit BridgehubDepositBaseTokenInitiated(_chainId, _prevMsgSender, _l1Token, _amount);

     |  // @audit-issue Consider named parameters
 217 |  bytes memory l2TxCalldata = _getDepositL2Calldata(_prevMsgSender, _l2Receiver, _l1Token, amount);

     |  // @audit-issue Consider named parameters
 227 |  emit BridgehubDepositInitiated(_chainId, txDataHash, _prevMsgSender, _l2Receiver, _l1Token, amount);

     |  // @audit-issue Consider named parameters
 288 |  _claimFailedDeposit(
 289 |      false,
 290 |      _chainId,
 291 |      _depositSender,
 292 |      _l1Token,
 293 |      _amount,
 294 |      _l2TxHash,
 295 |      _l2BatchNumber,
 296 |      _l2MessageIndex,
 297 |      _l2TxNumberInBatch,
 298 |      _merkleProof
 299 |  );

     |  // @audit-issue Consider named parameters
 316 |  bool proofValid = bridgehub.proveL1ToL2TransactionStatus(
 317 |      _chainId,
 318 |      _l2TxHash,
 319 |      _l2BatchNumber,
 320 |      _l2MessageIndex,
 321 |      _l2TxNumberInBatch,
 322 |      _merkleProof,
 323 |      TxStatus.Failure
 324 |  );

     |  // @audit-issue Consider named parameters
 367 |  emit ClaimedFailedDepositSharedBridge(_chainId, _depositSender, _l1Token, _amount);

     |  // @audit-issue Consider named parameters
 398 |  _finalizeWithdrawal(_chainId, _l2BatchNumber, _l2MessageIndex, _l2TxNumberInBatch, _message, _merkleProof);

     |  // @audit-issue Consider named parameters
 435 |  (l1Receiver, l1Token, amount) = _checkWithdrawal(_chainId, messageParams, _message, _merkleProof);

     |  // @audit-issue Consider named parameters
 454 |  emit WithdrawalFinalizedSharedBridge(_chainId, l1Receiver, l1Token, amount);

     |  // @audit-issue Consider named parameters
 477 |  bool success = bridgehub.proveL2MessageInclusion(
 478 |      _chainId,
 479 |      _messageParams.l2BatchNumber,
 480 |      _messageParams.l2MessageIndex,
 481 |      l2ToL1Message,
 482 |      _merkleProof
 483 |  );

     |  // @audit-issue Consider named parameters
 571 |  bytes memory l2TxCalldata = _getDepositL2Calldata(_prevMsgSender, _l2Receiver, _l1Token, _amount);

     |  // @audit-issue Consider named parameters
 602 |  emit LegacyDepositInitiated(ERA_CHAIN_ID, l2TxHash, _prevMsgSender, _l2Receiver, _l1Token, _amount);

     |  // @audit-issue Consider named parameters
 622 |  (l1Receiver, l1Token, amount) = _finalizeWithdrawal(
 623 |      ERA_CHAIN_ID,
 624 |      _l2BatchNumber,
 625 |      _l2MessageIndex,
 626 |      _l2TxNumberInBatch,
 627 |      _message,
 628 |      _merkleProof
 629 |  );

     |  // @audit-issue Consider named parameters
 654 |  _claimFailedDeposit(
 655 |      true,
 656 |      ERA_CHAIN_ID,
 657 |      _depositSender,
 658 |      _l1Token,
 659 |      _amount,
 660 |      _l2TxHash,
 661 |      _l2BatchNumber,
 662 |      _l2MessageIndex,
 663 |      _l2TxNumberInBatch,
 664 |      _merkleProof
 665 |  );
```
GitHub: [168](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L168), [217](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L217), [227](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L227), [288-299](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L288-L299), [316-324](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L316-L324), [367](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L367), [398](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L398), [435](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L435), [454](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L454), [477-483](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L477-L483), [571](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L571), [602](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L602), [622-629](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L622-L629), [654-665](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L654-L665)


```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

     |  // @audit-issue Consider named parameters
 137 |  IStateTransitionManager(_stateTransitionManager).createNewChain(
 138 |      _chainId,
 139 |      _baseToken,
 140 |      address(sharedBridge),
 141 |      _admin,
 142 |      _initData
 143 |  );

     |  // @audit-issue Consider named parameters
 160 |  return IZkSyncStateTransition(stateTransition).proveL2MessageInclusion(_batchNumber, _index, _message, _proof);

     |  // @audit-issue Consider named parameters
 172 |  return IZkSyncStateTransition(stateTransition).proveL2LogInclusion(_batchNumber, _index, _log, _proof);

     |  // @audit-issue Consider named parameters
 187 |  IZkSyncStateTransition(stateTransition).proveL1ToL2TransactionStatus(
 188 |      _l2TxHash,
 189 |      _l2BatchNumber,
 190 |      _l2MessageIndex,
 191 |      _l2TxNumberInBatch,
 192 |      _merkleProof,
 193 |      _status
 194 |  );
```
GitHub: [137-143](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L137-L143), [160](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L160), [172](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L172), [187-194](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L187-L194)


```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

     |  // @audit-issue Consider named parameters
  92 |  IExecutor.StoredBatchInfo memory batchZero = IExecutor.StoredBatchInfo(
  93 |      0,
  94 |      _initializeData.genesisBatchHash,
  95 |      _initializeData.genesisIndexRepeatedStorageChanges,
  96 |      0,
  97 |      EMPTY_STRING_KECCAK,
  98 |      DEFAULT_L2_LOGS_TREE_ROOT_HASH,
  99 |      0,
 100 |      _initializeData.genesisBatchCommitment
 101 |  );

     |  // @audit-issue Consider named parameters
 263 |  initData = bytes.concat(
 264 |      IDiamondInit.initialize.selector,
 265 |      bytes32(_chainId),
 266 |      bytes32(uint256(uint160(bridgehub))),
 267 |      bytes32(uint256(uint160(address(this)))),
 268 |      bytes32(uint256(protocolVersion)),
 269 |      bytes32(uint256(uint160(_admin))),
 270 |      bytes32(uint256(uint160(validatorTimelock))),
 271 |      bytes32(uint256(uint160(_baseToken))),
 272 |      bytes32(uint256(uint160(_sharedBridge))),
 273 |      bytes32(storedBatchZero),
 274 |      diamondCut.initCalldata
 275 |  );
```
GitHub: [92-101](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L92-L101), [263-275](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L263-L275)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol

     |  // @audit-issue Consider named parameters
  86 |  emit NewBaseTokenMultiplier(oldNominator, oldDenominator, _nominator, _denominator);
```
GitHub: [86](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L86)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

     |  // @audit-issue Consider named parameters
  84 |  bytes32 commitment = _createBatchCommitment(_newBatch, logOutput.stateDiffHash, blobCommitments, blobHashes);

     |  // @audit-issue Consider named parameters
  87 |  StoredBatchInfo(
  88 |      _newBatch.batchNumber,
  89 |      _newBatch.newStateRoot,
  90 |      _newBatch.indexRepeatedStorageChanges,
  91 |      _newBatch.numberOfLayer1Txs,
  92 |      _newBatch.priorityOperationsHash,
  93 |      logOutput.l2LogsTreeRoot,
  94 |      _newBatch.timestamp,
  95 |      commitment
  96 |  );

     |  // @audit-issue Consider named parameters
 461 |  abi.encodePacked(
 462 |      _prevBatchCommitment,
 463 |      _currentBatchCommitment,
 464 |      _verifierParams.recursionNodeLevelVkHash,
 465 |      _verifierParams.recursionLeafLevelVkHash
 466 |  )

     |  // @audit-issue Consider named parameters
 509 |  _batchAuxiliaryOutput(_newBatchData, _stateDiffHash, _blobCommitments, _blobHashes)

     |  // @audit-issue Consider named parameters
 517 |  abi.encodePacked(
 518 |      _batch.indexRepeatedStorageChanges,
 519 |      _batch.newStateRoot,
 520 |      uint64(0), // index repeated storage changes in zkPorter
 521 |      bytes32(0) // zkPorter batch hash
 522 |  );

     |  // @audit-issue Consider named parameters
 528 |  abi.encodePacked(
 529 |      s.zkPorterIsAvailable,
 530 |      s.l2BootloaderBytecodeHash,
 531 |      l2DefaultAccountBytecodeHash,
 532 |      // VM 1.5.0 requires us to pass the EVM simulator code hash. For now it is the same as the default account.
 533 |      l2DefaultAccountBytecodeHash
 534 |  );

     |  // @audit-issue Consider named parameters
 548 |  abi.encodePacked(
 549 |      l2ToL1LogsHash,
 550 |      _stateDiffHash,
 551 |      _batch.bootloaderHeapInitialContentsHash,
 552 |      _batch.eventsQueueStateHash,
 553 |      _encodeBlobAuxilaryOutput(_blobCommitments, _blobHashes)
 554 |  );
```
GitHub: [84](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L84), [87-96](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L87-L96), [461-466](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L461-L466), [509](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L509), [517-522](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L517-L522), [528-534](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L528-L534), [548-554](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L548-L554)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

     |  // @audit-issue Consider named parameters
  60 |  return _proveL2LogInclusion(_batchNumber, _index, _L2MessageToLog(_message), _proof);

     |  // @audit-issue Consider named parameters
  70 |  return _proveL2LogInclusion(_batchNumber, _index, _log, _proof);

     |  // @audit-issue Consider named parameters
 100 |  return _proveL2LogInclusion(_l2BatchNumber, _l2MessageIndex, l2Log, _merkleProof);

     |  // @audit-issue Consider named parameters
 113 |  abi.encodePacked(_log.l2ShardId, _log.isService, _log.txNumberInBatch, _log.sender, _log.key, _log.value)

     |  // @audit-issue Consider named parameters
 186 |  IL1SharedBridge(s.baseTokenBridge).finalizeWithdrawal(
 187 |      ERA_CHAIN_ID,
 188 |      _l2BatchNumber,
 189 |      _l2MessageIndex,
 190 |      _l2TxNumberInBatch,
 191 |      _message,
 192 |      _merkleProof
 193 |  );

     |  // @audit-issue Consider named parameters
 255 |  canonicalTxHash = _requestL2Transaction(_request.mintValue, params, _request.l2Calldata, _request.factoryDeps);

     |  // @audit-issue Consider named parameters
 325 |  TransactionValidator.validateL1ToL2Transaction(
 326 |      transaction,
 327 |      transactionEncoding,
 328 |      s.priorityTxMaxGasLimit,
 329 |      s.feeParams.priorityTxMaxPubdata
 330 |  );

     |  // @audit-issue Consider named parameters
 343 |  emit NewPriorityRequest(
 344 |      _priorityOpParams.txId,
 345 |      canonicalTxHash,
 346 |      _priorityOpParams.expirationTimestamp,
 347 |      transaction,
 348 |      _factoryDeps
 349 |  );
```
GitHub: [60](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L60), [70](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L70), [100](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L100), [113](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L113), [186-193](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L186-L193), [255](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L255), [325-330](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L325-L330), [343-349](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L343-L349)


```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol

     |  // @audit-issue Consider named parameters
 194 |  TransactionValidator.validateL1ToL2Transaction(
 195 |      _l2ProtocolUpgradeTx,
 196 |      encodedTransaction,
 197 |      s.priorityTxMaxGasLimit,
 198 |      s.feeParams.priorityTxMaxPubdata
 199 |  );
```
GitHub: [194-199](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L194-L199)


## [N-20] Consider using named mappings

Consider using [named mappings](https://ethereum.stackexchange.com/a/145555) to make it easier to understand the purpose of each mapping (requires Solidity 0.8.18 or later).

*Instances: 21*

```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

     |  // @audit-issue Name the key/value in this mapping
  27 |  mapping(uint256 l2BatchNumber => mapping(uint256 l2ToL1MessageNumber => bool isFinalized))
  28 |      public isWithdrawalFinalized;

     |  // @audit-issue Name the key/value in this mapping
  32 |  mapping(address account => mapping(address l1Token => mapping(bytes32 depositL2TxHash => uint256 amount)))
  33 |      public depositAmount;

     |  // @audit-issue Name the key/value in this mapping
  45 |  mapping(address => uint256) private __DEPRECATED_lastWithdrawalLimitReset;

     |  // @audit-issue Name the key/value in this mapping
  48 |  mapping(address => uint256) private __DEPRECATED_withdrawnAmountInWindow;

     |  // @audit-issue Name the key/value in this mapping
  51 |  mapping(address => mapping(address => uint256)) private __DEPRECATED_totalDepositedAmountPerUser;
```
GitHub: [27-28](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L27-L28), [32-33](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L32-L33), [45](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L45), [48](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L48), [51](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L51)


```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

     |  // @audit-issue Name the key/value in this mapping
  52 |  mapping(uint256 chainId => mapping(bytes32 l2DepositTxHash => bytes32 depositDataHash))
  53 |      public
  54 |      override depositHappened;

     |  // @audit-issue Name the key/value in this mapping
  57 |  mapping(uint256 chainId => mapping(uint256 l2BatchNumber => mapping(uint256 l2ToL1MessageNumber => bool isFinalized)))
  58 |      public isWithdrawalFinalized;

     |  // @audit-issue Name the key/value in this mapping
  65 |  mapping(uint256 chainId => mapping(address l1Token => uint256 balance)) internal chainBalance;
```
GitHub: [52-54](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L52-L54), [57-58](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L57-L58), [65](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L65)


```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

     |  // @audit-issue Name the key/value in this mapping
  21 |  mapping(address _stateTransitionManager => bool) public stateTransitionManagerIsRegistered;

     |  // @audit-issue Name the key/value in this mapping
  23 |  mapping(address _token => bool) public tokenIsRegistered;

     |  // @audit-issue Name the key/value in this mapping
  26 |  mapping(uint256 _chainId => address) public stateTransitionManager;

     |  // @audit-issue Name the key/value in this mapping
  29 |  mapping(uint256 _chainId => address) public baseToken;
```
GitHub: [21](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L21), [23](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L23), [26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L26), [29](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L29)


```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

     |  // @audit-issue Name the key/value in this mapping
  32 |  mapping(uint256 => address) public stateTransition;

     |  // @audit-issue Name the key/value in this mapping
  50 |  mapping(uint256 => bytes32) public upgradeCutHash;
```
GitHub: [32](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L32), [50](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L50)


```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

     |  // @audit-issue Name the key/value in this mapping
  47 |  mapping(uint256 => LibMap.Uint32Map) internal committedBatchTimestamp;

     |  // @audit-issue Name the key/value in this mapping
  50 |  mapping(uint256 _chainId => mapping(address _validator => bool)) public validators;
```
GitHub: [47](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L47), [50](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L50)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol

     |  // @audit-issue Name the key/value in this mapping
 114 |  mapping(uint256 l2BatchNumber => mapping(uint256 l2ToL1MessageNumber => bool isFinalized)) isEthWithdrawalFinalized;

     |  // @audit-issue Name the key/value in this mapping
 120 |  mapping(address => uint256) __DEPRECATED_totalDepositedAmountPerUser;
```
GitHub: [114](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L114), [120](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L120)


```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

     |  // @audit-issue Name the key/value in this mapping
  26 |  mapping(address => AccountInfo) internal accountInfo;
```
GitHub: [26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L26)


```solidity
File: code/system-contracts/contracts/ImmutableSimulator.sol

     |  // @audit-issue Name the key/value in this mapping
  21 |  mapping(uint256 contractAddress => mapping(uint256 index => bytes32 value)) internal immutableDataStorage;
```
GitHub: [21](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ImmutableSimulator.sol#L21)


```solidity
File: code/system-contracts/contracts/NonceHolder.sol

     |  // @audit-issue Name the key/value in this mapping
  41 |  mapping(uint256 account => mapping(uint256 nonceKey => uint256 value)) internal nonceValues;
```
GitHub: [41](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/NonceHolder.sol#L41)


## [N-21] Consider using the `using`-`for` syntax

The `using`-`for` [syntax](https://docs.soliditylang.org/en/latest/contracts.html#using-for) is the more common way of calling library functions.

*Instances: 99*

```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

  79 |  return L2ContractHelper.computeCreate2Address(l2Bridge, salt, l2TokenProxyBytecodeHash, constructorInputHash);
```
GitHub: [79](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L79)


```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

 503 |  (uint32 functionSignature, uint256 offset) = UnsafeBytes.readUint32(_l2ToL1message, 0);

 506 |  (l1Receiver, offset) = UnsafeBytes.readAddress(_l2ToL1message, offset);

 507 |  (amount, offset) = UnsafeBytes.readUint256(_l2ToL1message, offset);

 518 |  (l1Receiver, offset) = UnsafeBytes.readAddress(_l2ToL1message, offset);

 519 |  (l1Token, offset) = UnsafeBytes.readAddress(_l2ToL1message, offset);

 520 |  (amount, offset) = UnsafeBytes.readUint256(_l2ToL1message, offset);

 580 |  ? AddressAliasHelper.applyL1ToL2Alias(_prevMsgSender)
```
GitHub: [503](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L503), [506](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L506), [507](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L507), [518](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L518), [519](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L519), [520](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L520), [580](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L580)


```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

 328 |  _recipient = msg.sender == tx.origin ? msg.sender : AddressAliasHelper.applyL1ToL2Alias(msg.sender);

 331 |  _recipient = AddressAliasHelper.applyL1ToL2Alias(_refundRecipient);
```
GitHub: [328](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L328), [331](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L331)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol

  15 |  Diamond.diamondCut(_diamondCut);

  21 |  Diamond.DiamondStorage storage diamondStorage = Diamond.getDiamondStorage();
```
GitHub: [15](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol#L15), [21](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol#L21)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol

 114 |  Diamond.diamondCut(_diamondCut);

 124 |  Diamond.diamondCut(_diamondCut);

 134 |  Diamond.DiamondStorage storage diamondStorage = Diamond.getDiamondStorage();

 144 |  Diamond.DiamondStorage storage diamondStorage = Diamond.getDiamondStorage();
```
GitHub: [114](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L114), [124](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L124), [134](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L134), [144](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L144)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

 144 |  (address logSender, ) = UnsafeBytes.readAddress(emittedL2Logs, i + L2_LOG_ADDRESS_OFFSET);

 145 |  (uint256 logKey, ) = UnsafeBytes.readUint256(emittedL2Logs, i + L2_LOG_KEY_OFFSET);

 146 |  (bytes32 logValue, ) = UnsafeBytes.readBytes32(emittedL2Logs, i + L2_LOG_VALUE_OFFSET);
```
GitHub: [144](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L144), [145](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L145), [146](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L146)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol

 158 |  Diamond.DiamondStorage storage ds = Diamond.getDiamondStorage();

 164 |  Diamond.DiamondStorage storage ds = Diamond.getDiamondStorage();

 182 |  Diamond.DiamondStorage storage ds = Diamond.getDiamondStorage();

 203 |  Diamond.DiamondStorage storage ds = Diamond.getDiamondStorage();

 218 |  Diamond.DiamondStorage storage ds = Diamond.getDiamondStorage();

 224 |  Diamond.DiamondStorage storage ds = Diamond.getDiamondStorage();

 230 |  Diamond.DiamondStorage storage ds = Diamond.getDiamondStorage();
```
GitHub: [158](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L158), [164](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L164), [182](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L182), [203](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L203), [218](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L218), [224](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L224), [230](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L230)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

 123 |  bytes32 calculatedRootHash = Merkle.calculateRoot(_proof, _index, hashedLog);

 174 |  return Math.max(l2GasPrice, minL2GasPriceBaseToken);

 235 |  l2Sender = AddressAliasHelper.applyL1ToL2Alias(_request.sender);

 278 |  refundRecipient = AddressAliasHelper.applyL1ToL2Alias(refundRecipient);

 325 |  TransactionValidator.validateL1ToL2Transaction(
 326 |      transaction,
 327 |      transactionEncoding,
 328 |      s.priorityTxMaxGasLimit,
 329 |      s.feeParams.priorityTxMaxPubdata
 330 |  );

 357 |  bytes32 hashedBytecode = L2ContractHelper.hashL2Bytecode(_factoryDeps[i]);
```
GitHub: [123](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L123), [174](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L174), [235](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L235), [278](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L278), [325-330](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L325-L330), [357](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L357)


```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol

  97 |  L2ContractHelper.validateBytecodeHash(_l2DefaultAccountBytecodeHash);

 114 |  L2ContractHelper.validateBytecodeHash(_l2BootloaderBytecodeHash);

 194 |  TransactionValidator.validateL1ToL2Transaction(
 195 |      _l2ProtocolUpgradeTx,
 196 |      encodedTransaction,
 197 |      s.priorityTxMaxGasLimit,
 198 |      s.feeParams.priorityTxMaxPubdata
 199 |  );

 201 |  TransactionValidator.validateUpgradeTransaction(_l2ProtocolUpgradeTx);

 228 |  L2ContractHelper.hashL2Bytecode(_factoryDeps[i]) == bytes32(_expectedHashes[i]),
```
GitHub: [97](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L97), [114](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L114), [194-199](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L194-L199), [201](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L201), [228](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L228)


```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol

  83 |  costForComputation += Math.ceilDiv(_encodingLength * L1_TX_DELTA_544_ENCODING_BYTES, 544);

  89 |  costForComputation = Math.max(costForComputation, L1_TX_MIN_L2_GAS_BASE);

 136 |  batchOverheadForTransaction = Math.max(batchOverheadForTransaction, overheadForLength);
```
GitHub: [83](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L83), [89](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L89), [136](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L136)


```solidity
File: code/system-contracts/contracts/AccountCodeStorage.sol

  37 |  require(Utils.isContractConstructing(_hash), "Code hash is not for a contract on constructor");

  48 |  require(Utils.isContractConstructed(_hash), "Code hash is not for a constructed contract");

  57 |  require(Utils.isContractConstructing(codeHash), "Code hash is not for a contract on constructor");

  60 |  bytes32 constructedBytecodeHash = Utils.constructedBytecodeHash(codeHash);

 107 |  else if (Utils.isContractConstructing(codeHash)) {

 134 |  !Utils.isContractConstructing(codeHash)

 136 |  codeSize = Utils.bytecodeLenInBytes(codeHash);
```
GitHub: [37](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L37), [48](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L48), [57](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L57), [60](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L60), [107](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L107), [134](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L134), [136](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L136)


```solidity
File: code/system-contracts/contracts/BootloaderUtilities.sol

  29 |  txHash = keccak256(bytes.concat(signedTxHash, EfficientCall.keccak(_transaction.signature)));

  52 |  bytes memory encodedNonce = RLPEncoder.encodeUint256(_transaction.nonce);

  56 |  bytes memory encodedGasPrice = RLPEncoder.encodeUint256(_transaction.maxFeePerGas);

  57 |  bytes memory encodedGasLimit = RLPEncoder.encodeUint256(_transaction.gasLimit);

  61 |  bytes memory encodedTo = RLPEncoder.encodeAddress(address(uint160(_transaction.to)));

  62 |  bytes memory encodedValue = RLPEncoder.encodeUint256(_transaction.value);

  71 |  encodedDataLength = RLPEncoder.encodeNonSingleBytesLen(txDataLen);

  82 |  rEncoded = RLPEncoder.encodeUint256(rInt);

  87 |  sEncoded = RLPEncoder.encodeUint256(sInt);

 100 |  vEncoded = RLPEncoder.encodeUint256(vInt);

 116 |  encodedListLength = RLPEncoder.encodeListLen(uint64(listLength));

 143 |  bytes memory encodedChainId = RLPEncoder.encodeUint256(block.chainid);

 144 |  bytes memory encodedNonce = RLPEncoder.encodeUint256(_transaction.nonce);

 145 |  bytes memory encodedGasPrice = RLPEncoder.encodeUint256(_transaction.maxFeePerGas);

 146 |  bytes memory encodedGasLimit = RLPEncoder.encodeUint256(_transaction.gasLimit);

 147 |  bytes memory encodedTo = RLPEncoder.encodeAddress(address(uint160(_transaction.to)));

 148 |  bytes memory encodedValue = RLPEncoder.encodeUint256(_transaction.value);

 167 |  encodedDataLength = RLPEncoder.encodeNonSingleBytesLen(txDataLen);

 176 |  bytes memory encodedAccessListLength = RLPEncoder.encodeListLen(0);

 181 |  rEncoded = RLPEncoder.encodeUint256(rInt);

 186 |  sEncoded = RLPEncoder.encodeUint256(sInt);

 193 |  vEncoded = RLPEncoder.encodeUint256(vInt - 27);

 207 |  encodedListLength = RLPEncoder.encodeListLen(uint64(listLength));

 236 |  bytes memory encodedChainId = RLPEncoder.encodeUint256(block.chainid);

 237 |  bytes memory encodedNonce = RLPEncoder.encodeUint256(_transaction.nonce);

 238 |  bytes memory encodedMaxPriorityFeePerGas = RLPEncoder.encodeUint256(_transaction.maxPriorityFeePerGas);

 239 |  bytes memory encodedMaxFeePerGas = RLPEncoder.encodeUint256(_transaction.maxFeePerGas);

 240 |  bytes memory encodedGasLimit = RLPEncoder.encodeUint256(_transaction.gasLimit);

 241 |  bytes memory encodedTo = RLPEncoder.encodeAddress(address(uint160(_transaction.to)));

 242 |  bytes memory encodedValue = RLPEncoder.encodeUint256(_transaction.value);

 262 |  encodedDataLength = RLPEncoder.encodeNonSingleBytesLen(txDataLen);

 271 |  bytes memory encodedAccessListLength = RLPEncoder.encodeListLen(0);

 276 |  rEncoded = RLPEncoder.encodeUint256(rInt);

 281 |  sEncoded = RLPEncoder.encodeUint256(sInt);

 288 |  vEncoded = RLPEncoder.encodeUint256(vInt - 27);

 302 |  encodedListLength = RLPEncoder.encodeListLen(uint64(listLength));
```
GitHub: [29](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L29), [52](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L52), [56](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L56), [57](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L57), [61](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L61), [62](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L62), [71](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L71), [82](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L82), [87](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L87), [100](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L100), [116](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L116), [143](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L143), [144](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L144), [145](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L145), [146](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L146), [147](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L147), [148](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L148), [167](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L167), [176](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L176), [181](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L181), [186](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L186), [193](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L193), [207](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L207), [236](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L236), [237](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L237), [238](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L238), [239](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L239), [240](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L240), [241](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L241), [242](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L242), [262](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L262), [271](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L271), [276](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L276), [281](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L281), [288](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L288), [302](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L302)


```solidity
File: code/system-contracts/contracts/Compressor.sol

  72 |  bytecodeHash = Utils.hashL2Bytecode(_bytecode);

 189 |  stateDiffHash = EfficientCall.keccak(_stateDiffs);
```
GitHub: [72](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L72), [189](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L189)


```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

 103 |  bytes32 constructorInputHash = EfficientCall.keccak(_input);

 311 |  bytes32 constructingBytecodeHash = Utils.constructingBytecodeHash(_bytecodeHash);

 341 |  SystemContractHelper.setValueForNextFarCall(uint128(value));

 343 |  bytes memory returnData = EfficientCall.mimicCall(gasleft(), _newAddress, _input, _sender, true, _isSystem);
```
GitHub: [103](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L103), [311](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L311), [341](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L341), [343](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L343)


```solidity
File: code/system-contracts/contracts/DefaultAccount.sol

  46 |  address codeAddress = SystemContractHelper.getCodeAddress();

  83 |  SystemContractsCaller.systemCallWithPropagatedRevert(
  84 |      uint32(gasleft()),
  85 |      address(NONCE_HOLDER_SYSTEM_CONTRACT),
  86 |      0,
  87 |      abi.encodeCall(INonceHolder.incrementMinNonceIfEquals, (_transaction.nonce))
  88 |  );

 133 |  uint128 value = Utils.safeCastToU128(_transaction.value);

 135 |  uint32 gas = Utils.safeCastToU32(gasleft());

 149 |  bool success = EfficientCall.rawCall(gas, to, value, data, isSystemCall);

 151 |  EfficientCall.propagateRevert();
```
GitHub: [46](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L46), [83-88](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L83-L88), [133](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L133), [135](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L135), [149](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L149), [151](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L151)


```solidity
File: code/system-contracts/contracts/KnownCodesStorage.sol

  78 |  require(Utils.bytecodeLenInWords(_bytecodeHash) % 2 == 1, "Code length in words must be odd");
```
GitHub: [78](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/KnownCodesStorage.sol#L78)


```solidity
File: code/system-contracts/contracts/L1Messenger.sol

  90 |  SystemContractHelper.burnGas(Utils.safeCastToU32(gasToPay), 0);

  90 |  SystemContractHelper.burnGas(Utils.safeCastToU32(gasToPay), 0);

 118 |  hash = EfficientCall.keccak(_message);
```
GitHub: [90](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L90), [90](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L90), [118](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L118)


## [N-22] Constructor / initialization function lacks parameter validation

Constructors and initialization functions play a critical role in contracts by setting important initial states when the contract is first deployed before the system starts. The parameters passed to the constructor and initialization functions directly affect the behavior of the contract / protocol. If incorrect parameters are provided, the system may fail to run, behave abnormally, be unstable, or lack security. Therefore, it's crucial to carefully check each parameter in the constructor and initialization functions. If an exception is found, the transaction should be rolled back.

*Instances: 7*

```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

     |  // @audit-issue `_sharedBridge` is assigned to a state variable, unvalidated
  55 |  constructor(IL1SharedBridge _sharedBridge) reentrancyGuardInitializer {
```
GitHub: [55](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L55)


```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

     |  // @audit-issue `_l1WethAddress` is assigned to a state variable, unvalidated
     |  // `_bridgehub` is assigned to a state variable, unvalidated
     |  // `_legacyBridge` is assigned to a state variable, unvalidated
  90 |  constructor(
  91 |      address _l1WethAddress,
  92 |      IBridgehub _bridgehub,
  93 |      IL1ERC20Bridge _legacyBridge
  94 |  ) reentrancyGuardInitializer {

     |  // @audit-issue `_eraFirstPostUpgradeBatch` is assigned to a state variable, unvalidated
 104 |  function initialize(
 105 |      address _owner,
 106 |      uint256 _eraFirstPostUpgradeBatch
 107 |  ) external reentrancyGuardInitializer initializer {
```
GitHub: [90-94](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L90-L94), [104-107](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L104-L107)


```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

     |  // @audit-issue `_securityCouncil` is assigned to a state variable, unvalidated
     |  // `_minDelay` is assigned to a state variable, unvalidated
  41 |  constructor(address _admin, address _securityCouncil, uint256 _minDelay) {
```
GitHub: [41](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L41)


```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

     |  // @audit-issue `_bridgehub` is assigned to a state variable, unvalidated
  60 |  constructor(address _bridgehub) reentrancyGuardInitializer {
```
GitHub: [60](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L60)


```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

     |  // @audit-issue `_executionDelay` is assigned to a state variable, unvalidated
  55 |  constructor(address _initialOwner, uint32 _executionDelay) {
```
GitHub: [55](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L55)


```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

     |  // @audit-issue `_l1Bridge` is assigned to a state variable, unvalidated
     |  // `_l2TokenProxyBytecodeHash` is assigned to a state variable, unvalidated
  49 |  function initialize(
  50 |      address _l1Bridge,
  51 |      address _l1LegecyBridge,
  52 |      bytes32 _l2TokenProxyBytecodeHash,
  53 |      address _aliasedOwner
  54 |  ) external reinitializer(2) {
```
GitHub: [49-54](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L49-L54)


## [N-23] Contract order does not follow Solidity style guide recommendations

This is a [best practice](https://docs.soliditylang.org/en/latest/style-guide.html#order-of-layout) that should be followed.

Inside each contract, library or interface, use the following order:

> 1. Type declarations
> 2. State variables
> 3. Events
> 4. Errors
> 5. Modifiers
> 6. Functions

Note that the recommendations here only cover the top-level ordering. Within, e.g. variables and functions, additional ordering rules will apply, but are covered by other findings.

*Instances: 21*

```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

     |  // @audit-info Contract component order has style violations; recommended top-level order:
     |  // using SafeERC20 for IERC20;
     |  // struct MessageParams
     |  // variable l1WethAddress
     |  // variable bridgehub
     |  // variable legacyBridge
     |  // variable eraFirstPostUpgradeBatch
     |  // variable l2BridgeAddress
     |  // variable depositHappened
     |  // variable isWithdrawalFinalized
     |  // variable hyperbridgingEnabled
     |  // variable chainBalance
     |  // modifier onlyBridgehub
     |  // modifier onlyBridgehubOrEra
     |  // modifier onlyLegacyBridge
     |  // constructor
     |  // function initialize
     |  // function transferFundsFromLegacy
     |  // function receiveEth
     |  // function initializeChainGovernance
     |  // function bridgehubDepositBaseToken
     |  // function _depositFunds
     |  // function bridgehubDeposit
     |  // function bridgehubConfirmL2Transaction
     |  // function _getDepositL2Calldata
     |  // function _getERC20Getters
     |  // function claimFailedDeposit
     |  // function _claimFailedDeposit
     |  // function _isEraLegacyWithdrawal
     |  // function finalizeWithdrawal
     |  // function _finalizeWithdrawal
     |  // function _checkWithdrawal
     |  // function _parseL2WithdrawalMessage
     |  // function depositLegacyErc20Bridge
     |  // function finalizeWithdrawalLegacyErc20Bridge
     |  // function claimFailedDepositLegacyErc20Bridge
  30 |  contract L1SharedBridge is IL1SharedBridge, ReentrancyGuard, Initializable, Ownable2Step {
  :  |
     |      // @audit-issue struct MessageParams should come before function finalizeWithdrawal
 401 |      struct MessageParams {
 402 |          uint256 l2BatchNumber;
 403 |          uint256 l2MessageIndex;
 404 |          uint16 l2TxNumberInBatch;
 405 |      }
```
GitHub: [401-405](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L401-L405)


```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

     |  // @audit-info Contract component order has style violations; recommended top-level order:
     |  // variable sharedBridge
     |  // variable stateTransitionManagerIsRegistered
     |  // variable tokenIsRegistered
     |  // variable stateTransitionManager
     |  // variable baseToken
     |  // variable admin
     |  // variable pendingAdmin
     |  // modifier onlyOwnerOrAdmin
     |  // constructor
     |  // function initialize
     |  // function setPendingAdmin
     |  // function acceptAdmin
     |  // function getStateTransition
     |  // function addStateTransitionManager
     |  // function removeStateTransitionManager
     |  // function addToken
     |  // function setSharedBridge
     |  // function createNewChain
     |  // function proveL2MessageInclusion
     |  // function proveL2LogInclusion
     |  // function proveL1ToL2TransactionStatus
     |  // function l2TransactionBaseCost
     |  // function requestL2TransactionDirect
     |  // function requestL2TransactionTwoBridges
     |  // function _actualRefundRecipient
  16 |  contract Bridgehub is IBridgehub, ReentrancyGuard, Ownable2Step {
  :  |
     |      // @audit-issue modifier onlyOwnerOrAdmin should come before function initialize
  45 |      modifier onlyOwnerOrAdmin() {
  46 |          require(msg.sender == admin || msg.sender == owner(), "Bridgehub: not owner or admin");
  47 |          _;
  48 |      }
```
GitHub: [45-48](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L45-L48)


```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

     |  // @audit-info Contract component order has style violations; recommended top-level order:
     |  // variable EXECUTED_PROPOSAL_TIMESTAMP
     |  // variable securityCouncil
     |  // variable timestamps
     |  // variable minDelay
     |  // modifier onlySelf
     |  // modifier onlySecurityCouncil
     |  // modifier onlyOwnerOrSecurityCouncil
     |  // constructor
     |  // function isOperation
     |  // function isOperationPending
     |  // function isOperationReady
     |  // function isOperationDone
     |  // function getOperationState
     |  // function scheduleTransparent
     |  // function scheduleShadow
     |  // function cancel
     |  // function execute
     |  // function executeInstant
     |  // function hashOperation
     |  // function _schedule
     |  // function _execute
     |  // function _checkPredecessorDone
     |  // function updateDelay
     |  // function updateSecurityCouncil
     |  // function 
  20 |  contract Governance is IGovernance, Ownable2Step {
  :  |
     |      // @audit-issue modifier onlySelf should come before constructor
  58 |      modifier onlySelf() {
  59 |          require(msg.sender == address(this), "Only governance contract itself is allowed to call this function");
  60 |          _;
  61 |      }
```
GitHub: [58-61](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L58-L61)


```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

     |  // @audit-info Contract component order has style violations; recommended top-level order:
     |  // variable bridgehub
     |  // variable stateTransition
     |  // variable storedBatchZero
     |  // variable initialCutHash
     |  // variable genesisUpgrade
     |  // variable protocolVersion
     |  // variable validatorTimelock
     |  // variable upgradeCutHash
     |  // variable admin
     |  // variable pendingAdmin
     |  // modifier onlyBridgehub
     |  // modifier onlyOwnerOrAdmin
     |  // constructor
     |  // function getChainAdmin
     |  // function initialize
     |  // function setPendingAdmin
     |  // function acceptAdmin
     |  // function setValidatorTimelock
     |  // function setInitialCutHash
     |  // function setNewVersionUpgrade
     |  // function setUpgradeDiamondCut
     |  // function freezeChain
     |  // function unfreezeChain
     |  // function revertBatches
     |  // function _setChainIdUpgrade
     |  // function registerAlreadyDeployedStateTransition
     |  // function createNewChain
  27 |  contract StateTransitionManager is IStateTransitionManager, ReentrancyGuard, Ownable2Step {
  :  |
     |      // @audit-issue modifier onlyBridgehub should come before constructor
  65 |      modifier onlyBridgehub() {
  66 |          require(msg.sender == bridgehub, "StateTransition: only bridgehub");
  67 |          _;
  68 |      }
```
GitHub: [65-68](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L65-L68)


```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

     |  // @audit-info Contract component order has style violations; recommended top-level order:
     |  // using LibMap for LibMap.Uint32Map;
     |  // variable getName
     |  // variable stateTransitionManager
     |  // variable committedBatchTimestamp
     |  // variable validators
     |  // variable executionDelay
     |  // event NewExecutionDelay
     |  // event ValidatorAdded
     |  // event ValidatorRemoved
     |  // error AddressAlreadyValidator
     |  // error ValidatorDoesNotExist
     |  // modifier onlyChainAdmin
     |  // modifier onlyValidator
     |  // constructor
     |  // function setStateTransitionManager
     |  // function addValidator
     |  // function removeValidator
     |  // function setExecutionDelay
     |  // function getCommittedBatchTimestamp
     |  // function commitBatches
     |  // function commitBatchesSharedBridge
     |  // function revertBatches
     |  // function revertBatchesSharedBridge
     |  // function proveBatches
     |  // function proveBatchesSharedBridge
     |  // function executeBatches
     |  // function executeBatchesSharedBridge
     |  // function _propagateToZkSyncStateTransition
  22 |  contract ValidatorTimelock is IExecutor, Ownable2Step {
  :  |
     |      // @audit-issue variable stateTransitionManager should come before error ValidatorDoesNotExist
  44 |      IStateTransitionManager public stateTransitionManager;
  :  |
     |      // @audit-issue modifier onlyChainAdmin should come before constructor
  61 |      modifier onlyChainAdmin(uint256 _chainId) {
  62 |          require(msg.sender == stateTransitionManager.getChainAdmin(_chainId), "ValidatorTimelock: only chain admin");
  63 |          _;
  64 |      }
```
GitHub: [44](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L44), [61-64](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L61-L64)


```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol

     |  // @audit-info Contract component order has style violations; recommended top-level order:
     |  // using UncheckedMath for uint256;
     |  // using SafeCast for uint256;
     |  // struct SelectorToFacet
     |  // struct FacetToSelectors
     |  // struct DiamondStorage
     |  // struct FacetCut
     |  // struct DiamondCutData
     |  // enum Action
     |  // variable DIAMOND_INIT_SUCCESS_RETURN_VALUE
     |  // variable DIAMOND_STORAGE_POSITION
     |  // event DiamondCut
     |  // function getDiamondStorage
     |  // function diamondCut
     |  // function _addFunctions
     |  // function _replaceFunctions
     |  // function _removeFunctions
     |  // function _saveFacetIfNew
     |  // function _addOneFunction
     |  // function _removeOneFunction
     |  // function _removeFacet
     |  // function _initializeDiamondCut
  11 |  library Diamond {
  :  |
     |      // @audit-issue struct SelectorToFacet should come before event DiamondCut
  30 |      struct SelectorToFacet {
  31 |          address facetAddress;
  32 |          uint16 selectorPosition;
  33 |          bool isFreezable;
  34 |      }
```
GitHub: [30-34](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L30-L34)


```solidity
File: code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol

     |  // @audit-info Contract component order has style violations; recommended top-level order:
     |  // event NewPendingAdmin
     |  // event NewAdmin
     |  // event NewChain
     |  // function setPendingAdmin
     |  // function acceptAdmin
     |  // function stateTransitionManagerIsRegistered
     |  // function stateTransitionManager
     |  // function tokenIsRegistered
     |  // function baseToken
     |  // function sharedBridge
     |  // function getStateTransition
     |  // function proveL2MessageInclusion
     |  // function proveL2LogInclusion
     |  // function proveL1ToL2TransactionStatus
     |  // function requestL2TransactionDirect
     |  // function requestL2TransactionTwoBridges
     |  // function l2TransactionBaseCost
     |  // function createNewChain
     |  // function addStateTransitionManager
     |  // function removeStateTransitionManager
     |  // function addToken
     |  // function setSharedBridge
  42 |  interface IBridgehub {
  :  |
     |      // @audit-issue event NewChain should come before function setSharedBridge
 133 |      event NewChain(uint256 indexed chainId, address stateTransitionManager, address indexed chainGovernance);
```
GitHub: [133](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L133)


```solidity
File: code/contracts/ethereum/contracts/governance/IGovernance.sol

     |  // @audit-info Contract component order has style violations; recommended top-level order:
     |  // enum OperationState
     |  // struct Call
     |  // struct Operation
     |  // event TransparentOperationScheduled
     |  // event ShadowOperationScheduled
     |  // event OperationExecuted
     |  // event ChangeSecurityCouncil
     |  // event ChangeMinDelay
     |  // event OperationCancelled
     |  // function isOperation
     |  // function isOperationPending
     |  // function isOperationReady
     |  // function isOperationDone
     |  // function getOperationState
     |  // function scheduleTransparent
     |  // function scheduleShadow
     |  // function cancel
     |  // function execute
     |  // function executeInstant
     |  // function hashOperation
     |  // function updateDelay
     |  // function updateSecurityCouncil
   8 |  interface IGovernance {
  :  |
     |      // @audit-issue event TransparentOperationScheduled should come before function updateSecurityCouncil
  68 |      event TransparentOperationScheduled(bytes32 indexed _id, uint256 delay, Operation _operation);
```
GitHub: [68](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L68)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol

     |  // @audit-info Contract component order has style violations; recommended top-level order:
     |  // event IsPorterAvailableStatusUpdate
     |  // event ValidatorStatusUpdate
     |  // event NewPendingAdmin
     |  // event NewAdmin
     |  // event NewPriorityTxMaxGasLimit
     |  // event NewFeeParams
     |  // event ValidiumModeStatusUpdate
     |  // event NewBaseTokenMultiplier
     |  // event ExecuteUpgrade
     |  // event Freeze
     |  // event Unfreeze
     |  // function setPendingAdmin
     |  // function acceptAdmin
     |  // function setValidator
     |  // function setPorterAvailability
     |  // function setPriorityTxMaxGasLimit
     |  // function changeFeeParams
     |  // function setTokenMultiplier
     |  // function setValidiumMode
     |  // function upgradeChainFromVersion
     |  // function executeUpgrade
     |  // function freezeDiamond
     |  // function unfreezeDiamond
  13 |  interface IAdmin is IZkSyncStateTransitionBase {
  :  |
     |      // @audit-issue event IsPorterAvailableStatusUpdate should come before function unfreezeDiamond
  61 |      event IsPorterAvailableStatusUpdate(bool isPorterAvailable);
```
GitHub: [61](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L61)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol

     |  // @audit-info Contract component order has style violations; recommended top-level order:
     |  // struct StoredBatchInfo
     |  // struct CommitBatchInfo
     |  // struct ProofInput
     |  // event BlockCommit
     |  // event BlocksVerification
     |  // event BlockExecution
     |  // event BlocksRevert
     |  // function commitBatches
     |  // function commitBatchesSharedBridge
     |  // function proveBatches
     |  // function proveBatchesSharedBridge
     |  // function executeBatches
     |  // function executeBatchesSharedBridge
     |  // function revertBatches
     |  // function revertBatchesSharedBridge
  73 |  interface IExecutor is IZkSyncStateTransitionBase {
  :  |
     |      // @audit-issue event BlockCommit should come before function revertBatchesSharedBridge
 191 |      event BlockCommit(uint256 indexed batchNumber, bytes32 indexed batchHash, bytes32 indexed commitment);
```
GitHub: [191](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L191)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol

     |  // @audit-info Contract component order has style violations; recommended top-level order:
     |  // struct Facet
     |  // function getVerifier
     |  // function getAdmin
     |  // function getPendingAdmin
     |  // function getBridgehub
     |  // function getStateTransitionManager
     |  // function getBaseToken
     |  // function getBaseTokenBridge
     |  // function getTotalBatchesCommitted
     |  // function getTotalBatchesVerified
     |  // function getTotalBatchesExecuted
     |  // function getTotalPriorityTxs
     |  // function getFirstUnprocessedPriorityTx
     |  // function getPriorityQueueSize
     |  // function priorityQueueFrontOperation
     |  // function isValidator
     |  // function l2LogsRootHash
     |  // function storedBatchHash
     |  // function getL2BootloaderBytecodeHash
     |  // function getL2DefaultAccountBytecodeHash
     |  // function getVerifierParams
     |  // function isDiamondStorageFrozen
     |  // function getProtocolVersion
     |  // function getL2SystemContractsUpgradeTxHash
     |  // function getL2SystemContractsUpgradeBatchNumber
     |  // function getPriorityTxMaxGasLimit
     |  // function isEthWithdrawalFinalized
     |  // function getPubdataPricingMode
     |  // function baseTokenGasPriceMultiplierNominator
     |  // function baseTokenGasPriceMultiplierDenominator
     |  // function facets
     |  // function facetFunctionSelectors
     |  // function facetAddresses
     |  // function facetAddress
     |  // function isFunctionFreezable
     |  // function isFacetFreezable
  13 |  interface IGetters is IZkSyncStateTransitionBase {
  :  |
     |      // @audit-issue struct Facet should come before function baseTokenGasPriceMultiplierDenominator
 124 |      struct Facet {
 125 |          address addr;
 126 |          bytes4[] selectors;
 127 |      }
```
GitHub: [124-127](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L124-L127)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol

     |  // @audit-info Contract component order has style violations; recommended top-level order:
     |  // event NewPriorityRequest
     |  // event EthWithdrawalFinalized
     |  // function proveL2MessageInclusion
     |  // function proveL2LogInclusion
     |  // function proveL1ToL2TransactionStatus
     |  // function finalizeEthWithdrawal
     |  // function requestL2Transaction
     |  // function bridgehubRequestL2Transaction
     |  // function l2TransactionBaseCost
     |  // function transferEthToSharedBridge
  11 |  interface IMailbox is IZkSyncStateTransitionBase {
  :  |
     |      // @audit-issue event NewPriorityRequest should come before function transferEthToSharedBridge
 123 |      event NewPriorityRequest(
 124 |          uint256 txId,
 125 |          bytes32 txHash,
 126 |          uint64 expirationTimestamp,
 127 |          L2CanonicalTransaction transaction,
 128 |          bytes[] factoryDeps
 129 |      );
```
GitHub: [123-129](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L123-L129)


```solidity
File: code/contracts/ethereum/contracts/common/ReentrancyGuard.sol

     |  // @audit-info Contract component order has style violations; recommended top-level order:
     |  // variable LOCK_FLAG_ADDRESS
     |  // variable _NOT_ENTERED
     |  // variable _ENTERED
     |  // modifier reentrancyGuardInitializer
     |  // modifier nonReentrant
     |  // function _initializeReentrancyGuard
  25 |  abstract contract ReentrancyGuard {
  :  |
     |  // @audit-issue modifier nonReentrant should come before function _initializeReentrancyGuard
  68 |      modifier nonReentrant() {
  69 |          uint256 _status;
  70 |          assembly {
  71 |              _status := sload(LOCK_FLAG_ADDRESS)
  72 |          }
  74 |          // On the first call to nonReentrant, _notEntered will be true
  75 |          require(_status == _NOT_ENTERED, "r1");
  77 |          // Any calls to nonReentrant after this point will fail
  78 |          assembly {
  79 |              sstore(LOCK_FLAG_ADDRESS, _ENTERED)
  80 |          }
  82 |          _;
  84 |          // By storing the original value once again, a refund is triggered (see
  85 |          // https://eips.ethereum.org/EIPS/eip-2200)
  86 |          assembly {
  87 |              sstore(LOCK_FLAG_ADDRESS, _NOT_ENTERED)
  88 |          }
  89 |      }
```
GitHub: [68-89](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/ReentrancyGuard.sol#L68-L89)


```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

     |  // @audit-info Contract component order has style violations; recommended top-level order:
     |  // struct ForceDeployment
     |  // variable accountInfo
     |  // modifier onlySelf
     |  // function getAccountInfo
     |  // function extendedAccountVersion
     |  // function _storeAccountInfo
     |  // function updateAccountVersion
     |  // function updateNonceOrdering
     |  // function getNewAddressCreate2
     |  // function getNewAddressCreate
     |  // function create2
     |  // function create
     |  // function create2Account
     |  // function createAccount
     |  // function forceDeployOnAddress
     |  // function forceDeployOnAddresses
     |  // function _nonSystemDeployOnAddress
     |  // function _performDeployOnAddress
     |  // function _ensureBytecodeIsKnown
     |  // function _storeConstructingByteCodeHashOnAddress
     |  // function _constructContract
  23 |  contract ContractDeployer is IContractDeployer, ISystemContract {
  :  |
     |      // @audit-issue struct ForceDeployment should come before function createAccount
 197 |      struct ForceDeployment {
 198 |          // The bytecode hash to put on an address
 199 |          bytes32 bytecodeHash;
 200 |          // The address on which to deploy the bytecodehash to
 201 |          address newAddress;
 202 |          // Whether to run the constructor on the force deployment
 203 |          bool callConstructor;
 204 |          // The value with which to initialize a contract
 205 |          uint256 value;
 206 |          // The constructor calldata
 207 |          bytes input;
 208 |      }
```
GitHub: [197-208](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L197-L208)


```solidity
File: code/system-contracts/contracts/L1Messenger.sol

     |  // @audit-info Contract component order has style violations; recommended top-level order:
     |  // variable chainedLogsHash
     |  // variable numberOfLogsToProcess
     |  // variable chainedMessagesHash
     |  // variable chainedL1BytecodesRevealDataHash
     |  // variable KECCAK_ROUND_GAS_COST
     |  // variable KECCAK_ROUND_NUMBER_OF_BYTES
     |  // variable SHA256_ROUND_GAS_COST
     |  // variable SHA256_ROUND_NUMBER_OF_BYTES
     |  // function keccakGasCost
     |  // function sha256GasCost
     |  // function sendL2ToL1Log
     |  // function _processL2ToL1Log
     |  // function sendToL1
     |  // function requestBytecodeL1Publication
     |  // function publishPubdataAndClearState
  25 |  contract L1Messenger is IL1Messenger, ISystemContract {
  :  |
     |      // @audit-issue variable SHA256_ROUND_GAS_COST should come before function keccakGasCost
  55 |      uint256 internal constant SHA256_ROUND_GAS_COST = 7;
```
GitHub: [55](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L55)


```solidity
File: code/system-contracts/contracts/MsgValueSimulator.sol

     |  // @audit-info Contract component order has style violations; recommended top-level order:
     |  // variable GAS_TO_PASS
     |  // variable MSG_VALUE_SIMULATOR_STIPEND_GAS
     |  // function _getAbiParams
     |  // function 
  19 |  contract MsgValueSimulator is ISystemContract {
  :  |
     |      // @audit-issue variable GAS_TO_PASS should come before function _getAbiParams
  36 |      uint256 constant GAS_TO_PASS = 2300;
```
GitHub: [36](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/MsgValueSimulator.sol#L36)


```solidity
File: code/system-contracts/contracts/SystemContext.sol

     |  // @audit-info Contract component order has style violations; recommended top-level order:
     |  // variable MINIBLOCK_HASHES_TO_STORE
     |  // variable chainId
     |  // variable origin
     |  // variable gasPrice
     |  // variable blockGasLimit
     |  // variable coinbase
     |  // variable difficulty
     |  // variable baseFee
     |  // variable currentBatchInfo
     |  // variable batchHashes
     |  // variable currentL2BlockInfo
     |  // variable currentL2BlockTxsRollingHash
     |  // variable l2BlockHash
     |  // variable currentVirtualL2BlockInfo
     |  // variable virtualBlockUpgradeInfo
     |  // variable txNumberInBlock
     |  // variable gasPerPubdataByte
     |  // variable basePubdataSpent
     |  // function setChainId
     |  // function setTxOrigin
     |  // function setGasPrice
     |  // function setPubdataInfo
     |  // function getCurrentPubdataSpent
     |  // function getCurrentPubdataCost
     |  // function getBlockHashEVM
     |  // function getBatchHash
     |  // function getBatchNumberAndTimestamp
     |  // function getL2BlockNumberAndTimestamp
     |  // function getBlockNumber
     |  // function getBlockTimestamp
     |  // function _getLatest257L2blockHash
     |  // function _setL2BlockHash
     |  // function _calculateL2BlockHash
     |  // function _calculateLegacyL2BlockHash
     |  // function _upgradeL2Blocks
     |  // function _setVirtualBlock
     |  // function _setNewL2BlockData
     |  // function setL2Block
     |  // function appendTransactionToCurrentL2Block
     |  // function publishTimestampDataToL1
     |  // function _ensureBatchConsistentWithL2Block
     |  // function setNewBatch
     |  // function unsafeOverrideBatch
     |  // function incrementTxNumberInBatch
     |  // function resetTxNumberInBatch
     |  // function currentBlockInfo
     |  // function getBlockNumberAndTimestamp
     |  // function blockHash
  17 |  contract SystemContext is ISystemContext, ISystemContextDeprecated, ISystemContract {
  :  |
     |      // @audit-issue variable txNumberInBlock should come before function setChainId
  89 |      uint16 public txNumberInBlock;
```
GitHub: [89](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L89)


```solidity
File: code/system-contracts/contracts/interfaces/IBaseToken.sol

     |  // @audit-info Contract component order has style violations; recommended top-level order:
     |  // event Mint
     |  // event Transfer
     |  // event Withdrawal
     |  // event WithdrawalWithMessage
     |  // function balanceOf
     |  // function transferFromTo
     |  // function totalSupply
     |  // function name
     |  // function symbol
     |  // function decimals
     |  // function mint
     |  // function withdraw
     |  // function withdrawWithMessage
   5 |  interface IBaseToken {
  :  |
     |      // @audit-issue event Mint should come before function withdrawWithMessage
  24 |      event Mint(address indexed account, uint256 amount);
```
GitHub: [24](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBaseToken.sol#L24)


```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

     |  // @audit-info Contract component order has style violations; recommended top-level order:
     |  // struct ERC20Getters
     |  // variable availableGetters
     |  // variable decimals_
     |  // variable l2Bridge
     |  // variable l1Address
     |  // modifier onlyBridge
     |  // modifier onlyNextVersion
     |  // constructor
     |  // function bridgeInitialize
     |  // function reinitializeToken
     |  // function bridgeMint
     |  // function bridgeBurn
     |  // function name
     |  // function symbol
     |  // function decimals
     |  // function decodeString
     |  // function decodeUint8
  15 |  contract L2StandardERC20 is ERC20PermitUpgradeable, IL2StandardToken, ERC1967Upgrade {
  :  |
     |      // @audit-issue modifier onlyBridge should come before function reinitializeToken
 129 |      modifier onlyBridge() {
 130 |          require(msg.sender == l2Bridge, "xnt"); // Only L2 bridge can call this method
 131 |          _;
 132 |      }
```
GitHub: [129-132](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L129-L132)


```solidity
File: code/contracts/zksync/contracts/bridge/L2WrappedBaseToken.sol

     |  // @audit-info Contract component order has style violations; recommended top-level order:
     |  // variable l2Bridge
     |  // variable l1Address
     |  // modifier onlyBridge
     |  // constructor
     |  // function initializeV2
     |  // function bridgeMint
     |  // function bridgeBurn
     |  // function deposit
     |  // function withdraw
     |  // function depositTo
     |  // function withdrawTo
     |  // function 
  23 |  contract L2WrappedBaseToken is ERC20PermitUpgradeable, IL2WrappedBaseToken, IL2StandardToken {
  :  |
     |      // @audit-issue modifier onlyBridge should come before function initializeV2
  64 |      modifier onlyBridge() {
  65 |          require(msg.sender == l2Bridge, "permission denied"); // Only L2 bridge can call this method
  66 |          _;
  67 |      }
```
GitHub: [64-67](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2WrappedBaseToken.sol#L64-L67)


## [N-24] Contract should expose an `interface`

The `contract`s should expose an `interface` so that other projects can more easily integrate with it, without having to develop their own non-standard variants.

*Instances: 14*

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol

     |  // @audit-issue Consider defining an interface for this contract
  10 |  contract DiamondProxy {
```
GitHub: [10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol#L10)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol

     |  // @audit-issue Consider defining an interface for this contract
  11 |  contract ZkSyncStateTransitionBase is ReentrancyGuard {
```
GitHub: [11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L11)


```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol

     |  // @audit-issue Consider defining an interface for this contract
  44 |  abstract contract BaseZkSyncUpgrade is ZkSyncStateTransitionBase {
```
GitHub: [44](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L44)


```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol

     |  // @audit-issue Consider defining an interface for this contract
  17 |  abstract contract BaseZkSyncUpgradeGenesis is BaseZkSyncUpgrade {
```
GitHub: [17](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L17)


```solidity
File: code/contracts/ethereum/contracts/upgrades/DefaultUpgrade.sol

     |  // @audit-issue Consider defining an interface for this contract
  10 |  contract DefaultUpgrade is BaseZkSyncUpgrade {
```
GitHub: [10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/DefaultUpgrade.sol#L10)


```solidity
File: code/contracts/ethereum/contracts/upgrades/GenesisUpgrade.sol

     |  // @audit-issue Consider defining an interface for this contract
  11 |  contract GenesisUpgrade is BaseZkSyncUpgradeGenesis {
```
GitHub: [11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/GenesisUpgrade.sol#L11)


```solidity
File: code/contracts/ethereum/contracts/common/ReentrancyGuard.sol

     |  // @audit-issue Consider defining an interface for this contract
  25 |  abstract contract ReentrancyGuard {
```
GitHub: [25](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/ReentrancyGuard.sol#L25)


```solidity
File: code/contracts/ethereum/contracts/upgrades/Upgrade_4844.sol

     |  // @audit-issue Consider defining an interface for this contract
  12 |  contract Upgrade_4844 is BaseZkSyncUpgrade {
```
GitHub: [12](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/Upgrade_4844.sol#L12)


```solidity
File: code/contracts/ethereum/contracts/upgrades/Upgrade_v1_4_1.sol

     |  // @audit-issue Consider defining an interface for this contract
  13 |  contract Upgrade_v1_4_1 is BaseZkSyncUpgrade {
```
GitHub: [13](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/Upgrade_v1_4_1.sol#L13)


```solidity
File: code/system-contracts/contracts/EmptyContract.sol

     |  // @audit-issue Consider defining an interface for this contract
  10 |  contract EmptyContract {
```
GitHub: [10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/EmptyContract.sol#L10)


```solidity
File: code/system-contracts/contracts/MsgValueSimulator.sol

     |  // @audit-issue Consider defining an interface for this contract
  19 |  contract MsgValueSimulator is ISystemContract {
```
GitHub: [19](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/MsgValueSimulator.sol#L19)


```solidity
File: code/system-contracts/contracts/GasBoundCaller.sol

     |  // @audit-issue Consider defining an interface for this contract
  15 |  contract GasBoundCaller {
```
GitHub: [15](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/GasBoundCaller.sol#L15)


```solidity
File: code/system-contracts/contracts/interfaces/ISystemContract.sol

     |  // @audit-issue Consider defining an interface for this contract
  17 |  abstract contract ISystemContract {
```
GitHub: [17](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContract.sol#L17)


```solidity
File: code/contracts/zksync/contracts/ForceDeployUpgrader.sol

     |  // @audit-issue Consider defining an interface for this contract
  10 |  contract ForceDeployUpgrader {
```
GitHub: [10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/ForceDeployUpgrader.sol#L10)


## [N-25] Contracts should have full test coverage

While 100% code coverage does not guarantee that there are no bugs, it often will catch easy-to-find bugs, and will ensure that there are fewer regressions when the code invariably has to be modified. Furthermore, in order to get full coverage, code authors will often have to re-organize their code so that it is more modular, so that each component can be tested separately, which reduces interdependencies between modules and layers, and makes for code that is easier to reason about and audit.

*Instances: 99*

```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

     |  // @audit-issue Test coverage for this file was < 100%
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

     |  // @audit-issue Test coverage for this file was < 100%
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

     |  // @audit-issue Test coverage for this file was < 100%
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

     |  // @audit-issue Test coverage for this file was < 100%
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

     |  // @audit-issue Test coverage for this file was < 100%
   1 |  pragma solidity 0.8.20;
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

     |  // @audit-issue Test coverage for this file was < 100%
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol

     |  // @audit-issue Test coverage for this file was < 100%
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol

     |  // @audit-issue Test coverage for this file was < 100%
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol

     |  // @audit-issue Test coverage for this file was < 100%
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol

     |  // @audit-issue Test coverage for this file was < 100%
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

     |  // @audit-issue Test coverage for this file was < 100%
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol

     |  // @audit-issue Test coverage for this file was < 100%
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

     |  // @audit-issue Test coverage for this file was < 100%
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol

     |  // @audit-issue Test coverage for this file was < 100%
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol

     |  // @audit-issue Test coverage for this file was < 100%
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol

     |  // @audit-issue Test coverage for this file was < 100%
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/upgrades/DefaultUpgrade.sol

     |  // @audit-issue Test coverage for this file was < 100%
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/DefaultUpgrade.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/upgrades/GenesisUpgrade.sol

     |  // @audit-issue Test coverage for this file was < 100%
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/GenesisUpgrade.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol

     |  // @audit-issue Test coverage for this file was < 100%
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/common/libraries/UncheckedMath.sol

     |  // @audit-issue Test coverage for this file was < 100%
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/UncheckedMath.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol

     |  // @audit-issue Test coverage for this file was < 100%
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol

     |  // @audit-issue Test coverage for this file was < 100%
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/LibMap.sol

     |  // @audit-issue Test coverage for this file was < 100%
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/LibMap.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol

     |  // @audit-issue Test coverage for this file was < 100%
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol

     |  // @audit-issue Test coverage for this file was < 100%
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol

     |  // @audit-issue Test coverage for this file was < 100%
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol

     |  // @audit-issue Test coverage for this file was < 100%
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol

     |  // @audit-issue Test coverage for this file was < 100%
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL2Bridge.sol

     |  // @audit-issue Test coverage for this file was < 100%
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL2Bridge.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IWETH9.sol

     |  // @audit-issue Test coverage for this file was < 100%
   1 |  // SPDX-License-Identifier: Apache-2.0
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IWETH9.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol

     |  // @audit-issue Test coverage for this file was < 100%
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/common/interfaces/IL2ContractDeployer.sol

     |  // @audit-issue Test coverage for this file was < 100%
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/interfaces/IL2ContractDeployer.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/governance/IGovernance.sol

     |  // @audit-issue Test coverage for this file was < 100%
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol

     |  // @audit-issue Test coverage for this file was < 100%
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol

     |  // @audit-issue Test coverage for this file was < 100%
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol

     |  // @audit-issue Test coverage for this file was < 100%
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol

     |  // @audit-issue Test coverage for this file was < 100%
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol

     |  // @audit-issue Test coverage for this file was < 100%
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/ILegacyGetters.sol

     |  // @audit-issue Test coverage for this file was < 100%
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/ILegacyGetters.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol

     |  // @audit-issue Test coverage for this file was < 100%
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IVerifier.sol

     |  // @audit-issue Test coverage for this file was < 100%
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IVerifier.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol

     |  // @audit-issue Test coverage for this file was < 100%
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransitionBase.sol

     |  // @audit-issue Test coverage for this file was < 100%
   1 |  // SPDX-License-Identifier: UNLICENSED
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransitionBase.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/upgrades/IDefaultUpgrade.sol

     |  // @audit-issue Test coverage for this file was < 100%
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/IDefaultUpgrade.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/common/Config.sol

     |  // @audit-issue Test coverage for this file was < 100%
   1 |  pragma solidity 0.8.20;
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/Config.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/common/L2ContractAddresses.sol

     |  // @audit-issue Test coverage for this file was < 100%
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/L2ContractAddresses.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/common/Messaging.sol

     |  // @audit-issue Test coverage for this file was < 100%
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/Messaging.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/common/ReentrancyGuard.sol

     |  // @audit-issue Test coverage for this file was < 100%
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/ReentrancyGuard.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol

     |  // @audit-issue Test coverage for this file was < 100%
   1 |  // SPDX-License-Identifier: Apache-2.0
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/Verifier.sol

     |  // @audit-issue Test coverage for this file was < 100%
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/upgrades/Upgrade_4844.sol

     |  // @audit-issue Test coverage for this file was < 100%
   1 |  pragma solidity 0.8.20;
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/Upgrade_4844.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/upgrades/Upgrade_v1_4_1.sol

     |  // @audit-issue Test coverage for this file was < 100%
   1 |  pragma solidity 0.8.20;
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/Upgrade_v1_4_1.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/common/Dependencies.sol

     |  // @audit-issue Test coverage for this file was < 100%
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/Dependencies.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/l2-deps/ISystemContext.sol

     |  // @audit-issue Test coverage for this file was < 100%
   1 |  // SPDX-License-Identifier: UNLICENSED
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/l2-deps/ISystemContext.sol#L1)


```solidity
File: code/system-contracts/contracts/AccountCodeStorage.sol

     |  // @audit-issue Test coverage for this file was < 100%
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L1)


```solidity
File: code/system-contracts/contracts/BootloaderUtilities.sol

     |  // @audit-issue Test coverage for this file was < 100%
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L1)


```solidity
File: code/system-contracts/contracts/ComplexUpgrader.sol

     |  // @audit-issue Test coverage for this file was < 100%
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ComplexUpgrader.sol#L1)


```solidity
File: code/system-contracts/contracts/Compressor.sol

     |  // @audit-issue Test coverage for this file was < 100%
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L1)


```solidity
File: code/system-contracts/contracts/Constants.sol

     |  // @audit-issue Test coverage for this file was < 100%
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Constants.sol#L1)


```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

     |  // @audit-issue Test coverage for this file was < 100%
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L1)


```solidity
File: code/system-contracts/contracts/DefaultAccount.sol

     |  // @audit-issue Test coverage for this file was < 100%
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L1)


```solidity
File: code/system-contracts/contracts/EmptyContract.sol

     |  // @audit-issue Test coverage for this file was < 100%
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/EmptyContract.sol#L1)


```solidity
File: code/system-contracts/contracts/ImmutableSimulator.sol

     |  // @audit-issue Test coverage for this file was < 100%
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ImmutableSimulator.sol#L1)


```solidity
File: code/system-contracts/contracts/KnownCodesStorage.sol

     |  // @audit-issue Test coverage for this file was < 100%
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/KnownCodesStorage.sol#L1)


```solidity
File: code/system-contracts/contracts/L1Messenger.sol

     |  // @audit-issue Test coverage for this file was < 100%
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L1)


```solidity
File: code/system-contracts/contracts/L2BaseToken.sol

     |  // @audit-issue Test coverage for this file was < 100%
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L2BaseToken.sol#L1)


```solidity
File: code/system-contracts/contracts/MsgValueSimulator.sol

     |  // @audit-issue Test coverage for this file was < 100%
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/MsgValueSimulator.sol#L1)


```solidity
File: code/system-contracts/contracts/NonceHolder.sol

     |  // @audit-issue Test coverage for this file was < 100%
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/NonceHolder.sol#L1)


```solidity
File: code/system-contracts/contracts/PubdataChunkPublisher.sol

     |  // @audit-issue Test coverage for this file was < 100%
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/PubdataChunkPublisher.sol#L1)


```solidity
File: code/system-contracts/contracts/SystemContext.sol

     |  // @audit-issue Test coverage for this file was < 100%
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L1)


```solidity
File: code/system-contracts/contracts/GasBoundCaller.sol

     |  // @audit-issue Test coverage for this file was < 100%
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/GasBoundCaller.sol#L1)


```solidity
File: code/system-contracts/contracts/libraries/EfficientCall.sol

     |  // @audit-issue Test coverage for this file was < 100%
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L1)


```solidity
File: code/system-contracts/contracts/libraries/RLPEncoder.sol

     |  // @audit-issue Test coverage for this file was < 100%
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/RLPEncoder.sol#L1)


```solidity
File: code/system-contracts/contracts/libraries/SystemContractHelper.sol

     |  // @audit-issue Test coverage for this file was < 100%
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L1)


```solidity
File: code/system-contracts/contracts/libraries/SystemContractsCaller.sol

     |  // @audit-issue Test coverage for this file was < 100%
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L1)


```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

     |  // @audit-issue Test coverage for this file was < 100%
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L1)


```solidity
File: code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol

     |  // @audit-issue Test coverage for this file was < 100%
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol#L1)


```solidity
File: code/system-contracts/contracts/libraries/Utils.sol

     |  // @audit-issue Test coverage for this file was < 100%
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L1)


```solidity
File: code/system-contracts/contracts/interfaces/IAccount.sol

     |  // @audit-issue Test coverage for this file was < 100%
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IAccount.sol#L1)


```solidity
File: code/system-contracts/contracts/interfaces/IAccountCodeStorage.sol

     |  // @audit-issue Test coverage for this file was < 100%
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IAccountCodeStorage.sol#L1)


```solidity
File: code/system-contracts/contracts/interfaces/IBaseToken.sol

     |  // @audit-issue Test coverage for this file was < 100%
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBaseToken.sol#L1)


```solidity
File: code/system-contracts/contracts/interfaces/IBootloaderUtilities.sol

     |  // @audit-issue Test coverage for this file was < 100%
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBootloaderUtilities.sol#L1)


```solidity
File: code/system-contracts/contracts/interfaces/IComplexUpgrader.sol

     |  // @audit-issue Test coverage for this file was < 100%
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IComplexUpgrader.sol#L1)


```solidity
File: code/system-contracts/contracts/interfaces/ICompressor.sol

     |  // @audit-issue Test coverage for this file was < 100%
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ICompressor.sol#L1)


```solidity
File: code/system-contracts/contracts/interfaces/IContractDeployer.sol

     |  // @audit-issue Test coverage for this file was < 100%
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L1)


```solidity
File: code/system-contracts/contracts/interfaces/IImmutableSimulator.sol

     |  // @audit-issue Test coverage for this file was < 100%
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IImmutableSimulator.sol#L1)


```solidity
File: code/system-contracts/contracts/interfaces/IKnownCodesStorage.sol

     |  // @audit-issue Test coverage for this file was < 100%
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IKnownCodesStorage.sol#L1)


```solidity
File: code/system-contracts/contracts/interfaces/IL1Messenger.sol

     |  // @audit-issue Test coverage for this file was < 100%
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL1Messenger.sol#L1)


```solidity
File: code/system-contracts/contracts/interfaces/IL2StandardToken.sol

     |  // @audit-issue Test coverage for this file was < 100%
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL2StandardToken.sol#L1)


```solidity
File: code/system-contracts/contracts/interfaces/IMailbox.sol

     |  // @audit-issue Test coverage for this file was < 100%
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IMailbox.sol#L1)


```solidity
File: code/system-contracts/contracts/interfaces/INonceHolder.sol

     |  // @audit-issue Test coverage for this file was < 100%
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/INonceHolder.sol#L1)


```solidity
File: code/system-contracts/contracts/interfaces/IPaymaster.sol

     |  // @audit-issue Test coverage for this file was < 100%
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IPaymaster.sol#L1)


```solidity
File: code/system-contracts/contracts/interfaces/IPaymasterFlow.sol

     |  // @audit-issue Test coverage for this file was < 100%
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IPaymasterFlow.sol#L1)


```solidity
File: code/system-contracts/contracts/interfaces/IPubdataChunkPublisher.sol

     |  // @audit-issue Test coverage for this file was < 100%
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IPubdataChunkPublisher.sol#L1)


```solidity
File: code/system-contracts/contracts/interfaces/ISystemContext.sol

     |  // @audit-issue Test coverage for this file was < 100%
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L1)


```solidity
File: code/system-contracts/contracts/interfaces/ISystemContextDeprecated.sol

     |  // @audit-issue Test coverage for this file was < 100%
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContextDeprecated.sol#L1)


```solidity
File: code/system-contracts/contracts/interfaces/ISystemContract.sol

     |  // @audit-issue Test coverage for this file was < 100%
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContract.sol#L1)


```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

     |  // @audit-issue Test coverage for this file was < 100%
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L1)


```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

     |  // @audit-issue Test coverage for this file was < 100%
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L1)


## [N-26] Critical system parameter changes should be behind a timelock

Admin functions that change state should consider adding timelocks so that users and other privileged roles can be notified of and react to upcoming changes. Also, this protects users against a compromised/malicious admin account.

*Instances: 30*

```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

     |  // @audit-issue Add a timelock to the parameter change
  51 |  function setPendingAdmin(address _newPendingAdmin) external onlyOwnerOrAdmin {
  52 |      // Save previous value into the stack to put it into the event later
  53 |      address oldPendingAdmin = pendingAdmin;
  54 |      // Change pending admin
  55 |      pendingAdmin = _newPendingAdmin;
  56 |      emit NewPendingAdmin(oldPendingAdmin, _newPendingAdmin);
  57 |  }

     |  // @audit-issue Add a timelock to the parameter change
  82 |  function addStateTransitionManager(address _stateTransitionManager) external onlyOwner {
  83 |      require(
  84 |          !stateTransitionManagerIsRegistered[_stateTransitionManager],
  85 |          "Bridgehub: state transition already registered"
  86 |      );
  87 |      stateTransitionManagerIsRegistered[_stateTransitionManager] = true;
  88 |  }

     |  // @audit-issue Add a timelock to the parameter change
  92 |  function removeStateTransitionManager(address _stateTransitionManager) external onlyOwner {
  93 |      require(
  94 |          stateTransitionManagerIsRegistered[_stateTransitionManager],
  95 |          "Bridgehub: state transition not registered yet"
  96 |      );
  97 |      stateTransitionManagerIsRegistered[_stateTransitionManager] = false;
  98 |  }

     |  // @audit-issue Add a timelock to the parameter change
 101 |  function addToken(address _token) external onlyOwner {
 102 |      require(!tokenIsRegistered[_token], "Bridgehub: token already registered");
 103 |      tokenIsRegistered[_token] = true;
 104 |  }

     |  // @audit-issue Add a timelock to the parameter change
 108 |  function setSharedBridge(address _sharedBridge) external onlyOwner {
 109 |      sharedBridge = IL1SharedBridge(_sharedBridge);
 110 |  }
```
GitHub: [51-57](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L51-L57), [82-88](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L82-L88), [92-98](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L92-L98), [101-104](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L101-L104), [108-110](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L108-L110)


```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

     |  // @audit-issue Add a timelock to the parameter change
 249 |  function updateDelay(uint256 _newDelay) external onlySelf {
 250 |      emit ChangeMinDelay(minDelay, _newDelay);
 251 |      minDelay = _newDelay;
 252 |  }

     |  // @audit-issue Add a timelock to the parameter change
 256 |  function updateSecurityCouncil(address _newSecurityCouncil) external onlySelf {
 257 |      emit ChangeSecurityCouncil(securityCouncil, _newSecurityCouncil);
 258 |      securityCouncil = _newSecurityCouncil;
 259 |  }
```
GitHub: [249-252](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L249-L252), [256-259](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L256-L259)


```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

     |  // @audit-issue Add a timelock to the parameter change
 112 |  function setPendingAdmin(address _newPendingAdmin) external onlyOwnerOrAdmin {
 113 |      // Save previous value into the stack to put it into the event later
 114 |      address oldPendingAdmin = pendingAdmin;
 115 |      // Change pending admin
 116 |      pendingAdmin = _newPendingAdmin;
 117 |      emit NewPendingAdmin(oldPendingAdmin, _newPendingAdmin);
 118 |  }

     |  // @audit-issue Add a timelock to the parameter change
 139 |  function setInitialCutHash(Diamond.DiamondCutData calldata _diamondCut) external onlyOwner {
 140 |      initialCutHash = keccak256(abi.encode(_diamondCut));
 141 |  }

     |  // @audit-issue Add a timelock to the parameter change
 144 |  function setNewVersionUpgrade(
 145 |      Diamond.DiamondCutData calldata _cutData,
 146 |      uint256 _oldProtocolVersion,
 147 |      uint256 _newProtocolVersion
 148 |  ) external onlyOwner {
 149 |      upgradeCutHash[_oldProtocolVersion] = keccak256(abi.encode(_cutData));
 150 |      protocolVersion = _newProtocolVersion;
 151 |  }

     |  // @audit-issue Add a timelock to the parameter change
 154 |  function setUpgradeDiamondCut(
 155 |      Diamond.DiamondCutData calldata _cutData,
 156 |      uint256 _oldProtocolVersion
 157 |  ) external onlyOwner {
 158 |      upgradeCutHash[_oldProtocolVersion] = keccak256(abi.encode(_cutData));
 159 |  }
```
GitHub: [112-118](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L112-L118), [139-141](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L139-L141), [144-151](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L144-L151), [154-159](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L154-L159)


```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

     |  // @audit-issue Add a timelock to the parameter change
  73 |  function setStateTransitionManager(IStateTransitionManager _stateTransitionManager) external onlyOwner {
  74 |      stateTransitionManager = _stateTransitionManager;
  75 |  }

     |  // @audit-issue Add a timelock to the parameter change
  78 |  function addValidator(uint256 _chainId, address _newValidator) external onlyChainAdmin(_chainId) {
  79 |      if (validators[_chainId][_newValidator]) {
  80 |          revert AddressAlreadyValidator(_chainId);
  81 |      }
  82 |      validators[_chainId][_newValidator] = true;
  83 |      emit ValidatorAdded(_chainId, _newValidator);
  84 |  }

     |  // @audit-issue Add a timelock to the parameter change
  87 |  function removeValidator(uint256 _chainId, address _validator) external onlyChainAdmin(_chainId) {
  88 |      if (!validators[_chainId][_validator]) {
  89 |          revert ValidatorDoesNotExist(_chainId);
  90 |      }
  91 |      validators[_chainId][_validator] = false;
  92 |      emit ValidatorRemoved(_chainId, _validator);
  93 |  }

     |  // @audit-issue Add a timelock to the parameter change
  96 |  function setExecutionDelay(uint32 _executionDelay) external onlyOwner {
  97 |      executionDelay = _executionDelay;
  98 |      emit NewExecutionDelay(_executionDelay);
  99 |  }
```
GitHub: [73-75](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L73-L75), [78-84](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L78-L84), [87-93](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L87-L93), [96-99](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L96-L99)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol

     |  // @audit-issue Add a timelock to the parameter change
  23 |  function setPendingAdmin(address _newPendingAdmin) external onlyAdmin {
  24 |      // Save previous value into the stack to put it into the event later
  25 |      address oldPendingAdmin = s.pendingAdmin;
  26 |      // Change pending admin
  27 |      s.pendingAdmin = _newPendingAdmin;
  28 |      emit NewPendingAdmin(oldPendingAdmin, _newPendingAdmin);
  29 |  }

     |  // @audit-issue Add a timelock to the parameter change
  45 |  function setValidator(address _validator, bool _active) external onlyStateTransitionManager {
  46 |      s.validators[_validator] = _active;
  47 |      emit ValidatorStatusUpdate(_validator, _active);
  48 |  }

     |  // @audit-issue Add a timelock to the parameter change
  51 |  function setPorterAvailability(bool _zkPorterIsAvailable) external onlyStateTransitionManager {
  52 |      // Change the porter availability
  53 |      s.zkPorterIsAvailable = _zkPorterIsAvailable;
  54 |      emit IsPorterAvailableStatusUpdate(_zkPorterIsAvailable);
  55 |  }

     |  // @audit-issue Add a timelock to the parameter change
  58 |      function setPriorityTxMaxGasLimit(uint256 _newPriorityTxMaxGasLimit) external onlyStateTransitionManager {
  59 |          require(_newPriorityTxMaxGasLimit <= MAX_GAS_PER_TRANSACTION, "n5");
  61 |          uint256 oldPriorityTxMaxGasLimit = s.priorityTxMaxGasLimit;
  62 |          s.priorityTxMaxGasLimit = _newPriorityTxMaxGasLimit;
  63 |          emit NewPriorityTxMaxGasLimit(oldPriorityTxMaxGasLimit, _newPriorityTxMaxGasLimit);
  64 |      }

     |  // @audit-issue Add a timelock to the parameter change
  67 |      function changeFeeParams(FeeParams calldata _newFeeParams) external onlyAdminOrStateTransitionManager {
  68 |          // Double checking that the new fee params are valid, i.e.
  69 |          // the maximal pubdata per batch is not less than the maximal pubdata per priority transaction.
  70 |          require(_newFeeParams.maxPubdataPerBatch >= _newFeeParams.priorityTxMaxPubdata, "n6");
  72 |          FeeParams memory oldFeeParams = s.feeParams;
  73 |          s.feeParams = _newFeeParams;
  75 |          emit NewFeeParams(oldFeeParams, _newFeeParams);
  76 |      }

     |  // @audit-issue Add a timelock to the parameter change
  79 |      function setTokenMultiplier(uint128 _nominator, uint128 _denominator) external onlyAdminOrStateTransitionManager {
  80 |          uint128 oldNominator = s.baseTokenGasPriceMultiplierNominator;
  81 |          uint128 oldDenominator = s.baseTokenGasPriceMultiplierDenominator;
  83 |          s.baseTokenGasPriceMultiplierNominator = _nominator;
  84 |          s.baseTokenGasPriceMultiplierDenominator = _denominator;
  86 |          emit NewBaseTokenMultiplier(oldNominator, oldDenominator, _nominator, _denominator);
  87 |      }

     |  // @audit-issue Add a timelock to the parameter change
  89 |  function setValidiumMode(PubdataPricingMode _validiumMode) external onlyAdmin {
  90 |      require(s.totalBatchesCommitted == 0, "AdminFacet: set validium only after genesis"); // Validium mode can be set only before the first batch is committed
  91 |      s.feeParams.pubdataPricingMode = _validiumMode;
  92 |      emit ValidiumModeStatusUpdate(_validiumMode);
  93 |  }

     |  // @audit-issue Add a timelock to the parameter change
 100 |      function upgradeChainFromVersion(
 101 |          uint256 _oldProtocolVersion,
 102 |          Diamond.DiamondCutData calldata _diamondCut
 103 |      ) external onlyAdminOrStateTransitionManager {
 104 |          bytes32 cutHashInput = keccak256(abi.encode(_diamondCut));
 105 |          require(
 106 |              cutHashInput == IStateTransitionManager(s.stateTransitionManager).upgradeCutHash(_oldProtocolVersion),
 107 |              "StateTransition: cutHash mismatch"
 108 |          );
 110 |          require(
 111 |              s.protocolVersion == _oldProtocolVersion,
 112 |              "StateTransition: protocolVersion mismatch in STC when upgrading"
 113 |          );
 114 |          Diamond.diamondCut(_diamondCut);
 115 |          emit ExecuteUpgrade(_diamondCut);
 116 |          require(
 117 |              s.protocolVersion > _oldProtocolVersion,
 118 |              "StateTransition: protocolVersion mismatch in STC after upgrading"
 119 |          );
 120 |      }
```
GitHub: [23-29](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L23-L29), [45-48](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L45-L48), [51-55](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L51-L55), [58-64](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L58-L64), [67-76](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L67-L76), [79-87](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L79-L87), [89-93](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L89-L93), [100-120](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L100-L120)


```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

     |  // @audit-issue Add a timelock to the parameter change
  65 |      function updateAccountVersion(AccountAbstractionVersion _version) external onlySystemCall {
  66 |          accountInfo[msg.sender].supportedAAVersion = _version;
  68 |          emit AccountVersionUpdated(msg.sender, _version);
  69 |      }

     |  // @audit-issue Add a timelock to the parameter change
  74 |      function updateNonceOrdering(AccountNonceOrdering _nonceOrdering) external onlySystemCall {
  75 |          AccountInfo memory currentInfo = accountInfo[msg.sender];
  77 |          require(
  78 |              _nonceOrdering == AccountNonceOrdering.Arbitrary &&
  79 |                  currentInfo.nonceOrdering == AccountNonceOrdering.Sequential,
  80 |              "It is only possible to change from sequential to arbitrary ordering"
  81 |          );
  83 |          currentInfo.nonceOrdering = _nonceOrdering;
  84 |          _storeAccountInfo(msg.sender, currentInfo);
  86 |          emit AccountNonceOrderingUpdated(msg.sender, _nonceOrdering);
  87 |      }
```
GitHub: [65-69](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L65-L69), [74-87](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L74-L87)


```solidity
File: code/system-contracts/contracts/NonceHolder.sol

     |  // @audit-issue Add a timelock to the parameter change
  82 |      function setValueUnderNonce(uint256 _key, uint256 _value) public onlySystemCall {
  83 |          IContractDeployer.AccountInfo memory accountInfo = DEPLOYER_SYSTEM_CONTRACT.getAccountInfo(msg.sender);
  85 |          require(_value != 0, "Nonce value cannot be set to 0");
  86 |          // If an account has sequential nonce ordering, we enforce that the previous
  87 |          // nonce has already been used.
  88 |          if (accountInfo.nonceOrdering == IContractDeployer.AccountNonceOrdering.Sequential && _key != 0) {
  89 |              require(isNonceUsed(msg.sender, _key - 1), "Previous nonce has not been used");
  90 |          }
  92 |          uint256 addressAsKey = uint256(uint160(msg.sender));
  94 |          nonceValues[addressAsKey][_key] = _value;
  96 |          emit ValueSetUnderNonce(msg.sender, _key, _value);
  97 |      }
```
GitHub: [82-97](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/NonceHolder.sol#L82-L97)


```solidity
File: code/system-contracts/contracts/SystemContext.sol

     |  // @audit-issue Add a timelock to the parameter change
  84 |  function setChainId(uint256 _newChainId) external onlyCallFromForceDeployer {
  85 |      chainId = _newChainId;
  86 |  }

     |  // @audit-issue Add a timelock to the parameter change
  99 |  function setTxOrigin(address _newOrigin) external onlyCallFromBootloader {
 100 |      origin = _newOrigin;
 101 |  }

     |  // @audit-issue Add a timelock to the parameter change
 105 |  function setGasPrice(uint256 _gasPrice) external onlyCallFromBootloader {
 106 |      gasPrice = _gasPrice;
 107 |  }

     |  // @audit-issue Add a timelock to the parameter change
 112 |  function setPubdataInfo(uint256 _gasPerPubdataByte, uint256 _basePubdataSpent) external onlyCallFromBootloader {
 113 |      basePubdataSpent = _basePubdataSpent;
 114 |      gasPerPubdataByte = _gasPerPubdataByte;
 115 |  }
```
GitHub: [84-86](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L84-L86), [99-101](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L99-L101), [105-107](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L105-L107), [112-115](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L112-L115)


## [N-27] Custom errors should be used rather than `revert()`/`require()`

Custom errors are available from solidity version 0.8.4. Custom errors are more easily processed in `try`-`catch` blocks, and are easier to re-use and maintain.

*Instances: 99*

```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

     |  // @audit-issue Use custom errors with a revert statement
  64 |  require(msg.sender == address(sharedBridge), "Not shared bridge");

     |  // @audit-issue Use custom errors with a revert statement
  66 |  require(amount == _amount, "Incorrect amount");

     |  // @audit-issue Use custom errors with a revert statement
 141 |  require(_amount != 0, "0T"); // empty deposit

     |  // @audit-issue Use custom errors with a revert statement
 143 |  require(amount == _amount, "3T"); // The token has non-standard transfer logic

     |  // @audit-issue Use custom errors with a revert statement
 186 |  require(amount != 0, "2T"); // empty deposit

     |  // @audit-issue Use custom errors with a revert statement
 215 |  require(!isWithdrawalFinalized[_l2BatchNumber][_l2MessageIndex], "pw");
```
GitHub: [64](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L64), [66](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L66), [141](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L141), [143](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L143), [186](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L186), [215](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L215)


```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

     |  // @audit-issue Use custom errors with a revert statement
  69 |  require(msg.sender == address(bridgehub), "ShB not BH");

     |  // @audit-issue Use custom errors with a revert statement
  75 |  require(
  76 |      msg.sender == address(bridgehub) || (_chainId == ERA_CHAIN_ID && msg.sender == ERA_DIAMOND_PROXY),
  77 |      "L1SharedBridge: not bridgehub or era chain"
  78 |  );

     |  // @audit-issue Use custom errors with a revert statement
  84 |  require(msg.sender == address(legacyBridge), "ShB not legacy bridge");

     |  // @audit-issue Use custom errors with a revert statement
 108 |  require(_owner != address(0), "ShB owner 0");

     |  // @audit-issue Use custom errors with a revert statement
 121 |  require(balanceAfter > balanceBefore, "ShB: 0 eth transferred");

     |  // @audit-issue Use custom errors with a revert statement
 129 |  require(amount > 0, "ShB: 0 amount to transfer");

     |  // @audit-issue Use custom errors with a revert statement
 132 |  require(balanceAfter - balanceBefore == amount, "ShB: wrong amount transferred");

     |  // @audit-issue Use custom errors with a revert statement
 138 |  require(bridgehub.getStateTransition(_chainId) == msg.sender, "receiveEth not state transition");

     |  // @audit-issue Use custom errors with a revert statement
 155 |  require(msg.value == _amount, "L1SharedBridge: msg.value not equal to amount");

     |  // @audit-issue Use custom errors with a revert statement
 158 |  require(msg.value == 0, "ShB m.v > 0 b d.it");

     |  // @audit-issue Use custom errors with a revert statement
 161 |  require(amount == _amount, "3T"); // The token has non-standard transfer logic

     |  // @audit-issue Use custom errors with a revert statement
 188 |  require(l2BridgeAddress[_chainId] != address(0), "ShB l2 bridge not deployed");

     |  // @audit-issue Use custom errors with a revert statement
 194 |  require(_l1Token != l1WethAddress, "ShB: WETH deposit not supported");

     |  // @audit-issue Use custom errors with a revert statement
 195 |  require(bridgehub.baseToken(_chainId) != _l1Token, "ShB: baseToken deposit not supported");

     |  // @audit-issue Use custom errors with a revert statement
 200 |  require(_depositAmount == 0, "ShB wrong withdraw amount");

     |  // @audit-issue Use custom errors with a revert statement
 202 |  require(msg.value == 0, "ShB m.v > 0 for BH d.it 2");

     |  // @audit-issue Use custom errors with a revert statement
 206 |  require(withdrawAmount == _depositAmount, "5T"); // The token has non-standard transfer logic

     |  // @audit-issue Use custom errors with a revert statement
 208 |  require(amount != 0, "6T"); // empty deposit amount

     |  // @audit-issue Use custom errors with a revert statement
 237 |  require(depositHappened[_chainId][_txHash] == 0x00, "ShB tx hap");

     |  // @audit-issue Use custom errors with a revert statement
 325 |  require(proofValid, "yn");

     |  // @audit-issue Use custom errors with a revert statement
 327 |  require(_amount > 0, "y1");

     |  // @audit-issue Use custom errors with a revert statement
 342 |  require(dataHash == txDataHash, "ShB: d.it not hap");

     |  // @audit-issue Use custom errors with a revert statement
 349 |  require(chainBalance[_chainId][_l1Token] >= _amount, "ShB n funds");

     |  // @audit-issue Use custom errors with a revert statement
 360 |  require(callSuccess, "ShB: claimFailedDeposit failed");

     |  // @audit-issue Use custom errors with a revert statement
 396 |  require(!legacyBridge.isWithdrawalFinalized(_l2BatchNumber, _l2MessageIndex), "ShB: legacy withdrawal");

     |  // @audit-issue Use custom errors with a revert statement
 417 |  require(!isWithdrawalFinalized[_chainId][_l2BatchNumber][_l2MessageIndex], "Withdrawal is already finalized");

     |  // @audit-issue Use custom errors with a revert statement
 427 |  require(!alreadyFinalized, "Withdrawal is already finalized 2");

     |  // @audit-issue Use custom errors with a revert statement
 439 |  require(chainBalance[_chainId][l1Token] >= amount, "ShB not enough funds 2"); // not enought funds

     |  // @audit-issue Use custom errors with a revert statement
 449 |  require(callSuccess, "ShB: withdraw failed");

     |  // @audit-issue Use custom errors with a revert statement
 484 |  require(success, "ShB withd w proof"); // withdrawal wrong proof

     |  // @audit-issue Use custom errors with a revert statement
 501 |  require(_l2ToL1message.length >= 56, "ShB wrong msg len"); // wrong messsage length

     |  // @audit-issue Use custom errors with a revert statement
 517 |  require(_l2ToL1message.length == 76, "ShB wrong msg len 2");

     |  // @audit-issue Use custom errors with a revert statement
 522 |  revert("ShB Incorrect message function selector");

     |  // @audit-issue Use custom errors with a revert statement
 563 |  require(l2BridgeAddress[ERA_CHAIN_ID] != address(0), "ShB b. n dep");

     |  // @audit-issue Use custom errors with a revert statement
 564 |  require(_l1Token != l1WethAddress, "ShB: WETH deposit not supported 2");
```
GitHub: [69](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L69), [75-78](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L75-L78), [84](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L84), [108](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L108), [121](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L121), [129](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L129), [132](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L132), [138](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L138), [155](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L155), [158](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L158), [161](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L161), [188](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L188), [194](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L194), [195](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L195), [200](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L200), [202](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L202), [206](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L206), [208](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L208), [237](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L237), [325](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L325), [327](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L327), [342](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L342), [349](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L349), [360](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L360), [396](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L396), [417](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L417), [427](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L427), [439](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L439), [449](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L449), [484](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L484), [501](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L501), [517](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L517), [522](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L522), [563](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L563), [564](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L564)


```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

     |  // @audit-issue Use custom errors with a revert statement
  46 |  require(msg.sender == admin || msg.sender == owner(), "Bridgehub: not owner or admin");

     |  // @audit-issue Use custom errors with a revert statement
  62 |  require(msg.sender == currentPendingAdmin, "n42"); // Only proposed by current admin address can claim the admin rights

     |  // @audit-issue Use custom errors with a revert statement
  83 |  require(
  84 |      !stateTransitionManagerIsRegistered[_stateTransitionManager],
  85 |      "Bridgehub: state transition already registered"
  86 |  );

     |  // @audit-issue Use custom errors with a revert statement
  93 |  require(
  94 |      stateTransitionManagerIsRegistered[_stateTransitionManager],
  95 |      "Bridgehub: state transition not registered yet"
  96 |  );

     |  // @audit-issue Use custom errors with a revert statement
 102 |  require(!tokenIsRegistered[_token], "Bridgehub: token already registered");

     |  // @audit-issue Use custom errors with a revert statement
 122 |  require(_chainId != 0, "Bridgehub: chainId cannot be 0");

     |  // @audit-issue Use custom errors with a revert statement
 123 |  require(_chainId <= type(uint48).max, "Bridgehub: chainId too large");

     |  // @audit-issue Use custom errors with a revert statement
 125 |  require(
 126 |      stateTransitionManagerIsRegistered[_stateTransitionManager],
 127 |      "Bridgehub: state transition not registered"
 128 |  );

     |  // @audit-issue Use custom errors with a revert statement
 129 |  require(tokenIsRegistered[_baseToken], "Bridgehub: token not registered");

     |  // @audit-issue Use custom errors with a revert statement
 130 |  require(address(sharedBridge) != address(0), "Bridgehub: weth bridge not set");

     |  // @audit-issue Use custom errors with a revert statement
 132 |  require(stateTransitionManager[_chainId] == address(0), "Bridgehub: chainId already registered");

     |  // @audit-issue Use custom errors with a revert statement
 223 |  require(msg.value == _request.mintValue, "Bridgehub: msg.value mismatch 1");

     |  // @audit-issue Use custom errors with a revert statement
 225 |  require(msg.value == 0, "Bridgehub: non-eth bridge with msg.value");

     |  // @audit-issue Use custom errors with a revert statement
 269 |  require(
 270 |      msg.value == _request.mintValue + _request.secondBridgeValue,
 271 |      "Bridgehub: msg.value mismatch 2"
 272 |  );

     |  // @audit-issue Use custom errors with a revert statement
 275 |  require(msg.value == _request.secondBridgeValue, "Bridgehub: msg.value mismatch 3");

     |  // @audit-issue Use custom errors with a revert statement
 296 |  require(outputRequest.magicValue == TWO_BRIDGES_MAGIC_VALUE, "Bridgehub: magic value mismatch");

     |  // @audit-issue Use custom errors with a revert statement
 300 |  require(
 301 |      _request.secondBridgeAddress > BRIDGEHUB_MIN_SECOND_BRIDGE_ADDRESS,
 302 |      "Bridgehub: second bridge address too low"
 303 |  ); // to avoid calls to precompiles
```
GitHub: [46](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L46), [62](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L62), [83-86](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L83-L86), [93-96](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L93-L96), [102](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L102), [122](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L122), [123](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L123), [125-128](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L125-L128), [129](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L129), [130](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L130), [132](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L132), [223](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L223), [225](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L225), [269-272](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L269-L272), [275](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L275), [296](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L296), [300-303](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L300-L303)


```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

     |  // @audit-issue Use custom errors with a revert statement
  42 |  require(_admin != address(0), "Admin should be non zero address");

     |  // @audit-issue Use custom errors with a revert statement
  59 |  require(msg.sender == address(this), "Only governance contract itself is allowed to call this function");

     |  // @audit-issue Use custom errors with a revert statement
  65 |  require(msg.sender == securityCouncil, "Only security council is allowed to call this function");

     |  // @audit-issue Use custom errors with a revert statement
  71 |  require(
  72 |      msg.sender == owner() || msg.sender == securityCouncil,
  73 |      "Only the owner and security council are allowed to call this function"
  74 |  );

     |  // @audit-issue Use custom errors with a revert statement
 155 |  require(isOperationPending(_id), "Operation must be pending");

     |  // @audit-issue Use custom errors with a revert statement
 172 |  require(isOperationReady(id), "Operation must be ready before execution");

     |  // @audit-issue Use custom errors with a revert statement
 177 |  require(isOperationReady(id), "Operation must be ready after execution");

     |  // @audit-issue Use custom errors with a revert statement
 191 |  require(isOperationPending(id), "Operation must be pending before execution");

     |  // @audit-issue Use custom errors with a revert statement
 196 |  require(isOperationPending(id), "Operation must be pending after execution");

     |  // @audit-issue Use custom errors with a revert statement
 216 |  require(!isOperation(_id), "Operation with this proposal id already exists");

     |  // @audit-issue Use custom errors with a revert statement
 217 |  require(_delay >= minDelay, "Proposed delay is less than minimum delay");

     |  // @audit-issue Use custom errors with a revert statement
 240 |  require(_predecessorId == bytes32(0) || isOperationDone(_predecessorId), "Predecessor operation not completed");
```
GitHub: [42](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L42), [59](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L59), [65](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L65), [71-74](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L71-L74), [155](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L155), [172](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L172), [177](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L177), [191](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L191), [196](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L196), [216](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L216), [217](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L217), [240](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L240)


```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

     |  // @audit-issue Use custom errors with a revert statement
  66 |  require(msg.sender == bridgehub, "StateTransition: only bridgehub");

     |  // @audit-issue Use custom errors with a revert statement
  72 |  require(msg.sender == admin || msg.sender == owner(), "Bridgehub: not owner or admin");

     |  // @audit-issue Use custom errors with a revert statement
  84 |  require(_initializeData.governor != address(0), "StateTransition: governor zero");

     |  // @audit-issue Use custom errors with a revert statement
 123 |  require(msg.sender == currentPendingAdmin, "n42"); // Only proposed by current admin address can claim the admin rights

     |  // @audit-issue Use custom errors with a revert statement
 258 |  require(cutHashInput == initialCutHash, "StateTransition: initial cutHash mismatch");
```
GitHub: [66](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L66), [72](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L72), [84](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L84), [123](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L123), [258](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L258)


```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

     |  // @audit-issue Use custom errors with a revert statement
  62 |  require(msg.sender == stateTransitionManager.getChainAdmin(_chainId), "ValidatorTimelock: only chain admin");

     |  // @audit-issue Use custom errors with a revert statement
  68 |  require(validators[_chainId][msg.sender] == true, "ValidatorTimelock: only validator");

     |  // @audit-issue Use custom errors with a revert statement
 195 |  require(block.timestamp >= commitBatchTimestamp + delay, "5c"); // The delay is not passed

     |  // @audit-issue Use custom errors with a revert statement
 217 |  require(block.timestamp >= commitBatchTimestamp + delay, "5c"); // The delay is not passed
```
GitHub: [62](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L62), [68](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L68), [195](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L195), [217](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L217)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol

     |  // @audit-issue Use custom errors with a revert statement
  25 |  require(address(_initializeData.verifier) != address(0), "vt");

     |  // @audit-issue Use custom errors with a revert statement
  26 |  require(_initializeData.admin != address(0), "vy");

     |  // @audit-issue Use custom errors with a revert statement
  27 |  require(_initializeData.validatorTimelock != address(0), "hc");

     |  // @audit-issue Use custom errors with a revert statement
  28 |  require(_initializeData.priorityTxMaxGasLimit <= MAX_GAS_PER_TRANSACTION, "vu");
```
GitHub: [25](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol#L25), [26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol#L26), [27](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol#L27), [28](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol#L28)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol

     |  // @audit-issue Use custom errors with a revert statement
  14 |  require(_chainId == block.chainid, "pr");

     |  // @audit-issue Use custom errors with a revert statement
  25 |  require(msg.data.length >= 4 || msg.data.length == 0, "Ut");

     |  // @audit-issue Use custom errors with a revert statement
  30 |  require(facetAddress != address(0), "F"); // Proxy has no facet for this selector

     |  // @audit-issue Use custom errors with a revert statement
  31 |  require(!diamondStorage.isFrozen || !facet.isFreezable, "q1"); // Facet is frozen
```
GitHub: [14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol#L14), [25](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol#L25), [30](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol#L30), [31](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol#L31)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol

     |  // @audit-issue Use custom errors with a revert statement
  34 |  require(msg.sender == pendingAdmin, "n4"); // Only proposed by current admin address can claim the admin rights

     |  // @audit-issue Use custom errors with a revert statement
  59 |  require(_newPriorityTxMaxGasLimit <= MAX_GAS_PER_TRANSACTION, "n5");

     |  // @audit-issue Use custom errors with a revert statement
  70 |  require(_newFeeParams.maxPubdataPerBatch >= _newFeeParams.priorityTxMaxPubdata, "n6");

     |  // @audit-issue Use custom errors with a revert statement
  90 |  require(s.totalBatchesCommitted == 0, "AdminFacet: set validium only after genesis"); // Validium mode can be set only before the first batch is committed

     |  // @audit-issue Use custom errors with a revert statement
 105 |  require(
 106 |      cutHashInput == IStateTransitionManager(s.stateTransitionManager).upgradeCutHash(_oldProtocolVersion),
 107 |      "StateTransition: cutHash mismatch"
 108 |  );

     |  // @audit-issue Use custom errors with a revert statement
 110 |  require(
 111 |      s.protocolVersion == _oldProtocolVersion,
 112 |      "StateTransition: protocolVersion mismatch in STC when upgrading"
 113 |  );

     |  // @audit-issue Use custom errors with a revert statement
 116 |  require(
 117 |      s.protocolVersion > _oldProtocolVersion,
 118 |      "StateTransition: protocolVersion mismatch in STC after upgrading"
 119 |  );

     |  // @audit-issue Use custom errors with a revert statement
 136 |  require(!diamondStorage.isFrozen, "a9"); // diamond proxy is frozen already

     |  // @audit-issue Use custom errors with a revert statement
 146 |  require(diamondStorage.isFrozen, "a7"); // diamond proxy is not frozen
```
GitHub: [34](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L34), [59](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L59), [70](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L70), [90](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L90), [105-108](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L105-L108), [110-113](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L110-L113), [116-119](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L116-L119), [136](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L136), [146](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L146)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

     |  // @audit-issue Use custom errors with a revert statement
  37 |  require(_newBatch.batchNumber == _previousBatch.batchNumber + 1, "f"); // only commit next batch

     |  // @audit-issue Use custom errors with a revert statement
  40 |  require(pubdataSource == uint8(PubdataSource.Calldata) || pubdataSource == uint8(PubdataSource.Blob), "us");

     |  // @audit-issue Use custom errors with a revert statement
  50 |  require(logOutput.pubdataHash == 0x00, "v0h");
```
GitHub: [37](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L37), [40](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L40), [50](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L50)


## [N-28] Duplicate `require()`/`revert()` checks should be refactored to a modifier or function

The compiler will inline the function, which will avoid `JUMP` instructions usually associated with functions.

*Instances: 17*

```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

     |  // @audit-info Duplicates of this require()/revert() were detected
 143 |  require(amount == _amount, "3T"); // The token has non-standard transfer logic

File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol
     |      // @audit-issue First seen at code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol:143
 161 |      require(amount == _amount, "3T"); // The token has non-standard transfer logic
```
GitHub: [161](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L161)


```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

     |  // @audit-info Duplicates of this require()/revert() were detected
  46 |  require(msg.sender == admin || msg.sender == owner(), "Bridgehub: not owner or admin");

File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol
     |  // @audit-issue First seen at code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol:46
  72 |  require(msg.sender == admin || msg.sender == owner(), "Bridgehub: not owner or admin");
```
GitHub: [72](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L72)


```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

     |  // @audit-info Duplicates of this require()/revert() were detected
  62 |  require(msg.sender == currentPendingAdmin, "n42"); // Only proposed by current admin address can claim the admin rights

File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol
     |  // @audit-issue First seen at code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol:62
 123 |  require(msg.sender == currentPendingAdmin, "n42"); // Only proposed by current admin address can claim the admin rights
```
GitHub: [123](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L123)


```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

     |  // @audit-info Duplicates of this require()/revert() were detected
 195 |  require(block.timestamp >= commitBatchTimestamp + delay, "5c"); // The delay is not passed
  :  |
     |  // @audit-issue First seen at code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol:195
 217 |  require(block.timestamp >= commitBatchTimestamp + delay, "5c"); // The delay is not passed
```
GitHub: [217](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L217)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol

     |  // @audit-info Duplicates of this require()/revert() were detected
  70 |  require(_newFeeParams.maxPubdataPerBatch >= _newFeeParams.priorityTxMaxPubdata, "n6");

File: code/contracts/ethereum/contracts/upgrades/Upgrade_v1_4_1.sol
     |  // @audit-issue First seen at code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol:70
  23 |  require(_newFeeParams.maxPubdataPerBatch >= _newFeeParams.priorityTxMaxPubdata, "n6");
```
GitHub: [23](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/Upgrade_v1_4_1.sol#L23)


```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol

     |  // @audit-info Duplicates of this require()/revert() were detected
  72 |  require(block.timestamp >= _proposedUpgrade.upgradeTimestamp, "Upgrade is not ready yet");

File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol
     |  // @audit-issue First seen at code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol:72
  52 |  require(block.timestamp >= _proposedUpgrade.upgradeTimestamp, "Upgrade is not ready yet");
```
GitHub: [52](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L52)


```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol

     |  // @audit-info Duplicates of this require()/revert() were detected
 242 |  require(
 243 |      _newProtocolVersion - previousProtocolVersion <= MAX_ALLOWED_PROTOCOL_VERSION_DELTA,
 244 |      "Too big protocol version difference"
 245 |  );

File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol
     |  // @audit-issue First seen at code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol:242
  27 |  require(
  28 |      _newProtocolVersion - previousProtocolVersion <= MAX_ALLOWED_PROTOCOL_VERSION_DELTA,
  29 |      "Too big protocol version difference"
  30 |  );
```
GitHub: [27-30](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L27-L30)


```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol

     |  // @audit-info Duplicates of this require()/revert() were detected
 249 |  require(s.l2SystemContractsUpgradeTxHash == bytes32(0), "Previous upgrade has not been finalized");

File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol
     |  // @audit-issue First seen at code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol:249
  33 |  require(s.l2SystemContractsUpgradeTxHash == bytes32(0), "Previous upgrade has not been finalized");
```
GitHub: [33](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L33)


```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol

     |  // @audit-info Duplicates of this require()/revert() were detected
 250 |  require(
 251 |      s.l2SystemContractsUpgradeBatchNumber == 0,
 252 |      "The batch number of the previous upgrade has not been cleaned"
 253 |  );

File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol
     |  // @audit-issue First seen at code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol:250
  34 |  require(
  35 |      s.l2SystemContractsUpgradeBatchNumber == 0,
  36 |      "The batch number of the previous upgrade has not been cleaned"
  37 |  );
```
GitHub: [34-37](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L34-L37)


```solidity
File: code/system-contracts/contracts/AccountCodeStorage.sol

     |  // @audit-info Duplicates of this require()/revert() were detected
  26 |  require(msg.sender == address(DEPLOYER_SYSTEM_CONTRACT), "Callable only by the deployer system contract");

File: code/system-contracts/contracts/ImmutableSimulator.sol
     |  // @audit-issue First seen at code/system-contracts/contracts/AccountCodeStorage.sol:26
  35 |  require(msg.sender == address(DEPLOYER_SYSTEM_CONTRACT), "Callable only by the deployer system contract");
```
GitHub: [35](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ImmutableSimulator.sol#L35)


```solidity
File: code/system-contracts/contracts/BootloaderUtilities.sol

     |  // @audit-info Duplicates of this require()/revert() were detected
  92 |  require(vInt == 27 || vInt == 28, "Invalid v value");
  :  |
     |  // @audit-issue First seen at code/system-contracts/contracts/BootloaderUtilities.sol:92
 191 |  require(vInt == 27 || vInt == 28, "Invalid v value");
  :  |
     |  // @audit-issue First seen at code/system-contracts/contracts/BootloaderUtilities.sol:92
 286 |  require(vInt == 27 || vInt == 28, "Invalid v value");
```
GitHub: [191](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L191), [286](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L286)


```solidity
File: code/contracts/zksync/contracts/TestnetPaymaster.sol

     |  // @audit-info Duplicates of this require()/revert() were detected
  23 |  require(_transaction.paymasterInput.length >= 4, "The standard paymaster input must be at least 4 bytes long");

File: code/system-contracts/contracts/libraries/TransactionHelper.sol
     |  // @audit-issue First seen at code/contracts/zksync/contracts/TestnetPaymaster.sol:23
 363 |  require(_transaction.paymasterInput.length >= 4, "The standard paymaster input must be at least 4 bytes long");
```
GitHub: [363](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L363)


```solidity
File: code/contracts/zksync/contracts/TestnetPaymaster.sol

     |  // @audit-info Duplicates of this require()/revert() were detected
  66 |  revert("Unsupported paymaster flow");

File: code/system-contracts/contracts/libraries/TransactionHelper.sol
     |  // @audit-issue First seen at code/contracts/zksync/contracts/TestnetPaymaster.sol:66
 388 |  revert("Unsupported paymaster flow");
```
GitHub: [388](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L388)


```solidity
File: code/contracts/zksync/contracts/SystemContractsCaller.sol

     |  // @audit-info Duplicates of this require()/revert() were detected
  28 |  require(_x <= type(uint32).max, "Overflow");

File: code/system-contracts/contracts/libraries/Utils.sol
     |  // @audit-issue First seen at code/contracts/zksync/contracts/SystemContractsCaller.sol:28
  27 |  require(_x <= type(uint32).max, "Overflow");
```
GitHub: [27](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L27)


```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

     |  // @audit-info Duplicates of this require()/revert() were detected
  56 |  require(_l2TokenProxyBytecodeHash != bytes32(0), "df");
  :  |
     |  // @audit-issue First seen at code/contracts/zksync/contracts/bridge/L2SharedBridge.sol:56
  58 |  require(_l2TokenProxyBytecodeHash != bytes32(0), "df");
```
GitHub: [58](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L58)


```solidity
File: code/contracts/zksync/contracts/bridge/L2WrappedBaseToken.sol

     |  // @audit-info Duplicates of this require()/revert() were detected
  84 |  require(success, "Failed withdrawal");
  :  |
     |  // @audit-issue First seen at code/contracts/zksync/contracts/bridge/L2WrappedBaseToken.sol:84
 109 |  require(success, "Failed withdrawal");
```
GitHub: [109](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2WrappedBaseToken.sol#L109)


## [N-29] Duplicate functions defined

Where possible, the following duplicated function definitions should be refactored into a common base contract or library.

*Instances: 8*

```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

     |  // @audit-info Duplicates of this function were detected
  51 |  function setPendingAdmin(address _newPendingAdmin) external onlyOwnerOrAdmin {
  52 |      // Save previous value into the stack to put it into the event later
  53 |      address oldPendingAdmin = pendingAdmin;
  54 |      // Change pending admin
  55 |      pendingAdmin = _newPendingAdmin;
  56 |      emit NewPendingAdmin(oldPendingAdmin, _newPendingAdmin);
  57 |  }

File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol
     |  // @audit-issue First seen at code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol:51
 112 |  function setPendingAdmin(address _newPendingAdmin) external onlyOwnerOrAdmin {
 113 |      // Save previous value into the stack to put it into the event later
 114 |      address oldPendingAdmin = pendingAdmin;
 115 |      // Change pending admin
 116 |      pendingAdmin = _newPendingAdmin;
 117 |      emit NewPendingAdmin(oldPendingAdmin, _newPendingAdmin);
 118 |  }
```
GitHub: [112-118](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L112-L118)


```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

     |  // @audit-info Duplicates of this function were detected
  60 |      function acceptAdmin() external {
  61 |          address currentPendingAdmin = pendingAdmin;
  62 |          require(msg.sender == currentPendingAdmin, "n42"); // Only proposed by current admin address can claim the admin rights
  64 |          address previousAdmin = admin;
  65 |          admin = currentPendingAdmin;
  66 |          delete pendingAdmin;
  68 |          emit NewPendingAdmin(currentPendingAdmin, address(0));
  69 |          emit NewAdmin(previousAdmin, pendingAdmin);
  70 |      }

File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol
     |  // @audit-issue First seen at code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol:60
 121 |      function acceptAdmin() external {
 122 |          address currentPendingAdmin = pendingAdmin;
 123 |          require(msg.sender == currentPendingAdmin, "n42"); // Only proposed by current admin address can claim the admin rights
 125 |          address previousAdmin = admin;
 126 |          admin = currentPendingAdmin;
 127 |          delete pendingAdmin;
 129 |          emit NewPendingAdmin(currentPendingAdmin, address(0));
 130 |          emit NewAdmin(previousAdmin, pendingAdmin);
 131 |      }
```
GitHub: [121-131](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L121-L131)


```solidity
File: code/contracts/ethereum/contracts/upgrades/DefaultUpgrade.sol

     |  // @audit-info Duplicates of this function were detected
  13 |  function upgrade(ProposedUpgrade calldata _proposedUpgrade) public override returns (bytes32) {
  14 |      super.upgrade(_proposedUpgrade);
  15 |      return Diamond.DIAMOND_INIT_SUCCESS_RETURN_VALUE;
  16 |  }

File: code/contracts/ethereum/contracts/upgrades/GenesisUpgrade.sol
     |  // @audit-issue First seen at code/contracts/ethereum/contracts/upgrades/DefaultUpgrade.sol:13
  14 |  function upgrade(ProposedUpgrade calldata _proposedUpgrade) public override returns (bytes32) {
  15 |      super.upgrade(_proposedUpgrade);
  16 |      return Diamond.DIAMOND_INIT_SUCCESS_RETURN_VALUE;
  17 |  }
```
GitHub: [14-17](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/GenesisUpgrade.sol#L14-L17)


```solidity
File: code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol

     |  // @audit-info Duplicates of this function were detected
  60 |      function computeCreate2Address(
  61 |          address _sender,
  62 |          bytes32 _salt,
  63 |          bytes32 _bytecodeHash,
  64 |          bytes32 _constructorInputHash
  65 |      ) internal pure returns (address) {
  66 |          bytes32 senderBytes = bytes32(uint256(uint160(_sender)));
  67 |          bytes32 data = keccak256(
  68 |              bytes.concat(CREATE2_PREFIX, senderBytes, _salt, _bytecodeHash, _constructorInputHash)
  69 |          );
  71 |          return address(uint160(uint256(data)));
  72 |      }

File: code/contracts/zksync/contracts/L2ContractHelper.sol
     |  // @audit-issue First seen at code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol:60
 101 |      function computeCreate2Address(
 102 |          address _sender,
 103 |          bytes32 _salt,
 104 |          bytes32 _bytecodeHash,
 105 |          bytes32 _constructorInputHash
 106 |      ) internal pure returns (address) {
 107 |          bytes32 senderBytes = bytes32(uint256(uint160(_sender)));
 108 |          bytes32 data = keccak256(
 109 |              bytes.concat(CREATE2_PREFIX, senderBytes, _salt, _bytecodeHash, _constructorInputHash)
 110 |          );
 112 |          return address(uint160(uint256(data)));
 113 |      }
```
GitHub: [101-113](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/L2ContractHelper.sol#L101-L113)


```solidity
File: code/contracts/zksync/contracts/SystemContractsCaller.sol

     |  // @audit-info Duplicates of this function were detected
  76 |      function systemCallWithReturndata(
  77 |          uint32 gasLimit,
  78 |          address to,
  79 |          uint128 value,
  80 |          bytes memory data
  81 |      ) internal returns (bool success, bytes memory returnData) {
  82 |          success = systemCall(gasLimit, to, value, data);
  84 |          uint256 size;
  85 |          assembly {
  86 |              size := returndatasize()
  87 |          }
  89 |          returnData = new bytes(size);
  90 |          assembly {
  91 |              returndatacopy(add(returnData, 0x20), 0, size)
  92 |          }
  93 |      }

File: code/system-contracts/contracts/libraries/SystemContractsCaller.sol
     |  // @audit-issue First seen at code/contracts/zksync/contracts/SystemContractsCaller.sol:76
 123 |      function systemCallWithReturndata(
 124 |          uint32 gasLimit,
 125 |          address to,
 126 |          uint128 value,
 127 |          bytes memory data
 128 |      ) internal returns (bool success, bytes memory returnData) {
 129 |          success = systemCall(gasLimit, to, value, data);
 131 |          uint256 size;
 132 |          assembly {
 133 |              size := returndatasize()
 134 |          }
 136 |          returnData = new bytes(size);
 137 |          assembly {
 138 |              returndatacopy(add(returnData, 0x20), 0, size)
 139 |          }
 140 |      }
```
GitHub: [123-140](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L123-L140)


```solidity
File: code/contracts/zksync/contracts/SystemContractsCaller.sol

     |  // @audit-info Duplicates of this function were detected
  95 |  function getFarCallABI(
  96 |      uint32 dataOffset,
  97 |      uint32 memoryPage,
  98 |      uint32 dataStart,
  99 |      uint32 dataLength,
 100 |      uint32 gasPassed,
 101 |      uint8 shardId,
 102 |      CalldataForwardingMode forwardingMode,
 103 |      bool isConstructorCall,
 104 |      bool isSystemCall
 105 |  ) internal pure returns (uint256 farCallAbi) {
 106 |      // Fill in the call parameter fields
 107 |      farCallAbi = getFarCallABIWithEmptyFatPointer(
 108 |          gasPassed,
 109 |          shardId,
 110 |          forwardingMode,
 111 |          isConstructorCall,
 112 |          isSystemCall
 113 |      );
 114 |      // Fill in the fat pointer fields
 115 |      farCallAbi |= dataOffset;
 116 |      farCallAbi |= (uint256(memoryPage) << 32);
 117 |      farCallAbi |= (uint256(dataStart) << 64);
 118 |      farCallAbi |= (uint256(dataLength) << 96);
 119 |  }

File: code/system-contracts/contracts/libraries/SystemContractsCaller.sol
     |  // @audit-issue First seen at code/contracts/zksync/contracts/SystemContractsCaller.sol:95
 214 |  function getFarCallABI(
 215 |      uint32 dataOffset,
 216 |      uint32 memoryPage,
 217 |      uint32 dataStart,
 218 |      uint32 dataLength,
 219 |      uint32 gasPassed,
 220 |      uint8 shardId,
 221 |      CalldataForwardingMode forwardingMode,
 222 |      bool isConstructorCall,
 223 |      bool isSystemCall
 224 |  ) internal pure returns (uint256 farCallAbi) {
 225 |      // Fill in the call parameter fields
 226 |      farCallAbi = getFarCallABIWithEmptyFatPointer(
 227 |          gasPassed,
 228 |          shardId,
 229 |          forwardingMode,
 230 |          isConstructorCall,
 231 |          isSystemCall
 232 |      );
 233 |      // Fill in the fat pointer fields
 234 |      farCallAbi |= dataOffset;
 235 |      farCallAbi |= (uint256(memoryPage) << 32);
 236 |      farCallAbi |= (uint256(dataStart) << 64);
 237 |      farCallAbi |= (uint256(dataLength) << 96);
 238 |  }
```
GitHub: [214-238](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L214-L238)


```solidity
File: code/contracts/zksync/contracts/SystemContractsCaller.sol

     |  // @audit-info Duplicates of this function were detected
 121 |  function getFarCallABIWithEmptyFatPointer(
 122 |      uint32 gasPassed,
 123 |      uint8 shardId,
 124 |      CalldataForwardingMode forwardingMode,
 125 |      bool isConstructorCall,
 126 |      bool isSystemCall
 127 |  ) internal pure returns (uint256 farCallAbiWithEmptyFatPtr) {
 128 |      farCallAbiWithEmptyFatPtr |= (uint256(gasPassed) << 192);
 129 |      farCallAbiWithEmptyFatPtr |= (uint256(forwardingMode) << 224);
 130 |      farCallAbiWithEmptyFatPtr |= (uint256(shardId) << 232);
 131 |      if (isConstructorCall) {
 132 |          farCallAbiWithEmptyFatPtr |= (1 << 240);
 133 |      }
 134 |      if (isSystemCall) {
 135 |          farCallAbiWithEmptyFatPtr |= (1 << 248);
 136 |      }
 137 |  }

File: code/system-contracts/contracts/libraries/SystemContractsCaller.sol
     |  // @audit-issue First seen at code/contracts/zksync/contracts/SystemContractsCaller.sol:121
 250 |  function getFarCallABIWithEmptyFatPointer(
 251 |      uint32 gasPassed,
 252 |      uint8 shardId,
 253 |      CalldataForwardingMode forwardingMode,
 254 |      bool isConstructorCall,
 255 |      bool isSystemCall
 256 |  ) internal pure returns (uint256 farCallAbiWithEmptyFatPtr) {
 257 |      farCallAbiWithEmptyFatPtr |= (uint256(gasPassed) << 192);
 258 |      farCallAbiWithEmptyFatPtr |= (uint256(forwardingMode) << 224);
 259 |      farCallAbiWithEmptyFatPtr |= (uint256(shardId) << 232);
 260 |      if (isConstructorCall) {
 261 |          farCallAbiWithEmptyFatPtr |= (1 << 240);
 262 |      }
 263 |      if (isSystemCall) {
 264 |          farCallAbiWithEmptyFatPtr |= (1 << 248);
 265 |      }
 266 |  }
```
GitHub: [250-266](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L250-L266)


```solidity
File: code/contracts/zksync/contracts/SystemContractsCaller.sol

     |  // @audit-info Duplicates of this function were detected
  27 |      function safeCastToU32(uint256 _x) internal pure returns (uint32) {
  28 |          require(_x <= type(uint32).max, "Overflow");
  30 |          return uint32(_x);
  31 |      }

File: code/system-contracts/contracts/libraries/Utils.sol
     |  // @audit-issue First seen at code/contracts/zksync/contracts/SystemContractsCaller.sol:27
  26 |      function safeCastToU32(uint256 _x) internal pure returns (uint32) {
  27 |          require(_x <= type(uint32).max, "Overflow");
  29 |          return uint32(_x);
  30 |      }
```
GitHub: [26-30](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L26-L30)


## [N-30] Duplicate strings defined

For better maintainability, consider creating and using a constant for those strings instead of duplicating it.

*Instances: 13*

```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

     |  // @audit-info Duplicates of this string were detected
  46 |  require(msg.sender == admin || msg.sender == owner(), "Bridgehub: not owner or admin");

File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol
     |  // @audit-issue First seen at code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol:46
  72 |  require(msg.sender == admin || msg.sender == owner(), "Bridgehub: not owner or admin");
```
GitHub: [72](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L72)


```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol

     |  // @audit-info Duplicates of this string were detected
  72 |  require(block.timestamp >= _proposedUpgrade.upgradeTimestamp, "Upgrade is not ready yet");

File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol
     |  // @audit-issue First seen at code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol:72
  52 |  require(block.timestamp >= _proposedUpgrade.upgradeTimestamp, "Upgrade is not ready yet");
```
GitHub: [52](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L52)


```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol

     |  // @audit-info Duplicates of this string were detected
 240 |  "New protocol version is not greater than the current one"

File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol
     |  // @audit-issue First seen at code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol:240
  25 |  "New protocol version is not greater than the current one"
```
GitHub: [25](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L25)


```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol

     |  // @audit-info Duplicates of this string were detected
 244 |  "Too big protocol version difference"

File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol
     |  // @audit-issue First seen at code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol:244
  29 |  "Too big protocol version difference"
```
GitHub: [29](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L29)


```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol

     |  // @audit-info Duplicates of this string were detected
 249 |  require(s.l2SystemContractsUpgradeTxHash == bytes32(0), "Previous upgrade has not been finalized");

File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol
     |  // @audit-issue First seen at code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol:249
  33 |  require(s.l2SystemContractsUpgradeTxHash == bytes32(0), "Previous upgrade has not been finalized");
```
GitHub: [33](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L33)


```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol

     |  // @audit-info Duplicates of this string were detected
 252 |  "The batch number of the previous upgrade has not been cleaned"

File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol
     |  // @audit-issue First seen at code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol:252
  36 |  "The batch number of the previous upgrade has not been cleaned"
```
GitHub: [36](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L36)


```solidity
File: code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol

     |  // @audit-info Duplicates of this string were detected
  12 |  bytes32 private constant CREATE2_PREFIX = keccak256("zksyncCreate2");

File: code/contracts/zksync/contracts/L2ContractHelper.sol
     |  // @audit-issue First seen at code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol:12
  85 |  bytes32 private constant CREATE2_PREFIX = keccak256("zksyncCreate2");
```
GitHub: [85](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/L2ContractHelper.sol#L85)


```solidity
File: code/system-contracts/contracts/AccountCodeStorage.sol

     |  // @audit-info Duplicates of this string were detected
  26 |  require(msg.sender == address(DEPLOYER_SYSTEM_CONTRACT), "Callable only by the deployer system contract");

File: code/system-contracts/contracts/ImmutableSimulator.sol
     |  // @audit-issue First seen at code/system-contracts/contracts/AccountCodeStorage.sol:26
  35 |  require(msg.sender == address(DEPLOYER_SYSTEM_CONTRACT), "Callable only by the deployer system contract");
```
GitHub: [35](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ImmutableSimulator.sol#L35)


```solidity
File: code/system-contracts/contracts/BootloaderUtilities.sol

     |  // @audit-info Duplicates of this string were detected
  92 |  require(vInt == 27 || vInt == 28, "Invalid v value");
  :  |
     |  // @audit-issue First seen at code/system-contracts/contracts/BootloaderUtilities.sol:92
 191 |  require(vInt == 27 || vInt == 28, "Invalid v value");
  :  |
     |  // @audit-issue First seen at code/system-contracts/contracts/BootloaderUtilities.sol:92
 286 |  require(vInt == 27 || vInt == 28, "Invalid v value");
```
GitHub: [191](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L191), [286](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L286)


```solidity
File: code/contracts/zksync/contracts/TestnetPaymaster.sol

     |  // @audit-info Duplicates of this string were detected
  23 |  require(_transaction.paymasterInput.length >= 4, "The standard paymaster input must be at least 4 bytes long");

File: code/system-contracts/contracts/libraries/TransactionHelper.sol
     |  // @audit-issue First seen at code/contracts/zksync/contracts/TestnetPaymaster.sol:23
 363 |  require(_transaction.paymasterInput.length >= 4, "The standard paymaster input must be at least 4 bytes long");
```
GitHub: [363](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L363)


```solidity
File: code/contracts/zksync/contracts/TestnetPaymaster.sol

     |  // @audit-info Duplicates of this string were detected
  66 |  revert("Unsupported paymaster flow");

File: code/system-contracts/contracts/libraries/TransactionHelper.sol
     |  // @audit-issue First seen at code/contracts/zksync/contracts/TestnetPaymaster.sol:66
 388 |  revert("Unsupported paymaster flow");
```
GitHub: [388](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L388)


```solidity
File: code/contracts/zksync/contracts/bridge/L2WrappedBaseToken.sol

     |  // @audit-info Duplicates of this string were detected
  84 |  require(success, "Failed withdrawal");
  :  |
     |  // @audit-issue First seen at code/contracts/zksync/contracts/bridge/L2WrappedBaseToken.sol:84
 109 |  require(success, "Failed withdrawal");
```
GitHub: [109](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2WrappedBaseToken.sol#L109)


## [N-31] Error messages should be descriptive, rather that cryptic

The error message should clearly state _how_/_why_ something is an error, not just that a specific error state was reached; someone shouldn't have to read the code in order to see how to resolve the problem.

*Instances: 99*

```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

     |  // @audit-issue Use a more informative error description
 141 |  require(_amount != 0, "0T"); // empty deposit

     |  // @audit-issue Use a more informative error description
 143 |  require(amount == _amount, "3T"); // The token has non-standard transfer logic

     |  // @audit-issue Use a more informative error description
 186 |  require(amount != 0, "2T"); // empty deposit

     |  // @audit-issue Use a more informative error description
 215 |  require(!isWithdrawalFinalized[_l2BatchNumber][_l2MessageIndex], "pw");
```
GitHub: [141](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L141), [143](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L143), [186](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L186), [215](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L215)


```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

     |  // @audit-issue Use a more informative error description
  69 |  require(msg.sender == address(bridgehub), "ShB not BH");

     |  // @audit-issue Use a more informative error description
 108 |  require(_owner != address(0), "ShB owner 0");

     |  // @audit-issue Use a more informative error description
 161 |  require(amount == _amount, "3T"); // The token has non-standard transfer logic

     |  // @audit-issue Use a more informative error description
 206 |  require(withdrawAmount == _depositAmount, "5T"); // The token has non-standard transfer logic

     |  // @audit-issue Use a more informative error description
 208 |  require(amount != 0, "6T"); // empty deposit amount

     |  // @audit-issue Use a more informative error description
 237 |  require(depositHappened[_chainId][_txHash] == 0x00, "ShB tx hap");

     |  // @audit-issue Use a more informative error description
 325 |  require(proofValid, "yn");

     |  // @audit-issue Use a more informative error description
 327 |  require(_amount > 0, "y1");

     |  // @audit-issue Use a more informative error description
 349 |  require(chainBalance[_chainId][_l1Token] >= _amount, "ShB n funds");

     |  // @audit-issue Use a more informative error description
 563 |  require(l2BridgeAddress[ERA_CHAIN_ID] != address(0), "ShB b. n dep");
```
GitHub: [69](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L69), [108](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L108), [161](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L161), [206](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L206), [208](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L208), [237](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L237), [325](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L325), [327](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L327), [349](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L349), [563](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L563)


```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

     |  // @audit-issue Use a more informative error description
  62 |  require(msg.sender == currentPendingAdmin, "n42"); // Only proposed by current admin address can claim the admin rights
```
GitHub: [62](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L62)


```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

     |  // @audit-issue Use a more informative error description
 123 |  require(msg.sender == currentPendingAdmin, "n42"); // Only proposed by current admin address can claim the admin rights
```
GitHub: [123](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L123)


```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

     |  // @audit-issue Use a more informative error description
 195 |  require(block.timestamp >= commitBatchTimestamp + delay, "5c"); // The delay is not passed

     |  // @audit-issue Use a more informative error description
 217 |  require(block.timestamp >= commitBatchTimestamp + delay, "5c"); // The delay is not passed
```
GitHub: [195](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L195), [217](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L217)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol

     |  // @audit-issue Use a more informative error description
  25 |  require(address(_initializeData.verifier) != address(0), "vt");

     |  // @audit-issue Use a more informative error description
  26 |  require(_initializeData.admin != address(0), "vy");

     |  // @audit-issue Use a more informative error description
  27 |  require(_initializeData.validatorTimelock != address(0), "hc");

     |  // @audit-issue Use a more informative error description
  28 |  require(_initializeData.priorityTxMaxGasLimit <= MAX_GAS_PER_TRANSACTION, "vu");
```
GitHub: [25](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol#L25), [26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol#L26), [27](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol#L27), [28](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol#L28)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol

     |  // @audit-issue Use a more informative error description
  14 |  require(_chainId == block.chainid, "pr");

     |  // @audit-issue Use a more informative error description
  25 |  require(msg.data.length >= 4 || msg.data.length == 0, "Ut");

     |  // @audit-issue Use a more informative error description
  30 |  require(facetAddress != address(0), "F"); // Proxy has no facet for this selector

     |  // @audit-issue Use a more informative error description
  31 |  require(!diamondStorage.isFrozen || !facet.isFreezable, "q1"); // Facet is frozen
```
GitHub: [14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol#L14), [25](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol#L25), [30](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol#L30), [31](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol#L31)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol

     |  // @audit-issue Use a more informative error description
  34 |  require(msg.sender == pendingAdmin, "n4"); // Only proposed by current admin address can claim the admin rights

     |  // @audit-issue Use a more informative error description
  59 |  require(_newPriorityTxMaxGasLimit <= MAX_GAS_PER_TRANSACTION, "n5");

     |  // @audit-issue Use a more informative error description
  70 |  require(_newFeeParams.maxPubdataPerBatch >= _newFeeParams.priorityTxMaxPubdata, "n6");

     |  // @audit-issue Use a more informative error description
 136 |  require(!diamondStorage.isFrozen, "a9"); // diamond proxy is frozen already

     |  // @audit-issue Use a more informative error description
 146 |  require(diamondStorage.isFrozen, "a7"); // diamond proxy is not frozen
```
GitHub: [34](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L34), [59](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L59), [70](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L70), [136](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L136), [146](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L146)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

     |  // @audit-issue Use a more informative error description
  37 |  require(_newBatch.batchNumber == _previousBatch.batchNumber + 1, "f"); // only commit next batch

     |  // @audit-issue Use a more informative error description
  40 |  require(pubdataSource == uint8(PubdataSource.Calldata) || pubdataSource == uint8(PubdataSource.Blob), "us");

     |  // @audit-issue Use a more informative error description
  50 |  require(logOutput.pubdataHash == 0x00, "v0h");

     |  // @audit-issue Use a more informative error description
  61 |  require(
  62 |      logOutput.pubdataHash ==
  63 |          keccak256(_newBatch.pubdataCommitments[1:_newBatch.pubdataCommitments.length - 32]),
  64 |      "wp"
  65 |  );

     |  // @audit-issue Use a more informative error description
  74 |  require(_previousBatch.batchHash == logOutput.previousBatchHash, "l");

     |  // @audit-issue Use a more informative error description
  76 |  require(logOutput.chainedPriorityTxsHash == _newBatch.priorityOperationsHash, "t");

     |  // @audit-issue Use a more informative error description
  78 |  require(logOutput.numberOfLayer1Txs == _newBatch.numberOfLayer1Txs, "ta");

     |  // @audit-issue Use a more informative error description
 110 |  require(batchTimestamp == _expectedBatchTimestamp, "tb");

     |  // @audit-issue Use a more informative error description
 114 |  require(_previousBatchTimestamp < batchTimestamp, "h3");

     |  // @audit-issue Use a more informative error description
 122 |  require(block.timestamp - COMMIT_TIMESTAMP_NOT_OLDER <= batchTimestamp, "h1"); // New batch timestamp is too small

     |  // @audit-issue Use a more informative error description
 123 |  require(lastL2BlockTimestamp <= block.timestamp + COMMIT_TIMESTAMP_APPROXIMATION_DELTA, "h2"); // The last L2 block timestamp is too big

     |  // @audit-issue Use a more informative error description
 149 |  require(!_checkBit(processedLogs, uint8(logKey)), "kp");

     |  // @audit-issue Use a more informative error description
 154 |  require(logSender == L2_TO_L1_MESSENGER_SYSTEM_CONTRACT_ADDR, "lm");

     |  // @audit-issue Use a more informative error description
 157 |  require(logSender == L2_TO_L1_MESSENGER_SYSTEM_CONTRACT_ADDR, "ln");

     |  // @audit-issue Use a more informative error description
 160 |  require(logSender == L2_TO_L1_MESSENGER_SYSTEM_CONTRACT_ADDR, "lb");

     |  // @audit-issue Use a more informative error description
 163 |  require(logSender == L2_SYSTEM_CONTEXT_SYSTEM_CONTRACT_ADDR, "sc");

     |  // @audit-issue Use a more informative error description
 166 |  require(logSender == L2_SYSTEM_CONTEXT_SYSTEM_CONTRACT_ADDR, "sv");

     |  // @audit-issue Use a more informative error description
 169 |  require(logSender == L2_BOOTLOADER_ADDRESS, "bl");

     |  // @audit-issue Use a more informative error description
 172 |  require(logSender == L2_BOOTLOADER_ADDRESS, "bk");

     |  // @audit-issue Use a more informative error description
 175 |  require(logSender == L2_PUBDATA_CHUNK_PUBLISHER_ADDR, "pc");

     |  // @audit-issue Use a more informative error description
 178 |  require(logSender == L2_PUBDATA_CHUNK_PUBLISHER_ADDR, "pd");

     |  // @audit-issue Use a more informative error description
 181 |  require(logSender == L2_BOOTLOADER_ADDRESS, "bu");

     |  // @audit-issue Use a more informative error description
 182 |  require(_expectedSystemContractUpgradeTxHash == logValue, "ut");

     |  // @audit-issue Use a more informative error description
 184 |  revert("ul");

     |  // @audit-issue Use a more informative error description
 192 |  require(processedLogs == 511, "b7");

     |  // @audit-issue Use a more informative error description
 194 |  require(processedLogs == 1023, "b8");

     |  // @audit-issue Use a more informative error description
 231 |  require(_newBatchesData.length == 1, "e4");

     |  // @audit-issue Use a more informative error description
 233 |  require(s.storedBatchHashes[s.totalBatchesCommitted] == _hashStoredBatchInfo(_lastCommittedBatchData), "i"); // incorrect previous batch data

     |  // @audit-issue Use a more informative error description
 284 |  require(s.l2SystemContractsUpgradeBatchNumber == 0, "ik");

     |  // @audit-issue Use a more informative error description
 323 |  require(currentBatchNumber == s.totalBatchesExecuted + _executedBatchIdx + 1, "k"); // Execute batches in order

     |  // @audit-issue Use a more informative error description
 324 |  require(
 325 |      _hashStoredBatchInfo(_storedBatch) == s.storedBatchHashes[currentBatchNumber],
 326 |      "exe10" // executing batch should be committed
 327 |  );

     |  // @audit-issue Use a more informative error description
 330 |  require(priorityOperationsHash == _storedBatch.priorityOperationsHash, "x"); // priority operations hash does not match to expected

     |  // @audit-issue Use a more informative error description
 358 |  require(newTotalBatchesExecuted <= s.totalBatchesVerified, "n"); // Can't execute batches more than committed and proven currently.

     |  // @audit-issue Use a more informative error description
 402 |  require(_hashStoredBatchInfo(_prevBatch) == s.storedBatchHashes[currentTotalBatchesVerified], "t1");

     |  // @audit-issue Use a more informative error description
 407 |  require(
 408 |      _hashStoredBatchInfo(_committedBatches[i]) == s.storedBatchHashes[currentTotalBatchesVerified],
 409 |      "o1"
 410 |  );

     |  // @audit-issue Use a more informative error description
 421 |  require(currentTotalBatchesVerified <= s.totalBatchesCommitted, "q");

     |  // @audit-issue Use a more informative error description
 442 |  require(proofPublicInput.length == 1, "t4");

     |  // @audit-issue Use a more informative error description
 449 |  require(successVerifyProof, "p"); // Proof verification fail

     |  // @audit-issue Use a more informative error description
 482 |  require(s.totalBatchesCommitted > _newLastBatch, "v1"); // The last committed batch is less than new last batch

     |  // @audit-issue Use a more informative error description
 483 |  require(_newLastBatch >= s.totalBatchesExecuted, "v2"); // Already executed batches cannot be reverted

     |  // @audit-issue Use a more informative error description
 543 |  require(_batch.systemLogs.length <= MAX_L2_TO_L1_LOGS_COMMITMENT_BYTES, "pu");

     |  // @audit-issue Use a more informative error description
 567 |  require(_blobCommitments.length == MAX_NUMBER_OF_BLOBS, "b10");

     |  // @audit-issue Use a more informative error description
 568 |  require(_blobHashes.length == MAX_NUMBER_OF_BLOBS, "b11");

     |  // @audit-issue Use a more informative error description
 631 |  require(_pubdataCommitments.length > 0, "pl");

     |  // @audit-issue Use a more informative error description
 632 |  require(_pubdataCommitments.length <= PUBDATA_COMMITMENT_SIZE * MAX_NUMBER_OF_BLOBS, "bd");

     |  // @audit-issue Use a more informative error description
 633 |  require(_pubdataCommitments.length % PUBDATA_COMMITMENT_SIZE == 0, "bs");

     |  // @audit-issue Use a more informative error description
 639 |  require(blobVersionedHash != bytes32(0), "vh");

     |  // @audit-issue Use a more informative error description
 663 |  require(versionedHash == bytes32(0), "lh");

     |  // @audit-issue Use a more informative error description
 668 |  require(
 669 |      (_blobHashes[i] == bytes32(0) && blobCommitments[i] == bytes32(0)) ||
 670 |          (_blobHashes[i] != bytes32(0) && blobCommitments[i] != bytes32(0)),
 671 |      "bh"
 672 |  );

     |  // @audit-issue Use a more informative error description
 681 |  require(success, "vc");
```
GitHub: [37](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L37), [40](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L40), [50](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L50), [61-65](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L61-L65), [74](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L74), [76](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L76), [78](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L78), [110](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L110), [114](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L114), [122](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L122), [123](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L123), [149](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L149), [154](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L154), [157](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L157), [160](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L160), [163](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L163), [166](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L166), [169](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L169), [172](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L172), [175](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L175), [178](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L178), [181](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L181), [182](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L182), [184](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L184), [192](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L192), [194](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L194), [231](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L231), [233](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L233), [284](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L284), [323](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L323), [324-327](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L324-L327), [330](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L330), [358](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L358), [402](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L402), [407-410](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L407-L410), [421](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L421), [442](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L442), [449](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L449), [482](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L482), [483](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L483), [543](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L543), [567](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L567), [568](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L568), [631](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L631), [632](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L632), [633](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L633), [639](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L639), [663](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L663), [668-672](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L668-L672), [681](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L681)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol

     |  // @audit-issue Use a more informative error description
 183 |  require(ds.selectorToFacet[_selector].facetAddress != address(0), "g2");
```
GitHub: [183](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L183)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

     |  // @audit-issue Use a more informative error description
 110 |  require(_batchNumber <= s.totalBatchesExecuted, "xx");

     |  // @audit-issue Use a more informative error description
 117 |  require(hashedLog != L2_L1_LOGS_TREE_DEFAULT_LEAF_HASH, "tw");

     |  // @audit-issue Use a more informative error description
 243 |  require(_request.l2GasPerPubdataByteLimit == REQUIRED_L2_GAS_PRICE_PER_PUBDATA, "qp");

     |  // @audit-issue Use a more informative error description
 264 |  require(_factoryDeps.length <= MAX_NEW_FACTORY_DEPS, "uj");

     |  // @audit-issue Use a more informative error description
 272 |  require(_mintValue >= baseCost + _params.l2Value, "mv"); // The `msg.value` doesn't cover the transaction cost
```
GitHub: [110](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L110), [117](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L117), [243](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L243), [264](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L264), [272](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L272)


```solidity
File: code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol

     |  // @audit-issue Use a more informative error description
  23 |  require(_bytecode.length % 32 == 0, "pq");

     |  // @audit-issue Use a more informative error description
  26 |  require(bytecodeLenInWords < 2 ** 16, "pp"); // bytecode length must be less than 2^16 words

     |  // @audit-issue Use a more informative error description
  27 |  require(bytecodeLenInWords % 2 == 1, "ps"); // bytecode length in words must be odd

     |  // @audit-issue Use a more informative error description
  41 |  require(version == 1 && _bytecodeHash[1] == bytes1(0), "zf"); // Incorrectly formatted bytecodeHash

     |  // @audit-issue Use a more informative error description
  43 |  require(bytecodeLen(_bytecodeHash) % 2 == 1, "uy"); // Code length in words must be odd
```
GitHub: [23](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L23), [26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L26), [27](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L27), [41](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L41), [43](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L43)


```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol

     |  // @audit-issue Use a more informative error description
 107 |  require(selectors.length > 0, "B"); // no functions for diamond cut

     |  // @audit-issue Use a more informative error description
 116 |  revert("C"); // undefined diamond cut action

     |  // @audit-issue Use a more informative error description
 132 |  require(_facet.code.length > 0, "G");

     |  // @audit-issue Use a more informative error description
 141 |  require(oldFacet.facetAddress == address(0), "J"); // facet for this selector already exists

     |  // @audit-issue Use a more informative error description
 155 |  require(_facet.code.length > 0, "K");

     |  // @audit-issue Use a more informative error description
 161 |  require(oldFacet.facetAddress != address(0), "L"); // it is impossible to replace the facet with zero address

     |  // @audit-issue Use a more informative error description
 175 |  require(_facet == address(0), "a1"); // facet address must be zero
```
GitHub: [107](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L107), [116](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L116), [132](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L132), [141](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L141), [155](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L155), [161](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L161), [175](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L175)


## [N-32] Event is not fully `indexed`

Index event fields make the field more quickly accessible to off-chain tools that parse events. This is especially useful when it comes to filtering based on an address. However, note that each index field costs extra gas during emission, so it's not necessarily best to index the maximum allowed per event (three fields). Where applicable, each event should use three indexed fields if there are three or more fields, and gas usage is not particularly of concern for the events in question. If there are fewer than three applicable fields, all of the applicable fields should be indexed.

*Instances: 9*

```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

     |  // @audit-issue Consider adding an index to _addedValidator
  32 |  event ValidatorAdded(uint256 _chainId, address _addedValidator);

     |  // @audit-issue Consider adding an index to _removedValidator
  35 |  event ValidatorRemoved(uint256 _chainId, address _removedValidator);
```
GitHub: [32](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L32), [35](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L35)


```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol

     |  // @audit-issue Consider adding an index to initAddress
  24 |  event DiamondCut(FacetCut[] facetCuts, address initAddress, bytes initCalldata);
```
GitHub: [24](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L24)


```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol

     |  // @audit-issue Consider adding an index to l1Token
  12 |  event DepositInitiated(
  13 |      bytes32 indexed l2DepositTxHash,
  14 |      address indexed from,
  15 |      address indexed to,
  16 |      address l1Token,
  17 |      uint256 amount
  18 |  );
```
GitHub: [12-18](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L12-L18)


```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol

     |  // @audit-issue Consider adding an index to to, l1Token
  13 |  event LegacyDepositInitiated(
  14 |      uint256 indexed chainId,
  15 |      bytes32 indexed l2DepositTxHash,
  16 |      address indexed from,
  17 |      address to,
  18 |      address l1Token,
  19 |      uint256 amount
  20 |  );

     |  // @audit-issue Consider adding an index to to, l1Token
  22 |  event BridgehubDepositInitiated(
  23 |      uint256 indexed chainId,
  24 |      bytes32 indexed txDataHash,
  25 |      address indexed from,
  26 |      address to,
  27 |      address l1Token,
  28 |      uint256 amount
  29 |  );

     |  // @audit-issue Consider adding an index to l1Token
  31 |  event BridgehubDepositBaseTokenInitiated(
  32 |      uint256 indexed chainId,
  33 |      address indexed from,
  34 |      address l1Token,
  35 |      uint256 amount
  36 |  );
```
GitHub: [13-20](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L13-L20), [22-29](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L22-L29), [31-36](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L31-L36)


```solidity
File: code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol

     |  // @audit-issue Consider adding an index to stateTransitionManager
 133 |  event NewChain(uint256 indexed chainId, address stateTransitionManager, address indexed chainGovernance);
```
GitHub: [133](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L133)


```solidity
File: code/contracts/ethereum/contracts/governance/IGovernance.sol

     |  // @audit-issue Consider adding an index to _securityCouncilBefore, _securityCouncilAfter
  77 |  event ChangeSecurityCouncil(address _securityCouncilBefore, address _securityCouncilAfter);
```
GitHub: [77](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L77)


## [N-33] Events are missing sender information

When an action is triggered based on a user's action, not being able to filter based on who triggered the action makes event processing a lot more cumbersome. Including the `msg.sender` the events of these types of action will make events much more useful to end users, especially when `msg.sender` is not `tx.origin`.

*Instances: 72*

```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

     |  // @audit-issue Consider adding msg.sender as a parameter
 199 |  emit ClaimedFailedDeposit(_depositSender, _l1Token, amount);

     |  // @audit-issue Consider adding msg.sender as a parameter
 225 |  emit WithdrawalFinalized(l1Receiver, l1Token, amount);
```
GitHub: [199](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L199), [225](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L225)


```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

     |  // @audit-issue Consider adding msg.sender as a parameter
 168 |  emit BridgehubDepositBaseTokenInitiated(_chainId, _prevMsgSender, _l1Token, _amount);

     |  // @audit-issue Consider adding msg.sender as a parameter
 227 |  emit BridgehubDepositInitiated(_chainId, txDataHash, _prevMsgSender, _l2Receiver, _l1Token, amount);

     |  // @audit-issue Consider adding msg.sender as a parameter
 239 |  emit BridgehubDepositFinalized(_chainId, _txDataHash, _txHash);

     |  // @audit-issue Consider adding msg.sender as a parameter
 367 |  emit ClaimedFailedDepositSharedBridge(_chainId, _depositSender, _l1Token, _amount);

     |  // @audit-issue Consider adding msg.sender as a parameter
 454 |  emit WithdrawalFinalizedSharedBridge(_chainId, l1Receiver, l1Token, amount);

     |  // @audit-issue Consider adding msg.sender as a parameter
 602 |  emit LegacyDepositInitiated(ERA_CHAIN_ID, l2TxHash, _prevMsgSender, _l2Receiver, _l1Token, _amount);
```
GitHub: [168](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L168), [227](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L227), [239](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L239), [367](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L367), [454](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L454), [602](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L602)


```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

     |  // @audit-issue Consider adding msg.sender as a parameter
  56 |  emit NewPendingAdmin(oldPendingAdmin, _newPendingAdmin);

     |  // @audit-issue Consider adding msg.sender as a parameter
  68 |  emit NewPendingAdmin(currentPendingAdmin, address(0));

     |  // @audit-issue Consider adding msg.sender as a parameter
  69 |  emit NewAdmin(previousAdmin, pendingAdmin);

     |  // @audit-issue Consider adding msg.sender as a parameter
 145 |  emit NewChain(_chainId, _stateTransitionManager, _admin);
```
GitHub: [56](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L56), [68](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L68), [69](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L69), [145](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L145)


```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

     |  // @audit-issue Consider adding msg.sender as a parameter
  47 |  emit ChangeSecurityCouncil(address(0), _securityCouncil);

     |  // @audit-issue Consider adding msg.sender as a parameter
  50 |  emit ChangeMinDelay(0, _minDelay);

     |  // @audit-issue Consider adding msg.sender as a parameter
 132 |  emit TransparentOperationScheduled(id, _delay, _operation);

     |  // @audit-issue Consider adding msg.sender as a parameter
 144 |  emit ShadowOperationScheduled(_id, _delay);

     |  // @audit-issue Consider adding msg.sender as a parameter
 157 |  emit OperationCancelled(_id);

     |  // @audit-issue Consider adding msg.sender as a parameter
 180 |  emit OperationExecuted(id);

     |  // @audit-issue Consider adding msg.sender as a parameter
 199 |  emit OperationExecuted(id);

     |  // @audit-issue Consider adding msg.sender as a parameter
 250 |  emit ChangeMinDelay(minDelay, _newDelay);

     |  // @audit-issue Consider adding msg.sender as a parameter
 257 |  emit ChangeSecurityCouncil(securityCouncil, _newSecurityCouncil);
```
GitHub: [47](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L47), [50](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L50), [132](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L132), [144](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L144), [157](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L157), [180](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L180), [199](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L199), [250](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L250), [257](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L257)


```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

     |  // @audit-issue Consider adding msg.sender as a parameter
 117 |  emit NewPendingAdmin(oldPendingAdmin, _newPendingAdmin);

     |  // @audit-issue Consider adding msg.sender as a parameter
 129 |  emit NewPendingAdmin(currentPendingAdmin, address(0));

     |  // @audit-issue Consider adding msg.sender as a parameter
 130 |  emit NewAdmin(previousAdmin, pendingAdmin);

     |  // @audit-issue Consider adding msg.sender as a parameter
 229 |  emit SetChainIdUpgrade(_chainContract, l2ProtocolUpgradeTx, protocolVersion);

     |  // @audit-issue Consider adding msg.sender as a parameter
 237 |  emit StateTransitionNewChain(_chainId, _stateTransitionContract);

     |  // @audit-issue Consider adding msg.sender as a parameter
 289 |  emit StateTransitionNewChain(_chainId, stateTransitionAddress);
```
GitHub: [117](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L117), [129](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L129), [130](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L130), [229](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L229), [237](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L237), [289](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L289)


```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

     |  // @audit-issue Consider adding msg.sender as a parameter
  83 |  emit ValidatorAdded(_chainId, _newValidator);

     |  // @audit-issue Consider adding msg.sender as a parameter
  92 |  emit ValidatorRemoved(_chainId, _validator);

     |  // @audit-issue Consider adding msg.sender as a parameter
  98 |  emit NewExecutionDelay(_executionDelay);
```
GitHub: [83](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L83), [92](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L92), [98](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L98)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol

     |  // @audit-issue Consider adding msg.sender as a parameter
  28 |  emit NewPendingAdmin(oldPendingAdmin, _newPendingAdmin);

     |  // @audit-issue Consider adding msg.sender as a parameter
  40 |  emit NewPendingAdmin(pendingAdmin, address(0));

     |  // @audit-issue Consider adding msg.sender as a parameter
  41 |  emit NewAdmin(previousAdmin, pendingAdmin);

     |  // @audit-issue Consider adding msg.sender as a parameter
  47 |  emit ValidatorStatusUpdate(_validator, _active);

     |  // @audit-issue Consider adding msg.sender as a parameter
  54 |  emit IsPorterAvailableStatusUpdate(_zkPorterIsAvailable);

     |  // @audit-issue Consider adding msg.sender as a parameter
  63 |  emit NewPriorityTxMaxGasLimit(oldPriorityTxMaxGasLimit, _newPriorityTxMaxGasLimit);

     |  // @audit-issue Consider adding msg.sender as a parameter
  75 |  emit NewFeeParams(oldFeeParams, _newFeeParams);

     |  // @audit-issue Consider adding msg.sender as a parameter
  86 |  emit NewBaseTokenMultiplier(oldNominator, oldDenominator, _nominator, _denominator);

     |  // @audit-issue Consider adding msg.sender as a parameter
  92 |  emit ValidiumModeStatusUpdate(_validiumMode);

     |  // @audit-issue Consider adding msg.sender as a parameter
 115 |  emit ExecuteUpgrade(_diamondCut);

     |  // @audit-issue Consider adding msg.sender as a parameter
 125 |  emit ExecuteUpgrade(_diamondCut);

     |  // @audit-issue Consider adding msg.sender as a parameter
 139 |  emit Freeze();

     |  // @audit-issue Consider adding msg.sender as a parameter
 149 |  emit Unfreeze();
```
GitHub: [28](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L28), [40](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L40), [41](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L41), [47](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L47), [54](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L54), [63](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L63), [75](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L75), [86](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L86), [92](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L92), [115](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L115), [125](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L125), [139](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L139), [149](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L149)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

     |  // @audit-issue Consider adding msg.sender as a parameter
 261 |  emit BlockCommit(
 262 |      _lastCommittedBatchData.batchNumber,
 263 |      _lastCommittedBatchData.batchHash,
 264 |      _lastCommittedBatchData.commitment
 265 |  );

     |  // @audit-issue Consider adding msg.sender as a parameter
 299 |  emit BlockCommit(
 300 |      _lastCommittedBatchData.batchNumber,
 301 |      _lastCommittedBatchData.batchHash,
 302 |      _lastCommittedBatchData.commitment
 303 |  );

     |  // @audit-issue Consider adding msg.sender as a parameter
 353 |  emit BlockExecution(_batchesData[i].batchNumber, _batchesData[i].batchHash, _batchesData[i].commitment);

     |  // @audit-issue Consider adding msg.sender as a parameter
 436 |  emit BlocksVerification(s.totalBatchesVerified, currentTotalBatchesVerified);

     |  // @audit-issue Consider adding msg.sender as a parameter
 496 |  emit BlocksRevert(s.totalBatchesCommitted, s.totalBatchesVerified, s.totalBatchesExecuted);
```
GitHub: [261-265](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L261-L265), [299-303](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L299-L303), [353](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L353), [436](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L436), [496](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L496)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

     |  // @audit-issue Consider adding msg.sender as a parameter
 343 |  emit NewPriorityRequest(
 344 |      _priorityOpParams.txId,
 345 |      canonicalTxHash,
 346 |      _priorityOpParams.expirationTimestamp,
 347 |      transaction,
 348 |      _factoryDeps
 349 |  );
```
GitHub: [343-349](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L343-L349)


```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol

     |  // @audit-issue Consider adding msg.sender as a parameter
  87 |  emit UpgradeComplete(_proposedUpgrade.newProtocolVersion, txHash, _proposedUpgrade);

     |  // @audit-issue Consider adding msg.sender as a parameter
 104 |  emit NewL2DefaultAccountBytecodeHash(previousDefaultAccountBytecodeHash, _l2DefaultAccountBytecodeHash);

     |  // @audit-issue Consider adding msg.sender as a parameter
 121 |  emit NewL2BootloaderBytecodeHash(previousBootloaderBytecodeHash, _l2BootloaderBytecodeHash);

     |  // @audit-issue Consider adding msg.sender as a parameter
 137 |  emit NewVerifier(address(oldVerifier), address(_newVerifier));

     |  // @audit-issue Consider adding msg.sender as a parameter
 157 |  emit NewVerifierParams(oldVerifierParams, _newVerifierParams);

     |  // @audit-issue Consider adding msg.sender as a parameter
 256 |  emit NewProtocolVersion(previousProtocolVersion, _newProtocolVersion);
```
GitHub: [87](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L87), [104](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L104), [121](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L121), [137](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L137), [157](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L157), [256](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L256)


```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol

     |  // @audit-issue Consider adding msg.sender as a parameter
  40 |  emit NewProtocolVersion(previousProtocolVersion, _newProtocolVersion);

     |  // @audit-issue Consider adding msg.sender as a parameter
  67 |  emit UpgradeComplete(_proposedUpgrade.newProtocolVersion, txHash, _proposedUpgrade);
```
GitHub: [40](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L40), [67](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L67)


```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol

     |  // @audit-issue Consider adding msg.sender as a parameter
 121 |  emit DiamondCut(facetCuts, initAddress, initCalldata);
```
GitHub: [121](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L121)


```solidity
File: code/contracts/ethereum/contracts/upgrades/Upgrade_v1_4_1.sol

     |  // @audit-issue Consider adding msg.sender as a parameter
  28 |  emit NewFeeParams(oldFeeParams, _newFeeParams);
```
GitHub: [28](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/Upgrade_v1_4_1.sol#L28)


```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

     |  // @audit-issue Consider adding msg.sender as a parameter
 355 |  emit ContractDeployed(_sender, _bytecodeHash, _newAddress);
```
GitHub: [355](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L355)


```solidity
File: code/system-contracts/contracts/KnownCodesStorage.sol

     |  // @audit-issue Consider adding msg.sender as a parameter
  59 |  emit MarkedAsKnown(_bytecodeHash, _shouldSendToL1);
```
GitHub: [59](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/KnownCodesStorage.sol#L59)


```solidity
File: code/system-contracts/contracts/L1Messenger.sol

     |  // @audit-issue Consider adding msg.sender as a parameter
 111 |  emit L2ToL1LogSent(_l2ToL1Log);

     |  // @audit-issue Consider adding msg.sender as a parameter
 181 |  emit BytecodeL1PublicationRequested(_bytecodeHash);
```
GitHub: [111](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L111), [181](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L181)


```solidity
File: code/system-contracts/contracts/L2BaseToken.sol

     |  // @audit-issue Consider adding msg.sender as a parameter
  49 |  emit Transfer(_from, _to, _amount);

     |  // @audit-issue Consider adding msg.sender as a parameter
  67 |  emit Mint(_account, _amount);
```
GitHub: [49](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L2BaseToken.sol#L49), [67](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L2BaseToken.sol#L67)


```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

     |  // @audit-issue Consider adding msg.sender as a parameter
 105 |  emit FinalizeDeposit(_l1Sender, _l2Receiver, expectedL2Token, _amount);
```
GitHub: [105](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L105)


```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

     |  // @audit-issue Consider adding msg.sender as a parameter
 101 |  emit BridgeInitialize(_l1Address, decodedName, decodedSymbol, decimals_);

     |  // @audit-issue Consider adding msg.sender as a parameter
 126 |  emit BridgeInitialize(l1Address, _newName, _newSymbol, decimals_);

     |  // @audit-issue Consider adding msg.sender as a parameter
 147 |  emit BridgeMint(_to, _amount);

     |  // @audit-issue Consider adding msg.sender as a parameter
 156 |  emit BridgeBurn(_from, _amount);
```
GitHub: [101](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L101), [126](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L126), [147](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L147), [156](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L156)


```solidity
File: code/contracts/zksync/contracts/bridge/L2WrappedBaseToken.sol

     |  // @audit-issue Consider adding msg.sender as a parameter
  61 |  emit Initialize(name_, symbol_, 18);

     |  // @audit-issue Consider adding msg.sender as a parameter
  86 |  emit BridgeBurn(_from, _amount);
```
GitHub: [61](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2WrappedBaseToken.sol#L61), [86](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2WrappedBaseToken.sol#L86)


## [N-34] Events should use parameters to convey information

For example, rather than using `event Paused()` and `event Unpaused()`, use `event PauseState(address indexed whoChangedIt, bool wasPaused, bool isNowPaused)`

*Instances: 2*

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol

     |  // @audit-issue Consider adding event parameters
  94 |  event Freeze();

     |  // @audit-issue Consider adding event parameters
  97 |  event Unfreeze();
```
GitHub: [94](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L94), [97](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L97)


## [N-35] Events that mark critical parameter changes should contain both the old and the new value

This should especially be done if the new value is not required to be different from the old value

*Instances: 17*

```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

     |  // @audit-info setter/update
 249 |  function updateDelay(uint256 _newDelay) external onlySelf {
     |      // @audit-issue Consider including 'old' parameters in emit
 250 |      emit ChangeMinDelay(minDelay, _newDelay);

     |  // @audit-info setter/update
 256 |  function updateSecurityCouncil(address _newSecurityCouncil) external onlySelf {
     |      // @audit-issue Consider including 'old' parameters in emit
 257 |      emit ChangeSecurityCouncil(securityCouncil, _newSecurityCouncil);
```
GitHub: [250](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L250), [257](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L257)


```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

     |  // @audit-info setter/update
 179 |  function _setChainIdUpgrade(uint256 _chainId, address _chainContract) internal {
  :  |
     |      // @audit-issue Consider including 'old' parameters in emit
 229 |      emit SetChainIdUpgrade(_chainContract, l2ProtocolUpgradeTx, protocolVersion);
```
GitHub: [229](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L229)


```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

     |  // @audit-info setter/update
  78 |  function addValidator(uint256 _chainId, address _newValidator) external onlyChainAdmin(_chainId) {
  :  |
     |      // @audit-issue Consider including 'old' parameters in emit
  83 |      emit ValidatorAdded(_chainId, _newValidator);

     |  // @audit-info setter/update
  87 |  function removeValidator(uint256 _chainId, address _validator) external onlyChainAdmin(_chainId) {
  :  |
     |      // @audit-issue Consider including 'old' parameters in emit
  92 |      emit ValidatorRemoved(_chainId, _validator);

     |  // @audit-info setter/update
  96 |  function setExecutionDelay(uint32 _executionDelay) external onlyOwner {
  :  |
     |      // @audit-issue Consider including 'old' parameters in emit
  98 |      emit NewExecutionDelay(_executionDelay);
```
GitHub: [83](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L83), [92](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L92), [98](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L98)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol

     |  // @audit-info setter/update
  45 |  function setValidator(address _validator, bool _active) external onlyStateTransitionManager {
  :  |
     |      // @audit-issue Consider including 'old' parameters in emit
  47 |      emit ValidatorStatusUpdate(_validator, _active);

     |  // @audit-info setter/update
  51 |  function setPorterAvailability(bool _zkPorterIsAvailable) external onlyStateTransitionManager {
  :  |
     |      // @audit-issue Consider including 'old' parameters in emit
  54 |      emit IsPorterAvailableStatusUpdate(_zkPorterIsAvailable);

     |  // @audit-info setter/update
  89 |  function setValidiumMode(PubdataPricingMode _validiumMode) external onlyAdmin {
  :  |
     |      // @audit-issue Consider including 'old' parameters in emit
  92 |      emit ValidiumModeStatusUpdate(_validiumMode);

     |  // @audit-info setter/update
 100 |  function upgradeChainFromVersion(
 101 |      uint256 _oldProtocolVersion,
 102 |      Diamond.DiamondCutData calldata _diamondCut
 103 |  ) external onlyAdminOrStateTransitionManager {
  :  |
     |      // @audit-issue Consider including 'old' parameters in emit
 115 |      emit ExecuteUpgrade(_diamondCut);
```
GitHub: [47](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L47), [54](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L54), [92](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L92), [115](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L115)


```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol

     |  // @audit-info setter/update
  92 |  function _setL2DefaultAccountBytecodeHash(bytes32 _l2DefaultAccountBytecodeHash) private {
  :  |
     |      // @audit-issue Consider including 'old' parameters in emit
 104 |      emit NewL2DefaultAccountBytecodeHash(previousDefaultAccountBytecodeHash, _l2DefaultAccountBytecodeHash);

     |  // @audit-info setter/update
 109 |  function _setL2BootloaderBytecodeHash(bytes32 _l2BootloaderBytecodeHash) private {
  :  |
     |      // @audit-issue Consider including 'old' parameters in emit
 121 |      emit NewL2BootloaderBytecodeHash(previousBootloaderBytecodeHash, _l2BootloaderBytecodeHash);

     |  // @audit-info setter/update
 236 |  function _setNewProtocolVersion(uint256 _newProtocolVersion) internal virtual {
  :  |
     |      // @audit-issue Consider including 'old' parameters in emit
 256 |      emit NewProtocolVersion(previousProtocolVersion, _newProtocolVersion);
```
GitHub: [104](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L104), [121](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L121), [256](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L256)


```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol

     |  // @audit-info setter/update
  20 |  function _setNewProtocolVersion(uint256 _newProtocolVersion) internal override {
  :  |
     |      // @audit-issue Consider including 'old' parameters in emit
  40 |      emit NewProtocolVersion(previousProtocolVersion, _newProtocolVersion);
```
GitHub: [40](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L40)


```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

     |  // @audit-info setter/update
  65 |  function updateAccountVersion(AccountAbstractionVersion _version) external onlySystemCall {
  :  |
     |      // @audit-issue Consider including 'old' parameters in emit
  68 |      emit AccountVersionUpdated(msg.sender, _version);

     |  // @audit-info setter/update
  74 |  function updateNonceOrdering(AccountNonceOrdering _nonceOrdering) external onlySystemCall {
  :  |
     |      // @audit-issue Consider including 'old' parameters in emit
  86 |      emit AccountNonceOrderingUpdated(msg.sender, _nonceOrdering);
```
GitHub: [68](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L68), [86](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L86)


```solidity
File: code/system-contracts/contracts/NonceHolder.sol

     |  // @audit-info setter/update
  82 |  function setValueUnderNonce(uint256 _key, uint256 _value) public onlySystemCall {
  :  |
     |      // @audit-issue Consider including 'old' parameters in emit
  96 |      emit ValueSetUnderNonce(msg.sender, _key, _value);
```
GitHub: [96](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/NonceHolder.sol#L96)


## [N-36] Excessive downcasting of `block.timestamp` reduces contract lifespan

Using `uint40`/`int44` or higher is safe for contracts since the timekeeping will break in the year 11421.

*Instances: 2*

```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

     |  // @audit-issue Consider a type with more bits
 115 |  uint32 timestamp = uint32(block.timestamp);

     |  // @audit-issue Consider a type with more bits
 134 |  uint32 timestamp = uint32(block.timestamp);
```
GitHub: [115](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L115), [134](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L134)


## [N-37] Expressions for constant values should use `immutable` rather than `constant`

While it doesn't save any gas because the compiler knows that developers often make this mistake, it's still best to use the right tool for the task at hand. There is a difference between `constant` variables and `immutable` variables, and they should each be used in their appropriate contexts. `constants` should be used for literal values written into the code, and `immutable` variables should be used for expressions, or values calculated in, or passed into the constructor.

*Instances: 99*

```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

     |  // @audit-issue Consider defining as `immutable` instead
  22 |  uint256 internal constant EXECUTED_PROPOSAL_TIMESTAMP = uint256(1);
```
GitHub: [22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L22)


```solidity
File: code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol

     |  // @audit-issue Consider defining as `immutable` instead
  12 |  bytes32 private constant CREATE2_PREFIX = keccak256("zksyncCreate2");
```
GitHub: [12](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L12)


```solidity
File: code/contracts/ethereum/contracts/common/Config.sol

     |  // @audit-issue Consider defining as `immutable` instead
  16 |  uint256 constant MAX_L2_TO_L1_LOGS_COMMITMENT_BYTES = 4 + L2_TO_L1_LOG_SERIALIZE_SIZE * 512;

     |  // @audit-issue Consider defining as `immutable` instead
  24 |  bytes32 constant DEFAULT_L2_LOGS_TREE_ROOT_HASH = bytes32(0);

     |  // @audit-issue Consider defining as `immutable` instead
  87 |  address constant POINT_EVALUATION_PRECOMPILE_ADDR = address(0x0A);

     |  // @audit-issue Consider defining as `immutable` instead
 103 |  address constant ETH_TOKEN_ADDRESS = address(1);

     |  // @audit-issue Consider defining as `immutable` instead
 109 |  address constant ERA_ERC20_BRIDGE_ADDRESS = address(1233);

     |  // @audit-issue Consider defining as `immutable` instead
 114 |  bytes32 constant TWO_BRIDGES_MAGIC_VALUE = bytes32(uint256(keccak256("TWO_BRIDGES_MAGIC_VALUE")) - 1);

     |  // @audit-issue Consider defining as `immutable` instead
 117 |  address constant BRIDGEHUB_MIN_SECOND_BRIDGE_ADDRESS = address(uint160(type(uint16).max));
```
GitHub: [16](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/Config.sol#L16), [24](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/Config.sol#L24), [87](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/Config.sol#L87), [103](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/Config.sol#L103), [109](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/Config.sol#L109), [114](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/Config.sol#L114), [117](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/Config.sol#L117)


```solidity
File: code/contracts/ethereum/contracts/common/L2ContractAddresses.sol

     |  // @audit-issue Consider defining as `immutable` instead
   6 |  address constant L2_BOOTLOADER_ADDRESS = address(0x8001);

     |  // @audit-issue Consider defining as `immutable` instead
   9 |  address constant L2_KNOWN_CODE_STORAGE_SYSTEM_CONTRACT_ADDR = address(0x8004);

     |  // @audit-issue Consider defining as `immutable` instead
  12 |  address constant L2_DEPLOYER_SYSTEM_CONTRACT_ADDR = address(0x8006);

     |  // @audit-issue Consider defining as `immutable` instead
  21 |  address constant L2_FORCE_DEPLOYER_ADDR = address(0x8007);

     |  // @audit-issue Consider defining as `immutable` instead
  24 |  address constant L2_TO_L1_MESSENGER_SYSTEM_CONTRACT_ADDR = address(0x8008);

     |  // @audit-issue Consider defining as `immutable` instead
  27 |  address constant L2_BASE_TOKEN_SYSTEM_CONTRACT_ADDR = address(0x800a);

     |  // @audit-issue Consider defining as `immutable` instead
  30 |  address constant L2_SYSTEM_CONTEXT_SYSTEM_CONTRACT_ADDR = address(0x800b);

     |  // @audit-issue Consider defining as `immutable` instead
  33 |  address constant L2_PUBDATA_CHUNK_PUBLISHER_ADDR = address(0x8011);
```
GitHub: [6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/L2ContractAddresses.sol#L6), [9](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/L2ContractAddresses.sol#L9), [12](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/L2ContractAddresses.sol#L12), [21](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/L2ContractAddresses.sol#L21), [24](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/L2ContractAddresses.sol#L24), [27](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/L2ContractAddresses.sol#L27), [30](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/L2ContractAddresses.sol#L30), [33](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/L2ContractAddresses.sol#L33)


```solidity
File: code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol

     |  // @audit-issue Consider defining as `immutable` instead
  22 |  uint160 constant offset = uint160(0x1111000000000000000000000000000000001111);
```
GitHub: [22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol#L22)


```solidity
File: code/contracts/ethereum/contracts/state-transition/Verifier.sol

     |  // @audit-issue Consider defining as `immutable` instead
  27 |  uint256 internal constant VK_GATE_SETUP_0_X_SLOT = 0x200 + 0x000;

     |  // @audit-issue Consider defining as `immutable` instead
  28 |  uint256 internal constant VK_GATE_SETUP_0_Y_SLOT = 0x200 + 0x020;

     |  // @audit-issue Consider defining as `immutable` instead
  29 |  uint256 internal constant VK_GATE_SETUP_1_X_SLOT = 0x200 + 0x040;

     |  // @audit-issue Consider defining as `immutable` instead
  30 |  uint256 internal constant VK_GATE_SETUP_1_Y_SLOT = 0x200 + 0x060;

     |  // @audit-issue Consider defining as `immutable` instead
  31 |  uint256 internal constant VK_GATE_SETUP_2_X_SLOT = 0x200 + 0x080;

     |  // @audit-issue Consider defining as `immutable` instead
  32 |  uint256 internal constant VK_GATE_SETUP_2_Y_SLOT = 0x200 + 0x0a0;

     |  // @audit-issue Consider defining as `immutable` instead
  33 |  uint256 internal constant VK_GATE_SETUP_3_X_SLOT = 0x200 + 0x0c0;

     |  // @audit-issue Consider defining as `immutable` instead
  34 |  uint256 internal constant VK_GATE_SETUP_3_Y_SLOT = 0x200 + 0x0e0;

     |  // @audit-issue Consider defining as `immutable` instead
  35 |  uint256 internal constant VK_GATE_SETUP_4_X_SLOT = 0x200 + 0x100;

     |  // @audit-issue Consider defining as `immutable` instead
  36 |  uint256 internal constant VK_GATE_SETUP_4_Y_SLOT = 0x200 + 0x120;

     |  // @audit-issue Consider defining as `immutable` instead
  37 |  uint256 internal constant VK_GATE_SETUP_5_X_SLOT = 0x200 + 0x140;

     |  // @audit-issue Consider defining as `immutable` instead
  38 |  uint256 internal constant VK_GATE_SETUP_5_Y_SLOT = 0x200 + 0x160;

     |  // @audit-issue Consider defining as `immutable` instead
  39 |  uint256 internal constant VK_GATE_SETUP_6_X_SLOT = 0x200 + 0x180;

     |  // @audit-issue Consider defining as `immutable` instead
  40 |  uint256 internal constant VK_GATE_SETUP_6_Y_SLOT = 0x200 + 0x1a0;

     |  // @audit-issue Consider defining as `immutable` instead
  41 |  uint256 internal constant VK_GATE_SETUP_7_X_SLOT = 0x200 + 0x1c0;

     |  // @audit-issue Consider defining as `immutable` instead
  42 |  uint256 internal constant VK_GATE_SETUP_7_Y_SLOT = 0x200 + 0x1e0;

     |  // @audit-issue Consider defining as `immutable` instead
  44 |  uint256 internal constant VK_GATE_SELECTORS_0_X_SLOT = 0x200 + 0x200;

     |  // @audit-issue Consider defining as `immutable` instead
  45 |  uint256 internal constant VK_GATE_SELECTORS_0_Y_SLOT = 0x200 + 0x220;

     |  // @audit-issue Consider defining as `immutable` instead
  46 |  uint256 internal constant VK_GATE_SELECTORS_1_X_SLOT = 0x200 + 0x240;

     |  // @audit-issue Consider defining as `immutable` instead
  47 |  uint256 internal constant VK_GATE_SELECTORS_1_Y_SLOT = 0x200 + 0x260;

     |  // @audit-issue Consider defining as `immutable` instead
  49 |  uint256 internal constant VK_PERMUTATION_0_X_SLOT = 0x200 + 0x280;

     |  // @audit-issue Consider defining as `immutable` instead
  50 |  uint256 internal constant VK_PERMUTATION_0_Y_SLOT = 0x200 + 0x2a0;

     |  // @audit-issue Consider defining as `immutable` instead
  51 |  uint256 internal constant VK_PERMUTATION_1_X_SLOT = 0x200 + 0x2c0;

     |  // @audit-issue Consider defining as `immutable` instead
  52 |  uint256 internal constant VK_PERMUTATION_1_Y_SLOT = 0x200 + 0x2e0;

     |  // @audit-issue Consider defining as `immutable` instead
  53 |  uint256 internal constant VK_PERMUTATION_2_X_SLOT = 0x200 + 0x300;

     |  // @audit-issue Consider defining as `immutable` instead
  54 |  uint256 internal constant VK_PERMUTATION_2_Y_SLOT = 0x200 + 0x320;

     |  // @audit-issue Consider defining as `immutable` instead
  55 |  uint256 internal constant VK_PERMUTATION_3_X_SLOT = 0x200 + 0x340;

     |  // @audit-issue Consider defining as `immutable` instead
  56 |  uint256 internal constant VK_PERMUTATION_3_Y_SLOT = 0x200 + 0x360;

     |  // @audit-issue Consider defining as `immutable` instead
  58 |  uint256 internal constant VK_LOOKUP_SELECTOR_X_SLOT = 0x200 + 0x380;

     |  // @audit-issue Consider defining as `immutable` instead
  59 |  uint256 internal constant VK_LOOKUP_SELECTOR_Y_SLOT = 0x200 + 0x3a0;

     |  // @audit-issue Consider defining as `immutable` instead
  61 |  uint256 internal constant VK_LOOKUP_TABLE_0_X_SLOT = 0x200 + 0x3c0;

     |  // @audit-issue Consider defining as `immutable` instead
  62 |  uint256 internal constant VK_LOOKUP_TABLE_0_Y_SLOT = 0x200 + 0x3e0;

     |  // @audit-issue Consider defining as `immutable` instead
  63 |  uint256 internal constant VK_LOOKUP_TABLE_1_X_SLOT = 0x200 + 0x400;

     |  // @audit-issue Consider defining as `immutable` instead
  64 |  uint256 internal constant VK_LOOKUP_TABLE_1_Y_SLOT = 0x200 + 0x420;

     |  // @audit-issue Consider defining as `immutable` instead
  65 |  uint256 internal constant VK_LOOKUP_TABLE_2_X_SLOT = 0x200 + 0x440;

     |  // @audit-issue Consider defining as `immutable` instead
  66 |  uint256 internal constant VK_LOOKUP_TABLE_2_Y_SLOT = 0x200 + 0x460;

     |  // @audit-issue Consider defining as `immutable` instead
  67 |  uint256 internal constant VK_LOOKUP_TABLE_3_X_SLOT = 0x200 + 0x480;

     |  // @audit-issue Consider defining as `immutable` instead
  68 |  uint256 internal constant VK_LOOKUP_TABLE_3_Y_SLOT = 0x200 + 0x4a0;

     |  // @audit-issue Consider defining as `immutable` instead
  70 |  uint256 internal constant VK_LOOKUP_TABLE_TYPE_X_SLOT = 0x200 + 0x4c0;

     |  // @audit-issue Consider defining as `immutable` instead
  71 |  uint256 internal constant VK_LOOKUP_TABLE_TYPE_Y_SLOT = 0x200 + 0x4e0;

     |  // @audit-issue Consider defining as `immutable` instead
  73 |  uint256 internal constant VK_RECURSIVE_FLAG_SLOT = 0x200 + 0x500;

     |  // @audit-issue Consider defining as `immutable` instead
  79 |  uint256 internal constant PROOF_PUBLIC_INPUT = 0x200 + 0x520 + 0x000;

     |  // @audit-issue Consider defining as `immutable` instead
  81 |  uint256 internal constant PROOF_STATE_POLYS_0_X_SLOT = 0x200 + 0x520 + 0x020;

     |  // @audit-issue Consider defining as `immutable` instead
  82 |  uint256 internal constant PROOF_STATE_POLYS_0_Y_SLOT = 0x200 + 0x520 + 0x040;

     |  // @audit-issue Consider defining as `immutable` instead
  83 |  uint256 internal constant PROOF_STATE_POLYS_1_X_SLOT = 0x200 + 0x520 + 0x060;

     |  // @audit-issue Consider defining as `immutable` instead
  84 |  uint256 internal constant PROOF_STATE_POLYS_1_Y_SLOT = 0x200 + 0x520 + 0x080;

     |  // @audit-issue Consider defining as `immutable` instead
  85 |  uint256 internal constant PROOF_STATE_POLYS_2_X_SLOT = 0x200 + 0x520 + 0x0a0;

     |  // @audit-issue Consider defining as `immutable` instead
  86 |  uint256 internal constant PROOF_STATE_POLYS_2_Y_SLOT = 0x200 + 0x520 + 0x0c0;

     |  // @audit-issue Consider defining as `immutable` instead
  87 |  uint256 internal constant PROOF_STATE_POLYS_3_X_SLOT = 0x200 + 0x520 + 0x0e0;

     |  // @audit-issue Consider defining as `immutable` instead
  88 |  uint256 internal constant PROOF_STATE_POLYS_3_Y_SLOT = 0x200 + 0x520 + 0x100;

     |  // @audit-issue Consider defining as `immutable` instead
  90 |  uint256 internal constant PROOF_COPY_PERMUTATION_GRAND_PRODUCT_X_SLOT = 0x200 + 0x520 + 0x120;

     |  // @audit-issue Consider defining as `immutable` instead
  91 |  uint256 internal constant PROOF_COPY_PERMUTATION_GRAND_PRODUCT_Y_SLOT = 0x200 + 0x520 + 0x140;

     |  // @audit-issue Consider defining as `immutable` instead
  93 |  uint256 internal constant PROOF_LOOKUP_S_POLY_X_SLOT = 0x200 + 0x520 + 0x160;

     |  // @audit-issue Consider defining as `immutable` instead
  94 |  uint256 internal constant PROOF_LOOKUP_S_POLY_Y_SLOT = 0x200 + 0x520 + 0x180;

     |  // @audit-issue Consider defining as `immutable` instead
  96 |  uint256 internal constant PROOF_LOOKUP_GRAND_PRODUCT_X_SLOT = 0x200 + 0x520 + 0x1a0;

     |  // @audit-issue Consider defining as `immutable` instead
  97 |  uint256 internal constant PROOF_LOOKUP_GRAND_PRODUCT_Y_SLOT = 0x200 + 0x520 + 0x1c0;

     |  // @audit-issue Consider defining as `immutable` instead
  99 |  uint256 internal constant PROOF_QUOTIENT_POLY_PARTS_0_X_SLOT = 0x200 + 0x520 + 0x1e0;

     |  // @audit-issue Consider defining as `immutable` instead
 100 |  uint256 internal constant PROOF_QUOTIENT_POLY_PARTS_0_Y_SLOT = 0x200 + 0x520 + 0x200;

     |  // @audit-issue Consider defining as `immutable` instead
 101 |  uint256 internal constant PROOF_QUOTIENT_POLY_PARTS_1_X_SLOT = 0x200 + 0x520 + 0x220;

     |  // @audit-issue Consider defining as `immutable` instead
 102 |  uint256 internal constant PROOF_QUOTIENT_POLY_PARTS_1_Y_SLOT = 0x200 + 0x520 + 0x240;

     |  // @audit-issue Consider defining as `immutable` instead
 103 |  uint256 internal constant PROOF_QUOTIENT_POLY_PARTS_2_X_SLOT = 0x200 + 0x520 + 0x260;

     |  // @audit-issue Consider defining as `immutable` instead
 104 |  uint256 internal constant PROOF_QUOTIENT_POLY_PARTS_2_Y_SLOT = 0x200 + 0x520 + 0x280;

     |  // @audit-issue Consider defining as `immutable` instead
 105 |  uint256 internal constant PROOF_QUOTIENT_POLY_PARTS_3_X_SLOT = 0x200 + 0x520 + 0x2a0;

     |  // @audit-issue Consider defining as `immutable` instead
 106 |  uint256 internal constant PROOF_QUOTIENT_POLY_PARTS_3_Y_SLOT = 0x200 + 0x520 + 0x2c0;

     |  // @audit-issue Consider defining as `immutable` instead
 108 |  uint256 internal constant PROOF_STATE_POLYS_0_OPENING_AT_Z_SLOT = 0x200 + 0x520 + 0x2e0;

     |  // @audit-issue Consider defining as `immutable` instead
 109 |  uint256 internal constant PROOF_STATE_POLYS_1_OPENING_AT_Z_SLOT = 0x200 + 0x520 + 0x300;

     |  // @audit-issue Consider defining as `immutable` instead
 110 |  uint256 internal constant PROOF_STATE_POLYS_2_OPENING_AT_Z_SLOT = 0x200 + 0x520 + 0x320;

     |  // @audit-issue Consider defining as `immutable` instead
 111 |  uint256 internal constant PROOF_STATE_POLYS_3_OPENING_AT_Z_SLOT = 0x200 + 0x520 + 0x340;

     |  // @audit-issue Consider defining as `immutable` instead
 113 |  uint256 internal constant PROOF_STATE_POLYS_3_OPENING_AT_Z_OMEGA_SLOT = 0x200 + 0x520 + 0x360;

     |  // @audit-issue Consider defining as `immutable` instead
 114 |  uint256 internal constant PROOF_GATE_SELECTORS_0_OPENING_AT_Z_SLOT = 0x200 + 0x520 + 0x380;

     |  // @audit-issue Consider defining as `immutable` instead
 116 |  uint256 internal constant PROOF_COPY_PERMUTATION_POLYS_0_OPENING_AT_Z_SLOT = 0x200 + 0x520 + 0x3a0;

     |  // @audit-issue Consider defining as `immutable` instead
 117 |  uint256 internal constant PROOF_COPY_PERMUTATION_POLYS_1_OPENING_AT_Z_SLOT = 0x200 + 0x520 + 0x3c0;

     |  // @audit-issue Consider defining as `immutable` instead
 118 |  uint256 internal constant PROOF_COPY_PERMUTATION_POLYS_2_OPENING_AT_Z_SLOT = 0x200 + 0x520 + 0x3e0;

     |  // @audit-issue Consider defining as `immutable` instead
 120 |  uint256 internal constant PROOF_COPY_PERMUTATION_GRAND_PRODUCT_OPENING_AT_Z_OMEGA_SLOT = 0x200 + 0x520 + 0x400;

     |  // @audit-issue Consider defining as `immutable` instead
 121 |  uint256 internal constant PROOF_LOOKUP_S_POLY_OPENING_AT_Z_OMEGA_SLOT = 0x200 + 0x520 + 0x420;

     |  // @audit-issue Consider defining as `immutable` instead
 122 |  uint256 internal constant PROOF_LOOKUP_GRAND_PRODUCT_OPENING_AT_Z_OMEGA_SLOT = 0x200 + 0x520 + 0x440;

     |  // @audit-issue Consider defining as `immutable` instead
 123 |  uint256 internal constant PROOF_LOOKUP_T_POLY_OPENING_AT_Z_SLOT = 0x200 + 0x520 + 0x460;

     |  // @audit-issue Consider defining as `immutable` instead
 124 |  uint256 internal constant PROOF_LOOKUP_T_POLY_OPENING_AT_Z_OMEGA_SLOT = 0x200 + 0x520 + 0x480;

     |  // @audit-issue Consider defining as `immutable` instead
 125 |  uint256 internal constant PROOF_LOOKUP_SELECTOR_POLY_OPENING_AT_Z_SLOT = 0x200 + 0x520 + 0x4a0;

     |  // @audit-issue Consider defining as `immutable` instead
 126 |  uint256 internal constant PROOF_LOOKUP_TABLE_TYPE_POLY_OPENING_AT_Z_SLOT = 0x200 + 0x520 + 0x4c0;

     |  // @audit-issue Consider defining as `immutable` instead
 127 |  uint256 internal constant PROOF_QUOTIENT_POLY_OPENING_AT_Z_SLOT = 0x200 + 0x520 + 0x4e0;
```
GitHub: [27](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L27), [28](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L28), [29](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L29), [30](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L30), [31](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L31), [32](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L32), [33](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L33), [34](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L34), [35](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L35), [36](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L36), [37](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L37), [38](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L38), [39](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L39), [40](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L40), [41](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L41), [42](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L42), [44](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L44), [45](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L45), [46](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L46), [47](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L47), [49](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L49), [50](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L50), [51](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L51), [52](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L52), [53](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L53), [54](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L54), [55](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L55), [56](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L56), [58](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L58), [59](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L59), [61](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L61), [62](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L62), [63](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L63), [64](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L64), [65](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L65), [66](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L66), [67](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L67), [68](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L68), [70](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L70), [71](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L71), [73](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L73), [79](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L79), [81](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L81), [82](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L82), [83](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L83), [84](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L84), [85](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L85), [86](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L86), [87](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L87), [88](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L88), [90](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L90), [91](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L91), [93](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L93), [94](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L94), [96](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L96), [97](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L97), [99](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L99), [100](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L100), [101](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L101), [102](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L102), [103](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L103), [104](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L104), [105](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L105), [106](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L106), [108](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L108), [109](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L109), [110](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L110), [111](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L111), [113](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L113), [114](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L114), [116](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L116), [117](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L117), [118](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L118), [120](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L120), [121](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L121), [122](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L122), [123](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L123), [124](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L124), [125](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L125), [126](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L126), [127](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L127)


## [N-38] Function has excessive length

Long functions are more difficult to understand and test, and ought to be refactored where possible to reduce surprises.

*Instances: 13*

```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

     |  // @audit-issue Long function: 66 lines
 303 |  function _claimFailedDeposit(
 304 |      bool _checkedInLegacyBridge,
 305 |      uint256 _chainId,
 306 |      address _depositSender,
 307 |      address _l1Token,
 308 |      uint256 _amount,
 309 |      bytes32 _l2TxHash,
 310 |      uint256 _l2BatchNumber,
 311 |      uint256 _l2MessageIndex,
 312 |      uint16 _l2TxNumberInBatch,
 313 |      bytes32[] calldata _merkleProof
 314 |  ) internal nonReentrant {
```
GitHub: [303-314](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L303-L314)


```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

     |  // @audit-issue Long function: 62 lines
 262 |  function requestL2TransactionTwoBridges(
 263 |      L2TransactionRequestTwoBridgesOuter calldata _request
 264 |  ) external payable override nonReentrant returns (bytes32 canonicalTxHash) {
```
GitHub: [262-264](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L262-L264)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

     |  // @audit-issue Long function: 66 lines
  32 |  function _commitOneBatch(
  33 |      StoredBatchInfo memory _previousBatch,
  34 |      CommitBatchInfo calldata _newBatch,
  35 |      bytes32 _expectedSystemContractUpgradeTxHash
  36 |  ) internal view returns (StoredBatchInfo memory) {

     |  // @audit-issue Long function: 67 lines
 130 |  function _processL2Logs(
 131 |      CommitBatchInfo calldata _newBatch,
 132 |      bytes32 _expectedSystemContractUpgradeTxHash
 133 |  ) internal pure returns (LogProcessingOutput memory logOutput) {
```
GitHub: [32-36](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L32-L36), [130-133](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L130-L133)


```solidity
File: code/contracts/ethereum/contracts/state-transition/Verifier.sol

     |  // @audit-issue Long function: 1364 lines
 343 |  function verify(
 344 |      uint256[] calldata, // _publicInputs
 345 |      uint256[] calldata, // _proof
 346 |      uint256[] calldata // _recursiveAggregationInput
 347 |  ) external view returns (bool) {
```
GitHub: [343-347](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L343-L347)


```solidity
File: code/system-contracts/contracts/BootloaderUtilities.sol

     |  // @audit-issue Long function: 91 lines
  44 |  function encodeLegacyTransactionHash(Transaction calldata _transaction) internal view returns (bytes32 txHash) {

     |  // @audit-issue Long function: 86 lines
 139 |  function encodeEIP2930TransactionHash(Transaction calldata _transaction) internal view returns (bytes32) {

     |  // @audit-issue Long function: 91 lines
 229 |  function encodeEIP1559TransactionHash(Transaction calldata _transaction) internal view returns (bytes32) {
```
GitHub: [44](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L44), [139](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L139), [229](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L229)


```solidity
File: code/system-contracts/contracts/Compressor.sol

     |  // @audit-issue Long function: 81 lines
 110 |  function verifyCompressedStateDiffs(
 111 |      uint256 _numberOfStateDiffs,
 112 |      uint256 _enumerationIndexSize,
 113 |      bytes calldata _stateDiffs,
 114 |      bytes calldata _compressedStateDiffs
 115 |  ) external payable onlyCallFrom(address(L1_MESSENGER_CONTRACT)) returns (bytes32 stateDiffHash) {
```
GitHub: [110-115](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L110-L115)


```solidity
File: code/system-contracts/contracts/L1Messenger.sol

     |  // @audit-issue Long function: 140 lines
 194 |  function publishPubdataAndClearState(
 195 |      bytes calldata _totalL2ToL1PubdataAndStateDiffs
 196 |  ) external onlyCallFromBootloader {
```
GitHub: [194-196](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L194-L196)


```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

     |  // @audit-issue Long function: 69 lines
 147 |  function _encodeHashLegacyTransaction(Transaction calldata _transaction) private view returns (bytes32) {

     |  // @audit-issue Long function: 67 lines
 219 |  function _encodeHashEIP2930Transaction(Transaction calldata _transaction) private view returns (bytes32) {

     |  // @audit-issue Long function: 69 lines
 289 |  function _encodeHashEIP1559Transaction(Transaction calldata _transaction) private view returns (bytes32) {
```
GitHub: [147](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L147), [219](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L219), [289](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L289)


## [N-39] Function is empty

Consider adding a comment about why the function body is empty.

*Instances: 7*

```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

     |  // @audit-issue Consider documenting why the function body is empty
  60 |  function initialize() external reentrancyGuardInitializer {}
```
GitHub: [60](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L60)


```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

     |  // @audit-issue Consider documenting why the function body is empty
  38 |  constructor() reentrancyGuardInitializer {}
```
GitHub: [38](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L38)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol

     |  // @audit-issue Consider documenting why the function body is empty
  19 |  constructor() reentrancyGuardInitializer {}
```
GitHub: [19](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol#L19)


```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol

     |  // @audit-issue Consider documenting why the function body is empty
 263 |  function _upgradeL1Contract(bytes calldata _customCallDataForUpgrade) internal virtual {}

     |  // @audit-issue Consider documenting why the function body is empty
 269 |  function _postUpgrade(bytes calldata _customCallDataForUpgrade) internal virtual {}
```
GitHub: [263](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L263), [269](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L269)


```solidity
File: code/system-contracts/contracts/DefaultAccount.sol

     |  // @audit-issue Consider documenting why the function body is empty
 125 |  function executeTransactionFromOutside(Transaction calldata _transaction) external payable override {
 126 |      // Behave the same as for fallback/receive, just execute nothing, returns nothing
 127 |  }
```
GitHub: [125-127](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L125-L127)


```solidity
File: code/contracts/zksync/contracts/TestnetPaymaster.sol

     |  // @audit-issue Consider documenting why the function body is empty
  70 |  function postTransaction(
  71 |      bytes calldata _context,
  72 |      Transaction calldata _transaction,
  73 |      bytes32,
  74 |      bytes32,
  75 |      ExecutionResult _txResult,
  76 |      uint256 _maxRefundedGas
  77 |  ) external payable override {
  78 |      // Refunds are not supported yet.
  79 |  }
```
GitHub: [70-79](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/TestnetPaymaster.sol#L70-L79)


## [N-40] Function ordering does not follow the Solidity style guide

According to the [Solidity style guide](https://docs.soliditylang.org/en/v0.8.17/style-guide.html#order-of-functions), functions should be laid out in the following order :`constructor()`, `receive()`, `fallback()`, `external`, `public`, `internal`, `private`, but the cases below do not follow this pattern.

*Instances: 49*

```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

     |  // @audit-info Contract node order has style violations; recommended order is:
     |  // constructor ()
     |  // external initialize()
     |  // external tranferTokenToSharedBridge()
     |  // external l2TokenAddress()
     |  // external deposit()
     |  // external claimFailedDeposit()
     |  // external finalizeWithdrawal()
     |  // public deposit()
     |  // internal _depositFundsToSharedBridge()
  19 |  contract L1ERC20Bridge is IL1ERC20Bridge, ReentrancyGuard {
  :  |
     |      // @audit-issue external claimFailedDeposit() should be above internal _depositFundsToSharedBridge()
 176 |      function claimFailedDeposit(
 177 |          address _depositSender,
 178 |          address _l1Token,
 179 |          bytes32 _l2TxHash,
 180 |          uint256 _l2BatchNumber,
 181 |          uint256 _l2MessageIndex,
 182 |          uint16 _l2TxNumberInBatch,
 183 |          bytes32[] calldata _merkleProof
 184 |      ) external nonReentrant {
```
GitHub: [176-184](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L176-L184)


```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

     |  // @audit-info Contract node order has style violations; recommended order is:
     |  // constructor ()
     |  // external initialize()
     |  // external transferFundsFromLegacy()
     |  // external receiveEth()
     |  // external initializeChainGovernance()
     |  // external bridgehubDepositBaseToken()
     |  // external bridgehubDeposit()
     |  // external bridgehubConfirmL2Transaction()
     |  // external claimFailedDeposit()
     |  // external finalizeWithdrawal()
     |  // external depositLegacyErc20Bridge()
     |  // external finalizeWithdrawalLegacyErc20Bridge()
     |  // external claimFailedDepositLegacyErc20Bridge()
     |  // internal _depositFunds()
     |  // internal _getDepositL2Calldata()
     |  // internal _getERC20Getters()
     |  // internal _claimFailedDeposit()
     |  // internal _isEraLegacyWithdrawal()
     |  // internal _finalizeWithdrawal()
     |  // internal _checkWithdrawal()
     |  // internal _parseL2WithdrawalMessage()
  30 |  contract L1SharedBridge is IL1SharedBridge, ReentrancyGuard, Initializable, Ownable2Step {
  :  |
     |      // @audit-issue external bridgehubDeposit() should be above internal _depositFunds()
 182 |      function bridgehubDeposit(
 183 |          uint256 _chainId,
 184 |          address _prevMsgSender,
 185 |          uint256, // l2Value, needed for Weth deposits in the future
 186 |          bytes calldata _data
 187 |      ) external payable override onlyBridgehub returns (L2TransactionRequestTwoBridgesInner memory request) {
  :  |
     |      // @audit-issue external claimFailedDeposit() should be above internal _getERC20Getters()
 277 |      function claimFailedDeposit(
 278 |          uint256 _chainId,
 279 |          address _depositSender,
 280 |          address _l1Token,
 281 |          uint256 _amount,
 282 |          bytes32 _l2TxHash,
 283 |          uint256 _l2BatchNumber,
 284 |          uint256 _l2MessageIndex,
 285 |          uint16 _l2TxNumberInBatch,
 286 |          bytes32[] calldata _merkleProof
 287 |      ) external override {
  :  |
     |      // @audit-issue external finalizeWithdrawal() should be above internal _isEraLegacyWithdrawal()
 385 |      function finalizeWithdrawal(
 386 |          uint256 _chainId,
 387 |          uint256 _l2BatchNumber,
 388 |          uint256 _l2MessageIndex,
 389 |          uint16 _l2TxNumberInBatch,
 390 |          bytes calldata _message,
 391 |          bytes32[] calldata _merkleProof
 392 |      ) external override {
  :  |
     |      // @audit-issue external depositLegacyErc20Bridge() should be above internal _parseL2WithdrawalMessage()
 554 |      function depositLegacyErc20Bridge(
 555 |          address _prevMsgSender,
 556 |          address _l2Receiver,
 557 |          address _l1Token,
 558 |          uint256 _amount,
 559 |          uint256 _l2TxGasLimit,
 560 |          uint256 _l2TxGasPerPubdataByte,
 561 |          address _refundRecipient
 562 |      ) external payable override onlyLegacyBridge nonReentrant returns (bytes32 l2TxHash) {
```
GitHub: [182-187](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L182-L187), [277-287](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L277-L287), [385-392](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L385-L392), [554-562](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L554-L562)


```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

     |  // @audit-info Contract node order has style violations; recommended order is:
     |  // constructor ()
     |  // external initialize()
     |  // external setPendingAdmin()
     |  // external acceptAdmin()
     |  // external addStateTransitionManager()
     |  // external removeStateTransitionManager()
     |  // external addToken()
     |  // external setSharedBridge()
     |  // external createNewChain()
     |  // external proveL2MessageInclusion()
     |  // external proveL2LogInclusion()
     |  // external proveL1ToL2TransactionStatus()
     |  // external l2TransactionBaseCost()
     |  // external requestL2TransactionDirect()
     |  // external requestL2TransactionTwoBridges()
     |  // public getStateTransition()
     |  // internal _actualRefundRecipient()
  16 |  contract Bridgehub is IBridgehub, ReentrancyGuard, Ownable2Step {
  :  |
     |      // @audit-issue external addStateTransitionManager() should be above public getStateTransition()
  82 |      function addStateTransitionManager(address _stateTransitionManager) external onlyOwner {
```
GitHub: [82](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L82)


```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

     |  // @audit-info Contract node order has style violations; recommended order is:
     |  // constructor ()
     |  // receive ()
     |  // external scheduleTransparent()
     |  // external scheduleShadow()
     |  // external cancel()
     |  // external execute()
     |  // external executeInstant()
     |  // external updateDelay()
     |  // external updateSecurityCouncil()
     |  // public isOperation()
     |  // public isOperationPending()
     |  // public isOperationReady()
     |  // public isOperationDone()
     |  // public getOperationState()
     |  // public hashOperation()
     |  // internal _schedule()
     |  // internal _execute()
     |  // internal _checkPredecessorDone()
  20 |  contract Governance is IGovernance, Ownable2Step {
  :  |
     |      // @audit-issue external scheduleTransparent() should be above public getOperationState()
 129 |      function scheduleTransparent(Operation calldata _operation, uint256 _delay) external onlyOwner {
  :  |
     |      // @audit-issue external updateDelay() should be above internal _checkPredecessorDone()
 249 |      function updateDelay(uint256 _newDelay) external onlySelf {
  :  |
     |      // @audit-issue receive () should be above external updateSecurityCouncil()
 262 |      receive() external payable {}
```
GitHub: [129](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L129), [249](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L249), [262](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L262)


```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

     |  // @audit-info Contract node order has style violations; recommended order is:
     |  // constructor ()
     |  // external getChainAdmin()
     |  // external initialize()
     |  // external setPendingAdmin()
     |  // external acceptAdmin()
     |  // external setValidatorTimelock()
     |  // external setInitialCutHash()
     |  // external setNewVersionUpgrade()
     |  // external setUpgradeDiamondCut()
     |  // external freezeChain()
     |  // external unfreezeChain()
     |  // external revertBatches()
     |  // external registerAlreadyDeployedStateTransition()
     |  // external createNewChain()
     |  // internal _setChainIdUpgrade()
  27 |  contract StateTransitionManager is IStateTransitionManager, ReentrancyGuard, Ownable2Step {
  :  |
     |      // @audit-issue external registerAlreadyDeployedStateTransition() should be above internal _setChainIdUpgrade()
 232 |      function registerAlreadyDeployedStateTransition(
 233 |          uint256 _chainId,
 234 |          address _stateTransitionContract
 235 |      ) external onlyOwner {
```
GitHub: [232-235](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L232-L235)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

     |  // @audit-info Contract node order has style violations; recommended order is:
     |  // external commitBatches()
     |  // external commitBatchesSharedBridge()
     |  // external executeBatchesSharedBridge()
     |  // external executeBatches()
     |  // external proveBatches()
     |  // external proveBatchesSharedBridge()
     |  // external revertBatches()
     |  // external revertBatchesSharedBridge()
     |  // internal _commitOneBatch()
     |  // internal _verifyBatchTimestamp()
     |  // internal _processL2Logs()
     |  // internal _commitBatches()
     |  // internal _commitBatchesWithoutSystemContractsUpgrade()
     |  // internal _commitBatchesWithSystemContractsUpgrade()
     |  // internal _collectOperationsFromPriorityQueue()
     |  // internal _executeOneBatch()
     |  // internal _executeBatches()
     |  // internal _proveBatches()
     |  // internal _verifyProof()
     |  // internal _getBatchProofPublicInput()
     |  // internal _revertBatches()
     |  // internal _createBatchCommitment()
     |  // internal _batchPassThroughData()
     |  // internal _batchMetaParameters()
     |  // internal _batchAuxiliaryOutput()
     |  // internal _encodeBlobAuxilaryOutput()
     |  // internal _hashStoredBatchInfo()
     |  // internal _checkBit()
     |  // internal _setBit()
     |  // internal _pointEvaluationPrecompile()
     |  // internal _verifyBlobInformation()
     |  // internal _getBlobVersionedHash()
  22 |  contract ExecutorFacet is ZkSyncStateTransitionBase, IExecutor {
  :  |
     |      // @audit-issue external commitBatches() should be above internal _processL2Logs()
 199 |      function commitBatches(
 200 |          StoredBatchInfo memory _lastCommittedBatchData,
 201 |          CommitBatchInfo[] calldata _newBatchesData
 202 |      ) external nonReentrant onlyValidator {
  :  |
     |      // @audit-issue external executeBatchesSharedBridge() should be above internal _executeOneBatch()
 337 |      function executeBatchesSharedBridge(
 338 |          uint256,
 339 |          StoredBatchInfo[] calldata _batchesData
 340 |      ) external nonReentrant onlyValidator {
  :  |
     |      // @audit-issue external proveBatches() should be above internal _executeBatches()
 368 |      function proveBatches(
 369 |          StoredBatchInfo calldata _prevBatch,
 370 |          StoredBatchInfo[] calldata _committedBatches,
 371 |          ProofInput calldata _proof
 372 |      ) external nonReentrant onlyValidator {
  :  |
     |      // @audit-issue external revertBatches() should be above internal _getBatchProofPublicInput()
 472 |      function revertBatches(uint256 _newLastBatch) external nonReentrant onlyValidatorOrStateTransitionManager {
```
GitHub: [199-202](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L199-L202), [337-340](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L337-L340), [368-372](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L368-L372), [472](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L472)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

     |  // @audit-info Contract node order has style violations; recommended order is:
     |  // external transferEthToSharedBridge()
     |  // external bridgehubRequestL2Transaction()
     |  // external proveL2LogInclusion()
     |  // external finalizeEthWithdrawal()
     |  // external requestL2Transaction()
     |  // public proveL2MessageInclusion()
     |  // public proveL1ToL2TransactionStatus()
     |  // public l2TransactionBaseCost()
     |  // internal _proveL2LogInclusion()
     |  // internal _L2MessageToLog()
     |  // internal _deriveL2GasPrice()
     |  // internal _requestL2TransactionSender()
     |  // internal _requestL2Transaction()
     |  // internal _serializeL2Transaction()
     |  // internal _writePriorityOp()
     |  // internal _hashFactoryDeps()
  30 |  contract MailboxFacet is ZkSyncStateTransitionBase, IMailbox {
  :  |
     |      // @audit-issue external proveL2LogInclusion() should be above public proveL2MessageInclusion()
  64 |      function proveL2LogInclusion(
  65 |          uint256 _batchNumber,
  66 |          uint256 _index,
  67 |          L2Log memory _log,
  68 |          bytes32[] calldata _proof
  69 |      ) external view returns (bool) {
  :  |
     |      // @audit-issue public l2TransactionBaseCost() should be above internal _L2MessageToLog()
 143 |      function l2TransactionBaseCost(
 144 |          uint256 _gasPrice,
 145 |          uint256 _l2GasLimit,
 146 |          uint256 _l2GasPerPubdataByteLimit
 147 |      ) public view returns (uint256) {
  :  |
     |      // @audit-issue external finalizeEthWithdrawal() should be above internal _deriveL2GasPrice()
 178 |      function finalizeEthWithdrawal(
 179 |          uint256 _l2BatchNumber,
 180 |          uint256 _l2MessageIndex,
 181 |          uint16 _l2TxNumberInBatch,
 182 |          bytes calldata _message,
 183 |          bytes32[] calldata _merkleProof
 184 |      ) external nonReentrant {
```
GitHub: [64-69](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L64-L69), [143-147](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L143-L147), [178-184](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L178-L184)


```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol

     |  // @audit-info Contract node order has style violations; recommended order is:
     |  // public upgrade()
     |  // internal _upgradeVerifier()
     |  // internal _setBaseSystemContracts()
     |  // internal _setL2SystemContractUpgrade()
     |  // internal _setNewProtocolVersion()
     |  // internal _upgradeL1Contract()
     |  // internal _postUpgrade()
     |  // private _setL2DefaultAccountBytecodeHash()
     |  // private _setL2BootloaderBytecodeHash()
     |  // private _setVerifier()
     |  // private _setVerifierParams()
     |  // private _verifyFactoryDeps()
  44 |  abstract contract BaseZkSyncUpgrade is ZkSyncStateTransitionBase {
  :  |
     |      // @audit-issue internal _upgradeVerifier() should be above private _setVerifierParams()
 163 |      function _upgradeVerifier(address _newVerifier, VerifierParams calldata _verifierParams) internal {
  :  |
     |      // @audit-issue internal _setNewProtocolVersion() should be above private _verifyFactoryDeps()
 236 |      function _setNewProtocolVersion(uint256 _newProtocolVersion) internal virtual {
```
GitHub: [163](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L163), [236](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L236)


```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol

     |  // @audit-info Contract node order has style violations; recommended order is:
     |  // public upgrade()
     |  // internal _setNewProtocolVersion()
  17 |  abstract contract BaseZkSyncUpgradeGenesis is BaseZkSyncUpgrade {
  :  |
     |      // @audit-issue public upgrade() should be above internal _setNewProtocolVersion()
  47 |      function upgrade(ProposedUpgrade calldata _proposedUpgrade) public virtual override returns (bytes32) {
```
GitHub: [47](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L47)


```solidity
File: code/contracts/ethereum/contracts/state-transition/Verifier.sol

     |  // @audit-info Contract node order has style violations; recommended order is:
     |  // external verificationKeyHash()
     |  // external verify()
     |  // internal _loadVerificationKey()
  20 |  contract Verifier is IVerifier {
  :  |
     |      // @audit-issue external verify() should be above internal _loadVerificationKey()
 343 |      function verify(
 344 |          uint256[] calldata, // _publicInputs
 345 |          uint256[] calldata, // _proof
 346 |          uint256[] calldata // _recursiveAggregationInput
 347 |      ) external view returns (bool) {
```
GitHub: [343-347](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L343-L347)


```solidity
File: code/contracts/ethereum/contracts/upgrades/Upgrade_v1_4_1.sol

     |  // @audit-info Contract node order has style violations; recommended order is:
     |  // public upgrade()
     |  // private changeFeeParams()
  13 |  contract Upgrade_v1_4_1 is BaseZkSyncUpgrade {
  :  |
     |      // @audit-issue public upgrade() should be above private changeFeeParams()
  33 |      function upgrade(ProposedUpgrade calldata _proposedUpgrade) public override returns (bytes32) {
```
GitHub: [33](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/Upgrade_v1_4_1.sol#L33)


```solidity
File: code/system-contracts/contracts/AccountCodeStorage.sol

     |  // @audit-info Contract node order has style violations; recommended order is:
     |  // external storeAccountConstructingCodeHash()
     |  // external storeAccountConstructedCodeHash()
     |  // external markAccountCodeHashAsConstructed()
     |  // external getCodeHash()
     |  // external getCodeSize()
     |  // public getRawCodeHash()
     |  // internal _storeCodeHash()
  22 |  contract AccountCodeStorage is IAccountCodeStorage {
  :  |
     |      // @audit-issue public getRawCodeHash() should be above internal _storeCodeHash()
  78 |      function getRawCodeHash(address _address) public view override returns (bytes32 codeHash) {
  :  |
     |      // @audit-issue external getCodeHash() should be above public getRawCodeHash()
  89 |      function getCodeHash(uint256 _input) external view override returns (bytes32) {
```
GitHub: [78](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L78), [89](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L89)


```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

     |  // @audit-info Contract node order has style violations; recommended order is:
     |  // external getAccountInfo()
     |  // external updateAccountVersion()
     |  // external updateNonceOrdering()
     |  // external create2()
     |  // external create()
     |  // external forceDeployOnAddress()
     |  // external forceDeployOnAddresses()
     |  // public extendedAccountVersion()
     |  // public getNewAddressCreate2()
     |  // public getNewAddressCreate()
     |  // public create2Account()
     |  // public createAccount()
     |  // internal _storeAccountInfo()
     |  // internal _nonSystemDeployOnAddress()
     |  // internal _performDeployOnAddress()
     |  // internal _ensureBytecodeIsKnown()
     |  // internal _storeConstructingByteCodeHashOnAddress()
     |  // internal _constructContract()
  23 |  contract ContractDeployer is IContractDeployer, ISystemContract {
  :  |
     |      // @audit-issue external updateAccountVersion() should be above internal _storeAccountInfo()
  65 |      function updateAccountVersion(AccountAbstractionVersion _version) external onlySystemCall {
  :  |
     |      // @audit-issue external create2() should be above public getNewAddressCreate()
 132 |      function create2(
 133 |          bytes32 _salt,
 134 |          bytes32 _bytecodeHash,
 135 |          bytes calldata _input
 136 |      ) external payable override returns (address) {
  :  |
     |      // @audit-issue external forceDeployOnAddress() should be above public createAccount()
 213 |      function forceDeployOnAddress(ForceDeployment calldata _deployment, address _sender) external payable onlySelf {
```
GitHub: [65](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L65), [132-136](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L132-L136), [213](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L213)


```solidity
File: code/system-contracts/contracts/DefaultAccount.sol

     |  // @audit-info Contract node order has style violations; recommended order is:
     |  // receive ()
     |  // fallback ()
     |  // external validateTransaction()
     |  // external executeTransaction()
     |  // external executeTransactionFromOutside()
     |  // external payForTransaction()
     |  // external prepareForPaymaster()
     |  // internal _validateTransaction()
     |  // internal _execute()
     |  // internal _isValidSignature()
  19 |  contract DefaultAccount is IAccount {
  :  |
     |      // @audit-issue external executeTransaction() should be above internal _validateTransaction()
 112 |      function executeTransaction(
 113 |          bytes32, // _txHash
 114 |          bytes32, // _suggestedSignedHash
 115 |          Transaction calldata _transaction
 116 |      ) external payable override ignoreNonBootloader ignoreInDelegateCall {
  :  |
     |      // @audit-issue external payForTransaction() should be above internal _isValidSignature()
 196 |      function payForTransaction(
 197 |          bytes32, // _txHash
 198 |          bytes32, // _suggestedSignedHash
 199 |          Transaction calldata _transaction
 200 |      ) external payable ignoreNonBootloader ignoreInDelegateCall {
  :  |
     |      // @audit-issue fallback () should be above external prepareForPaymaster()
 220 |      fallback() external payable ignoreInDelegateCall {
  :  |
     |      // @audit-issue receive () should be above fallback ()
 227 |      receive() external payable {
```
GitHub: [112-116](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L112-L116), [196-200](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L196-L200), [220](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L220), [227](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L227)


```solidity
File: code/system-contracts/contracts/EmptyContract.sol

     |  // @audit-info Contract node order has style violations; recommended order is:
     |  // receive ()
     |  // fallback ()
  10 |  contract EmptyContract {
  :  |
     |      // @audit-issue receive () should be above fallback ()
  13 |      receive() external payable {}
```
GitHub: [13](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/EmptyContract.sol#L13)


```solidity
File: code/system-contracts/contracts/KnownCodesStorage.sol

     |  // @audit-info Contract node order has style violations; recommended order is:
     |  // external markFactoryDeps()
     |  // external markBytecodeAsPublished()
     |  // public getMarker()
     |  // internal _markBytecodeAsPublished()
     |  // internal _validateBytecode()
  18 |  contract KnownCodesStorage is IKnownCodesStorage, ISystemContract {
  :  |
     |      // @audit-issue public getMarker() should be above internal _markBytecodeAsPublished()
  65 |      function getMarker(bytes32 _hash) public view override returns (uint256 marker) {
```
GitHub: [65](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/KnownCodesStorage.sol#L65)


```solidity
File: code/system-contracts/contracts/L1Messenger.sol

     |  // @audit-info Contract node order has style violations; recommended order is:
     |  // external sendL2ToL1Log()
     |  // external sendToL1()
     |  // external requestBytecodeL1Publication()
     |  // external publishPubdataAndClearState()
     |  // internal keccakGasCost()
     |  // internal sha256GasCost()
     |  // internal _processL2ToL1Log()
  25 |  contract L1Messenger is IL1Messenger, ISystemContract {
  :  |
     |      // @audit-issue external sendL2ToL1Log() should be above internal sha256GasCost()
  70 |      function sendL2ToL1Log(
  71 |          bool _isService,
  72 |          bytes32 _key,
  73 |          bytes32 _value
  74 |      ) external onlyCallFromSystemContract returns (uint256 logIdInMerkleTree) {
  :  |
     |      // @audit-issue external sendToL1() should be above internal _processL2ToL1Log()
 116 |      function sendToL1(bytes calldata _message) external override returns (bytes32 hash) {
```
GitHub: [70-74](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L70-L74), [116](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L116)


```solidity
File: code/system-contracts/contracts/L2BaseToken.sol

     |  // @audit-info Contract node order has style violations; recommended order is:
     |  // external transferFromTo()
     |  // external balanceOf()
     |  // external mint()
     |  // external withdraw()
     |  // external withdrawWithMessage()
     |  // external name()
     |  // external symbol()
     |  // external decimals()
     |  // internal _burnMsgValue()
     |  // internal _getL1WithdrawMessage()
     |  // internal _getExtendedWithdrawMessage()
  18 |  contract L2BaseToken is IBaseToken, ISystemContract {
  :  |
     |      // @audit-issue external name() should be above internal _getExtendedWithdrawMessage()
 128 |      function name() external pure override returns (string memory) {
```
GitHub: [128](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L2BaseToken.sol#L128)


```solidity
File: code/system-contracts/contracts/MsgValueSimulator.sol

     |  // @audit-info Contract node order has style violations; recommended order is:
     |  // fallback ()
     |  // internal _getAbiParams()
  19 |  contract MsgValueSimulator is ISystemContract {
  :  |
     |      // @audit-issue fallback () should be above internal _getAbiParams()
  47 |      fallback(bytes calldata _data) external onlySystemCall returns (bytes memory) {
```
GitHub: [47](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/MsgValueSimulator.sol#L47)


```solidity
File: code/system-contracts/contracts/NonceHolder.sol

     |  // @audit-info Contract node order has style violations; recommended order is:
     |  // external incrementMinNonceIfEquals()
     |  // external getDeploymentNonce()
     |  // external incrementDeploymentNonce()
     |  // external validateNonceUsage()
     |  // public getMinNonce()
     |  // public getRawNonce()
     |  // public increaseMinNonce()
     |  // public setValueUnderNonce()
     |  // public getValueUnderNonce()
     |  // public isNonceUsed()
     |  // internal _splitRawNonce()
  27 |  contract NonceHolder is INonceHolder, ISystemContract {
  :  |
     |      // @audit-issue external incrementMinNonceIfEquals() should be above public getValueUnderNonce()
 110 |      function incrementMinNonceIfEquals(uint256 _expectedNonce) external onlySystemCall {
  :  |
     |      // @audit-issue external validateNonceUsage() should be above public isNonceUsed()
 166 |      function validateNonceUsage(address _address, uint256 _key, bool _shouldBeUsed) external view {
```
GitHub: [110](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/NonceHolder.sol#L110), [166](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/NonceHolder.sol#L166)


```solidity
File: code/system-contracts/contracts/SystemContext.sol

     |  // @audit-info Contract node order has style violations; recommended order is:
     |  // external setChainId()
     |  // external setTxOrigin()
     |  // external setGasPrice()
     |  // external setPubdataInfo()
     |  // external getCurrentPubdataCost()
     |  // external getBlockHashEVM()
     |  // external getBatchHash()
     |  // external setL2Block()
     |  // external appendTransactionToCurrentL2Block()
     |  // external publishTimestampDataToL1()
     |  // external setNewBatch()
     |  // external unsafeOverrideBatch()
     |  // external incrementTxNumberInBatch()
     |  // external resetTxNumberInBatch()
     |  // external currentBlockInfo()
     |  // external getBlockNumberAndTimestamp()
     |  // external blockHash()
     |  // public getCurrentPubdataSpent()
     |  // public getBatchNumberAndTimestamp()
     |  // public getL2BlockNumberAndTimestamp()
     |  // public getBlockNumber()
     |  // public getBlockTimestamp()
     |  // internal _getLatest257L2blockHash()
     |  // internal _setL2BlockHash()
     |  // internal _calculateL2BlockHash()
     |  // internal _calculateLegacyL2BlockHash()
     |  // internal _upgradeL2Blocks()
     |  // internal _setVirtualBlock()
     |  // internal _setNewL2BlockData()
     |  // internal _ensureBatchConsistentWithL2Block()
  17 |  contract SystemContext is ISystemContext, ISystemContextDeprecated, ISystemContract {
  :  |
     |      // @audit-issue external getCurrentPubdataCost() should be above public getCurrentPubdataSpent()
 122 |      function getCurrentPubdataCost() external view returns (uint256) {
  :  |
     |      // @audit-issue external setL2Block() should be above internal _setNewL2BlockData()
 341 |      function setL2Block(
 342 |          uint128 _l2BlockNumber,
 343 |          uint128 _l2BlockTimestamp,
 344 |          bytes32 _expectedPrevL2BlockHash,
 345 |          bool _isFirstInBatch,
 346 |          uint128 _maxVirtualBlocksToCreate
 347 |      ) external onlyCallFromBootloader {
  :  |
     |      // @audit-issue external setNewBatch() should be above internal _ensureBatchConsistentWithL2Block()
 444 |      function setNewBatch(
 445 |          bytes32 _prevBatchHash,
 446 |          uint128 _newTimestamp,
 447 |          uint128 _expectedNewNumber,
 448 |          uint256 _baseFee
 449 |      ) external onlyCallFromBootloader {
```
GitHub: [122](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L122), [341-347](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L341-L347), [444-449](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L444-L449)


```solidity
File: code/system-contracts/contracts/libraries/EfficientCall.sol

     |  // @audit-info Contract node order has style violations; recommended order is:
     |  // internal keccak()
     |  // internal sha()
     |  // internal call()
     |  // internal staticCall()
     |  // internal delegateCall()
     |  // internal mimicCall()
     |  // internal rawCall()
     |  // internal rawStaticCall()
     |  // internal rawDelegateCall()
     |  // internal rawMimicCall()
     |  // internal propagateRevert()
     |  // private _verifyCallResult()
     |  // private _loadFarCallABIIntoActivePtr()
  32 |  library EfficientCall {
  :  |
     |      // @audit-issue internal propagateRevert() should be above private _verifyCallResult()
 232 |      function propagateRevert() internal pure {
```
GitHub: [232](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L232)


```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

     |  // @audit-info Contract node order has style violations; recommended order is:
     |  // internal isEthToken()
     |  // internal encodeHash()
     |  // internal processPaymasterInput()
     |  // internal payToTheBootloader()
     |  // internal totalRequiredBalance()
     |  // private _encodeHashEIP712Transaction()
     |  // private _encodeHashLegacyTransaction()
     |  // private _encodeHashEIP2930Transaction()
     |  // private _encodeHashEIP1559Transaction()
  78 |  library TransactionHelper {
  :  |
     |      // @audit-issue internal processPaymasterInput() should be above private _encodeHashEIP1559Transaction()
 362 |      function processPaymasterInput(Transaction calldata _transaction) internal {
```
GitHub: [362](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L362)


```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

     |  // @audit-info Contract node order has style violations; recommended order is:
     |  // constructor ()
     |  // external initialize()
     |  // external finalizeDeposit()
     |  // external withdraw()
     |  // public l2TokenAddress()
     |  // internal _deployL2Token()
     |  // internal _getL1WithdrawMessage()
     |  // internal _getCreate2Salt()
     |  // internal _deployBeaconProxy()
  23 |  contract L2SharedBridge is IL2SharedBridge, Initializable {
  :  |
     |      // @audit-issue external withdraw() should be above internal _deployL2Token()
 123 |      function withdraw(address _l1Receiver, address _l2Token, uint256 _amount) external override {
  :  |
     |      // @audit-issue public l2TokenAddress() should be above internal _getL1WithdrawMessage()
 149 |      function l2TokenAddress(address _l1Token) public view override returns (address) {
```
GitHub: [123](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L123), [149](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L149)


```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

     |  // @audit-info Contract node order has style violations; recommended order is:
     |  // constructor ()
     |  // external bridgeInitialize()
     |  // external reinitializeToken()
     |  // external bridgeMint()
     |  // external bridgeBurn()
     |  // external decodeString()
     |  // external decodeUint8()
     |  // public name()
     |  // public symbol()
     |  // public decimals()
  15 |  contract L2StandardERC20 is ERC20PermitUpgradeable, IL2StandardToken, ERC1967Upgrade {
  :  |
     |      // @audit-issue external decodeString() should be above public decimals()
 178 |      function decodeString(bytes memory _input) external pure returns (string memory result) {
```
GitHub: [178](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L178)


```solidity
File: code/contracts/zksync/contracts/TestnetPaymaster.sol

     |  // @audit-info Contract node order has style violations; recommended order is:
     |  // receive ()
     |  // external validateAndPayForPaymasterTransaction()
     |  // external postTransaction()
  13 |  contract TestnetPaymaster is IPaymaster {
  :  |
     |      // @audit-issue receive () should be above external postTransaction()
  81 |      receive() external payable {}
```
GitHub: [81](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/TestnetPaymaster.sol#L81)


```solidity
File: code/contracts/zksync/contracts/bridge/L2WrappedBaseToken.sol

     |  // @audit-info Contract node order has style violations; recommended order is:
     |  // constructor ()
     |  // receive ()
     |  // external initializeV2()
     |  // external bridgeMint()
     |  // external bridgeBurn()
     |  // external deposit()
     |  // external withdraw()
     |  // public depositTo()
     |  // public withdrawTo()
  23 |  contract L2WrappedBaseToken is ERC20PermitUpgradeable, IL2WrappedBaseToken, IL2StandardToken {
  :  |
     |      // @audit-issue receive () should be above public withdrawTo()
 113 |      receive() external payable {
```
GitHub: [113](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2WrappedBaseToken.sol#L113)


## [N-41] High cyclomatic complexity

Cyclomatic complexity is a quantitative measure of the number of linearly independent paths through a program's source code:
                
| Cyclomatic Complexity | Interpretation | Recommendation |
| - | - | - |
| 1..9 | 🟢 Low complexity | Acceptable |
| 10..19 | 🟡 Moderate complexity | Careful testing and documentation |
| 20..29 | 🟠 High complexity | Candidate for refactoring |
| 30+ | ⛔ Very high complexity | At high risk of errors |

The following functions have a moderate or higher complexity i.e. 10 or more decision points. Consider breaking down these functions into more manageable units, by splitting things into utility functions, by reducing nesting, and by using early returns.

*Instances: 5*

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

     |  // @audit-issue This function has a cyclomatic complexity of 13
 130 |      function _processL2Logs(
 131 |          CommitBatchInfo calldata _newBatch,
 132 |          bytes32 _expectedSystemContractUpgradeTxHash
 133 |      ) internal pure returns (LogProcessingOutput memory logOutput) {
 134 |          // Copy L2 to L1 logs into memory.
 135 |          bytes memory emittedL2Logs = _newBatch.systemLogs;
 137 |          // Used as bitmap to set/check log processing happens exactly once.
 138 |          // See SystemLogKey enum in Constants.sol for ordering.
 139 |          uint256 processedLogs;
 141 |          // linear traversal of the logs
 142 |          for (uint256 i = 0; i < emittedL2Logs.length; i = i.uncheckedAdd(L2_TO_L1_LOG_SERIALIZE_SIZE)) {
 143 |              // Extract the values to be compared to/used such as the log sender, key, and value
 144 |              (address logSender, ) = UnsafeBytes.readAddress(emittedL2Logs, i + L2_LOG_ADDRESS_OFFSET);
 145 |              (uint256 logKey, ) = UnsafeBytes.readUint256(emittedL2Logs, i + L2_LOG_KEY_OFFSET);
 146 |              (bytes32 logValue, ) = UnsafeBytes.readBytes32(emittedL2Logs, i + L2_LOG_VALUE_OFFSET);
 148 |              // Ensure that the log hasn't been processed already
 149 |              require(!_checkBit(processedLogs, uint8(logKey)), "kp");
 150 |              processedLogs = _setBit(processedLogs, uint8(logKey));
 152 |              // Need to check that each log was sent by the correct address.
 153 |              if (logKey == uint256(SystemLogKey.L2_TO_L1_LOGS_TREE_ROOT_KEY)) {
 154 |                  require(logSender == L2_TO_L1_MESSENGER_SYSTEM_CONTRACT_ADDR, "lm");
 155 |                  logOutput.l2LogsTreeRoot = logValue;
 156 |              } else if (logKey == uint256(SystemLogKey.TOTAL_L2_TO_L1_PUBDATA_KEY)) {
 157 |                  require(logSender == L2_TO_L1_MESSENGER_SYSTEM_CONTRACT_ADDR, "ln");
 158 |                  logOutput.pubdataHash = logValue;
 159 |              } else if (logKey == uint256(SystemLogKey.STATE_DIFF_HASH_KEY)) {
 160 |                  require(logSender == L2_TO_L1_MESSENGER_SYSTEM_CONTRACT_ADDR, "lb");
 161 |                  logOutput.stateDiffHash = logValue;
 162 |              } else if (logKey == uint256(SystemLogKey.PACKED_BATCH_AND_L2_BLOCK_TIMESTAMP_KEY)) {
 163 |                  require(logSender == L2_SYSTEM_CONTEXT_SYSTEM_CONTRACT_ADDR, "sc");
 164 |                  logOutput.packedBatchAndL2BlockTimestamp = uint256(logValue);
 165 |              } else if (logKey == uint256(SystemLogKey.PREV_BATCH_HASH_KEY)) {
 166 |                  require(logSender == L2_SYSTEM_CONTEXT_SYSTEM_CONTRACT_ADDR, "sv");
 167 |                  logOutput.previousBatchHash = logValue;
 168 |              } else if (logKey == uint256(SystemLogKey.CHAINED_PRIORITY_TXN_HASH_KEY)) {
 169 |                  require(logSender == L2_BOOTLOADER_ADDRESS, "bl");
 170 |                  logOutput.chainedPriorityTxsHash = logValue;
 171 |              } else if (logKey == uint256(SystemLogKey.NUMBER_OF_LAYER_1_TXS_KEY)) {
 172 |                  require(logSender == L2_BOOTLOADER_ADDRESS, "bk");
 173 |                  logOutput.numberOfLayer1Txs = uint256(logValue);
 174 |              } else if (logKey == uint256(SystemLogKey.BLOB_ONE_HASH_KEY)) {
 175 |                  require(logSender == L2_PUBDATA_CHUNK_PUBLISHER_ADDR, "pc");
 176 |                  logOutput.blob1Hash = logValue;
 177 |              } else if (logKey == uint256(SystemLogKey.BLOB_TWO_HASH_KEY)) {
 178 |                  require(logSender == L2_PUBDATA_CHUNK_PUBLISHER_ADDR, "pd");
 179 |                  logOutput.blob2Hash = logValue;
 180 |              } else if (logKey == uint256(SystemLogKey.EXPECTED_SYSTEM_CONTRACT_UPGRADE_TX_HASH_KEY)) {
 181 |                  require(logSender == L2_BOOTLOADER_ADDRESS, "bu");
 182 |                  require(_expectedSystemContractUpgradeTxHash == logValue, "ut");
 183 |              } else {
 184 |                  revert("ul");
 185 |              }
 186 |          }
 188 |          // We only require 9 logs to be checked, the 10th is if we are expecting a protocol upgrade
 189 |          // Without the protocol upgrade we expect 9 logs: 2^9 - 1 = 511
 190 |          // With the protocol upgrade we expect 8 logs: 2^10 - 1 = 1023
 191 |          if (_expectedSystemContractUpgradeTxHash == bytes32(0)) {
 192 |              require(processedLogs == 511, "b7");
 193 |          } else {
 194 |              require(processedLogs == 1023, "b8");
 195 |          }
 196 |      }
```
GitHub: [130-196](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L130-L196)


```solidity
File: code/system-contracts/contracts/Compressor.sol

     |  // @audit-issue This function has a cyclomatic complexity of 12
 110 |      function verifyCompressedStateDiffs(
 111 |          uint256 _numberOfStateDiffs,
 112 |          uint256 _enumerationIndexSize,
 113 |          bytes calldata _stateDiffs,
 114 |          bytes calldata _compressedStateDiffs
 115 |      ) external payable onlyCallFrom(address(L1_MESSENGER_CONTRACT)) returns (bytes32 stateDiffHash) {
 116 |          // We do not enforce the operator to use the optimal, i.e. the minimally possible _enumerationIndexSize.
 117 |          // We do enforce however, that the _enumerationIndexSize is not larger than 8 bytes long, which is the
 118 |          // maximal ever possible size for enumeration index.
 119 |          require(_enumerationIndexSize <= MAX_ENUMERATION_INDEX_SIZE, "enumeration index size is too large");
 121 |          uint256 numberOfInitialWrites = uint256(_compressedStateDiffs.readUint16(0));
 123 |          uint256 stateDiffPtr = 2;
 124 |          uint256 numInitialWritesProcessed = 0;
 126 |          // Process initial writes
 127 |          for (uint256 i = 0; i < _numberOfStateDiffs * STATE_DIFF_ENTRY_SIZE; i += STATE_DIFF_ENTRY_SIZE) {
 128 |              bytes calldata stateDiff = _stateDiffs[i:i + STATE_DIFF_ENTRY_SIZE];
 129 |              uint64 enumIndex = stateDiff.readUint64(84);
 130 |              if (enumIndex != 0) {
 131 |                  // It is a repeated write, so we skip it.
 132 |                  continue;
 133 |              }
 135 |              numInitialWritesProcessed++;
 137 |              bytes32 derivedKey = stateDiff.readBytes32(52);
 138 |              uint256 initValue = stateDiff.readUint256(92);
 139 |              uint256 finalValue = stateDiff.readUint256(124);
 140 |              require(derivedKey == _compressedStateDiffs.readBytes32(stateDiffPtr), "iw: initial key mismatch");
 141 |              stateDiffPtr += 32;
 143 |              uint8 metadata = uint8(bytes1(_compressedStateDiffs[stateDiffPtr]));
 144 |              stateDiffPtr++;
 145 |              uint8 operation = metadata & OPERATION_BITMASK;
 146 |              uint8 len = operation == 0 ? 32 : metadata >> LENGTH_BITS_OFFSET;
 147 |              _verifyValueCompression(
 148 |                  initValue,
 149 |                  finalValue,
 150 |                  operation,
 151 |                  _compressedStateDiffs[stateDiffPtr:stateDiffPtr + len]
 152 |              );
 153 |              stateDiffPtr += len;
 154 |          }
 156 |          require(numInitialWritesProcessed == numberOfInitialWrites, "Incorrect number of initial storage diffs");
 158 |          // Process repeated writes
 159 |          for (uint256 i = 0; i < _numberOfStateDiffs * STATE_DIFF_ENTRY_SIZE; i += STATE_DIFF_ENTRY_SIZE) {
 160 |              bytes calldata stateDiff = _stateDiffs[i:i + STATE_DIFF_ENTRY_SIZE];
 161 |              uint64 enumIndex = stateDiff.readUint64(84);
 162 |              if (enumIndex == 0) {
 163 |                  continue;
 164 |              }
 166 |              uint256 initValue = stateDiff.readUint256(92);
 167 |              uint256 finalValue = stateDiff.readUint256(124);
 168 |              uint256 compressedEnumIndex = _sliceToUint256(
 169 |                  _compressedStateDiffs[stateDiffPtr:stateDiffPtr + _enumerationIndexSize]
 170 |              );
 171 |              require(enumIndex == compressedEnumIndex, "rw: enum key mismatch");
 172 |              stateDiffPtr += _enumerationIndexSize;
 174 |              uint8 metadata = uint8(bytes1(_compressedStateDiffs[stateDiffPtr]));
 175 |              stateDiffPtr += 1;
 176 |              uint8 operation = metadata & OPERATION_BITMASK;
 177 |              uint8 len = operation == 0 ? 32 : metadata >> LENGTH_BITS_OFFSET;
 178 |              _verifyValueCompression(
 179 |                  initValue,
 180 |                  finalValue,
 181 |                  operation,
 182 |                  _compressedStateDiffs[stateDiffPtr:stateDiffPtr + len]
 183 |              );
 184 |              stateDiffPtr += len;
 185 |          }
 187 |          require(stateDiffPtr == _compressedStateDiffs.length, "Extra data in _compressedStateDiffs");
 189 |          stateDiffHash = EfficientCall.keccak(_stateDiffs);
 190 |      }
```
GitHub: [110-190](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L110-L190)


```solidity
File: code/system-contracts/contracts/L1Messenger.sol

     |  // @audit-issue This function has a cyclomatic complexity of 15
 194 |      function publishPubdataAndClearState(
 195 |          bytes calldata _totalL2ToL1PubdataAndStateDiffs
 196 |      ) external onlyCallFromBootloader {
 197 |          uint256 calldataPtr = 0;
 199 |          /// Check logs
 200 |          uint32 numberOfL2ToL1Logs = uint32(bytes4(_totalL2ToL1PubdataAndStateDiffs[calldataPtr:calldataPtr + 4]));
 201 |          require(numberOfL2ToL1Logs <= L2_TO_L1_LOGS_MERKLE_TREE_LEAVES, "Too many L2->L1 logs");
 202 |          calldataPtr += 4;
 204 |          bytes32[] memory l2ToL1LogsTreeArray = new bytes32[](L2_TO_L1_LOGS_MERKLE_TREE_LEAVES);
 205 |          bytes32 reconstructedChainedLogsHash;
 206 |          for (uint256 i = 0; i < numberOfL2ToL1Logs; ++i) {
 207 |              bytes32 hashedLog = EfficientCall.keccak(
 208 |                  _totalL2ToL1PubdataAndStateDiffs[calldataPtr:calldataPtr + L2_TO_L1_LOG_SERIALIZE_SIZE]
 209 |              );
 210 |              calldataPtr += L2_TO_L1_LOG_SERIALIZE_SIZE;
 211 |              l2ToL1LogsTreeArray[i] = hashedLog;
 212 |              reconstructedChainedLogsHash = keccak256(abi.encode(reconstructedChainedLogsHash, hashedLog));
 213 |          }
 214 |          require(
 215 |              reconstructedChainedLogsHash == chainedLogsHash,
 216 |              "reconstructedChainedLogsHash is not equal to chainedLogsHash"
 217 |          );
 218 |          for (uint256 i = numberOfL2ToL1Logs; i < L2_TO_L1_LOGS_MERKLE_TREE_LEAVES; ++i) {
 219 |              l2ToL1LogsTreeArray[i] = L2_L1_LOGS_TREE_DEFAULT_LEAF_HASH;
 220 |          }
 221 |          uint256 nodesOnCurrentLevel = L2_TO_L1_LOGS_MERKLE_TREE_LEAVES;
 222 |          while (nodesOnCurrentLevel > 1) {
 223 |              nodesOnCurrentLevel /= 2;
 224 |              for (uint256 i = 0; i < nodesOnCurrentLevel; ++i) {
 225 |                  l2ToL1LogsTreeArray[i] = keccak256(
 226 |                      abi.encode(l2ToL1LogsTreeArray[2 * i], l2ToL1LogsTreeArray[2 * i + 1])
 227 |                  );
 228 |              }
 229 |          }
 230 |          bytes32 l2ToL1LogsTreeRoot = l2ToL1LogsTreeArray[0];
 232 |          /// Check messages
 233 |          uint32 numberOfMessages = uint32(bytes4(_totalL2ToL1PubdataAndStateDiffs[calldataPtr:calldataPtr + 4]));
 234 |          calldataPtr += 4;
 235 |          bytes32 reconstructedChainedMessagesHash;
 236 |          for (uint256 i = 0; i < numberOfMessages; ++i) {
 237 |              uint32 currentMessageLength = uint32(bytes4(_totalL2ToL1PubdataAndStateDiffs[calldataPtr:calldataPtr + 4]));
 238 |              calldataPtr += 4;
 239 |              bytes32 hashedMessage = EfficientCall.keccak(
 240 |                  _totalL2ToL1PubdataAndStateDiffs[calldataPtr:calldataPtr + currentMessageLength]
 241 |              );
 242 |              calldataPtr += currentMessageLength;
 243 |              reconstructedChainedMessagesHash = keccak256(abi.encode(reconstructedChainedMessagesHash, hashedMessage));
 244 |          }
 245 |          require(
 246 |              reconstructedChainedMessagesHash == chainedMessagesHash,
 247 |              "reconstructedChainedMessagesHash is not equal to chainedMessagesHash"
 248 |          );
 250 |          /// Check bytecodes
 251 |          uint32 numberOfBytecodes = uint32(bytes4(_totalL2ToL1PubdataAndStateDiffs[calldataPtr:calldataPtr + 4]));
 252 |          calldataPtr += 4;
 253 |          bytes32 reconstructedChainedL1BytecodesRevealDataHash;
 254 |          for (uint256 i = 0; i < numberOfBytecodes; ++i) {
 255 |              uint32 currentBytecodeLength = uint32(
 256 |                  bytes4(_totalL2ToL1PubdataAndStateDiffs[calldataPtr:calldataPtr + 4])
 257 |              );
 258 |              calldataPtr += 4;
 259 |              reconstructedChainedL1BytecodesRevealDataHash = keccak256(
 260 |                  abi.encode(
 261 |                      reconstructedChainedL1BytecodesRevealDataHash,
 262 |                      Utils.hashL2Bytecode(
 263 |                          _totalL2ToL1PubdataAndStateDiffs[calldataPtr:calldataPtr + currentBytecodeLength]
 264 |                      )
 265 |                  )
 266 |              );
 267 |              calldataPtr += currentBytecodeLength;
 268 |          }
 269 |          require(
 270 |              reconstructedChainedL1BytecodesRevealDataHash == chainedL1BytecodesRevealDataHash,
 271 |              "reconstructedChainedL1BytecodesRevealDataHash is not equal to chainedL1BytecodesRevealDataHash"
 272 |          );
 274 |          /// Check State Diffs
 275 |          /// encoding is as follows:
 276 |          /// header (1 byte version, 3 bytes total len of compressed, 1 byte enumeration index size)
 277 |          /// body (`compressedStateDiffSize` bytes, 4 bytes number of state diffs, `numberOfStateDiffs` * `STATE_DIFF_ENTRY_SIZE` bytes for the uncompressed state diffs)
 278 |          /// encoded state diffs: [20bytes address][32bytes key][32bytes derived key][8bytes enum index][32bytes initial value][32bytes final value]
 279 |          require(
 280 |              uint256(uint8(bytes1(_totalL2ToL1PubdataAndStateDiffs[calldataPtr]))) ==
 281 |                  STATE_DIFF_COMPRESSION_VERSION_NUMBER,
 282 |              "state diff compression version mismatch"
 283 |          );
 284 |          calldataPtr++;
 286 |          uint24 compressedStateDiffSize = uint24(bytes3(_totalL2ToL1PubdataAndStateDiffs[calldataPtr:calldataPtr + 3]));
 287 |          calldataPtr += 3;
 289 |          uint8 enumerationIndexSize = uint8(bytes1(_totalL2ToL1PubdataAndStateDiffs[calldataPtr]));
 290 |          calldataPtr++;
 292 |          bytes calldata compressedStateDiffs = _totalL2ToL1PubdataAndStateDiffs[calldataPtr:calldataPtr +
 293 |              compressedStateDiffSize];
 294 |          calldataPtr += compressedStateDiffSize;
 296 |          bytes calldata totalL2ToL1Pubdata = _totalL2ToL1PubdataAndStateDiffs[:calldataPtr];
 298 |          require(calldataPtr <= MAX_ALLOWED_PUBDATA_PER_BATCH, "L1 Messenger pubdata is too long");
 300 |          uint32 numberOfStateDiffs = uint32(bytes4(_totalL2ToL1PubdataAndStateDiffs[calldataPtr:calldataPtr + 4]));
 301 |          calldataPtr += 4;
 303 |          bytes calldata stateDiffs = _totalL2ToL1PubdataAndStateDiffs[calldataPtr:calldataPtr +
 304 |              (numberOfStateDiffs * STATE_DIFF_ENTRY_SIZE)];
 305 |          calldataPtr += numberOfStateDiffs * STATE_DIFF_ENTRY_SIZE;
 307 |          bytes32 stateDiffHash = COMPRESSOR_CONTRACT.verifyCompressedStateDiffs(
 308 |              numberOfStateDiffs,
 309 |              enumerationIndexSize,
 310 |              stateDiffs,
 311 |              compressedStateDiffs
 312 |          );
 314 |          /// Check for calldata strict format
 315 |          require(calldataPtr == _totalL2ToL1PubdataAndStateDiffs.length, "Extra data in the totalL2ToL1Pubdata array");
 317 |          PUBDATA_CHUNK_PUBLISHER.chunkAndPublishPubdata(totalL2ToL1Pubdata);
 319 |          /// Native (VM) L2 to L1 log
 320 |          SystemContractHelper.toL1(true, bytes32(uint256(SystemLogKey.L2_TO_L1_LOGS_TREE_ROOT_KEY)), l2ToL1LogsTreeRoot);
 321 |          SystemContractHelper.toL1(
 322 |              true,
 323 |              bytes32(uint256(SystemLogKey.TOTAL_L2_TO_L1_PUBDATA_KEY)),
 324 |              EfficientCall.keccak(totalL2ToL1Pubdata)
 325 |          );
 326 |          SystemContractHelper.toL1(true, bytes32(uint256(SystemLogKey.STATE_DIFF_HASH_KEY)), stateDiffHash);
 328 |          /// Clear logs state
 329 |          chainedLogsHash = bytes32(0);
 330 |          numberOfLogsToProcess = 0;
 331 |          chainedMessagesHash = bytes32(0);
 332 |          chainedL1BytecodesRevealDataHash = bytes32(0);
 333 |      }
```
GitHub: [194-333](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L194-L333)


```solidity
File: code/system-contracts/contracts/SystemContext.sol

     |  // @audit-issue This function has a cyclomatic complexity of 10
 132 |      function getBlockHashEVM(uint256 _block) external view returns (bytes32 hash) {
 133 |          uint128 blockNumber = currentVirtualL2BlockInfo.number;
 135 |          VirtualBlockUpgradeInfo memory currentVirtualBlockUpgradeInfo = virtualBlockUpgradeInfo;
 137 |          // Due to virtual blocks upgrade, we'll have to use the following logic for retreiving the blockhash:
 138 |          // 1. If the block number is out of the 256-block supported range, return 0.
 139 |          // 2. If the block was created before the upgrade for the virtual blocks (i.e. there we used to use hashes of the batches),
 140 |          // we return the hash of the batch.
 141 |          // 3. If the block was created after the day when the virtual blocks have caught up with the L2 blocks, i.e.
 142 |          // all the information which is returned for users should be for L2 blocks, we return the hash of the corresponding L2 block.
 143 |          // 4. If the block queried is a virtual blocks, calculate it on the fly.
 144 |          if (blockNumber <= _block || blockNumber - _block > 256) {
 145 |              hash = bytes32(0);
 146 |          } else if (_block < currentVirtualBlockUpgradeInfo.virtualBlockStartBatch) {
 147 |              // Note, that we will get into this branch only for a brief moment of time, right after the upgrade
 148 |              // for virtual blocks before 256 virtual blocks are produced.
 149 |              hash = batchHashes[_block];
 150 |          } else if (
 151 |              _block >= currentVirtualBlockUpgradeInfo.virtualBlockFinishL2Block &&
 152 |              currentVirtualBlockUpgradeInfo.virtualBlockFinishL2Block > 0
 153 |          ) {
 154 |              hash = _getLatest257L2blockHash(_block);
 155 |          } else {
 156 |              // Important: we do not want this number to ever collide with the L2 block hash (either new or old one) and so
 157 |              // that's why the legacy L2 blocks' hashes are keccak256(abi.encodePacked(uint32(_block))), while these are equivalent to
 158 |              // keccak256(abi.encodePacked(_block))
 159 |              hash = keccak256(abi.encode(_block));
 160 |          }
 161 |      }
```
GitHub: [132-161](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L132-L161)


```solidity
File: code/system-contracts/contracts/libraries/RLPEncoder.sol

     |  // @audit-issue This function has a cyclomatic complexity of 10
  84 |  function _highestByteSet(uint256 _number) private pure returns (uint256 hbs) {
  85 |      unchecked {
  86 |          if (_number > type(uint128).max) {
  87 |              _number >>= 128;
  88 |              hbs += 16;
  89 |          }
  90 |          if (_number > type(uint64).max) {
  91 |              _number >>= 64;
  92 |              hbs += 8;
  93 |          }
  94 |          if (_number > type(uint32).max) {
  95 |              _number >>= 32;
  96 |              hbs += 4;
  97 |          }
  98 |          if (_number > type(uint16).max) {
  99 |              _number >>= 16;
 100 |              hbs += 2;
 101 |          }
 102 |          if (_number > type(uint8).max) {
 103 |              hbs += 1;
 104 |          }
 105 |      }
 106 |  }
```
GitHub: [84-106](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/RLPEncoder.sol#L84-L106)


## [N-42] Import directives should uses aliases

Using import directives of the form `import {<identifier_name>} from "some/file.sol"` avoids polluting the symbol namespace making flattened files smaller, and speeds up compilation (but does not save any gas)

*Instances: 50*

```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

     |  // @audit-issue Import specific identifiers rather than whole file
   7 |  import "./IBridgehub.sol";

     |  // @audit-issue Import specific identifiers rather than whole file
   8 |  import "../bridge/interfaces/IL1SharedBridge.sol";

     |  // @audit-issue Import specific identifiers rather than whole file
   9 |  import "../state-transition/IStateTransitionManager.sol";

     |  // @audit-issue Import specific identifiers rather than whole file
  10 |  import "../common/ReentrancyGuard.sol";

     |  // @audit-issue Import specific identifiers rather than whole file
  11 |  import "../state-transition/chain-interfaces/IZkSyncStateTransition.sol";

     |  // @audit-issue Import specific identifiers rather than whole file
  14 |  import "../vendor/AddressAliasHelper.sol";
```
GitHub: [7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L7), [8](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L8), [9](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L9), [10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L10), [11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L11), [14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L14)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol

     |  // @audit-issue Import specific identifiers rather than whole file
  12 |  import "../l2-deps/ISystemContext.sol";
```
GitHub: [12](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol#L12)


```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol

     |  // @audit-issue Import specific identifiers rather than whole file
   5 |  import "../state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol";

     |  // @audit-issue Import specific identifiers rather than whole file
   6 |  import "../state-transition/chain-interfaces/IMailbox.sol";

     |  // @audit-issue Import specific identifiers rather than whole file
   7 |  import "../state-transition/chain-interfaces/IVerifier.sol";

     |  // @audit-issue Import specific identifiers rather than whole file
   8 |  import "../common/libraries/L2ContractHelper.sol";

     |  // @audit-issue Import specific identifiers rather than whole file
   9 |  import "../common/Messaging.sol";

     |  // @audit-issue Import specific identifiers rather than whole file
  10 |  import "../state-transition/libraries/TransactionValidator.sol";
```
GitHub: [5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L5), [6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L6), [7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L7), [8](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L8), [9](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L9), [10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L10)


```solidity
File: code/contracts/ethereum/contracts/upgrades/GenesisUpgrade.sol

     |  // @audit-issue Import specific identifiers rather than whole file
   5 |  import "../state-transition/libraries/Diamond.sol";

     |  // @audit-issue Import specific identifiers rather than whole file
   6 |  import "./BaseZkSyncUpgradeGenesis.sol";

     |  // @audit-issue Import specific identifiers rather than whole file
   7 |  import "./IDefaultUpgrade.sol";
```
GitHub: [5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/GenesisUpgrade.sol#L5), [6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/GenesisUpgrade.sol#L6), [7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/GenesisUpgrade.sol#L7)


```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol

     |  // @audit-issue Import specific identifiers rather than whole file
   5 |  import "./IL1SharedBridge.sol";
```
GitHub: [5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L5)


```solidity
File: code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol

     |  // @audit-issue Import specific identifiers rather than whole file
   6 |  import "../common/Messaging.sol";

     |  // @audit-issue Import specific identifiers rather than whole file
   7 |  import "../state-transition/IStateTransitionManager.sol";

     |  // @audit-issue Import specific identifiers rather than whole file
   8 |  import "../state-transition/libraries/Diamond.sol";
```
GitHub: [6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L6), [7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L7), [8](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L8)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol

     |  // @audit-issue Import specific identifiers rather than whole file
  13 |  import "../libraries/Diamond.sol";
```
GitHub: [13](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol#L13)


```solidity
File: code/contracts/ethereum/contracts/state-transition/Verifier.sol

     |  // @audit-issue Import specific identifiers rather than whole file
   5 |  import "./chain-interfaces/IVerifier.sol";
```
GitHub: [5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L5)


```solidity
File: code/contracts/ethereum/contracts/common/Dependencies.sol

     |  // @audit-issue Import specific identifiers rather than whole file
   5 |  import "@openzeppelin/contracts/proxy/transparent/TransparentUpgradeableProxy.sol";

     |  // @audit-issue Import specific identifiers rather than whole file
   6 |  import "@openzeppelin/contracts/proxy/transparent/ProxyAdmin.sol";
```
GitHub: [5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/Dependencies.sol#L5), [6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/Dependencies.sol#L6)


```solidity
File: code/system-contracts/contracts/AccountCodeStorage.sol

     |  // @audit-issue Import specific identifiers rather than whole file
   5 |  import "./interfaces/IAccountCodeStorage.sol";

     |  // @audit-issue Import specific identifiers rather than whole file
   6 |  import "./libraries/Utils.sol";
```
GitHub: [5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L5), [6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L6)


```solidity
File: code/system-contracts/contracts/DefaultAccount.sol

     |  // @audit-issue Import specific identifiers rather than whole file
   5 |  import "./interfaces/IAccount.sol";

     |  // @audit-issue Import specific identifiers rather than whole file
   6 |  import "./libraries/TransactionHelper.sol";

     |  // @audit-issue Import specific identifiers rather than whole file
   7 |  import "./libraries/SystemContractHelper.sol";

     |  // @audit-issue Import specific identifiers rather than whole file
   8 |  import "./libraries/EfficientCall.sol";
```
GitHub: [5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L5), [6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L6), [7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L7), [8](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L8)


```solidity
File: code/system-contracts/contracts/libraries/EfficientCall.sol

     |  // @audit-issue Import specific identifiers rather than whole file
   5 |  import "./SystemContractHelper.sol";

     |  // @audit-issue Import specific identifiers rather than whole file
   6 |  import "./Utils.sol";
```
GitHub: [5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L5), [6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L6)


```solidity
File: code/system-contracts/contracts/libraries/SystemContractsCaller.sol

     |  // @audit-issue Import specific identifiers rather than whole file
   6 |  import "./Utils.sol";
```
GitHub: [6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L6)


```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

     |  // @audit-issue Import specific identifiers rather than whole file
   5 |  import "../openzeppelin/token/ERC20/IERC20.sol";

     |  // @audit-issue Import specific identifiers rather than whole file
   6 |  import "../openzeppelin/token/ERC20/utils/SafeERC20.sol";

     |  // @audit-issue Import specific identifiers rather than whole file
   8 |  import "../interfaces/IPaymasterFlow.sol";

     |  // @audit-issue Import specific identifiers rather than whole file
   9 |  import "../interfaces/IContractDeployer.sol";

     |  // @audit-issue Import specific identifiers rather than whole file
  11 |  import "./RLPEncoder.sol";

     |  // @audit-issue Import specific identifiers rather than whole file
  12 |  import "./EfficientCall.sol";
```
GitHub: [5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L5), [6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L6), [8](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L8), [9](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L9), [11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L11), [12](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L12)


```solidity
File: code/system-contracts/contracts/libraries/Utils.sol

     |  // @audit-issue Import specific identifiers rather than whole file
   4 |  import "./EfficientCall.sol";
```
GitHub: [4](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L4)


```solidity
File: code/system-contracts/contracts/interfaces/IAccount.sol

     |  // @audit-issue Import specific identifiers rather than whole file
   5 |  import "../libraries/TransactionHelper.sol";
```
GitHub: [5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IAccount.sol#L5)


```solidity
File: code/system-contracts/contracts/interfaces/IBootloaderUtilities.sol

     |  // @audit-issue Import specific identifiers rather than whole file
   5 |  import "../libraries/TransactionHelper.sol";
```
GitHub: [5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBootloaderUtilities.sol#L5)


```solidity
File: code/system-contracts/contracts/interfaces/IPaymaster.sol

     |  // @audit-issue Import specific identifiers rather than whole file
   5 |  import "../libraries/TransactionHelper.sol";
```
GitHub: [5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IPaymaster.sol#L5)


```solidity
File: code/contracts/zksync/contracts/interfaces/IPaymaster.sol

     |  // @audit-issue Import specific identifiers rather than whole file
   5 |  import "../L2ContractHelper.sol";
```
GitHub: [5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/interfaces/IPaymaster.sol#L5)


```solidity
File: code/contracts/zksync/contracts/Dependencies.sol

     |  // @audit-issue Import specific identifiers rather than whole file
   5 |  import "@openzeppelin/contracts/proxy/transparent/TransparentUpgradeableProxy.sol";

     |  // @audit-issue Import specific identifiers rather than whole file
   6 |  import "@openzeppelin/contracts/proxy/transparent/ProxyAdmin.sol";
```
GitHub: [5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/Dependencies.sol#L5), [6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/Dependencies.sol#L6)


```solidity
File: code/contracts/zksync/contracts/TestnetPaymaster.sol

     |  // @audit-issue Import specific identifiers rather than whole file
   5 |  import "@openzeppelin/contracts/token/ERC20/IERC20.sol";

     |  // @audit-issue Import specific identifiers rather than whole file
   7 |  import "./interfaces/IPaymaster.sol";

     |  // @audit-issue Import specific identifiers rather than whole file
   8 |  import "./interfaces/IPaymasterFlow.sol";

     |  // @audit-issue Import specific identifiers rather than whole file
   9 |  import "./L2ContractHelper.sol";
```
GitHub: [5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/TestnetPaymaster.sol#L5), [7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/TestnetPaymaster.sol#L7), [8](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/TestnetPaymaster.sol#L8), [9](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/TestnetPaymaster.sol#L9)


## [N-43] Imports should be organized more systematically

The contract's interface should be imported first, followed by each of the interfaces it uses, followed by all other files. The examples below do not follow this layout.

*Instances: 4*

```solidity
File: code/system-contracts/contracts/Compressor.sol

     |  // @audit-issue Import contract interface > other interfaces > project files > external files
  10 |  import {L1_MESSENGER_CONTRACT, INITIAL_WRITE_STARTING_POSITION, COMPRESSED_INITIAL_WRITE_SIZE, STATE_DIFF_ENTRY_SIZE, STATE_DIFF_ENUM_INDEX_OFFSET, STATE_DIFF_FINAL_VALUE_OFFSET, STATE_DIFF_DERIVED_KEY_OFFSET, DERIVED_KEY_LENGTH, VALUE_LENGTH, ENUM_INDEX_LENGTH, KNOWN_CODE_STORAGE_CONTRACT} from "./Constants.sol";
```
GitHub: [10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L10)


```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

     |  // @audit-issue Import contract interface > other interfaces > project files > external files
   7 |  import {CREATE2_PREFIX, CREATE_PREFIX, NONCE_HOLDER_SYSTEM_CONTRACT, ACCOUNT_CODE_STORAGE_SYSTEM_CONTRACT, FORCE_DEPLOYER, MAX_SYSTEM_CONTRACT_ADDRESS, KNOWN_CODE_STORAGE_CONTRACT, BASE_TOKEN_SYSTEM_CONTRACT, IMMUTABLE_SIMULATOR_SYSTEM_CONTRACT, COMPLEX_UPGRADER_CONTRACT, KECCAK256_SYSTEM_CONTRACT} from "./Constants.sol";
```
GitHub: [7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L7)


```solidity
File: code/system-contracts/contracts/DefaultAccount.sol

     |  // @audit-issue Import contract interface > other interfaces > project files > external files
   9 |  import {BOOTLOADER_FORMAL_ADDRESS, NONCE_HOLDER_SYSTEM_CONTRACT, DEPLOYER_SYSTEM_CONTRACT, INonceHolder} from "./Constants.sol";
```
GitHub: [9](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L9)


```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

     |  // @audit-issue Import contract interface > other interfaces > project files > external files
  15 |  import {L2ContractHelper, DEPLOYER_SYSTEM_CONTRACT, L2_BASE_TOKEN_ADDRESS, IContractDeployer} from "../L2ContractHelper.sol";
```
GitHub: [15](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L15)


## [N-44] Inconsistent usage of `require()`/`revert()`/`revert <error>`

Some parts of the codebase use `require()` calls, and/or `revert()` calls and/or `revert <error>` statements. Pick one consistent approach per file.

*Instances: 6*

```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

     |  // @audit-issue Consistently use one of require(), revert(), or revert <error>
  62 |  require(msg.sender == stateTransitionManager.getChainAdmin(_chainId), "ValidatorTimelock: only chain admin");

     |  // @audit-issue Consistently use one of require(), revert(), or revert <error>
  68 |  require(validators[_chainId][msg.sender] == true, "ValidatorTimelock: only validator");

     |  // @audit-issue Consistently use one of require(), revert(), or revert <error>
 195 |  require(block.timestamp >= commitBatchTimestamp + delay, "5c"); // The delay is not passed

     |  // @audit-issue Consistently use one of require(), revert(), or revert <error>
 217 |  require(block.timestamp >= commitBatchTimestamp + delay, "5c"); // The delay is not passed

     |  // @audit-issue Consistently use one of require(), revert(), or revert <error>
  80 |  revert AddressAlreadyValidator(_chainId);

     |  // @audit-issue Consistently use one of require(), revert(), or revert <error>
  89 |  revert ValidatorDoesNotExist(_chainId);
```
GitHub: [62](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L62), [68](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L68), [195](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L195), [217](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L217), [80](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L80), [89](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L89)


## [N-45] Interfaces should use floating version pragmas

If the file contains non-interfaces as well, the interfaces should be moved to a separate file.

*Instances: 37*

```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol

   3 |  pragma solidity 0.8.20;
```
GitHub: [3](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L3)


```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol

   3 |  pragma solidity 0.8.20;
```
GitHub: [3](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L3)


```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL2Bridge.sol

   3 |  pragma solidity 0.8.20;
```
GitHub: [3](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL2Bridge.sol#L3)


```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IWETH9.sol

   2 |  pragma solidity 0.8.20;
```
GitHub: [2](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IWETH9.sol#L2)


```solidity
File: code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol

   3 |  pragma solidity 0.8.20;
```
GitHub: [3](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L3)


```solidity
File: code/contracts/ethereum/contracts/common/interfaces/IL2ContractDeployer.sol

   3 |  pragma solidity 0.8.20;
```
GitHub: [3](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/interfaces/IL2ContractDeployer.sol#L3)


```solidity
File: code/contracts/ethereum/contracts/governance/IGovernance.sol

   3 |  pragma solidity 0.8.20;
```
GitHub: [3](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L3)


```solidity
File: code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol

   3 |  pragma solidity 0.8.20;
```
GitHub: [3](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L3)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol

   3 |  pragma solidity 0.8.20;
```
GitHub: [3](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L3)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol

   3 |  pragma solidity 0.8.20;
```
GitHub: [3](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol#L3)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol

   3 |  pragma solidity 0.8.20;
```
GitHub: [3](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L3)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol

   3 |  pragma solidity 0.8.20;
```
GitHub: [3](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L3)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/ILegacyGetters.sol

   3 |  pragma solidity 0.8.20;
```
GitHub: [3](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/ILegacyGetters.sol#L3)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol

   3 |  pragma solidity 0.8.20;
```
GitHub: [3](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L3)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IVerifier.sol

   3 |  pragma solidity 0.8.20;
```
GitHub: [3](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IVerifier.sol#L3)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol

   3 |  pragma solidity 0.8.20;
```
GitHub: [3](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol#L3)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransitionBase.sol

   2 |  pragma solidity 0.8.20;
```
GitHub: [2](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransitionBase.sol#L2)


```solidity
File: code/contracts/ethereum/contracts/upgrades/IDefaultUpgrade.sol

   3 |  pragma solidity 0.8.20;
```
GitHub: [3](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/IDefaultUpgrade.sol#L3)


```solidity
File: code/system-contracts/contracts/interfaces/IAccount.sol

   3 |  pragma solidity 0.8.20;
```
GitHub: [3](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IAccount.sol#L3)


```solidity
File: code/system-contracts/contracts/interfaces/IAccountCodeStorage.sol

   3 |  pragma solidity 0.8.20;
```
GitHub: [3](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IAccountCodeStorage.sol#L3)


```solidity
File: code/system-contracts/contracts/interfaces/IBaseToken.sol

   3 |  pragma solidity 0.8.20;
```
GitHub: [3](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBaseToken.sol#L3)


```solidity
File: code/system-contracts/contracts/interfaces/IBootloaderUtilities.sol

   3 |  pragma solidity 0.8.20;
```
GitHub: [3](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBootloaderUtilities.sol#L3)


```solidity
File: code/system-contracts/contracts/interfaces/IComplexUpgrader.sol

   3 |  pragma solidity 0.8.20;
```
GitHub: [3](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IComplexUpgrader.sol#L3)


```solidity
File: code/system-contracts/contracts/interfaces/ICompressor.sol

   3 |  pragma solidity 0.8.20;
```
GitHub: [3](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ICompressor.sol#L3)


```solidity
File: code/system-contracts/contracts/interfaces/IContractDeployer.sol

   3 |  pragma solidity 0.8.20;
```
GitHub: [3](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L3)


```solidity
File: code/system-contracts/contracts/interfaces/IImmutableSimulator.sol

   3 |  pragma solidity 0.8.20;
```
GitHub: [3](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IImmutableSimulator.sol#L3)


```solidity
File: code/system-contracts/contracts/interfaces/IKnownCodesStorage.sol

   3 |  pragma solidity 0.8.20;
```
GitHub: [3](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IKnownCodesStorage.sol#L3)


```solidity
File: code/system-contracts/contracts/interfaces/IL1Messenger.sol

   3 |  pragma solidity 0.8.20;
```
GitHub: [3](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL1Messenger.sol#L3)


```solidity
File: code/system-contracts/contracts/interfaces/IL2StandardToken.sol

   3 |  pragma solidity 0.8.20;
```
GitHub: [3](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL2StandardToken.sol#L3)


```solidity
File: code/system-contracts/contracts/interfaces/IMailbox.sol

   3 |  pragma solidity 0.8.20;
```
GitHub: [3](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IMailbox.sol#L3)


```solidity
File: code/system-contracts/contracts/interfaces/INonceHolder.sol

   3 |  pragma solidity 0.8.20;
```
GitHub: [3](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/INonceHolder.sol#L3)


```solidity
File: code/system-contracts/contracts/interfaces/IPaymaster.sol

   3 |  pragma solidity 0.8.20;
```
GitHub: [3](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IPaymaster.sol#L3)


```solidity
File: code/system-contracts/contracts/interfaces/IPaymasterFlow.sol

   3 |  pragma solidity 0.8.20;
```
GitHub: [3](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IPaymasterFlow.sol#L3)


```solidity
File: code/system-contracts/contracts/interfaces/IPubdataChunkPublisher.sol

   2 |  pragma solidity 0.8.20;
```
GitHub: [2](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IPubdataChunkPublisher.sol#L2)


```solidity
File: code/system-contracts/contracts/interfaces/ISystemContext.sol

   3 |  pragma solidity 0.8.20;
```
GitHub: [3](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L3)


```solidity
File: code/system-contracts/contracts/interfaces/ISystemContextDeprecated.sol

   3 |  pragma solidity 0.8.20;
```
GitHub: [3](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContextDeprecated.sol#L3)


```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL1ERC20Bridge.sol

   3 |  pragma solidity 0.8.20;
```
GitHub: [3](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L3)


## [N-46] Large multiples of ten should use scientific notation for readability

Use a scientific notation rather than decimal literals (e.g. `1e6` instead of `1000000`, `5e3` instead of `5000`), for better code readability.

*Instances: 17*

```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

     |  // @audit-issue Use scientific notation (e.g. 1e18) instead
 188 |  gasLimit: 72000000,
```
GitHub: [188](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L188)


```solidity
File: code/contracts/ethereum/contracts/common/Config.sol

     |  // @audit-issue Use scientific notation (e.g. 1e18) instead
  52 |  uint256 constant MAX_GAS_PER_TRANSACTION = 80000000;

     |  // @audit-issue Use scientific notation (e.g. 1e18) instead
  94 |  uint256 constant TX_SLOT_OVERHEAD_L2_GAS = 10000;
```
GitHub: [52](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/Config.sol#L52), [94](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/Config.sol#L94)


```solidity
File: code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol

     |  // @audit-issue Use scientific notation (e.g. 1e18) instead
  22 |  uint160 constant offset = uint160(0x1111000000000000000000000000000000001111);
```
GitHub: [22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol#L22)


```solidity
File: code/contracts/ethereum/contracts/state-transition/Verifier.sol

     |  // @audit-issue Use scientific notation (e.g. 1e18) instead
 236 |  uint256 internal constant DOMAIN_SIZE = 0x1000000; // 2^24
```
GitHub: [236](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L236)


```solidity
File: code/contracts/ethereum/contracts/upgrades/Upgrade_v1_4_1.sol

     |  // @audit-issue Use scientific notation (e.g. 1e18) instead
  38 |  batchOverheadL1Gas: 1000000,

     |  // @audit-issue Use scientific notation (e.g. 1e18) instead
  39 |  maxPubdataPerBatch: 120000,

     |  // @audit-issue Use scientific notation (e.g. 1e18) instead
  40 |  maxL2GasPerBatch: 80000000,

     |  // @audit-issue Use scientific notation (e.g. 1e18) instead
  41 |  priorityTxMaxPubdata: 99000,

     |  // @audit-issue Use scientific notation (e.g. 1e18) instead
  42 |  minimalL2GasPrice: 250000000
```
GitHub: [38](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/Upgrade_v1_4_1.sol#L38), [39](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/Upgrade_v1_4_1.sol#L39), [40](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/Upgrade_v1_4_1.sol#L40), [41](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/Upgrade_v1_4_1.sol#L41), [42](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/Upgrade_v1_4_1.sol#L42)


```solidity
File: code/system-contracts/contracts/Constants.sol

     |  // @audit-issue Use scientific notation (e.g. 1e18) instead
  20 |  uint160 constant SYSTEM_CONTRACTS_OFFSET = 0x8000;

     |  // @audit-issue Use scientific notation (e.g. 1e18) instead
  25 |  uint160 constant REAL_SYSTEM_CONTRACTS_OFFSET = 0x8000;

     |  // @audit-issue Use scientific notation (e.g. 1e18) instead
 108 |  uint256 constant MAX_ALLOWED_PUBDATA_PER_BATCH = 520000;
```
GitHub: [20](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Constants.sol#L20), [25](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Constants.sol#L25), [108](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Constants.sol#L108)


```solidity
File: code/system-contracts/contracts/MsgValueSimulator.sol

     |  // @audit-issue Use scientific notation (e.g. 1e18) instead
  41 |  uint256 constant MSG_VALUE_SIMULATOR_STIPEND_GAS = 27000;
```
GitHub: [41](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/MsgValueSimulator.sol#L41)


```solidity
File: code/system-contracts/contracts/libraries/Utils.sol

     |  // @audit-issue Use scientific notation (e.g. 1e18) instead
  18 |  0x0001000000000000000000000000000000000000000000000000000000000000;
```
GitHub: [18](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L18)


```solidity
File: code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol

     |  // @audit-issue Use scientific notation (e.g. 1e18) instead
  22 |  uint160 constant offset = uint160(0x1111000000000000000000000000000000001111);
```
GitHub: [22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol#L22)


```solidity
File: code/contracts/zksync/contracts/L2ContractHelper.sol

     |  // @audit-issue Use scientific notation (e.g. 1e18) instead
  68 |  uint160 constant SYSTEM_CONTRACTS_OFFSET = 0x8000; // 2^15
```
GitHub: [68](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/L2ContractHelper.sol#L68)


## [N-47] Large numeric literals should use underscores for readability

Solidity allows you to write large numbers using an underscore as a separator e.g. you can write `123_456` instead of `123456` to improve readability.

*Instances: 99*

```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

     |  // @audit-issue Add underscores to `72000000` to improve readability e.g. `123_456`
 188 |  gasLimit: 72000000,
```
GitHub: [188](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L188)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

     |  // @audit-issue Add underscores to `1023` to improve readability e.g. `123_456`
 194 |  require(processedLogs == 1023, "b8");
```
GitHub: [194](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L194)


```solidity
File: code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol

     |  // @audit-issue Add underscores to `00000000` to improve readability e.g. `123_456`
  28 |  hashedBytecode = sha256(_bytecode) & 0x00000000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF;
```
GitHub: [28](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L28)


```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol

     |  // @audit-issue Add underscores to `33774` to improve readability e.g. `123_456`
     |  // @audit-issue Add underscores to `659306` to improve readability e.g. `123_456`
     |  // @audit-issue Add underscores to `47509050` to improve readability e.g. `123_456`
     |  // @audit-issue Add underscores to `731180` to improve readability e.g. `123_456`
     |  // @audit-issue Add underscores to `458212294` to improve readability e.g. `123_456`
     |  // @audit-issue Add underscores to `30751925` to improve readability e.g. `123_456`
  18 |  0x33774e659306e47509050e97cb651e731180a42d458212294d30751925c551a2; // keccak256("diamond.zksync.init") - 1
  :  |
     |  // @audit-issue Add underscores to `09332` to improve readability e.g. `123_456`
  22 |  0xc8fcad8db84d3cc18b4c41d551ea0ee66dd599cde068d998e57d5e09332c131b; // keccak256("diamond.standard.diamond.storage") - 1;
```
GitHub: [18](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L18), [18](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L18), [18](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L18), [18](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L18), [18](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L18), [18](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L18), [22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L22)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol

     |  // @audit-issue Add underscores to `52435875175126190479447740508185965837690552500527637822603658699938581184513` to improve readability e.g. `123_456`
  50 |  uint256 constant BLS_MODULUS = 52435875175126190479447740508185965837690552500527637822603658699938581184513;
```
GitHub: [50](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L50)


```solidity
File: code/contracts/ethereum/contracts/common/Config.sol

     |  // @audit-issue Add underscores to `2460186` to improve readability e.g. `123_456`
     |  // @audit-issue Add underscores to `7233` to improve readability e.g. `123_456`
     |  // @audit-issue Add underscores to `82273` to improve readability e.g. `123_456`
     |  // @audit-issue Add underscores to `8045` to improve readability e.g. `123_456`
   8 |  bytes32 constant EMPTY_STRING_KECCAK = 0xc5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470;
  :  |
     |  // @audit-issue Add underscores to `520241` to improve readability e.g. `123_456`
     |  // @audit-issue Add underscores to `4744` to improve readability e.g. `123_456`
  21 |  bytes32 constant L2_L1_LOGS_TREE_DEFAULT_LEAF_HASH = 0x72abee45b59e344af8a6e520241c4744aff26ed411f4c4b00f8af09adada43ba;
  :  |
     |  // @audit-issue Add underscores to `80000000` to improve readability e.g. `123_456`
  52 |  uint256 constant MAX_GAS_PER_TRANSACTION = 80000000;
  :  |
     |  // @audit-issue Add underscores to `167157` to improve readability e.g. `123_456`
  59 |  uint256 constant L1_TX_INTRINSIC_L2_GAS = 167157;
  :  |
     |  // @audit-issue Add underscores to `173484` to improve readability e.g. `123_456`
  65 |  uint256 constant L1_TX_MIN_L2_GAS_BASE = 173484;
  :  |
     |  // @audit-issue Add underscores to `1656` to improve readability e.g. `123_456`
  68 |  uint256 constant L1_TX_DELTA_544_ENCODING_BYTES = 1656;
  :  |
     |  // @audit-issue Add underscores to `2473` to improve readability e.g. `123_456`
  71 |  uint256 constant L1_TX_DELTA_FACTORY_DEPS_L2_GAS = 2473;
  :  |
     |  // @audit-issue Add underscores to `10000` to improve readability e.g. `123_456`
  94 |  uint256 constant TX_SLOT_OVERHEAD_L2_GAS = 10000;
  :  |
     |  // @audit-issue Add underscores to `1233` to improve readability e.g. `123_456`
 109 |  address constant ERA_ERC20_BRIDGE_ADDRESS = address(1233);
```
GitHub: [8](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/Config.sol#L8), [8](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/Config.sol#L8), [8](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/Config.sol#L8), [8](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/Config.sol#L8), [21](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/Config.sol#L21), [21](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/Config.sol#L21), [52](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/Config.sol#L52), [59](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/Config.sol#L59), [65](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/Config.sol#L65), [68](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/Config.sol#L68), [71](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/Config.sol#L71), [94](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/Config.sol#L94), [109](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/Config.sol#L109)


```solidity
File: code/contracts/ethereum/contracts/common/L2ContractAddresses.sol

     |  // @audit-issue Add underscores to `8001` to improve readability e.g. `123_456`
   6 |  address constant L2_BOOTLOADER_ADDRESS = address(0x8001);
  :  |
     |  // @audit-issue Add underscores to `8004` to improve readability e.g. `123_456`
   9 |  address constant L2_KNOWN_CODE_STORAGE_SYSTEM_CONTRACT_ADDR = address(0x8004);
  :  |
     |  // @audit-issue Add underscores to `8006` to improve readability e.g. `123_456`
  12 |  address constant L2_DEPLOYER_SYSTEM_CONTRACT_ADDR = address(0x8006);
  :  |
     |  // @audit-issue Add underscores to `8007` to improve readability e.g. `123_456`
  21 |  address constant L2_FORCE_DEPLOYER_ADDR = address(0x8007);
  :  |
     |  // @audit-issue Add underscores to `8008` to improve readability e.g. `123_456`
  24 |  address constant L2_TO_L1_MESSENGER_SYSTEM_CONTRACT_ADDR = address(0x8008);
  :  |
     |  // @audit-issue Add underscores to `8011` to improve readability e.g. `123_456`
  33 |  address constant L2_PUBDATA_CHUNK_PUBLISHER_ADDR = address(0x8011);
```
GitHub: [6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/L2ContractAddresses.sol#L6), [9](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/L2ContractAddresses.sol#L9), [12](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/L2ContractAddresses.sol#L12), [21](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/L2ContractAddresses.sol#L21), [24](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/L2ContractAddresses.sol#L24), [33](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/L2ContractAddresses.sol#L33)


```solidity
File: code/contracts/ethereum/contracts/common/ReentrancyGuard.sol

     |  // @audit-issue Add underscores to `44239` to improve readability e.g. `123_456`
     |  // @audit-issue Add underscores to `2314` to improve readability e.g. `123_456`
     |  // @audit-issue Add underscores to `406345` to improve readability e.g. `123_456`
  29 |  uint256 private constant LOCK_FLAG_ADDRESS = 0x8e94fed44239eb2314ab7a406345e6c5a8f0ccedf3b600de3d004e672c33abf4;
```
GitHub: [29](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/ReentrancyGuard.sol#L29), [29](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/ReentrancyGuard.sol#L29), [29](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/ReentrancyGuard.sol#L29)


```solidity
File: code/contracts/ethereum/contracts/state-transition/Verifier.sol

     |  // @audit-issue Add underscores to `1951441010` to improve readability e.g. `123_456`
     |  // @audit-issue Add underscores to `6075066` to improve readability e.g. `123_456`
     |  // @audit-issue Add underscores to `2821` to improve readability e.g. `123_456`
     |  // @audit-issue Add underscores to `86636` to improve readability e.g. `123_456`
 235 |  uint256 internal constant OMEGA = 0x1951441010b2b95a6e47a6075066a50a036f5ba978c050f2821df86636c0facb;
     |  // @audit-issue Add underscores to `1000000` to improve readability e.g. `123_456`
 236 |  uint256 internal constant DOMAIN_SIZE = 0x1000000; // 2^24
     |  // @audit-issue Add underscores to `21888242871839275222246405745257275088696311157297823662689037894645226208583` to improve readability e.g. `123_456`
 237 |  uint256 internal constant Q_MOD = 21888242871839275222246405745257275088696311157297823662689037894645226208583;
     |  // @audit-issue Add underscores to `21888242871839275222246405745257275088548364400416034343698204186575808495617` to improve readability e.g. `123_456`
 238 |  uint256 internal constant R_MOD = 21888242871839275222246405745257275088548364400416034343698204186575808495617;
  :  |
     |  // @audit-issue Add underscores to `9393920` to improve readability e.g. `123_456`
     |  // @audit-issue Add underscores to `7260` to improve readability e.g. `123_456`
     |  // @audit-issue Add underscores to `493335` to improve readability e.g. `123_456`
     |  // @audit-issue Add underscores to `71297` to improve readability e.g. `123_456`
 249 |  uint256 internal constant G2_ELEMENTS_0_X1 = 0x198e9393920d483a7260bfb731fb5d25f1aa493335a9e71297e485b7aef312c2;
     |  // @audit-issue Add underscores to `1800` to improve readability e.g. `123_456`
     |  // @audit-issue Add underscores to `76426` to improve readability e.g. `123_456`
     |  // @audit-issue Add underscores to `00665` to improve readability e.g. `123_456`
     |  // @audit-issue Add underscores to `4479674322` to improve readability e.g. `123_456`
 250 |  uint256 internal constant G2_ELEMENTS_0_X2 = 0x1800deef121f1e76426a00665e5c4479674322d4f75edadd46debd5cd992f6ed;
     |  // @audit-issue Add underscores to `090689` to improve readability e.g. `123_456`
     |  // @audit-issue Add underscores to `0585` to improve readability e.g. `123_456`
     |  // @audit-issue Add underscores to `3395` to improve readability e.g. `123_456`
     |  // @audit-issue Add underscores to `313370` to improve readability e.g. `123_456`
     |  // @audit-issue Add underscores to `122975` to improve readability e.g. `123_456`
 251 |  uint256 internal constant G2_ELEMENTS_0_Y1 = 0x090689d0585ff075ec9e99ad690c3395bc4b313370b38ef355acdadcd122975b;
     |  // @audit-issue Add underscores to `71808` to improve readability e.g. `123_456`
     |  // @audit-issue Add underscores to `7690` to improve readability e.g. `123_456`
     |  // @audit-issue Add underscores to `0166` to improve readability e.g. `123_456`
 252 |  uint256 internal constant G2_ELEMENTS_0_Y2 = 0x12c85ea5db8c6deb4aab71808dcb408fe3d1e7690c43d37b4ce6cc0166fa7daa;
     |  // @audit-issue Add underscores to `580791` to improve readability e.g. `123_456`
     |  // @audit-issue Add underscores to `09383` to improve readability e.g. `123_456`
 253 |  uint256 internal constant G2_ELEMENTS_1_X1 = 0x260e01b251f6f1c7e7ff4e580791dee8ea51d87a358e038b4efe30fac09383c1;
     |  // @audit-issue Add underscores to `0118` to improve readability e.g. `123_456`
     |  // @audit-issue Add underscores to `5974` to improve readability e.g. `123_456`
     |  // @audit-issue Add underscores to `5944073` to improve readability e.g. `123_456`
     |  // @audit-issue Add underscores to `32078` to improve readability e.g. `123_456`
     |  // @audit-issue Add underscores to `938883` to improve readability e.g. `123_456`
 254 |  uint256 internal constant G2_ELEMENTS_1_X2 = 0x0118c4d5b837bcc2bc89b5b398b5974e9f5944073b32078b7e231fec938883b0;
     |  // @audit-issue Add underscores to `6369` to improve readability e.g. `123_456`
     |  // @audit-issue Add underscores to `7110` to improve readability e.g. `123_456`
     |  // @audit-issue Add underscores to `25156` to improve readability e.g. `123_456`
     |  // @audit-issue Add underscores to `72859` to improve readability e.g. `123_456`
     |  // @audit-issue Add underscores to `04641` to improve readability e.g. `123_456`
 255 |  uint256 internal constant G2_ELEMENTS_1_Y1 = 0x04fc6369f7110fe3d25156c1bb9a72859cf2a04641f99ba4ee413c80da6a5fe4;
     |  // @audit-issue Add underscores to `0632` to improve readability e.g. `123_456`
     |  // @audit-issue Add underscores to `56475` to improve readability e.g. `123_456`
     |  // @audit-issue Add underscores to `4214` to improve readability e.g. `123_456`
     |  // @audit-issue Add underscores to `5615` to improve readability e.g. `123_456`
     |  // @audit-issue Add underscores to `2854` to improve readability e.g. `123_456`
 256 |  uint256 internal constant G2_ELEMENTS_1_Y2 = 0x22febda3c0c0632a56475b4214e5615e11e6dd3f96e6cea2854a87d4dacc5e55;
```
GitHub: [235](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L235), [235](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L235), [235](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L235), [235](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L235), [236](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L236), [237](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L237), [238](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L238), [249](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L249), [249](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L249), [249](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L249), [249](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L249), [250](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L250), [250](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L250), [250](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L250), [250](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L250), [251](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L251), [251](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L251), [251](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L251), [251](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L251), [251](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L251), [252](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L252), [252](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L252), [252](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L252), [253](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L253), [253](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L253), [254](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L254), [254](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L254), [254](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L254), [254](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L254), [254](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L254), [255](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L255), [255](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L255), [255](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L255), [255](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L255), [255](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L255), [256](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L256), [256](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L256), [256](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L256), [256](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L256), [256](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L256)


```solidity
File: code/contracts/ethereum/contracts/upgrades/Upgrade_v1_4_1.sol

     |  // @audit-issue Add underscores to `1000000` to improve readability e.g. `123_456`
  38 |  batchOverheadL1Gas: 1000000,
     |  // @audit-issue Add underscores to `120000` to improve readability e.g. `123_456`
  39 |  maxPubdataPerBatch: 120000,
     |  // @audit-issue Add underscores to `80000000` to improve readability e.g. `123_456`
  40 |  maxL2GasPerBatch: 80000000,
     |  // @audit-issue Add underscores to `99000` to improve readability e.g. `123_456`
  41 |  priorityTxMaxPubdata: 99000,
     |  // @audit-issue Add underscores to `250000000` to improve readability e.g. `123_456`
  42 |  minimalL2GasPrice: 250000000
```
GitHub: [38](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/Upgrade_v1_4_1.sol#L38), [39](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/Upgrade_v1_4_1.sol#L39), [40](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/Upgrade_v1_4_1.sol#L40), [41](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/Upgrade_v1_4_1.sol#L41), [42](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/Upgrade_v1_4_1.sol#L42)


```solidity
File: code/system-contracts/contracts/AccountCodeStorage.sol

     |  // @audit-issue Add underscores to `2460186` to improve readability e.g. `123_456`
     |  // @audit-issue Add underscores to `7233` to improve readability e.g. `123_456`
     |  // @audit-issue Add underscores to `82273` to improve readability e.g. `123_456`
     |  // @audit-issue Add underscores to `8045` to improve readability e.g. `123_456`
  23 |  bytes32 constant EMPTY_STRING_KECCAK = 0xc5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470;
```
GitHub: [23](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L23), [23](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L23), [23](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L23), [23](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L23)


```solidity
File: code/system-contracts/contracts/Constants.sol

     |  // @audit-issue Add underscores to `8000` to improve readability e.g. `123_456`
  20 |  uint160 constant SYSTEM_CONTRACTS_OFFSET = 0x8000;
  :  |
     |  // @audit-issue Add underscores to `8000` to improve readability e.g. `123_456`
  25 |  uint160 constant REAL_SYSTEM_CONTRACTS_OFFSET = 0x8000;
  :  |
     |  // @audit-issue Add underscores to `8010` to improve readability e.g. `123_456`
  71 |  address constant KECCAK256_SYSTEM_CONTRACT = address(0x8010);
  :  |
     |  // @audit-issue Add underscores to `2020` to improve readability e.g. `123_456`
     |  // @audit-issue Add underscores to `0006188` to improve readability e.g. `123_456`
     |  // @audit-issue Add underscores to `8520` to improve readability e.g. `123_456`
  98 |  bytes32 constant CREATE2_PREFIX = 0x2020dba91b30cc0006188af794c2fb30dd8520db7e2c088b7fc7c103c00ca494;
  :  |
     |  // @audit-issue Add underscores to `9951` to improve readability e.g. `123_456`
     |  // @audit-issue Add underscores to `70909` to improve readability e.g. `123_456`
     |  // @audit-issue Add underscores to `1200610` to improve readability e.g. `123_456`
     |  // @audit-issue Add underscores to `815974674` to improve readability e.g. `123_456`
 101 |  bytes32 constant CREATE_PREFIX = 0x63bae3a9951d38e8a3fbb7b70909afc1200610fc5bc55ade242f815974674f23;
  :  |
     |  // @audit-issue Add underscores to `520000` to improve readability e.g. `123_456`
 108 |  uint256 constant MAX_ALLOWED_PUBDATA_PER_BATCH = 520000;
  :  |
     |  // @audit-issue Add underscores to `4096` to improve readability e.g. `123_456`
 125 |  uint256 constant L2_TO_L1_LOGS_MERKLE_TREE_LEAVES = 4096;
```
GitHub: [20](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Constants.sol#L20), [25](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Constants.sol#L25), [71](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Constants.sol#L71), [98](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Constants.sol#L98), [98](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Constants.sol#L98), [98](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Constants.sol#L98), [101](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Constants.sol#L101), [101](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Constants.sol#L101), [101](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Constants.sol#L101), [101](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Constants.sol#L101), [108](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Constants.sol#L108), [125](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Constants.sol#L125)


```solidity
File: code/system-contracts/contracts/DefaultAccount.sol

     |  // @audit-issue Add underscores to `7357` to improve readability e.g. `123_456`
     |  // @audit-issue Add underscores to `4501` to improve readability e.g. `123_456`
     |  // @audit-issue Add underscores to `46681` to improve readability e.g. `123_456`
 184 |  require(uint256(s) <= 0x7FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF5D576E7357A4501DDFE92F46681B20A0, "Invalid s");
```
GitHub: [184](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L184), [184](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L184), [184](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L184)


```solidity
File: code/system-contracts/contracts/MsgValueSimulator.sol

     |  // @audit-issue Add underscores to `2300` to improve readability e.g. `123_456`
  36 |  uint256 constant GAS_TO_PASS = 2300;
  :  |
     |  // @audit-issue Add underscores to `27000` to improve readability e.g. `123_456`
  41 |  uint256 constant MSG_VALUE_SIMULATOR_STIPEND_GAS = 27000;
```
GitHub: [36](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/MsgValueSimulator.sol#L36), [41](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/MsgValueSimulator.sol#L41)


## [N-48] Large or complicated code bases should implement invariant tests

This includes: large code bases, or code with lots of inline-assembly, complicated math, or complicated interactions between multiple contracts.

Invariant fuzzers such as Echidna require the test writer to come up with invariants which should not be violated under any circumstances, and the fuzzer tests various inputs and function calls to ensure that the invariants always hold.

Even code with 100% code coverage can still have bugs due to the order of the operations a user performs, and invariant fuzzers may help significantly.

*Instances: 99*

```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

     |  // @audit-issue Invariant tests were not detected for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

     |  // @audit-issue Invariant tests were not detected for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

     |  // @audit-issue Invariant tests were not detected for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

     |  // @audit-issue Invariant tests were not detected for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

     |  // @audit-issue Invariant tests were not detected for this file
   1 |  pragma solidity 0.8.20;
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

     |  // @audit-issue Invariant tests were not detected for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol

     |  // @audit-issue Invariant tests were not detected for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol

     |  // @audit-issue Invariant tests were not detected for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol

     |  // @audit-issue Invariant tests were not detected for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol

     |  // @audit-issue Invariant tests were not detected for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

     |  // @audit-issue Invariant tests were not detected for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol

     |  // @audit-issue Invariant tests were not detected for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

     |  // @audit-issue Invariant tests were not detected for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol

     |  // @audit-issue Invariant tests were not detected for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol

     |  // @audit-issue Invariant tests were not detected for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol

     |  // @audit-issue Invariant tests were not detected for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/upgrades/DefaultUpgrade.sol

     |  // @audit-issue Invariant tests were not detected for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/DefaultUpgrade.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/upgrades/GenesisUpgrade.sol

     |  // @audit-issue Invariant tests were not detected for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/GenesisUpgrade.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol

     |  // @audit-issue Invariant tests were not detected for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/common/libraries/UncheckedMath.sol

     |  // @audit-issue Invariant tests were not detected for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/UncheckedMath.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol

     |  // @audit-issue Invariant tests were not detected for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol

     |  // @audit-issue Invariant tests were not detected for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/LibMap.sol

     |  // @audit-issue Invariant tests were not detected for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/LibMap.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol

     |  // @audit-issue Invariant tests were not detected for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol

     |  // @audit-issue Invariant tests were not detected for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol

     |  // @audit-issue Invariant tests were not detected for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol

     |  // @audit-issue Invariant tests were not detected for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol

     |  // @audit-issue Invariant tests were not detected for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL2Bridge.sol

     |  // @audit-issue Invariant tests were not detected for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL2Bridge.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IWETH9.sol

     |  // @audit-issue Invariant tests were not detected for this file
   1 |  // SPDX-License-Identifier: Apache-2.0
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IWETH9.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol

     |  // @audit-issue Invariant tests were not detected for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/common/interfaces/IL2ContractDeployer.sol

     |  // @audit-issue Invariant tests were not detected for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/interfaces/IL2ContractDeployer.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/governance/IGovernance.sol

     |  // @audit-issue Invariant tests were not detected for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol

     |  // @audit-issue Invariant tests were not detected for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol

     |  // @audit-issue Invariant tests were not detected for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol

     |  // @audit-issue Invariant tests were not detected for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol

     |  // @audit-issue Invariant tests were not detected for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol

     |  // @audit-issue Invariant tests were not detected for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/ILegacyGetters.sol

     |  // @audit-issue Invariant tests were not detected for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/ILegacyGetters.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol

     |  // @audit-issue Invariant tests were not detected for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IVerifier.sol

     |  // @audit-issue Invariant tests were not detected for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IVerifier.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol

     |  // @audit-issue Invariant tests were not detected for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransitionBase.sol

     |  // @audit-issue Invariant tests were not detected for this file
   1 |  // SPDX-License-Identifier: UNLICENSED
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransitionBase.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/upgrades/IDefaultUpgrade.sol

     |  // @audit-issue Invariant tests were not detected for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/IDefaultUpgrade.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/common/Config.sol

     |  // @audit-issue Invariant tests were not detected for this file
   1 |  pragma solidity 0.8.20;
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/Config.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/common/L2ContractAddresses.sol

     |  // @audit-issue Invariant tests were not detected for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/L2ContractAddresses.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/common/Messaging.sol

     |  // @audit-issue Invariant tests were not detected for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/Messaging.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/common/ReentrancyGuard.sol

     |  // @audit-issue Invariant tests were not detected for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/ReentrancyGuard.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol

     |  // @audit-issue Invariant tests were not detected for this file
   1 |  // SPDX-License-Identifier: Apache-2.0
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/Verifier.sol

     |  // @audit-issue Invariant tests were not detected for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/upgrades/Upgrade_4844.sol

     |  // @audit-issue Invariant tests were not detected for this file
   1 |  pragma solidity 0.8.20;
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/Upgrade_4844.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/upgrades/Upgrade_v1_4_1.sol

     |  // @audit-issue Invariant tests were not detected for this file
   1 |  pragma solidity 0.8.20;
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/Upgrade_v1_4_1.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/common/Dependencies.sol

     |  // @audit-issue Invariant tests were not detected for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/Dependencies.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/l2-deps/ISystemContext.sol

     |  // @audit-issue Invariant tests were not detected for this file
   1 |  // SPDX-License-Identifier: UNLICENSED
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/l2-deps/ISystemContext.sol#L1)


```solidity
File: code/system-contracts/contracts/AccountCodeStorage.sol

     |  // @audit-issue Invariant tests were not detected for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L1)


```solidity
File: code/system-contracts/contracts/BootloaderUtilities.sol

     |  // @audit-issue Invariant tests were not detected for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L1)


```solidity
File: code/system-contracts/contracts/ComplexUpgrader.sol

     |  // @audit-issue Invariant tests were not detected for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ComplexUpgrader.sol#L1)


```solidity
File: code/system-contracts/contracts/Compressor.sol

     |  // @audit-issue Invariant tests were not detected for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L1)


```solidity
File: code/system-contracts/contracts/Constants.sol

     |  // @audit-issue Invariant tests were not detected for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Constants.sol#L1)


```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

     |  // @audit-issue Invariant tests were not detected for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L1)


```solidity
File: code/system-contracts/contracts/DefaultAccount.sol

     |  // @audit-issue Invariant tests were not detected for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L1)


```solidity
File: code/system-contracts/contracts/EmptyContract.sol

     |  // @audit-issue Invariant tests were not detected for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/EmptyContract.sol#L1)


```solidity
File: code/system-contracts/contracts/ImmutableSimulator.sol

     |  // @audit-issue Invariant tests were not detected for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ImmutableSimulator.sol#L1)


```solidity
File: code/system-contracts/contracts/KnownCodesStorage.sol

     |  // @audit-issue Invariant tests were not detected for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/KnownCodesStorage.sol#L1)


```solidity
File: code/system-contracts/contracts/L1Messenger.sol

     |  // @audit-issue Invariant tests were not detected for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L1)


```solidity
File: code/system-contracts/contracts/L2BaseToken.sol

     |  // @audit-issue Invariant tests were not detected for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L2BaseToken.sol#L1)


```solidity
File: code/system-contracts/contracts/MsgValueSimulator.sol

     |  // @audit-issue Invariant tests were not detected for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/MsgValueSimulator.sol#L1)


```solidity
File: code/system-contracts/contracts/NonceHolder.sol

     |  // @audit-issue Invariant tests were not detected for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/NonceHolder.sol#L1)


```solidity
File: code/system-contracts/contracts/PubdataChunkPublisher.sol

     |  // @audit-issue Invariant tests were not detected for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/PubdataChunkPublisher.sol#L1)


```solidity
File: code/system-contracts/contracts/SystemContext.sol

     |  // @audit-issue Invariant tests were not detected for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L1)


```solidity
File: code/system-contracts/contracts/GasBoundCaller.sol

     |  // @audit-issue Invariant tests were not detected for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/GasBoundCaller.sol#L1)


```solidity
File: code/system-contracts/contracts/libraries/EfficientCall.sol

     |  // @audit-issue Invariant tests were not detected for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L1)


```solidity
File: code/system-contracts/contracts/libraries/RLPEncoder.sol

     |  // @audit-issue Invariant tests were not detected for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/RLPEncoder.sol#L1)


```solidity
File: code/system-contracts/contracts/libraries/SystemContractHelper.sol

     |  // @audit-issue Invariant tests were not detected for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L1)


```solidity
File: code/system-contracts/contracts/libraries/SystemContractsCaller.sol

     |  // @audit-issue Invariant tests were not detected for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L1)


```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

     |  // @audit-issue Invariant tests were not detected for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L1)


```solidity
File: code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol

     |  // @audit-issue Invariant tests were not detected for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol#L1)


```solidity
File: code/system-contracts/contracts/libraries/Utils.sol

     |  // @audit-issue Invariant tests were not detected for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L1)


```solidity
File: code/system-contracts/contracts/interfaces/IAccount.sol

     |  // @audit-issue Invariant tests were not detected for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IAccount.sol#L1)


```solidity
File: code/system-contracts/contracts/interfaces/IAccountCodeStorage.sol

     |  // @audit-issue Invariant tests were not detected for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IAccountCodeStorage.sol#L1)


```solidity
File: code/system-contracts/contracts/interfaces/IBaseToken.sol

     |  // @audit-issue Invariant tests were not detected for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBaseToken.sol#L1)


```solidity
File: code/system-contracts/contracts/interfaces/IBootloaderUtilities.sol

     |  // @audit-issue Invariant tests were not detected for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBootloaderUtilities.sol#L1)


```solidity
File: code/system-contracts/contracts/interfaces/IComplexUpgrader.sol

     |  // @audit-issue Invariant tests were not detected for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IComplexUpgrader.sol#L1)


```solidity
File: code/system-contracts/contracts/interfaces/ICompressor.sol

     |  // @audit-issue Invariant tests were not detected for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ICompressor.sol#L1)


```solidity
File: code/system-contracts/contracts/interfaces/IContractDeployer.sol

     |  // @audit-issue Invariant tests were not detected for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L1)


```solidity
File: code/system-contracts/contracts/interfaces/IImmutableSimulator.sol

     |  // @audit-issue Invariant tests were not detected for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IImmutableSimulator.sol#L1)


```solidity
File: code/system-contracts/contracts/interfaces/IKnownCodesStorage.sol

     |  // @audit-issue Invariant tests were not detected for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IKnownCodesStorage.sol#L1)


```solidity
File: code/system-contracts/contracts/interfaces/IL1Messenger.sol

     |  // @audit-issue Invariant tests were not detected for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL1Messenger.sol#L1)


```solidity
File: code/system-contracts/contracts/interfaces/IL2StandardToken.sol

     |  // @audit-issue Invariant tests were not detected for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL2StandardToken.sol#L1)


```solidity
File: code/system-contracts/contracts/interfaces/IMailbox.sol

     |  // @audit-issue Invariant tests were not detected for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IMailbox.sol#L1)


```solidity
File: code/system-contracts/contracts/interfaces/INonceHolder.sol

     |  // @audit-issue Invariant tests were not detected for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/INonceHolder.sol#L1)


```solidity
File: code/system-contracts/contracts/interfaces/IPaymaster.sol

     |  // @audit-issue Invariant tests were not detected for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IPaymaster.sol#L1)


```solidity
File: code/system-contracts/contracts/interfaces/IPaymasterFlow.sol

     |  // @audit-issue Invariant tests were not detected for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IPaymasterFlow.sol#L1)


```solidity
File: code/system-contracts/contracts/interfaces/IPubdataChunkPublisher.sol

     |  // @audit-issue Invariant tests were not detected for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IPubdataChunkPublisher.sol#L1)


```solidity
File: code/system-contracts/contracts/interfaces/ISystemContext.sol

     |  // @audit-issue Invariant tests were not detected for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L1)


```solidity
File: code/system-contracts/contracts/interfaces/ISystemContextDeprecated.sol

     |  // @audit-issue Invariant tests were not detected for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContextDeprecated.sol#L1)


```solidity
File: code/system-contracts/contracts/interfaces/ISystemContract.sol

     |  // @audit-issue Invariant tests were not detected for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContract.sol#L1)


```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

     |  // @audit-issue Invariant tests were not detected for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L1)


```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

     |  // @audit-issue Invariant tests were not detected for this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L1)


## [N-49] Missing checks for empty bytes when updating bytes state variables

An accidental empty bytes assignment could be catastrophic, e.g. setting a merkle root proof to zero.

*Instances: 3*

```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

     |  // @audit-issue `_txDataHash` is assigned to a state variable unvalidated
 232 |  function bridgehubConfirmL2Transaction(
 233 |      uint256 _chainId,
 234 |      bytes32 _txDataHash,
 235 |      bytes32 _txHash
 236 |  ) external override onlyBridgehub {
```
GitHub: [232-236](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L232-L236)


```solidity
File: code/system-contracts/contracts/SystemContext.sol

     |  // @audit-issue `_hash` is assigned to a state variable unvalidated
 212 |  function _setL2BlockHash(uint256 _block, bytes32 _hash) internal {

     |  // @audit-issue `_prevBatchHash` is assigned to a state variable unvalidated
 444 |  function setNewBatch(
 445 |      bytes32 _prevBatchHash,
 446 |      uint128 _newTimestamp,
 447 |      uint128 _expectedNewNumber,
 448 |      uint256 _baseFee
 449 |  ) external onlyCallFromBootloader {
```
GitHub: [212](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L212), [444-449](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L444-L449)


## [N-50] Missing events in initializers

As a best practice, consider emitting an event when the contract is initialized. In this way, it's easy for the user to track the exact point in time when the contract was initialized, by filtering the emitted events.

*Instances: 8*

```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

     |  // @audit-issue Consider emitting an event documenting the initialization
  60 |  function initialize() external reentrancyGuardInitializer {}
```
GitHub: [60](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L60)


```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

     |  // @audit-issue Consider emitting an event documenting the initialization
 104 |      function initialize(
 105 |          address _owner,
 106 |          uint256 _eraFirstPostUpgradeBatch
 107 |      ) external reentrancyGuardInitializer initializer {
 108 |          require(_owner != address(0), "ShB owner 0");
 109 |          _transferOwnership(_owner);
 111 |          eraFirstPostUpgradeBatch = _eraFirstPostUpgradeBatch;
 112 |          l2BridgeAddress[ERA_CHAIN_ID] = ERA_ERC20_BRIDGE_ADDRESS;
 113 |      }
```
GitHub: [104-113](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L104-L113)


```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

     |  // @audit-issue Consider emitting an event documenting the initialization
  41 |  function initialize(address _owner) external reentrancyGuardInitializer {
  42 |      _transferOwnership(_owner);
  43 |  }
```
GitHub: [41-43](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L41-L43)


```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

     |  // @audit-issue Consider emitting an event documenting the initialization
  81 |      function initialize(
  82 |          StateTransitionManagerInitializeData calldata _initializeData
  83 |      ) external reentrancyGuardInitializer {
  84 |          require(_initializeData.governor != address(0), "StateTransition: governor zero");
  85 |          _transferOwnership(_initializeData.governor);
  87 |          genesisUpgrade = _initializeData.genesisUpgrade;
  88 |          protocolVersion = _initializeData.protocolVersion;
  89 |          validatorTimelock = _initializeData.validatorTimelock;
  91 |          // We need to initialize the state hash because it is used in the commitment of the next batch
  92 |          IExecutor.StoredBatchInfo memory batchZero = IExecutor.StoredBatchInfo(
  93 |              0,
  94 |              _initializeData.genesisBatchHash,
  95 |              _initializeData.genesisIndexRepeatedStorageChanges,
  96 |              0,
  97 |              EMPTY_STRING_KECCAK,
  98 |              DEFAULT_L2_LOGS_TREE_ROOT_HASH,
  99 |              0,
 100 |              _initializeData.genesisBatchCommitment
 101 |          );
 102 |          storedBatchZero = keccak256(abi.encode(batchZero));
 104 |          initialCutHash = keccak256(abi.encode(_initializeData.diamondCut));
 106 |          // While this does not provide a protection in the production, it is needed for local testing
 107 |          // Length of the L2Log encoding should not be equal to the length of other L2Logs' tree nodes preimages
 108 |          assert(L2_TO_L1_LOG_SERIALIZE_SIZE != 2 * 32);
 109 |      }
```
GitHub: [81-109](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L81-L109)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol

     |  // @audit-issue Consider emitting an event documenting the initialization
  24 |      function initialize(InitializeData calldata _initializeData) external reentrancyGuardInitializer returns (bytes32) {
  25 |          require(address(_initializeData.verifier) != address(0), "vt");
  26 |          require(_initializeData.admin != address(0), "vy");
  27 |          require(_initializeData.validatorTimelock != address(0), "hc");
  28 |          require(_initializeData.priorityTxMaxGasLimit <= MAX_GAS_PER_TRANSACTION, "vu");
  30 |          s.chainId = _initializeData.chainId;
  31 |          s.bridgehub = _initializeData.bridgehub;
  32 |          s.stateTransitionManager = _initializeData.stateTransitionManager;
  33 |          s.baseToken = _initializeData.baseToken;
  34 |          s.baseTokenBridge = _initializeData.baseTokenBridge;
  35 |          s.protocolVersion = _initializeData.protocolVersion;
  37 |          s.verifier = _initializeData.verifier;
  38 |          s.admin = _initializeData.admin;
  39 |          s.validators[_initializeData.validatorTimelock] = true;
  41 |          s.storedBatchHashes[0] = _initializeData.storedBatchZero;
  42 |          s.verifierParams = _initializeData.verifierParams;
  43 |          s.l2BootloaderBytecodeHash = _initializeData.l2BootloaderBytecodeHash;
  44 |          s.l2DefaultAccountBytecodeHash = _initializeData.l2DefaultAccountBytecodeHash;
  45 |          s.priorityTxMaxGasLimit = _initializeData.priorityTxMaxGasLimit;
  46 |          s.feeParams = _initializeData.feeParams;
  47 |          s.blobVersionedHashRetriever = _initializeData.blobVersionedHashRetriever;
  49 |          // While this does not provide a protection in the production, it is needed for local testing
  50 |          // Length of the L2Log encoding should not be equal to the length of other L2Logs' tree nodes preimages
  51 |          assert(L2_TO_L1_LOG_SERIALIZE_SIZE != 2 * 32);
  53 |          return Diamond.DIAMOND_INIT_SUCCESS_RETURN_VALUE;
  54 |      }
```
GitHub: [24-54](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol#L24-L54)


```solidity
File: code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol

     |  // @audit-issue Consider emitting an event documenting the initialization
  65 |  function initialize(StateTransitionManagerInitializeData calldata _initalizeData) external;
```
GitHub: [65](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L65)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol

     |  // @audit-issue Consider emitting an event documenting the initialization
  62 |  function initialize(InitializeData calldata _initData) external returns (bytes32);
```
GitHub: [62](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol#L62)


```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

     |  // @audit-issue Consider emitting an event documenting the initialization
  49 |      function initialize(
  50 |          address _l1Bridge,
  51 |          address _l1LegecyBridge,
  52 |          bytes32 _l2TokenProxyBytecodeHash,
  53 |          address _aliasedOwner
  54 |      ) external reinitializer(2) {
  55 |          require(_l1Bridge != address(0), "bf");
  56 |          require(_l2TokenProxyBytecodeHash != bytes32(0), "df");
  57 |          require(_aliasedOwner != address(0), "sf");
  58 |          require(_l2TokenProxyBytecodeHash != bytes32(0), "df");
  60 |          l1Bridge = _l1Bridge;
  61 |          l2TokenProxyBytecodeHash = _l2TokenProxyBytecodeHash;
  63 |          if (block.chainid != ERA_CHAIN_ID) {
  64 |              address l2StandardToken = address(new L2StandardERC20{salt: bytes32(0)}());
  65 |              l2TokenBeacon = new UpgradeableBeacon{salt: bytes32(0)}(l2StandardToken);
  66 |              l2TokenBeacon.transferOwnership(_aliasedOwner);
  67 |          } else {
  68 |              require(_l1LegecyBridge != address(0), "bf2");
  69 |              // l2StandardToken and l2TokenBeacon are already deployed on ERA, and stored in the proxy
  70 |          }
  71 |      }
```
GitHub: [49-71](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L49-L71)


## [N-51] Mixed usage of `int`/`uint` with `int256`/`uint256`

`int256`/`uint256` are the preferred type names (they're what are used for function signatures), so they should be used consistently

*Instances: 1*

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

     |  // @audit-issue Use uint256 instead
 580 |  for (uint i = 0; i < MAX_NUMBER_OF_BLOBS; i++) {
```
GitHub: [580](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L580)


## [N-52] Multiple `address`/ID mappings can be combined into a single `mapping` of an `address`/ID to a `struct`, for readability

Well-organized data structures make code reviews easier, which may lead to fewer bugs. Consider combining related mappings into mappings to structs, so it's clear what data is related.

*Instances: 13*

```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

     |  // @audit-issue Consider whether multiple mappings can be merged into a single struct mapping
  48 |  mapping(uint256 chainId => address l2Bridge) public override l2BridgeAddress;

     |  // @audit-issue Consider whether multiple mappings can be merged into a single struct mapping
  52 |  mapping(uint256 chainId => mapping(bytes32 l2DepositTxHash => bytes32 depositDataHash))
  53 |      public
  54 |      override depositHappened;

     |  // @audit-issue Consider whether multiple mappings can be merged into a single struct mapping
  57 |  mapping(uint256 chainId => mapping(uint256 l2BatchNumber => mapping(uint256 l2ToL1MessageNumber => bool isFinalized)))
  58 |      public isWithdrawalFinalized;

     |  // @audit-issue Consider whether multiple mappings can be merged into a single struct mapping
  61 |  mapping(uint256 chainId => bool enabled) internal hyperbridgingEnabled;

     |  // @audit-issue Consider whether multiple mappings can be merged into a single struct mapping
  65 |  mapping(uint256 chainId => mapping(address l1Token => uint256 balance)) internal chainBalance;
```
GitHub: [48](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L48), [52-54](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L52-L54), [57-58](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L57-L58), [61](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L61), [65](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L65)


```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

     |  // @audit-issue Consider whether multiple mappings can be merged into a single struct mapping
  26 |  mapping(uint256 _chainId => address) public stateTransitionManager;

     |  // @audit-issue Consider whether multiple mappings can be merged into a single struct mapping
  29 |  mapping(uint256 _chainId => address) public baseToken;
```
GitHub: [26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L26), [29](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L29)


```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

     |  // @audit-issue Consider whether multiple mappings can be merged into a single struct mapping
  47 |  mapping(uint256 => LibMap.Uint32Map) internal committedBatchTimestamp;

     |  // @audit-issue Consider whether multiple mappings can be merged into a single struct mapping
  50 |  mapping(uint256 _chainId => mapping(address _validator => bool)) public validators;
```
GitHub: [47](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L47), [50](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L50)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol

     |  // @audit-issue Consider whether multiple mappings can be merged into a single struct mapping
  86 |  mapping(uint256 batchNumber => bytes32 batchHash) storedBatchHashes;

     |  // @audit-issue Consider whether multiple mappings can be merged into a single struct mapping
  88 |  mapping(uint256 batchNumber => bytes32 l2LogsRootHash) l2LogsRootHashes;
```
GitHub: [86](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L86), [88](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L88)


```solidity
File: code/system-contracts/contracts/NonceHolder.sol

     |  // @audit-issue Consider whether multiple mappings can be merged into a single struct mapping
  36 |  mapping(uint256 account => uint256 packedMinAndDeploymentNonce) internal rawNonces;

     |  // @audit-issue Consider whether multiple mappings can be merged into a single struct mapping
  41 |  mapping(uint256 account => mapping(uint256 nonceKey => uint256 value)) internal nonceValues;
```
GitHub: [36](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/NonceHolder.sol#L36), [41](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/NonceHolder.sol#L41)


## [N-53] Named but unused function parameters in an overridden function

`override` function arguments that are unused should have the variable name removed or commented out to avoid compiler warnings.

*Instances: 3*

```solidity
File: code/system-contracts/contracts/DefaultAccount.sol

     |  // @audit-issue `_transaction` is unused
 125 |  function executeTransactionFromOutside(Transaction calldata _transaction) external payable override {
```
GitHub: [125](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L125)


```solidity
File: code/contracts/zksync/contracts/TestnetPaymaster.sol

     |  // @audit-issue `_context` is unused
     |  // `_transaction` is unused
     |  // `_txResult` is unused
     |  // `_maxRefundedGas` is unused
  70 |  function postTransaction(
  71 |      bytes calldata _context,
  72 |      Transaction calldata _transaction,
  73 |      bytes32,
  74 |      bytes32,
  75 |      ExecutionResult _txResult,
  76 |      uint256 _maxRefundedGas
  77 |  ) external payable override {
```
GitHub: [70-77](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/TestnetPaymaster.sol#L70-L77)


```solidity
File: code/contracts/zksync/contracts/bridge/L2WrappedBaseToken.sol

     |  // @audit-issue `_to` is unused
     |  // `_amount` is unused
  72 |  function bridgeMint(address _to, uint256 _amount) external override onlyBridge {
```
GitHub: [72](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2WrappedBaseToken.sol#L72)


## [N-54] Named imports of base contracts are missing

When importing base contracts, use [named imports](https://docs.soliditylang.org/en/latest/layout-of-source-files.html#syntax-and-semantics) to improve code readability.

*Instances: 7*

```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

     |  // @audit-issue Missing named import for `IBridgehub`
  16 |  contract Bridgehub is IBridgehub, ReentrancyGuard, Ownable2Step {

     |  // @audit-issue Missing named import for `ReentrancyGuard`
  16 |  contract Bridgehub is IBridgehub, ReentrancyGuard, Ownable2Step {
```
GitHub: [16](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L16), [16](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L16)


```solidity
File: code/contracts/ethereum/contracts/upgrades/GenesisUpgrade.sol

     |  // @audit-issue Missing named import for `BaseZkSyncUpgradeGenesis`
  11 |  contract GenesisUpgrade is BaseZkSyncUpgradeGenesis {
```
GitHub: [11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/GenesisUpgrade.sol#L11)


```solidity
File: code/contracts/ethereum/contracts/state-transition/Verifier.sol

     |  // @audit-issue Missing named import for `IVerifier`
  20 |  contract Verifier is IVerifier {
```
GitHub: [20](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L20)


```solidity
File: code/system-contracts/contracts/AccountCodeStorage.sol

     |  // @audit-issue Missing named import for `IAccountCodeStorage`
  22 |  contract AccountCodeStorage is IAccountCodeStorage {
```
GitHub: [22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L22)


```solidity
File: code/system-contracts/contracts/DefaultAccount.sol

     |  // @audit-issue Missing named import for `IAccount`
  19 |  contract DefaultAccount is IAccount {
```
GitHub: [19](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L19)


```solidity
File: code/contracts/zksync/contracts/TestnetPaymaster.sol

     |  // @audit-issue Missing named import for `IPaymaster`
  13 |  contract TestnetPaymaster is IPaymaster {
```
GitHub: [13](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/TestnetPaymaster.sol#L13)


## [N-55] Naming: name immutables using all-uppercase

Immutables should be in uppercase as stated [Solidity style guide](https://docs.soliditylang.org/en/latest/style-guide.html#constants).

*Instances: 5*

```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

     |  // @audit-issue Names of immutable variables should be in all uppercase
  23 |  IL1SharedBridge public immutable override sharedBridge;
```
GitHub: [23](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L23)


```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

     |  // @audit-issue Names of immutable variables should be in all uppercase
  34 |  address public immutable override l1WethAddress;

     |  // @audit-issue Names of immutable variables should be in all uppercase
  37 |  IBridgehub public immutable override bridgehub;

     |  // @audit-issue Names of immutable variables should be in all uppercase
  40 |  IL1ERC20Bridge public immutable override legacyBridge;
```
GitHub: [34](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L34), [37](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L37), [40](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L40)


```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

     |  // @audit-issue Names of immutable variables should be in all uppercase
  29 |  address public immutable bridgehub;
```
GitHub: [29](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L29)


## [N-56] Naming: use all-uppercase when naming constants

Constants should be in uppercase as stated [Solidity style guide](https://docs.soliditylang.org/en/latest/style-guide.html#constants).

*Instances: 7*

```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

     |  // @audit-issue Names of constant variables should be in all uppercase
  26 |  string public constant override getName = "ValidatorTimelock";
```
GitHub: [26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L26)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol

     |  // @audit-issue Names of constant variables should be in all uppercase
  20 |  string public constant override getName = "AdminFacet";
```
GitHub: [20](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L20)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

     |  // @audit-issue Names of constant variables should be in all uppercase
  27 |  string public constant override getName = "ExecutorFacet";
```
GitHub: [27](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L27)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol

     |  // @audit-issue Names of constant variables should be in all uppercase
  25 |  string public constant override getName = "GettersFacet";
```
GitHub: [25](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L25)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

     |  // @audit-issue Names of constant variables should be in all uppercase
  35 |  string public constant override getName = "MailboxFacet";
```
GitHub: [35](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L35)


```solidity
File: code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol

     |  // @audit-issue Names of constant variables should be in all uppercase
  22 |  uint160 constant offset = uint160(0x1111000000000000000000000000000000001111);
```
GitHub: [22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol#L22)


```solidity
File: code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol

     |  // @audit-issue Names of constant variables should be in all uppercase
  22 |  uint160 constant offset = uint160(0x1111000000000000000000000000000000001111);
```
GitHub: [22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol#L22)


## [N-57] NatSpec: Contract declarations should have NatSpec descriptions

e.g. `@dev` or `@notice`, and it must appear above the contract definition braces in order to be identified by the compiler as NatSpec.

*Instances: 23*

```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

     |  // @audit-issue Add NatSpec contract/interface/library documentation
  16 |  contract Bridgehub is IBridgehub, ReentrancyGuard, Ownable2Step {
```
GitHub: [16](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L16)


```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IWETH9.sol

     |  // @audit-issue Add NatSpec contract/interface/library documentation
   4 |  interface IWETH9 {
```
GitHub: [4](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IWETH9.sol#L4)


```solidity
File: code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol

     |  // @audit-issue Add NatSpec contract/interface/library documentation
  42 |  interface IBridgehub {
```
GitHub: [42](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L42)


```solidity
File: code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol

     |  // @audit-issue Add NatSpec contract/interface/library documentation
  26 |  interface IStateTransitionManager {
```
GitHub: [26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L26)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol

     |  // @audit-issue Add NatSpec contract/interface/library documentation
  61 |  interface IDiamondInit {
```
GitHub: [61](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol#L61)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol

     |  // @audit-issue Add NatSpec contract/interface/library documentation
  15 |  interface IZkSyncStateTransition is IAdmin, IExecutor, IGetters, IMailbox {
```
GitHub: [15](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol#L15)


```solidity
File: code/contracts/ethereum/contracts/upgrades/IDefaultUpgrade.sol

     |  // @audit-issue Add NatSpec contract/interface/library documentation
   7 |  interface IDefaultUpgrade {
```
GitHub: [7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/IDefaultUpgrade.sol#L7)


```solidity
File: code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol

     |  // @audit-issue Add NatSpec contract/interface/library documentation
  21 |  library AddressAliasHelper {
```
GitHub: [21](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol#L21)


```solidity
File: code/contracts/ethereum/contracts/state-transition/l2-deps/ISystemContext.sol

     |  // @audit-issue Add NatSpec contract/interface/library documentation
   4 |  interface ISystemContext {
```
GitHub: [4](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/l2-deps/ISystemContext.sol#L4)


```solidity
File: code/system-contracts/contracts/interfaces/IAccount.sol

     |  // @audit-issue Add NatSpec contract/interface/library documentation
   9 |  interface IAccount {
```
GitHub: [9](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IAccount.sol#L9)


```solidity
File: code/system-contracts/contracts/interfaces/IAccountCodeStorage.sol

     |  // @audit-issue Add NatSpec contract/interface/library documentation
   5 |  interface IAccountCodeStorage {
```
GitHub: [5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IAccountCodeStorage.sol#L5)


```solidity
File: code/system-contracts/contracts/interfaces/IBaseToken.sol

     |  // @audit-issue Add NatSpec contract/interface/library documentation
   5 |  interface IBaseToken {
```
GitHub: [5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBaseToken.sol#L5)


```solidity
File: code/system-contracts/contracts/interfaces/IBootloaderUtilities.sol

     |  // @audit-issue Add NatSpec contract/interface/library documentation
   7 |  interface IBootloaderUtilities {
```
GitHub: [7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBootloaderUtilities.sol#L7)


```solidity
File: code/system-contracts/contracts/interfaces/IContractDeployer.sol

     |  // @audit-issue Add NatSpec contract/interface/library documentation
   5 |  interface IContractDeployer {
```
GitHub: [5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L5)


```solidity
File: code/system-contracts/contracts/interfaces/IImmutableSimulator.sol

     |  // @audit-issue Add NatSpec contract/interface/library documentation
  10 |  interface IImmutableSimulator {
```
GitHub: [10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IImmutableSimulator.sol#L10)


```solidity
File: code/system-contracts/contracts/interfaces/IL2StandardToken.sol

     |  // @audit-issue Add NatSpec contract/interface/library documentation
   5 |  interface IL2StandardToken {
```
GitHub: [5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL2StandardToken.sol#L5)


```solidity
File: code/system-contracts/contracts/interfaces/IMailbox.sol

     |  // @audit-issue Add NatSpec contract/interface/library documentation
   5 |  interface IMailbox {
```
GitHub: [5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IMailbox.sol#L5)


```solidity
File: code/system-contracts/contracts/interfaces/IPaymaster.sol

     |  // @audit-issue Add NatSpec contract/interface/library documentation
  14 |  interface IPaymaster {
```
GitHub: [14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IPaymaster.sol#L14)


```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol

     |  // @audit-issue Add NatSpec contract/interface/library documentation
   5 |  interface IL2StandardToken {
```
GitHub: [5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol#L5)


```solidity
File: code/contracts/zksync/contracts/interfaces/IPaymaster.sol

     |  // @audit-issue Add NatSpec contract/interface/library documentation
  14 |  interface IPaymaster {
```
GitHub: [14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/interfaces/IPaymaster.sol#L14)


```solidity
File: code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol

     |  // @audit-issue Add NatSpec contract/interface/library documentation
  21 |  library AddressAliasHelper {
```
GitHub: [21](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol#L21)


```solidity
File: code/contracts/zksync/contracts/SystemContractsCaller.sol

     |  // @audit-issue Add NatSpec contract/interface/library documentation
  26 |  library Utils {
```
GitHub: [26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/SystemContractsCaller.sol#L26)


```solidity
File: code/contracts/zksync/contracts/TestnetPaymaster.sol

     |  // @audit-issue Add NatSpec contract/interface/library documentation
  13 |  contract TestnetPaymaster is IPaymaster {
```
GitHub: [13](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/TestnetPaymaster.sol#L13)


## [N-58] NatSpec: Contract declarations should have `@author` tags

`@author` is used to explain who to direct contract queries to.

*Instances: 26*

```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

     |  // @audit-issue Add NatSpec @author
  16 |  contract Bridgehub is IBridgehub, ReentrancyGuard, Ownable2Step {
```
GitHub: [16](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L16)


```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IWETH9.sol

     |  // @audit-issue Add NatSpec @author
   4 |  interface IWETH9 {
```
GitHub: [4](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IWETH9.sol#L4)


```solidity
File: code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol

     |  // @audit-issue Add NatSpec @author
  42 |  interface IBridgehub {
```
GitHub: [42](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L42)


```solidity
File: code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol

     |  // @audit-issue Add NatSpec @author
  26 |  interface IStateTransitionManager {
```
GitHub: [26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L26)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol

     |  // @audit-issue Add NatSpec @author
  61 |  interface IDiamondInit {
```
GitHub: [61](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol#L61)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol

     |  // @audit-issue Add NatSpec @author
  15 |  interface IZkSyncStateTransition is IAdmin, IExecutor, IGetters, IMailbox {
```
GitHub: [15](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol#L15)


```solidity
File: code/contracts/ethereum/contracts/upgrades/IDefaultUpgrade.sol

     |  // @audit-issue Add NatSpec @author
   7 |  interface IDefaultUpgrade {
```
GitHub: [7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/IDefaultUpgrade.sol#L7)


```solidity
File: code/contracts/ethereum/contracts/common/ReentrancyGuard.sol

     |  // @audit-issue Add NatSpec @author
  25 |  abstract contract ReentrancyGuard {
```
GitHub: [25](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/ReentrancyGuard.sol#L25)


```solidity
File: code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol

     |  // @audit-issue Add NatSpec @author
  21 |  library AddressAliasHelper {
```
GitHub: [21](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol#L21)


```solidity
File: code/contracts/ethereum/contracts/state-transition/l2-deps/ISystemContext.sol

     |  // @audit-issue Add NatSpec @author
   4 |  interface ISystemContext {
```
GitHub: [4](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/l2-deps/ISystemContext.sol#L4)


```solidity
File: code/system-contracts/contracts/interfaces/IAccount.sol

     |  // @audit-issue Add NatSpec @author
   9 |  interface IAccount {
```
GitHub: [9](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IAccount.sol#L9)


```solidity
File: code/system-contracts/contracts/interfaces/IAccountCodeStorage.sol

     |  // @audit-issue Add NatSpec @author
   5 |  interface IAccountCodeStorage {
```
GitHub: [5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IAccountCodeStorage.sol#L5)


```solidity
File: code/system-contracts/contracts/interfaces/IBaseToken.sol

     |  // @audit-issue Add NatSpec @author
   5 |  interface IBaseToken {
```
GitHub: [5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBaseToken.sol#L5)


```solidity
File: code/system-contracts/contracts/interfaces/IBootloaderUtilities.sol

     |  // @audit-issue Add NatSpec @author
   7 |  interface IBootloaderUtilities {
```
GitHub: [7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBootloaderUtilities.sol#L7)


```solidity
File: code/system-contracts/contracts/interfaces/IContractDeployer.sol

     |  // @audit-issue Add NatSpec @author
   5 |  interface IContractDeployer {
```
GitHub: [5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L5)


```solidity
File: code/system-contracts/contracts/interfaces/IImmutableSimulator.sol

     |  // @audit-issue Add NatSpec @author
  10 |  interface IImmutableSimulator {
```
GitHub: [10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IImmutableSimulator.sol#L10)


```solidity
File: code/system-contracts/contracts/interfaces/IL2StandardToken.sol

     |  // @audit-issue Add NatSpec @author
   5 |  interface IL2StandardToken {
```
GitHub: [5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL2StandardToken.sol#L5)


```solidity
File: code/system-contracts/contracts/interfaces/IMailbox.sol

     |  // @audit-issue Add NatSpec @author
   5 |  interface IMailbox {
```
GitHub: [5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IMailbox.sol#L5)


```solidity
File: code/system-contracts/contracts/interfaces/IPaymaster.sol

     |  // @audit-issue Add NatSpec @author
  14 |  interface IPaymaster {
```
GitHub: [14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IPaymaster.sol#L14)


```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol

     |  // @audit-issue Add NatSpec @author
   5 |  interface IL2StandardToken {
```
GitHub: [5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol#L5)


```solidity
File: code/contracts/zksync/contracts/interfaces/IPaymaster.sol

     |  // @audit-issue Add NatSpec @author
  14 |  interface IPaymaster {
```
GitHub: [14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/interfaces/IPaymaster.sol#L14)


```solidity
File: code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol

     |  // @audit-issue Add NatSpec @author
  21 |  library AddressAliasHelper {
```
GitHub: [21](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol#L21)


```solidity
File: code/contracts/zksync/contracts/ForceDeployUpgrader.sol

     |  // @audit-issue Add NatSpec @author
  10 |  contract ForceDeployUpgrader {
```
GitHub: [10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/ForceDeployUpgrader.sol#L10)


```solidity
File: code/contracts/zksync/contracts/SystemContractsCaller.sol

     |  // @audit-issue Add NatSpec @author
  26 |  library Utils {

     |  // @audit-issue Add NatSpec @author
  36 |  library SystemContractsCaller {
```
GitHub: [26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/SystemContractsCaller.sol#L26), [36](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/SystemContractsCaller.sol#L36)


```solidity
File: code/contracts/zksync/contracts/TestnetPaymaster.sol

     |  // @audit-issue Add NatSpec @author
  13 |  contract TestnetPaymaster is IPaymaster {
```
GitHub: [13](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/TestnetPaymaster.sol#L13)


## [N-59] NatSpec: Contract declarations should have `@dev` tags

`@dev` is used to explain extra details to developers

*Instances: 75*

```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

     |  // @audit-issue Add NatSpec @dev
  16 |  contract Bridgehub is IBridgehub, ReentrancyGuard, Ownable2Step {
```
GitHub: [16](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L16)


```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

     |  // @audit-issue Add NatSpec @dev
  27 |  contract StateTransitionManager is IStateTransitionManager, ReentrancyGuard, Ownable2Step {
```
GitHub: [27](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L27)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol

     |  // @audit-issue Add NatSpec @dev
  10 |  contract DiamondProxy {
```
GitHub: [10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol#L10)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol

     |  // @audit-issue Add NatSpec @dev
  18 |  contract AdminFacet is ZkSyncStateTransitionBase, IAdmin {
```
GitHub: [18](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L18)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

     |  // @audit-issue Add NatSpec @dev
  22 |  contract ExecutorFacet is ZkSyncStateTransitionBase, IExecutor {
```
GitHub: [22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L22)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol

     |  // @audit-issue Add NatSpec @dev
  20 |  contract GettersFacet is ZkSyncStateTransitionBase, IGetters, ILegacyGetters {
```
GitHub: [20](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L20)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

     |  // @audit-issue Add NatSpec @dev
  30 |  contract MailboxFacet is ZkSyncStateTransitionBase, IMailbox {
```
GitHub: [30](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L30)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol

     |  // @audit-issue Add NatSpec @dev
  11 |  contract ZkSyncStateTransitionBase is ReentrancyGuard {
```
GitHub: [11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L11)


```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol

     |  // @audit-issue Add NatSpec @dev
  44 |  abstract contract BaseZkSyncUpgrade is ZkSyncStateTransitionBase {
```
GitHub: [44](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L44)


```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol

     |  // @audit-issue Add NatSpec @dev
  17 |  abstract contract BaseZkSyncUpgradeGenesis is BaseZkSyncUpgrade {
```
GitHub: [17](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L17)


```solidity
File: code/contracts/ethereum/contracts/upgrades/DefaultUpgrade.sol

     |  // @audit-issue Add NatSpec @dev
  10 |  contract DefaultUpgrade is BaseZkSyncUpgrade {
```
GitHub: [10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/DefaultUpgrade.sol#L10)


```solidity
File: code/contracts/ethereum/contracts/upgrades/GenesisUpgrade.sol

     |  // @audit-issue Add NatSpec @dev
  11 |  contract GenesisUpgrade is BaseZkSyncUpgradeGenesis {
```
GitHub: [11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/GenesisUpgrade.sol#L11)


```solidity
File: code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol

     |  // @audit-issue Add NatSpec @dev
  10 |  library L2ContractHelper {
```
GitHub: [10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L10)


```solidity
File: code/contracts/ethereum/contracts/common/libraries/UncheckedMath.sol

     |  // @audit-issue Add NatSpec @dev
  10 |  library UncheckedMath {
```
GitHub: [10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/UncheckedMath.sol#L10)


```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol

     |  // @audit-issue Add NatSpec @dev
  11 |  library Diamond {
```
GitHub: [11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L11)


```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol

     |  // @audit-issue Add NatSpec @dev
   9 |  library Merkle {
```
GitHub: [9](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol#L9)


```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol

     |  // @audit-issue Add NatSpec @dev
  13 |  library TransactionValidator {
```
GitHub: [13](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L13)


```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol

     |  // @audit-issue Add NatSpec @dev
  11 |  interface IL1ERC20Bridge {
```
GitHub: [11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L11)


```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol

     |  // @audit-issue Add NatSpec @dev
  12 |  interface IL1SharedBridge {
```
GitHub: [12](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L12)


```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL2Bridge.sol

     |  // @audit-issue Add NatSpec @dev
   6 |  interface IL2Bridge {
```
GitHub: [6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL2Bridge.sol#L6)


```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IWETH9.sol

     |  // @audit-issue Add NatSpec @dev
   4 |  interface IWETH9 {
```
GitHub: [4](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IWETH9.sol#L4)


```solidity
File: code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol

     |  // @audit-issue Add NatSpec @dev
  42 |  interface IBridgehub {
```
GitHub: [42](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L42)


```solidity
File: code/contracts/ethereum/contracts/common/interfaces/IL2ContractDeployer.sol

     |  // @audit-issue Add NatSpec @dev
   9 |  interface IL2ContractDeployer {
```
GitHub: [9](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/interfaces/IL2ContractDeployer.sol#L9)


```solidity
File: code/contracts/ethereum/contracts/governance/IGovernance.sol

     |  // @audit-issue Add NatSpec @dev
   8 |  interface IGovernance {
```
GitHub: [8](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L8)


```solidity
File: code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol

     |  // @audit-issue Add NatSpec @dev
  26 |  interface IStateTransitionManager {
```
GitHub: [26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L26)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol

     |  // @audit-issue Add NatSpec @dev
  13 |  interface IAdmin is IZkSyncStateTransitionBase {
```
GitHub: [13](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L13)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol

     |  // @audit-issue Add NatSpec @dev
  61 |  interface IDiamondInit {
```
GitHub: [61](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol#L61)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol

     |  // @audit-issue Add NatSpec @dev
  73 |  interface IExecutor is IZkSyncStateTransitionBase {
```
GitHub: [73](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L73)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol

     |  // @audit-issue Add NatSpec @dev
  13 |  interface IGetters is IZkSyncStateTransitionBase {
```
GitHub: [13](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L13)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol

     |  // @audit-issue Add NatSpec @dev
  11 |  interface IMailbox is IZkSyncStateTransitionBase {
```
GitHub: [11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L11)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IVerifier.sol

     |  // @audit-issue Add NatSpec @dev
  15 |  interface IVerifier {
```
GitHub: [15](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IVerifier.sol#L15)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol

     |  // @audit-issue Add NatSpec @dev
  15 |  interface IZkSyncStateTransition is IAdmin, IExecutor, IGetters, IMailbox {
```
GitHub: [15](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol#L15)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransitionBase.sol

     |  // @audit-issue Add NatSpec @dev
   7 |  interface IZkSyncStateTransitionBase {
```
GitHub: [7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransitionBase.sol#L7)


```solidity
File: code/contracts/ethereum/contracts/upgrades/IDefaultUpgrade.sol

     |  // @audit-issue Add NatSpec @dev
   7 |  interface IDefaultUpgrade {
```
GitHub: [7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/IDefaultUpgrade.sol#L7)


```solidity
File: code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol

     |  // @audit-issue Add NatSpec @dev
  21 |  library AddressAliasHelper {
```
GitHub: [21](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol#L21)


```solidity
File: code/contracts/ethereum/contracts/upgrades/Upgrade_4844.sol

     |  // @audit-issue Add NatSpec @dev
  12 |  contract Upgrade_4844 is BaseZkSyncUpgrade {
```
GitHub: [12](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/Upgrade_4844.sol#L12)


```solidity
File: code/contracts/ethereum/contracts/upgrades/Upgrade_v1_4_1.sol

     |  // @audit-issue Add NatSpec @dev
  13 |  contract Upgrade_v1_4_1 is BaseZkSyncUpgrade {
```
GitHub: [13](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/Upgrade_v1_4_1.sol#L13)


```solidity
File: code/contracts/ethereum/contracts/state-transition/l2-deps/ISystemContext.sol

     |  // @audit-issue Add NatSpec @dev
   4 |  interface ISystemContext {
```
GitHub: [4](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/l2-deps/ISystemContext.sol#L4)


```solidity
File: code/system-contracts/contracts/BootloaderUtilities.sol

     |  // @audit-issue Add NatSpec @dev
  16 |  contract BootloaderUtilities is IBootloaderUtilities {
```
GitHub: [16](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L16)


```solidity
File: code/system-contracts/contracts/ComplexUpgrader.sol

     |  // @audit-issue Add NatSpec @dev
  14 |  contract ComplexUpgrader is IComplexUpgrader {
```
GitHub: [14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ComplexUpgrader.sol#L14)


```solidity
File: code/system-contracts/contracts/EmptyContract.sol

     |  // @audit-issue Add NatSpec @dev
  10 |  contract EmptyContract {
```
GitHub: [10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/EmptyContract.sol#L10)


```solidity
File: code/system-contracts/contracts/PubdataChunkPublisher.sol

     |  // @audit-issue Add NatSpec @dev
  16 |  contract PubdataChunkPublisher is IPubdataChunkPublisher, ISystemContract {
```
GitHub: [16](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/PubdataChunkPublisher.sol#L16)


```solidity
File: code/system-contracts/contracts/SystemContext.sol

     |  // @audit-issue Add NatSpec @dev
  17 |  contract SystemContext is ISystemContext, ISystemContextDeprecated, ISystemContract {
```
GitHub: [17](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L17)


```solidity
File: code/system-contracts/contracts/libraries/RLPEncoder.sol

     |  // @audit-issue Add NatSpec @dev
  10 |  library RLPEncoder {
```
GitHub: [10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/RLPEncoder.sol#L10)


```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

     |  // @audit-issue Add NatSpec @dev
  78 |  library TransactionHelper {
```
GitHub: [78](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L78)


```solidity
File: code/system-contracts/contracts/interfaces/IAccount.sol

     |  // @audit-issue Add NatSpec @dev
   9 |  interface IAccount {
```
GitHub: [9](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IAccount.sol#L9)


```solidity
File: code/system-contracts/contracts/interfaces/IAccountCodeStorage.sol

     |  // @audit-issue Add NatSpec @dev
   5 |  interface IAccountCodeStorage {
```
GitHub: [5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IAccountCodeStorage.sol#L5)


```solidity
File: code/system-contracts/contracts/interfaces/IBaseToken.sol

     |  // @audit-issue Add NatSpec @dev
   5 |  interface IBaseToken {
```
GitHub: [5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBaseToken.sol#L5)


```solidity
File: code/system-contracts/contracts/interfaces/IBootloaderUtilities.sol

     |  // @audit-issue Add NatSpec @dev
   7 |  interface IBootloaderUtilities {
```
GitHub: [7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBootloaderUtilities.sol#L7)


```solidity
File: code/system-contracts/contracts/interfaces/IComplexUpgrader.sol

     |  // @audit-issue Add NatSpec @dev
  10 |  interface IComplexUpgrader {
```
GitHub: [10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IComplexUpgrader.sol#L10)


```solidity
File: code/system-contracts/contracts/interfaces/ICompressor.sol

     |  // @audit-issue Add NatSpec @dev
  18 |  interface ICompressor {
```
GitHub: [18](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ICompressor.sol#L18)


```solidity
File: code/system-contracts/contracts/interfaces/IContractDeployer.sol

     |  // @audit-issue Add NatSpec @dev
   5 |  interface IContractDeployer {
```
GitHub: [5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L5)


```solidity
File: code/system-contracts/contracts/interfaces/IImmutableSimulator.sol

     |  // @audit-issue Add NatSpec @dev
  10 |  interface IImmutableSimulator {
```
GitHub: [10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IImmutableSimulator.sol#L10)


```solidity
File: code/system-contracts/contracts/interfaces/IKnownCodesStorage.sol

     |  // @audit-issue Add NatSpec @dev
  11 |  interface IKnownCodesStorage {
```
GitHub: [11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IKnownCodesStorage.sol#L11)


```solidity
File: code/system-contracts/contracts/interfaces/IL1Messenger.sol

     |  // @audit-issue Add NatSpec @dev
  40 |  interface IL1Messenger {
```
GitHub: [40](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL1Messenger.sol#L40)


```solidity
File: code/system-contracts/contracts/interfaces/IL2StandardToken.sol

     |  // @audit-issue Add NatSpec @dev
   5 |  interface IL2StandardToken {
```
GitHub: [5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL2StandardToken.sol#L5)


```solidity
File: code/system-contracts/contracts/interfaces/IMailbox.sol

     |  // @audit-issue Add NatSpec @dev
   5 |  interface IMailbox {
```
GitHub: [5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IMailbox.sol#L5)


```solidity
File: code/system-contracts/contracts/interfaces/IPaymaster.sol

     |  // @audit-issue Add NatSpec @dev
  14 |  interface IPaymaster {
```
GitHub: [14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IPaymaster.sol#L14)


```solidity
File: code/system-contracts/contracts/interfaces/IPubdataChunkPublisher.sol

     |  // @audit-issue Add NatSpec @dev
   9 |  interface IPubdataChunkPublisher {
```
GitHub: [9](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IPubdataChunkPublisher.sol#L9)


```solidity
File: code/system-contracts/contracts/interfaces/ISystemContext.sol

     |  // @audit-issue Add NatSpec @dev
  11 |  interface ISystemContext {
```
GitHub: [11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L11)


```solidity
File: code/system-contracts/contracts/interfaces/ISystemContextDeprecated.sol

     |  // @audit-issue Add NatSpec @dev
  10 |  interface ISystemContextDeprecated {
```
GitHub: [10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContextDeprecated.sol#L10)


```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

     |  // @audit-issue Add NatSpec @dev
  23 |  contract L2SharedBridge is IL2SharedBridge, Initializable {
```
GitHub: [23](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L23)


```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

     |  // @audit-issue Add NatSpec @dev
  15 |  contract L2StandardERC20 is ERC20PermitUpgradeable, IL2StandardToken, ERC1967Upgrade {
```
GitHub: [15](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L15)


```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL1ERC20Bridge.sol

     |  // @audit-issue Add NatSpec @dev
   8 |  interface IL1ERC20Bridge {
```
GitHub: [8](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L8)


```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL1SharedBridge.sol

     |  // @audit-issue Add NatSpec @dev
   8 |  interface IL1SharedBridge {
```
GitHub: [8](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL1SharedBridge.sol#L8)


```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol

     |  // @audit-issue Add NatSpec @dev
   6 |  interface IL2SharedBridge {
```
GitHub: [6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol#L6)


```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol

     |  // @audit-issue Add NatSpec @dev
   5 |  interface IL2StandardToken {
```
GitHub: [5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol#L5)


```solidity
File: code/contracts/zksync/contracts/interfaces/IPaymaster.sol

     |  // @audit-issue Add NatSpec @dev
  14 |  interface IPaymaster {
```
GitHub: [14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/interfaces/IPaymaster.sol#L14)


```solidity
File: code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol

     |  // @audit-issue Add NatSpec @dev
  21 |  library AddressAliasHelper {
```
GitHub: [21](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol#L21)


```solidity
File: code/contracts/zksync/contracts/ForceDeployUpgrader.sol

     |  // @audit-issue Add NatSpec @dev
  10 |  contract ForceDeployUpgrader {
```
GitHub: [10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/ForceDeployUpgrader.sol#L10)


```solidity
File: code/contracts/zksync/contracts/L2ContractHelper.sol

     |  // @audit-issue Add NatSpec @dev
  30 |  interface IContractDeployer {

     |  // @audit-issue Add NatSpec @dev
  61 |  interface IBaseToken {

     |  // @audit-issue Add NatSpec @dev
  83 |  library L2ContractHelper {
```
GitHub: [30](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/L2ContractHelper.sol#L30), [61](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/L2ContractHelper.sol#L61), [83](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/L2ContractHelper.sol#L83)


```solidity
File: code/contracts/zksync/contracts/SystemContractsCaller.sol

     |  // @audit-issue Add NatSpec @dev
  26 |  library Utils {
```
GitHub: [26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/SystemContractsCaller.sol#L26)


```solidity
File: code/contracts/zksync/contracts/TestnetPaymaster.sol

     |  // @audit-issue Add NatSpec @dev
  13 |  contract TestnetPaymaster is IPaymaster {
```
GitHub: [13](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/TestnetPaymaster.sol#L13)


## [N-60] NatSpec: Contract declarations should have `@notice` tags

`@notice` is used to explain to end users what the contract does, and the compiler interprets `///` or `/**` comments as this tag if one wasn't explicitly provided.

*Instances: 57*

```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

     |  // @audit-issue Add NatSpec @notice
  30 |  contract L1SharedBridge is IL1SharedBridge, ReentrancyGuard, Initializable, Ownable2Step {
```
GitHub: [30](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L30)


```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

     |  // @audit-issue Add NatSpec @notice
  16 |  contract Bridgehub is IBridgehub, ReentrancyGuard, Ownable2Step {
```
GitHub: [16](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L16)


```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

     |  // @audit-issue Add NatSpec @notice
  27 |  contract StateTransitionManager is IStateTransitionManager, ReentrancyGuard, Ownable2Step {
```
GitHub: [27](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L27)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol

     |  // @audit-issue Add NatSpec @notice
  17 |  contract DiamondInit is ZkSyncStateTransitionBase, IDiamondInit {
```
GitHub: [17](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol#L17)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol

     |  // @audit-issue Add NatSpec @notice
  10 |  contract DiamondProxy {
```
GitHub: [10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol#L10)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol

     |  // @audit-issue Add NatSpec @notice
  18 |  contract AdminFacet is ZkSyncStateTransitionBase, IAdmin {
```
GitHub: [18](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L18)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

     |  // @audit-issue Add NatSpec @notice
  22 |  contract ExecutorFacet is ZkSyncStateTransitionBase, IExecutor {
```
GitHub: [22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L22)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol

     |  // @audit-issue Add NatSpec @notice
  20 |  contract GettersFacet is ZkSyncStateTransitionBase, IGetters, ILegacyGetters {
```
GitHub: [20](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L20)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

     |  // @audit-issue Add NatSpec @notice
  30 |  contract MailboxFacet is ZkSyncStateTransitionBase, IMailbox {
```
GitHub: [30](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L30)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol

     |  // @audit-issue Add NatSpec @notice
  11 |  contract ZkSyncStateTransitionBase is ReentrancyGuard {
```
GitHub: [11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L11)


```solidity
File: code/contracts/ethereum/contracts/upgrades/DefaultUpgrade.sol

     |  // @audit-issue Add NatSpec @notice
  10 |  contract DefaultUpgrade is BaseZkSyncUpgrade {
```
GitHub: [10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/DefaultUpgrade.sol#L10)


```solidity
File: code/contracts/ethereum/contracts/upgrades/GenesisUpgrade.sol

     |  // @audit-issue Add NatSpec @notice
  11 |  contract GenesisUpgrade is BaseZkSyncUpgradeGenesis {
```
GitHub: [11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/GenesisUpgrade.sol#L11)


```solidity
File: code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol

     |  // @audit-issue Add NatSpec @notice
  18 |  library UnsafeBytes {
```
GitHub: [18](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol#L18)


```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol

     |  // @audit-issue Add NatSpec @notice
   9 |  library Merkle {
```
GitHub: [9](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol#L9)


```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol

     |  // @audit-issue Add NatSpec @notice
  20 |  library PriorityQueue {
```
GitHub: [20](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L20)


```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol

     |  // @audit-issue Add NatSpec @notice
  13 |  library TransactionValidator {
```
GitHub: [13](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L13)


```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol

     |  // @audit-issue Add NatSpec @notice
  12 |  interface IL1SharedBridge {
```
GitHub: [12](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L12)


```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL2Bridge.sol

     |  // @audit-issue Add NatSpec @notice
   6 |  interface IL2Bridge {
```
GitHub: [6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL2Bridge.sol#L6)


```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IWETH9.sol

     |  // @audit-issue Add NatSpec @notice
   4 |  interface IWETH9 {
```
GitHub: [4](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IWETH9.sol#L4)


```solidity
File: code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol

     |  // @audit-issue Add NatSpec @notice
  42 |  interface IBridgehub {
```
GitHub: [42](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L42)


```solidity
File: code/contracts/ethereum/contracts/governance/IGovernance.sol

     |  // @audit-issue Add NatSpec @notice
   8 |  interface IGovernance {
```
GitHub: [8](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L8)


```solidity
File: code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol

     |  // @audit-issue Add NatSpec @notice
  26 |  interface IStateTransitionManager {
```
GitHub: [26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L26)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol

     |  // @audit-issue Add NatSpec @notice
  13 |  interface IAdmin is IZkSyncStateTransitionBase {
```
GitHub: [13](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L13)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol

     |  // @audit-issue Add NatSpec @notice
  61 |  interface IDiamondInit {
```
GitHub: [61](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol#L61)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol

     |  // @audit-issue Add NatSpec @notice
  73 |  interface IExecutor is IZkSyncStateTransitionBase {
```
GitHub: [73](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L73)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol

     |  // @audit-issue Add NatSpec @notice
  13 |  interface IGetters is IZkSyncStateTransitionBase {
```
GitHub: [13](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L13)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/ILegacyGetters.sol

     |  // @audit-issue Add NatSpec @notice
  11 |  interface ILegacyGetters is IZkSyncStateTransitionBase {
```
GitHub: [11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/ILegacyGetters.sol#L11)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol

     |  // @audit-issue Add NatSpec @notice
  11 |  interface IMailbox is IZkSyncStateTransitionBase {
```
GitHub: [11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L11)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IVerifier.sol

     |  // @audit-issue Add NatSpec @notice
  15 |  interface IVerifier {
```
GitHub: [15](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IVerifier.sol#L15)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol

     |  // @audit-issue Add NatSpec @notice
  15 |  interface IZkSyncStateTransition is IAdmin, IExecutor, IGetters, IMailbox {
```
GitHub: [15](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol#L15)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransitionBase.sol

     |  // @audit-issue Add NatSpec @notice
   7 |  interface IZkSyncStateTransitionBase {
```
GitHub: [7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransitionBase.sol#L7)


```solidity
File: code/contracts/ethereum/contracts/upgrades/IDefaultUpgrade.sol

     |  // @audit-issue Add NatSpec @notice
   7 |  interface IDefaultUpgrade {
```
GitHub: [7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/IDefaultUpgrade.sol#L7)


```solidity
File: code/contracts/ethereum/contracts/common/ReentrancyGuard.sol

     |  // @audit-issue Add NatSpec @notice
  25 |  abstract contract ReentrancyGuard {
```
GitHub: [25](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/ReentrancyGuard.sol#L25)


```solidity
File: code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol

     |  // @audit-issue Add NatSpec @notice
  21 |  library AddressAliasHelper {
```
GitHub: [21](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol#L21)


```solidity
File: code/contracts/ethereum/contracts/upgrades/Upgrade_4844.sol

     |  // @audit-issue Add NatSpec @notice
  12 |  contract Upgrade_4844 is BaseZkSyncUpgrade {
```
GitHub: [12](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/Upgrade_4844.sol#L12)


```solidity
File: code/contracts/ethereum/contracts/upgrades/Upgrade_v1_4_1.sol

     |  // @audit-issue Add NatSpec @notice
  13 |  contract Upgrade_v1_4_1 is BaseZkSyncUpgrade {
```
GitHub: [13](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/Upgrade_v1_4_1.sol#L13)


```solidity
File: code/contracts/ethereum/contracts/state-transition/l2-deps/ISystemContext.sol

     |  // @audit-issue Add NatSpec @notice
   4 |  interface ISystemContext {
```
GitHub: [4](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/l2-deps/ISystemContext.sol#L4)


```solidity
File: code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol

     |  // @audit-issue Add NatSpec @notice
  18 |  library UnsafeBytesCalldata {
```
GitHub: [18](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol#L18)


```solidity
File: code/system-contracts/contracts/libraries/Utils.sol

     |  // @audit-issue Add NatSpec @notice
  11 |  library Utils {
```
GitHub: [11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L11)


```solidity
File: code/system-contracts/contracts/interfaces/IAccount.sol

     |  // @audit-issue Add NatSpec @notice
   9 |  interface IAccount {
```
GitHub: [9](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IAccount.sol#L9)


```solidity
File: code/system-contracts/contracts/interfaces/IAccountCodeStorage.sol

     |  // @audit-issue Add NatSpec @notice
   5 |  interface IAccountCodeStorage {
```
GitHub: [5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IAccountCodeStorage.sol#L5)


```solidity
File: code/system-contracts/contracts/interfaces/IBaseToken.sol

     |  // @audit-issue Add NatSpec @notice
   5 |  interface IBaseToken {
```
GitHub: [5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBaseToken.sol#L5)


```solidity
File: code/system-contracts/contracts/interfaces/IBootloaderUtilities.sol

     |  // @audit-issue Add NatSpec @notice
   7 |  interface IBootloaderUtilities {
```
GitHub: [7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBootloaderUtilities.sol#L7)


```solidity
File: code/system-contracts/contracts/interfaces/IContractDeployer.sol

     |  // @audit-issue Add NatSpec @notice
   5 |  interface IContractDeployer {
```
GitHub: [5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L5)


```solidity
File: code/system-contracts/contracts/interfaces/IImmutableSimulator.sol

     |  // @audit-issue Add NatSpec @notice
  10 |  interface IImmutableSimulator {
```
GitHub: [10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IImmutableSimulator.sol#L10)


```solidity
File: code/system-contracts/contracts/interfaces/IL2StandardToken.sol

     |  // @audit-issue Add NatSpec @notice
   5 |  interface IL2StandardToken {
```
GitHub: [5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL2StandardToken.sol#L5)


```solidity
File: code/system-contracts/contracts/interfaces/IMailbox.sol

     |  // @audit-issue Add NatSpec @notice
   5 |  interface IMailbox {
```
GitHub: [5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IMailbox.sol#L5)


```solidity
File: code/system-contracts/contracts/interfaces/INonceHolder.sol

     |  // @audit-issue Add NatSpec @notice
  13 |  interface INonceHolder {
```
GitHub: [13](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/INonceHolder.sol#L13)


```solidity
File: code/system-contracts/contracts/interfaces/IPaymaster.sol

     |  // @audit-issue Add NatSpec @notice
  14 |  interface IPaymaster {
```
GitHub: [14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IPaymaster.sol#L14)


```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL1ERC20Bridge.sol

     |  // @audit-issue Add NatSpec @notice
   8 |  interface IL1ERC20Bridge {
```
GitHub: [8](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L8)


```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL1SharedBridge.sol

     |  // @audit-issue Add NatSpec @notice
   8 |  interface IL1SharedBridge {
```
GitHub: [8](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL1SharedBridge.sol#L8)


```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol

     |  // @audit-issue Add NatSpec @notice
   6 |  interface IL2SharedBridge {
```
GitHub: [6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol#L6)


```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol

     |  // @audit-issue Add NatSpec @notice
   5 |  interface IL2StandardToken {
```
GitHub: [5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol#L5)


```solidity
File: code/contracts/zksync/contracts/interfaces/IPaymaster.sol

     |  // @audit-issue Add NatSpec @notice
  14 |  interface IPaymaster {
```
GitHub: [14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/interfaces/IPaymaster.sol#L14)


```solidity
File: code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol

     |  // @audit-issue Add NatSpec @notice
  21 |  library AddressAliasHelper {
```
GitHub: [21](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol#L21)


```solidity
File: code/contracts/zksync/contracts/SystemContractsCaller.sol

     |  // @audit-issue Add NatSpec @notice
  26 |  library Utils {
```
GitHub: [26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/SystemContractsCaller.sol#L26)


```solidity
File: code/contracts/zksync/contracts/TestnetPaymaster.sol

     |  // @audit-issue Add NatSpec @notice
  13 |  contract TestnetPaymaster is IPaymaster {
```
GitHub: [13](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/TestnetPaymaster.sol#L13)


## [N-61] NatSpec: Contract declarations should have `@title` tags

`@title` is used to title the contract

*Instances: 91*

```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

     |  // @audit-issue Add NatSpec @title
  19 |  contract L1ERC20Bridge is IL1ERC20Bridge, ReentrancyGuard {
```
GitHub: [19](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L19)


```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

     |  // @audit-issue Add NatSpec @title
  30 |  contract L1SharedBridge is IL1SharedBridge, ReentrancyGuard, Initializable, Ownable2Step {
```
GitHub: [30](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L30)


```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

     |  // @audit-issue Add NatSpec @title
  16 |  contract Bridgehub is IBridgehub, ReentrancyGuard, Ownable2Step {
```
GitHub: [16](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L16)


```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

     |  // @audit-issue Add NatSpec @title
  20 |  contract Governance is IGovernance, Ownable2Step {
```
GitHub: [20](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L20)


```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

     |  // @audit-issue Add NatSpec @title
  22 |  contract ValidatorTimelock is IExecutor, Ownable2Step {
```
GitHub: [22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L22)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol

     |  // @audit-issue Add NatSpec @title
  17 |  contract DiamondInit is ZkSyncStateTransitionBase, IDiamondInit {
```
GitHub: [17](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol#L17)


```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol

     |  // @audit-issue Add NatSpec @title
  44 |  abstract contract BaseZkSyncUpgrade is ZkSyncStateTransitionBase {
```
GitHub: [44](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L44)


```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol

     |  // @audit-issue Add NatSpec @title
  17 |  abstract contract BaseZkSyncUpgradeGenesis is BaseZkSyncUpgrade {
```
GitHub: [17](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L17)


```solidity
File: code/contracts/ethereum/contracts/upgrades/DefaultUpgrade.sol

     |  // @audit-issue Add NatSpec @title
  10 |  contract DefaultUpgrade is BaseZkSyncUpgrade {
```
GitHub: [10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/DefaultUpgrade.sol#L10)


```solidity
File: code/contracts/ethereum/contracts/upgrades/GenesisUpgrade.sol

     |  // @audit-issue Add NatSpec @title
  11 |  contract GenesisUpgrade is BaseZkSyncUpgradeGenesis {
```
GitHub: [11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/GenesisUpgrade.sol#L11)


```solidity
File: code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol

     |  // @audit-issue Add NatSpec @title
  10 |  library L2ContractHelper {
```
GitHub: [10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L10)


```solidity
File: code/contracts/ethereum/contracts/common/libraries/UncheckedMath.sol

     |  // @audit-issue Add NatSpec @title
  10 |  library UncheckedMath {
```
GitHub: [10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/UncheckedMath.sol#L10)


```solidity
File: code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol

     |  // @audit-issue Add NatSpec @title
  18 |  library UnsafeBytes {
```
GitHub: [18](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol#L18)


```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol

     |  // @audit-issue Add NatSpec @title
  11 |  library Diamond {
```
GitHub: [11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L11)


```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/LibMap.sol

     |  // @audit-issue Add NatSpec @title
   8 |  library LibMap {
```
GitHub: [8](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/LibMap.sol#L8)


```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol

     |  // @audit-issue Add NatSpec @title
   9 |  library Merkle {
```
GitHub: [9](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol#L9)


```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol

     |  // @audit-issue Add NatSpec @title
  20 |  library PriorityQueue {
```
GitHub: [20](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L20)


```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL2Bridge.sol

     |  // @audit-issue Add NatSpec @title
   6 |  interface IL2Bridge {
```
GitHub: [6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL2Bridge.sol#L6)


```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IWETH9.sol

     |  // @audit-issue Add NatSpec @title
   4 |  interface IWETH9 {
```
GitHub: [4](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IWETH9.sol#L4)


```solidity
File: code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol

     |  // @audit-issue Add NatSpec @title
  42 |  interface IBridgehub {
```
GitHub: [42](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L42)


```solidity
File: code/contracts/ethereum/contracts/common/interfaces/IL2ContractDeployer.sol

     |  // @audit-issue Add NatSpec @title
   9 |  interface IL2ContractDeployer {
```
GitHub: [9](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/interfaces/IL2ContractDeployer.sol#L9)


```solidity
File: code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol

     |  // @audit-issue Add NatSpec @title
  26 |  interface IStateTransitionManager {
```
GitHub: [26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L26)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol

     |  // @audit-issue Add NatSpec @title
  61 |  interface IDiamondInit {
```
GitHub: [61](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol#L61)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/ILegacyGetters.sol

     |  // @audit-issue Add NatSpec @title
  11 |  interface ILegacyGetters is IZkSyncStateTransitionBase {
```
GitHub: [11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/ILegacyGetters.sol#L11)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol

     |  // @audit-issue Add NatSpec @title
  15 |  interface IZkSyncStateTransition is IAdmin, IExecutor, IGetters, IMailbox {
```
GitHub: [15](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol#L15)


```solidity
File: code/contracts/ethereum/contracts/upgrades/IDefaultUpgrade.sol

     |  // @audit-issue Add NatSpec @title
   7 |  interface IDefaultUpgrade {
```
GitHub: [7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/IDefaultUpgrade.sol#L7)


```solidity
File: code/contracts/ethereum/contracts/common/ReentrancyGuard.sol

     |  // @audit-issue Add NatSpec @title
  25 |  abstract contract ReentrancyGuard {
```
GitHub: [25](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/ReentrancyGuard.sol#L25)


```solidity
File: code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol

     |  // @audit-issue Add NatSpec @title
  21 |  library AddressAliasHelper {
```
GitHub: [21](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol#L21)


```solidity
File: code/contracts/ethereum/contracts/state-transition/Verifier.sol

     |  // @audit-issue Add NatSpec @title
  20 |  contract Verifier is IVerifier {
```
GitHub: [20](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L20)


```solidity
File: code/contracts/ethereum/contracts/upgrades/Upgrade_4844.sol

     |  // @audit-issue Add NatSpec @title
  12 |  contract Upgrade_4844 is BaseZkSyncUpgrade {
```
GitHub: [12](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/Upgrade_4844.sol#L12)


```solidity
File: code/contracts/ethereum/contracts/upgrades/Upgrade_v1_4_1.sol

     |  // @audit-issue Add NatSpec @title
  13 |  contract Upgrade_v1_4_1 is BaseZkSyncUpgrade {
```
GitHub: [13](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/Upgrade_v1_4_1.sol#L13)


```solidity
File: code/contracts/ethereum/contracts/state-transition/l2-deps/ISystemContext.sol

     |  // @audit-issue Add NatSpec @title
   4 |  interface ISystemContext {
```
GitHub: [4](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/l2-deps/ISystemContext.sol#L4)


```solidity
File: code/system-contracts/contracts/AccountCodeStorage.sol

     |  // @audit-issue Add NatSpec @title
  22 |  contract AccountCodeStorage is IAccountCodeStorage {
```
GitHub: [22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L22)


```solidity
File: code/system-contracts/contracts/BootloaderUtilities.sol

     |  // @audit-issue Add NatSpec @title
  16 |  contract BootloaderUtilities is IBootloaderUtilities {
```
GitHub: [16](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L16)


```solidity
File: code/system-contracts/contracts/ComplexUpgrader.sol

     |  // @audit-issue Add NatSpec @title
  14 |  contract ComplexUpgrader is IComplexUpgrader {
```
GitHub: [14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ComplexUpgrader.sol#L14)


```solidity
File: code/system-contracts/contracts/Compressor.sol

     |  // @audit-issue Add NatSpec @title
  22 |  contract Compressor is ICompressor, ISystemContract {
```
GitHub: [22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L22)


```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

     |  // @audit-issue Add NatSpec @title
  23 |  contract ContractDeployer is IContractDeployer, ISystemContract {
```
GitHub: [23](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L23)


```solidity
File: code/system-contracts/contracts/DefaultAccount.sol

     |  // @audit-issue Add NatSpec @title
  19 |  contract DefaultAccount is IAccount {
```
GitHub: [19](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L19)


```solidity
File: code/system-contracts/contracts/EmptyContract.sol

     |  // @audit-issue Add NatSpec @title
  10 |  contract EmptyContract {
```
GitHub: [10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/EmptyContract.sol#L10)


```solidity
File: code/system-contracts/contracts/ImmutableSimulator.sol

     |  // @audit-issue Add NatSpec @title
  18 |  contract ImmutableSimulator is IImmutableSimulator {
```
GitHub: [18](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ImmutableSimulator.sol#L18)


```solidity
File: code/system-contracts/contracts/KnownCodesStorage.sol

     |  // @audit-issue Add NatSpec @title
  18 |  contract KnownCodesStorage is IKnownCodesStorage, ISystemContract {
```
GitHub: [18](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/KnownCodesStorage.sol#L18)


```solidity
File: code/system-contracts/contracts/L1Messenger.sol

     |  // @audit-issue Add NatSpec @title
  25 |  contract L1Messenger is IL1Messenger, ISystemContract {
```
GitHub: [25](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L25)


```solidity
File: code/system-contracts/contracts/L2BaseToken.sol

     |  // @audit-issue Add NatSpec @title
  18 |  contract L2BaseToken is IBaseToken, ISystemContract {
```
GitHub: [18](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L2BaseToken.sol#L18)


```solidity
File: code/system-contracts/contracts/MsgValueSimulator.sol

     |  // @audit-issue Add NatSpec @title
  19 |  contract MsgValueSimulator is ISystemContract {
```
GitHub: [19](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/MsgValueSimulator.sol#L19)


```solidity
File: code/system-contracts/contracts/NonceHolder.sol

     |  // @audit-issue Add NatSpec @title
  27 |  contract NonceHolder is INonceHolder, ISystemContract {
```
GitHub: [27](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/NonceHolder.sol#L27)


```solidity
File: code/system-contracts/contracts/PubdataChunkPublisher.sol

     |  // @audit-issue Add NatSpec @title
  16 |  contract PubdataChunkPublisher is IPubdataChunkPublisher, ISystemContract {
```
GitHub: [16](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/PubdataChunkPublisher.sol#L16)


```solidity
File: code/system-contracts/contracts/SystemContext.sol

     |  // @audit-issue Add NatSpec @title
  17 |  contract SystemContext is ISystemContext, ISystemContextDeprecated, ISystemContract {
```
GitHub: [17](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L17)


```solidity
File: code/system-contracts/contracts/GasBoundCaller.sol

     |  // @audit-issue Add NatSpec @title
  15 |  contract GasBoundCaller {
```
GitHub: [15](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/GasBoundCaller.sol#L15)


```solidity
File: code/system-contracts/contracts/libraries/EfficientCall.sol

     |  // @audit-issue Add NatSpec @title
  32 |  library EfficientCall {
```
GitHub: [32](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L32)


```solidity
File: code/system-contracts/contracts/libraries/RLPEncoder.sol

     |  // @audit-issue Add NatSpec @title
  10 |  library RLPEncoder {
```
GitHub: [10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/RLPEncoder.sol#L10)


```solidity
File: code/system-contracts/contracts/libraries/SystemContractHelper.sol

     |  // @audit-issue Add NatSpec @title
  41 |  library SystemContractHelper {
```
GitHub: [41](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L41)


```solidity
File: code/system-contracts/contracts/libraries/SystemContractsCaller.sol

     |  // @audit-issue Add NatSpec @title
  68 |  library SystemContractsCaller {
```
GitHub: [68](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L68)


```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

     |  // @audit-issue Add NatSpec @title
  78 |  library TransactionHelper {
```
GitHub: [78](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L78)


```solidity
File: code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol

     |  // @audit-issue Add NatSpec @title
  18 |  library UnsafeBytesCalldata {
```
GitHub: [18](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol#L18)


```solidity
File: code/system-contracts/contracts/libraries/Utils.sol

     |  // @audit-issue Add NatSpec @title
  11 |  library Utils {
```
GitHub: [11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L11)


```solidity
File: code/system-contracts/contracts/interfaces/IAccount.sol

     |  // @audit-issue Add NatSpec @title
   9 |  interface IAccount {
```
GitHub: [9](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IAccount.sol#L9)


```solidity
File: code/system-contracts/contracts/interfaces/IAccountCodeStorage.sol

     |  // @audit-issue Add NatSpec @title
   5 |  interface IAccountCodeStorage {
```
GitHub: [5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IAccountCodeStorage.sol#L5)


```solidity
File: code/system-contracts/contracts/interfaces/IBaseToken.sol

     |  // @audit-issue Add NatSpec @title
   5 |  interface IBaseToken {
```
GitHub: [5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBaseToken.sol#L5)


```solidity
File: code/system-contracts/contracts/interfaces/IBootloaderUtilities.sol

     |  // @audit-issue Add NatSpec @title
   7 |  interface IBootloaderUtilities {
```
GitHub: [7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBootloaderUtilities.sol#L7)


```solidity
File: code/system-contracts/contracts/interfaces/IComplexUpgrader.sol

     |  // @audit-issue Add NatSpec @title
  10 |  interface IComplexUpgrader {
```
GitHub: [10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IComplexUpgrader.sol#L10)


```solidity
File: code/system-contracts/contracts/interfaces/ICompressor.sol

     |  // @audit-issue Add NatSpec @title
  18 |  interface ICompressor {
```
GitHub: [18](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ICompressor.sol#L18)


```solidity
File: code/system-contracts/contracts/interfaces/IContractDeployer.sol

     |  // @audit-issue Add NatSpec @title
   5 |  interface IContractDeployer {
```
GitHub: [5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L5)


```solidity
File: code/system-contracts/contracts/interfaces/IImmutableSimulator.sol

     |  // @audit-issue Add NatSpec @title
  10 |  interface IImmutableSimulator {
```
GitHub: [10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IImmutableSimulator.sol#L10)


```solidity
File: code/system-contracts/contracts/interfaces/IKnownCodesStorage.sol

     |  // @audit-issue Add NatSpec @title
  11 |  interface IKnownCodesStorage {
```
GitHub: [11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IKnownCodesStorage.sol#L11)


```solidity
File: code/system-contracts/contracts/interfaces/IL1Messenger.sol

     |  // @audit-issue Add NatSpec @title
  40 |  interface IL1Messenger {
```
GitHub: [40](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL1Messenger.sol#L40)


```solidity
File: code/system-contracts/contracts/interfaces/IL2StandardToken.sol

     |  // @audit-issue Add NatSpec @title
   5 |  interface IL2StandardToken {
```
GitHub: [5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL2StandardToken.sol#L5)


```solidity
File: code/system-contracts/contracts/interfaces/IMailbox.sol

     |  // @audit-issue Add NatSpec @title
   5 |  interface IMailbox {
```
GitHub: [5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IMailbox.sol#L5)


```solidity
File: code/system-contracts/contracts/interfaces/INonceHolder.sol

     |  // @audit-issue Add NatSpec @title
  13 |  interface INonceHolder {
```
GitHub: [13](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/INonceHolder.sol#L13)


```solidity
File: code/system-contracts/contracts/interfaces/IPaymaster.sol

     |  // @audit-issue Add NatSpec @title
  14 |  interface IPaymaster {
```
GitHub: [14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IPaymaster.sol#L14)


```solidity
File: code/system-contracts/contracts/interfaces/IPaymasterFlow.sol

     |  // @audit-issue Add NatSpec @title
  12 |  interface IPaymasterFlow {
```
GitHub: [12](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IPaymasterFlow.sol#L12)


```solidity
File: code/system-contracts/contracts/interfaces/IPubdataChunkPublisher.sol

     |  // @audit-issue Add NatSpec @title
   9 |  interface IPubdataChunkPublisher {
```
GitHub: [9](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IPubdataChunkPublisher.sol#L9)


```solidity
File: code/system-contracts/contracts/interfaces/ISystemContext.sol

     |  // @audit-issue Add NatSpec @title
  11 |  interface ISystemContext {
```
GitHub: [11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L11)


```solidity
File: code/system-contracts/contracts/interfaces/ISystemContextDeprecated.sol

     |  // @audit-issue Add NatSpec @title
  10 |  interface ISystemContextDeprecated {
```
GitHub: [10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContextDeprecated.sol#L10)


```solidity
File: code/system-contracts/contracts/interfaces/ISystemContract.sol

     |  // @audit-issue Add NatSpec @title
  17 |  abstract contract ISystemContract {
```
GitHub: [17](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContract.sol#L17)


```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

     |  // @audit-issue Add NatSpec @title
  23 |  contract L2SharedBridge is IL2SharedBridge, Initializable {
```
GitHub: [23](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L23)


```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

     |  // @audit-issue Add NatSpec @title
  15 |  contract L2StandardERC20 is ERC20PermitUpgradeable, IL2StandardToken, ERC1967Upgrade {
```
GitHub: [15](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L15)


```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL1ERC20Bridge.sol

     |  // @audit-issue Add NatSpec @title
   8 |  interface IL1ERC20Bridge {
```
GitHub: [8](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L8)


```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol

     |  // @audit-issue Add NatSpec @title
   6 |  interface IL2SharedBridge {
```
GitHub: [6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol#L6)


```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol

     |  // @audit-issue Add NatSpec @title
   5 |  interface IL2StandardToken {
```
GitHub: [5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol#L5)


```solidity
File: code/contracts/zksync/contracts/interfaces/IPaymaster.sol

     |  // @audit-issue Add NatSpec @title
  14 |  interface IPaymaster {
```
GitHub: [14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/interfaces/IPaymaster.sol#L14)


```solidity
File: code/contracts/zksync/contracts/interfaces/IPaymasterFlow.sol

     |  // @audit-issue Add NatSpec @title
  13 |  interface IPaymasterFlow {
```
GitHub: [13](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/interfaces/IPaymasterFlow.sol#L13)


```solidity
File: code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol

     |  // @audit-issue Add NatSpec @title
  21 |  library AddressAliasHelper {
```
GitHub: [21](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol#L21)


```solidity
File: code/contracts/zksync/contracts/ForceDeployUpgrader.sol

     |  // @audit-issue Add NatSpec @title
  10 |  contract ForceDeployUpgrader {
```
GitHub: [10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/ForceDeployUpgrader.sol#L10)


```solidity
File: code/contracts/zksync/contracts/L2ContractHelper.sol

     |  // @audit-issue Add NatSpec @title
  18 |  interface IL2Messenger {

     |  // @audit-issue Add NatSpec @title
  30 |  interface IContractDeployer {

     |  // @audit-issue Add NatSpec @title
  61 |  interface IBaseToken {

     |  // @audit-issue Add NatSpec @title
  83 |  library L2ContractHelper {
```
GitHub: [18](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/L2ContractHelper.sol#L18), [30](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/L2ContractHelper.sol#L30), [61](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/L2ContractHelper.sol#L61), [83](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/L2ContractHelper.sol#L83)


```solidity
File: code/contracts/zksync/contracts/SystemContractsCaller.sol

     |  // @audit-issue Add NatSpec @title
  26 |  library Utils {

     |  // @audit-issue Add NatSpec @title
  36 |  library SystemContractsCaller {
```
GitHub: [26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/SystemContractsCaller.sol#L26), [36](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/SystemContractsCaller.sol#L36)


```solidity
File: code/contracts/zksync/contracts/TestnetPaymaster.sol

     |  // @audit-issue Add NatSpec @title
  13 |  contract TestnetPaymaster is IPaymaster {
```
GitHub: [13](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/TestnetPaymaster.sol#L13)


```solidity
File: code/contracts/zksync/contracts/bridge/L2WrappedBaseToken.sol

     |  // @audit-issue Add NatSpec @title
  23 |  contract L2WrappedBaseToken is ERC20PermitUpgradeable, IL2WrappedBaseToken, IL2StandardToken {
```
GitHub: [23](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2WrappedBaseToken.sol#L23)


## [N-62] NatSpec: Error `@param` is missing

Documentation of all error parameters improves code readability, as per [NatSpec Format](https://docs.soliditylang.org/en/latest/natspec-format.html#tags).

*Instances: 2*

```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

     |  // @audit-issue Missing NatSpec @param for parameter 1 uint256 _chainId
  38 |  error AddressAlreadyValidator(uint256 _chainId);

     |  // @audit-issue Missing NatSpec @param for parameter 1 uint256 _chainId
  41 |  error ValidatorDoesNotExist(uint256 _chainId);
```
GitHub: [38](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L38), [41](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L41)


## [N-63] NatSpec: Error definitions should have `@dev` tags

`@dev` is used to explain to developers what the error does, and the compiler interprets `///` or `/**` comments as this tag if one wasn't explicitly provided.

*Instances: 2*

```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

     |  // @audit-issue Add NatSpec @dev
  38 |  error AddressAlreadyValidator(uint256 _chainId);

     |  // @audit-issue Add NatSpec @dev
  41 |  error ValidatorDoesNotExist(uint256 _chainId);
```
GitHub: [38](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L38), [41](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L41)


## [N-64] NatSpec: Event `@param` is missing

Documentation of all event parameters improves code readability, as per [NatSpec Format](https://docs.soliditylang.org/en/latest/natspec-format.html#tags).

*Instances: 99*

```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

     |  // @audit-issue Missing NatSpec @param for parameter 1 uint256 _newExecutionDelay
  29 |  event NewExecutionDelay(uint256 _newExecutionDelay);

     |  // @audit-issue Missing NatSpec @param for parameter 1 uint256 _chainId
  32 |  event ValidatorAdded(uint256 _chainId, address _addedValidator);

     |  // @audit-issue Missing NatSpec @param for parameter 2 address _addedValidator
  32 |  event ValidatorAdded(uint256 _chainId, address _addedValidator);

     |  // @audit-issue Missing NatSpec @param for parameter 1 uint256 _chainId
  35 |  event ValidatorRemoved(uint256 _chainId, address _removedValidator);

     |  // @audit-issue Missing NatSpec @param for parameter 2 address _removedValidator
  35 |  event ValidatorRemoved(uint256 _chainId, address _removedValidator);
```
GitHub: [29](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L29), [32](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L32), [32](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L32), [35](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L35), [35](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L35)


```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol

     |  // @audit-issue Missing NatSpec @param for parameter 1 uint256 previousProtocolVersion
  46 |  event NewProtocolVersion(uint256 indexed previousProtocolVersion, uint256 indexed newProtocolVersion);

     |  // @audit-issue Missing NatSpec @param for parameter 2 uint256 newProtocolVersion
  46 |  event NewProtocolVersion(uint256 indexed previousProtocolVersion, uint256 indexed newProtocolVersion);

     |  // @audit-issue Missing NatSpec @param for parameter 1 bytes32 previousBytecodeHash
  49 |  event NewL2BootloaderBytecodeHash(bytes32 indexed previousBytecodeHash, bytes32 indexed newBytecodeHash);

     |  // @audit-issue Missing NatSpec @param for parameter 2 bytes32 newBytecodeHash
  49 |  event NewL2BootloaderBytecodeHash(bytes32 indexed previousBytecodeHash, bytes32 indexed newBytecodeHash);

     |  // @audit-issue Missing NatSpec @param for parameter 1 bytes32 previousBytecodeHash
  52 |  event NewL2DefaultAccountBytecodeHash(bytes32 indexed previousBytecodeHash, bytes32 indexed newBytecodeHash);

     |  // @audit-issue Missing NatSpec @param for parameter 2 bytes32 newBytecodeHash
  52 |  event NewL2DefaultAccountBytecodeHash(bytes32 indexed previousBytecodeHash, bytes32 indexed newBytecodeHash);

     |  // @audit-issue Missing NatSpec @param for parameter 1 address oldVerifier
  55 |  event NewVerifier(address indexed oldVerifier, address indexed newVerifier);

     |  // @audit-issue Missing NatSpec @param for parameter 2 address newVerifier
  55 |  event NewVerifier(address indexed oldVerifier, address indexed newVerifier);

     |  // @audit-issue Missing NatSpec @param for parameter 1 struct VerifierParams oldVerifierParams
  58 |  event NewVerifierParams(VerifierParams oldVerifierParams, VerifierParams newVerifierParams);

     |  // @audit-issue Missing NatSpec @param for parameter 2 struct VerifierParams newVerifierParams
  58 |  event NewVerifierParams(VerifierParams oldVerifierParams, VerifierParams newVerifierParams);

     |  // @audit-issue Missing NatSpec @param for parameter 1 uint256 newProtocolVersion
  61 |  event UpgradeComplete(uint256 indexed newProtocolVersion, bytes32 indexed l2UpgradeTxHash, ProposedUpgrade upgrade);

     |  // @audit-issue Missing NatSpec @param for parameter 2 bytes32 l2UpgradeTxHash
  61 |  event UpgradeComplete(uint256 indexed newProtocolVersion, bytes32 indexed l2UpgradeTxHash, ProposedUpgrade upgrade);

     |  // @audit-issue Missing NatSpec @param for parameter 3 struct ProposedUpgrade upgrade
  61 |  event UpgradeComplete(uint256 indexed newProtocolVersion, bytes32 indexed l2UpgradeTxHash, ProposedUpgrade upgrade);
```
GitHub: [46](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L46), [46](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L46), [49](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L49), [49](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L49), [52](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L52), [52](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L52), [55](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L55), [55](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L55), [58](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L58), [58](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L58), [61](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L61), [61](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L61), [61](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L61)


```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol

     |  // @audit-issue Missing NatSpec @param for parameter 1 struct Diamond.FacetCut[] facetCuts
  24 |  event DiamondCut(FacetCut[] facetCuts, address initAddress, bytes initCalldata);

     |  // @audit-issue Missing NatSpec @param for parameter 2 address initAddress
  24 |  event DiamondCut(FacetCut[] facetCuts, address initAddress, bytes initCalldata);

     |  // @audit-issue Missing NatSpec @param for parameter 3 bytes initCalldata
  24 |  event DiamondCut(FacetCut[] facetCuts, address initAddress, bytes initCalldata);
```
GitHub: [24](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L24), [24](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L24), [24](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L24)


```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol

     |  // @audit-issue Missing NatSpec @param for parameter 1 bytes32 l2DepositTxHash
  13 |  bytes32 indexed l2DepositTxHash,

     |  // @audit-issue Missing NatSpec @param for parameter 2 address from
  14 |  address indexed from,

     |  // @audit-issue Missing NatSpec @param for parameter 3 address to
  15 |  address indexed to,

     |  // @audit-issue Missing NatSpec @param for parameter 4 address l1Token
  16 |  address l1Token,

     |  // @audit-issue Missing NatSpec @param for parameter 5 uint256 amount
  17 |  uint256 amount

     |  // @audit-issue Missing NatSpec @param for parameter 1 address to
  20 |  event WithdrawalFinalized(address indexed to, address indexed l1Token, uint256 amount);

     |  // @audit-issue Missing NatSpec @param for parameter 2 address l1Token
  20 |  event WithdrawalFinalized(address indexed to, address indexed l1Token, uint256 amount);

     |  // @audit-issue Missing NatSpec @param for parameter 3 uint256 amount
  20 |  event WithdrawalFinalized(address indexed to, address indexed l1Token, uint256 amount);

     |  // @audit-issue Missing NatSpec @param for parameter 1 address to
  22 |  event ClaimedFailedDeposit(address indexed to, address indexed l1Token, uint256 amount);

     |  // @audit-issue Missing NatSpec @param for parameter 2 address l1Token
  22 |  event ClaimedFailedDeposit(address indexed to, address indexed l1Token, uint256 amount);

     |  // @audit-issue Missing NatSpec @param for parameter 3 uint256 amount
  22 |  event ClaimedFailedDeposit(address indexed to, address indexed l1Token, uint256 amount);
```
GitHub: [13](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L13), [14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L14), [15](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L15), [16](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L16), [17](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L17), [20](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L20), [20](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L20), [20](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L20), [22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L22), [22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L22), [22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L22)


```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol

     |  // @audit-issue Missing NatSpec @param for parameter 1 uint256 chainId
  14 |  uint256 indexed chainId,

     |  // @audit-issue Missing NatSpec @param for parameter 2 bytes32 l2DepositTxHash
  15 |  bytes32 indexed l2DepositTxHash,

     |  // @audit-issue Missing NatSpec @param for parameter 3 address from
  16 |  address indexed from,

     |  // @audit-issue Missing NatSpec @param for parameter 4 address to
  17 |  address to,

     |  // @audit-issue Missing NatSpec @param for parameter 5 address l1Token
  18 |  address l1Token,

     |  // @audit-issue Missing NatSpec @param for parameter 6 uint256 amount
  19 |  uint256 amount

     |  // @audit-issue Missing NatSpec @param for parameter 1 uint256 chainId
  23 |  uint256 indexed chainId,

     |  // @audit-issue Missing NatSpec @param for parameter 2 bytes32 txDataHash
  24 |  bytes32 indexed txDataHash,

     |  // @audit-issue Missing NatSpec @param for parameter 3 address from
  25 |  address indexed from,

     |  // @audit-issue Missing NatSpec @param for parameter 4 address to
  26 |  address to,

     |  // @audit-issue Missing NatSpec @param for parameter 5 address l1Token
  27 |  address l1Token,

     |  // @audit-issue Missing NatSpec @param for parameter 6 uint256 amount
  28 |  uint256 amount

     |  // @audit-issue Missing NatSpec @param for parameter 1 uint256 chainId
  32 |  uint256 indexed chainId,

     |  // @audit-issue Missing NatSpec @param for parameter 2 address from
  33 |  address indexed from,

     |  // @audit-issue Missing NatSpec @param for parameter 3 address l1Token
  34 |  address l1Token,

     |  // @audit-issue Missing NatSpec @param for parameter 4 uint256 amount
  35 |  uint256 amount

     |  // @audit-issue Missing NatSpec @param for parameter 1 uint256 chainId
  39 |  uint256 indexed chainId,

     |  // @audit-issue Missing NatSpec @param for parameter 2 bytes32 txDataHash
  40 |  bytes32 indexed txDataHash,

     |  // @audit-issue Missing NatSpec @param for parameter 3 bytes32 l2DepositTxHash
  41 |  bytes32 indexed l2DepositTxHash

     |  // @audit-issue Missing NatSpec @param for parameter 1 uint256 chainId
  45 |  uint256 indexed chainId,

     |  // @audit-issue Missing NatSpec @param for parameter 2 address to
  46 |  address indexed to,

     |  // @audit-issue Missing NatSpec @param for parameter 3 address l1Token
  47 |  address indexed l1Token,

     |  // @audit-issue Missing NatSpec @param for parameter 4 uint256 amount
  48 |  uint256 amount

     |  // @audit-issue Missing NatSpec @param for parameter 1 uint256 chainId
  52 |  uint256 indexed chainId,

     |  // @audit-issue Missing NatSpec @param for parameter 2 address to
  53 |  address indexed to,

     |  // @audit-issue Missing NatSpec @param for parameter 3 address l1Token
  54 |  address indexed l1Token,

     |  // @audit-issue Missing NatSpec @param for parameter 4 uint256 amount
  55 |  uint256 amount
```
GitHub: [14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L14), [15](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L15), [16](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L16), [17](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L17), [18](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L18), [19](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L19), [23](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L23), [24](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L24), [25](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L25), [26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L26), [27](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L27), [28](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L28), [32](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L32), [33](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L33), [34](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L34), [35](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L35), [39](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L39), [40](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L40), [41](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L41), [45](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L45), [46](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L46), [47](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L47), [48](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L48), [52](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L52), [53](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L53), [54](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L54), [55](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L55)


```solidity
File: code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol

     |  // @audit-issue Missing NatSpec @param for parameter 1 address oldPendingAdmin
  45 |  event NewPendingAdmin(address indexed oldPendingAdmin, address indexed newPendingAdmin);

     |  // @audit-issue Missing NatSpec @param for parameter 2 address newPendingAdmin
  45 |  event NewPendingAdmin(address indexed oldPendingAdmin, address indexed newPendingAdmin);

     |  // @audit-issue Missing NatSpec @param for parameter 1 address oldAdmin
  48 |  event NewAdmin(address indexed oldAdmin, address indexed newAdmin);

     |  // @audit-issue Missing NatSpec @param for parameter 2 address newAdmin
  48 |  event NewAdmin(address indexed oldAdmin, address indexed newAdmin);

     |  // @audit-issue Missing NatSpec @param for parameter 1 uint256 chainId
 133 |  event NewChain(uint256 indexed chainId, address stateTransitionManager, address indexed chainGovernance);

     |  // @audit-issue Missing NatSpec @param for parameter 2 address stateTransitionManager
 133 |  event NewChain(uint256 indexed chainId, address stateTransitionManager, address indexed chainGovernance);

     |  // @audit-issue Missing NatSpec @param for parameter 3 address chainGovernance
 133 |  event NewChain(uint256 indexed chainId, address stateTransitionManager, address indexed chainGovernance);
```
GitHub: [45](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L45), [45](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L45), [48](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L48), [48](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L48), [133](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L133), [133](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L133), [133](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L133)


```solidity
File: code/contracts/ethereum/contracts/governance/IGovernance.sol

     |  // @audit-issue Missing NatSpec @param for parameter 1 bytes32 _id
  68 |  event TransparentOperationScheduled(bytes32 indexed _id, uint256 delay, Operation _operation);

     |  // @audit-issue Missing NatSpec @param for parameter 2 uint256 delay
  68 |  event TransparentOperationScheduled(bytes32 indexed _id, uint256 delay, Operation _operation);

     |  // @audit-issue Missing NatSpec @param for parameter 3 struct IGovernance.Operation _operation
  68 |  event TransparentOperationScheduled(bytes32 indexed _id, uint256 delay, Operation _operation);

     |  // @audit-issue Missing NatSpec @param for parameter 1 bytes32 _id
  71 |  event ShadowOperationScheduled(bytes32 indexed _id, uint256 delay);

     |  // @audit-issue Missing NatSpec @param for parameter 2 uint256 delay
  71 |  event ShadowOperationScheduled(bytes32 indexed _id, uint256 delay);

     |  // @audit-issue Missing NatSpec @param for parameter 1 bytes32 _id
  74 |  event OperationExecuted(bytes32 indexed _id);

     |  // @audit-issue Missing NatSpec @param for parameter 1 address _securityCouncilBefore
  77 |  event ChangeSecurityCouncil(address _securityCouncilBefore, address _securityCouncilAfter);

     |  // @audit-issue Missing NatSpec @param for parameter 2 address _securityCouncilAfter
  77 |  event ChangeSecurityCouncil(address _securityCouncilBefore, address _securityCouncilAfter);

     |  // @audit-issue Missing NatSpec @param for parameter 1 uint256 _delayBefore
  80 |  event ChangeMinDelay(uint256 _delayBefore, uint256 _delayAfter);

     |  // @audit-issue Missing NatSpec @param for parameter 2 uint256 _delayAfter
  80 |  event ChangeMinDelay(uint256 _delayBefore, uint256 _delayAfter);

     |  // @audit-issue Missing NatSpec @param for parameter 1 bytes32 _id
  83 |  event OperationCancelled(bytes32 indexed _id);
```
GitHub: [68](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L68), [68](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L68), [68](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L68), [71](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L71), [71](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L71), [74](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L74), [77](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L77), [77](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L77), [80](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L80), [80](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L80), [83](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L83)


```solidity
File: code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol

     |  // @audit-issue Missing NatSpec @param for parameter 1 uint256 _chainId
  28 |  event StateTransitionNewChain(uint256 indexed _chainId, address indexed _stateTransitionContract);

     |  // @audit-issue Missing NatSpec @param for parameter 2 address _stateTransitionContract
  28 |  event StateTransitionNewChain(uint256 indexed _chainId, address indexed _stateTransitionContract);

     |  // @audit-issue Missing NatSpec @param for parameter 1 address _stateTransitionChain
  31 |  address indexed _stateTransitionChain,

     |  // @audit-issue Missing NatSpec @param for parameter 2 struct L2CanonicalTransaction _l2Transaction
  32 |  L2CanonicalTransaction _l2Transaction,

     |  // @audit-issue Missing NatSpec @param for parameter 3 uint256 _protocolVersion
  33 |  uint256 indexed _protocolVersion

     |  // @audit-issue Missing NatSpec @param for parameter 1 address oldPendingAdmin
  38 |  event NewPendingAdmin(address indexed oldPendingAdmin, address indexed newPendingAdmin);

     |  // @audit-issue Missing NatSpec @param for parameter 2 address newPendingAdmin
  38 |  event NewPendingAdmin(address indexed oldPendingAdmin, address indexed newPendingAdmin);

     |  // @audit-issue Missing NatSpec @param for parameter 1 address oldAdmin
  41 |  event NewAdmin(address indexed oldAdmin, address indexed newAdmin);

     |  // @audit-issue Missing NatSpec @param for parameter 2 address newAdmin
  41 |  event NewAdmin(address indexed oldAdmin, address indexed newAdmin);
```
GitHub: [28](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L28), [28](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L28), [31](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L31), [32](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L32), [33](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L33), [38](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L38), [38](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L38), [41](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L41), [41](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L41)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol

     |  // @audit-issue Missing NatSpec @param for parameter 1 bool isPorterAvailable
  61 |  event IsPorterAvailableStatusUpdate(bool isPorterAvailable);

     |  // @audit-issue Missing NatSpec @param for parameter 1 address validatorAddress
  64 |  event ValidatorStatusUpdate(address indexed validatorAddress, bool isActive);

     |  // @audit-issue Missing NatSpec @param for parameter 2 bool isActive
  64 |  event ValidatorStatusUpdate(address indexed validatorAddress, bool isActive);

     |  // @audit-issue Missing NatSpec @param for parameter 1 address oldPendingAdmin
  68 |  event NewPendingAdmin(address indexed oldPendingAdmin, address indexed newPendingAdmin);

     |  // @audit-issue Missing NatSpec @param for parameter 2 address newPendingAdmin
  68 |  event NewPendingAdmin(address indexed oldPendingAdmin, address indexed newPendingAdmin);

     |  // @audit-issue Missing NatSpec @param for parameter 1 address oldAdmin
  71 |  event NewAdmin(address indexed oldAdmin, address indexed newAdmin);

     |  // @audit-issue Missing NatSpec @param for parameter 2 address newAdmin
  71 |  event NewAdmin(address indexed oldAdmin, address indexed newAdmin);

     |  // @audit-issue Missing NatSpec @param for parameter 1 uint256 oldPriorityTxMaxGasLimit
  74 |  event NewPriorityTxMaxGasLimit(uint256 oldPriorityTxMaxGasLimit, uint256 newPriorityTxMaxGasLimit);

     |  // @audit-issue Missing NatSpec @param for parameter 2 uint256 newPriorityTxMaxGasLimit
  74 |  event NewPriorityTxMaxGasLimit(uint256 oldPriorityTxMaxGasLimit, uint256 newPriorityTxMaxGasLimit);

     |  // @audit-issue Missing NatSpec @param for parameter 1 struct FeeParams oldFeeParams
  77 |  event NewFeeParams(FeeParams oldFeeParams, FeeParams newFeeParams);

     |  // @audit-issue Missing NatSpec @param for parameter 2 struct FeeParams newFeeParams
  77 |  event NewFeeParams(FeeParams oldFeeParams, FeeParams newFeeParams);

     |  // @audit-issue Missing NatSpec @param for parameter 1 enum PubdataPricingMode validiumMode
  80 |  event ValidiumModeStatusUpdate(PubdataPricingMode validiumMode);

     |  // @audit-issue Missing NatSpec @param for parameter 1 uint128 oldNominator
  84 |  uint128 oldNominator,
```
GitHub: [61](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L61), [64](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L64), [64](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L64), [68](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L68), [68](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L68), [71](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L71), [71](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L71), [74](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L74), [74](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L74), [77](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L77), [77](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L77), [80](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L80), [84](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L84)


## [N-65] NatSpec: Event definitions should have NatSpec descriptions

e.g. `@dev` or `@notice`, and it must appear above the event definition braces in order to be identified by the compiler as NatSpec.

*Instances: 33*

```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol

     |  // @audit-issue Add NatSpec event documentation
  24 |  event DiamondCut(FacetCut[] facetCuts, address initAddress, bytes initCalldata);
```
GitHub: [24](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L24)


```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol

     |  // @audit-issue Add NatSpec event documentation
  12 |  event DepositInitiated(
  13 |      bytes32 indexed l2DepositTxHash,
  14 |      address indexed from,
  15 |      address indexed to,
  16 |      address l1Token,
  17 |      uint256 amount
  18 |  );

     |  // @audit-issue Add NatSpec event documentation
  20 |  event WithdrawalFinalized(address indexed to, address indexed l1Token, uint256 amount);

     |  // @audit-issue Add NatSpec event documentation
  22 |  event ClaimedFailedDeposit(address indexed to, address indexed l1Token, uint256 amount);
```
GitHub: [12-18](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L12-L18), [20](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L20), [22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L22)


```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol

     |  // @audit-issue Add NatSpec event documentation
  13 |  event LegacyDepositInitiated(
  14 |      uint256 indexed chainId,
  15 |      bytes32 indexed l2DepositTxHash,
  16 |      address indexed from,
  17 |      address to,
  18 |      address l1Token,
  19 |      uint256 amount
  20 |  );

     |  // @audit-issue Add NatSpec event documentation
  22 |  event BridgehubDepositInitiated(
  23 |      uint256 indexed chainId,
  24 |      bytes32 indexed txDataHash,
  25 |      address indexed from,
  26 |      address to,
  27 |      address l1Token,
  28 |      uint256 amount
  29 |  );

     |  // @audit-issue Add NatSpec event documentation
  31 |  event BridgehubDepositBaseTokenInitiated(
  32 |      uint256 indexed chainId,
  33 |      address indexed from,
  34 |      address l1Token,
  35 |      uint256 amount
  36 |  );

     |  // @audit-issue Add NatSpec event documentation
  38 |  event BridgehubDepositFinalized(
  39 |      uint256 indexed chainId,
  40 |      bytes32 indexed txDataHash,
  41 |      bytes32 indexed l2DepositTxHash
  42 |  );

     |  // @audit-issue Add NatSpec event documentation
  44 |  event WithdrawalFinalizedSharedBridge(
  45 |      uint256 indexed chainId,
  46 |      address indexed to,
  47 |      address indexed l1Token,
  48 |      uint256 amount
  49 |  );

     |  // @audit-issue Add NatSpec event documentation
  51 |  event ClaimedFailedDepositSharedBridge(
  52 |      uint256 indexed chainId,
  53 |      address indexed to,
  54 |      address indexed l1Token,
  55 |      uint256 amount
  56 |  );
```
GitHub: [13-20](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L13-L20), [22-29](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L22-L29), [31-36](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L31-L36), [38-42](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L38-L42), [44-49](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L44-L49), [51-56](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L51-L56)


```solidity
File: code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol

     |  // @audit-issue Add NatSpec event documentation
 133 |  event NewChain(uint256 indexed chainId, address stateTransitionManager, address indexed chainGovernance);
```
GitHub: [133](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L133)


```solidity
File: code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol

     |  // @audit-issue Add NatSpec event documentation
  28 |  event StateTransitionNewChain(uint256 indexed _chainId, address indexed _stateTransitionContract);

     |  // @audit-issue Add NatSpec event documentation
  30 |  event SetChainIdUpgrade(
  31 |      address indexed _stateTransitionChain,
  32 |      L2CanonicalTransaction _l2Transaction,
  33 |      uint256 indexed _protocolVersion
  34 |  );
```
GitHub: [28](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L28), [30-34](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L30-L34)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol

     |  // @audit-issue Add NatSpec event documentation
  17 |  event ProposeTransparentUpgrade(
  18 |      Diamond.DiamondCutData diamondCut,
  19 |      uint256 indexed proposalId,
  20 |      bytes32 proposalSalt
  21 |  );
```
GitHub: [17-21](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol#L17-L21)


```solidity
File: code/system-contracts/contracts/interfaces/IBaseToken.sol

     |  // @audit-issue Add NatSpec event documentation
  24 |  event Mint(address indexed account, uint256 amount);

     |  // @audit-issue Add NatSpec event documentation
  26 |  event Transfer(address indexed from, address indexed to, uint256 value);

     |  // @audit-issue Add NatSpec event documentation
  28 |  event Withdrawal(address indexed _l2Sender, address indexed _l1Receiver, uint256 _amount);

     |  // @audit-issue Add NatSpec event documentation
  30 |  event WithdrawalWithMessage(
  31 |      address indexed _l2Sender,
  32 |      address indexed _l1Receiver,
  33 |      uint256 _amount,
  34 |      bytes _additionalData
  35 |  );
```
GitHub: [24](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBaseToken.sol#L24), [26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBaseToken.sol#L26), [28](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBaseToken.sol#L28), [30-35](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBaseToken.sol#L30-L35)


```solidity
File: code/system-contracts/contracts/interfaces/IContractDeployer.sol

     |  // @audit-issue Add NatSpec event documentation
  33 |  event ContractDeployed(
  34 |      address indexed deployerAddress,
  35 |      bytes32 indexed bytecodeHash,
  36 |      address indexed contractAddress
  37 |  );

     |  // @audit-issue Add NatSpec event documentation
  39 |  event AccountNonceOrderingUpdated(address indexed accountAddress, AccountNonceOrdering nonceOrdering);

     |  // @audit-issue Add NatSpec event documentation
  41 |  event AccountVersionUpdated(address indexed accountAddress, AccountAbstractionVersion aaVersion);
```
GitHub: [33-37](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L33-L37), [39](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L39), [41](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L41)


```solidity
File: code/system-contracts/contracts/interfaces/IKnownCodesStorage.sol

     |  // @audit-issue Add NatSpec event documentation
  12 |  event MarkedAsKnown(bytes32 indexed bytecodeHash, bool indexed sendBytecodeToL1);
```
GitHub: [12](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IKnownCodesStorage.sol#L12)


```solidity
File: code/system-contracts/contracts/interfaces/IL1Messenger.sol

     |  // @audit-issue Add NatSpec event documentation
  43 |  event L1MessageSent(address indexed _sender, bytes32 indexed _hash, bytes _message);

     |  // @audit-issue Add NatSpec event documentation
  45 |  event L2ToL1LogSent(L2ToL1Log _l2log);

     |  // @audit-issue Add NatSpec event documentation
  47 |  event BytecodeL1PublicationRequested(bytes32 _bytecodeHash);
```
GitHub: [43](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL1Messenger.sol#L43), [45](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL1Messenger.sol#L45), [47](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL1Messenger.sol#L47)


```solidity
File: code/system-contracts/contracts/interfaces/IL2StandardToken.sol

     |  // @audit-issue Add NatSpec event documentation
   6 |  event BridgeMint(address indexed _account, uint256 _amount);

     |  // @audit-issue Add NatSpec event documentation
   8 |  event BridgeBurn(address indexed _account, uint256 _amount);
```
GitHub: [6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL2StandardToken.sol#L6), [8](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL2StandardToken.sol#L8)


```solidity
File: code/system-contracts/contracts/interfaces/INonceHolder.sol

     |  // @audit-issue Add NatSpec event documentation
  14 |  event ValueSetUnderNonce(address indexed accountAddress, uint256 indexed key, uint256 value);
```
GitHub: [14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/INonceHolder.sol#L14)


```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol

     |  // @audit-issue Add NatSpec event documentation
   7 |  event FinalizeDeposit(
   8 |      address indexed l1Sender,
   9 |      address indexed l2Receiver,
  10 |      address indexed l2Token,
  11 |      uint256 amount
  12 |  );

     |  // @audit-issue Add NatSpec event documentation
  14 |  event WithdrawalInitiated(
  15 |      address indexed l2Sender,
  16 |      address indexed l1Receiver,
  17 |      address indexed l2Token,
  18 |      uint256 amount
  19 |  );
```
GitHub: [7-12](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol#L7-L12), [14-19](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol#L14-L19)


```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol

     |  // @audit-issue Add NatSpec event documentation
   6 |  event BridgeInitialize(address indexed l1Token, string name, string symbol, uint8 decimals);

     |  // @audit-issue Add NatSpec event documentation
   8 |  event BridgeMint(address indexed _account, uint256 _amount);

     |  // @audit-issue Add NatSpec event documentation
  10 |  event BridgeBurn(address indexed _account, uint256 _amount);
```
GitHub: [6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol#L6), [8](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol#L8), [10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol#L10)


## [N-66] NatSpec: Event definitions should have `@dev` tags

`@dev` is used to explain to developers what the event does, as per [NatSpec Format](https://docs.soliditylang.org/en/latest/natspec-format.html#tags).

*Instances: 63*

```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

     |  // @audit-issue Add NatSpec @dev
  29 |  event NewExecutionDelay(uint256 _newExecutionDelay);

     |  // @audit-issue Add NatSpec @dev
  32 |  event ValidatorAdded(uint256 _chainId, address _addedValidator);

     |  // @audit-issue Add NatSpec @dev
  35 |  event ValidatorRemoved(uint256 _chainId, address _removedValidator);
```
GitHub: [29](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L29), [32](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L32), [35](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L35)


```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol

     |  // @audit-issue Add NatSpec @dev
  46 |  event NewProtocolVersion(uint256 indexed previousProtocolVersion, uint256 indexed newProtocolVersion);

     |  // @audit-issue Add NatSpec @dev
  49 |  event NewL2BootloaderBytecodeHash(bytes32 indexed previousBytecodeHash, bytes32 indexed newBytecodeHash);

     |  // @audit-issue Add NatSpec @dev
  52 |  event NewL2DefaultAccountBytecodeHash(bytes32 indexed previousBytecodeHash, bytes32 indexed newBytecodeHash);

     |  // @audit-issue Add NatSpec @dev
  55 |  event NewVerifier(address indexed oldVerifier, address indexed newVerifier);

     |  // @audit-issue Add NatSpec @dev
  58 |  event NewVerifierParams(VerifierParams oldVerifierParams, VerifierParams newVerifierParams);

     |  // @audit-issue Add NatSpec @dev
  61 |  event UpgradeComplete(uint256 indexed newProtocolVersion, bytes32 indexed l2UpgradeTxHash, ProposedUpgrade upgrade);
```
GitHub: [46](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L46), [49](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L49), [52](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L52), [55](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L55), [58](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L58), [61](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L61)


```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol

     |  // @audit-issue Add NatSpec @dev
  24 |  event DiamondCut(FacetCut[] facetCuts, address initAddress, bytes initCalldata);
```
GitHub: [24](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L24)


```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol

     |  // @audit-issue Add NatSpec @dev
  12 |  event DepositInitiated(

     |  // @audit-issue Add NatSpec @dev
  20 |  event WithdrawalFinalized(address indexed to, address indexed l1Token, uint256 amount);

     |  // @audit-issue Add NatSpec @dev
  22 |  event ClaimedFailedDeposit(address indexed to, address indexed l1Token, uint256 amount);
```
GitHub: [12](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L12), [20](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L20), [22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L22)


```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol

     |  // @audit-issue Add NatSpec @dev
  13 |  event LegacyDepositInitiated(

     |  // @audit-issue Add NatSpec @dev
  22 |  event BridgehubDepositInitiated(

     |  // @audit-issue Add NatSpec @dev
  31 |  event BridgehubDepositBaseTokenInitiated(

     |  // @audit-issue Add NatSpec @dev
  38 |  event BridgehubDepositFinalized(

     |  // @audit-issue Add NatSpec @dev
  44 |  event WithdrawalFinalizedSharedBridge(

     |  // @audit-issue Add NatSpec @dev
  51 |  event ClaimedFailedDepositSharedBridge(
```
GitHub: [13](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L13), [22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L22), [31](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L31), [38](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L38), [44](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L44), [51](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L51)


```solidity
File: code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol

     |  // @audit-issue Add NatSpec @dev
  48 |  event NewAdmin(address indexed oldAdmin, address indexed newAdmin);

     |  // @audit-issue Add NatSpec @dev
 133 |  event NewChain(uint256 indexed chainId, address stateTransitionManager, address indexed chainGovernance);
```
GitHub: [48](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L48), [133](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L133)


```solidity
File: code/contracts/ethereum/contracts/governance/IGovernance.sol

     |  // @audit-issue Add NatSpec @dev
  68 |  event TransparentOperationScheduled(bytes32 indexed _id, uint256 delay, Operation _operation);

     |  // @audit-issue Add NatSpec @dev
  71 |  event ShadowOperationScheduled(bytes32 indexed _id, uint256 delay);

     |  // @audit-issue Add NatSpec @dev
  74 |  event OperationExecuted(bytes32 indexed _id);

     |  // @audit-issue Add NatSpec @dev
  77 |  event ChangeSecurityCouncil(address _securityCouncilBefore, address _securityCouncilAfter);

     |  // @audit-issue Add NatSpec @dev
  80 |  event ChangeMinDelay(uint256 _delayBefore, uint256 _delayAfter);

     |  // @audit-issue Add NatSpec @dev
  83 |  event OperationCancelled(bytes32 indexed _id);
```
GitHub: [68](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L68), [71](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L71), [74](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L74), [77](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L77), [80](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L80), [83](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L83)


```solidity
File: code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol

     |  // @audit-issue Add NatSpec @dev
  28 |  event StateTransitionNewChain(uint256 indexed _chainId, address indexed _stateTransitionContract);

     |  // @audit-issue Add NatSpec @dev
  30 |  event SetChainIdUpgrade(

     |  // @audit-issue Add NatSpec @dev
  41 |  event NewAdmin(address indexed oldAdmin, address indexed newAdmin);
```
GitHub: [28](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L28), [30](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L30), [41](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L41)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol

     |  // @audit-issue Add NatSpec @dev
  61 |  event IsPorterAvailableStatusUpdate(bool isPorterAvailable);

     |  // @audit-issue Add NatSpec @dev
  64 |  event ValidatorStatusUpdate(address indexed validatorAddress, bool isActive);

     |  // @audit-issue Add NatSpec @dev
  71 |  event NewAdmin(address indexed oldAdmin, address indexed newAdmin);

     |  // @audit-issue Add NatSpec @dev
  74 |  event NewPriorityTxMaxGasLimit(uint256 oldPriorityTxMaxGasLimit, uint256 newPriorityTxMaxGasLimit);

     |  // @audit-issue Add NatSpec @dev
  77 |  event NewFeeParams(FeeParams oldFeeParams, FeeParams newFeeParams);

     |  // @audit-issue Add NatSpec @dev
  80 |  event ValidiumModeStatusUpdate(PubdataPricingMode validiumMode);

     |  // @audit-issue Add NatSpec @dev
  83 |  event NewBaseTokenMultiplier(

     |  // @audit-issue Add NatSpec @dev
  91 |  event ExecuteUpgrade(Diamond.DiamondCutData diamondCut);

     |  // @audit-issue Add NatSpec @dev
  94 |  event Freeze();

     |  // @audit-issue Add NatSpec @dev
  97 |  event Unfreeze();
```
GitHub: [61](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L61), [64](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L64), [71](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L71), [74](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L74), [77](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L77), [80](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L80), [83](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L83), [91](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L91), [94](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L94), [97](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L97)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol

     |  // @audit-issue Add NatSpec @dev
 123 |  event NewPriorityRequest(

     |  // @audit-issue Add NatSpec @dev
 134 |  event EthWithdrawalFinalized(address indexed to, uint256 amount);
```
GitHub: [123](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L123), [134](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L134)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol

     |  // @audit-issue Add NatSpec @dev
  17 |  event ProposeTransparentUpgrade(
```
GitHub: [17](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol#L17)


```solidity
File: code/contracts/ethereum/contracts/upgrades/Upgrade_v1_4_1.sol

     |  // @audit-issue Add NatSpec @dev
  16 |  event NewFeeParams(FeeParams oldFeeParams, FeeParams newFeeParams);
```
GitHub: [16](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/Upgrade_v1_4_1.sol#L16)


```solidity
File: code/system-contracts/contracts/interfaces/IBaseToken.sol

     |  // @audit-issue Add NatSpec @dev
  24 |  event Mint(address indexed account, uint256 amount);

     |  // @audit-issue Add NatSpec @dev
  26 |  event Transfer(address indexed from, address indexed to, uint256 value);

     |  // @audit-issue Add NatSpec @dev
  28 |  event Withdrawal(address indexed _l2Sender, address indexed _l1Receiver, uint256 _amount);

     |  // @audit-issue Add NatSpec @dev
  30 |  event WithdrawalWithMessage(
```
GitHub: [24](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBaseToken.sol#L24), [26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBaseToken.sol#L26), [28](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBaseToken.sol#L28), [30](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBaseToken.sol#L30)


```solidity
File: code/system-contracts/contracts/interfaces/IContractDeployer.sol

     |  // @audit-issue Add NatSpec @dev
  33 |  event ContractDeployed(

     |  // @audit-issue Add NatSpec @dev
  39 |  event AccountNonceOrderingUpdated(address indexed accountAddress, AccountNonceOrdering nonceOrdering);

     |  // @audit-issue Add NatSpec @dev
  41 |  event AccountVersionUpdated(address indexed accountAddress, AccountAbstractionVersion aaVersion);
```
GitHub: [33](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L33), [39](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L39), [41](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L41)


```solidity
File: code/system-contracts/contracts/interfaces/IKnownCodesStorage.sol

     |  // @audit-issue Add NatSpec @dev
  12 |  event MarkedAsKnown(bytes32 indexed bytecodeHash, bool indexed sendBytecodeToL1);
```
GitHub: [12](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IKnownCodesStorage.sol#L12)


```solidity
File: code/system-contracts/contracts/interfaces/IL1Messenger.sol

     |  // @audit-issue Add NatSpec @dev
  43 |  event L1MessageSent(address indexed _sender, bytes32 indexed _hash, bytes _message);

     |  // @audit-issue Add NatSpec @dev
  45 |  event L2ToL1LogSent(L2ToL1Log _l2log);

     |  // @audit-issue Add NatSpec @dev
  47 |  event BytecodeL1PublicationRequested(bytes32 _bytecodeHash);
```
GitHub: [43](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL1Messenger.sol#L43), [45](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL1Messenger.sol#L45), [47](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL1Messenger.sol#L47)


```solidity
File: code/system-contracts/contracts/interfaces/IL2StandardToken.sol

     |  // @audit-issue Add NatSpec @dev
   6 |  event BridgeMint(address indexed _account, uint256 _amount);

     |  // @audit-issue Add NatSpec @dev
   8 |  event BridgeBurn(address indexed _account, uint256 _amount);
```
GitHub: [6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL2StandardToken.sol#L6), [8](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL2StandardToken.sol#L8)


```solidity
File: code/system-contracts/contracts/interfaces/INonceHolder.sol

     |  // @audit-issue Add NatSpec @dev
  14 |  event ValueSetUnderNonce(address indexed accountAddress, uint256 indexed key, uint256 value);
```
GitHub: [14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/INonceHolder.sol#L14)


```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol

     |  // @audit-issue Add NatSpec @dev
   7 |  event FinalizeDeposit(

     |  // @audit-issue Add NatSpec @dev
  14 |  event WithdrawalInitiated(
```
GitHub: [7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol#L7), [14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol#L14)


```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol

     |  // @audit-issue Add NatSpec @dev
   6 |  event BridgeInitialize(address indexed l1Token, string name, string symbol, uint8 decimals);

     |  // @audit-issue Add NatSpec @dev
   8 |  event BridgeMint(address indexed _account, uint256 _amount);

     |  // @audit-issue Add NatSpec @dev
  10 |  event BridgeBurn(address indexed _account, uint256 _amount);
```
GitHub: [6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol#L6), [8](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol#L8), [10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol#L10)


## [N-67] NatSpec: Event definitions should have `@notice` tags

`@notice` is used to explain to end users what the event does, and the compiler interprets `///` or `/**` comments as this tag if one wasn't explicitly provided.

*Instances: 35*

```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol

     |  // @audit-issue Add NatSpec @notice
  24 |  event DiamondCut(FacetCut[] facetCuts, address initAddress, bytes initCalldata);
```
GitHub: [24](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L24)


```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol

     |  // @audit-issue Add NatSpec @notice
  12 |  event DepositInitiated(

     |  // @audit-issue Add NatSpec @notice
  20 |  event WithdrawalFinalized(address indexed to, address indexed l1Token, uint256 amount);

     |  // @audit-issue Add NatSpec @notice
  22 |  event ClaimedFailedDeposit(address indexed to, address indexed l1Token, uint256 amount);
```
GitHub: [12](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L12), [20](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L20), [22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L22)


```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol

     |  // @audit-issue Add NatSpec @notice
  13 |  event LegacyDepositInitiated(

     |  // @audit-issue Add NatSpec @notice
  22 |  event BridgehubDepositInitiated(

     |  // @audit-issue Add NatSpec @notice
  31 |  event BridgehubDepositBaseTokenInitiated(

     |  // @audit-issue Add NatSpec @notice
  38 |  event BridgehubDepositFinalized(

     |  // @audit-issue Add NatSpec @notice
  44 |  event WithdrawalFinalizedSharedBridge(

     |  // @audit-issue Add NatSpec @notice
  51 |  event ClaimedFailedDepositSharedBridge(
```
GitHub: [13](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L13), [22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L22), [31](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L31), [38](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L38), [44](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L44), [51](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L51)


```solidity
File: code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol

     |  // @audit-issue Add NatSpec @notice
 133 |  event NewChain(uint256 indexed chainId, address stateTransitionManager, address indexed chainGovernance);
```
GitHub: [133](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L133)


```solidity
File: code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol

     |  // @audit-issue Add NatSpec @notice
  28 |  event StateTransitionNewChain(uint256 indexed _chainId, address indexed _stateTransitionContract);

     |  // @audit-issue Add NatSpec @notice
  30 |  event SetChainIdUpgrade(
```
GitHub: [28](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L28), [30](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L30)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol

     |  // @audit-issue Add NatSpec @notice
  17 |  event ProposeTransparentUpgrade(
```
GitHub: [17](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol#L17)


```solidity
File: code/contracts/ethereum/contracts/upgrades/Upgrade_v1_4_1.sol

     |  // @audit-issue Add NatSpec @notice
  16 |  event NewFeeParams(FeeParams oldFeeParams, FeeParams newFeeParams);
```
GitHub: [16](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/Upgrade_v1_4_1.sol#L16)


```solidity
File: code/system-contracts/contracts/interfaces/IBaseToken.sol

     |  // @audit-issue Add NatSpec @notice
  24 |  event Mint(address indexed account, uint256 amount);

     |  // @audit-issue Add NatSpec @notice
  26 |  event Transfer(address indexed from, address indexed to, uint256 value);

     |  // @audit-issue Add NatSpec @notice
  28 |  event Withdrawal(address indexed _l2Sender, address indexed _l1Receiver, uint256 _amount);

     |  // @audit-issue Add NatSpec @notice
  30 |  event WithdrawalWithMessage(
```
GitHub: [24](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBaseToken.sol#L24), [26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBaseToken.sol#L26), [28](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBaseToken.sol#L28), [30](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBaseToken.sol#L30)


```solidity
File: code/system-contracts/contracts/interfaces/IContractDeployer.sol

     |  // @audit-issue Add NatSpec @notice
  33 |  event ContractDeployed(

     |  // @audit-issue Add NatSpec @notice
  39 |  event AccountNonceOrderingUpdated(address indexed accountAddress, AccountNonceOrdering nonceOrdering);

     |  // @audit-issue Add NatSpec @notice
  41 |  event AccountVersionUpdated(address indexed accountAddress, AccountAbstractionVersion aaVersion);
```
GitHub: [33](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L33), [39](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L39), [41](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L41)


```solidity
File: code/system-contracts/contracts/interfaces/IKnownCodesStorage.sol

     |  // @audit-issue Add NatSpec @notice
  12 |  event MarkedAsKnown(bytes32 indexed bytecodeHash, bool indexed sendBytecodeToL1);
```
GitHub: [12](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IKnownCodesStorage.sol#L12)


```solidity
File: code/system-contracts/contracts/interfaces/IL1Messenger.sol

     |  // @audit-issue Add NatSpec @notice
  43 |  event L1MessageSent(address indexed _sender, bytes32 indexed _hash, bytes _message);

     |  // @audit-issue Add NatSpec @notice
  45 |  event L2ToL1LogSent(L2ToL1Log _l2log);

     |  // @audit-issue Add NatSpec @notice
  47 |  event BytecodeL1PublicationRequested(bytes32 _bytecodeHash);
```
GitHub: [43](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL1Messenger.sol#L43), [45](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL1Messenger.sol#L45), [47](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL1Messenger.sol#L47)


```solidity
File: code/system-contracts/contracts/interfaces/IL2StandardToken.sol

     |  // @audit-issue Add NatSpec @notice
   6 |  event BridgeMint(address indexed _account, uint256 _amount);

     |  // @audit-issue Add NatSpec @notice
   8 |  event BridgeBurn(address indexed _account, uint256 _amount);
```
GitHub: [6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL2StandardToken.sol#L6), [8](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL2StandardToken.sol#L8)


```solidity
File: code/system-contracts/contracts/interfaces/INonceHolder.sol

     |  // @audit-issue Add NatSpec @notice
  14 |  event ValueSetUnderNonce(address indexed accountAddress, uint256 indexed key, uint256 value);
```
GitHub: [14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/INonceHolder.sol#L14)


```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol

     |  // @audit-issue Add NatSpec @notice
   7 |  event FinalizeDeposit(

     |  // @audit-issue Add NatSpec @notice
  14 |  event WithdrawalInitiated(

     |  // @audit-issue Add NatSpec @notice
  22 |  event BaseTokenReceived(uint256 amount);
```
GitHub: [7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol#L7), [14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol#L14), [22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol#L22)


```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol

     |  // @audit-issue Add NatSpec @notice
   6 |  event BridgeInitialize(address indexed l1Token, string name, string symbol, uint8 decimals);

     |  // @audit-issue Add NatSpec @notice
   8 |  event BridgeMint(address indexed _account, uint256 _amount);

     |  // @audit-issue Add NatSpec @notice
  10 |  event BridgeBurn(address indexed _account, uint256 _amount);
```
GitHub: [6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol#L6), [8](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol#L8), [10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2StandardToken.sol#L10)


## [N-68] NatSpec: Function `@param` is missing

Documentation of all function parameters improves code readability.

*Instances: 99*

```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

     |  // @audit-issue Missing NatSpec @param for parameter 1 contract IL1SharedBridge _sharedBridge
  55 |  constructor(IL1SharedBridge _sharedBridge) reentrancyGuardInitializer {

     |  // @audit-issue Missing NatSpec @param for parameter 1 address _token
     |  // @audit-issue Missing NatSpec @param for parameter 2 uint256 _amount
  63 |  function tranferTokenToSharedBridge(address _token, uint256 _amount) external {

     |  // @audit-issue Missing NatSpec @param for parameter 1 address _l1Token
  75 |  function l2TokenAddress(address _l1Token) external view returns (address) {

     |  // @audit-issue Missing NatSpec @param for parameter 1 address _from
     |  // @audit-issue Missing NatSpec @param for parameter 2 contract IERC20 _token
     |  // @audit-issue Missing NatSpec @param for parameter 3 uint256 _amount
 160 |  function _depositFundsToSharedBridge(address _from, IERC20 _token, uint256 _amount) internal returns (uint256) {
```
GitHub: [55](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L55), [63](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L63), [63](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L63), [75](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L75), [160](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L160), [160](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L160), [160](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L160)


```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

     |  // @audit-issue Missing NatSpec @param for parameter 1 address _l1WethAddress
  91 |  address _l1WethAddress,
     |  // @audit-issue Missing NatSpec @param for parameter 2 contract IBridgehub _bridgehub
  92 |  IBridgehub _bridgehub,
     |  // @audit-issue Missing NatSpec @param for parameter 3 contract IL1ERC20Bridge _legacyBridge
  93 |  IL1ERC20Bridge _legacyBridge

     |  // @audit-issue Missing NatSpec @param for parameter 2 uint256 _eraFirstPostUpgradeBatch
 106 |  uint256 _eraFirstPostUpgradeBatch

     |  // @audit-issue Missing NatSpec @param for parameter 1 address _token
     |  // @audit-issue Missing NatSpec @param for parameter 2 address _target
     |  // @audit-issue Missing NatSpec @param for parameter 3 uint256 _targetChainId
 116 |  function transferFundsFromLegacy(address _token, address _target, uint256 _targetChainId) external onlyOwner {

     |  // @audit-issue Missing NatSpec @param for parameter 1 uint256 _chainId
 137 |  function receiveEth(uint256 _chainId) external payable {

     |  // @audit-issue Missing NatSpec @param for parameter 1 uint256 _chainId
     |  // @audit-issue Missing NatSpec @param for parameter 2 address _l2BridgeAddress
 142 |  function initializeChainGovernance(uint256 _chainId, address _l2BridgeAddress) external onlyOwner {

     |  // @audit-issue Missing NatSpec @param for parameter 1 uint256 _chainId
 149 |  uint256 _chainId,
     |  // @audit-issue Missing NatSpec @param for parameter 2 address _prevMsgSender
 150 |  address _prevMsgSender,
     |  // @audit-issue Missing NatSpec @param for parameter 3 address _l1Token
 151 |  address _l1Token,
     |  // @audit-issue Missing NatSpec @param for parameter 4 uint256 _amount
 152 |  uint256 _amount

     |  // @audit-issue Missing NatSpec @param for parameter 1 address _from
     |  // @audit-issue Missing NatSpec @param for parameter 2 contract IERC20 _token
     |  // @audit-issue Missing NatSpec @param for parameter 3 uint256 _amount
 173 |  function _depositFunds(address _from, IERC20 _token, uint256 _amount) internal returns (uint256) {

     |  // @audit-issue Missing NatSpec @param for parameter 1 uint256 _chainId
 183 |  uint256 _chainId,
     |  // @audit-issue Missing NatSpec @param for parameter 2 address _prevMsgSender
 184 |  address _prevMsgSender,
     |  // @audit-issue Missing NatSpec @param for parameter 3 uint256 
 185 |  uint256, // l2Value, needed for Weth deposits in the future
     |  // @audit-issue Missing NatSpec @param for parameter 4 bytes _data
 186 |  bytes calldata _data

     |  // @audit-issue Missing NatSpec @param for parameter 1 uint256 _chainId
 233 |  uint256 _chainId,
     |  // @audit-issue Missing NatSpec @param for parameter 2 bytes32 _txDataHash
 234 |  bytes32 _txDataHash,
     |  // @audit-issue Missing NatSpec @param for parameter 3 bytes32 _txHash
 235 |  bytes32 _txHash

     |  // @audit-issue Missing NatSpec @param for parameter 1 address _l1Sender
 244 |  address _l1Sender,
     |  // @audit-issue Missing NatSpec @param for parameter 2 address _l2Receiver
 245 |  address _l2Receiver,
     |  // @audit-issue Missing NatSpec @param for parameter 3 address _l1Token
 246 |  address _l1Token,
     |  // @audit-issue Missing NatSpec @param for parameter 4 uint256 _amount
 247 |  uint256 _amount

     |  // @audit-issue Missing NatSpec @param for parameter 1 address _token
 254 |  function _getERC20Getters(address _token) internal view returns (bytes memory) {

     |  // @audit-issue Missing NatSpec @param for parameter 1 uint256 _chainId
 278 |  uint256 _chainId,

     |  // @audit-issue Missing NatSpec @param for parameter 1 bool _checkedInLegacyBridge
 304 |  bool _checkedInLegacyBridge,
     |  // @audit-issue Missing NatSpec @param for parameter 2 uint256 _chainId
 305 |  uint256 _chainId,
     |  // @audit-issue Missing NatSpec @param for parameter 3 address _depositSender
 306 |  address _depositSender,
     |  // @audit-issue Missing NatSpec @param for parameter 4 address _l1Token
 307 |  address _l1Token,
     |  // @audit-issue Missing NatSpec @param for parameter 5 uint256 _amount
 308 |  uint256 _amount,
     |  // @audit-issue Missing NatSpec @param for parameter 6 bytes32 _l2TxHash
 309 |  bytes32 _l2TxHash,
     |  // @audit-issue Missing NatSpec @param for parameter 7 uint256 _l2BatchNumber
 310 |  uint256 _l2BatchNumber,
     |  // @audit-issue Missing NatSpec @param for parameter 8 uint256 _l2MessageIndex
 311 |  uint256 _l2MessageIndex,
     |  // @audit-issue Missing NatSpec @param for parameter 9 uint16 _l2TxNumberInBatch
 312 |  uint16 _l2TxNumberInBatch,
     |  // @audit-issue Missing NatSpec @param for parameter 10 bytes32[] _merkleProof
 313 |  bytes32[] calldata _merkleProof

     |  // @audit-issue Missing NatSpec @param for parameter 1 uint256 _chainId
 410 |  uint256 _chainId,
     |  // @audit-issue Missing NatSpec @param for parameter 2 uint256 _l2BatchNumber
 411 |  uint256 _l2BatchNumber,
     |  // @audit-issue Missing NatSpec @param for parameter 3 uint256 _l2MessageIndex
 412 |  uint256 _l2MessageIndex,
     |  // @audit-issue Missing NatSpec @param for parameter 4 uint16 _l2TxNumberInBatch
 413 |  uint16 _l2TxNumberInBatch,
     |  // @audit-issue Missing NatSpec @param for parameter 5 bytes _message
 414 |  bytes calldata _message,
     |  // @audit-issue Missing NatSpec @param for parameter 6 bytes32[] _merkleProof
 415 |  bytes32[] calldata _merkleProof

     |  // @audit-issue Missing NatSpec @param for parameter 1 uint256 _chainId
 459 |  uint256 _chainId,
     |  // @audit-issue Missing NatSpec @param for parameter 2 struct L1SharedBridge.MessageParams _messageParams
 460 |  MessageParams memory _messageParams,
     |  // @audit-issue Missing NatSpec @param for parameter 3 bytes _message
 461 |  bytes calldata _message,
     |  // @audit-issue Missing NatSpec @param for parameter 4 bytes32[] _merkleProof
 462 |  bytes32[] calldata _merkleProof

     |  // @audit-issue Missing NatSpec @param for parameter 1 uint256 _chainId
 488 |  uint256 _chainId,
     |  // @audit-issue Missing NatSpec @param for parameter 2 bytes _l2ToL1message
 489 |  bytes memory _l2ToL1message

     |  // @audit-issue Missing NatSpec @param for parameter 1 address _prevMsgSender
 555 |  address _prevMsgSender,
```
GitHub: [91](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L91), [92](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L92), [93](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L93), [106](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L106), [116](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L116), [116](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L116), [116](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L116), [137](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L137), [142](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L142), [142](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L142), [149](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L149), [150](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L150), [151](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L151), [152](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L152), [173](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L173), [173](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L173), [173](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L173), [183](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L183), [184](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L184), [185](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L185), [186](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L186), [233](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L233), [234](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L234), [235](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L235), [244](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L244), [245](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L245), [246](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L246), [247](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L247), [254](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L254), [278](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L278), [304](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L304), [305](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L305), [306](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L306), [307](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L307), [308](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L308), [309](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L309), [310](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L310), [311](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L311), [312](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L312), [313](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L313), [410](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L410), [411](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L411), [412](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L412), [413](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L413), [414](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L414), [415](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L415), [459](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L459), [460](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L460), [461](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L461), [462](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L462), [488](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L488), [489](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L489), [555](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L555)


```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

     |  // @audit-issue Missing NatSpec @param for parameter 1 address _owner
  41 |  function initialize(address _owner) external reentrancyGuardInitializer {

     |  // @audit-issue Missing NatSpec @param for parameter 1 uint256 _chainId
  75 |  function getStateTransition(uint256 _chainId) public view returns (address) {

     |  // @audit-issue Missing NatSpec @param for parameter 1 address _stateTransitionManager
  82 |  function addStateTransitionManager(address _stateTransitionManager) external onlyOwner {

     |  // @audit-issue Missing NatSpec @param for parameter 1 address _stateTransitionManager
  92 |  function removeStateTransitionManager(address _stateTransitionManager) external onlyOwner {

     |  // @audit-issue Missing NatSpec @param for parameter 1 address _token
 101 |  function addToken(address _token) external onlyOwner {

     |  // @audit-issue Missing NatSpec @param for parameter 1 address _sharedBridge
 108 |  function setSharedBridge(address _sharedBridge) external onlyOwner {

     |  // @audit-issue Missing NatSpec @param for parameter 1 uint256 _chainId
 115 |  uint256 _chainId,
     |  // @audit-issue Missing NatSpec @param for parameter 2 address _stateTransitionManager
 116 |  address _stateTransitionManager,
     |  // @audit-issue Missing NatSpec @param for parameter 3 address _baseToken
 117 |  address _baseToken,
     |  // @audit-issue Missing NatSpec @param for parameter 4 uint256 
 118 |  uint256, //_salt
     |  // @audit-issue Missing NatSpec @param for parameter 5 address _admin
 119 |  address _admin,
     |  // @audit-issue Missing NatSpec @param for parameter 6 bytes _initData
 120 |  bytes calldata _initData

     |  // @audit-issue Missing NatSpec @param for parameter 1 uint256 _chainId
 153 |  uint256 _chainId,
     |  // @audit-issue Missing NatSpec @param for parameter 2 uint256 _batchNumber
 154 |  uint256 _batchNumber,
     |  // @audit-issue Missing NatSpec @param for parameter 3 uint256 _index
 155 |  uint256 _index,
     |  // @audit-issue Missing NatSpec @param for parameter 4 struct L2Message _message
 156 |  L2Message calldata _message,
     |  // @audit-issue Missing NatSpec @param for parameter 5 bytes32[] _proof
 157 |  bytes32[] calldata _proof

     |  // @audit-issue Missing NatSpec @param for parameter 1 uint256 _chainId
 165 |  uint256 _chainId,
     |  // @audit-issue Missing NatSpec @param for parameter 2 uint256 _batchNumber
 166 |  uint256 _batchNumber,
     |  // @audit-issue Missing NatSpec @param for parameter 3 uint256 _index
 167 |  uint256 _index,
     |  // @audit-issue Missing NatSpec @param for parameter 4 struct L2Log _log
 168 |  L2Log memory _log,
     |  // @audit-issue Missing NatSpec @param for parameter 5 bytes32[] _proof
 169 |  bytes32[] calldata _proof

     |  // @audit-issue Missing NatSpec @param for parameter 1 uint256 _chainId
 177 |  uint256 _chainId,
     |  // @audit-issue Missing NatSpec @param for parameter 2 bytes32 _l2TxHash
 178 |  bytes32 _l2TxHash,
     |  // @audit-issue Missing NatSpec @param for parameter 3 uint256 _l2BatchNumber
 179 |  uint256 _l2BatchNumber,
     |  // @audit-issue Missing NatSpec @param for parameter 4 uint256 _l2MessageIndex
 180 |  uint256 _l2MessageIndex,
     |  // @audit-issue Missing NatSpec @param for parameter 5 uint16 _l2TxNumberInBatch
 181 |  uint16 _l2TxNumberInBatch,
     |  // @audit-issue Missing NatSpec @param for parameter 6 bytes32[] _merkleProof
 182 |  bytes32[] calldata _merkleProof,
     |  // @audit-issue Missing NatSpec @param for parameter 7 enum TxStatus _status
 183 |  TxStatus _status

     |  // @audit-issue Missing NatSpec @param for parameter 1 uint256 _chainId
 199 |  uint256 _chainId,
     |  // @audit-issue Missing NatSpec @param for parameter 2 uint256 _gasPrice
 200 |  uint256 _gasPrice,
     |  // @audit-issue Missing NatSpec @param for parameter 3 uint256 _l2GasLimit
 201 |  uint256 _l2GasLimit,
     |  // @audit-issue Missing NatSpec @param for parameter 4 uint256 _l2GasPerPubdataByteLimit
 202 |  uint256 _l2GasPerPubdataByteLimit

     |  // @audit-issue Missing NatSpec @param for parameter 1 struct L2TransactionRequestDirect _request
 218 |  L2TransactionRequestDirect calldata _request

     |  // @audit-issue Missing NatSpec @param for parameter 1 struct L2TransactionRequestTwoBridgesOuter _request
 263 |  L2TransactionRequestTwoBridgesOuter calldata _request

     |  // @audit-issue Missing NatSpec @param for parameter 1 address _refundRecipient
 325 |  function _actualRefundRecipient(address _refundRecipient) internal view returns (address _recipient) {
```
GitHub: [41](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L41), [75](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L75), [82](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L82), [92](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L92), [101](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L101), [108](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L108), [115](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L115), [116](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L116), [117](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L117), [118](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L118), [119](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L119), [120](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L120), [153](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L153), [154](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L154), [155](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L155), [156](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L156), [157](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L157), [165](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L165), [166](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L166), [167](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L167), [168](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L168), [169](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L169), [177](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L177), [178](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L178), [179](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L179), [180](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L180), [181](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L181), [182](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L182), [183](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L183), [199](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L199), [200](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L200), [201](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L201), [202](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L202), [218](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L218), [263](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L263), [325](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L325)


```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

     |  // @audit-issue Missing NatSpec @param for parameter 1 bytes32 _id
  84 |  function isOperation(bytes32 _id) public view returns (bool) {

     |  // @audit-issue Missing NatSpec @param for parameter 1 bytes32 _id
  89 |  function isOperationPending(bytes32 _id) public view returns (bool) {

     |  // @audit-issue Missing NatSpec @param for parameter 1 bytes32 _id
  95 |  function isOperationReady(bytes32 _id) public view returns (bool) {
```
GitHub: [84](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L84), [89](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L89), [95](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L95)


## [N-69] NatSpec: Function `@return` is missing

Documentation of all function parameters improves code readability.

*Instances: 99*

```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

     |  // @audit-issue Missing NatSpec @return for parameter 1 struct L2TransactionRequestTwoBridgesInner request
 187 |  ) external payable override onlyBridgehub returns (L2TransactionRequestTwoBridgesInner memory request) {

     |  // @audit-issue Missing NatSpec @return for parameter 1 bytes 
 248 |  ) internal view returns (bytes memory) {

     |  // @audit-issue Missing NatSpec @return for parameter 1 bytes 
 254 |  function _getERC20Getters(address _token) internal view returns (bytes memory) {

     |  // @audit-issue Missing NatSpec @return for parameter 1 address l1Receiver
 416 |  ) internal nonReentrant returns (address l1Receiver, address l1Token, uint256 amount) {

     |  // @audit-issue Missing NatSpec @return for parameter 2 address l1Token
 416 |  ) internal nonReentrant returns (address l1Receiver, address l1Token, uint256 amount) {

     |  // @audit-issue Missing NatSpec @return for parameter 3 uint256 amount
 416 |  ) internal nonReentrant returns (address l1Receiver, address l1Token, uint256 amount) {

     |  // @audit-issue Missing NatSpec @return for parameter 1 address l1Receiver
 463 |  ) internal view returns (address l1Receiver, address l1Token, uint256 amount) {

     |  // @audit-issue Missing NatSpec @return for parameter 2 address l1Token
 463 |  ) internal view returns (address l1Receiver, address l1Token, uint256 amount) {

     |  // @audit-issue Missing NatSpec @return for parameter 3 uint256 amount
 463 |  ) internal view returns (address l1Receiver, address l1Token, uint256 amount) {

     |  // @audit-issue Missing NatSpec @return for parameter 1 address l1Receiver
 490 |  ) internal view returns (address l1Receiver, address l1Token, uint256 amount) {

     |  // @audit-issue Missing NatSpec @return for parameter 2 address l1Token
 490 |  ) internal view returns (address l1Receiver, address l1Token, uint256 amount) {

     |  // @audit-issue Missing NatSpec @return for parameter 3 uint256 amount
 490 |  ) internal view returns (address l1Receiver, address l1Token, uint256 amount) {
```
GitHub: [187](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L187), [248](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L248), [254](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L254), [416](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L416), [416](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L416), [416](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L416), [463](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L463), [463](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L463), [463](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L463), [490](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L490), [490](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L490), [490](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L490)


```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

     |  // @audit-issue Missing NatSpec @return for parameter 1 address 
  75 |  function getStateTransition(uint256 _chainId) public view returns (address) {

     |  // @audit-issue Missing NatSpec @return for parameter 1 uint256 chainId
 121 |  ) external onlyOwnerOrAdmin nonReentrant returns (uint256 chainId) {

     |  // @audit-issue Missing NatSpec @return for parameter 1 bool 
 158 |  ) external view override returns (bool) {

     |  // @audit-issue Missing NatSpec @return for parameter 1 bool 
 170 |  ) external view override returns (bool) {

     |  // @audit-issue Missing NatSpec @return for parameter 1 bool 
 184 |  ) external view override returns (bool) {

     |  // @audit-issue Missing NatSpec @return for parameter 1 uint256 
 203 |  ) external view returns (uint256) {

     |  // @audit-issue Missing NatSpec @return for parameter 1 bytes32 canonicalTxHash
 219 |  ) external payable override nonReentrant returns (bytes32 canonicalTxHash) {

     |  // @audit-issue Missing NatSpec @return for parameter 1 bytes32 canonicalTxHash
 264 |  ) external payable override nonReentrant returns (bytes32 canonicalTxHash) {

     |  // @audit-issue Missing NatSpec @return for parameter 1 address _recipient
 325 |  function _actualRefundRecipient(address _refundRecipient) internal view returns (address _recipient) {
```
GitHub: [75](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L75), [121](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L121), [158](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L158), [170](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L170), [184](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L184), [203](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L203), [219](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L219), [264](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L264), [325](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L325)


```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

     |  // @audit-issue Missing NatSpec @return for parameter 1 bool 
  84 |  function isOperation(bytes32 _id) public view returns (bool) {

     |  // @audit-issue Missing NatSpec @return for parameter 1 bool 
  89 |  function isOperationPending(bytes32 _id) public view returns (bool) {

     |  // @audit-issue Missing NatSpec @return for parameter 1 bool 
  95 |  function isOperationReady(bytes32 _id) public view returns (bool) {

     |  // @audit-issue Missing NatSpec @return for parameter 1 bool 
 100 |  function isOperationDone(bytes32 _id) public view returns (bool) {

     |  // @audit-issue Missing NatSpec @return for parameter 1 enum IGovernance.OperationState 
 105 |  function getOperationState(bytes32 _id) public view returns (OperationState) {

     |  // @audit-issue Missing NatSpec @return for parameter 1 bytes32 
 204 |  function hashOperation(Operation calldata _operation) public pure returns (bytes32) {
```
GitHub: [84](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L84), [89](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L89), [95](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L95), [100](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L100), [105](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L105), [204](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L204)


```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

     |  // @audit-issue Missing NatSpec @return for parameter 1 address 
  76 |  function getChainAdmin(uint256 _chainId) external view override returns (address) {
```
GitHub: [76](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L76)


```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

     |  // @audit-issue Missing NatSpec @return for parameter 1 uint256 
 102 |  function getCommittedBatchTimestamp(uint256 _chainId, uint256 _l2BatchNumber) external view returns (uint256) {
```
GitHub: [102](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L102)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

     |  // @audit-issue Missing NatSpec @return for parameter 1 struct IExecutor.StoredBatchInfo 
  36 |  ) internal view returns (StoredBatchInfo memory) {

     |  // @audit-issue Missing NatSpec @return for parameter 1 struct LogProcessingOutput logOutput
 133 |  ) internal pure returns (LogProcessingOutput memory logOutput) {

     |  // @audit-issue Missing NatSpec @return for parameter 1 bytes32 concatHash
 308 |  function _collectOperationsFromPriorityQueue(uint256 _nPriorityOps) internal returns (bytes32 concatHash) {

     |  // @audit-issue Missing NatSpec @return for parameter 1 uint256 
 457 |  ) internal pure returns (uint256) {

     |  // @audit-issue Missing NatSpec @return for parameter 1 bytes32 
 505 |  ) internal view returns (bytes32) {

     |  // @audit-issue Missing NatSpec @return for parameter 1 bytes 
 515 |  function _batchPassThroughData(CommitBatchInfo calldata _batch) internal pure returns (bytes memory) {

     |  // @audit-issue Missing NatSpec @return for parameter 1 bytes 
 525 |  function _batchMetaParameters() internal view returns (bytes memory) {

     |  // @audit-issue Missing NatSpec @return for parameter 1 bytes 
 542 |  ) internal pure returns (bytes memory) {

     |  // @audit-issue Missing NatSpec @return for parameter 1 bytes32[] blobAuxOutputWords
 564 |  ) internal pure returns (bytes32[] memory blobAuxOutputWords) {

     |  // @audit-issue Missing NatSpec @return for parameter 1 bytes32 
 587 |  function _hashStoredBatchInfo(StoredBatchInfo memory _storedBatchInfo) internal pure returns (bytes32) {

     |  // @audit-issue Missing NatSpec @return for parameter 1 bool 
 592 |  function _checkBit(uint256 _bitMap, uint8 _index) internal pure returns (bool) {

     |  // @audit-issue Missing NatSpec @return for parameter 1 uint256 
 597 |  function _setBit(uint256 _bitMap, uint8 _index) internal pure returns (uint256) {

     |  // @audit-issue Missing NatSpec @return for parameter 1 bytes32[] blobCommitments
 628 |  ) internal view returns (bytes32[] memory blobCommitments) {

     |  // @audit-issue Missing NatSpec @return for parameter 1 bytes32 versionedHash
 679 |  function _getBlobVersionedHash(uint256 _index) internal view returns (bytes32 versionedHash) {
```
GitHub: [36](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L36), [133](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L133), [308](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L308), [457](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L457), [505](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L505), [515](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L515), [525](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L525), [542](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L542), [564](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L564), [587](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L587), [592](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L592), [597](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L597), [628](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L628), [679](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L679)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

     |  // @audit-issue Missing NatSpec @return for parameter 1 bytes32 canonicalTxHash
  49 |  ) external payable onlyBridgehub returns (bytes32 canonicalTxHash) {

     |  // @audit-issue Missing NatSpec @return for parameter 1 bool 
 109 |  ) internal view returns (bool) {

     |  // @audit-issue Missing NatSpec @return for parameter 1 struct L2Log 
 130 |  function _L2MessageToLog(L2Message memory _message) internal pure returns (L2Log memory) {

     |  // @audit-issue Missing NatSpec @return for parameter 1 bytes32 canonicalTxHash
 230 |  ) internal nonReentrant returns (bytes32 canonicalTxHash) {

     |  // @audit-issue Missing NatSpec @return for parameter 1 bytes32 canonicalTxHash
 263 |  ) internal returns (bytes32 canonicalTxHash) {

     |  // @audit-issue Missing NatSpec @return for parameter 1 struct L2CanonicalTransaction transaction
 293 |  ) internal pure returns (L2CanonicalTransaction memory transaction) {

     |  // @audit-issue Missing NatSpec @return for parameter 1 bytes32 canonicalTxHash
 320 |  ) internal returns (bytes32 canonicalTxHash) {

     |  // @audit-issue Missing NatSpec @return for parameter 1 uint256[] hashedFactoryDeps
 353 |  function _hashFactoryDeps(bytes[] memory _factoryDeps) internal pure returns (uint256[] memory hashedFactoryDeps) {
```
GitHub: [49](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L49), [109](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L109), [130](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L130), [230](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L230), [263](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L263), [293](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L293), [320](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L320), [353](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L353)


```solidity
File: code/contracts/ethereum/contracts/upgrades/DefaultUpgrade.sol

     |  // @audit-issue Missing NatSpec @return for parameter 1 bytes32 
  13 |  function upgrade(ProposedUpgrade calldata _proposedUpgrade) public override returns (bytes32) {
```
GitHub: [13](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/DefaultUpgrade.sol#L13)


```solidity
File: code/contracts/ethereum/contracts/upgrades/GenesisUpgrade.sol

     |  // @audit-issue Missing NatSpec @return for parameter 1 bytes32 
  14 |  function upgrade(ProposedUpgrade calldata _proposedUpgrade) public override returns (bytes32) {
```
GitHub: [14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/GenesisUpgrade.sol#L14)


```solidity
File: code/contracts/ethereum/contracts/common/libraries/UncheckedMath.sol

     |  // @audit-issue Missing NatSpec @return for parameter 1 uint256 
  11 |  function uncheckedInc(uint256 _number) internal pure returns (uint256) {

     |  // @audit-issue Missing NatSpec @return for parameter 1 uint256 
  17 |  function uncheckedAdd(uint256 _lhs, uint256 _rhs) internal pure returns (uint256) {
```
GitHub: [11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/UncheckedMath.sol#L11), [17](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/UncheckedMath.sol#L17)


```solidity
File: code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol

     |  // @audit-issue Missing NatSpec @return for parameter 1 uint32 result
  19 |  function readUint32(bytes memory _bytes, uint256 _start) internal pure returns (uint32 result, uint256 offset) {

     |  // @audit-issue Missing NatSpec @return for parameter 2 uint256 offset
  19 |  function readUint32(bytes memory _bytes, uint256 _start) internal pure returns (uint32 result, uint256 offset) {

     |  // @audit-issue Missing NatSpec @return for parameter 1 address result
  26 |  function readAddress(bytes memory _bytes, uint256 _start) internal pure returns (address result, uint256 offset) {

     |  // @audit-issue Missing NatSpec @return for parameter 2 uint256 offset
  26 |  function readAddress(bytes memory _bytes, uint256 _start) internal pure returns (address result, uint256 offset) {

     |  // @audit-issue Missing NatSpec @return for parameter 1 uint256 result
  33 |  function readUint256(bytes memory _bytes, uint256 _start) internal pure returns (uint256 result, uint256 offset) {

     |  // @audit-issue Missing NatSpec @return for parameter 2 uint256 offset
  33 |  function readUint256(bytes memory _bytes, uint256 _start) internal pure returns (uint256 result, uint256 offset) {

     |  // @audit-issue Missing NatSpec @return for parameter 1 bytes32 result
  40 |  function readBytes32(bytes memory _bytes, uint256 _start) internal pure returns (bytes32 result, uint256 offset) {

     |  // @audit-issue Missing NatSpec @return for parameter 2 uint256 offset
  40 |  function readBytes32(bytes memory _bytes, uint256 _start) internal pure returns (bytes32 result, uint256 offset) {
```
GitHub: [19](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol#L19), [19](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol#L19), [26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol#L26), [26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol#L26), [33](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol#L33), [33](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol#L33), [40](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol#L40), [40](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol#L40)


```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol

     |  // @audit-issue Missing NatSpec @return for parameter 1 bytes32 result
  40 |  function _efficientHash(bytes32 _lhs, bytes32 _rhs) private pure returns (bytes32 result) {
```
GitHub: [40](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol#L40)


```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol

     |  // @audit-issue Missing NatSpec @return for parameter 1 uint256 txBodyGasLimit
 112 |  ) internal pure returns (uint256 txBodyGasLimit) {

     |  // @audit-issue Missing NatSpec @return for parameter 1 uint256 batchOverheadForTransaction
 130 |  ) internal pure returns (uint256 batchOverheadForTransaction) {
```
GitHub: [112](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L112), [130](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L130)


```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol

     |  // @audit-issue Missing NatSpec @return for parameter 1 bool 
  24 |  function isWithdrawalFinalized(uint256 _l2BatchNumber, uint256 _l2MessageIndex) external view returns (bool);

     |  // @audit-issue Missing NatSpec @return for parameter 1 bytes32 txHash
  33 |  ) external payable returns (bytes32 txHash);

     |  // @audit-issue Missing NatSpec @return for parameter 1 bytes32 txHash
  41 |  ) external payable returns (bytes32 txHash);

     |  // @audit-issue Missing NatSpec @return for parameter 1 address 
  61 |  function l2TokenAddress(address _l1Token) external view returns (address);

     |  // @audit-issue Missing NatSpec @return for parameter 1 contract IL1SharedBridge 
  63 |  function sharedBridge() external view returns (IL1SharedBridge);

     |  // @audit-issue Missing NatSpec @return for parameter 1 address 
  65 |  function l2TokenBeacon() external view returns (address);

     |  // @audit-issue Missing NatSpec @return for parameter 1 address 
  67 |  function l2Bridge() external view returns (address);

     |  // @audit-issue Missing NatSpec @return for parameter 1 uint256 amount
  73 |  ) external returns (uint256 amount);
```
GitHub: [24](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L24), [33](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L33), [41](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L41), [61](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L61), [63](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L63), [65](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L65), [67](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L67), [73](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L73)


```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol

     |  // @audit-issue Missing NatSpec @return for parameter 1 bool 
  62 |  ) external view returns (bool);

     |  // @audit-issue Missing NatSpec @return for parameter 1 bytes32 txHash
  72 |  ) external payable returns (bytes32 txHash);

     |  // @audit-issue Missing NatSpec @return for parameter 1 address l1Receiver
 103 |  ) external returns (address l1Receiver, address l1Token, uint256 amount);

     |  // @audit-issue Missing NatSpec @return for parameter 2 address l1Token
 103 |  ) external returns (address l1Receiver, address l1Token, uint256 amount);

     |  // @audit-issue Missing NatSpec @return for parameter 3 uint256 amount
 103 |  ) external returns (address l1Receiver, address l1Token, uint256 amount);

     |  // @audit-issue Missing NatSpec @return for parameter 1 address 
 114 |  function l1WethAddress() external view returns (address);

     |  // @audit-issue Missing NatSpec @return for parameter 1 contract IBridgehub 
 116 |  function bridgehub() external view returns (IBridgehub);

     |  // @audit-issue Missing NatSpec @return for parameter 1 contract IL1ERC20Bridge 
 118 |  function legacyBridge() external view returns (IL1ERC20Bridge);

     |  // @audit-issue Missing NatSpec @return for parameter 1 address 
 120 |  function l2BridgeAddress(uint256 _chainId) external view returns (address);

     |  // @audit-issue Missing NatSpec @return for parameter 1 bytes32 
 122 |  function depositHappened(uint256 _chainId, bytes32 _l2TxHash) external view returns (bytes32);

     |  // @audit-issue Missing NatSpec @return for parameter 1 struct L2TransactionRequestTwoBridgesInner request
 133 |  ) external payable returns (L2TransactionRequestTwoBridgesInner memory request);
```
GitHub: [62](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L62), [72](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L72), [103](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L103), [103](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L103), [103](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L103), [114](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L114), [116](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L116), [118](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L118), [120](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L120), [122](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L122), [133](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L133)


```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL2Bridge.sol

     |  // @audit-issue Missing NatSpec @return for parameter 1 address 
  17 |  function l1TokenAddress(address _l2Token) external view returns (address);

     |  // @audit-issue Missing NatSpec @return for parameter 1 address 
  19 |  function l2TokenAddress(address _l1Token) external view returns (address);

     |  // @audit-issue Missing NatSpec @return for parameter 1 address 
  21 |  function l1Bridge() external view returns (address);
```
GitHub: [17](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL2Bridge.sol#L17), [19](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL2Bridge.sol#L19), [21](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL2Bridge.sol#L21)


```solidity
File: code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol

     |  // @audit-issue Missing NatSpec @return for parameter 1 bool 
  59 |  function stateTransitionManagerIsRegistered(address _stateTransitionManager) external view returns (bool);

     |  // @audit-issue Missing NatSpec @return for parameter 1 address 
  61 |  function stateTransitionManager(uint256 _chainId) external view returns (address);

     |  // @audit-issue Missing NatSpec @return for parameter 1 bool 
  63 |  function tokenIsRegistered(address _baseToken) external view returns (bool);

     |  // @audit-issue Missing NatSpec @return for parameter 1 address 
  65 |  function baseToken(uint256 _chainId) external view returns (address);

     |  // @audit-issue Missing NatSpec @return for parameter 1 contract IL1SharedBridge 
  67 |  function sharedBridge() external view returns (IL1SharedBridge);

     |  // @audit-issue Missing NatSpec @return for parameter 1 address 
  69 |  function getStateTransition(uint256 _chainId) external view returns (address);

     |  // @audit-issue Missing NatSpec @return for parameter 1 bool 
  79 |  ) external view returns (bool);

     |  // @audit-issue Missing NatSpec @return for parameter 1 bool 
  87 |  ) external view returns (bool);

     |  // @audit-issue Missing NatSpec @return for parameter 1 bool 
  97 |  ) external view returns (bool);

     |  // @audit-issue Missing NatSpec @return for parameter 1 bytes32 canonicalTxHash
 101 |  ) external payable returns (bytes32 canonicalTxHash);

     |  // @audit-issue Missing NatSpec @return for parameter 1 bytes32 canonicalTxHash
 105 |  ) external payable returns (bytes32 canonicalTxHash);
```
GitHub: [59](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L59), [61](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L61), [63](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L63), [65](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L65), [67](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L67), [69](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L69), [79](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L79), [87](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L87), [97](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L97), [101](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L101), [105](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L105)


## [N-70] NatSpec: Function definitions should have `@dev` tags

`@dev` is used to explain to developers what the function does, as per [NatSpec Format](https://docs.soliditylang.org/en/latest/natspec-format.html#tags).

*Instances: 99*

```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

     |  // @audit-issue Add NatSpec @dev
  75 |  function l2TokenAddress(address _l1Token) external view returns (address) {

     |  // @audit-issue Add NatSpec @dev
 208 |  function finalizeWithdrawal(
 209 |      uint256 _l2BatchNumber,
 210 |      uint256 _l2MessageIndex,
 211 |      uint16 _l2TxNumberInBatch,
 212 |      bytes calldata _message,
 213 |      bytes32[] calldata _merkleProof
 214 |  ) external nonReentrant {
```
GitHub: [75](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L75), [208-214](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L208-L214)


```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

     |  // @audit-issue Add NatSpec @dev
 137 |  function receiveEth(uint256 _chainId) external payable {

     |  // @audit-issue Add NatSpec @dev
 182 |  function bridgehubDeposit(
 183 |      uint256 _chainId,
 184 |      address _prevMsgSender,
 185 |      uint256, // l2Value, needed for Weth deposits in the future
 186 |      bytes calldata _data
 187 |  ) external payable override onlyBridgehub returns (L2TransactionRequestTwoBridgesInner memory request) {

     |  // @audit-issue Add NatSpec @dev
 232 |  function bridgehubConfirmL2Transaction(
 233 |      uint256 _chainId,
 234 |      bytes32 _txDataHash,
 235 |      bytes32 _txHash
 236 |  ) external override onlyBridgehub {

     |  // @audit-issue Add NatSpec @dev
 385 |  function finalizeWithdrawal(
 386 |      uint256 _chainId,
 387 |      uint256 _l2BatchNumber,
 388 |      uint256 _l2MessageIndex,
 389 |      uint16 _l2TxNumberInBatch,
 390 |      bytes calldata _message,
 391 |      bytes32[] calldata _merkleProof
 392 |  ) external override {

     |  // @audit-issue Add NatSpec @dev
 487 |  function _parseL2WithdrawalMessage(
 488 |      uint256 _chainId,
 489 |      bytes memory _l2ToL1message
 490 |  ) internal view returns (address l1Receiver, address l1Token, uint256 amount) {

     |  // @audit-issue Add NatSpec @dev
 615 |  function finalizeWithdrawalLegacyErc20Bridge(
 616 |      uint256 _l2BatchNumber,
 617 |      uint256 _l2MessageIndex,
 618 |      uint16 _l2TxNumberInBatch,
 619 |      bytes calldata _message,
 620 |      bytes32[] calldata _merkleProof
 621 |  ) external override onlyLegacyBridge returns (address l1Receiver, address l1Token, uint256 amount) {

     |  // @audit-issue Add NatSpec @dev
 644 |  function claimFailedDepositLegacyErc20Bridge(
 645 |      address _depositSender,
 646 |      address _l1Token,
 647 |      uint256 _amount,
 648 |      bytes32 _l2TxHash,
 649 |      uint256 _l2BatchNumber,
 650 |      uint256 _l2MessageIndex,
 651 |      uint16 _l2TxNumberInBatch,
 652 |      bytes32[] calldata _merkleProof
 653 |  ) external override onlyLegacyBridge {
```
GitHub: [137](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L137), [182-187](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L182-L187), [232-236](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L232-L236), [385-392](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L385-L392), [487-490](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L487-L490), [615-621](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L615-L621), [644-653](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L644-L653)


```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

     |  // @audit-issue Add NatSpec @dev
  38 |  constructor() reentrancyGuardInitializer {}

     |  // @audit-issue Add NatSpec @dev
  41 |  function initialize(address _owner) external reentrancyGuardInitializer {

     |  // @audit-issue Add NatSpec @dev
  51 |  function setPendingAdmin(address _newPendingAdmin) external onlyOwnerOrAdmin {

     |  // @audit-issue Add NatSpec @dev
  60 |  function acceptAdmin() external {

     |  // @audit-issue Add NatSpec @dev
  75 |  function getStateTransition(uint256 _chainId) public view returns (address) {

     |  // @audit-issue Add NatSpec @dev
  82 |  function addStateTransitionManager(address _stateTransitionManager) external onlyOwner {

     |  // @audit-issue Add NatSpec @dev
  92 |  function removeStateTransitionManager(address _stateTransitionManager) external onlyOwner {

     |  // @audit-issue Add NatSpec @dev
 101 |  function addToken(address _token) external onlyOwner {

     |  // @audit-issue Add NatSpec @dev
 108 |  function setSharedBridge(address _sharedBridge) external onlyOwner {

     |  // @audit-issue Add NatSpec @dev
 114 |  function createNewChain(
 115 |      uint256 _chainId,
 116 |      address _stateTransitionManager,
 117 |      address _baseToken,
 118 |      uint256, //_salt
 119 |      address _admin,
 120 |      bytes calldata _initData
 121 |  ) external onlyOwnerOrAdmin nonReentrant returns (uint256 chainId) {

     |  // @audit-issue Add NatSpec @dev
 152 |  function proveL2MessageInclusion(
 153 |      uint256 _chainId,
 154 |      uint256 _batchNumber,
 155 |      uint256 _index,
 156 |      L2Message calldata _message,
 157 |      bytes32[] calldata _proof
 158 |  ) external view override returns (bool) {

     |  // @audit-issue Add NatSpec @dev
 164 |  function proveL2LogInclusion(
 165 |      uint256 _chainId,
 166 |      uint256 _batchNumber,
 167 |      uint256 _index,
 168 |      L2Log memory _log,
 169 |      bytes32[] calldata _proof
 170 |  ) external view override returns (bool) {

     |  // @audit-issue Add NatSpec @dev
 176 |  function proveL1ToL2TransactionStatus(
 177 |      uint256 _chainId,
 178 |      bytes32 _l2TxHash,
 179 |      uint256 _l2BatchNumber,
 180 |      uint256 _l2MessageIndex,
 181 |      uint16 _l2TxNumberInBatch,
 182 |      bytes32[] calldata _merkleProof,
 183 |      TxStatus _status
 184 |  ) external view override returns (bool) {

     |  // @audit-issue Add NatSpec @dev
 198 |  function l2TransactionBaseCost(
 199 |      uint256 _chainId,
 200 |      uint256 _gasPrice,
 201 |      uint256 _l2GasLimit,
 202 |      uint256 _l2GasPerPubdataByteLimit
 203 |  ) external view returns (uint256) {

     |  // @audit-issue Add NatSpec @dev
 217 |  function requestL2TransactionDirect(
 218 |      L2TransactionRequestDirect calldata _request
 219 |  ) external payable override nonReentrant returns (bytes32 canonicalTxHash) {

     |  // @audit-issue Add NatSpec @dev
 262 |  function requestL2TransactionTwoBridges(
 263 |      L2TransactionRequestTwoBridgesOuter calldata _request
 264 |  ) external payable override nonReentrant returns (bytes32 canonicalTxHash) {

     |  // @audit-issue Add NatSpec @dev
 325 |  function _actualRefundRecipient(address _refundRecipient) internal view returns (address _recipient) {
```
GitHub: [38](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L38), [41](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L41), [51](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L51), [60](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L60), [75](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L75), [82](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L82), [92](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L92), [101](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L101), [108](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L108), [114-121](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L114-L121), [152-158](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L152-L158), [164-170](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L164-L170), [176-184](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L176-L184), [198-203](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L198-L203), [217-219](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L217-L219), [262-264](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L262-L264), [325](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L325)


```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

     |  // @audit-issue Add NatSpec @dev
  41 |  constructor(address _admin, address _securityCouncil, uint256 _minDelay) {
```
GitHub: [41](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L41)


```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

     |  // @audit-issue Add NatSpec @dev
  76 |  function getChainAdmin(uint256 _chainId) external view override returns (address) {

     |  // @audit-issue Add NatSpec @dev
 112 |  function setPendingAdmin(address _newPendingAdmin) external onlyOwnerOrAdmin {

     |  // @audit-issue Add NatSpec @dev
 121 |  function acceptAdmin() external {

     |  // @audit-issue Add NatSpec @dev
 232 |  function registerAlreadyDeployedStateTransition(
 233 |      uint256 _chainId,
 234 |      address _stateTransitionContract
 235 |  ) external onlyOwner {

     |  // @audit-issue Add NatSpec @dev
 241 |  function createNewChain(
 242 |      uint256 _chainId,
 243 |      address _baseToken,
 244 |      address _sharedBridge,
 245 |      address _admin,
 246 |      bytes calldata _diamondCut
 247 |  ) external onlyBridgehub {
```
GitHub: [76](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L76), [112](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L112), [121](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L121), [232-235](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L232-L235), [241-247](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L241-L247)


```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

     |  // @audit-issue Add NatSpec @dev
  55 |  constructor(address _initialOwner, uint32 _executionDelay) {
```
GitHub: [55](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L55)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol

     |  // @audit-issue Add NatSpec @dev
  24 |  function initialize(InitializeData calldata _initializeData) external reentrancyGuardInitializer returns (bytes32) {
```
GitHub: [24](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol#L24)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol

     |  // @audit-issue Add NatSpec @dev
  11 |  constructor(uint256 _chainId, Diamond.DiamondCutData memory _diamondCut) {
```
GitHub: [11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol#L11)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol

     |  // @audit-issue Add NatSpec @dev
  23 |  function setPendingAdmin(address _newPendingAdmin) external onlyAdmin {

     |  // @audit-issue Add NatSpec @dev
  32 |  function acceptAdmin() external {

     |  // @audit-issue Add NatSpec @dev
  45 |  function setValidator(address _validator, bool _active) external onlyStateTransitionManager {

     |  // @audit-issue Add NatSpec @dev
  51 |  function setPorterAvailability(bool _zkPorterIsAvailable) external onlyStateTransitionManager {

     |  // @audit-issue Add NatSpec @dev
  58 |  function setPriorityTxMaxGasLimit(uint256 _newPriorityTxMaxGasLimit) external onlyStateTransitionManager {

     |  // @audit-issue Add NatSpec @dev
  67 |  function changeFeeParams(FeeParams calldata _newFeeParams) external onlyAdminOrStateTransitionManager {

     |  // @audit-issue Add NatSpec @dev
  79 |  function setTokenMultiplier(uint128 _nominator, uint128 _denominator) external onlyAdminOrStateTransitionManager {

     |  // @audit-issue Add NatSpec @dev
  89 |  function setValidiumMode(PubdataPricingMode _validiumMode) external onlyAdmin {

     |  // @audit-issue Add NatSpec @dev
 100 |  function upgradeChainFromVersion(
 101 |      uint256 _oldProtocolVersion,
 102 |      Diamond.DiamondCutData calldata _diamondCut
 103 |  ) external onlyAdminOrStateTransitionManager {

     |  // @audit-issue Add NatSpec @dev
 123 |  function executeUpgrade(Diamond.DiamondCutData calldata _diamondCut) external onlyStateTransitionManager {

     |  // @audit-issue Add NatSpec @dev
 133 |  function freezeDiamond() external onlyAdminOrStateTransitionManager {

     |  // @audit-issue Add NatSpec @dev
 143 |  function unfreezeDiamond() external onlyAdminOrStateTransitionManager {
```
GitHub: [23](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L23), [32](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L32), [45](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L45), [51](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L51), [58](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L58), [67](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L67), [79](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L79), [89](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L89), [100-103](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L100-L103), [123](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L123), [133](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L133), [143](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L143)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

     |  // @audit-issue Add NatSpec @dev
 103 |  function _verifyBatchTimestamp(
 104 |      uint256 _packedBatchAndL2BlockTimestamp,
 105 |      uint256 _expectedBatchTimestamp,
 106 |      uint256 _previousBatchTimestamp
 107 |  ) internal view {

     |  // @audit-issue Add NatSpec @dev
 199 |  function commitBatches(
 200 |      StoredBatchInfo memory _lastCommittedBatchData,
 201 |      CommitBatchInfo[] calldata _newBatchesData
 202 |  ) external nonReentrant onlyValidator {

     |  // @audit-issue Add NatSpec @dev
 207 |  function commitBatchesSharedBridge(
 208 |      uint256, // _chainId
 209 |      StoredBatchInfo memory _lastCommittedBatchData,
 210 |      CommitBatchInfo[] calldata _newBatchesData
 211 |  ) external nonReentrant onlyValidator {

     |  // @audit-issue Add NatSpec @dev
 215 |  function _commitBatches(
 216 |      StoredBatchInfo memory _lastCommittedBatchData,
 217 |      CommitBatchInfo[] calldata _newBatchesData
 218 |  ) internal {

     |  // @audit-issue Add NatSpec @dev
 337 |  function executeBatchesSharedBridge(
 338 |      uint256,
 339 |      StoredBatchInfo[] calldata _batchesData
 340 |  ) external nonReentrant onlyValidator {

     |  // @audit-issue Add NatSpec @dev
 345 |  function executeBatches(StoredBatchInfo[] calldata _batchesData) external nonReentrant onlyValidator {

     |  // @audit-issue Add NatSpec @dev
 349 |  function _executeBatches(StoredBatchInfo[] calldata _batchesData) internal {

     |  // @audit-issue Add NatSpec @dev
 368 |  function proveBatches(
 369 |      StoredBatchInfo calldata _prevBatch,
 370 |      StoredBatchInfo[] calldata _committedBatches,
 371 |      ProofInput calldata _proof
 372 |  ) external nonReentrant onlyValidator {

     |  // @audit-issue Add NatSpec @dev
 377 |  function proveBatchesSharedBridge(
 378 |      uint256, // _chainId
 379 |      StoredBatchInfo calldata _prevBatch,
 380 |      StoredBatchInfo[] calldata _committedBatches,
 381 |      ProofInput calldata _proof
 382 |  ) external nonReentrant onlyValidator {

     |  // @audit-issue Add NatSpec @dev
 386 |  function _proveBatches(
 387 |      StoredBatchInfo calldata _prevBatch,
 388 |      StoredBatchInfo[] calldata _committedBatches,
 389 |      ProofInput calldata _proof
 390 |  ) internal {

     |  // @audit-issue Add NatSpec @dev
 440 |  function _verifyProof(uint256[] memory proofPublicInput, ProofInput calldata _proof) internal view {

     |  // @audit-issue Add NatSpec @dev
 472 |  function revertBatches(uint256 _newLastBatch) external nonReentrant onlyValidatorOrStateTransitionManager {

     |  // @audit-issue Add NatSpec @dev
 477 |  function revertBatchesSharedBridge(uint256, uint256 _newLastBatch) external nonReentrant onlyValidator {

     |  // @audit-issue Add NatSpec @dev
 481 |  function _revertBatches(uint256 _newLastBatch) internal {

     |  // @audit-issue Add NatSpec @dev
 515 |  function _batchPassThroughData(CommitBatchInfo calldata _batch) internal pure returns (bytes memory) {

     |  // @audit-issue Add NatSpec @dev
 525 |  function _batchMetaParameters() internal view returns (bytes memory) {

     |  // @audit-issue Add NatSpec @dev
 537 |  function _batchAuxiliaryOutput(
 538 |      CommitBatchInfo calldata _batch,
 539 |      bytes32 _stateDiffHash,
 540 |      bytes32[] memory _blobCommitments,
 541 |      bytes32[] memory _blobHashes
 542 |  ) internal pure returns (bytes memory) {

     |  // @audit-issue Add NatSpec @dev
 587 |  function _hashStoredBatchInfo(StoredBatchInfo memory _storedBatchInfo) internal pure returns (bytes32) {

     |  // @audit-issue Add NatSpec @dev
 592 |  function _checkBit(uint256 _bitMap, uint8 _index) internal pure returns (bool) {

     |  // @audit-issue Add NatSpec @dev
 597 |  function _setBit(uint256 _bitMap, uint8 _index) internal pure returns (uint256) {

     |  // @audit-issue Add NatSpec @dev
 605 |  function _pointEvaluationPrecompile(
 606 |      bytes32 _versionedHash,
 607 |      bytes32 _openingPoint,
 608 |      bytes calldata _openingValueCommitmentProof
 609 |  ) internal view {
```
GitHub: [103-107](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L103-L107), [199-202](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L199-L202), [207-211](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L207-L211), [215-218](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L215-L218), [337-340](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L337-L340), [345](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L345), [349](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L349), [368-372](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L368-L372), [377-382](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L377-L382), [386-390](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L386-L390), [440](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L440), [472](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L472), [477](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L477), [481](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L481), [515](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L515), [525](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L525), [537-542](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L537-L542), [587](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L587), [592](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L592), [597](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L597), [605-609](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L605-L609)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol

     |  // @audit-issue Add NatSpec @dev
  32 |  function getVerifier() external view returns (address) {

     |  // @audit-issue Add NatSpec @dev
  37 |  function getAdmin() external view returns (address) {

     |  // @audit-issue Add NatSpec @dev
  42 |  function getPendingAdmin() external view returns (address) {

     |  // @audit-issue Add NatSpec @dev
  47 |  function getBridgehub() external view returns (address) {

     |  // @audit-issue Add NatSpec @dev
  52 |  function getStateTransitionManager() external view returns (address) {

     |  // @audit-issue Add NatSpec @dev
  57 |  function getBaseToken() external view returns (address) {

     |  // @audit-issue Add NatSpec @dev
  62 |  function getBaseTokenBridge() external view returns (address) {

     |  // @audit-issue Add NatSpec @dev
  67 |  function baseTokenGasPriceMultiplierNominator() external view returns (uint128) {

     |  // @audit-issue Add NatSpec @dev
  72 |  function baseTokenGasPriceMultiplierDenominator() external view returns (uint128) {

     |  // @audit-issue Add NatSpec @dev
  77 |  function getTotalBatchesCommitted() external view returns (uint256) {

     |  // @audit-issue Add NatSpec @dev
  82 |  function getTotalBatchesVerified() external view returns (uint256) {

     |  // @audit-issue Add NatSpec @dev
  87 |  function getTotalBatchesExecuted() external view returns (uint256) {

     |  // @audit-issue Add NatSpec @dev
  92 |  function getTotalPriorityTxs() external view returns (uint256) {

     |  // @audit-issue Add NatSpec @dev
  97 |  function getFirstUnprocessedPriorityTx() external view returns (uint256) {

     |  // @audit-issue Add NatSpec @dev
 102 |  function getPriorityQueueSize() external view returns (uint256) {

     |  // @audit-issue Add NatSpec @dev
 107 |  function priorityQueueFrontOperation() external view returns (PriorityOperation memory) {

     |  // @audit-issue Add NatSpec @dev
 112 |  function isValidator(address _address) external view returns (bool) {

     |  // @audit-issue Add NatSpec @dev
 117 |  function l2LogsRootHash(uint256 _batchNumber) external view returns (bytes32) {

     |  // @audit-issue Add NatSpec @dev
 122 |  function storedBatchHash(uint256 _batchNumber) external view returns (bytes32) {

     |  // @audit-issue Add NatSpec @dev
 127 |  function getL2BootloaderBytecodeHash() external view returns (bytes32) {

     |  // @audit-issue Add NatSpec @dev
 132 |  function getL2DefaultAccountBytecodeHash() external view returns (bytes32) {

     |  // @audit-issue Add NatSpec @dev
 137 |  function getVerifierParams() external view returns (VerifierParams memory) {

     |  // @audit-issue Add NatSpec @dev
 142 |  function getProtocolVersion() external view returns (uint256) {

     |  // @audit-issue Add NatSpec @dev
 147 |  function getL2SystemContractsUpgradeTxHash() external view returns (bytes32) {

     |  // @audit-issue Add NatSpec @dev
 152 |  function getL2SystemContractsUpgradeBatchNumber() external view returns (uint256) {

     |  // @audit-issue Add NatSpec @dev
 157 |  function isDiamondStorageFrozen() external view returns (bool) {

     |  // @audit-issue Add NatSpec @dev
 163 |  function isFacetFreezable(address _facet) external view returns (bool isFreezable) {

     |  // @audit-issue Add NatSpec @dev
 176 |  function getPriorityTxMaxGasLimit() external view returns (uint256) {

     |  // @audit-issue Add NatSpec @dev
 181 |  function isFunctionFreezable(bytes4 _selector) external view returns (bool) {

     |  // @audit-issue Add NatSpec @dev
 188 |  function isEthWithdrawalFinalized(uint256 _l2BatchNumber, uint256 _l2MessageIndex) external view returns (bool) {

     |  // @audit-issue Add NatSpec @dev
 193 |  function getPubdataPricingMode() external view returns (PubdataPricingMode) {
```
GitHub: [32](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L32), [37](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L37), [42](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L42), [47](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L47), [52](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L52), [57](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L57), [62](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L62), [67](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L67), [72](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L72), [77](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L77), [82](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L82), [87](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L87), [92](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L92), [97](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L97), [102](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L102), [107](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L107), [112](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L112), [117](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L117), [122](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L122), [127](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L127), [132](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L132), [137](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L137), [142](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L142), [147](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L147), [152](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L152), [157](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L157), [163](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L163), [176](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L176), [181](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L181), [188](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L188), [193](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L193)


## [N-71] NatSpec: Function definitions should have `@notice` tags

`@notice` is used to explain to end users what the function does, and the compiler interprets `///` or `/**` comments as this tag if one wasn't explicitly provided.

*Instances: 99*

```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

     |  // @audit-issue Add NatSpec @notice
  55 |  constructor(IL1SharedBridge _sharedBridge) reentrancyGuardInitializer {

     |  // @audit-issue Add NatSpec @notice
  60 |  function initialize() external reentrancyGuardInitializer {}

     |  // @audit-issue Add NatSpec @notice
  63 |  function tranferTokenToSharedBridge(address _token, uint256 _amount) external {

     |  // @audit-issue Add NatSpec @notice
  75 |  function l2TokenAddress(address _l1Token) external view returns (address) {

     |  // @audit-issue Add NatSpec @notice
 160 |  function _depositFundsToSharedBridge(address _from, IERC20 _token, uint256 _amount) internal returns (uint256) {

     |  // @audit-issue Add NatSpec @notice
 176 |  function claimFailedDeposit(
 177 |      address _depositSender,
 178 |      address _l1Token,
 179 |      bytes32 _l2TxHash,
 180 |      uint256 _l2BatchNumber,
 181 |      uint256 _l2MessageIndex,
 182 |      uint16 _l2TxNumberInBatch,
 183 |      bytes32[] calldata _merkleProof
 184 |  ) external nonReentrant {
```
GitHub: [55](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L55), [60](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L60), [63](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L63), [75](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L75), [160](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L160), [176-184](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L176-L184)


```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

     |  // @audit-issue Add NatSpec @notice
  90 |  constructor(
  91 |      address _l1WethAddress,
  92 |      IBridgehub _bridgehub,
  93 |      IL1ERC20Bridge _legacyBridge
  94 |  ) reentrancyGuardInitializer {

     |  // @audit-issue Add NatSpec @notice
 104 |  function initialize(
 105 |      address _owner,
 106 |      uint256 _eraFirstPostUpgradeBatch
 107 |  ) external reentrancyGuardInitializer initializer {

     |  // @audit-issue Add NatSpec @notice
 116 |  function transferFundsFromLegacy(address _token, address _target, uint256 _targetChainId) external onlyOwner {

     |  // @audit-issue Add NatSpec @notice
 137 |  function receiveEth(uint256 _chainId) external payable {

     |  // @audit-issue Add NatSpec @notice
 142 |  function initializeChainGovernance(uint256 _chainId, address _l2BridgeAddress) external onlyOwner {

     |  // @audit-issue Add NatSpec @notice
 173 |  function _depositFunds(address _from, IERC20 _token, uint256 _amount) internal returns (uint256) {

     |  // @audit-issue Add NatSpec @notice
 243 |  function _getDepositL2Calldata(
 244 |      address _l1Sender,
 245 |      address _l2Receiver,
 246 |      address _l1Token,
 247 |      uint256 _amount
 248 |  ) internal view returns (bytes memory) {

     |  // @audit-issue Add NatSpec @notice
 254 |  function _getERC20Getters(address _token) internal view returns (bytes memory) {

     |  // @audit-issue Add NatSpec @notice
 277 |  function claimFailedDeposit(
 278 |      uint256 _chainId,
 279 |      address _depositSender,
 280 |      address _l1Token,
 281 |      uint256 _amount,
 282 |      bytes32 _l2TxHash,
 283 |      uint256 _l2BatchNumber,
 284 |      uint256 _l2MessageIndex,
 285 |      uint16 _l2TxNumberInBatch,
 286 |      bytes32[] calldata _merkleProof
 287 |  ) external override {

     |  // @audit-issue Add NatSpec @notice
 303 |  function _claimFailedDeposit(
 304 |      bool _checkedInLegacyBridge,
 305 |      uint256 _chainId,
 306 |      address _depositSender,
 307 |      address _l1Token,
 308 |      uint256 _amount,
 309 |      bytes32 _l2TxHash,
 310 |      uint256 _l2BatchNumber,
 311 |      uint256 _l2MessageIndex,
 312 |      uint16 _l2TxNumberInBatch,
 313 |      bytes32[] calldata _merkleProof
 314 |  ) internal nonReentrant {

     |  // @audit-issue Add NatSpec @notice
 374 |  function _isEraLegacyWithdrawal(uint256 _chainId, uint256 _l2BatchNumber) internal view returns (bool) {

     |  // @audit-issue Add NatSpec @notice
 409 |  function _finalizeWithdrawal(
 410 |      uint256 _chainId,
 411 |      uint256 _l2BatchNumber,
 412 |      uint256 _l2MessageIndex,
 413 |      uint16 _l2TxNumberInBatch,
 414 |      bytes calldata _message,
 415 |      bytes32[] calldata _merkleProof
 416 |  ) internal nonReentrant returns (address l1Receiver, address l1Token, uint256 amount) {

     |  // @audit-issue Add NatSpec @notice
 458 |  function _checkWithdrawal(
 459 |      uint256 _chainId,
 460 |      MessageParams memory _messageParams,
 461 |      bytes calldata _message,
 462 |      bytes32[] calldata _merkleProof
 463 |  ) internal view returns (address l1Receiver, address l1Token, uint256 amount) {

     |  // @audit-issue Add NatSpec @notice
 487 |  function _parseL2WithdrawalMessage(
 488 |      uint256 _chainId,
 489 |      bytes memory _l2ToL1message
 490 |  ) internal view returns (address l1Receiver, address l1Token, uint256 amount) {
```
GitHub: [90-94](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L90-L94), [104-107](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L104-L107), [116](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L116), [137](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L137), [142](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L142), [173](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L173), [243-248](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L243-L248), [254](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L254), [277-287](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L277-L287), [303-314](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L303-L314), [374](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L374), [409-416](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L409-L416), [458-463](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L458-L463), [487-490](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L487-L490)


```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

     |  // @audit-issue Add NatSpec @notice
  51 |  function setPendingAdmin(address _newPendingAdmin) external onlyOwnerOrAdmin {

     |  // @audit-issue Add NatSpec @notice
  60 |  function acceptAdmin() external {

     |  // @audit-issue Add NatSpec @notice
 325 |  function _actualRefundRecipient(address _refundRecipient) internal view returns (address _recipient) {
```
GitHub: [51](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L51), [60](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L60), [325](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L325)


```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

     |  // @audit-issue Add NatSpec @notice
  84 |  function isOperation(bytes32 _id) public view returns (bool) {

     |  // @audit-issue Add NatSpec @notice
  89 |  function isOperationPending(bytes32 _id) public view returns (bool) {

     |  // @audit-issue Add NatSpec @notice
  95 |  function isOperationReady(bytes32 _id) public view returns (bool) {

     |  // @audit-issue Add NatSpec @notice
 100 |  function isOperationDone(bytes32 _id) public view returns (bool) {

     |  // @audit-issue Add NatSpec @notice
 105 |  function getOperationState(bytes32 _id) public view returns (OperationState) {

     |  // @audit-issue Add NatSpec @notice
 154 |  function cancel(bytes32 _id) external onlyOwner {

     |  // @audit-issue Add NatSpec @notice
 204 |  function hashOperation(Operation calldata _operation) public pure returns (bytes32) {

     |  // @audit-issue Add NatSpec @notice
 215 |  function _schedule(bytes32 _id, uint256 _delay) internal {

     |  // @audit-issue Add NatSpec @notice
 224 |  function _execute(Call[] calldata _calls) internal {

     |  // @audit-issue Add NatSpec @notice
 249 |  function updateDelay(uint256 _newDelay) external onlySelf {

     |  // @audit-issue Add NatSpec @notice
 256 |  function updateSecurityCouncil(address _newSecurityCouncil) external onlySelf {

     |  // @audit-issue Add NatSpec @notice
 262 |  receive() external payable {}
```
GitHub: [84](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L84), [89](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L89), [95](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L95), [100](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L100), [105](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L105), [154](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L154), [204](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L204), [215](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L215), [224](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L224), [249](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L249), [256](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L256), [262](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L262)


```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

     |  // @audit-issue Add NatSpec @notice
  60 |  constructor(address _bridgehub) reentrancyGuardInitializer {

     |  // @audit-issue Add NatSpec @notice
  76 |  function getChainAdmin(uint256 _chainId) external view override returns (address) {

     |  // @audit-issue Add NatSpec @notice
  81 |  function initialize(
  82 |      StateTransitionManagerInitializeData calldata _initializeData
  83 |  ) external reentrancyGuardInitializer {

     |  // @audit-issue Add NatSpec @notice
 112 |  function setPendingAdmin(address _newPendingAdmin) external onlyOwnerOrAdmin {

     |  // @audit-issue Add NatSpec @notice
 121 |  function acceptAdmin() external {

     |  // @audit-issue Add NatSpec @notice
 134 |  function setValidatorTimelock(address _validatorTimelock) external onlyOwnerOrAdmin {

     |  // @audit-issue Add NatSpec @notice
 139 |  function setInitialCutHash(Diamond.DiamondCutData calldata _diamondCut) external onlyOwner {

     |  // @audit-issue Add NatSpec @notice
 144 |  function setNewVersionUpgrade(
 145 |      Diamond.DiamondCutData calldata _cutData,
 146 |      uint256 _oldProtocolVersion,
 147 |      uint256 _newProtocolVersion
 148 |  ) external onlyOwner {

     |  // @audit-issue Add NatSpec @notice
 154 |  function setUpgradeDiamondCut(
 155 |      Diamond.DiamondCutData calldata _cutData,
 156 |      uint256 _oldProtocolVersion
 157 |  ) external onlyOwner {

     |  // @audit-issue Add NatSpec @notice
 162 |  function freezeChain(uint256 _chainId) external onlyOwner {

     |  // @audit-issue Add NatSpec @notice
 167 |  function unfreezeChain(uint256 _chainId) external onlyOwner {

     |  // @audit-issue Add NatSpec @notice
 172 |  function revertBatches(uint256 _chainId, uint256 _newLastBatch) external onlyOwnerOrAdmin {

     |  // @audit-issue Add NatSpec @notice
 179 |  function _setChainIdUpgrade(uint256 _chainId, address _chainContract) internal {

     |  // @audit-issue Add NatSpec @notice
 232 |  function registerAlreadyDeployedStateTransition(
 233 |      uint256 _chainId,
 234 |      address _stateTransitionContract
 235 |  ) external onlyOwner {
```
GitHub: [60](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L60), [76](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L76), [81-83](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L81-L83), [112](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L112), [121](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L121), [134](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L134), [139](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L139), [144-148](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L144-L148), [154-157](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L154-L157), [162](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L162), [167](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L167), [172](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L172), [179](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L179), [232-235](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L232-L235)


```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

     |  // @audit-issue Add NatSpec @notice
  55 |  constructor(address _initialOwner, uint32 _executionDelay) {

     |  // @audit-issue Add NatSpec @notice
  73 |  function setStateTransitionManager(IStateTransitionManager _stateTransitionManager) external onlyOwner {

     |  // @audit-issue Add NatSpec @notice
  78 |  function addValidator(uint256 _chainId, address _newValidator) external onlyChainAdmin(_chainId) {

     |  // @audit-issue Add NatSpec @notice
  87 |  function removeValidator(uint256 _chainId, address _validator) external onlyChainAdmin(_chainId) {

     |  // @audit-issue Add NatSpec @notice
  96 |  function setExecutionDelay(uint32 _executionDelay) external onlyOwner {

     |  // @audit-issue Add NatSpec @notice
 102 |  function getCommittedBatchTimestamp(uint256 _chainId, uint256 _l2BatchNumber) external view returns (uint256) {

     |  // @audit-issue Add NatSpec @notice
 108 |  function commitBatches(
 109 |      StoredBatchInfo calldata,
 110 |      CommitBatchInfo[] calldata _newBatchesData
 111 |  ) external onlyValidator(ERA_CHAIN_ID) {

     |  // @audit-issue Add NatSpec @notice
 126 |  function commitBatchesSharedBridge(
 127 |      uint256 _chainId,
 128 |      StoredBatchInfo calldata,
 129 |      CommitBatchInfo[] calldata _newBatchesData
 130 |  ) external onlyValidator(_chainId) {

     |  // @audit-issue Add NatSpec @notice
 146 |  function revertBatches(uint256) external onlyValidator(ERA_CHAIN_ID) {

     |  // @audit-issue Add NatSpec @notice
 153 |  function revertBatchesSharedBridge(uint256 _chainId, uint256) external onlyValidator(_chainId) {

     |  // @audit-issue Add NatSpec @notice
 160 |  function proveBatches(
 161 |      StoredBatchInfo calldata,
 162 |      StoredBatchInfo[] calldata,
 163 |      ProofInput calldata
 164 |  ) external onlyValidator(ERA_CHAIN_ID) {

     |  // @audit-issue Add NatSpec @notice
 171 |  function proveBatchesSharedBridge(
 172 |      uint256 _chainId,
 173 |      StoredBatchInfo calldata,
 174 |      StoredBatchInfo[] calldata,
 175 |      ProofInput calldata
 176 |  ) external onlyValidator(_chainId) {

     |  // @audit-issue Add NatSpec @notice
 182 |  function executeBatches(StoredBatchInfo[] calldata _newBatchesData) external onlyValidator(ERA_CHAIN_ID) {

     |  // @audit-issue Add NatSpec @notice
 203 |  function executeBatchesSharedBridge(
 204 |      uint256 _chainId,
 205 |      StoredBatchInfo[] calldata _newBatchesData
 206 |  ) external onlyValidator(_chainId) {

     |  // @audit-issue Add NatSpec @notice
 225 |  function _propagateToZkSyncStateTransition(uint256 _chainId) internal {
```
GitHub: [55](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L55), [73](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L73), [78](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L78), [87](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L87), [96](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L96), [102](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L102), [108-111](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L108-L111), [126-130](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L126-L130), [146](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L146), [153](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L153), [160-164](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L160-L164), [171-176](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L171-L176), [182](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L182), [203-206](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L203-L206), [225](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L225)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol

     |  // @audit-issue Add NatSpec @notice
  19 |  constructor() reentrancyGuardInitializer {}
```
GitHub: [19](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol#L19)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol

     |  // @audit-issue Add NatSpec @notice
  11 |  constructor(uint256 _chainId, Diamond.DiamondCutData memory _diamondCut) {

     |  // @audit-issue Add NatSpec @notice
  20 |  fallback() external payable {
```
GitHub: [11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol#L11), [20](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol#L20)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol

     |  // @audit-issue Add NatSpec @notice
  23 |  function setPendingAdmin(address _newPendingAdmin) external onlyAdmin {

     |  // @audit-issue Add NatSpec @notice
  32 |  function acceptAdmin() external {

     |  // @audit-issue Add NatSpec @notice
  45 |  function setValidator(address _validator, bool _active) external onlyStateTransitionManager {

     |  // @audit-issue Add NatSpec @notice
  51 |  function setPorterAvailability(bool _zkPorterIsAvailable) external onlyStateTransitionManager {

     |  // @audit-issue Add NatSpec @notice
  58 |  function setPriorityTxMaxGasLimit(uint256 _newPriorityTxMaxGasLimit) external onlyStateTransitionManager {

     |  // @audit-issue Add NatSpec @notice
  67 |  function changeFeeParams(FeeParams calldata _newFeeParams) external onlyAdminOrStateTransitionManager {

     |  // @audit-issue Add NatSpec @notice
  79 |  function setTokenMultiplier(uint128 _nominator, uint128 _denominator) external onlyAdminOrStateTransitionManager {

     |  // @audit-issue Add NatSpec @notice
  89 |  function setValidiumMode(PubdataPricingMode _validiumMode) external onlyAdmin {

     |  // @audit-issue Add NatSpec @notice
 100 |  function upgradeChainFromVersion(
 101 |      uint256 _oldProtocolVersion,
 102 |      Diamond.DiamondCutData calldata _diamondCut
 103 |  ) external onlyAdminOrStateTransitionManager {

     |  // @audit-issue Add NatSpec @notice
 123 |  function executeUpgrade(Diamond.DiamondCutData calldata _diamondCut) external onlyStateTransitionManager {

     |  // @audit-issue Add NatSpec @notice
 133 |  function freezeDiamond() external onlyAdminOrStateTransitionManager {

     |  // @audit-issue Add NatSpec @notice
 143 |  function unfreezeDiamond() external onlyAdminOrStateTransitionManager {
```
GitHub: [23](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L23), [32](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L32), [45](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L45), [51](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L51), [58](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L58), [67](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L67), [79](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L79), [89](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L89), [100-103](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L100-L103), [123](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L123), [133](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L133), [143](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L143)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

     |  // @audit-issue Add NatSpec @notice
 130 |  function _processL2Logs(
 131 |      CommitBatchInfo calldata _newBatch,
 132 |      bytes32 _expectedSystemContractUpgradeTxHash
 133 |  ) internal pure returns (LogProcessingOutput memory logOutput) {

     |  // @audit-issue Add NatSpec @notice
 199 |  function commitBatches(
 200 |      StoredBatchInfo memory _lastCommittedBatchData,
 201 |      CommitBatchInfo[] calldata _newBatchesData
 202 |  ) external nonReentrant onlyValidator {

     |  // @audit-issue Add NatSpec @notice
 207 |  function commitBatchesSharedBridge(
 208 |      uint256, // _chainId
 209 |      StoredBatchInfo memory _lastCommittedBatchData,
 210 |      CommitBatchInfo[] calldata _newBatchesData
 211 |  ) external nonReentrant onlyValidator {

     |  // @audit-issue Add NatSpec @notice
 215 |  function _commitBatches(
 216 |      StoredBatchInfo memory _lastCommittedBatchData,
 217 |      CommitBatchInfo[] calldata _newBatchesData
 218 |  ) internal {

     |  // @audit-issue Add NatSpec @notice
 253 |  function _commitBatchesWithoutSystemContractsUpgrade(
 254 |      StoredBatchInfo memory _lastCommittedBatchData,
 255 |      CommitBatchInfo[] calldata _newBatchesData
 256 |  ) internal {

     |  // @audit-issue Add NatSpec @notice
 273 |  function _commitBatchesWithSystemContractsUpgrade(
 274 |      StoredBatchInfo memory _lastCommittedBatchData,
 275 |      CommitBatchInfo[] calldata _newBatchesData,
 276 |      bytes32 _systemContractUpgradeTxHash
 277 |  ) internal {

     |  // @audit-issue Add NatSpec @notice
 308 |  function _collectOperationsFromPriorityQueue(uint256 _nPriorityOps) internal returns (bytes32 concatHash) {

     |  // @audit-issue Add NatSpec @notice
 321 |  function _executeOneBatch(StoredBatchInfo memory _storedBatch, uint256 _executedBatchIdx) internal {

     |  // @audit-issue Add NatSpec @notice
 337 |  function executeBatchesSharedBridge(
 338 |      uint256,
 339 |      StoredBatchInfo[] calldata _batchesData
 340 |  ) external nonReentrant onlyValidator {

     |  // @audit-issue Add NatSpec @notice
 345 |  function executeBatches(StoredBatchInfo[] calldata _batchesData) external nonReentrant onlyValidator {

     |  // @audit-issue Add NatSpec @notice
 349 |  function _executeBatches(StoredBatchInfo[] calldata _batchesData) internal {

     |  // @audit-issue Add NatSpec @notice
 368 |  function proveBatches(
 369 |      StoredBatchInfo calldata _prevBatch,
 370 |      StoredBatchInfo[] calldata _committedBatches,
 371 |      ProofInput calldata _proof
 372 |  ) external nonReentrant onlyValidator {

     |  // @audit-issue Add NatSpec @notice
 377 |  function proveBatchesSharedBridge(
 378 |      uint256, // _chainId
 379 |      StoredBatchInfo calldata _prevBatch,
 380 |      StoredBatchInfo[] calldata _committedBatches,
 381 |      ProofInput calldata _proof
 382 |  ) external nonReentrant onlyValidator {

     |  // @audit-issue Add NatSpec @notice
 386 |  function _proveBatches(
 387 |      StoredBatchInfo calldata _prevBatch,
 388 |      StoredBatchInfo[] calldata _committedBatches,
 389 |      ProofInput calldata _proof
 390 |  ) internal {

     |  // @audit-issue Add NatSpec @notice
 440 |  function _verifyProof(uint256[] memory proofPublicInput, ProofInput calldata _proof) internal view {

     |  // @audit-issue Add NatSpec @notice
 453 |  function _getBatchProofPublicInput(
 454 |      bytes32 _prevBatchCommitment,
 455 |      bytes32 _currentBatchCommitment,
 456 |      VerifierParams memory _verifierParams
 457 |  ) internal pure returns (uint256) {

     |  // @audit-issue Add NatSpec @notice
 472 |  function revertBatches(uint256 _newLastBatch) external nonReentrant onlyValidatorOrStateTransitionManager {

     |  // @audit-issue Add NatSpec @notice
 477 |  function revertBatchesSharedBridge(uint256, uint256 _newLastBatch) external nonReentrant onlyValidator {

     |  // @audit-issue Add NatSpec @notice
 481 |  function _revertBatches(uint256 _newLastBatch) internal {

     |  // @audit-issue Add NatSpec @notice
 500 |  function _createBatchCommitment(
 501 |      CommitBatchInfo calldata _newBatchData,
 502 |      bytes32 _stateDiffHash,
 503 |      bytes32[] memory _blobCommitments,
 504 |      bytes32[] memory _blobHashes
 505 |  ) internal view returns (bytes32) {
```
GitHub: [130-133](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L130-L133), [199-202](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L199-L202), [207-211](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L207-L211), [215-218](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L215-L218), [253-256](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L253-L256), [273-277](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L273-L277), [308](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L308), [321](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L321), [337-340](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L337-L340), [345](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L345), [349](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L349), [368-372](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L368-L372), [377-382](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L377-L382), [386-390](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L386-L390), [440](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L440), [453-457](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L453-L457), [472](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L472), [477](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L477), [481](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L481), [500-505](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L500-L505)


## [N-72] NatSpec: Function definitions should have descriptions

e.g. `@dev` or `@notice`, and it must appear above the function definition braces in order to be identified by the compiler as NatSpec.

*Instances: 99*

```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

     |  // @audit-issue Add NatSpec function documentation
 137 |  function receiveEth(uint256 _chainId) external payable {

     |  // @audit-issue Add NatSpec function documentation
 487 |  function _parseL2WithdrawalMessage(
 488 |      uint256 _chainId,
 489 |      bytes memory _l2ToL1message
 490 |  ) internal view returns (address l1Receiver, address l1Token, uint256 amount) {
```
GitHub: [137](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L137), [487-490](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L487-L490)


```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

     |  // @audit-issue Add NatSpec function documentation
 325 |  function _actualRefundRecipient(address _refundRecipient) internal view returns (address _recipient) {
```
GitHub: [325](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L325)


```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

     |  // @audit-issue Add NatSpec function documentation
  76 |  function getChainAdmin(uint256 _chainId) external view override returns (address) {

     |  // @audit-issue Add NatSpec function documentation
 232 |  function registerAlreadyDeployedStateTransition(
 233 |      uint256 _chainId,
 234 |      address _stateTransitionContract
 235 |  ) external onlyOwner {
```
GitHub: [76](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L76), [232-235](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L232-L235)


```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

     |  // @audit-issue Add NatSpec function documentation
  55 |  constructor(address _initialOwner, uint32 _executionDelay) {
```
GitHub: [55](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L55)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol

     |  // @audit-issue Add NatSpec function documentation
  11 |  constructor(uint256 _chainId, Diamond.DiamondCutData memory _diamondCut) {
```
GitHub: [11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol#L11)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol

     |  // @audit-issue Add NatSpec function documentation
  89 |  function setValidiumMode(PubdataPricingMode _validiumMode) external onlyAdmin {
```
GitHub: [89](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L89)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

     |  // @audit-issue Add NatSpec function documentation
 215 |  function _commitBatches(
 216 |      StoredBatchInfo memory _lastCommittedBatchData,
 217 |      CommitBatchInfo[] calldata _newBatchesData
 218 |  ) internal {

     |  // @audit-issue Add NatSpec function documentation
 349 |  function _executeBatches(StoredBatchInfo[] calldata _batchesData) internal {

     |  // @audit-issue Add NatSpec function documentation
 386 |  function _proveBatches(
 387 |      StoredBatchInfo calldata _prevBatch,
 388 |      StoredBatchInfo[] calldata _committedBatches,
 389 |      ProofInput calldata _proof
 390 |  ) internal {

     |  // @audit-issue Add NatSpec function documentation
 440 |  function _verifyProof(uint256[] memory proofPublicInput, ProofInput calldata _proof) internal view {

     |  // @audit-issue Add NatSpec function documentation
 481 |  function _revertBatches(uint256 _newLastBatch) internal {

     |  // @audit-issue Add NatSpec function documentation
 515 |  function _batchPassThroughData(CommitBatchInfo calldata _batch) internal pure returns (bytes memory) {

     |  // @audit-issue Add NatSpec function documentation
 525 |  function _batchMetaParameters() internal view returns (bytes memory) {

     |  // @audit-issue Add NatSpec function documentation
 537 |  function _batchAuxiliaryOutput(
 538 |      CommitBatchInfo calldata _batch,
 539 |      bytes32 _stateDiffHash,
 540 |      bytes32[] memory _blobCommitments,
 541 |      bytes32[] memory _blobHashes
 542 |  ) internal pure returns (bytes memory) {
```
GitHub: [215-218](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L215-L218), [349](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L349), [386-390](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L386-L390), [440](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L440), [481](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L481), [515](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L515), [525](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L525), [537-542](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L537-L542)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

     |  // @audit-issue Add NatSpec function documentation
 228 |  function _requestL2TransactionSender(
 229 |      BridgehubL2TransactionRequest memory _request
 230 |  ) internal nonReentrant returns (bytes32 canonicalTxHash) {

     |  // @audit-issue Add NatSpec function documentation
 258 |  function _requestL2Transaction(
 259 |      uint256 _mintValue,
 260 |      WritePriorityOpParams memory _params,
 261 |      bytes memory _calldata,
 262 |      bytes[] memory _factoryDeps
 263 |  ) internal returns (bytes32 canonicalTxHash) {

     |  // @audit-issue Add NatSpec function documentation
 289 |  function _serializeL2Transaction(
 290 |      WritePriorityOpParams memory _priorityOpParams,
 291 |      bytes memory _calldata,
 292 |      bytes[] memory _factoryDeps
 293 |  ) internal pure returns (L2CanonicalTransaction memory transaction) {
```
GitHub: [228-230](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L228-L230), [258-263](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L258-L263), [289-293](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L289-L293)


```solidity
File: code/contracts/ethereum/contracts/common/libraries/UncheckedMath.sol

     |  // @audit-issue Add NatSpec function documentation
  11 |  function uncheckedInc(uint256 _number) internal pure returns (uint256) {

     |  // @audit-issue Add NatSpec function documentation
  17 |  function uncheckedAdd(uint256 _lhs, uint256 _rhs) internal pure returns (uint256) {
```
GitHub: [11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/UncheckedMath.sol#L11), [17](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/UncheckedMath.sol#L17)


```solidity
File: code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol

     |  // @audit-issue Add NatSpec function documentation
  19 |  function readUint32(bytes memory _bytes, uint256 _start) internal pure returns (uint32 result, uint256 offset) {

     |  // @audit-issue Add NatSpec function documentation
  26 |  function readAddress(bytes memory _bytes, uint256 _start) internal pure returns (address result, uint256 offset) {

     |  // @audit-issue Add NatSpec function documentation
  33 |  function readUint256(bytes memory _bytes, uint256 _start) internal pure returns (uint256 result, uint256 offset) {

     |  // @audit-issue Add NatSpec function documentation
  40 |  function readBytes32(bytes memory _bytes, uint256 _start) internal pure returns (bytes32 result, uint256 offset) {
```
GitHub: [19](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol#L19), [26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol#L26), [33](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol#L33), [40](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol#L40)


```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol

     |  // @audit-issue Add NatSpec function documentation
  24 |  function isWithdrawalFinalized(uint256 _l2BatchNumber, uint256 _l2MessageIndex) external view returns (bool);

     |  // @audit-issue Add NatSpec function documentation
  26 |  function deposit(
  27 |      address _l2Receiver,
  28 |      address _l1Token,
  29 |      uint256 _amount,
  30 |      uint256 _l2TxGasLimit,
  31 |      uint256 _l2TxGasPerPubdataByte,
  32 |      address _refundRecipient
  33 |  ) external payable returns (bytes32 txHash);

     |  // @audit-issue Add NatSpec function documentation
  35 |  function deposit(
  36 |      address _l2Receiver,
  37 |      address _l1Token,
  38 |      uint256 _amount,
  39 |      uint256 _l2TxGasLimit,
  40 |      uint256 _l2TxGasPerPubdataByte
  41 |  ) external payable returns (bytes32 txHash);

     |  // @audit-issue Add NatSpec function documentation
  43 |  function claimFailedDeposit(
  44 |      address _depositSender,
  45 |      address _l1Token,
  46 |      bytes32 _l2TxHash,
  47 |      uint256 _l2BatchNumber,
  48 |      uint256 _l2MessageIndex,
  49 |      uint16 _l2TxNumberInBatch,
  50 |      bytes32[] calldata _merkleProof
  51 |  ) external;

     |  // @audit-issue Add NatSpec function documentation
  53 |  function finalizeWithdrawal(
  54 |      uint256 _l2BatchNumber,
  55 |      uint256 _l2MessageIndex,
  56 |      uint16 _l2TxNumberInBatch,
  57 |      bytes calldata _message,
  58 |      bytes32[] calldata _merkleProof
  59 |  ) external;

     |  // @audit-issue Add NatSpec function documentation
  61 |  function l2TokenAddress(address _l1Token) external view returns (address);

     |  // @audit-issue Add NatSpec function documentation
  63 |  function sharedBridge() external view returns (IL1SharedBridge);

     |  // @audit-issue Add NatSpec function documentation
  65 |  function l2TokenBeacon() external view returns (address);

     |  // @audit-issue Add NatSpec function documentation
  67 |  function l2Bridge() external view returns (address);

     |  // @audit-issue Add NatSpec function documentation
  69 |  function depositAmount(
  70 |      address _account,
  71 |      address _l1Token,
  72 |      bytes32 _depositL2TxHash
  73 |  ) external returns (uint256 amount);

     |  // @audit-issue Add NatSpec function documentation
  75 |  function tranferTokenToSharedBridge(address _token, uint256 _amount) external;
```
GitHub: [24](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L24), [26-33](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L26-L33), [35-41](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L35-L41), [43-51](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L43-L51), [53-59](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L53-L59), [61](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L61), [63](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L63), [65](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L65), [67](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L67), [69-73](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L69-L73), [75](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L75)


```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol

     |  // @audit-issue Add NatSpec function documentation
  58 |  function isWithdrawalFinalized(
  59 |      uint256 _chainId,
  60 |      uint256 _l2BatchNumber,
  61 |      uint256 _l2MessageIndex
  62 |  ) external view returns (bool);

     |  // @audit-issue Add NatSpec function documentation
  64 |  function depositLegacyErc20Bridge(
  65 |      address _msgSender,
  66 |      address _l2Receiver,
  67 |      address _l1Token,
  68 |      uint256 _amount,
  69 |      uint256 _l2TxGasLimit,
  70 |      uint256 _l2TxGasPerPubdataByte,
  71 |      address _refundRecipient
  72 |  ) external payable returns (bytes32 txHash);

     |  // @audit-issue Add NatSpec function documentation
  74 |  function claimFailedDepositLegacyErc20Bridge(
  75 |      address _depositSender,
  76 |      address _l1Token,
  77 |      uint256 _amount,
  78 |      bytes32 _l2TxHash,
  79 |      uint256 _l2BatchNumber,
  80 |      uint256 _l2MessageIndex,
  81 |      uint16 _l2TxNumberInBatch,
  82 |      bytes32[] calldata _merkleProof
  83 |  ) external;

     |  // @audit-issue Add NatSpec function documentation
  85 |  function claimFailedDeposit(
  86 |      uint256 _chainId,
  87 |      address _depositSender,
  88 |      address _l1Token,
  89 |      uint256 _amount,
  90 |      bytes32 _l2TxHash,
  91 |      uint256 _l2BatchNumber,
  92 |      uint256 _l2MessageIndex,
  93 |      uint16 _l2TxNumberInBatch,
  94 |      bytes32[] calldata _merkleProof
  95 |  ) external;

     |  // @audit-issue Add NatSpec function documentation
  97 |  function finalizeWithdrawalLegacyErc20Bridge(
  98 |      uint256 _l2BatchNumber,
  99 |      uint256 _l2MessageIndex,
 100 |      uint16 _l2TxNumberInBatch,
 101 |      bytes calldata _message,
 102 |      bytes32[] calldata _merkleProof
 103 |  ) external returns (address l1Receiver, address l1Token, uint256 amount);

     |  // @audit-issue Add NatSpec function documentation
 105 |  function finalizeWithdrawal(
 106 |      uint256 _chainId,
 107 |      uint256 _l2BatchNumber,
 108 |      uint256 _l2MessageIndex,
 109 |      uint16 _l2TxNumberInBatch,
 110 |      bytes calldata _message,
 111 |      bytes32[] calldata _merkleProof
 112 |  ) external;

     |  // @audit-issue Add NatSpec function documentation
 114 |  function l1WethAddress() external view returns (address);

     |  // @audit-issue Add NatSpec function documentation
 116 |  function bridgehub() external view returns (IBridgehub);

     |  // @audit-issue Add NatSpec function documentation
 118 |  function legacyBridge() external view returns (IL1ERC20Bridge);

     |  // @audit-issue Add NatSpec function documentation
 120 |  function l2BridgeAddress(uint256 _chainId) external view returns (address);

     |  // @audit-issue Add NatSpec function documentation
 122 |  function depositHappened(uint256 _chainId, bytes32 _l2TxHash) external view returns (bytes32);

     |  // @audit-issue Add NatSpec function documentation
 135 |  function bridgehubDepositBaseToken(
 136 |      uint256 _chainId,
 137 |      address _prevMsgSender,
 138 |      address _l1Token,
 139 |      uint256 _amount
 140 |  ) external payable;

     |  // @audit-issue Add NatSpec function documentation
 142 |  function bridgehubConfirmL2Transaction(uint256 _chainId, bytes32 _txDataHash, bytes32 _txHash) external;

     |  // @audit-issue Add NatSpec function documentation
 144 |  function receiveEth(uint256 _chainId) external payable;
```
GitHub: [58-62](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L58-L62), [64-72](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L64-L72), [74-83](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L74-L83), [85-95](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L85-L95), [97-103](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L97-L103), [105-112](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L105-L112), [114](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L114), [116](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L116), [118](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L118), [120](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L120), [122](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L122), [135-140](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L135-L140), [142](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L142), [144](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L144)


```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL2Bridge.sol

     |  // @audit-issue Add NatSpec function documentation
   7 |  function finalizeDeposit(
   8 |      address _l1Sender,
   9 |      address _l2Receiver,
  10 |      address _l1Token,
  11 |      uint256 _amount,
  12 |      bytes calldata _data
  13 |  ) external payable;

     |  // @audit-issue Add NatSpec function documentation
  15 |  function withdraw(address _l1Receiver, address _l2Token, uint256 _amount) external;

     |  // @audit-issue Add NatSpec function documentation
  17 |  function l1TokenAddress(address _l2Token) external view returns (address);

     |  // @audit-issue Add NatSpec function documentation
  19 |  function l2TokenAddress(address _l1Token) external view returns (address);

     |  // @audit-issue Add NatSpec function documentation
  21 |  function l1Bridge() external view returns (address);
```
GitHub: [7-13](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL2Bridge.sol#L7-L13), [15](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL2Bridge.sol#L15), [17](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL2Bridge.sol#L17), [19](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL2Bridge.sol#L19), [21](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL2Bridge.sol#L21)


```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IWETH9.sol

     |  // @audit-issue Add NatSpec function documentation
   5 |  function deposit() external payable;

     |  // @audit-issue Add NatSpec function documentation
   7 |  function withdraw(uint256 wad) external;
```
GitHub: [5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IWETH9.sol#L5), [7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IWETH9.sol#L7)


```solidity
File: code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol

     |  // @audit-issue Add NatSpec function documentation
  61 |  function stateTransitionManager(uint256 _chainId) external view returns (address);

     |  // @audit-issue Add NatSpec function documentation
  63 |  function tokenIsRegistered(address _baseToken) external view returns (bool);

     |  // @audit-issue Add NatSpec function documentation
  65 |  function baseToken(uint256 _chainId) external view returns (address);

     |  // @audit-issue Add NatSpec function documentation
  67 |  function sharedBridge() external view returns (IL1SharedBridge);

     |  // @audit-issue Add NatSpec function documentation
  69 |  function getStateTransition(uint256 _chainId) external view returns (address);

     |  // @audit-issue Add NatSpec function documentation
  81 |  function proveL2LogInclusion(
  82 |      uint256 _chainId,
  83 |      uint256 _batchNumber,
  84 |      uint256 _index,
  85 |      L2Log memory _log,
  86 |      bytes32[] calldata _proof
  87 |  ) external view returns (bool);

     |  // @audit-issue Add NatSpec function documentation
  89 |  function proveL1ToL2TransactionStatus(
  90 |      uint256 _chainId,
  91 |      bytes32 _l2TxHash,
  92 |      uint256 _l2BatchNumber,
  93 |      uint256 _l2MessageIndex,
  94 |      uint16 _l2TxNumberInBatch,
  95 |      bytes32[] calldata _merkleProof,
  96 |      TxStatus _status
  97 |  ) external view returns (bool);

     |  // @audit-issue Add NatSpec function documentation
  99 |  function requestL2TransactionDirect(
 100 |      L2TransactionRequestDirect calldata _request
 101 |  ) external payable returns (bytes32 canonicalTxHash);

     |  // @audit-issue Add NatSpec function documentation
 103 |  function requestL2TransactionTwoBridges(
 104 |      L2TransactionRequestTwoBridgesOuter calldata _request
 105 |  ) external payable returns (bytes32 canonicalTxHash);

     |  // @audit-issue Add NatSpec function documentation
 107 |  function l2TransactionBaseCost(
 108 |      uint256 _chainId,
 109 |      uint256 _gasPrice,
 110 |      uint256 _l2GasLimit,
 111 |      uint256 _l2GasPerPubdataByteLimit
 112 |  ) external view returns (uint256);

     |  // @audit-issue Add NatSpec function documentation
 116 |  function createNewChain(
 117 |      uint256 _chainId,
 118 |      address _stateTransitionManager,
 119 |      address _baseToken,
 120 |      uint256 _salt,
 121 |      address _admin,
 122 |      bytes calldata _initData
 123 |  ) external returns (uint256 chainId);

     |  // @audit-issue Add NatSpec function documentation
 125 |  function addStateTransitionManager(address _stateTransitionManager) external;

     |  // @audit-issue Add NatSpec function documentation
 127 |  function removeStateTransitionManager(address _stateTransitionManager) external;

     |  // @audit-issue Add NatSpec function documentation
 129 |  function addToken(address _token) external;

     |  // @audit-issue Add NatSpec function documentation
 131 |  function setSharedBridge(address _sharedBridge) external;
```
GitHub: [61](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L61), [63](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L63), [65](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L65), [67](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L67), [69](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L69), [81-87](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L81-L87), [89-97](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L89-L97), [99-101](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L99-L101), [103-105](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L103-L105), [107-112](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L107-L112), [116-123](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L116-L123), [125](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L125), [127](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L127), [129](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L129), [131](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L131)


```solidity
File: code/contracts/ethereum/contracts/governance/IGovernance.sol

     |  // @audit-issue Add NatSpec function documentation
  41 |  function isOperation(bytes32 _id) external view returns (bool);

     |  // @audit-issue Add NatSpec function documentation
  43 |  function isOperationPending(bytes32 _id) external view returns (bool);

     |  // @audit-issue Add NatSpec function documentation
  45 |  function isOperationReady(bytes32 _id) external view returns (bool);

     |  // @audit-issue Add NatSpec function documentation
  47 |  function isOperationDone(bytes32 _id) external view returns (bool);

     |  // @audit-issue Add NatSpec function documentation
  49 |  function getOperationState(bytes32 _id) external view returns (OperationState);

     |  // @audit-issue Add NatSpec function documentation
  51 |  function scheduleTransparent(Operation calldata _operation, uint256 _delay) external;

     |  // @audit-issue Add NatSpec function documentation
  53 |  function scheduleShadow(bytes32 _id, uint256 _delay) external;

     |  // @audit-issue Add NatSpec function documentation
  55 |  function cancel(bytes32 _id) external;

     |  // @audit-issue Add NatSpec function documentation
  57 |  function execute(Operation calldata _operation) external payable;

     |  // @audit-issue Add NatSpec function documentation
  59 |  function executeInstant(Operation calldata _operation) external payable;

     |  // @audit-issue Add NatSpec function documentation
  61 |  function hashOperation(Operation calldata _operation) external pure returns (bytes32);

     |  // @audit-issue Add NatSpec function documentation
  63 |  function updateDelay(uint256 _newDelay) external;

     |  // @audit-issue Add NatSpec function documentation
  65 |  function updateSecurityCouncil(address _newSecurityCouncil) external;
```
GitHub: [41](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L41), [43](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L43), [45](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L45), [47](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L47), [49](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L49), [51](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L51), [53](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L53), [55](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L55), [57](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L57), [59](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L59), [61](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L61), [63](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L63), [65](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L65)


```solidity
File: code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol

     |  // @audit-issue Add NatSpec function documentation
  43 |  function bridgehub() external view returns (address);

     |  // @audit-issue Add NatSpec function documentation
  53 |  function stateTransition(uint256 _chainId) external view returns (address);

     |  // @audit-issue Add NatSpec function documentation
  55 |  function storedBatchZero() external view returns (bytes32);

     |  // @audit-issue Add NatSpec function documentation
  57 |  function initialCutHash() external view returns (bytes32);

     |  // @audit-issue Add NatSpec function documentation
  59 |  function genesisUpgrade() external view returns (address);

     |  // @audit-issue Add NatSpec function documentation
  61 |  function upgradeCutHash(uint256 _protocolVersion) external view returns (bytes32);

     |  // @audit-issue Add NatSpec function documentation
  63 |  function protocolVersion() external view returns (uint256);

     |  // @audit-issue Add NatSpec function documentation
  65 |  function initialize(StateTransitionManagerInitializeData calldata _initalizeData) external;

     |  // @audit-issue Add NatSpec function documentation
  67 |  function setInitialCutHash(Diamond.DiamondCutData calldata _diamondCut) external;

     |  // @audit-issue Add NatSpec function documentation
  69 |  function setValidatorTimelock(address _validatorTimelock) external;

     |  // @audit-issue Add NatSpec function documentation
  71 |  function getChainAdmin(uint256 _chainId) external view returns (address);

     |  // @audit-issue Add NatSpec function documentation
  82 |  function registerAlreadyDeployedStateTransition(uint256 _chainId, address _stateTransitionContract) external;

     |  // @audit-issue Add NatSpec function documentation
  84 |  function setNewVersionUpgrade(
  85 |      Diamond.DiamondCutData calldata _cutData,
  86 |      uint256 _oldProtocolVersion,
  87 |      uint256 _newProtocolVersion
  88 |  ) external;

     |  // @audit-issue Add NatSpec function documentation
  90 |  function setUpgradeDiamondCut(Diamond.DiamondCutData calldata _cutData, uint256 _oldProtocolVersion) external;
```
GitHub: [43](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L43), [53](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L53), [55](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L55), [57](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L57), [59](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L59), [61](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L61), [63](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L63), [65](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L65), [67](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L67), [69](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L69), [71](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L71), [82](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L82), [84-88](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L84-L88), [90](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L90)


## [N-73] NatSpec: Modifier `@param` is missing

Documentation of all modifier parameters improves code readability, as per [NatSpec Format](https://docs.soliditylang.org/en/latest/natspec-format.html#tags).

*Instances: 5*

```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

     |  // @audit-issue Missing NatSpec @param for parameter 1 uint256 _chainId
  74 |  modifier onlyBridgehubOrEra(uint256 _chainId) {
```
GitHub: [74](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L74)


```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

     |  // @audit-issue Missing NatSpec @param for parameter 1 uint256 _chainId
  61 |  modifier onlyChainAdmin(uint256 _chainId) {

     |  // @audit-issue Missing NatSpec @param for parameter 1 uint256 _chainId
  67 |  modifier onlyValidator(uint256 _chainId) {
```
GitHub: [61](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L61), [67](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L67)


```solidity
File: code/system-contracts/contracts/interfaces/ISystemContract.sol

     |  // @audit-issue Missing NatSpec @param for parameter 1 address caller
  40 |  modifier onlyCallFrom(address caller) {
```
GitHub: [40](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContract.sol#L40)


```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

     |  // @audit-issue Missing NatSpec @param for parameter 1 uint8 _version
 134 |  modifier onlyNextVersion(uint8 _version) {
```
GitHub: [134](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L134)


## [N-74] NatSpec: Modifier definitions should have NatSpec descriptions

e.g. `@dev` or `@notice`, and it must appear above the event definition braces in order to be identified by the compiler as NatSpec.

*Instances: 13*

```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

     |  // @audit-issue Add NatSpec modifier documentation
  45 |  modifier onlyOwnerOrAdmin() {
  46 |      require(msg.sender == admin || msg.sender == owner(), "Bridgehub: not owner or admin");
  47 |      _;
  48 |  }
```
GitHub: [45-48](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L45-L48)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol

     |  // @audit-issue Add NatSpec modifier documentation
  26 |  modifier onlyStateTransitionManager() {
  27 |      require(msg.sender == s.stateTransitionManager, "StateTransition Chain: not state transition manager");
  28 |      _;
  29 |  }

     |  // @audit-issue Add NatSpec modifier documentation
  31 |  modifier onlyBridgehub() {
  32 |      require(msg.sender == s.bridgehub, "StateTransition Chain: not bridgehub");
  33 |      _;
  34 |  }

     |  // @audit-issue Add NatSpec modifier documentation
  36 |  modifier onlyAdminOrStateTransitionManager() {
  37 |      require(
  38 |          msg.sender == s.admin || msg.sender == s.stateTransitionManager,
  39 |          "StateTransition Chain: Only by admin or state transition manager"
  40 |      );
  41 |      _;
  42 |  }

     |  // @audit-issue Add NatSpec modifier documentation
  44 |  modifier onlyValidatorOrStateTransitionManager() {
  45 |      require(
  46 |          s.validators[msg.sender] || msg.sender == s.stateTransitionManager,
  47 |          "StateTransition Chain: Only by validator or state transition manager"
  48 |      );
  49 |      _;
  50 |  }

     |  // @audit-issue Add NatSpec modifier documentation
  52 |  modifier onlyBaseTokenBridge() {
  53 |      require(msg.sender == s.baseTokenBridge, "Only shared bridge can call this function");
  54 |      _;
  55 |  }
```
GitHub: [26-29](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L26-L29), [31-34](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L31-L34), [36-42](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L36-L42), [44-50](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L44-L50), [52-55](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L52-L55)


```solidity
File: code/contracts/ethereum/contracts/common/ReentrancyGuard.sol

     |  // @audit-issue Add NatSpec modifier documentation
  41 |  modifier reentrancyGuardInitializer() {
  42 |      _initializeReentrancyGuard();
  43 |      _;
  44 |  }
```
GitHub: [41-44](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/ReentrancyGuard.sol#L41-L44)


```solidity
File: code/system-contracts/contracts/AccountCodeStorage.sol

     |  // @audit-issue Add NatSpec modifier documentation
  25 |  modifier onlyDeployer() {
  26 |      require(msg.sender == address(DEPLOYER_SYSTEM_CONTRACT), "Callable only by the deployer system contract");
  27 |      _;
  28 |  }
```
GitHub: [25-28](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L25-L28)


```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

     |  // @audit-issue Add NatSpec modifier documentation
  28 |  modifier onlySelf() {
  29 |      require(msg.sender == address(this), "Callable only by self");
  30 |      _;
  31 |  }
```
GitHub: [28-31](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L28-L31)


```solidity
File: code/system-contracts/contracts/KnownCodesStorage.sol

     |  // @audit-issue Add NatSpec modifier documentation
  19 |  modifier onlyCompressor() {
  20 |      require(msg.sender == address(COMPRESSOR_CONTRACT), "Callable only by the compressor");
  21 |      _;
  22 |  }
```
GitHub: [19-22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/KnownCodesStorage.sol#L19-L22)


```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

     |  // @audit-issue Add NatSpec modifier documentation
 129 |  modifier onlyBridge() {
 130 |      require(msg.sender == l2Bridge, "xnt"); // Only L2 bridge can call this method
 131 |      _;
 132 |  }

     |  // @audit-issue Add NatSpec modifier documentation
 134 |  modifier onlyNextVersion(uint8 _version) {
 135 |      // The version should be incremented by 1. Otherwise, the governor risks disabling
 136 |      // future reinitialization of the token by providing too large a version.
 137 |      require(_version == _getInitializedVersion() + 1, "v");
 138 |      _;
 139 |  }
```
GitHub: [129-132](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L129-L132), [134-139](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L134-L139)


```solidity
File: code/contracts/zksync/contracts/bridge/L2WrappedBaseToken.sol

     |  // @audit-issue Add NatSpec modifier documentation
  64 |  modifier onlyBridge() {
  65 |      require(msg.sender == l2Bridge, "permission denied"); // Only L2 bridge can call this method
  66 |      _;
  67 |  }
```
GitHub: [64-67](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2WrappedBaseToken.sol#L64-L67)


## [N-75] NatSpec: Modifier definitions should have `@dev` tags

`@dev` is used to explain to developers what the modifier does, and the compiler interprets `///` or `/**` comments as this tag if one wasn't explicitly provided.

*Instances: 30*

```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

     |  // @audit-issue Add NatSpec @dev
  68 |  modifier onlyBridgehub() {
  69 |      require(msg.sender == address(bridgehub), "ShB not BH");
  70 |      _;
  71 |  }

     |  // @audit-issue Add NatSpec @dev
  74 |  modifier onlyBridgehubOrEra(uint256 _chainId) {
  75 |      require(
  76 |          msg.sender == address(bridgehub) || (_chainId == ERA_CHAIN_ID && msg.sender == ERA_DIAMOND_PROXY),
  77 |          "L1SharedBridge: not bridgehub or era chain"
  78 |      );
  79 |      _;
  80 |  }

     |  // @audit-issue Add NatSpec @dev
  83 |  modifier onlyLegacyBridge() {
  84 |      require(msg.sender == address(legacyBridge), "ShB not legacy bridge");
  85 |      _;
  86 |  }
```
GitHub: [68-71](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L68-L71), [74-80](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L74-L80), [83-86](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L83-L86)


```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

     |  // @audit-issue Add NatSpec @dev
  45 |  modifier onlyOwnerOrAdmin() {
  46 |      require(msg.sender == admin || msg.sender == owner(), "Bridgehub: not owner or admin");
  47 |      _;
  48 |  }
```
GitHub: [45-48](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L45-L48)


```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

     |  // @audit-issue Add NatSpec @dev
  58 |  modifier onlySelf() {
  59 |      require(msg.sender == address(this), "Only governance contract itself is allowed to call this function");
  60 |      _;
  61 |  }

     |  // @audit-issue Add NatSpec @dev
  64 |  modifier onlySecurityCouncil() {
  65 |      require(msg.sender == securityCouncil, "Only security council is allowed to call this function");
  66 |      _;
  67 |  }

     |  // @audit-issue Add NatSpec @dev
  70 |  modifier onlyOwnerOrSecurityCouncil() {
  71 |      require(
  72 |          msg.sender == owner() || msg.sender == securityCouncil,
  73 |          "Only the owner and security council are allowed to call this function"
  74 |      );
  75 |      _;
  76 |  }
```
GitHub: [58-61](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L58-L61), [64-67](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L64-L67), [70-76](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L70-L76)


```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

     |  // @audit-issue Add NatSpec @dev
  65 |  modifier onlyBridgehub() {
  66 |      require(msg.sender == bridgehub, "StateTransition: only bridgehub");
  67 |      _;
  68 |  }

     |  // @audit-issue Add NatSpec @dev
  71 |  modifier onlyOwnerOrAdmin() {
  72 |      require(msg.sender == admin || msg.sender == owner(), "Bridgehub: not owner or admin");
  73 |      _;
  74 |  }
```
GitHub: [65-68](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L65-L68), [71-74](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L71-L74)


```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

     |  // @audit-issue Add NatSpec @dev
  61 |  modifier onlyChainAdmin(uint256 _chainId) {
  62 |      require(msg.sender == stateTransitionManager.getChainAdmin(_chainId), "ValidatorTimelock: only chain admin");
  63 |      _;
  64 |  }

     |  // @audit-issue Add NatSpec @dev
  67 |  modifier onlyValidator(uint256 _chainId) {
  68 |      require(validators[_chainId][msg.sender] == true, "ValidatorTimelock: only validator");
  69 |      _;
  70 |  }
```
GitHub: [61-64](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L61-L64), [67-70](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L67-L70)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol

     |  // @audit-issue Add NatSpec @dev
  15 |  modifier onlyAdmin() {
  16 |      require(msg.sender == s.admin, "StateTransition Chain: not admin");
  17 |      _;
  18 |  }

     |  // @audit-issue Add NatSpec @dev
  21 |  modifier onlyValidator() {
  22 |      require(s.validators[msg.sender], "StateTransition Chain: not validator");
  23 |      _;
  24 |  }

     |  // @audit-issue Add NatSpec @dev
  26 |  modifier onlyStateTransitionManager() {
  27 |      require(msg.sender == s.stateTransitionManager, "StateTransition Chain: not state transition manager");
  28 |      _;
  29 |  }

     |  // @audit-issue Add NatSpec @dev
  31 |  modifier onlyBridgehub() {
  32 |      require(msg.sender == s.bridgehub, "StateTransition Chain: not bridgehub");
  33 |      _;
  34 |  }

     |  // @audit-issue Add NatSpec @dev
  36 |  modifier onlyAdminOrStateTransitionManager() {
  37 |      require(
  38 |          msg.sender == s.admin || msg.sender == s.stateTransitionManager,
  39 |          "StateTransition Chain: Only by admin or state transition manager"
  40 |      );
  41 |      _;
  42 |  }

     |  // @audit-issue Add NatSpec @dev
  44 |  modifier onlyValidatorOrStateTransitionManager() {
  45 |      require(
  46 |          s.validators[msg.sender] || msg.sender == s.stateTransitionManager,
  47 |          "StateTransition Chain: Only by validator or state transition manager"
  48 |      );
  49 |      _;
  50 |  }

     |  // @audit-issue Add NatSpec @dev
  52 |  modifier onlyBaseTokenBridge() {
  53 |      require(msg.sender == s.baseTokenBridge, "Only shared bridge can call this function");
  54 |      _;
  55 |  }
```
GitHub: [15-18](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L15-L18), [21-24](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L21-L24), [26-29](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L26-L29), [31-34](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L31-L34), [36-42](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L36-L42), [44-50](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L44-L50), [52-55](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L52-L55)


```solidity
File: code/contracts/ethereum/contracts/common/ReentrancyGuard.sol

     |  // @audit-issue Add NatSpec @dev
  41 |  modifier reentrancyGuardInitializer() {
  42 |      _initializeReentrancyGuard();
  43 |      _;
  44 |  }
```
GitHub: [41-44](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/ReentrancyGuard.sol#L41-L44)


```solidity
File: code/system-contracts/contracts/AccountCodeStorage.sol

     |  // @audit-issue Add NatSpec @dev
  25 |  modifier onlyDeployer() {
  26 |      require(msg.sender == address(DEPLOYER_SYSTEM_CONTRACT), "Callable only by the deployer system contract");
  27 |      _;
  28 |  }
```
GitHub: [25-28](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L25-L28)


```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

     |  // @audit-issue Add NatSpec @dev
  28 |  modifier onlySelf() {
  29 |      require(msg.sender == address(this), "Callable only by self");
  30 |      _;
  31 |  }
```
GitHub: [28-31](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L28-L31)


```solidity
File: code/system-contracts/contracts/KnownCodesStorage.sol

     |  // @audit-issue Add NatSpec @dev
  19 |  modifier onlyCompressor() {
  20 |      require(msg.sender == address(COMPRESSOR_CONTRACT), "Callable only by the compressor");
  21 |      _;
  22 |  }
```
GitHub: [19-22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/KnownCodesStorage.sol#L19-L22)


```solidity
File: code/system-contracts/contracts/interfaces/ISystemContract.sol

     |  // @audit-issue Add NatSpec @dev
  20 |  modifier onlySystemCall() {
  21 |      require(
  22 |          SystemContractHelper.isSystemCall() || SystemContractHelper.isSystemContract(msg.sender),
  23 |          "This method require system call flag"
  24 |      );
  25 |      _;
  26 |  }

     |  // @audit-issue Add NatSpec @dev
  30 |  modifier onlyCallFromSystemContract() {
  31 |      require(
  32 |          SystemContractHelper.isSystemContract(msg.sender),
  33 |          "This method require the caller to be system contract"
  34 |      );
  35 |      _;
  36 |  }

     |  // @audit-issue Add NatSpec @dev
  40 |  modifier onlyCallFrom(address caller) {
  41 |      require(msg.sender == caller, "Inappropriate caller");
  42 |      _;
  43 |  }

     |  // @audit-issue Add NatSpec @dev
  47 |  modifier onlyCallFromBootloader() {
  48 |      require(msg.sender == BOOTLOADER_FORMAL_ADDRESS, "Callable only by the bootloader");
  49 |      _;
  50 |  }

     |  // @audit-issue Add NatSpec @dev
  54 |  modifier onlyCallFromForceDeployer() {
  55 |      require(msg.sender == FORCE_DEPLOYER);
  56 |      _;
  57 |  }
```
GitHub: [20-26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContract.sol#L20-L26), [30-36](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContract.sol#L30-L36), [40-43](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContract.sol#L40-L43), [47-50](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContract.sol#L47-L50), [54-57](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContract.sol#L54-L57)


```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

     |  // @audit-issue Add NatSpec @dev
 129 |  modifier onlyBridge() {
 130 |      require(msg.sender == l2Bridge, "xnt"); // Only L2 bridge can call this method
 131 |      _;
 132 |  }

     |  // @audit-issue Add NatSpec @dev
 134 |  modifier onlyNextVersion(uint8 _version) {
 135 |      // The version should be incremented by 1. Otherwise, the governor risks disabling
 136 |      // future reinitialization of the token by providing too large a version.
 137 |      require(_version == _getInitializedVersion() + 1, "v");
 138 |      _;
 139 |  }
```
GitHub: [129-132](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L129-L132), [134-139](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L134-L139)


```solidity
File: code/contracts/zksync/contracts/bridge/L2WrappedBaseToken.sol

     |  // @audit-issue Add NatSpec @dev
  64 |  modifier onlyBridge() {
  65 |      require(msg.sender == l2Bridge, "permission denied"); // Only L2 bridge can call this method
  66 |      _;
  67 |  }
```
GitHub: [64-67](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2WrappedBaseToken.sol#L64-L67)


## [N-76] NatSpec: Modifier definitions should have `@notice` tags

`@notice` is used to explain to end users what the modifier does, and the compiler interprets `///` or `/**` comments as this tag if one wasn't explicitly provided.

*Instances: 16*

```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

     |  // @audit-issue Add NatSpec @notice
  45 |  modifier onlyOwnerOrAdmin() {
  46 |      require(msg.sender == admin || msg.sender == owner(), "Bridgehub: not owner or admin");
  47 |      _;
  48 |  }
```
GitHub: [45-48](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L45-L48)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol

     |  // @audit-issue Add NatSpec @notice
  26 |  modifier onlyStateTransitionManager() {
  27 |      require(msg.sender == s.stateTransitionManager, "StateTransition Chain: not state transition manager");
  28 |      _;
  29 |  }

     |  // @audit-issue Add NatSpec @notice
  31 |  modifier onlyBridgehub() {
  32 |      require(msg.sender == s.bridgehub, "StateTransition Chain: not bridgehub");
  33 |      _;
  34 |  }

     |  // @audit-issue Add NatSpec @notice
  36 |  modifier onlyAdminOrStateTransitionManager() {
  37 |      require(
  38 |          msg.sender == s.admin || msg.sender == s.stateTransitionManager,
  39 |          "StateTransition Chain: Only by admin or state transition manager"
  40 |      );
  41 |      _;
  42 |  }

     |  // @audit-issue Add NatSpec @notice
  44 |  modifier onlyValidatorOrStateTransitionManager() {
  45 |      require(
  46 |          s.validators[msg.sender] || msg.sender == s.stateTransitionManager,
  47 |          "StateTransition Chain: Only by validator or state transition manager"
  48 |      );
  49 |      _;
  50 |  }

     |  // @audit-issue Add NatSpec @notice
  52 |  modifier onlyBaseTokenBridge() {
  53 |      require(msg.sender == s.baseTokenBridge, "Only shared bridge can call this function");
  54 |      _;
  55 |  }
```
GitHub: [26-29](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L26-L29), [31-34](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L31-L34), [36-42](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L36-L42), [44-50](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L44-L50), [52-55](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L52-L55)


```solidity
File: code/contracts/ethereum/contracts/common/ReentrancyGuard.sol

     |  // @audit-issue Add NatSpec @notice
  41 |  modifier reentrancyGuardInitializer() {
  42 |      _initializeReentrancyGuard();
  43 |      _;
  44 |  }

     |  // @audit-issue Add NatSpec @notice
  68 |      modifier nonReentrant() {
  69 |          uint256 _status;
  70 |          assembly {
  71 |              _status := sload(LOCK_FLAG_ADDRESS)
  72 |          }
  74 |          // On the first call to nonReentrant, _notEntered will be true
  75 |          require(_status == _NOT_ENTERED, "r1");
  77 |          // Any calls to nonReentrant after this point will fail
  78 |          assembly {
  79 |              sstore(LOCK_FLAG_ADDRESS, _ENTERED)
  80 |          }
  82 |          _;
  84 |          // By storing the original value once again, a refund is triggered (see
  85 |          // https://eips.ethereum.org/EIPS/eip-2200)
  86 |          assembly {
  87 |              sstore(LOCK_FLAG_ADDRESS, _NOT_ENTERED)
  88 |          }
  89 |      }
```
GitHub: [41-44](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/ReentrancyGuard.sol#L41-L44), [68-89](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/ReentrancyGuard.sol#L68-L89)


```solidity
File: code/system-contracts/contracts/AccountCodeStorage.sol

     |  // @audit-issue Add NatSpec @notice
  25 |  modifier onlyDeployer() {
  26 |      require(msg.sender == address(DEPLOYER_SYSTEM_CONTRACT), "Callable only by the deployer system contract");
  27 |      _;
  28 |  }
```
GitHub: [25-28](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L25-L28)


```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

     |  // @audit-issue Add NatSpec @notice
  28 |  modifier onlySelf() {
  29 |      require(msg.sender == address(this), "Callable only by self");
  30 |      _;
  31 |  }
```
GitHub: [28-31](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L28-L31)


```solidity
File: code/system-contracts/contracts/DefaultAccount.sol

     |  // @audit-issue Add NatSpec @notice
  28 |  modifier ignoreNonBootloader() {
  29 |      if (msg.sender != BOOTLOADER_FORMAL_ADDRESS) {
  30 |          // If function was called outside of the bootloader, behave like an EOA.
  31 |          assembly {
  32 |              return(0, 0)
  33 |          }
  34 |      }
  35 |      // Continue execution if called from the bootloader.
  36 |      _;
  37 |  }

     |  // @audit-issue Add NatSpec @notice
  45 |      modifier ignoreInDelegateCall() {
  46 |          address codeAddress = SystemContractHelper.getCodeAddress();
  47 |          if (codeAddress != address(this)) {
  48 |              // If the function was delegate called, behave like an EOA.
  49 |              assembly {
  50 |                  return(0, 0)
  51 |              }
  52 |          }
  54 |          // Continue execution if not delegate called.
  55 |          _;
  56 |      }
```
GitHub: [28-37](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L28-L37), [45-56](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L45-L56)


```solidity
File: code/system-contracts/contracts/KnownCodesStorage.sol

     |  // @audit-issue Add NatSpec @notice
  19 |  modifier onlyCompressor() {
  20 |      require(msg.sender == address(COMPRESSOR_CONTRACT), "Callable only by the compressor");
  21 |      _;
  22 |  }
```
GitHub: [19-22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/KnownCodesStorage.sol#L19-L22)


```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

     |  // @audit-issue Add NatSpec @notice
 129 |  modifier onlyBridge() {
 130 |      require(msg.sender == l2Bridge, "xnt"); // Only L2 bridge can call this method
 131 |      _;
 132 |  }

     |  // @audit-issue Add NatSpec @notice
 134 |  modifier onlyNextVersion(uint8 _version) {
 135 |      // The version should be incremented by 1. Otherwise, the governor risks disabling
 136 |      // future reinitialization of the token by providing too large a version.
 137 |      require(_version == _getInitializedVersion() + 1, "v");
 138 |      _;
 139 |  }
```
GitHub: [129-132](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L129-L132), [134-139](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L134-L139)


```solidity
File: code/contracts/zksync/contracts/bridge/L2WrappedBaseToken.sol

     |  // @audit-issue Add NatSpec @notice
  64 |  modifier onlyBridge() {
  65 |      require(msg.sender == l2Bridge, "permission denied"); // Only L2 bridge can call this method
  66 |      _;
  67 |  }
```
GitHub: [64-67](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2WrappedBaseToken.sol#L64-L67)


## [N-77] NatSpec: Non-public state variable declarations should use `@dev` tags

As per [Solidity NatSpec](https://docs.soliditylang.org/en/latest/natspec-format.html#tags). Note: public and non-public state variables should have a @dev tag. Only public state variables should have a @notice tag.

*Instances: 99*

```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

     |  // @audit-issue Add NatSpec @dev documentation
  22 |  uint256 internal constant EXECUTED_PROPOSAL_TIMESTAMP = uint256(1);
```
GitHub: [22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L22)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol

     |  // @audit-issue Add NatSpec @dev documentation
  12 |  ZkSyncStateTransitionStorage internal s;
```
GitHub: [12](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L12)


```solidity
File: code/contracts/ethereum/contracts/common/ReentrancyGuard.sol

     |  // @audit-issue Add NatSpec @dev documentation
  38 |  uint256 private constant _NOT_ENTERED = 1;

     |  // @audit-issue Add NatSpec @dev documentation
  39 |  uint256 private constant _ENTERED = 2;
```
GitHub: [38](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/ReentrancyGuard.sol#L38), [39](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/ReentrancyGuard.sol#L39)


```solidity
File: code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol

     |  // @audit-issue Add NatSpec @dev documentation
  22 |  uint160 constant offset = uint160(0x1111000000000000000000000000000000001111);
```
GitHub: [22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol#L22)


```solidity
File: code/contracts/ethereum/contracts/state-transition/Verifier.sol

     |  // @audit-issue Add NatSpec @dev documentation
  27 |  uint256 internal constant VK_GATE_SETUP_0_X_SLOT = 0x200 + 0x000;

     |  // @audit-issue Add NatSpec @dev documentation
  28 |  uint256 internal constant VK_GATE_SETUP_0_Y_SLOT = 0x200 + 0x020;

     |  // @audit-issue Add NatSpec @dev documentation
  29 |  uint256 internal constant VK_GATE_SETUP_1_X_SLOT = 0x200 + 0x040;

     |  // @audit-issue Add NatSpec @dev documentation
  30 |  uint256 internal constant VK_GATE_SETUP_1_Y_SLOT = 0x200 + 0x060;

     |  // @audit-issue Add NatSpec @dev documentation
  31 |  uint256 internal constant VK_GATE_SETUP_2_X_SLOT = 0x200 + 0x080;

     |  // @audit-issue Add NatSpec @dev documentation
  32 |  uint256 internal constant VK_GATE_SETUP_2_Y_SLOT = 0x200 + 0x0a0;

     |  // @audit-issue Add NatSpec @dev documentation
  33 |  uint256 internal constant VK_GATE_SETUP_3_X_SLOT = 0x200 + 0x0c0;

     |  // @audit-issue Add NatSpec @dev documentation
  34 |  uint256 internal constant VK_GATE_SETUP_3_Y_SLOT = 0x200 + 0x0e0;

     |  // @audit-issue Add NatSpec @dev documentation
  35 |  uint256 internal constant VK_GATE_SETUP_4_X_SLOT = 0x200 + 0x100;

     |  // @audit-issue Add NatSpec @dev documentation
  36 |  uint256 internal constant VK_GATE_SETUP_4_Y_SLOT = 0x200 + 0x120;

     |  // @audit-issue Add NatSpec @dev documentation
  37 |  uint256 internal constant VK_GATE_SETUP_5_X_SLOT = 0x200 + 0x140;

     |  // @audit-issue Add NatSpec @dev documentation
  38 |  uint256 internal constant VK_GATE_SETUP_5_Y_SLOT = 0x200 + 0x160;

     |  // @audit-issue Add NatSpec @dev documentation
  39 |  uint256 internal constant VK_GATE_SETUP_6_X_SLOT = 0x200 + 0x180;

     |  // @audit-issue Add NatSpec @dev documentation
  40 |  uint256 internal constant VK_GATE_SETUP_6_Y_SLOT = 0x200 + 0x1a0;

     |  // @audit-issue Add NatSpec @dev documentation
  41 |  uint256 internal constant VK_GATE_SETUP_7_X_SLOT = 0x200 + 0x1c0;

     |  // @audit-issue Add NatSpec @dev documentation
  42 |  uint256 internal constant VK_GATE_SETUP_7_Y_SLOT = 0x200 + 0x1e0;

     |  // @audit-issue Add NatSpec @dev documentation
  44 |  uint256 internal constant VK_GATE_SELECTORS_0_X_SLOT = 0x200 + 0x200;

     |  // @audit-issue Add NatSpec @dev documentation
  45 |  uint256 internal constant VK_GATE_SELECTORS_0_Y_SLOT = 0x200 + 0x220;

     |  // @audit-issue Add NatSpec @dev documentation
  46 |  uint256 internal constant VK_GATE_SELECTORS_1_X_SLOT = 0x200 + 0x240;

     |  // @audit-issue Add NatSpec @dev documentation
  47 |  uint256 internal constant VK_GATE_SELECTORS_1_Y_SLOT = 0x200 + 0x260;

     |  // @audit-issue Add NatSpec @dev documentation
  49 |  uint256 internal constant VK_PERMUTATION_0_X_SLOT = 0x200 + 0x280;

     |  // @audit-issue Add NatSpec @dev documentation
  50 |  uint256 internal constant VK_PERMUTATION_0_Y_SLOT = 0x200 + 0x2a0;

     |  // @audit-issue Add NatSpec @dev documentation
  51 |  uint256 internal constant VK_PERMUTATION_1_X_SLOT = 0x200 + 0x2c0;

     |  // @audit-issue Add NatSpec @dev documentation
  52 |  uint256 internal constant VK_PERMUTATION_1_Y_SLOT = 0x200 + 0x2e0;

     |  // @audit-issue Add NatSpec @dev documentation
  53 |  uint256 internal constant VK_PERMUTATION_2_X_SLOT = 0x200 + 0x300;

     |  // @audit-issue Add NatSpec @dev documentation
  54 |  uint256 internal constant VK_PERMUTATION_2_Y_SLOT = 0x200 + 0x320;

     |  // @audit-issue Add NatSpec @dev documentation
  55 |  uint256 internal constant VK_PERMUTATION_3_X_SLOT = 0x200 + 0x340;

     |  // @audit-issue Add NatSpec @dev documentation
  56 |  uint256 internal constant VK_PERMUTATION_3_Y_SLOT = 0x200 + 0x360;

     |  // @audit-issue Add NatSpec @dev documentation
  58 |  uint256 internal constant VK_LOOKUP_SELECTOR_X_SLOT = 0x200 + 0x380;

     |  // @audit-issue Add NatSpec @dev documentation
  59 |  uint256 internal constant VK_LOOKUP_SELECTOR_Y_SLOT = 0x200 + 0x3a0;

     |  // @audit-issue Add NatSpec @dev documentation
  61 |  uint256 internal constant VK_LOOKUP_TABLE_0_X_SLOT = 0x200 + 0x3c0;

     |  // @audit-issue Add NatSpec @dev documentation
  62 |  uint256 internal constant VK_LOOKUP_TABLE_0_Y_SLOT = 0x200 + 0x3e0;

     |  // @audit-issue Add NatSpec @dev documentation
  63 |  uint256 internal constant VK_LOOKUP_TABLE_1_X_SLOT = 0x200 + 0x400;

     |  // @audit-issue Add NatSpec @dev documentation
  64 |  uint256 internal constant VK_LOOKUP_TABLE_1_Y_SLOT = 0x200 + 0x420;

     |  // @audit-issue Add NatSpec @dev documentation
  65 |  uint256 internal constant VK_LOOKUP_TABLE_2_X_SLOT = 0x200 + 0x440;

     |  // @audit-issue Add NatSpec @dev documentation
  66 |  uint256 internal constant VK_LOOKUP_TABLE_2_Y_SLOT = 0x200 + 0x460;

     |  // @audit-issue Add NatSpec @dev documentation
  67 |  uint256 internal constant VK_LOOKUP_TABLE_3_X_SLOT = 0x200 + 0x480;

     |  // @audit-issue Add NatSpec @dev documentation
  68 |  uint256 internal constant VK_LOOKUP_TABLE_3_Y_SLOT = 0x200 + 0x4a0;

     |  // @audit-issue Add NatSpec @dev documentation
  70 |  uint256 internal constant VK_LOOKUP_TABLE_TYPE_X_SLOT = 0x200 + 0x4c0;

     |  // @audit-issue Add NatSpec @dev documentation
  71 |  uint256 internal constant VK_LOOKUP_TABLE_TYPE_Y_SLOT = 0x200 + 0x4e0;

     |  // @audit-issue Add NatSpec @dev documentation
  73 |  uint256 internal constant VK_RECURSIVE_FLAG_SLOT = 0x200 + 0x500;

     |  // @audit-issue Add NatSpec @dev documentation
  79 |  uint256 internal constant PROOF_PUBLIC_INPUT = 0x200 + 0x520 + 0x000;

     |  // @audit-issue Add NatSpec @dev documentation
  81 |  uint256 internal constant PROOF_STATE_POLYS_0_X_SLOT = 0x200 + 0x520 + 0x020;

     |  // @audit-issue Add NatSpec @dev documentation
  82 |  uint256 internal constant PROOF_STATE_POLYS_0_Y_SLOT = 0x200 + 0x520 + 0x040;

     |  // @audit-issue Add NatSpec @dev documentation
  83 |  uint256 internal constant PROOF_STATE_POLYS_1_X_SLOT = 0x200 + 0x520 + 0x060;

     |  // @audit-issue Add NatSpec @dev documentation
  84 |  uint256 internal constant PROOF_STATE_POLYS_1_Y_SLOT = 0x200 + 0x520 + 0x080;

     |  // @audit-issue Add NatSpec @dev documentation
  85 |  uint256 internal constant PROOF_STATE_POLYS_2_X_SLOT = 0x200 + 0x520 + 0x0a0;

     |  // @audit-issue Add NatSpec @dev documentation
  86 |  uint256 internal constant PROOF_STATE_POLYS_2_Y_SLOT = 0x200 + 0x520 + 0x0c0;

     |  // @audit-issue Add NatSpec @dev documentation
  87 |  uint256 internal constant PROOF_STATE_POLYS_3_X_SLOT = 0x200 + 0x520 + 0x0e0;

     |  // @audit-issue Add NatSpec @dev documentation
  88 |  uint256 internal constant PROOF_STATE_POLYS_3_Y_SLOT = 0x200 + 0x520 + 0x100;

     |  // @audit-issue Add NatSpec @dev documentation
  90 |  uint256 internal constant PROOF_COPY_PERMUTATION_GRAND_PRODUCT_X_SLOT = 0x200 + 0x520 + 0x120;

     |  // @audit-issue Add NatSpec @dev documentation
  91 |  uint256 internal constant PROOF_COPY_PERMUTATION_GRAND_PRODUCT_Y_SLOT = 0x200 + 0x520 + 0x140;

     |  // @audit-issue Add NatSpec @dev documentation
  93 |  uint256 internal constant PROOF_LOOKUP_S_POLY_X_SLOT = 0x200 + 0x520 + 0x160;

     |  // @audit-issue Add NatSpec @dev documentation
  94 |  uint256 internal constant PROOF_LOOKUP_S_POLY_Y_SLOT = 0x200 + 0x520 + 0x180;

     |  // @audit-issue Add NatSpec @dev documentation
  96 |  uint256 internal constant PROOF_LOOKUP_GRAND_PRODUCT_X_SLOT = 0x200 + 0x520 + 0x1a0;

     |  // @audit-issue Add NatSpec @dev documentation
  97 |  uint256 internal constant PROOF_LOOKUP_GRAND_PRODUCT_Y_SLOT = 0x200 + 0x520 + 0x1c0;

     |  // @audit-issue Add NatSpec @dev documentation
  99 |  uint256 internal constant PROOF_QUOTIENT_POLY_PARTS_0_X_SLOT = 0x200 + 0x520 + 0x1e0;

     |  // @audit-issue Add NatSpec @dev documentation
 100 |  uint256 internal constant PROOF_QUOTIENT_POLY_PARTS_0_Y_SLOT = 0x200 + 0x520 + 0x200;

     |  // @audit-issue Add NatSpec @dev documentation
 101 |  uint256 internal constant PROOF_QUOTIENT_POLY_PARTS_1_X_SLOT = 0x200 + 0x520 + 0x220;

     |  // @audit-issue Add NatSpec @dev documentation
 102 |  uint256 internal constant PROOF_QUOTIENT_POLY_PARTS_1_Y_SLOT = 0x200 + 0x520 + 0x240;

     |  // @audit-issue Add NatSpec @dev documentation
 103 |  uint256 internal constant PROOF_QUOTIENT_POLY_PARTS_2_X_SLOT = 0x200 + 0x520 + 0x260;

     |  // @audit-issue Add NatSpec @dev documentation
 104 |  uint256 internal constant PROOF_QUOTIENT_POLY_PARTS_2_Y_SLOT = 0x200 + 0x520 + 0x280;

     |  // @audit-issue Add NatSpec @dev documentation
 105 |  uint256 internal constant PROOF_QUOTIENT_POLY_PARTS_3_X_SLOT = 0x200 + 0x520 + 0x2a0;

     |  // @audit-issue Add NatSpec @dev documentation
 106 |  uint256 internal constant PROOF_QUOTIENT_POLY_PARTS_3_Y_SLOT = 0x200 + 0x520 + 0x2c0;

     |  // @audit-issue Add NatSpec @dev documentation
 108 |  uint256 internal constant PROOF_STATE_POLYS_0_OPENING_AT_Z_SLOT = 0x200 + 0x520 + 0x2e0;

     |  // @audit-issue Add NatSpec @dev documentation
 109 |  uint256 internal constant PROOF_STATE_POLYS_1_OPENING_AT_Z_SLOT = 0x200 + 0x520 + 0x300;

     |  // @audit-issue Add NatSpec @dev documentation
 110 |  uint256 internal constant PROOF_STATE_POLYS_2_OPENING_AT_Z_SLOT = 0x200 + 0x520 + 0x320;

     |  // @audit-issue Add NatSpec @dev documentation
 111 |  uint256 internal constant PROOF_STATE_POLYS_3_OPENING_AT_Z_SLOT = 0x200 + 0x520 + 0x340;

     |  // @audit-issue Add NatSpec @dev documentation
 113 |  uint256 internal constant PROOF_STATE_POLYS_3_OPENING_AT_Z_OMEGA_SLOT = 0x200 + 0x520 + 0x360;

     |  // @audit-issue Add NatSpec @dev documentation
 114 |  uint256 internal constant PROOF_GATE_SELECTORS_0_OPENING_AT_Z_SLOT = 0x200 + 0x520 + 0x380;

     |  // @audit-issue Add NatSpec @dev documentation
 116 |  uint256 internal constant PROOF_COPY_PERMUTATION_POLYS_0_OPENING_AT_Z_SLOT = 0x200 + 0x520 + 0x3a0;

     |  // @audit-issue Add NatSpec @dev documentation
 117 |  uint256 internal constant PROOF_COPY_PERMUTATION_POLYS_1_OPENING_AT_Z_SLOT = 0x200 + 0x520 + 0x3c0;

     |  // @audit-issue Add NatSpec @dev documentation
 118 |  uint256 internal constant PROOF_COPY_PERMUTATION_POLYS_2_OPENING_AT_Z_SLOT = 0x200 + 0x520 + 0x3e0;

     |  // @audit-issue Add NatSpec @dev documentation
 120 |  uint256 internal constant PROOF_COPY_PERMUTATION_GRAND_PRODUCT_OPENING_AT_Z_OMEGA_SLOT = 0x200 + 0x520 + 0x400;

     |  // @audit-issue Add NatSpec @dev documentation
 121 |  uint256 internal constant PROOF_LOOKUP_S_POLY_OPENING_AT_Z_OMEGA_SLOT = 0x200 + 0x520 + 0x420;

     |  // @audit-issue Add NatSpec @dev documentation
 122 |  uint256 internal constant PROOF_LOOKUP_GRAND_PRODUCT_OPENING_AT_Z_OMEGA_SLOT = 0x200 + 0x520 + 0x440;

     |  // @audit-issue Add NatSpec @dev documentation
 123 |  uint256 internal constant PROOF_LOOKUP_T_POLY_OPENING_AT_Z_SLOT = 0x200 + 0x520 + 0x460;

     |  // @audit-issue Add NatSpec @dev documentation
 124 |  uint256 internal constant PROOF_LOOKUP_T_POLY_OPENING_AT_Z_OMEGA_SLOT = 0x200 + 0x520 + 0x480;

     |  // @audit-issue Add NatSpec @dev documentation
 125 |  uint256 internal constant PROOF_LOOKUP_SELECTOR_POLY_OPENING_AT_Z_SLOT = 0x200 + 0x520 + 0x4a0;

     |  // @audit-issue Add NatSpec @dev documentation
 126 |  uint256 internal constant PROOF_LOOKUP_TABLE_TYPE_POLY_OPENING_AT_Z_SLOT = 0x200 + 0x520 + 0x4c0;

     |  // @audit-issue Add NatSpec @dev documentation
 127 |  uint256 internal constant PROOF_QUOTIENT_POLY_OPENING_AT_Z_SLOT = 0x200 + 0x520 + 0x4e0;

     |  // @audit-issue Add NatSpec @dev documentation
 128 |  uint256 internal constant PROOF_LINEARISATION_POLY_OPENING_AT_Z_SLOT = 0x200 + 0x520 + 0x500;

     |  // @audit-issue Add NatSpec @dev documentation
 130 |  uint256 internal constant PROOF_OPENING_PROOF_AT_Z_X_SLOT = 0x200 + 0x520 + 0x520;

     |  // @audit-issue Add NatSpec @dev documentation
 131 |  uint256 internal constant PROOF_OPENING_PROOF_AT_Z_Y_SLOT = 0x200 + 0x520 + 0x540;

     |  // @audit-issue Add NatSpec @dev documentation
 132 |  uint256 internal constant PROOF_OPENING_PROOF_AT_Z_OMEGA_X_SLOT = 0x200 + 0x520 + 0x560;

     |  // @audit-issue Add NatSpec @dev documentation
 133 |  uint256 internal constant PROOF_OPENING_PROOF_AT_Z_OMEGA_Y_SLOT = 0x200 + 0x520 + 0x580;

     |  // @audit-issue Add NatSpec @dev documentation
 135 |  uint256 internal constant PROOF_RECURSIVE_PART_P1_X_SLOT = 0x200 + 0x520 + 0x5a0;

     |  // @audit-issue Add NatSpec @dev documentation
 136 |  uint256 internal constant PROOF_RECURSIVE_PART_P1_Y_SLOT = 0x200 + 0x520 + 0x5c0;

     |  // @audit-issue Add NatSpec @dev documentation
 138 |  uint256 internal constant PROOF_RECURSIVE_PART_P2_X_SLOT = 0x200 + 0x520 + 0x5e0;

     |  // @audit-issue Add NatSpec @dev documentation
 139 |  uint256 internal constant PROOF_RECURSIVE_PART_P2_Y_SLOT = 0x200 + 0x520 + 0x600;

     |  // @audit-issue Add NatSpec @dev documentation
 145 |  uint256 internal constant TRANSCRIPT_BEGIN_SLOT = 0x200 + 0x520 + 0x620 + 0x00;

     |  // @audit-issue Add NatSpec @dev documentation
 146 |  uint256 internal constant TRANSCRIPT_DST_BYTE_SLOT = 0x200 + 0x520 + 0x620 + 0x03;

     |  // @audit-issue Add NatSpec @dev documentation
 147 |  uint256 internal constant TRANSCRIPT_STATE_0_SLOT = 0x200 + 0x520 + 0x620 + 0x04;

     |  // @audit-issue Add NatSpec @dev documentation
 148 |  uint256 internal constant TRANSCRIPT_STATE_1_SLOT = 0x200 + 0x520 + 0x620 + 0x24;
```
GitHub: [27](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L27), [28](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L28), [29](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L29), [30](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L30), [31](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L31), [32](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L32), [33](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L33), [34](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L34), [35](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L35), [36](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L36), [37](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L37), [38](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L38), [39](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L39), [40](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L40), [41](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L41), [42](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L42), [44](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L44), [45](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L45), [46](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L46), [47](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L47), [49](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L49), [50](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L50), [51](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L51), [52](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L52), [53](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L53), [54](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L54), [55](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L55), [56](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L56), [58](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L58), [59](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L59), [61](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L61), [62](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L62), [63](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L63), [64](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L64), [65](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L65), [66](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L66), [67](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L67), [68](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L68), [70](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L70), [71](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L71), [73](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L73), [79](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L79), [81](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L81), [82](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L82), [83](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L83), [84](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L84), [85](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L85), [86](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L86), [87](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L87), [88](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L88), [90](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L90), [91](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L91), [93](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L93), [94](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L94), [96](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L96), [97](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L97), [99](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L99), [100](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L100), [101](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L101), [102](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L102), [103](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L103), [104](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L104), [105](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L105), [106](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L106), [108](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L108), [109](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L109), [110](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L110), [111](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L111), [113](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L113), [114](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L114), [116](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L116), [117](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L117), [118](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L118), [120](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L120), [121](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L121), [122](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L122), [123](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L123), [124](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L124), [125](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L125), [126](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L126), [127](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L127), [128](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L128), [130](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L130), [131](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L131), [132](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L132), [133](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L133), [135](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L135), [136](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L136), [138](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L138), [139](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L139), [145](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L145), [146](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L146), [147](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L147), [148](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L148)


## [N-78] NatSpec: State variable declarations should have NatSpec descriptions

e.g. `@notice` for public state variables, and `@dev` for [non-public](https://docs.soliditylang.org/en/latest/natspec-format.html#tags) ones.

*Instances: 99*

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol

     |  // @audit-issue Add NatSpec documentation
  12 |  ZkSyncStateTransitionStorage internal s;
```
GitHub: [12](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L12)


```solidity
File: code/contracts/ethereum/contracts/common/ReentrancyGuard.sol

     |  // @audit-issue Add NatSpec documentation
  38 |  uint256 private constant _NOT_ENTERED = 1;

     |  // @audit-issue Add NatSpec documentation
  39 |  uint256 private constant _ENTERED = 2;
```
GitHub: [38](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/ReentrancyGuard.sol#L38), [39](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/ReentrancyGuard.sol#L39)


```solidity
File: code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol

     |  // @audit-issue Add NatSpec documentation
  22 |  uint160 constant offset = uint160(0x1111000000000000000000000000000000001111);
```
GitHub: [22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol#L22)


```solidity
File: code/contracts/ethereum/contracts/state-transition/Verifier.sol

     |  // @audit-issue Add NatSpec documentation
  27 |  uint256 internal constant VK_GATE_SETUP_0_X_SLOT = 0x200 + 0x000;

     |  // @audit-issue Add NatSpec documentation
  28 |  uint256 internal constant VK_GATE_SETUP_0_Y_SLOT = 0x200 + 0x020;

     |  // @audit-issue Add NatSpec documentation
  29 |  uint256 internal constant VK_GATE_SETUP_1_X_SLOT = 0x200 + 0x040;

     |  // @audit-issue Add NatSpec documentation
  30 |  uint256 internal constant VK_GATE_SETUP_1_Y_SLOT = 0x200 + 0x060;

     |  // @audit-issue Add NatSpec documentation
  31 |  uint256 internal constant VK_GATE_SETUP_2_X_SLOT = 0x200 + 0x080;

     |  // @audit-issue Add NatSpec documentation
  32 |  uint256 internal constant VK_GATE_SETUP_2_Y_SLOT = 0x200 + 0x0a0;

     |  // @audit-issue Add NatSpec documentation
  33 |  uint256 internal constant VK_GATE_SETUP_3_X_SLOT = 0x200 + 0x0c0;

     |  // @audit-issue Add NatSpec documentation
  34 |  uint256 internal constant VK_GATE_SETUP_3_Y_SLOT = 0x200 + 0x0e0;

     |  // @audit-issue Add NatSpec documentation
  35 |  uint256 internal constant VK_GATE_SETUP_4_X_SLOT = 0x200 + 0x100;

     |  // @audit-issue Add NatSpec documentation
  36 |  uint256 internal constant VK_GATE_SETUP_4_Y_SLOT = 0x200 + 0x120;

     |  // @audit-issue Add NatSpec documentation
  37 |  uint256 internal constant VK_GATE_SETUP_5_X_SLOT = 0x200 + 0x140;

     |  // @audit-issue Add NatSpec documentation
  38 |  uint256 internal constant VK_GATE_SETUP_5_Y_SLOT = 0x200 + 0x160;

     |  // @audit-issue Add NatSpec documentation
  39 |  uint256 internal constant VK_GATE_SETUP_6_X_SLOT = 0x200 + 0x180;

     |  // @audit-issue Add NatSpec documentation
  40 |  uint256 internal constant VK_GATE_SETUP_6_Y_SLOT = 0x200 + 0x1a0;

     |  // @audit-issue Add NatSpec documentation
  41 |  uint256 internal constant VK_GATE_SETUP_7_X_SLOT = 0x200 + 0x1c0;

     |  // @audit-issue Add NatSpec documentation
  42 |  uint256 internal constant VK_GATE_SETUP_7_Y_SLOT = 0x200 + 0x1e0;

     |  // @audit-issue Add NatSpec documentation
  44 |  uint256 internal constant VK_GATE_SELECTORS_0_X_SLOT = 0x200 + 0x200;

     |  // @audit-issue Add NatSpec documentation
  45 |  uint256 internal constant VK_GATE_SELECTORS_0_Y_SLOT = 0x200 + 0x220;

     |  // @audit-issue Add NatSpec documentation
  46 |  uint256 internal constant VK_GATE_SELECTORS_1_X_SLOT = 0x200 + 0x240;

     |  // @audit-issue Add NatSpec documentation
  47 |  uint256 internal constant VK_GATE_SELECTORS_1_Y_SLOT = 0x200 + 0x260;

     |  // @audit-issue Add NatSpec documentation
  49 |  uint256 internal constant VK_PERMUTATION_0_X_SLOT = 0x200 + 0x280;

     |  // @audit-issue Add NatSpec documentation
  50 |  uint256 internal constant VK_PERMUTATION_0_Y_SLOT = 0x200 + 0x2a0;

     |  // @audit-issue Add NatSpec documentation
  51 |  uint256 internal constant VK_PERMUTATION_1_X_SLOT = 0x200 + 0x2c0;

     |  // @audit-issue Add NatSpec documentation
  52 |  uint256 internal constant VK_PERMUTATION_1_Y_SLOT = 0x200 + 0x2e0;

     |  // @audit-issue Add NatSpec documentation
  53 |  uint256 internal constant VK_PERMUTATION_2_X_SLOT = 0x200 + 0x300;

     |  // @audit-issue Add NatSpec documentation
  54 |  uint256 internal constant VK_PERMUTATION_2_Y_SLOT = 0x200 + 0x320;

     |  // @audit-issue Add NatSpec documentation
  55 |  uint256 internal constant VK_PERMUTATION_3_X_SLOT = 0x200 + 0x340;

     |  // @audit-issue Add NatSpec documentation
  56 |  uint256 internal constant VK_PERMUTATION_3_Y_SLOT = 0x200 + 0x360;

     |  // @audit-issue Add NatSpec documentation
  58 |  uint256 internal constant VK_LOOKUP_SELECTOR_X_SLOT = 0x200 + 0x380;

     |  // @audit-issue Add NatSpec documentation
  59 |  uint256 internal constant VK_LOOKUP_SELECTOR_Y_SLOT = 0x200 + 0x3a0;

     |  // @audit-issue Add NatSpec documentation
  61 |  uint256 internal constant VK_LOOKUP_TABLE_0_X_SLOT = 0x200 + 0x3c0;

     |  // @audit-issue Add NatSpec documentation
  62 |  uint256 internal constant VK_LOOKUP_TABLE_0_Y_SLOT = 0x200 + 0x3e0;

     |  // @audit-issue Add NatSpec documentation
  63 |  uint256 internal constant VK_LOOKUP_TABLE_1_X_SLOT = 0x200 + 0x400;

     |  // @audit-issue Add NatSpec documentation
  64 |  uint256 internal constant VK_LOOKUP_TABLE_1_Y_SLOT = 0x200 + 0x420;

     |  // @audit-issue Add NatSpec documentation
  65 |  uint256 internal constant VK_LOOKUP_TABLE_2_X_SLOT = 0x200 + 0x440;

     |  // @audit-issue Add NatSpec documentation
  66 |  uint256 internal constant VK_LOOKUP_TABLE_2_Y_SLOT = 0x200 + 0x460;

     |  // @audit-issue Add NatSpec documentation
  67 |  uint256 internal constant VK_LOOKUP_TABLE_3_X_SLOT = 0x200 + 0x480;

     |  // @audit-issue Add NatSpec documentation
  68 |  uint256 internal constant VK_LOOKUP_TABLE_3_Y_SLOT = 0x200 + 0x4a0;

     |  // @audit-issue Add NatSpec documentation
  70 |  uint256 internal constant VK_LOOKUP_TABLE_TYPE_X_SLOT = 0x200 + 0x4c0;

     |  // @audit-issue Add NatSpec documentation
  71 |  uint256 internal constant VK_LOOKUP_TABLE_TYPE_Y_SLOT = 0x200 + 0x4e0;

     |  // @audit-issue Add NatSpec documentation
  73 |  uint256 internal constant VK_RECURSIVE_FLAG_SLOT = 0x200 + 0x500;

     |  // @audit-issue Add NatSpec documentation
  79 |  uint256 internal constant PROOF_PUBLIC_INPUT = 0x200 + 0x520 + 0x000;

     |  // @audit-issue Add NatSpec documentation
  81 |  uint256 internal constant PROOF_STATE_POLYS_0_X_SLOT = 0x200 + 0x520 + 0x020;

     |  // @audit-issue Add NatSpec documentation
  82 |  uint256 internal constant PROOF_STATE_POLYS_0_Y_SLOT = 0x200 + 0x520 + 0x040;

     |  // @audit-issue Add NatSpec documentation
  83 |  uint256 internal constant PROOF_STATE_POLYS_1_X_SLOT = 0x200 + 0x520 + 0x060;

     |  // @audit-issue Add NatSpec documentation
  84 |  uint256 internal constant PROOF_STATE_POLYS_1_Y_SLOT = 0x200 + 0x520 + 0x080;

     |  // @audit-issue Add NatSpec documentation
  85 |  uint256 internal constant PROOF_STATE_POLYS_2_X_SLOT = 0x200 + 0x520 + 0x0a0;

     |  // @audit-issue Add NatSpec documentation
  86 |  uint256 internal constant PROOF_STATE_POLYS_2_Y_SLOT = 0x200 + 0x520 + 0x0c0;

     |  // @audit-issue Add NatSpec documentation
  87 |  uint256 internal constant PROOF_STATE_POLYS_3_X_SLOT = 0x200 + 0x520 + 0x0e0;

     |  // @audit-issue Add NatSpec documentation
  88 |  uint256 internal constant PROOF_STATE_POLYS_3_Y_SLOT = 0x200 + 0x520 + 0x100;

     |  // @audit-issue Add NatSpec documentation
  90 |  uint256 internal constant PROOF_COPY_PERMUTATION_GRAND_PRODUCT_X_SLOT = 0x200 + 0x520 + 0x120;

     |  // @audit-issue Add NatSpec documentation
  91 |  uint256 internal constant PROOF_COPY_PERMUTATION_GRAND_PRODUCT_Y_SLOT = 0x200 + 0x520 + 0x140;

     |  // @audit-issue Add NatSpec documentation
  93 |  uint256 internal constant PROOF_LOOKUP_S_POLY_X_SLOT = 0x200 + 0x520 + 0x160;

     |  // @audit-issue Add NatSpec documentation
  94 |  uint256 internal constant PROOF_LOOKUP_S_POLY_Y_SLOT = 0x200 + 0x520 + 0x180;

     |  // @audit-issue Add NatSpec documentation
  96 |  uint256 internal constant PROOF_LOOKUP_GRAND_PRODUCT_X_SLOT = 0x200 + 0x520 + 0x1a0;

     |  // @audit-issue Add NatSpec documentation
  97 |  uint256 internal constant PROOF_LOOKUP_GRAND_PRODUCT_Y_SLOT = 0x200 + 0x520 + 0x1c0;

     |  // @audit-issue Add NatSpec documentation
  99 |  uint256 internal constant PROOF_QUOTIENT_POLY_PARTS_0_X_SLOT = 0x200 + 0x520 + 0x1e0;

     |  // @audit-issue Add NatSpec documentation
 100 |  uint256 internal constant PROOF_QUOTIENT_POLY_PARTS_0_Y_SLOT = 0x200 + 0x520 + 0x200;

     |  // @audit-issue Add NatSpec documentation
 101 |  uint256 internal constant PROOF_QUOTIENT_POLY_PARTS_1_X_SLOT = 0x200 + 0x520 + 0x220;

     |  // @audit-issue Add NatSpec documentation
 102 |  uint256 internal constant PROOF_QUOTIENT_POLY_PARTS_1_Y_SLOT = 0x200 + 0x520 + 0x240;

     |  // @audit-issue Add NatSpec documentation
 103 |  uint256 internal constant PROOF_QUOTIENT_POLY_PARTS_2_X_SLOT = 0x200 + 0x520 + 0x260;

     |  // @audit-issue Add NatSpec documentation
 104 |  uint256 internal constant PROOF_QUOTIENT_POLY_PARTS_2_Y_SLOT = 0x200 + 0x520 + 0x280;

     |  // @audit-issue Add NatSpec documentation
 105 |  uint256 internal constant PROOF_QUOTIENT_POLY_PARTS_3_X_SLOT = 0x200 + 0x520 + 0x2a0;

     |  // @audit-issue Add NatSpec documentation
 106 |  uint256 internal constant PROOF_QUOTIENT_POLY_PARTS_3_Y_SLOT = 0x200 + 0x520 + 0x2c0;

     |  // @audit-issue Add NatSpec documentation
 108 |  uint256 internal constant PROOF_STATE_POLYS_0_OPENING_AT_Z_SLOT = 0x200 + 0x520 + 0x2e0;

     |  // @audit-issue Add NatSpec documentation
 109 |  uint256 internal constant PROOF_STATE_POLYS_1_OPENING_AT_Z_SLOT = 0x200 + 0x520 + 0x300;

     |  // @audit-issue Add NatSpec documentation
 110 |  uint256 internal constant PROOF_STATE_POLYS_2_OPENING_AT_Z_SLOT = 0x200 + 0x520 + 0x320;

     |  // @audit-issue Add NatSpec documentation
 111 |  uint256 internal constant PROOF_STATE_POLYS_3_OPENING_AT_Z_SLOT = 0x200 + 0x520 + 0x340;

     |  // @audit-issue Add NatSpec documentation
 113 |  uint256 internal constant PROOF_STATE_POLYS_3_OPENING_AT_Z_OMEGA_SLOT = 0x200 + 0x520 + 0x360;

     |  // @audit-issue Add NatSpec documentation
 114 |  uint256 internal constant PROOF_GATE_SELECTORS_0_OPENING_AT_Z_SLOT = 0x200 + 0x520 + 0x380;

     |  // @audit-issue Add NatSpec documentation
 116 |  uint256 internal constant PROOF_COPY_PERMUTATION_POLYS_0_OPENING_AT_Z_SLOT = 0x200 + 0x520 + 0x3a0;

     |  // @audit-issue Add NatSpec documentation
 117 |  uint256 internal constant PROOF_COPY_PERMUTATION_POLYS_1_OPENING_AT_Z_SLOT = 0x200 + 0x520 + 0x3c0;

     |  // @audit-issue Add NatSpec documentation
 118 |  uint256 internal constant PROOF_COPY_PERMUTATION_POLYS_2_OPENING_AT_Z_SLOT = 0x200 + 0x520 + 0x3e0;

     |  // @audit-issue Add NatSpec documentation
 120 |  uint256 internal constant PROOF_COPY_PERMUTATION_GRAND_PRODUCT_OPENING_AT_Z_OMEGA_SLOT = 0x200 + 0x520 + 0x400;

     |  // @audit-issue Add NatSpec documentation
 121 |  uint256 internal constant PROOF_LOOKUP_S_POLY_OPENING_AT_Z_OMEGA_SLOT = 0x200 + 0x520 + 0x420;

     |  // @audit-issue Add NatSpec documentation
 122 |  uint256 internal constant PROOF_LOOKUP_GRAND_PRODUCT_OPENING_AT_Z_OMEGA_SLOT = 0x200 + 0x520 + 0x440;

     |  // @audit-issue Add NatSpec documentation
 123 |  uint256 internal constant PROOF_LOOKUP_T_POLY_OPENING_AT_Z_SLOT = 0x200 + 0x520 + 0x460;

     |  // @audit-issue Add NatSpec documentation
 124 |  uint256 internal constant PROOF_LOOKUP_T_POLY_OPENING_AT_Z_OMEGA_SLOT = 0x200 + 0x520 + 0x480;

     |  // @audit-issue Add NatSpec documentation
 125 |  uint256 internal constant PROOF_LOOKUP_SELECTOR_POLY_OPENING_AT_Z_SLOT = 0x200 + 0x520 + 0x4a0;

     |  // @audit-issue Add NatSpec documentation
 126 |  uint256 internal constant PROOF_LOOKUP_TABLE_TYPE_POLY_OPENING_AT_Z_SLOT = 0x200 + 0x520 + 0x4c0;

     |  // @audit-issue Add NatSpec documentation
 127 |  uint256 internal constant PROOF_QUOTIENT_POLY_OPENING_AT_Z_SLOT = 0x200 + 0x520 + 0x4e0;

     |  // @audit-issue Add NatSpec documentation
 128 |  uint256 internal constant PROOF_LINEARISATION_POLY_OPENING_AT_Z_SLOT = 0x200 + 0x520 + 0x500;

     |  // @audit-issue Add NatSpec documentation
 130 |  uint256 internal constant PROOF_OPENING_PROOF_AT_Z_X_SLOT = 0x200 + 0x520 + 0x520;

     |  // @audit-issue Add NatSpec documentation
 131 |  uint256 internal constant PROOF_OPENING_PROOF_AT_Z_Y_SLOT = 0x200 + 0x520 + 0x540;

     |  // @audit-issue Add NatSpec documentation
 132 |  uint256 internal constant PROOF_OPENING_PROOF_AT_Z_OMEGA_X_SLOT = 0x200 + 0x520 + 0x560;

     |  // @audit-issue Add NatSpec documentation
 133 |  uint256 internal constant PROOF_OPENING_PROOF_AT_Z_OMEGA_Y_SLOT = 0x200 + 0x520 + 0x580;

     |  // @audit-issue Add NatSpec documentation
 135 |  uint256 internal constant PROOF_RECURSIVE_PART_P1_X_SLOT = 0x200 + 0x520 + 0x5a0;

     |  // @audit-issue Add NatSpec documentation
 136 |  uint256 internal constant PROOF_RECURSIVE_PART_P1_Y_SLOT = 0x200 + 0x520 + 0x5c0;

     |  // @audit-issue Add NatSpec documentation
 138 |  uint256 internal constant PROOF_RECURSIVE_PART_P2_X_SLOT = 0x200 + 0x520 + 0x5e0;

     |  // @audit-issue Add NatSpec documentation
 139 |  uint256 internal constant PROOF_RECURSIVE_PART_P2_Y_SLOT = 0x200 + 0x520 + 0x600;

     |  // @audit-issue Add NatSpec documentation
 145 |  uint256 internal constant TRANSCRIPT_BEGIN_SLOT = 0x200 + 0x520 + 0x620 + 0x00;

     |  // @audit-issue Add NatSpec documentation
 146 |  uint256 internal constant TRANSCRIPT_DST_BYTE_SLOT = 0x200 + 0x520 + 0x620 + 0x03;

     |  // @audit-issue Add NatSpec documentation
 147 |  uint256 internal constant TRANSCRIPT_STATE_0_SLOT = 0x200 + 0x520 + 0x620 + 0x04;

     |  // @audit-issue Add NatSpec documentation
 148 |  uint256 internal constant TRANSCRIPT_STATE_1_SLOT = 0x200 + 0x520 + 0x620 + 0x24;

     |  // @audit-issue Add NatSpec documentation
 149 |  uint256 internal constant TRANSCRIPT_CHALLENGE_SLOT = 0x200 + 0x520 + 0x620 + 0x44;
```
GitHub: [27](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L27), [28](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L28), [29](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L29), [30](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L30), [31](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L31), [32](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L32), [33](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L33), [34](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L34), [35](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L35), [36](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L36), [37](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L37), [38](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L38), [39](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L39), [40](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L40), [41](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L41), [42](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L42), [44](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L44), [45](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L45), [46](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L46), [47](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L47), [49](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L49), [50](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L50), [51](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L51), [52](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L52), [53](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L53), [54](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L54), [55](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L55), [56](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L56), [58](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L58), [59](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L59), [61](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L61), [62](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L62), [63](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L63), [64](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L64), [65](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L65), [66](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L66), [67](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L67), [68](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L68), [70](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L70), [71](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L71), [73](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L73), [79](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L79), [81](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L81), [82](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L82), [83](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L83), [84](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L84), [85](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L85), [86](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L86), [87](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L87), [88](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L88), [90](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L90), [91](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L91), [93](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L93), [94](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L94), [96](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L96), [97](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L97), [99](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L99), [100](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L100), [101](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L101), [102](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L102), [103](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L103), [104](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L104), [105](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L105), [106](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L106), [108](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L108), [109](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L109), [110](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L110), [111](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L111), [113](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L113), [114](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L114), [116](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L116), [117](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L117), [118](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L118), [120](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L120), [121](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L121), [122](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L122), [123](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L123), [124](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L124), [125](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L125), [126](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L126), [127](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L127), [128](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L128), [130](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L130), [131](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L131), [132](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L132), [133](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L133), [135](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L135), [136](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L136), [138](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L138), [139](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L139), [145](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L145), [146](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L146), [147](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L147), [148](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L148), [149](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L149)


## [N-79] NatSpec: missing from file

As per the [Solidity Style Guide](https://docs.soliditylang.org/en/v0.8.22/style-guide.html#natspec):

        >  They are written with a triple slash (///) or a double asterisk block (/** ... */) and they should be used directly above function declarations or statements.

        Files with no NatSpec documentation are more difficult to use and review.
        

*Instances: 99*

```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

     |  // @audit-issue Add NatSpec comments to this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

     |  // @audit-issue Add NatSpec comments to this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

     |  // @audit-issue Add NatSpec comments to this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

     |  // @audit-issue Add NatSpec comments to this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

     |  // @audit-issue Add NatSpec comments to this file
   1 |  pragma solidity 0.8.20;
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

     |  // @audit-issue Add NatSpec comments to this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol

     |  // @audit-issue Add NatSpec comments to this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol

     |  // @audit-issue Add NatSpec comments to this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol

     |  // @audit-issue Add NatSpec comments to this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol

     |  // @audit-issue Add NatSpec comments to this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

     |  // @audit-issue Add NatSpec comments to this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol

     |  // @audit-issue Add NatSpec comments to this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

     |  // @audit-issue Add NatSpec comments to this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol

     |  // @audit-issue Add NatSpec comments to this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol

     |  // @audit-issue Add NatSpec comments to this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol

     |  // @audit-issue Add NatSpec comments to this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/upgrades/DefaultUpgrade.sol

     |  // @audit-issue Add NatSpec comments to this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/DefaultUpgrade.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/upgrades/GenesisUpgrade.sol

     |  // @audit-issue Add NatSpec comments to this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/GenesisUpgrade.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol

     |  // @audit-issue Add NatSpec comments to this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/common/libraries/UncheckedMath.sol

     |  // @audit-issue Add NatSpec comments to this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/UncheckedMath.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol

     |  // @audit-issue Add NatSpec comments to this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol

     |  // @audit-issue Add NatSpec comments to this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/LibMap.sol

     |  // @audit-issue Add NatSpec comments to this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/LibMap.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol

     |  // @audit-issue Add NatSpec comments to this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol

     |  // @audit-issue Add NatSpec comments to this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol

     |  // @audit-issue Add NatSpec comments to this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol

     |  // @audit-issue Add NatSpec comments to this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol

     |  // @audit-issue Add NatSpec comments to this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL2Bridge.sol

     |  // @audit-issue Add NatSpec comments to this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL2Bridge.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IWETH9.sol

     |  // @audit-issue Add NatSpec comments to this file
   1 |  // SPDX-License-Identifier: Apache-2.0
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IWETH9.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol

     |  // @audit-issue Add NatSpec comments to this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/common/interfaces/IL2ContractDeployer.sol

     |  // @audit-issue Add NatSpec comments to this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/interfaces/IL2ContractDeployer.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/governance/IGovernance.sol

     |  // @audit-issue Add NatSpec comments to this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol

     |  // @audit-issue Add NatSpec comments to this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol

     |  // @audit-issue Add NatSpec comments to this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol

     |  // @audit-issue Add NatSpec comments to this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol

     |  // @audit-issue Add NatSpec comments to this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol

     |  // @audit-issue Add NatSpec comments to this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/ILegacyGetters.sol

     |  // @audit-issue Add NatSpec comments to this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/ILegacyGetters.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol

     |  // @audit-issue Add NatSpec comments to this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IVerifier.sol

     |  // @audit-issue Add NatSpec comments to this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IVerifier.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol

     |  // @audit-issue Add NatSpec comments to this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransitionBase.sol

     |  // @audit-issue Add NatSpec comments to this file
   1 |  // SPDX-License-Identifier: UNLICENSED
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransitionBase.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/upgrades/IDefaultUpgrade.sol

     |  // @audit-issue Add NatSpec comments to this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/IDefaultUpgrade.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/common/Config.sol

     |  // @audit-issue Add NatSpec comments to this file
   1 |  pragma solidity 0.8.20;
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/Config.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/common/L2ContractAddresses.sol

     |  // @audit-issue Add NatSpec comments to this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/L2ContractAddresses.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/common/Messaging.sol

     |  // @audit-issue Add NatSpec comments to this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/Messaging.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/common/ReentrancyGuard.sol

     |  // @audit-issue Add NatSpec comments to this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/ReentrancyGuard.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol

     |  // @audit-issue Add NatSpec comments to this file
   1 |  // SPDX-License-Identifier: Apache-2.0
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/Verifier.sol

     |  // @audit-issue Add NatSpec comments to this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/upgrades/Upgrade_4844.sol

     |  // @audit-issue Add NatSpec comments to this file
   1 |  pragma solidity 0.8.20;
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/Upgrade_4844.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/upgrades/Upgrade_v1_4_1.sol

     |  // @audit-issue Add NatSpec comments to this file
   1 |  pragma solidity 0.8.20;
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/Upgrade_v1_4_1.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/common/Dependencies.sol

     |  // @audit-issue Add NatSpec comments to this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/Dependencies.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/l2-deps/ISystemContext.sol

     |  // @audit-issue Add NatSpec comments to this file
   1 |  // SPDX-License-Identifier: UNLICENSED
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/l2-deps/ISystemContext.sol#L1)


```solidity
File: code/system-contracts/contracts/AccountCodeStorage.sol

     |  // @audit-issue Add NatSpec comments to this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L1)


```solidity
File: code/system-contracts/contracts/BootloaderUtilities.sol

     |  // @audit-issue Add NatSpec comments to this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L1)


```solidity
File: code/system-contracts/contracts/ComplexUpgrader.sol

     |  // @audit-issue Add NatSpec comments to this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ComplexUpgrader.sol#L1)


```solidity
File: code/system-contracts/contracts/Compressor.sol

     |  // @audit-issue Add NatSpec comments to this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L1)


```solidity
File: code/system-contracts/contracts/Constants.sol

     |  // @audit-issue Add NatSpec comments to this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Constants.sol#L1)


```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

     |  // @audit-issue Add NatSpec comments to this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L1)


```solidity
File: code/system-contracts/contracts/DefaultAccount.sol

     |  // @audit-issue Add NatSpec comments to this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L1)


```solidity
File: code/system-contracts/contracts/EmptyContract.sol

     |  // @audit-issue Add NatSpec comments to this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/EmptyContract.sol#L1)


```solidity
File: code/system-contracts/contracts/ImmutableSimulator.sol

     |  // @audit-issue Add NatSpec comments to this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ImmutableSimulator.sol#L1)


```solidity
File: code/system-contracts/contracts/KnownCodesStorage.sol

     |  // @audit-issue Add NatSpec comments to this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/KnownCodesStorage.sol#L1)


```solidity
File: code/system-contracts/contracts/L1Messenger.sol

     |  // @audit-issue Add NatSpec comments to this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L1)


```solidity
File: code/system-contracts/contracts/L2BaseToken.sol

     |  // @audit-issue Add NatSpec comments to this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L2BaseToken.sol#L1)


```solidity
File: code/system-contracts/contracts/MsgValueSimulator.sol

     |  // @audit-issue Add NatSpec comments to this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/MsgValueSimulator.sol#L1)


```solidity
File: code/system-contracts/contracts/NonceHolder.sol

     |  // @audit-issue Add NatSpec comments to this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/NonceHolder.sol#L1)


```solidity
File: code/system-contracts/contracts/PubdataChunkPublisher.sol

     |  // @audit-issue Add NatSpec comments to this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/PubdataChunkPublisher.sol#L1)


```solidity
File: code/system-contracts/contracts/SystemContext.sol

     |  // @audit-issue Add NatSpec comments to this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L1)


```solidity
File: code/system-contracts/contracts/GasBoundCaller.sol

     |  // @audit-issue Add NatSpec comments to this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/GasBoundCaller.sol#L1)


```solidity
File: code/system-contracts/contracts/libraries/EfficientCall.sol

     |  // @audit-issue Add NatSpec comments to this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L1)


```solidity
File: code/system-contracts/contracts/libraries/RLPEncoder.sol

     |  // @audit-issue Add NatSpec comments to this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/RLPEncoder.sol#L1)


```solidity
File: code/system-contracts/contracts/libraries/SystemContractHelper.sol

     |  // @audit-issue Add NatSpec comments to this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L1)


```solidity
File: code/system-contracts/contracts/libraries/SystemContractsCaller.sol

     |  // @audit-issue Add NatSpec comments to this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L1)


```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

     |  // @audit-issue Add NatSpec comments to this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L1)


```solidity
File: code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol

     |  // @audit-issue Add NatSpec comments to this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol#L1)


```solidity
File: code/system-contracts/contracts/libraries/Utils.sol

     |  // @audit-issue Add NatSpec comments to this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L1)


```solidity
File: code/system-contracts/contracts/interfaces/IAccount.sol

     |  // @audit-issue Add NatSpec comments to this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IAccount.sol#L1)


```solidity
File: code/system-contracts/contracts/interfaces/IAccountCodeStorage.sol

     |  // @audit-issue Add NatSpec comments to this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IAccountCodeStorage.sol#L1)


```solidity
File: code/system-contracts/contracts/interfaces/IBaseToken.sol

     |  // @audit-issue Add NatSpec comments to this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBaseToken.sol#L1)


```solidity
File: code/system-contracts/contracts/interfaces/IBootloaderUtilities.sol

     |  // @audit-issue Add NatSpec comments to this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IBootloaderUtilities.sol#L1)


```solidity
File: code/system-contracts/contracts/interfaces/IComplexUpgrader.sol

     |  // @audit-issue Add NatSpec comments to this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IComplexUpgrader.sol#L1)


```solidity
File: code/system-contracts/contracts/interfaces/ICompressor.sol

     |  // @audit-issue Add NatSpec comments to this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ICompressor.sol#L1)


```solidity
File: code/system-contracts/contracts/interfaces/IContractDeployer.sol

     |  // @audit-issue Add NatSpec comments to this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L1)


```solidity
File: code/system-contracts/contracts/interfaces/IImmutableSimulator.sol

     |  // @audit-issue Add NatSpec comments to this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IImmutableSimulator.sol#L1)


```solidity
File: code/system-contracts/contracts/interfaces/IKnownCodesStorage.sol

     |  // @audit-issue Add NatSpec comments to this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IKnownCodesStorage.sol#L1)


```solidity
File: code/system-contracts/contracts/interfaces/IL1Messenger.sol

     |  // @audit-issue Add NatSpec comments to this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL1Messenger.sol#L1)


```solidity
File: code/system-contracts/contracts/interfaces/IL2StandardToken.sol

     |  // @audit-issue Add NatSpec comments to this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL2StandardToken.sol#L1)


```solidity
File: code/system-contracts/contracts/interfaces/IMailbox.sol

     |  // @audit-issue Add NatSpec comments to this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IMailbox.sol#L1)


```solidity
File: code/system-contracts/contracts/interfaces/INonceHolder.sol

     |  // @audit-issue Add NatSpec comments to this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/INonceHolder.sol#L1)


```solidity
File: code/system-contracts/contracts/interfaces/IPaymaster.sol

     |  // @audit-issue Add NatSpec comments to this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IPaymaster.sol#L1)


```solidity
File: code/system-contracts/contracts/interfaces/IPaymasterFlow.sol

     |  // @audit-issue Add NatSpec comments to this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IPaymasterFlow.sol#L1)


```solidity
File: code/system-contracts/contracts/interfaces/IPubdataChunkPublisher.sol

     |  // @audit-issue Add NatSpec comments to this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IPubdataChunkPublisher.sol#L1)


```solidity
File: code/system-contracts/contracts/interfaces/ISystemContext.sol

     |  // @audit-issue Add NatSpec comments to this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L1)


```solidity
File: code/system-contracts/contracts/interfaces/ISystemContextDeprecated.sol

     |  // @audit-issue Add NatSpec comments to this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContextDeprecated.sol#L1)


```solidity
File: code/system-contracts/contracts/interfaces/ISystemContract.sol

     |  // @audit-issue Add NatSpec comments to this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContract.sol#L1)


```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

     |  // @audit-issue Add NatSpec comments to this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L1)


```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

     |  // @audit-issue Add NatSpec comments to this file
   1 |  // SPDX-License-Identifier: MIT
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L1)


## [N-80] NatSpec: public state variable declarations should have @notice tag

As per [Solidity NatSpec](https://docs.soliditylang.org/en/latest/natspec-format.html#tags).

*Instances: 35*

```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

     |  // @audit-issue Add NatSpec documentation
  23 |  IL1SharedBridge public immutable override sharedBridge;

     |  // @audit-issue Add NatSpec documentation
  27 |  mapping(uint256 l2BatchNumber => mapping(uint256 l2ToL1MessageNumber => bool isFinalized))
  28 |      public isWithdrawalFinalized;

     |  // @audit-issue Add NatSpec documentation
  32 |  mapping(address account => mapping(address l1Token => mapping(bytes32 depositL2TxHash => uint256 amount)))
  33 |      public depositAmount;

     |  // @audit-issue Add NatSpec documentation
  36 |  address public l2Bridge;

     |  // @audit-issue Add NatSpec documentation
  39 |  address public l2TokenBeacon;

     |  // @audit-issue Add NatSpec documentation
  42 |  bytes32 public l2TokenProxyBytecodeHash;
```
GitHub: [23](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L23), [27-28](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L27-L28), [32-33](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L32-L33), [36](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L36), [39](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L39), [42](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L42)


```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

     |  // @audit-issue Add NatSpec documentation
  34 |  address public immutable override l1WethAddress;

     |  // @audit-issue Add NatSpec documentation
  37 |  IBridgehub public immutable override bridgehub;

     |  // @audit-issue Add NatSpec documentation
  40 |  IL1ERC20Bridge public immutable override legacyBridge;

     |  // @audit-issue Add NatSpec documentation
  48 |  mapping(uint256 chainId => address l2Bridge) public override l2BridgeAddress;

     |  // @audit-issue Add NatSpec documentation
  52 |  mapping(uint256 chainId => mapping(bytes32 l2DepositTxHash => bytes32 depositDataHash))
  53 |      public
  54 |      override depositHappened;

     |  // @audit-issue Add NatSpec documentation
  57 |  mapping(uint256 chainId => mapping(uint256 l2BatchNumber => mapping(uint256 l2ToL1MessageNumber => bool isFinalized)))
  58 |      public isWithdrawalFinalized;
```
GitHub: [34](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L34), [37](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L37), [40](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L40), [48](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L48), [52-54](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L52-L54), [57-58](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L57-L58)


```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

     |  // @audit-issue Add NatSpec documentation
  32 |  address public admin;
```
GitHub: [32](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L32)


```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

     |  // @audit-issue Add NatSpec documentation
  35 |  bytes32 public storedBatchZero;

     |  // @audit-issue Add NatSpec documentation
  38 |  bytes32 public initialCutHash;

     |  // @audit-issue Add NatSpec documentation
  41 |  address public genesisUpgrade;

     |  // @audit-issue Add NatSpec documentation
  44 |  uint256 public protocolVersion;

     |  // @audit-issue Add NatSpec documentation
  47 |  address public validatorTimelock;

     |  // @audit-issue Add NatSpec documentation
  50 |  mapping(uint256 => bytes32) public upgradeCutHash;

     |  // @audit-issue Add NatSpec documentation
  53 |  address public admin;
```
GitHub: [35](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L35), [38](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L38), [41](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L41), [44](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L44), [47](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L47), [50](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L50), [53](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L53)


```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

     |  // @audit-issue Add NatSpec documentation
  26 |  string public constant override getName = "ValidatorTimelock";

     |  // @audit-issue Add NatSpec documentation
  44 |  IStateTransitionManager public stateTransitionManager;

     |  // @audit-issue Add NatSpec documentation
  50 |  mapping(uint256 _chainId => mapping(address _validator => bool)) public validators;

     |  // @audit-issue Add NatSpec documentation
  53 |  uint32 public executionDelay;
```
GitHub: [26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L26), [44](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L44), [50](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L50), [53](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L53)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol

     |  // @audit-issue Add NatSpec documentation
  20 |  string public constant override getName = "AdminFacet";
```
GitHub: [20](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L20)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

     |  // @audit-issue Add NatSpec documentation
  27 |  string public constant override getName = "ExecutorFacet";
```
GitHub: [27](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L27)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol

     |  // @audit-issue Add NatSpec documentation
  25 |  string public constant override getName = "GettersFacet";
```
GitHub: [25](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L25)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

     |  // @audit-issue Add NatSpec documentation
  35 |  string public constant override getName = "MailboxFacet";
```
GitHub: [35](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L35)


```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

     |  // @audit-issue Add NatSpec documentation
  25 |  address public override l1Bridge;

     |  // @audit-issue Add NatSpec documentation
  29 |  UpgradeableBeacon public l2TokenBeacon;

     |  // @audit-issue Add NatSpec documentation
  35 |  mapping(address l2TokenAddress => address l1TokenAddress) public override l1TokenAddress;
```
GitHub: [25](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L25), [29](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L29), [35](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L35)


```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

     |  // @audit-issue Add NatSpec documentation
  34 |  address public override l2Bridge;

     |  // @audit-issue Add NatSpec documentation
  37 |  address public override l1Address;
```
GitHub: [34](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L34), [37](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L37)


```solidity
File: code/contracts/zksync/contracts/bridge/L2WrappedBaseToken.sol

     |  // @audit-issue Add NatSpec documentation
  25 |  address public override l2Bridge;

     |  // @audit-issue Add NatSpec documentation
  28 |  address public override l1Address;
```
GitHub: [25](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2WrappedBaseToken.sol#L25), [28](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2WrappedBaseToken.sol#L28)


## [N-81] Parameter change does not emit event

Events help non-contract tools to track changes, and events prevent users from being surprised by changes

*Instances: 57*

```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

     |  // @audit-issue Consider emitting an event documenting the parameter change
  82 |  function addStateTransitionManager(address _stateTransitionManager) external onlyOwner {

     |  // @audit-issue Consider emitting an event documenting the parameter change
  92 |  function removeStateTransitionManager(address _stateTransitionManager) external onlyOwner {

     |  // @audit-issue Consider emitting an event documenting the parameter change
 101 |  function addToken(address _token) external onlyOwner {

     |  // @audit-issue Consider emitting an event documenting the parameter change
 108 |  function setSharedBridge(address _sharedBridge) external onlyOwner {
```
GitHub: [82](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L82), [92](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L92), [101](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L101), [108](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L108)


```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

     |  // @audit-issue Consider emitting an event documenting the parameter change
 134 |  function setValidatorTimelock(address _validatorTimelock) external onlyOwnerOrAdmin {

     |  // @audit-issue Consider emitting an event documenting the parameter change
 139 |  function setInitialCutHash(Diamond.DiamondCutData calldata _diamondCut) external onlyOwner {

     |  // @audit-issue Consider emitting an event documenting the parameter change
 144 |  function setNewVersionUpgrade(
 145 |      Diamond.DiamondCutData calldata _cutData,
 146 |      uint256 _oldProtocolVersion,
 147 |      uint256 _newProtocolVersion
 148 |  ) external onlyOwner {

     |  // @audit-issue Consider emitting an event documenting the parameter change
 154 |  function setUpgradeDiamondCut(
 155 |      Diamond.DiamondCutData calldata _cutData,
 156 |      uint256 _oldProtocolVersion
 157 |  ) external onlyOwner {
```
GitHub: [134](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L134), [139](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L139), [144-148](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L144-L148), [154-157](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L154-L157)


```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

     |  // @audit-issue Consider emitting an event documenting the parameter change
  73 |  function setStateTransitionManager(IStateTransitionManager _stateTransitionManager) external onlyOwner {
```
GitHub: [73](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L73)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

     |  // @audit-issue Consider emitting an event documenting the parameter change
 597 |  function _setBit(uint256 _bitMap, uint8 _index) internal pure returns (uint256) {
```
GitHub: [597](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L597)


```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol

     |  // @audit-issue Consider emitting an event documenting the parameter change
 163 |  function _upgradeVerifier(address _newVerifier, VerifierParams calldata _verifierParams) internal {

     |  // @audit-issue Consider emitting an event documenting the parameter change
 171 |  function _setBaseSystemContracts(bytes32 _bootloaderHash, bytes32 _defaultAccountHash) internal {

     |  // @audit-issue Consider emitting an event documenting the parameter change
 180 |  function _setL2SystemContractUpgrade(
 181 |      L2CanonicalTransaction calldata _l2ProtocolUpgradeTx,
 182 |      bytes[] calldata _factoryDeps,
 183 |      uint256 _newProtocolVersion
 184 |  ) internal returns (bytes32) {

     |  // @audit-issue Consider emitting an event documenting the parameter change
 263 |  function _upgradeL1Contract(bytes calldata _customCallDataForUpgrade) internal virtual {}
```
GitHub: [163](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L163), [171](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L171), [180-184](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L180-L184), [263](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L263)


```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol

     |  // @audit-issue Consider emitting an event documenting the parameter change
 126 |  function _addFunctions(address _facet, bytes4[] memory _selectors, bool _isFacetFreezable) private {

     |  // @audit-issue Consider emitting an event documenting the parameter change
 172 |  function _removeFunctions(address _facet, bytes4[] memory _selectors) private {

     |  // @audit-issue Consider emitting an event documenting the parameter change
 205 |  function _addOneFunction(address _facet, bytes4 _selector, bool _isSelectorFreezable) private {

     |  // @audit-issue Consider emitting an event documenting the parameter change
 228 |  function _removeOneFunction(address _facet, bytes4 _selector) private {

     |  // @audit-issue Consider emitting an event documenting the parameter change
 257 |  function _removeFacet(address _facet) private {
```
GitHub: [126](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L126), [172](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L172), [205](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L205), [228](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L228), [257](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L257)


```solidity
File: code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol

     |  // @audit-issue Consider emitting an event documenting the parameter change
  53 |  function setPendingAdmin(address _newPendingAdmin) external;

     |  // @audit-issue Consider emitting an event documenting the parameter change
 125 |  function addStateTransitionManager(address _stateTransitionManager) external;

     |  // @audit-issue Consider emitting an event documenting the parameter change
 127 |  function removeStateTransitionManager(address _stateTransitionManager) external;

     |  // @audit-issue Consider emitting an event documenting the parameter change
 129 |  function addToken(address _token) external;

     |  // @audit-issue Consider emitting an event documenting the parameter change
 131 |  function setSharedBridge(address _sharedBridge) external;
```
GitHub: [53](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L53), [125](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L125), [127](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L127), [129](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L129), [131](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L131)


```solidity
File: code/contracts/ethereum/contracts/governance/IGovernance.sol

     |  // @audit-issue Consider emitting an event documenting the parameter change
  63 |  function updateDelay(uint256 _newDelay) external;

     |  // @audit-issue Consider emitting an event documenting the parameter change
  65 |  function updateSecurityCouncil(address _newSecurityCouncil) external;
```
GitHub: [63](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L63), [65](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L65)


```solidity
File: code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol

     |  // @audit-issue Consider emitting an event documenting the parameter change
  48 |  function setPendingAdmin(address _newPendingAdmin) external;

     |  // @audit-issue Consider emitting an event documenting the parameter change
  61 |  function upgradeCutHash(uint256 _protocolVersion) external view returns (bytes32);

     |  // @audit-issue Consider emitting an event documenting the parameter change
  67 |  function setInitialCutHash(Diamond.DiamondCutData calldata _diamondCut) external;

     |  // @audit-issue Consider emitting an event documenting the parameter change
  69 |  function setValidatorTimelock(address _validatorTimelock) external;

     |  // @audit-issue Consider emitting an event documenting the parameter change
  84 |  function setNewVersionUpgrade(
  85 |      Diamond.DiamondCutData calldata _cutData,
  86 |      uint256 _oldProtocolVersion,
  87 |      uint256 _newProtocolVersion
  88 |  ) external;

     |  // @audit-issue Consider emitting an event documenting the parameter change
  90 |  function setUpgradeDiamondCut(Diamond.DiamondCutData calldata _cutData, uint256 _oldProtocolVersion) external;
```
GitHub: [48](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L48), [61](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L61), [67](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L67), [69](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L69), [84-88](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L84-L88), [90](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L90)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol

     |  // @audit-issue Consider emitting an event documenting the parameter change
  17 |  function setPendingAdmin(address _newPendingAdmin) external;

     |  // @audit-issue Consider emitting an event documenting the parameter change
  25 |  function setValidator(address _validator, bool _active) external;

     |  // @audit-issue Consider emitting an event documenting the parameter change
  29 |  function setPorterAvailability(bool _zkPorterIsAvailable) external;

     |  // @audit-issue Consider emitting an event documenting the parameter change
  33 |  function setPriorityTxMaxGasLimit(uint256 _newPriorityTxMaxGasLimit) external;

     |  // @audit-issue Consider emitting an event documenting the parameter change
  37 |  function changeFeeParams(FeeParams calldata _newFeeParams) external;

     |  // @audit-issue Consider emitting an event documenting the parameter change
  40 |  function setTokenMultiplier(uint128 _nominator, uint128 _denominator) external;

     |  // @audit-issue Consider emitting an event documenting the parameter change
  43 |  function setValidiumMode(PubdataPricingMode _validiumMode) external;

     |  // @audit-issue Consider emitting an event documenting the parameter change
  45 |  function upgradeChainFromVersion(uint256 _protocolVersion, Diamond.DiamondCutData calldata _cutData) external;
```
GitHub: [17](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L17), [25](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L25), [29](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L29), [33](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L33), [37](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L37), [40](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L40), [43](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L43), [45](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L45)


```solidity
File: code/contracts/ethereum/contracts/state-transition/l2-deps/ISystemContext.sol

     |  // @audit-issue Consider emitting an event documenting the parameter change
   5 |  function setChainId(uint256 _newChainId) external;
```
GitHub: [5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/l2-deps/ISystemContext.sol#L5)


```solidity
File: code/system-contracts/contracts/ImmutableSimulator.sol

     |  // @audit-issue Consider emitting an event documenting the parameter change
  34 |  function setImmutables(address _dest, ImmutableData[] calldata _immutables) external override {
```
GitHub: [34](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ImmutableSimulator.sol#L34)


```solidity
File: code/system-contracts/contracts/SystemContext.sol

     |  // @audit-issue Consider emitting an event documenting the parameter change
  84 |  function setChainId(uint256 _newChainId) external onlyCallFromForceDeployer {

     |  // @audit-issue Consider emitting an event documenting the parameter change
  99 |  function setTxOrigin(address _newOrigin) external onlyCallFromBootloader {

     |  // @audit-issue Consider emitting an event documenting the parameter change
 105 |  function setGasPrice(uint256 _gasPrice) external onlyCallFromBootloader {

     |  // @audit-issue Consider emitting an event documenting the parameter change
 112 |  function setPubdataInfo(uint256 _gasPerPubdataByte, uint256 _basePubdataSpent) external onlyCallFromBootloader {

     |  // @audit-issue Consider emitting an event documenting the parameter change
 212 |  function _setL2BlockHash(uint256 _block, bytes32 _hash) internal {

     |  // @audit-issue Consider emitting an event documenting the parameter change
 241 |  function _upgradeL2Blocks(uint128 _l2BlockNumber, bytes32 _expectedPrevL2BlockHash, bool _isFirstInBatch) internal {

     |  // @audit-issue Consider emitting an event documenting the parameter change
 263 |  function _setVirtualBlock(
 264 |      uint128 _l2BlockNumber,
 265 |      uint128 _maxVirtualBlocksToCreate,
 266 |      uint128 _newTimestamp
 267 |  ) internal {

     |  // @audit-issue Consider emitting an event documenting the parameter change
 314 |  function _setNewL2BlockData(uint128 _l2BlockNumber, uint128 _l2BlockTimestamp, bytes32 _prevL2BlockHash) internal {

     |  // @audit-issue Consider emitting an event documenting the parameter change
 341 |  function setL2Block(
 342 |      uint128 _l2BlockNumber,
 343 |      uint128 _l2BlockTimestamp,
 344 |      bytes32 _expectedPrevL2BlockHash,
 345 |      bool _isFirstInBatch,
 346 |      uint128 _maxVirtualBlocksToCreate
 347 |  ) external onlyCallFromBootloader {

     |  // @audit-issue Consider emitting an event documenting the parameter change
 444 |  function setNewBatch(
 445 |      bytes32 _prevBatchHash,
 446 |      uint128 _newTimestamp,
 447 |      uint128 _expectedNewNumber,
 448 |      uint256 _baseFee
 449 |  ) external onlyCallFromBootloader {
```
GitHub: [84](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L84), [99](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L99), [105](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L105), [112](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L112), [212](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L212), [241](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L241), [263-267](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L263-L267), [314](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L314), [341-347](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L341-L347), [444-449](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L444-L449)


```solidity
File: code/system-contracts/contracts/libraries/SystemContractHelper.sol

     |  // @audit-issue Consider emitting an event documenting the parameter change
 168 |  function setValueForNextFarCall(uint128 _value) internal returns (bool success) {
```
GitHub: [168](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L168)


```solidity
File: code/system-contracts/contracts/interfaces/IContractDeployer.sol

     |  // @audit-issue Consider emitting an event documenting the parameter change
  87 |  function updateAccountVersion(AccountAbstractionVersion _version) external;

     |  // @audit-issue Consider emitting an event documenting the parameter change
  90 |  function updateNonceOrdering(AccountNonceOrdering _nonceOrdering) external;
```
GitHub: [87](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L87), [90](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L90)


```solidity
File: code/system-contracts/contracts/interfaces/IImmutableSimulator.sol

     |  // @audit-issue Consider emitting an event documenting the parameter change
  13 |  function setImmutables(address _dest, ImmutableData[] calldata _immutables) external;
```
GitHub: [13](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IImmutableSimulator.sol#L13)


```solidity
File: code/system-contracts/contracts/interfaces/INonceHolder.sol

     |  // @audit-issue Consider emitting an event documenting the parameter change
  27 |  function setValueUnderNonce(uint256 _key, uint256 _value) external;
```
GitHub: [27](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/INonceHolder.sol#L27)


## [N-82] Polymorphic functions make security audits more time-consuming and error-prone

The instances below point to two or more functions with the same name. Consider naming each function differently, in order to make code navigation and analysis easier.

*Instances: 2*

```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

     |  // @audit-info Contains polymorphic (overloaded) function definitions
  19 |  contract L1ERC20Bridge is IL1ERC20Bridge, ReentrancyGuard {
  :  |
     |      // @audit-issue Consider renaming or combining overloads to simplify
  98 |      function deposit(
  99 |          address _l2Receiver,
 100 |          address _l1Token,
 101 |          uint256 _amount,
 102 |          uint256 _l2TxGasLimit,
 103 |          uint256 _l2TxGasPerPubdataByte
 104 |      ) external payable returns (bytes32 l2TxHash) {
  :  |
     |      // @audit-issue Consider renaming or combining overloads to simplify
 133 |      function deposit(
 134 |          address _l2Receiver,
 135 |          address _l1Token,
 136 |          uint256 _amount,
 137 |          uint256 _l2TxGasLimit,
 138 |          uint256 _l2TxGasPerPubdataByte,
 139 |          address _refundRecipient
 140 |      ) public payable nonReentrant returns (bytes32 l2TxHash) {
```
GitHub: [98-104](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L98-L104), [133-140](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L133-L140)


## [N-83] Potential `block.timestamp` off-by-one error

In Solidity, using `>=` or `<=` to compare against `block.timestamp` (alias `now`) may introduce off-by-one errors due to the fact that `block.timestamp` is only updated once per block and its value remains constant throughout the block's execution. If an operation happens at the exact second when `block.timestamp` changes, it could result in unexpected behavior. To avoid this, it's safer to use strict inequality operators (`>` or `<`). For instance, if a condition should only be met after a certain time, use `block.timestamp > time` rather than `block.timestamp >= time`. This way, potential off-by-one errors due to the exact timing of block mining are mitigated, leading to safer, more predictable contract behavior.

*Instances: 6*

```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

     |  // @audit-issue Consider strict inequality (< or >)
 195 |  require(block.timestamp >= commitBatchTimestamp + delay, "5c"); // The delay is not passed

     |  // @audit-issue Consider strict inequality (< or >)
 217 |  require(block.timestamp >= commitBatchTimestamp + delay, "5c"); // The delay is not passed
```
GitHub: [195](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L195), [217](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L217)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

     |  // @audit-issue Consider strict inequality (< or >)
 122 |  require(block.timestamp - COMMIT_TIMESTAMP_NOT_OLDER <= batchTimestamp, "h1"); // New batch timestamp is too small

     |  // @audit-issue Consider strict inequality (< or >)
 123 |  require(lastL2BlockTimestamp <= block.timestamp + COMMIT_TIMESTAMP_APPROXIMATION_DELTA, "h2"); // The last L2 block timestamp is too big
```
GitHub: [122](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L122), [123](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L123)


```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol

     |  // @audit-issue Consider strict inequality (< or >)
  72 |  require(block.timestamp >= _proposedUpgrade.upgradeTimestamp, "Upgrade is not ready yet");
```
GitHub: [72](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L72)


```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol

     |  // @audit-issue Consider strict inequality (< or >)
  52 |  require(block.timestamp >= _proposedUpgrade.upgradeTimestamp, "Upgrade is not ready yet");
```
GitHub: [52](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L52)


## [N-84] Setters should prevent re-setting the same value

This especially problematic when the setter also emits the same value, which may be confusing to offline parsers.

*Instances: 38*

```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

     |  // @audit-info Context
  51 |  function setPendingAdmin(address _newPendingAdmin) external onlyOwnerOrAdmin {
  :  |
     |      // @audit-issue Check if `_newPendingAdmin` changes anything before assignment
  55 |      pendingAdmin = _newPendingAdmin;
```
GitHub: [55](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L55)


```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

     |  // @audit-info Context
 249 |  function updateDelay(uint256 _newDelay) external onlySelf {
  :  |
     |      // @audit-issue Check if `_newDelay` changes anything before assignment
 251 |      minDelay = _newDelay;

     |  // @audit-info Context
 256 |  function updateSecurityCouncil(address _newSecurityCouncil) external onlySelf {
  :  |
     |      // @audit-issue Check if `_newSecurityCouncil` changes anything before assignment
 258 |      securityCouncil = _newSecurityCouncil;
```
GitHub: [251](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L251), [258](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L258)


```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

     |  // @audit-info Context
 112 |  function setPendingAdmin(address _newPendingAdmin) external onlyOwnerOrAdmin {
  :  |
     |      // @audit-issue Check if `_newPendingAdmin` changes anything before assignment
 116 |      pendingAdmin = _newPendingAdmin;

     |  // @audit-info Context
 134 |  function setValidatorTimelock(address _validatorTimelock) external onlyOwnerOrAdmin {
     |      // @audit-issue Check if `_validatorTimelock` changes anything before assignment
 135 |      validatorTimelock = _validatorTimelock;

     |  // @audit-info Context
 144 |  function setNewVersionUpgrade(
 145 |      Diamond.DiamondCutData calldata _cutData,
 146 |      uint256 _oldProtocolVersion,
 147 |      uint256 _newProtocolVersion
 148 |  ) external onlyOwner {
  :  |
     |      // @audit-issue Check if `_newProtocolVersion` changes anything before assignment
 150 |      protocolVersion = _newProtocolVersion;
```
GitHub: [116](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L116), [135](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L135), [150](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L150)


```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

     |  // @audit-info Context
  73 |  function setStateTransitionManager(IStateTransitionManager _stateTransitionManager) external onlyOwner {
     |      // @audit-issue Check if `_stateTransitionManager` changes anything before assignment
  74 |      stateTransitionManager = _stateTransitionManager;

     |  // @audit-info Context
  96 |  function setExecutionDelay(uint32 _executionDelay) external onlyOwner {
     |      // @audit-issue Check if `_executionDelay` changes anything before assignment
  97 |      executionDelay = _executionDelay;
```
GitHub: [74](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L74), [97](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L97)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol

     |  // @audit-info Context
  23 |  function setPendingAdmin(address _newPendingAdmin) external onlyAdmin {
  :  |
     |      // @audit-issue Check if `_newPendingAdmin` changes anything before assignment
  27 |      s.pendingAdmin = _newPendingAdmin;

     |  // @audit-info Context
  45 |  function setValidator(address _validator, bool _active) external onlyStateTransitionManager {
     |      // @audit-issue Check if `_active` changes anything before assignment
  46 |      s.validators[_validator] = _active;

     |  // @audit-info Context
  51 |  function setPorterAvailability(bool _zkPorterIsAvailable) external onlyStateTransitionManager {
  :  |
     |      // @audit-issue Check if `_zkPorterIsAvailable` changes anything before assignment
  53 |      s.zkPorterIsAvailable = _zkPorterIsAvailable;

     |  // @audit-info Context
  58 |  function setPriorityTxMaxGasLimit(uint256 _newPriorityTxMaxGasLimit) external onlyStateTransitionManager {
  :  |
     |      // @audit-issue Check if `_newPriorityTxMaxGasLimit` changes anything before assignment
  62 |      s.priorityTxMaxGasLimit = _newPriorityTxMaxGasLimit;

     |  // @audit-info Context
  67 |  function changeFeeParams(FeeParams calldata _newFeeParams) external onlyAdminOrStateTransitionManager {
  :  |
     |      // @audit-issue Check if `_newFeeParams` changes anything before assignment
  73 |      s.feeParams = _newFeeParams;

     |  // @audit-info Context
  79 |  function setTokenMultiplier(uint128 _nominator, uint128 _denominator) external onlyAdminOrStateTransitionManager {
  :  |
     |      // @audit-issue Check if `_nominator` changes anything before assignment
  83 |      s.baseTokenGasPriceMultiplierNominator = _nominator;
     |      // @audit-issue Check if `_denominator` changes anything before assignment
  84 |      s.baseTokenGasPriceMultiplierDenominator = _denominator;

     |  // @audit-info Context
  89 |  function setValidiumMode(PubdataPricingMode _validiumMode) external onlyAdmin {
  :  |
     |      // @audit-issue Check if `_validiumMode` changes anything before assignment
  91 |      s.feeParams.pubdataPricingMode = _validiumMode;
```
GitHub: [27](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L27), [46](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L46), [53](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L53), [62](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L62), [73](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L73), [83](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L83), [84](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L84), [91](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L91)


```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol

     |  // @audit-info Context
  92 |  function _setL2DefaultAccountBytecodeHash(bytes32 _l2DefaultAccountBytecodeHash) private {
  :  |
     |      // @audit-issue Check if `_l2DefaultAccountBytecodeHash` changes anything before assignment
 103 |      s.l2DefaultAccountBytecodeHash = _l2DefaultAccountBytecodeHash;

     |  // @audit-info Context
 109 |  function _setL2BootloaderBytecodeHash(bytes32 _l2BootloaderBytecodeHash) private {
  :  |
     |      // @audit-issue Check if `_l2BootloaderBytecodeHash` changes anything before assignment
 120 |      s.l2BootloaderBytecodeHash = _l2BootloaderBytecodeHash;

     |  // @audit-info Context
 126 |  function _setVerifier(IVerifier _newVerifier) private {
  :  |
     |      // @audit-issue Check if `_newVerifier` changes anything before assignment
 136 |      s.verifier = _newVerifier;

     |  // @audit-info Context
 142 |  function _setVerifierParams(VerifierParams calldata _newVerifierParams) private {
  :  |
     |      // @audit-issue Check if `_newVerifierParams` changes anything before assignment
 156 |      s.verifierParams = _newVerifierParams;

     |  // @audit-info Context
 236 |  function _setNewProtocolVersion(uint256 _newProtocolVersion) internal virtual {
  :  |
     |      // @audit-issue Check if `_newProtocolVersion` changes anything before assignment
 255 |      s.protocolVersion = _newProtocolVersion;
```
GitHub: [103](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L103), [120](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L120), [136](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L136), [156](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L156), [255](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L255)


```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol

     |  // @audit-info Context
  20 |  function _setNewProtocolVersion(uint256 _newProtocolVersion) internal override {
  :  |
     |      // @audit-issue Check if `_newProtocolVersion` changes anything before assignment
  39 |      s.protocolVersion = _newProtocolVersion;
```
GitHub: [39](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L39)


```solidity
File: code/contracts/ethereum/contracts/upgrades/Upgrade_v1_4_1.sol

     |  // @audit-info Context
  20 |  function changeFeeParams(FeeParams memory _newFeeParams) private {
  :  |
     |      // @audit-issue Check if `_newFeeParams` changes anything before assignment
  26 |      s.feeParams = _newFeeParams;
```
GitHub: [26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/Upgrade_v1_4_1.sol#L26)


```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

     |  // @audit-info Context
  65 |  function updateAccountVersion(AccountAbstractionVersion _version) external onlySystemCall {
     |      // @audit-issue Check if `_version` changes anything before assignment
  66 |      accountInfo[msg.sender].supportedAAVersion = _version;

     |  // @audit-info Context
  74 |  function updateNonceOrdering(AccountNonceOrdering _nonceOrdering) external onlySystemCall {
  :  |
     |      // @audit-issue Check if `_nonceOrdering` changes anything before assignment
  83 |      currentInfo.nonceOrdering = _nonceOrdering;
```
GitHub: [66](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L66), [83](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L83)


```solidity
File: code/system-contracts/contracts/NonceHolder.sol

     |  // @audit-info Context
  82 |  function setValueUnderNonce(uint256 _key, uint256 _value) public onlySystemCall {
  :  |
     |      // @audit-issue Check if `_value` changes anything before assignment
  94 |      nonceValues[addressAsKey][_key] = _value;
```
GitHub: [94](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/NonceHolder.sol#L94)


```solidity
File: code/system-contracts/contracts/SystemContext.sol

     |  // @audit-info Context
  84 |  function setChainId(uint256 _newChainId) external onlyCallFromForceDeployer {
     |      // @audit-issue Check if `_newChainId` changes anything before assignment
  85 |      chainId = _newChainId;

     |  // @audit-info Context
  99 |  function setTxOrigin(address _newOrigin) external onlyCallFromBootloader {
     |      // @audit-issue Check if `_newOrigin` changes anything before assignment
 100 |      origin = _newOrigin;

     |  // @audit-info Context
 105 |  function setGasPrice(uint256 _gasPrice) external onlyCallFromBootloader {
     |      // @audit-issue Check if `_gasPrice` changes anything before assignment
 106 |      gasPrice = _gasPrice;

     |  // @audit-info Context
 112 |  function setPubdataInfo(uint256 _gasPerPubdataByte, uint256 _basePubdataSpent) external onlyCallFromBootloader {
     |      // @audit-issue Check if `_basePubdataSpent` changes anything before assignment
 113 |      basePubdataSpent = _basePubdataSpent;
     |      // @audit-issue Check if `_gasPerPubdataByte` changes anything before assignment
 114 |      gasPerPubdataByte = _gasPerPubdataByte;

     |  // @audit-info Context
 212 |  function _setL2BlockHash(uint256 _block, bytes32 _hash) internal {
     |      // @audit-issue Check if `_hash` changes anything before assignment
 213 |      l2BlockHash[_block % MINIBLOCK_HASHES_TO_STORE] = _hash;

     |  // @audit-info Context
 263 |  function _setVirtualBlock(
 264 |      uint128 _l2BlockNumber,
 265 |      uint128 _maxVirtualBlocksToCreate,
 266 |      uint128 _newTimestamp
 267 |  ) internal {
  :  |
     |      // @audit-issue Check if `_maxVirtualBlocksToCreate` changes anything before assignment
 295 |      virtualBlockInfo.number += _maxVirtualBlocksToCreate;
     |      // @audit-issue Check if `_newTimestamp` changes anything before assignment
 296 |      virtualBlockInfo.timestamp = _newTimestamp;
  :  |
     |          // @audit-issue Check if `_l2BlockNumber` changes anything before assignment
 303 |          virtualBlockUpgradeInfo.virtualBlockFinishL2Block = _l2BlockNumber;
     |          // @audit-issue Check if `_l2BlockNumber` changes anything before assignment
 304 |          virtualBlockInfo.number = _l2BlockNumber;

     |  // @audit-info Context
 444 |  function setNewBatch(
 445 |      bytes32 _prevBatchHash,
 446 |      uint128 _newTimestamp,
 447 |      uint128 _expectedNewNumber,
 448 |      uint256 _baseFee
 449 |  ) external onlyCallFromBootloader {
  :  |
     |      // @audit-issue Check if `_prevBatchHash` changes anything before assignment
 456 |      batchHashes[previousBatchNumber] = _prevBatchHash;
  :  |
     |      // @audit-issue Check if `_baseFee` changes anything before assignment
 463 |      baseFee = _baseFee;
```
GitHub: [85](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L85), [100](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L100), [106](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L106), [113](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L113), [114](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L114), [213](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L213), [295](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L295), [296](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L296), [303](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L303), [304](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L304), [456](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L456), [463](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L463)


## [N-85] State variables should include comments

Consider adding some comments on critical state variables to explain what they are supposed to do: this will help for future code reviews.

*Instances: 99*

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol

     |  // @audit-issue Consider adding comments explaining this state var
  12 |  ZkSyncStateTransitionStorage internal s;
```
GitHub: [12](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L12)


```solidity
File: code/contracts/ethereum/contracts/common/ReentrancyGuard.sol

     |  // @audit-issue Consider adding comments explaining this state var
  39 |  uint256 private constant _ENTERED = 2;
```
GitHub: [39](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/ReentrancyGuard.sol#L39)


```solidity
File: code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol

     |  // @audit-issue Consider adding comments explaining this state var
  22 |  uint160 constant offset = uint160(0x1111000000000000000000000000000000001111);
```
GitHub: [22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol#L22)


```solidity
File: code/contracts/ethereum/contracts/state-transition/Verifier.sol

     |  // @audit-issue Consider adding comments explaining this state var
  27 |  uint256 internal constant VK_GATE_SETUP_0_X_SLOT = 0x200 + 0x000;

     |  // @audit-issue Consider adding comments explaining this state var
  28 |  uint256 internal constant VK_GATE_SETUP_0_Y_SLOT = 0x200 + 0x020;

     |  // @audit-issue Consider adding comments explaining this state var
  29 |  uint256 internal constant VK_GATE_SETUP_1_X_SLOT = 0x200 + 0x040;

     |  // @audit-issue Consider adding comments explaining this state var
  30 |  uint256 internal constant VK_GATE_SETUP_1_Y_SLOT = 0x200 + 0x060;

     |  // @audit-issue Consider adding comments explaining this state var
  31 |  uint256 internal constant VK_GATE_SETUP_2_X_SLOT = 0x200 + 0x080;

     |  // @audit-issue Consider adding comments explaining this state var
  32 |  uint256 internal constant VK_GATE_SETUP_2_Y_SLOT = 0x200 + 0x0a0;

     |  // @audit-issue Consider adding comments explaining this state var
  33 |  uint256 internal constant VK_GATE_SETUP_3_X_SLOT = 0x200 + 0x0c0;

     |  // @audit-issue Consider adding comments explaining this state var
  34 |  uint256 internal constant VK_GATE_SETUP_3_Y_SLOT = 0x200 + 0x0e0;

     |  // @audit-issue Consider adding comments explaining this state var
  35 |  uint256 internal constant VK_GATE_SETUP_4_X_SLOT = 0x200 + 0x100;

     |  // @audit-issue Consider adding comments explaining this state var
  36 |  uint256 internal constant VK_GATE_SETUP_4_Y_SLOT = 0x200 + 0x120;

     |  // @audit-issue Consider adding comments explaining this state var
  37 |  uint256 internal constant VK_GATE_SETUP_5_X_SLOT = 0x200 + 0x140;

     |  // @audit-issue Consider adding comments explaining this state var
  38 |  uint256 internal constant VK_GATE_SETUP_5_Y_SLOT = 0x200 + 0x160;

     |  // @audit-issue Consider adding comments explaining this state var
  39 |  uint256 internal constant VK_GATE_SETUP_6_X_SLOT = 0x200 + 0x180;

     |  // @audit-issue Consider adding comments explaining this state var
  40 |  uint256 internal constant VK_GATE_SETUP_6_Y_SLOT = 0x200 + 0x1a0;

     |  // @audit-issue Consider adding comments explaining this state var
  41 |  uint256 internal constant VK_GATE_SETUP_7_X_SLOT = 0x200 + 0x1c0;

     |  // @audit-issue Consider adding comments explaining this state var
  42 |  uint256 internal constant VK_GATE_SETUP_7_Y_SLOT = 0x200 + 0x1e0;

     |  // @audit-issue Consider adding comments explaining this state var
  44 |  uint256 internal constant VK_GATE_SELECTORS_0_X_SLOT = 0x200 + 0x200;

     |  // @audit-issue Consider adding comments explaining this state var
  45 |  uint256 internal constant VK_GATE_SELECTORS_0_Y_SLOT = 0x200 + 0x220;

     |  // @audit-issue Consider adding comments explaining this state var
  46 |  uint256 internal constant VK_GATE_SELECTORS_1_X_SLOT = 0x200 + 0x240;

     |  // @audit-issue Consider adding comments explaining this state var
  47 |  uint256 internal constant VK_GATE_SELECTORS_1_Y_SLOT = 0x200 + 0x260;

     |  // @audit-issue Consider adding comments explaining this state var
  49 |  uint256 internal constant VK_PERMUTATION_0_X_SLOT = 0x200 + 0x280;

     |  // @audit-issue Consider adding comments explaining this state var
  50 |  uint256 internal constant VK_PERMUTATION_0_Y_SLOT = 0x200 + 0x2a0;

     |  // @audit-issue Consider adding comments explaining this state var
  51 |  uint256 internal constant VK_PERMUTATION_1_X_SLOT = 0x200 + 0x2c0;

     |  // @audit-issue Consider adding comments explaining this state var
  52 |  uint256 internal constant VK_PERMUTATION_1_Y_SLOT = 0x200 + 0x2e0;

     |  // @audit-issue Consider adding comments explaining this state var
  53 |  uint256 internal constant VK_PERMUTATION_2_X_SLOT = 0x200 + 0x300;

     |  // @audit-issue Consider adding comments explaining this state var
  54 |  uint256 internal constant VK_PERMUTATION_2_Y_SLOT = 0x200 + 0x320;

     |  // @audit-issue Consider adding comments explaining this state var
  55 |  uint256 internal constant VK_PERMUTATION_3_X_SLOT = 0x200 + 0x340;

     |  // @audit-issue Consider adding comments explaining this state var
  56 |  uint256 internal constant VK_PERMUTATION_3_Y_SLOT = 0x200 + 0x360;

     |  // @audit-issue Consider adding comments explaining this state var
  58 |  uint256 internal constant VK_LOOKUP_SELECTOR_X_SLOT = 0x200 + 0x380;

     |  // @audit-issue Consider adding comments explaining this state var
  59 |  uint256 internal constant VK_LOOKUP_SELECTOR_Y_SLOT = 0x200 + 0x3a0;

     |  // @audit-issue Consider adding comments explaining this state var
  61 |  uint256 internal constant VK_LOOKUP_TABLE_0_X_SLOT = 0x200 + 0x3c0;

     |  // @audit-issue Consider adding comments explaining this state var
  62 |  uint256 internal constant VK_LOOKUP_TABLE_0_Y_SLOT = 0x200 + 0x3e0;

     |  // @audit-issue Consider adding comments explaining this state var
  63 |  uint256 internal constant VK_LOOKUP_TABLE_1_X_SLOT = 0x200 + 0x400;

     |  // @audit-issue Consider adding comments explaining this state var
  64 |  uint256 internal constant VK_LOOKUP_TABLE_1_Y_SLOT = 0x200 + 0x420;

     |  // @audit-issue Consider adding comments explaining this state var
  65 |  uint256 internal constant VK_LOOKUP_TABLE_2_X_SLOT = 0x200 + 0x440;

     |  // @audit-issue Consider adding comments explaining this state var
  66 |  uint256 internal constant VK_LOOKUP_TABLE_2_Y_SLOT = 0x200 + 0x460;

     |  // @audit-issue Consider adding comments explaining this state var
  67 |  uint256 internal constant VK_LOOKUP_TABLE_3_X_SLOT = 0x200 + 0x480;

     |  // @audit-issue Consider adding comments explaining this state var
  68 |  uint256 internal constant VK_LOOKUP_TABLE_3_Y_SLOT = 0x200 + 0x4a0;

     |  // @audit-issue Consider adding comments explaining this state var
  70 |  uint256 internal constant VK_LOOKUP_TABLE_TYPE_X_SLOT = 0x200 + 0x4c0;

     |  // @audit-issue Consider adding comments explaining this state var
  71 |  uint256 internal constant VK_LOOKUP_TABLE_TYPE_Y_SLOT = 0x200 + 0x4e0;

     |  // @audit-issue Consider adding comments explaining this state var
  73 |  uint256 internal constant VK_RECURSIVE_FLAG_SLOT = 0x200 + 0x500;

     |  // @audit-issue Consider adding comments explaining this state var
  79 |  uint256 internal constant PROOF_PUBLIC_INPUT = 0x200 + 0x520 + 0x000;

     |  // @audit-issue Consider adding comments explaining this state var
  81 |  uint256 internal constant PROOF_STATE_POLYS_0_X_SLOT = 0x200 + 0x520 + 0x020;

     |  // @audit-issue Consider adding comments explaining this state var
  82 |  uint256 internal constant PROOF_STATE_POLYS_0_Y_SLOT = 0x200 + 0x520 + 0x040;

     |  // @audit-issue Consider adding comments explaining this state var
  83 |  uint256 internal constant PROOF_STATE_POLYS_1_X_SLOT = 0x200 + 0x520 + 0x060;

     |  // @audit-issue Consider adding comments explaining this state var
  84 |  uint256 internal constant PROOF_STATE_POLYS_1_Y_SLOT = 0x200 + 0x520 + 0x080;

     |  // @audit-issue Consider adding comments explaining this state var
  85 |  uint256 internal constant PROOF_STATE_POLYS_2_X_SLOT = 0x200 + 0x520 + 0x0a0;

     |  // @audit-issue Consider adding comments explaining this state var
  86 |  uint256 internal constant PROOF_STATE_POLYS_2_Y_SLOT = 0x200 + 0x520 + 0x0c0;

     |  // @audit-issue Consider adding comments explaining this state var
  87 |  uint256 internal constant PROOF_STATE_POLYS_3_X_SLOT = 0x200 + 0x520 + 0x0e0;

     |  // @audit-issue Consider adding comments explaining this state var
  88 |  uint256 internal constant PROOF_STATE_POLYS_3_Y_SLOT = 0x200 + 0x520 + 0x100;

     |  // @audit-issue Consider adding comments explaining this state var
  90 |  uint256 internal constant PROOF_COPY_PERMUTATION_GRAND_PRODUCT_X_SLOT = 0x200 + 0x520 + 0x120;

     |  // @audit-issue Consider adding comments explaining this state var
  91 |  uint256 internal constant PROOF_COPY_PERMUTATION_GRAND_PRODUCT_Y_SLOT = 0x200 + 0x520 + 0x140;

     |  // @audit-issue Consider adding comments explaining this state var
  93 |  uint256 internal constant PROOF_LOOKUP_S_POLY_X_SLOT = 0x200 + 0x520 + 0x160;

     |  // @audit-issue Consider adding comments explaining this state var
  94 |  uint256 internal constant PROOF_LOOKUP_S_POLY_Y_SLOT = 0x200 + 0x520 + 0x180;

     |  // @audit-issue Consider adding comments explaining this state var
  96 |  uint256 internal constant PROOF_LOOKUP_GRAND_PRODUCT_X_SLOT = 0x200 + 0x520 + 0x1a0;

     |  // @audit-issue Consider adding comments explaining this state var
  97 |  uint256 internal constant PROOF_LOOKUP_GRAND_PRODUCT_Y_SLOT = 0x200 + 0x520 + 0x1c0;

     |  // @audit-issue Consider adding comments explaining this state var
  99 |  uint256 internal constant PROOF_QUOTIENT_POLY_PARTS_0_X_SLOT = 0x200 + 0x520 + 0x1e0;

     |  // @audit-issue Consider adding comments explaining this state var
 100 |  uint256 internal constant PROOF_QUOTIENT_POLY_PARTS_0_Y_SLOT = 0x200 + 0x520 + 0x200;

     |  // @audit-issue Consider adding comments explaining this state var
 101 |  uint256 internal constant PROOF_QUOTIENT_POLY_PARTS_1_X_SLOT = 0x200 + 0x520 + 0x220;

     |  // @audit-issue Consider adding comments explaining this state var
 102 |  uint256 internal constant PROOF_QUOTIENT_POLY_PARTS_1_Y_SLOT = 0x200 + 0x520 + 0x240;

     |  // @audit-issue Consider adding comments explaining this state var
 103 |  uint256 internal constant PROOF_QUOTIENT_POLY_PARTS_2_X_SLOT = 0x200 + 0x520 + 0x260;

     |  // @audit-issue Consider adding comments explaining this state var
 104 |  uint256 internal constant PROOF_QUOTIENT_POLY_PARTS_2_Y_SLOT = 0x200 + 0x520 + 0x280;

     |  // @audit-issue Consider adding comments explaining this state var
 105 |  uint256 internal constant PROOF_QUOTIENT_POLY_PARTS_3_X_SLOT = 0x200 + 0x520 + 0x2a0;

     |  // @audit-issue Consider adding comments explaining this state var
 106 |  uint256 internal constant PROOF_QUOTIENT_POLY_PARTS_3_Y_SLOT = 0x200 + 0x520 + 0x2c0;

     |  // @audit-issue Consider adding comments explaining this state var
 108 |  uint256 internal constant PROOF_STATE_POLYS_0_OPENING_AT_Z_SLOT = 0x200 + 0x520 + 0x2e0;

     |  // @audit-issue Consider adding comments explaining this state var
 109 |  uint256 internal constant PROOF_STATE_POLYS_1_OPENING_AT_Z_SLOT = 0x200 + 0x520 + 0x300;

     |  // @audit-issue Consider adding comments explaining this state var
 110 |  uint256 internal constant PROOF_STATE_POLYS_2_OPENING_AT_Z_SLOT = 0x200 + 0x520 + 0x320;

     |  // @audit-issue Consider adding comments explaining this state var
 111 |  uint256 internal constant PROOF_STATE_POLYS_3_OPENING_AT_Z_SLOT = 0x200 + 0x520 + 0x340;

     |  // @audit-issue Consider adding comments explaining this state var
 113 |  uint256 internal constant PROOF_STATE_POLYS_3_OPENING_AT_Z_OMEGA_SLOT = 0x200 + 0x520 + 0x360;

     |  // @audit-issue Consider adding comments explaining this state var
 114 |  uint256 internal constant PROOF_GATE_SELECTORS_0_OPENING_AT_Z_SLOT = 0x200 + 0x520 + 0x380;

     |  // @audit-issue Consider adding comments explaining this state var
 116 |  uint256 internal constant PROOF_COPY_PERMUTATION_POLYS_0_OPENING_AT_Z_SLOT = 0x200 + 0x520 + 0x3a0;

     |  // @audit-issue Consider adding comments explaining this state var
 117 |  uint256 internal constant PROOF_COPY_PERMUTATION_POLYS_1_OPENING_AT_Z_SLOT = 0x200 + 0x520 + 0x3c0;

     |  // @audit-issue Consider adding comments explaining this state var
 118 |  uint256 internal constant PROOF_COPY_PERMUTATION_POLYS_2_OPENING_AT_Z_SLOT = 0x200 + 0x520 + 0x3e0;

     |  // @audit-issue Consider adding comments explaining this state var
 120 |  uint256 internal constant PROOF_COPY_PERMUTATION_GRAND_PRODUCT_OPENING_AT_Z_OMEGA_SLOT = 0x200 + 0x520 + 0x400;

     |  // @audit-issue Consider adding comments explaining this state var
 121 |  uint256 internal constant PROOF_LOOKUP_S_POLY_OPENING_AT_Z_OMEGA_SLOT = 0x200 + 0x520 + 0x420;

     |  // @audit-issue Consider adding comments explaining this state var
 122 |  uint256 internal constant PROOF_LOOKUP_GRAND_PRODUCT_OPENING_AT_Z_OMEGA_SLOT = 0x200 + 0x520 + 0x440;

     |  // @audit-issue Consider adding comments explaining this state var
 123 |  uint256 internal constant PROOF_LOOKUP_T_POLY_OPENING_AT_Z_SLOT = 0x200 + 0x520 + 0x460;

     |  // @audit-issue Consider adding comments explaining this state var
 124 |  uint256 internal constant PROOF_LOOKUP_T_POLY_OPENING_AT_Z_OMEGA_SLOT = 0x200 + 0x520 + 0x480;

     |  // @audit-issue Consider adding comments explaining this state var
 125 |  uint256 internal constant PROOF_LOOKUP_SELECTOR_POLY_OPENING_AT_Z_SLOT = 0x200 + 0x520 + 0x4a0;

     |  // @audit-issue Consider adding comments explaining this state var
 126 |  uint256 internal constant PROOF_LOOKUP_TABLE_TYPE_POLY_OPENING_AT_Z_SLOT = 0x200 + 0x520 + 0x4c0;

     |  // @audit-issue Consider adding comments explaining this state var
 127 |  uint256 internal constant PROOF_QUOTIENT_POLY_OPENING_AT_Z_SLOT = 0x200 + 0x520 + 0x4e0;

     |  // @audit-issue Consider adding comments explaining this state var
 128 |  uint256 internal constant PROOF_LINEARISATION_POLY_OPENING_AT_Z_SLOT = 0x200 + 0x520 + 0x500;

     |  // @audit-issue Consider adding comments explaining this state var
 130 |  uint256 internal constant PROOF_OPENING_PROOF_AT_Z_X_SLOT = 0x200 + 0x520 + 0x520;

     |  // @audit-issue Consider adding comments explaining this state var
 131 |  uint256 internal constant PROOF_OPENING_PROOF_AT_Z_Y_SLOT = 0x200 + 0x520 + 0x540;

     |  // @audit-issue Consider adding comments explaining this state var
 132 |  uint256 internal constant PROOF_OPENING_PROOF_AT_Z_OMEGA_X_SLOT = 0x200 + 0x520 + 0x560;

     |  // @audit-issue Consider adding comments explaining this state var
 133 |  uint256 internal constant PROOF_OPENING_PROOF_AT_Z_OMEGA_Y_SLOT = 0x200 + 0x520 + 0x580;

     |  // @audit-issue Consider adding comments explaining this state var
 135 |  uint256 internal constant PROOF_RECURSIVE_PART_P1_X_SLOT = 0x200 + 0x520 + 0x5a0;

     |  // @audit-issue Consider adding comments explaining this state var
 136 |  uint256 internal constant PROOF_RECURSIVE_PART_P1_Y_SLOT = 0x200 + 0x520 + 0x5c0;

     |  // @audit-issue Consider adding comments explaining this state var
 138 |  uint256 internal constant PROOF_RECURSIVE_PART_P2_X_SLOT = 0x200 + 0x520 + 0x5e0;

     |  // @audit-issue Consider adding comments explaining this state var
 139 |  uint256 internal constant PROOF_RECURSIVE_PART_P2_Y_SLOT = 0x200 + 0x520 + 0x600;

     |  // @audit-issue Consider adding comments explaining this state var
 145 |  uint256 internal constant TRANSCRIPT_BEGIN_SLOT = 0x200 + 0x520 + 0x620 + 0x00;

     |  // @audit-issue Consider adding comments explaining this state var
 146 |  uint256 internal constant TRANSCRIPT_DST_BYTE_SLOT = 0x200 + 0x520 + 0x620 + 0x03;

     |  // @audit-issue Consider adding comments explaining this state var
 147 |  uint256 internal constant TRANSCRIPT_STATE_0_SLOT = 0x200 + 0x520 + 0x620 + 0x04;

     |  // @audit-issue Consider adding comments explaining this state var
 148 |  uint256 internal constant TRANSCRIPT_STATE_1_SLOT = 0x200 + 0x520 + 0x620 + 0x24;

     |  // @audit-issue Consider adding comments explaining this state var
 149 |  uint256 internal constant TRANSCRIPT_CHALLENGE_SLOT = 0x200 + 0x520 + 0x620 + 0x44;

     |  // @audit-issue Consider adding comments explaining this state var
 155 |  uint256 internal constant STATE_ALPHA_SLOT = 0x200 + 0x520 + 0x620 + 0x80 + 0x000;
```
GitHub: [27](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L27), [28](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L28), [29](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L29), [30](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L30), [31](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L31), [32](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L32), [33](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L33), [34](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L34), [35](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L35), [36](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L36), [37](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L37), [38](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L38), [39](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L39), [40](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L40), [41](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L41), [42](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L42), [44](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L44), [45](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L45), [46](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L46), [47](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L47), [49](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L49), [50](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L50), [51](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L51), [52](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L52), [53](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L53), [54](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L54), [55](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L55), [56](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L56), [58](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L58), [59](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L59), [61](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L61), [62](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L62), [63](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L63), [64](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L64), [65](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L65), [66](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L66), [67](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L67), [68](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L68), [70](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L70), [71](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L71), [73](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L73), [79](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L79), [81](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L81), [82](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L82), [83](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L83), [84](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L84), [85](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L85), [86](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L86), [87](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L87), [88](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L88), [90](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L90), [91](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L91), [93](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L93), [94](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L94), [96](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L96), [97](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L97), [99](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L99), [100](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L100), [101](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L101), [102](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L102), [103](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L103), [104](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L104), [105](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L105), [106](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L106), [108](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L108), [109](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L109), [110](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L110), [111](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L111), [113](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L113), [114](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L114), [116](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L116), [117](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L117), [118](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L118), [120](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L120), [121](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L121), [122](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L122), [123](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L123), [124](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L124), [125](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L125), [126](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L126), [127](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L127), [128](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L128), [130](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L130), [131](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L131), [132](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L132), [133](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L133), [135](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L135), [136](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L136), [138](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L138), [139](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L139), [145](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L145), [146](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L146), [147](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L147), [148](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L148), [149](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L149), [155](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L155)


## [N-86] Style guide: Contract names should use CamelCase style

According to the Solidity [style guide](https://docs.soliditylang.org/en/latest/style-guide.html#contract-and-library-names) contract and library names should be in `CapWords style` (CamelCase)

*Instances: 2*

```solidity
File: code/contracts/ethereum/contracts/upgrades/Upgrade_4844.sol

     |  // @audit-issue Use CapWords style for naming contracts/libraries
  12 |  contract Upgrade_4844 is BaseZkSyncUpgrade {
```
GitHub: [12](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/Upgrade_4844.sol#L12)


```solidity
File: code/contracts/ethereum/contracts/upgrades/Upgrade_v1_4_1.sol

     |  // @audit-issue Use CapWords style for naming contracts/libraries
  13 |  contract Upgrade_v1_4_1 is BaseZkSyncUpgrade {
```
GitHub: [13](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/Upgrade_v1_4_1.sol#L13)


## [N-87] Style guide: Non-`external`/`public` function names should begin with an underscore

According to the Solidity Style Guide, Non-`external`/`public` variable and function names should begin with an [underscore](https://docs.soliditylang.org/en/latest/style-guide.html#underscore-prefix-for-non-external-functions-and-variables).

*Instances: 99*

```solidity
File: code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol

     |  // @audit-issue Prefix function name with an `_` (underscore)
  21 |  function hashL2Bytecode(bytes memory _bytecode) internal pure returns (bytes32 hashedBytecode) {

     |  // @audit-issue Prefix function name with an `_` (underscore)
  39 |  function validateBytecodeHash(bytes32 _bytecodeHash) internal pure {

     |  // @audit-issue Prefix function name with an `_` (underscore)
  49 |  function bytecodeLen(bytes32 _bytecodeHash) internal pure returns (uint256 codeLengthInWords) {

     |  // @audit-issue Prefix function name with an `_` (underscore)
  60 |  function computeCreate2Address(
  61 |      address _sender,
  62 |      bytes32 _salt,
  63 |      bytes32 _bytecodeHash,
  64 |      bytes32 _constructorInputHash
  65 |  ) internal pure returns (address) {
```
GitHub: [21](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L21), [39](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L39), [49](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L49), [60-65](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L60-L65)


```solidity
File: code/contracts/ethereum/contracts/common/libraries/UncheckedMath.sol

     |  // @audit-issue Prefix function name with an `_` (underscore)
  11 |  function uncheckedInc(uint256 _number) internal pure returns (uint256) {

     |  // @audit-issue Prefix function name with an `_` (underscore)
  17 |  function uncheckedAdd(uint256 _lhs, uint256 _rhs) internal pure returns (uint256) {
```
GitHub: [11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/UncheckedMath.sol#L11), [17](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/UncheckedMath.sol#L17)


```solidity
File: code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol

     |  // @audit-issue Prefix function name with an `_` (underscore)
  19 |  function readUint32(bytes memory _bytes, uint256 _start) internal pure returns (uint32 result, uint256 offset) {

     |  // @audit-issue Prefix function name with an `_` (underscore)
  26 |  function readAddress(bytes memory _bytes, uint256 _start) internal pure returns (address result, uint256 offset) {

     |  // @audit-issue Prefix function name with an `_` (underscore)
  33 |  function readUint256(bytes memory _bytes, uint256 _start) internal pure returns (uint256 result, uint256 offset) {

     |  // @audit-issue Prefix function name with an `_` (underscore)
  40 |  function readBytes32(bytes memory _bytes, uint256 _start) internal pure returns (bytes32 result, uint256 offset) {
```
GitHub: [19](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol#L19), [26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol#L26), [33](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol#L33), [40](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol#L40)


```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol

     |  // @audit-issue Prefix function name with an `_` (underscore)
  87 |  function getDiamondStorage() internal pure returns (DiamondStorage storage diamondStorage) {

     |  // @audit-issue Prefix function name with an `_` (underscore)
  96 |  function diamondCut(DiamondCutData memory _diamondCut) internal {
```
GitHub: [87](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L87), [96](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L96)


```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/LibMap.sol

     |  // @audit-issue Prefix function name with an `_` (underscore)
  18 |  function get(Uint32Map storage _map, uint256 _index) internal view returns (uint32 result) {

     |  // @audit-issue Prefix function name with an `_` (underscore)
  38 |  function set(Uint32Map storage _map, uint256 _index, uint32 _value) internal {
```
GitHub: [18](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/LibMap.sol#L18), [38](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/LibMap.sol#L38)


```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol

     |  // @audit-issue Prefix function name with an `_` (underscore)
  18 |  function calculateRoot(
  19 |      bytes32[] calldata _path,
  20 |      uint256 _index,
  21 |      bytes32 _itemHash
  22 |  ) internal pure returns (bytes32) {
```
GitHub: [18-22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol#L18-L22)


```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol

     |  // @audit-issue Prefix function name with an `_` (underscore)
  35 |  function getFirstUnprocessedPriorityTx(Queue storage _queue) internal view returns (uint256) {

     |  // @audit-issue Prefix function name with an `_` (underscore)
  40 |  function getTotalPriorityTxs(Queue storage _queue) internal view returns (uint256) {

     |  // @audit-issue Prefix function name with an `_` (underscore)
  45 |  function getSize(Queue storage _queue) internal view returns (uint256) {

     |  // @audit-issue Prefix function name with an `_` (underscore)
  50 |  function isEmpty(Queue storage _queue) internal view returns (bool) {

     |  // @audit-issue Prefix function name with an `_` (underscore)
  55 |  function pushBack(Queue storage _queue, PriorityOperation memory _operation) internal {

     |  // @audit-issue Prefix function name with an `_` (underscore)
  64 |  function front(Queue storage _queue) internal view returns (PriorityOperation memory) {

     |  // @audit-issue Prefix function name with an `_` (underscore)
  72 |  function popFront(Queue storage _queue) internal returns (PriorityOperation memory priorityOperation) {
```
GitHub: [35](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L35), [40](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L40), [45](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L45), [50](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L50), [55](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L55), [64](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L64), [72](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L72)


```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol

     |  // @audit-issue Prefix function name with an `_` (underscore)
  19 |  function validateL1ToL2Transaction(
  20 |      L2CanonicalTransaction memory _transaction,
  21 |      bytes memory _encoded,
  22 |      uint256 _priorityTxMaxGasLimit,
  23 |      uint256 _priorityTxMaxPubdata
  24 |  ) internal pure {

     |  // @audit-issue Prefix function name with an `_` (underscore)
  46 |  function validateUpgradeTransaction(L2CanonicalTransaction memory _transaction) internal pure {

     |  // @audit-issue Prefix function name with an `_` (underscore)
  69 |  function getMinimalPriorityTransactionGasLimit(
  70 |      uint256 _encodingLength,
  71 |      uint256 _numberOfFactoryDependencies,
  72 |      uint256 _l2GasPricePerPubdata
  73 |  ) internal pure returns (uint256) {

     |  // @audit-issue Prefix function name with an `_` (underscore)
 109 |  function getTransactionBodyGasLimit(
 110 |      uint256 _totalGasLimit,
 111 |      uint256 _encodingLength
 112 |  ) internal pure returns (uint256 txBodyGasLimit) {

     |  // @audit-issue Prefix function name with an `_` (underscore)
 128 |  function getOverheadForTransaction(
 129 |      uint256 _encodingLength
 130 |  ) internal pure returns (uint256 batchOverheadForTransaction) {
```
GitHub: [19-24](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L19-L24), [46](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L46), [69-73](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L69-L73), [109-112](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L109-L112), [128-130](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L128-L130)


```solidity
File: code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol

     |  // @audit-issue Prefix function name with an `_` (underscore)
  28 |  function applyL1ToL2Alias(address l1Address) internal pure returns (address l2Address) {

     |  // @audit-issue Prefix function name with an `_` (underscore)
  38 |  function undoL1ToL2Alias(address l2Address) internal pure returns (address l1Address) {
```
GitHub: [28](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol#L28), [38](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol#L38)


```solidity
File: code/contracts/ethereum/contracts/upgrades/Upgrade_v1_4_1.sol

     |  // @audit-issue Prefix function name with an `_` (underscore)
  20 |  function changeFeeParams(FeeParams memory _newFeeParams) private {
```
GitHub: [20](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/Upgrade_v1_4_1.sol#L20)


```solidity
File: code/system-contracts/contracts/BootloaderUtilities.sol

     |  // @audit-issue Prefix function name with an `_` (underscore)
  44 |  function encodeLegacyTransactionHash(Transaction calldata _transaction) internal view returns (bytes32 txHash) {

     |  // @audit-issue Prefix function name with an `_` (underscore)
 139 |  function encodeEIP2930TransactionHash(Transaction calldata _transaction) internal view returns (bytes32) {

     |  // @audit-issue Prefix function name with an `_` (underscore)
 229 |  function encodeEIP1559TransactionHash(Transaction calldata _transaction) internal view returns (bytes32) {
```
GitHub: [44](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L44), [139](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L139), [229](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L229)


```solidity
File: code/system-contracts/contracts/L1Messenger.sol

     |  // @audit-issue Prefix function name with an `_` (underscore)
  50 |  function keccakGasCost(uint256 _length) internal pure returns (uint256) {

     |  // @audit-issue Prefix function name with an `_` (underscore)
  61 |  function sha256GasCost(uint256 _length) internal pure returns (uint256) {
```
GitHub: [50](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L50), [61](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L61)


```solidity
File: code/system-contracts/contracts/libraries/EfficientCall.sol

     |  // @audit-issue Prefix function name with an `_` (underscore)
  36 |  function keccak(bytes calldata _data) internal view returns (bytes32) {

     |  // @audit-issue Prefix function name with an `_` (underscore)
  45 |  function sha(bytes calldata _data) internal view returns (bytes32) {

     |  // @audit-issue Prefix function name with an `_` (underscore)
  58 |  function call(
  59 |      uint256 _gas,
  60 |      address _address,
  61 |      uint256 _value,
  62 |      bytes calldata _data,
  63 |      bool _isSystem
  64 |  ) internal returns (bytes memory returnData) {

     |  // @audit-issue Prefix function name with an `_` (underscore)
  74 |  function staticCall(
  75 |      uint256 _gas,
  76 |      address _address,
  77 |      bytes calldata _data
  78 |  ) internal view returns (bytes memory returnData) {

     |  // @audit-issue Prefix function name with an `_` (underscore)
  88 |  function delegateCall(
  89 |      uint256 _gas,
  90 |      address _address,
  91 |      bytes calldata _data
  92 |  ) internal returns (bytes memory returnData) {

     |  // @audit-issue Prefix function name with an `_` (underscore)
 105 |  function mimicCall(
 106 |      uint256 _gas,
 107 |      address _address,
 108 |      bytes calldata _data,
 109 |      address _whoToMimic,
 110 |      bool _isConstructor,
 111 |      bool _isSystem
 112 |  ) internal returns (bytes memory returnData) {

     |  // @audit-issue Prefix function name with an `_` (underscore)
 124 |  function rawCall(
 125 |      uint256 _gas,
 126 |      address _address,
 127 |      uint256 _value,
 128 |      bytes calldata _data,
 129 |      bool _isSystem
 130 |  ) internal returns (bool success) {

     |  // @audit-issue Prefix function name with an `_` (underscore)
 159 |  function rawStaticCall(uint256 _gas, address _address, bytes calldata _data) internal view returns (bool success) {

     |  // @audit-issue Prefix function name with an `_` (underscore)
 173 |  function rawDelegateCall(uint256 _gas, address _address, bytes calldata _data) internal returns (bool success) {

     |  // @audit-issue Prefix function name with an `_` (underscore)
 191 |  function rawMimicCall(
 192 |      uint256 _gas,
 193 |      address _address,
 194 |      bytes calldata _data,
 195 |      address _whoToMimic,
 196 |      bool _isConstructor,
 197 |      bool _isSystem
 198 |  ) internal returns (bool success) {

     |  // @audit-issue Prefix function name with an `_` (underscore)
 232 |  function propagateRevert() internal pure {
```
GitHub: [36](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L36), [45](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L45), [58-64](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L58-L64), [74-78](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L74-L78), [88-92](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L88-L92), [105-112](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L105-L112), [124-130](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L124-L130), [159](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L159), [173](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L173), [191-198](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L191-L198), [232](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L232)


```solidity
File: code/system-contracts/contracts/libraries/RLPEncoder.sol

     |  // @audit-issue Prefix function name with an `_` (underscore)
  11 |  function encodeAddress(address _val) internal pure returns (bytes memory encoded) {

     |  // @audit-issue Prefix function name with an `_` (underscore)
  24 |  function encodeUint256(uint256 _val) internal pure returns (bytes memory encoded) {

     |  // @audit-issue Prefix function name with an `_` (underscore)
  49 |  function encodeNonSingleBytesLen(uint64 _len) internal pure returns (bytes memory) {

     |  // @audit-issue Prefix function name with an `_` (underscore)
  56 |  function encodeListLen(uint64 _len) internal pure returns (bytes memory) {
```
GitHub: [11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/RLPEncoder.sol#L11), [24](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/RLPEncoder.sol#L24), [49](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/RLPEncoder.sol#L49), [56](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/RLPEncoder.sol#L56)


```solidity
File: code/system-contracts/contracts/libraries/SystemContractHelper.sol

     |  // @audit-issue Prefix function name with an `_` (underscore)
  48 |  function toL1(bool _isService, bytes32 _key, bytes32 _value) internal {

     |  // @audit-issue Prefix function name with an `_` (underscore)
  63 |  function getCodeAddress() internal view returns (address addr) {

     |  // @audit-issue Prefix function name with an `_` (underscore)
  74 |  function loadCalldataIntoActivePtr() internal view {

     |  // @audit-issue Prefix function name with an `_` (underscore)
  85 |  function ptrPackIntoActivePtr(uint256 _farCallAbi) internal view {

     |  // @audit-issue Prefix function name with an `_` (underscore)
  94 |  function ptrAddIntoActive(uint32 _value) internal view {

     |  // @audit-issue Prefix function name with an `_` (underscore)
 106 |  function ptrShrinkIntoActive(uint32 _shrink) internal view {

     |  // @audit-issue Prefix function name with an `_` (underscore)
 124 |  function packPrecompileParams(
 125 |      uint32 _inputMemoryOffset,
 126 |      uint32 _inputMemoryLength,
 127 |      uint32 _outputMemoryOffset,
 128 |      uint32 _outputMemoryLength,
 129 |      uint64 _perPrecompileInterpreted
 130 |  ) internal pure returns (uint256 rawParams) {

     |  // @audit-issue Prefix function name with an `_` (underscore)
 148 |  function unsafePrecompileCall(
 149 |      uint256 _rawParams,
 150 |      uint32 _gasToBurn,
 151 |      uint32 _pubdataToSpend
 152 |  ) internal view returns (bool success) {

     |  // @audit-issue Prefix function name with an `_` (underscore)
 168 |  function setValueForNextFarCall(uint128 _value) internal returns (bool success) {

     |  // @audit-issue Prefix function name with an `_` (underscore)
 181 |  function eventInitialize(uint256 initializer, uint256 value1) internal {

     |  // @audit-issue Prefix function name with an `_` (underscore)
 191 |  function eventWrite(uint256 value1, uint256 value2) internal {

     |  // @audit-issue Prefix function name with an `_` (underscore)
 203 |  function getZkSyncMetaBytes() internal view returns (uint256 meta) {

     |  // @audit-issue Prefix function name with an `_` (underscore)
 215 |  function extractNumberFromMeta(uint256 meta, uint256 offset, uint256 size) internal pure returns (uint256 result) {

     |  // @audit-issue Prefix function name with an `_` (underscore)
 227 |  function getPubdataPublishedFromMeta(uint256 meta) internal pure returns (uint32 pubdataPublished) {

     |  // @audit-issue Prefix function name with an `_` (underscore)
 237 |  function getHeapSizeFromMeta(uint256 meta) internal pure returns (uint32 heapSize) {

     |  // @audit-issue Prefix function name with an `_` (underscore)
 246 |  function getAuxHeapSizeFromMeta(uint256 meta) internal pure returns (uint32 auxHeapSize) {

     |  // @audit-issue Prefix function name with an `_` (underscore)
 254 |  function getShardIdFromMeta(uint256 meta) internal pure returns (uint8 shardId) {

     |  // @audit-issue Prefix function name with an `_` (underscore)
 263 |  function getCallerShardIdFromMeta(uint256 meta) internal pure returns (uint8 callerShardId) {

     |  // @audit-issue Prefix function name with an `_` (underscore)
 272 |  function getCodeShardIdFromMeta(uint256 meta) internal pure returns (uint8 codeShardId) {

     |  // @audit-issue Prefix function name with an `_` (underscore)
 279 |  function getZkSyncMeta() internal view returns (ZkSyncMeta memory meta) {

     |  // @audit-issue Prefix function name with an `_` (underscore)
 296 |  function getCallFlags() internal view returns (uint256 callFlags) {

     |  // @audit-issue Prefix function name with an `_` (underscore)
 307 |  function getCalldataPtr() internal view returns (uint256 ptr) {

     |  // @audit-issue Prefix function name with an `_` (underscore)
 318 |  function getExtraAbiData(uint256 index) internal view returns (uint256 extraAbiData) {

     |  // @audit-issue Prefix function name with an `_` (underscore)
 329 |  function isSystemCall() internal view returns (bool) {

     |  // @audit-issue Prefix function name with an `_` (underscore)
 338 |  function isSystemContract(address _address) internal pure returns (bool) {

     |  // @audit-issue Prefix function name with an `_` (underscore)
 344 |  function burnGas(uint32 _gasToPay, uint32 _pubdataToSpend) internal view {
```
GitHub: [48](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L48), [63](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L63), [74](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L74), [85](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L85), [94](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L94), [106](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L106), [124-130](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L124-L130), [148-152](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L148-L152), [168](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L168), [181](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L181), [191](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L191), [203](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L203), [215](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L215), [227](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L227), [237](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L237), [246](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L246), [254](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L254), [263](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L263), [272](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L272), [279](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L279), [296](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L296), [307](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L307), [318](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L318), [329](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L329), [338](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L338), [344](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L344)


```solidity
File: code/system-contracts/contracts/libraries/SystemContractsCaller.sol

     |  // @audit-issue Prefix function name with an `_` (underscore)
  76 |  function systemCall(uint32 gasLimit, address to, uint256 value, bytes memory data) internal returns (bool success) {

     |  // @audit-issue Prefix function name with an `_` (underscore)
 123 |  function systemCallWithReturndata(
 124 |      uint32 gasLimit,
 125 |      address to,
 126 |      uint128 value,
 127 |      bytes memory data
 128 |  ) internal returns (bool success, bytes memory returnData) {

     |  // @audit-issue Prefix function name with an `_` (underscore)
 150 |  function systemCallWithPropagatedRevert(
 151 |      uint32 gasLimit,
 152 |      address to,
 153 |      uint128 value,
 154 |      bytes memory data
 155 |  ) internal returns (bytes memory returnData) {

     |  // @audit-issue Prefix function name with an `_` (underscore)
 214 |  function getFarCallABI(
 215 |      uint32 dataOffset,
 216 |      uint32 memoryPage,
 217 |      uint32 dataStart,
 218 |      uint32 dataLength,
 219 |      uint32 gasPassed,
 220 |      uint8 shardId,
 221 |      CalldataForwardingMode forwardingMode,
 222 |      bool isConstructorCall,
 223 |      bool isSystemCall
 224 |  ) internal pure returns (uint256 farCallAbi) {

     |  // @audit-issue Prefix function name with an `_` (underscore)
 250 |  function getFarCallABIWithEmptyFatPointer(
 251 |      uint32 gasPassed,
 252 |      uint8 shardId,
 253 |      CalldataForwardingMode forwardingMode,
 254 |      bool isConstructorCall,
 255 |      bool isSystemCall
 256 |  ) internal pure returns (uint256 farCallAbiWithEmptyFatPtr) {
```
GitHub: [76](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L76), [123-128](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L123-L128), [150-155](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L150-L155), [214-224](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L214-L224), [250-256](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L250-L256)


```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

     |  // @audit-issue Prefix function name with an `_` (underscore)
  94 |  function isEthToken(uint256 _addr) internal pure returns (bool) {

     |  // @audit-issue Prefix function name with an `_` (underscore)
 100 |  function encodeHash(Transaction calldata _transaction) internal view returns (bytes32 resultHash) {

     |  // @audit-issue Prefix function name with an `_` (underscore)
 362 |  function processPaymasterInput(Transaction calldata _transaction) internal {

     |  // @audit-issue Prefix function name with an `_` (underscore)
 395 |  function payToTheBootloader(Transaction calldata _transaction) internal returns (bool success) {

     |  // @audit-issue Prefix function name with an `_` (underscore)
 405 |  function totalRequiredBalance(Transaction calldata _transaction) internal pure returns (uint256 requiredBalance) {
```
GitHub: [94](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L94), [100](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L100), [362](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L362), [395](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L395), [405](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L405)


```solidity
File: code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol

     |  // @audit-issue Prefix function name with an `_` (underscore)
  19 |  function readUint16(bytes calldata _bytes, uint256 _start) internal pure returns (uint16 result) {

     |  // @audit-issue Prefix function name with an `_` (underscore)
  26 |  function readUint32(bytes calldata _bytes, uint256 _start) internal pure returns (uint32 result) {

     |  // @audit-issue Prefix function name with an `_` (underscore)
  33 |  function readUint64(bytes calldata _bytes, uint256 _start) internal pure returns (uint64 result) {

     |  // @audit-issue Prefix function name with an `_` (underscore)
  40 |  function readBytes32(bytes calldata _bytes, uint256 _start) internal pure returns (bytes32 result) {

     |  // @audit-issue Prefix function name with an `_` (underscore)
  46 |  function readUint256(bytes calldata _bytes, uint256 _start) internal pure returns (uint256 result) {
```
GitHub: [19](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol#L19), [26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol#L26), [33](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol#L33), [40](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol#L40), [46](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol#L46)


```solidity
File: code/system-contracts/contracts/libraries/Utils.sol

     |  // @audit-issue Prefix function name with an `_` (underscore)
  20 |  function safeCastToU128(uint256 _x) internal pure returns (uint128) {

     |  // @audit-issue Prefix function name with an `_` (underscore)
  26 |  function safeCastToU32(uint256 _x) internal pure returns (uint32) {

     |  // @audit-issue Prefix function name with an `_` (underscore)
  32 |  function safeCastToU24(uint256 _x) internal pure returns (uint24) {

     |  // @audit-issue Prefix function name with an `_` (underscore)
  39 |  function bytecodeLenInBytes(bytes32 _bytecodeHash) internal pure returns (uint256 codeLength) {

     |  // @audit-issue Prefix function name with an `_` (underscore)
  44 |  function bytecodeLenInWords(bytes32 _bytecodeHash) internal pure returns (uint256 codeLengthInWords) {

     |  // @audit-issue Prefix function name with an `_` (underscore)
  51 |  function isContractConstructed(bytes32 _bytecodeHash) internal pure returns (bool) {

     |  // @audit-issue Prefix function name with an `_` (underscore)
  56 |  function isContractConstructing(bytes32 _bytecodeHash) internal pure returns (bool) {

     |  // @audit-issue Prefix function name with an `_` (underscore)
  63 |  function constructingBytecodeHash(bytes32 _bytecodeHash) internal pure returns (bytes32) {
```
GitHub: [20](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L20), [26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L26), [32](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L32), [39](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L39), [44](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L44), [51](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L51), [56](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L56), [63](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L63)


## [N-88] Style guide: Non-`external`/`public` variable names should begin with an underscore

According to the Solidity Style Guide, Non-`external`/`public` variable and function names should begin with an [underscore](https://docs.soliditylang.org/en/latest/style-guide.html#underscore-prefix-for-non-external-functions-and-variables).

*Instances: 28*

```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

     |  // @audit-issue Prefix variable name with an `_` (underscore)
  45 |  uint256 internal eraFirstPostUpgradeBatch;

     |  // @audit-issue Prefix variable name with an `_` (underscore)
  61 |  mapping(uint256 chainId => bool enabled) internal hyperbridgingEnabled;

     |  // @audit-issue Prefix variable name with an `_` (underscore)
  65 |  mapping(uint256 chainId => mapping(address l1Token => uint256 balance)) internal chainBalance;
```
GitHub: [45](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L45), [61](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L61), [65](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L65)


```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

     |  // @audit-issue Prefix variable name with an `_` (underscore)
  35 |  address private pendingAdmin;
```
GitHub: [35](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L35)


```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

     |  // @audit-issue Prefix variable name with an `_` (underscore)
  56 |  address private pendingAdmin;
```
GitHub: [56](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L56)


```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

     |  // @audit-issue Prefix variable name with an `_` (underscore)
  47 |  mapping(uint256 => LibMap.Uint32Map) internal committedBatchTimestamp;
```
GitHub: [47](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L47)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol

     |  // @audit-issue Prefix variable name with an `_` (underscore)
  12 |  ZkSyncStateTransitionStorage internal s;
```
GitHub: [12](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L12)


```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

     |  // @audit-issue Prefix variable name with an `_` (underscore)
  26 |  mapping(address => AccountInfo) internal accountInfo;
```
GitHub: [26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L26)


```solidity
File: code/system-contracts/contracts/ImmutableSimulator.sol

     |  // @audit-issue Prefix variable name with an `_` (underscore)
  21 |  mapping(uint256 contractAddress => mapping(uint256 index => bytes32 value)) internal immutableDataStorage;
```
GitHub: [21](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ImmutableSimulator.sol#L21)


```solidity
File: code/system-contracts/contracts/L1Messenger.sol

     |  // @audit-issue Prefix variable name with an `_` (underscore)
  28 |  bytes32 internal chainedLogsHash;

     |  // @audit-issue Prefix variable name with an `_` (underscore)
  32 |  uint256 internal numberOfLogsToProcess;

     |  // @audit-issue Prefix variable name with an `_` (underscore)
  36 |  bytes32 internal chainedMessagesHash;

     |  // @audit-issue Prefix variable name with an `_` (underscore)
  41 |  bytes32 internal chainedL1BytecodesRevealDataHash;
```
GitHub: [28](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L28), [32](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L32), [36](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L36), [41](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L41)


```solidity
File: code/system-contracts/contracts/L2BaseToken.sol

     |  // @audit-issue Prefix variable name with an `_` (underscore)
  20 |  mapping(address account => uint256 balance) internal balance;
```
GitHub: [20](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L2BaseToken.sol#L20)


```solidity
File: code/system-contracts/contracts/NonceHolder.sol

     |  // @audit-issue Prefix variable name with an `_` (underscore)
  36 |  mapping(uint256 account => uint256 packedMinAndDeploymentNonce) internal rawNonces;

     |  // @audit-issue Prefix variable name with an `_` (underscore)
  41 |  mapping(uint256 account => mapping(uint256 nonceKey => uint256 value)) internal nonceValues;
```
GitHub: [36](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/NonceHolder.sol#L36), [41](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/NonceHolder.sol#L41)


```solidity
File: code/system-contracts/contracts/SystemContext.sol

     |  // @audit-issue Prefix variable name with an `_` (underscore)
  51 |  BlockInfo internal currentBatchInfo;

     |  // @audit-issue Prefix variable name with an `_` (underscore)
  55 |  mapping(uint256 batchNumber => bytes32 batchHash) internal batchHashes;

     |  // @audit-issue Prefix variable name with an `_` (underscore)
  58 |  BlockInfo internal currentL2BlockInfo;

     |  // @audit-issue Prefix variable name with an `_` (underscore)
  61 |  bytes32 internal currentL2BlockTxsRollingHash;

     |  // @audit-issue Prefix variable name with an `_` (underscore)
  70 |  bytes32[MINIBLOCK_HASHES_TO_STORE] internal l2BlockHash;

     |  // @audit-issue Prefix variable name with an `_` (underscore)
  77 |  BlockInfo internal currentVirtualL2BlockInfo;

     |  // @audit-issue Prefix variable name with an `_` (underscore)
  80 |  VirtualBlockUpgradeInfo internal virtualBlockUpgradeInfo;

     |  // @audit-issue Prefix variable name with an `_` (underscore)
  95 |  uint256 internal basePubdataSpent;
```
GitHub: [51](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L51), [55](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L55), [58](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L58), [61](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L61), [70](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L70), [77](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L77), [80](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L80), [95](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L95)


```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

     |  // @audit-issue Prefix variable name with an `_` (underscore)
  32 |  bytes32 internal l2TokenProxyBytecodeHash;

     |  // @audit-issue Prefix variable name with an `_` (underscore)
  37 |  address private l1LegacyBridge;
```
GitHub: [32](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L32), [37](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L37)


```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

     |  // @audit-issue Prefix variable name with an `_` (underscore)
  26 |  ERC20Getters private availableGetters;

     |  // @audit-issue Prefix variable name with an `_` (underscore)
  31 |  uint8 private decimals_;
```
GitHub: [26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L26), [31](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L31)


## [N-89] Style guide: State and local variables should be named using lowerCamelCase

The Solidity style guide [says](https://docs.soliditylang.org/en/latest/style-guide.html#local-and-state-variable-names) to use mixedCase for local and state variable names. Note that while OpenZeppelin may not follow this advice, it still is the recommended way of naming variables.

*Instances: 11*

```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

     |  // @audit-issue Use lowerCamelCase style in name `_l1Token`
 190 |  (address _l1Token, uint256 _depositAmount, address _l2Receiver) = abi.decode(

     |  // @audit-issue Use lowerCamelCase style in name `_depositAmount`
 190 |  (address _l1Token, uint256 _depositAmount, address _l2Receiver) = abi.decode(

     |  // @audit-issue Use lowerCamelCase style in name `_l2Receiver`
 190 |  (address _l1Token, uint256 _depositAmount, address _l2Receiver) = abi.decode(
```
GitHub: [190](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L190), [190](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L190), [190](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L190)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol

     |  // @audit-issue Use lowerCamelCase style in name `__DEPRECATED_diamondCutStorage`
  68 |  uint256[7] __DEPRECATED_diamondCutStorage;

     |  // @audit-issue Use lowerCamelCase style in name `__DEPRECATED_governor`
  70 |  address __DEPRECATED_governor;

     |  // @audit-issue Use lowerCamelCase style in name `__DEPRECATED_pendingGovernor`
  72 |  address __DEPRECATED_pendingGovernor;

     |  // @audit-issue Use lowerCamelCase style in name `__DEPRECATED_allowList`
  92 |  address __DEPRECATED_allowList;

     |  // @audit-issue Use lowerCamelCase style in name `__DEPRECATED_upgrades`
 109 |  UpgradeStorage __DEPRECATED_upgrades;

     |  // @audit-issue Use lowerCamelCase style in name `__DEPRECATED_lastWithdrawalLimitReset`
 116 |  uint256 __DEPRECATED_lastWithdrawalLimitReset;

     |  // @audit-issue Use lowerCamelCase style in name `__DEPRECATED_withdrawnAmountInWindow`
 118 |  uint256 __DEPRECATED_withdrawnAmountInWindow;

     |  // @audit-issue Use lowerCamelCase style in name `__DEPRECATED_totalDepositedAmountPerUser`
 120 |  mapping(address => uint256) __DEPRECATED_totalDepositedAmountPerUser;
```
GitHub: [68](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L68), [70](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L70), [72](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L72), [92](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L92), [109](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L109), [116](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L116), [118](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L118), [120](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L120)


## [N-90] Style guide: Using underscore at the end of variable name

The use of underscore at the end of the variable name is uncommon and also suggests that the variable name was not completely changed. Consider refactoring `variableName_` to `variableName`.

*Instances: 3*

```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

     |  // @audit-issue Don't use underscores at the end of variable names
  31 |  uint8 private decimals_;
```
GitHub: [31](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L31)


```solidity
File: code/contracts/zksync/contracts/bridge/L2WrappedBaseToken.sol

     |  // @audit-issue Don't use underscores at the end of variable names
  45 |  string memory name_,

     |  // @audit-issue Don't use underscores at the end of variable names
  46 |  string memory symbol_,
```
GitHub: [45](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2WrappedBaseToken.sol#L45), [46](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2WrappedBaseToken.sol#L46)


## [N-91] Style: SPDX-License-Identifier should be on first line

As per the Solidity manual:

        > Trust in smart contracts can be better established if their source code is available. Since making source code available always touches on legal problems with regards to copyright, the Solidity compiler encourages the use of machine-readable SPDX license identifiers. Every source file should start with a comment indicating its license.

        *[Layout of a Solidity Source File](https://docs.soliditylang.org/en/v0.8.22/layout-of-source-files.html)*
        

*Instances: 5*

```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

     |  // @audit-issue Move this to line 1
   3 |  // SPDX-License-Identifier: MIT
```
GitHub: [3](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L3)


```solidity
File: code/contracts/ethereum/contracts/common/Config.sol

     |  // @audit-issue Move this to line 1
   3 |  // SPDX-License-Identifier: MIT
```
GitHub: [3](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/Config.sol#L3)


```solidity
File: code/contracts/ethereum/contracts/upgrades/Upgrade_4844.sol

     |  // @audit-issue Move this to line 1
   3 |  // SPDX-License-Identifier: MIT
```
GitHub: [3](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/Upgrade_4844.sol#L3)


```solidity
File: code/contracts/ethereum/contracts/upgrades/Upgrade_v1_4_1.sol

     |  // @audit-issue Move this to line 1
   3 |  // SPDX-License-Identifier: MIT
```
GitHub: [3](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/Upgrade_v1_4_1.sol#L3)


```solidity
File: code/contracts/zksync/contracts/Config.sol

     |  // @audit-issue Move this to line 1
   3 |  // SPDX-License-Identifier: MIT
```
GitHub: [3](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/Config.sol#L3)


## [N-92] Style: inconsistent use of leading spacing in comments

Some lines use `// comment` and some use `//comment`. The instances below point out the usages that don't follow the majority within each file.

*Instances: 1*

```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

     |  // @audit-issue Use // xxx style comments for majority consistency
 118 |  uint256, //_salt
```
GitHub: [118](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L118)


## [N-93] Style: line length is too long

Usually lines in source code are limited to [80](https://softwareengineering.stackexchange.com/questions/148677/why-is-80-characters-the-standard-limit-for-code-width) characters. Today's screens are much larger so it's reasonable to stretch this in some cases. The solidity style guide recommends a maximumum line length of [120 characters](https://docs.soliditylang.org/en/v0.8.17/style-guide.html#maximum-line-length), so the lines below should be split when they reach that length.

*Instances: 99*

```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

     |  // @audit-issue @audit-issue Line length is 130 characters (leading spaces not shown)
  31 |  /// @dev Used for saving the number of deposited funds, to claim them in case the deposit transaction will fail in zkSync Era.
```
GitHub: [31](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L31)


```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

     |  // @audit-issue @audit-issue Line length is 139 characters (leading spaces not shown)
  21 |  import {ERA_CHAIN_ID, ERA_ERC20_BRIDGE_ADDRESS, ETH_TOKEN_ADDRESS, ERA_DIAMOND_PROXY, TWO_BRIDGES_MAGIC_VALUE} from "../common/Config.sol";

     |  // @audit-issue @audit-issue Line length is 127 characters (leading spaces not shown)
  43 |  /// This variable is used to differentiate between pre-upgrade and post-upgrade withdrawals. Withdrawals from batches older

     |  // @audit-issue @audit-issue Line length is 128 characters (leading spaces not shown)
  47 |  /// @dev A mapping chainId => bridgeProxy. Used to store the bridge proxy's address, and to see if it has been deployed yet.

     |  // @audit-issue @audit-issue Line length is 122 characters (leading spaces not shown)
  57 |  mapping(uint256 chainId => mapping(uint256 l2BatchNumber => mapping(uint256 l2ToL1MessageNumber => bool isFinalized)))

     |  // @audit-issue @audit-issue Line length is 137 characters (leading spaces not shown)
 103 |  /// implementation. The owner is the Governor and separate from the ProxyAdmin from now on, so that the Governor can call the bridge.

     |  // @audit-issue @audit-issue Line length is 172 characters (leading spaces not shown)
 160 |  uint256 amount = _depositFunds(_prevMsgSender, IERC20(_l1Token), _amount); // note if _prevMsgSender is this contract, this will return 0. This does not happen.

     |  // @audit-issue @audit-issue Line length is 142 characters (leading spaces not shown)
 167 |  // Note that we don't save the deposited amount, as this is for the base token, which gets sent to the refundRecipient if the tx fails

     |  // @audit-issue @audit-issue Line length is 128 characters (leading spaces not shown)
 230 |  /// @notice Confirms the acceptance of a transaction by the Mailbox, as part of the L2 transaction process within Bridgehub.

     |  // @audit-issue @audit-issue Line length is 140 characters (leading spaces not shown)
 332 |  // Deposits that happened before the upgrade cannot be checked here, they have to be claimed and checked in the legacyBridge

     |  // @audit-issue @audit-issue Line length is 142 characters (leading spaces not shown)
 494 |  // It should be equal to the length of the bytes4 function signature + address l1Receiver + uint256 amount = 4 + 20 + 32 = 56 (bytes).

     |  // @audit-issue @audit-issue Line length is 124 characters (leading spaces not shown)
 515 |  // It should be equal to the length of the function signature + address + address + uint256 = 4 + 20 + 20 + 32 =

     |  // @audit-issue @audit-issue Line length is 139 characters (leading spaces not shown)
 587 |  mintValue: msg.value, // l2 gas + l2 msg.Value the bridgehub will withdraw the mintValue from the base token bridge for gas

     |  // @audit-issue @audit-issue Line length is 155 characters (leading spaces not shown)
 588 |  l2Value: 0, // L2 msg.value, this contract doesn't support base token deposits or wrapping functionality, for direct deposits use bridgehub
```
GitHub: [21](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L21), [43](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L43), [47](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L47), [57](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L57), [103](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L103), [160](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L160), [167](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L167), [230](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L230), [332](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L332), [494](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L494), [515](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L515), [587](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L587), [588](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L588)


```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

     |  // @audit-issue @audit-issue Line length is 127 characters (leading spaces not shown)
  62 |  require(msg.sender == currentPendingAdmin, "n42"); // Only proposed by current admin address can claim the admin rights

     |  // @audit-issue @audit-issue Line length is 127 characters (leading spaces not shown)
 216 |  /// This means this is not ideal for contract calls, as the contract would have to handle token allowance of the base Token
```
GitHub: [62](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L62), [216](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L216)


```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

     |  // @audit-issue @audit-issue Line length is 213 characters (leading spaces not shown)
  21 |  import {REQUIRED_L2_GAS_PRICE_PER_PUBDATA, L2_TO_L1_LOG_SERIALIZE_SIZE, DEFAULT_L2_LOGS_TREE_ROOT_HASH, EMPTY_STRING_KECCAK, SYSTEM_UPGRADE_L2_TX_TYPE, ERA_DIAMOND_PROXY, ERA_CHAIN_ID} from "../common/Config.sol";

     |  // @audit-issue @audit-issue Line length is 127 characters (leading spaces not shown)
 123 |  require(msg.sender == currentPendingAdmin, "n42"); // Only proposed by current admin address can claim the admin rights
```
GitHub: [21](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L21), [123](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L123)


```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

     |  // @audit-issue @audit-issue Line length is 134 characters (leading spaces not shown)
  13 |  /// @notice Intermediate smart contract between the validator EOA account and the hyperchains state transition diamond smart contract.

     |  // @audit-issue @audit-issue Line length is 126 characters (leading spaces not shown)
  15 |  /// modifying the main hyperchain diamond contract. As such, even if this contract is compromised, it will not impact the main
```
GitHub: [13](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L13), [15](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L15)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol

     |  // @audit-issue @audit-issue Line length is 132 characters (leading spaces not shown)
  69 |  /// @notice Address which will exercise critical changes to the Diamond Proxy (upgrades, freezing & unfreezing). Replaced by STM

     |  // @audit-issue @audit-issue Line length is 130 characters (leading spaces not shown)
 149 |  /// @notice gasPriceMultiplier for each baseToken, so that each L1->L2 transaction pays for its transaction on the destination
```
GitHub: [69](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L69), [149](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L149)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol

     |  // @audit-issue @audit-issue Line length is 162 characters (leading spaces not shown)
  90 |  require(s.totalBatchesCommitted == 0, "AdminFacet: set validium only after genesis"); // Validium mode can be set only before the first batch is committed
```
GitHub: [90](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L90)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

     |  // @audit-issue @audit-issue Line length is 280 characters (leading spaces not shown)
   6 |  import {COMMIT_TIMESTAMP_NOT_OLDER, COMMIT_TIMESTAMP_APPROXIMATION_DELTA, EMPTY_STRING_KECCAK, L2_TO_L1_LOG_SERIALIZE_SIZE, MAX_L2_TO_L1_LOGS_COMMITMENT_BYTES, PACKED_L2_BLOCK_TIMESTAMP_MASK, PUBLIC_INPUT_SHIFT, POINT_EVALUATION_PRECOMPILE_ADDR} from "../../../common/Config.sol";

     |  // @audit-issue @audit-issue Line length is 341 characters (leading spaces not shown)
   7 |  import {IExecutor, L2_LOG_ADDRESS_OFFSET, L2_LOG_KEY_OFFSET, L2_LOG_VALUE_OFFSET, SystemLogKey, LogProcessingOutput, PubdataSource, BLS_MODULUS, PUBDATA_COMMITMENT_SIZE, PUBDATA_COMMITMENT_CLAIMED_VALUE_OFFSET, PUBDATA_COMMITMENT_COMMITMENT_OFFSET, MAX_NUMBER_OF_BLOBS, TOTAL_BLOBS_IN_COMMITMENT} from "../../chain-interfaces/IExecutor.sol";

     |  // @audit-issue @audit-issue Line length is 192 characters (leading spaces not shown)
  12 |  import {L2_BOOTLOADER_ADDRESS, L2_TO_L1_MESSENGER_SYSTEM_CONTRACT_ADDR, L2_SYSTEM_CONTEXT_SYSTEM_CONTRACT_ADDR, L2_PUBDATA_CHUNK_PUBLISHER_ADDR} from "../../../common/L2ContractAddresses.sol";

     |  // @audit-issue @audit-issue Line length is 176 characters (leading spaces not shown)
  57 |  // In this scenario, pubdataCommitments is a list of: opening point (16 bytes) || claimed value (32 bytes) || commitment (48 bytes) || proof (48 bytes)) = 144 bytes

     |  // @audit-issue @audit-issue Line length is 178 characters (leading spaces not shown)
  60 |  // In this scenario pubdataCommitments is actual pubdata consisting of l2 to l1 logs, l2 to l1 message, compressed smart contract bytecode, and compressed state diffs

     |  // @audit-issue @audit-issue Line length is 142 characters (leading spaces not shown)
 100 |  /// @param _packedBatchAndL2BlockTimestamp - packed batch and L2 block timestamp in a format of batchTimestamp * 2**128 + l2BatchTimestamp

     |  // @audit-issue @audit-issue Line length is 122 characters (leading spaces not shown)
 122 |  require(block.timestamp - COMMIT_TIMESTAMP_NOT_OLDER <= batchTimestamp, "h1"); // New batch timestamp is too small

     |  // @audit-issue @audit-issue Line length is 144 characters (leading spaces not shown)
 123 |  require(lastL2BlockTimestamp <= block.timestamp + COMMIT_TIMESTAMP_APPROXIMATION_DELTA, "h2"); // The last L2 block timestamp is too big

     |  // @audit-issue @audit-issue Line length is 139 characters (leading spaces not shown)
 221 |  // 1. A chain has to keep their protocol version up to date, as processing a block requires the latest or previous protocol version

     |  // @audit-issue @audit-issue Line length is 132 characters (leading spaces not shown)
 222 |  // to solve this we will need to add the feature to create batches with only the protocol upgrade tx, without any other txs.

     |  // @audit-issue @audit-issue Line length is 169 characters (leading spaces not shown)
 223 |  // 2. A chain might become out of sync if it launches while we are in the middle of a protocol upgrade. This would mean they cannot process their genesis upgrade

     |  // @audit-issue @audit-issue Line length is 139 characters (leading spaces not shown)
 224 |  // as thier protocolversion would be outdated, and they also cannot process the protocol upgrade tx as they have a pending upgrade.

     |  // @audit-issue @audit-issue Line length is 138 characters (leading spaces not shown)
 225 |  // 3. The protocol upgrade is increased in the BaseZkSyncUpgrade, in the executor only the systemContractsUpgradeTxHash is checked

     |  // @audit-issue @audit-issue Line length is 158 characters (leading spaces not shown)
 230 |  // With the new changes for EIP-4844, namely the restriction on number of blobs per block, we only allow for a single batch to be committed at a time.

     |  // @audit-issue @audit-issue Line length is 149 characters (leading spaces not shown)
 233 |  require(s.storedBatchHashes[s.totalBatchesCommitted] == _hashStoredBatchInfo(_lastCommittedBatchData), "i"); // incorrect previous batch data

     |  // @audit-issue @audit-issue Line length is 132 characters (leading spaces not shown)
 282 |  // While the logic of the contract ensures that the s.l2SystemContractsUpgradeBatchNumber is 0 when this function is called,

     |  // @audit-issue @audit-issue Line length is 139 characters (leading spaces not shown)
 330 |  require(priorityOperationsHash == _storedBatch.priorityOperationsHash, "x"); // priority operations hash does not match to expected

     |  // @audit-issue @audit-issue Line length is 139 characters (leading spaces not shown)
 358 |  require(newTotalBatchesExecuted <= s.totalBatchesVerified, "n"); // Can't execute batches more than committed and proven currently.

     |  // @audit-issue @audit-issue Line length is 123 characters (leading spaces not shown)
 532 |  // VM 1.5.0 requires us to pass the EVM simulator code hash. For now it is the same as the default account.

     |  // @audit-issue @audit-issue Line length is 125 characters (leading spaces not shown)
 615 |  // response is equal to BLS_MODULUS as defined in https://eips.ethereum.org/EIPS/eip-4844#point-evaluation-precompile

     |  // @audit-issue @audit-issue Line length is 133 characters (leading spaces not shown)
 621 |  /// @dev Verifies that the blobs contain the correct data by calling the point evaluation precompile. For the precompile we need:

     |  // @audit-issue @audit-issue Line length is 151 characters (leading spaces not shown)
 624 |  /// pubdataCommitments is a list of: opening point (16 bytes) || claimed value (32 bytes) || commitment (48 bytes) || proof (48 bytes)) = 144 bytes
```
GitHub: [6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L6), [7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L7), [12](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L12), [57](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L57), [60](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L60), [100](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L100), [122](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L122), [123](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L123), [221](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L221), [222](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L222), [223](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L223), [224](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L224), [225](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L225), [230](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L230), [233](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L233), [282](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L282), [330](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L330), [358](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L358), [532](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L532), [615](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L615), [621](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L621), [624](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L624)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

     |  // @audit-issue @audit-issue Line length is 151 characters (leading spaces not shown)
  11 |  import {WritePriorityOpParams, L2CanonicalTransaction, L2Message, L2Log, TxStatus, BridgehubL2TransactionRequest} from "../../../common/Messaging.sol";

     |  // @audit-issue @audit-issue Line length is 244 characters (leading spaces not shown)
  18 |  import {REQUIRED_L2_GAS_PRICE_PER_PUBDATA, L1_GAS_PER_PUBDATA_BYTE, L2_L1_LOGS_TREE_DEFAULT_LEAF_HASH, PRIORITY_OPERATION_L2_TX_TYPE, PRIORITY_EXPIRATION, MAX_NEW_FACTORY_DEPS, ETH_TOKEN_ADDRESS, ERA_CHAIN_ID} from "../../../common/Config.sol";

     |  // @audit-issue @audit-issue Line length is 155 characters (leading spaces not shown)
  19 |  import {L2_BOOTLOADER_ADDRESS, L2_TO_L1_MESSENGER_SYSTEM_CONTRACT_ADDR, L2_BASE_TOKEN_SYSTEM_CONTRACT_ADDR} from "../../../common/L2ContractAddresses.sol";

     |  // @audit-issue @audit-issue Line length is 135 characters (leading spaces not shown)
  90 |  // - l2ShardId = 0 (means that L1 -> L2 transaction was processed in a rollup shard, other shards are not available yet anyway)

     |  // @audit-issue @audit-issue Line length is 128 characters (leading spaces not shown)
 232 |  // Please note, currently zkSync address derivation is different from Ethereum one, but it may be changed in the future.

     |  // @audit-issue @audit-issue Line length is 127 characters (leading spaces not shown)
 239 |  // to ensure that users do not get used to using "exotic" numbers for _request.l2GasPerPubdataByteLimit, e.g. 1-2, etc.

     |  // @audit-issue @audit-issue Line length is 144 characters (leading spaces not shown)
 240 |  // VERY IMPORTANT: nobody should rely on this constant to be fixed and every contract should give their users the ability to provide the
```
GitHub: [11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L11), [18](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L18), [19](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L19), [90](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L90), [232](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L232), [239](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L239), [240](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L240)


```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol

     |  // @audit-issue @audit-issue Line length is 121 characters (leading spaces not shown)
  11 |  import {MAX_NEW_FACTORY_DEPS, SYSTEM_UPGRADE_L2_TX_TYPE, MAX_ALLOWED_PROTOCOL_VERSION_DELTA} from "../common/Config.sol";

     |  // @audit-issue @audit-issue Line length is 121 characters (leading spaces not shown)
 143 |  // An upgrade to the verifier params must be done carefully to ensure there aren't batches in the committed state

     |  // @audit-issue @audit-issue Line length is 126 characters (leading spaces not shown)
 145 |  // Batches committed expecting the old verifier params will fail. Ensure all commited batches are finalized before the
```
GitHub: [11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L11), [143](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L143), [145](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L145)


```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol

     |  // @audit-issue @audit-issue Line length is 121 characters (leading spaces not shown)
  11 |  import {MAX_NEW_FACTORY_DEPS, SYSTEM_UPGRADE_L2_TX_TYPE, MAX_ALLOWED_PROTOCOL_VERSION_DELTA} from "../common/Config.sol";
```
GitHub: [11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L11)


```solidity
File: code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol

     |  // @audit-issue @audit-issue Line length is 136 characters (leading spaces not shown)
   9 |  * @dev Each of the functions accepts the `bytes memory` and the offset where data should be read and returns a value of a certain type.
```
GitHub: [9](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol#L9)


```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol

     |  // @audit-issue @audit-issue Line length is 126 characters (leading spaces not shown)
  16 |  /// @dev Used to distinguish calls to contracts that were supposed to be used as diamond initializer from other contracts.

     |  // @audit-issue @audit-issue Line length is 129 characters (leading spaces not shown)
  22 |  0xc8fcad8db84d3cc18b4c41d551ea0ee66dd599cde068d998e57d5e09332c131b; // keccak256("diamond.standard.diamond.storage") - 1;

     |  // @audit-issue @audit-issue Line length is 121 characters (leading spaces not shown)
 161 |  require(oldFacet.facetAddress != address(0), "L"); // it is impossible to replace the facet with zero address
```
GitHub: [16](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L16), [22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L22), [161](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L161)


```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/LibMap.sol

     |  // @audit-issue @audit-issue Line length is 144 characters (leading spaces not shown)
   6 |  /// @dev This library is an adaptation of the corresponding Solady library (https://github.com/vectorized/solady/blob/main/src/utils/LibMap.sol)

     |  // @audit-issue @audit-issue Line length is 123 characters (leading spaces not shown)
  60 |  // shifted to its proper position. The XOR operation will effectively replace the old value with the new value.
```
GitHub: [6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/LibMap.sol#L6), [60](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/LibMap.sol#L60)


```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol

     |  // @audit-issue @audit-issue Line length is 134 characters (leading spaces not shown)
  13 |  /// NOTE: When using this function, check that the _path length is equal to the tree height to prevent shorter/longer paths attack
```
GitHub: [13](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol#L13)


```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol

     |  // @audit-issue @audit-issue Line length is 123 characters (leading spaces not shown)
  39 |  /// @return The total number of priority operations that were added to the priority queue, including all processed ones
```
GitHub: [39](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L39)


```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol

     |  // @audit-issue @audit-issue Line length is 256 characters (leading spaces not shown)
   8 |  import {TX_SLOT_OVERHEAD_L2_GAS, MEMORY_OVERHEAD_GAS, L1_TX_INTRINSIC_L2_GAS, L1_TX_DELTA_544_ENCODING_BYTES, L1_TX_DELTA_FACTORY_DEPS_L2_GAS, L1_TX_MIN_L2_GAS_BASE, L1_TX_INTRINSIC_PUBDATA, L1_TX_DELTA_FACTORY_DEPS_PUBDATA} from "../../common/Config.sol";

     |  // @audit-issue @audit-issue Line length is 157 characters (leading spaces not shown)
  68 |  /// Note: The calculation includes the main cost of the priority transaction, however, in reality, the operator can spend a little more gas on overheads.

     |  // @audit-issue @audit-issue Line length is 131 characters (leading spaces not shown)
 107 |  /// and the L2 gas needed to process the transaction itself (i.e. the actual l2GasLimit that will be used for the transaction).
```
GitHub: [8](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L8), [68](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L68), [107](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L107)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol

     |  // @audit-issue @audit-issue Line length is 124 characters (leading spaces not shown)
  21 |  /// @dev Enum used to determine the source of pubdata. At first we will support calldata and blobs but this can be extended.

     |  // @audit-issue @audit-issue Line length is 123 characters (leading spaces not shown)
  45 |  /// @dev Offset used to pull Value From Log. Equal to 4 (bytes for isService) + 20 (bytes for address) + 32 (bytes for key)

     |  // @audit-issue @audit-issue Line length is 136 characters (leading spaces not shown)
  53 |  /// @dev Format: list of: opening point (16 bytes) || claimed value (32 bytes) || commitment (48 bytes) || proof (48 bytes)) = 144 bytes

     |  // @audit-issue @audit-issue Line length is 163 characters (leading spaces not shown)
  77 |  /// @param indexRepeatedStorageChanges The serial number of the shortcut index that's used as a unique identifier for storage keys that were used twice or more

     |  // @audit-issue @audit-issue Line length is 163 characters (leading spaces not shown)
  97 |  /// @param indexRepeatedStorageChanges The serial number of the shortcut index that's used as a unique identifier for storage keys that were used twice or more

     |  // @audit-issue @audit-issue Line length is 175 characters (leading spaces not shown)
 101 |  /// @param bootloaderHeapInitialContentsHash Hash of the initial contents of the bootloader heap. In practice it serves as the commitment to the transactions in the batch.

     |  // @audit-issue @audit-issue Line length is 135 characters (leading spaces not shown)
 102 |  /// @param eventsQueueStateHash Hash of the events queue state. In practice it serves as the commitment to the events in the batch.

     |  // @audit-issue @audit-issue Line length is 149 characters (leading spaces not shown)
 105 |  /// @dev pubdataCommitments format: This will always start with a 1 byte pubdataSource flag. Current allowed values are 0 (calldata) or 1 (blobs)

     |  // @audit-issue @audit-issue Line length is 159 characters (leading spaces not shown)
 106 |  ///                             kzg: list of: opening point (16 bytes) || claimed value (32 bytes) || commitment (48 bytes) || proof (48 bytes) = 144 bytes

     |  // @audit-issue @audit-issue Line length is 152 characters (leading spaces not shown)
 108 |  ///                                       and 32 bytes appended to serve as the blob commitment part for the aux output part of the batch commitment

     |  // @audit-issue @audit-issue Line length is 158 characters (leading spaces not shown)
 110 |  /// @dev When using calldata, we only need to send one blob commitment since the max number of bytes in calldata fits in a single blob and we can pull the

     |  // @audit-issue @audit-issue Line length is 124 characters (leading spaces not shown)
 196 |  /// @dev It has the name "BlocksVerification" and not "BatchesVerification" due to backward compatibility considerations
```
GitHub: [21](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L21), [45](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L45), [53](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L53), [77](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L77), [97](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L97), [101](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L101), [102](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L102), [105](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L105), [106](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L106), [108](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L108), [110](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L110), [196](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L196)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol

     |  // @audit-issue @audit-issue Line length is 130 characters (leading spaces not shown)
  10 |  /// @title The interface of the Getters Contract that implements functions for getting contract state from outside the blockchain.

     |  // @audit-issue @audit-issue Line length is 123 characters (leading spaces not shown)
  48 |  /// @return The total number of priority operations that were added to the priority queue, including all processed ones

     |  // @audit-issue @audit-issue Line length is 126 characters (leading spaces not shown)
  54 |  /// in case exactly *unprocessed* transactions are needed, one should check that getPriorityQueueSize() is greater than 0.

     |  // @audit-issue @audit-issue Line length is 125 characters (leading spaces not shown)
 111 |  /// @return the baseTokenGasPriceMultiplierNominator, used to compare the baseTokenPrice to ether for L1->L2 transactions

     |  // @audit-issue @audit-issue Line length is 127 characters (leading spaces not shown)
 114 |  /// @return the baseTokenGasPriceMultiplierDenominator, used to compare the baseTokenPrice to ether for L1->L2 transactions
```
GitHub: [10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L10), [48](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L48), [54](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L54), [111](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L111), [114](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L114)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol

     |  // @audit-issue @audit-issue Line length is 125 characters (leading spaces not shown)
   6 |  import {L2CanonicalTransaction, L2Log, L2Message, TxStatus, BridgehubL2TransactionRequest} from "../../common/Messaging.sol";

     |  // @audit-issue @audit-issue Line length is 147 characters (leading spaces not shown)
  15 |  /// @param _message Information about the sent message: sender address, the message itself, tx index in the L2 batch where the message was sent

     |  // @audit-issue @audit-issue Line length is 130 characters (leading spaces not shown)
  46 |  /// NOTE: It may return `false` for incorrect proof, but it doesn't mean that the L1 -> L2 transaction has an opposite status!

     |  // @audit-issue @audit-issue Line length is 132 characters (leading spaces not shown)
  75 |  /// @param _l2GasPerPubdataByteLimit The maximum amount L2 gas that the operator may charge the user for single byte of pubdata.

     |  // @audit-issue @audit-issue Line length is 131 characters (leading spaces not shown)
  79 |  /// Please note, the contract may change the refund recipient's address to eliminate sending funds to addresses out of control.

     |  // @audit-issue @audit-issue Line length is 154 characters (leading spaces not shown)
  81 |  /// - If `_refundRecipient` is set to `address(0)` and the sender has NO deployed bytecode on L1, the refund will be sent to the `msg.sender` address.

     |  // @audit-issue @audit-issue Line length is 159 characters (leading spaces not shown)
  82 |  /// - If `_refundRecipient` is set to `address(0)` and the sender has deployed bytecode on L1, the refund will be sent to the aliased `msg.sender` address.

     |  // @audit-issue @audit-issue Line length is 134 characters (leading spaces not shown)
  83 |  /// @dev The address aliasing of L1 contracts as refund recipient on L2 is necessary to guarantee that the funds are controllable,

     |  // @audit-issue @audit-issue Line length is 123 characters (leading spaces not shown)
  85 |  /// Without address aliasing for L1 contracts as refund recipients they would not be able to make proper L2 tx requests

     |  // @audit-issue @audit-issue Line length is 128 characters (leading spaces not shown)
  87 |  /// @return canonicalTxHash The hash of the requested L2 transaction. This hash can be used to follow the transaction status

     |  // @audit-issue @audit-issue Line length is 137 characters (leading spaces not shown)
 105 |  /// @param _l2GasPerPubdataByteLimit The maximum amount of L2 gas that the operator may charge the user for a single byte of pubdata.
```
GitHub: [6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L6), [15](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L15), [46](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L46), [75](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L75), [79](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L79), [81](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L81), [82](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L82), [83](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L83), [85](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L85), [87](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L87), [105](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L105)


```solidity
File: code/contracts/ethereum/contracts/common/ReentrancyGuard.sol

     |  // @audit-issue @audit-issue Line length is 146 characters (leading spaces not shown)
  32 |  // https://github.com/OpenZeppelin/openzeppelin-contracts/blob/566a774222707e424896c0c390a84dc3c13bdcb2/contracts/security/ReentrancyGuard.sol
```
GitHub: [32](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/ReentrancyGuard.sol#L32)


```solidity
File: code/contracts/ethereum/contracts/state-transition/Verifier.sol

     |  // @audit-issue @audit-issue Line length is 164 characters (leading spaces not shown)
  17 |  /// * Plonk for zkSync v1.1: https://github.com/matter-labs/solidity_plonk_verifier/raw/recursive/bellman_vk_codegen_recursive/RecursivePlonkUnrolledForEthereum.pdf
```
GitHub: [17](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L17)


```solidity
File: code/contracts/ethereum/contracts/upgrades/Upgrade_v1_4_1.sol

     |  // @audit-issue @audit-issue Line length is 133 characters (leading spaces not shown)
  19 |  /// It is to be used once to set the new fee params for the first time as they needed for the correct functioning of the upgrade.
```
GitHub: [19](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/Upgrade_v1_4_1.sol#L19)


```solidity
File: code/system-contracts/contracts/AccountCodeStorage.sol

     |  // @audit-issue @audit-issue Line length is 122 characters (leading spaces not shown)
  14 |  * the second byte denotes whether the contract is constructed, and the next two bytes denote the length in 32-byte words.
```
GitHub: [14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L14)


## [N-94] Style: surround top level declarations with two blank lines

As per the [Solidity Style Guide](https://docs.soliditylang.org/en/v0.8.22/style-guide.html#blank-lines):
        
> Surround top level declarations in Solidity source with two blank lines.

Note:  this rule does not apply to `import` directives following another `import` directive.

*Instances: 99*

```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

     |  // @audit-issue Separate top-level declarations with at least two lines
   3 |  pragma solidity 0.8.20;
   5 |  import {IERC20} from "@openzeppelin/contracts/token/ERC20/IERC20.sol";
```
GitHub: [3-5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L3-L5)


```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

     |  // @audit-issue Separate top-level declarations with at least two lines
   3 |  pragma solidity 0.8.20;
   5 |  import {Initializable} from "@openzeppelin/contracts/proxy/utils/Initializable.sol";
```
GitHub: [3-5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L3-L5)


```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

     |  // @audit-issue Separate top-level declarations with at least two lines
   3 |  pragma solidity 0.8.20;
   5 |  import {Ownable2Step} from "@openzeppelin/contracts/access/Ownable2Step.sol";

     |  // @audit-issue Separate top-level declarations with at least two lines
  14 |  import "../vendor/AddressAliasHelper.sol";
  16 |  contract Bridgehub is IBridgehub, ReentrancyGuard, Ownable2Step {
```
GitHub: [3-5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L3-L5), [14-16](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L14-L16)


```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

     |  // @audit-issue Separate top-level declarations with at least two lines
   3 |  pragma solidity 0.8.20;
   5 |  import {Ownable2Step} from "@openzeppelin/contracts/access/Ownable2Step.sol";
```
GitHub: [3-5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L3-L5)


```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

     |  // @audit-issue Separate top-level declarations with at least two lines
   3 |  pragma solidity 0.8.20;
   5 |  import {Ownable2Step} from "@openzeppelin/contracts/access/Ownable2Step.sol";
```
GitHub: [3-5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L3-L5)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol

     |  // @audit-issue Separate top-level declarations with at least two lines
   3 |  pragma solidity 0.8.20;
   5 |  import {Diamond} from "../libraries/Diamond.sol";
```
GitHub: [3-5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol#L3-L5)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol

     |  // @audit-issue Separate top-level declarations with at least two lines
   3 |  pragma solidity 0.8.20;
   5 |  import {Diamond} from "../libraries/Diamond.sol";
```
GitHub: [3-5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol#L3-L5)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol

     |  // @audit-issue Separate top-level declarations with at least two lines
   3 |  pragma solidity 0.8.20;
   5 |  import {IVerifier, VerifierParams} from "../chain-interfaces/IVerifier.sol";
```
GitHub: [3-5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L3-L5)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol

     |  // @audit-issue Separate top-level declarations with at least two lines
   3 |  pragma solidity 0.8.20;
   5 |  import {IAdmin} from "../../chain-interfaces/IAdmin.sol";
```
GitHub: [3-5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L3-L5)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

     |  // @audit-issue Separate top-level declarations with at least two lines
   3 |  pragma solidity 0.8.20;
   5 |  import {ZkSyncStateTransitionBase} from "./ZkSyncStateTransitionBase.sol";
```
GitHub: [3-5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L3-L5)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol

     |  // @audit-issue Separate top-level declarations with at least two lines
   3 |  pragma solidity 0.8.20;
   5 |  import {ZkSyncStateTransitionBase} from "./ZkSyncStateTransitionBase.sol";
```
GitHub: [3-5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L3-L5)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

     |  // @audit-issue Separate top-level declarations with at least two lines
   3 |  pragma solidity 0.8.20;
   5 |  import {Math} from "@openzeppelin/contracts/utils/math/Math.sol";
```
GitHub: [3-5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L3-L5)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol

     |  // @audit-issue Separate top-level declarations with at least two lines
   3 |  pragma solidity 0.8.20;
   5 |  import {ZkSyncStateTransitionStorage} from "../ZkSyncStateTransitionStorage.sol";
```
GitHub: [3-5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L3-L5)


```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol

     |  // @audit-issue Separate top-level declarations with at least two lines
   3 |  pragma solidity 0.8.20;
   5 |  import {ZkSyncStateTransitionBase} from "../state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol";
```
GitHub: [3-5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L3-L5)


```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol

     |  // @audit-issue Separate top-level declarations with at least two lines
   3 |  pragma solidity 0.8.20;
   5 |  import "../state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol";
```
GitHub: [3-5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L3-L5)


```solidity
File: code/contracts/ethereum/contracts/upgrades/DefaultUpgrade.sol

     |  // @audit-issue Separate top-level declarations with at least two lines
   3 |  pragma solidity 0.8.20;
   5 |  import {Diamond} from "../state-transition/libraries/Diamond.sol";
```
GitHub: [3-5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/DefaultUpgrade.sol#L3-L5)


```solidity
File: code/contracts/ethereum/contracts/upgrades/GenesisUpgrade.sol

     |  // @audit-issue Separate top-level declarations with at least two lines
   3 |  pragma solidity 0.8.20;
   5 |  import "../state-transition/libraries/Diamond.sol";
```
GitHub: [3-5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/GenesisUpgrade.sol#L3-L5)


```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol

     |  // @audit-issue Separate top-level declarations with at least two lines
   3 |  pragma solidity 0.8.20;
   5 |  import {SafeCast} from "@openzeppelin/contracts/utils/math/SafeCast.sol";
```
GitHub: [3-5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L3-L5)


```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol

     |  // @audit-issue Separate top-level declarations with at least two lines
   3 |  pragma solidity 0.8.20;
   5 |  import {UncheckedMath} from "../../common/libraries/UncheckedMath.sol";
```
GitHub: [3-5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol#L3-L5)


```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol

     |  // @audit-issue Separate top-level declarations with at least two lines
   3 |  pragma solidity 0.8.20;
   5 |  import {Math} from "@openzeppelin/contracts/utils/math/Math.sol";
```
GitHub: [3-5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L3-L5)


```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol

     |  // @audit-issue Separate top-level declarations with at least two lines
   3 |  pragma solidity 0.8.20;
   5 |  import "./IL1SharedBridge.sol";
```
GitHub: [3-5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L3-L5)


```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol

     |  // @audit-issue Separate top-level declarations with at least two lines
   3 |  pragma solidity 0.8.20;
   5 |  import {L2TransactionRequestTwoBridgesInner} from "../../bridgehub/IBridgehub.sol";
```
GitHub: [3-5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L3-L5)


```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IWETH9.sol

     |  // @audit-issue Separate top-level declarations with at least two lines
   2 |  pragma solidity 0.8.20;
   4 |  interface IWETH9 {
```
GitHub: [2-4](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IWETH9.sol#L2-L4)


```solidity
File: code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol

     |  // @audit-issue Separate top-level declarations with at least two lines
   3 |  pragma solidity 0.8.20;
   5 |  import {IL1SharedBridge} from "../bridge/interfaces/IL1SharedBridge.sol";

     |  // @audit-issue Separate top-level declarations with at least two lines
   8 |  import "../state-transition/libraries/Diamond.sol";
  10 |  struct L2TransactionRequestDirect {

     |  // @audit-issue Separate top-level declarations with at least two lines
  20 |  }
  22 |  struct L2TransactionRequestTwoBridgesOuter {

     |  // @audit-issue Separate top-level declarations with at least two lines
  32 |  }
  34 |  struct L2TransactionRequestTwoBridgesInner {

     |  // @audit-issue Separate top-level declarations with at least two lines
  40 |  }
  42 |  interface IBridgehub {
```
GitHub: [3-5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L3-L5), [8-10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L8-L10), [20-22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L20-L22), [32-34](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L32-L34), [40-42](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L40-L42)


```solidity
File: code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol

     |  // @audit-issue Separate top-level declarations with at least two lines
   3 |  pragma solidity 0.8.20;
   5 |  import {Diamond} from "./libraries/Diamond.sol";

     |  // @audit-issue Separate top-level declarations with at least two lines
  24 |  }
  26 |  interface IStateTransitionManager {
```
GitHub: [3-5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L3-L5), [24-26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L24-L26)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol

     |  // @audit-issue Separate top-level declarations with at least two lines
   3 |  pragma solidity 0.8.20;
   5 |  import {IZkSyncStateTransitionBase} from "../chain-interfaces/IZkSyncStateTransitionBase.sol";
```
GitHub: [3-5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L3-L5)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol

     |  // @audit-issue Separate top-level declarations with at least two lines
   3 |  pragma solidity 0.8.20;
   5 |  import {L2CanonicalTransaction} from "../../common/Messaging.sol";

     |  // @audit-issue Separate top-level declarations with at least two lines
  59 |  }
  61 |  interface IDiamondInit {
```
GitHub: [3-5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol#L3-L5), [59-61](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol#L59-L61)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol

     |  // @audit-issue Separate top-level declarations with at least two lines
   3 |  pragma solidity 0.8.20;
   5 |  import {IZkSyncStateTransitionBase} from "./IZkSyncStateTransitionBase.sol";

     |  // @audit-issue Separate top-level declarations with at least two lines
  25 |  }
  27 |  struct LogProcessingOutput {
```
GitHub: [3-5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L3-L5), [25-27](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L25-L27)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol

     |  // @audit-issue Separate top-level declarations with at least two lines
   3 |  pragma solidity 0.8.20;
   5 |  import {PriorityOperation} from "../libraries/PriorityQueue.sol";
```
GitHub: [3-5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L3-L5)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/ILegacyGetters.sol

     |  // @audit-issue Separate top-level declarations with at least two lines
   3 |  pragma solidity 0.8.20;
   5 |  import {IZkSyncStateTransitionBase} from "./IZkSyncStateTransitionBase.sol";
```
GitHub: [3-5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/ILegacyGetters.sol#L3-L5)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol

     |  // @audit-issue Separate top-level declarations with at least two lines
   3 |  pragma solidity 0.8.20;
   5 |  import {IZkSyncStateTransitionBase} from "./IZkSyncStateTransitionBase.sol";
```
GitHub: [3-5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L3-L5)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol

     |  // @audit-issue Separate top-level declarations with at least two lines
   3 |  pragma solidity 0.8.20;
   5 |  import {IAdmin} from "./IAdmin.sol";

     |  // @audit-issue Separate top-level declarations with at least two lines
  13 |  import "../libraries/Diamond.sol";
  15 |  interface IZkSyncStateTransition is IAdmin, IExecutor, IGetters, IMailbox {
```
GitHub: [3-5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol#L3-L5), [13-15](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol#L13-L15)


```solidity
File: code/contracts/ethereum/contracts/upgrades/IDefaultUpgrade.sol

     |  // @audit-issue Separate top-level declarations with at least two lines
   3 |  pragma solidity 0.8.20;
   5 |  import {ProposedUpgrade} from "./BaseZkSyncUpgrade.sol";

     |  // @audit-issue Separate top-level declarations with at least two lines
   5 |  import {ProposedUpgrade} from "./BaseZkSyncUpgrade.sol";
   7 |  interface IDefaultUpgrade {
```
GitHub: [3-5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/IDefaultUpgrade.sol#L3-L5), [5-7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/IDefaultUpgrade.sol#L5-L7)


```solidity
File: code/contracts/ethereum/contracts/common/Config.sol

     |  // @audit-issue Separate top-level declarations with at least two lines
 101 |  uint256 constant MEMORY_OVERHEAD_GAS = 10;
 103 |  address constant ETH_TOKEN_ADDRESS = address(1);

     |  // @audit-issue Separate top-level declarations with at least two lines
 112 |  address constant ERA_DIAMOND_PROXY = 0x77AE03789270Ad12d3d47FCAf7234241FceeC532;
 114 |  bytes32 constant TWO_BRIDGES_MAGIC_VALUE = bytes32(uint256(keccak256("TWO_BRIDGES_MAGIC_VALUE")) - 1);
```
GitHub: [101-103](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/Config.sol#L101-L103), [112-114](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/Config.sol#L112-L114)


```solidity
File: code/contracts/ethereum/contracts/common/Messaging.sol

     |  // @audit-issue Separate top-level declarations with at least two lines
 125 |  }
 127 |  struct BridgehubL2TransactionRequest {
```
GitHub: [125-127](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/Messaging.sol#L125-L127)


```solidity
File: code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol

     |  // @audit-issue Separate top-level declarations with at least two lines
  19 |  pragma solidity 0.8.20;
  21 |  library AddressAliasHelper {
```
GitHub: [19-21](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol#L19-L21)


```solidity
File: code/contracts/ethereum/contracts/state-transition/Verifier.sol

     |  // @audit-issue Separate top-level declarations with at least two lines
   3 |  pragma solidity 0.8.20;
   5 |  import "./chain-interfaces/IVerifier.sol";
```
GitHub: [3-5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L3-L5)


```solidity
File: code/contracts/ethereum/contracts/common/Dependencies.sol

     |  // @audit-issue Separate top-level declarations with at least two lines
   3 |  pragma solidity 0.8.20;
   5 |  import "@openzeppelin/contracts/proxy/transparent/TransparentUpgradeableProxy.sol";
```
GitHub: [3-5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/Dependencies.sol#L3-L5)


```solidity
File: code/contracts/ethereum/contracts/state-transition/l2-deps/ISystemContext.sol

     |  // @audit-issue Separate top-level declarations with at least two lines
   2 |  pragma solidity ^0.8.0;
   4 |  interface ISystemContext {
```
GitHub: [2-4](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/l2-deps/ISystemContext.sol#L2-L4)


```solidity
File: code/system-contracts/contracts/AccountCodeStorage.sol

     |  // @audit-issue Separate top-level declarations with at least two lines
   3 |  pragma solidity 0.8.20;
   5 |  import "./interfaces/IAccountCodeStorage.sol";
```
GitHub: [3-5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L3-L5)


```solidity
File: code/system-contracts/contracts/BootloaderUtilities.sol

     |  // @audit-issue Separate top-level declarations with at least two lines
   3 |  pragma solidity 0.8.20;
   5 |  import {IBootloaderUtilities} from "./interfaces/IBootloaderUtilities.sol";
```
GitHub: [3-5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L3-L5)


```solidity
File: code/system-contracts/contracts/ComplexUpgrader.sol

     |  // @audit-issue Separate top-level declarations with at least two lines
   3 |  pragma solidity 0.8.20;
   5 |  import {IComplexUpgrader} from "./interfaces/IComplexUpgrader.sol";
```
GitHub: [3-5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ComplexUpgrader.sol#L3-L5)


```solidity
File: code/system-contracts/contracts/Compressor.sol

     |  // @audit-issue Separate top-level declarations with at least two lines
   3 |  pragma solidity 0.8.20;
   5 |  import {ICompressor, OPERATION_BITMASK, LENGTH_BITS_OFFSET, MAX_ENUMERATION_INDEX_SIZE} from "./interfaces/ICompressor.sol";
```
GitHub: [3-5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L3-L5)


```solidity
File: code/system-contracts/contracts/Constants.sol

     |  // @audit-issue Separate top-level declarations with at least two lines
   3 |  pragma solidity 0.8.20;
   5 |  import {IAccountCodeStorage} from "./interfaces/IAccountCodeStorage.sol";

     |  // @audit-issue Separate top-level declarations with at least two lines
  29 |  uint160 constant MAX_SYSTEM_CONTRACT_ADDRESS = 0xffff; // 2^16 - 1
  31 |  address constant ECRECOVER_SYSTEM_CONTRACT = address(0x01);

     |  // @audit-issue Separate top-level declarations with at least two lines
  31 |  address constant ECRECOVER_SYSTEM_CONTRACT = address(0x01);
  32 |  address constant SHA256_SYSTEM_CONTRACT = address(0x02);

     |  // @audit-issue Separate top-level declarations with at least two lines
  32 |  address constant SHA256_SYSTEM_CONTRACT = address(0x02);
  33 |  address constant ECADD_SYSTEM_CONTRACT = address(0x06);

     |  // @audit-issue Separate top-level declarations with at least two lines
  33 |  address constant ECADD_SYSTEM_CONTRACT = address(0x06);
  34 |  address constant ECMUL_SYSTEM_CONTRACT = address(0x07);

     |  // @audit-issue Separate top-level declarations with at least two lines
  46 |  uint256 constant CURRENT_MAX_PRECOMPILE_ADDRESS = 0xff;
  48 |  address payable constant BOOTLOADER_FORMAL_ADDRESS = payable(address(SYSTEM_CONTRACTS_OFFSET + 0x01));

     |  // @audit-issue Separate top-level declarations with at least two lines
  48 |  address payable constant BOOTLOADER_FORMAL_ADDRESS = payable(address(SYSTEM_CONTRACTS_OFFSET + 0x01));
  49 |  IAccountCodeStorage constant ACCOUNT_CODE_STORAGE_SYSTEM_CONTRACT = IAccountCodeStorage(

     |  // @audit-issue Separate top-level declarations with at least two lines
  51 |  );
  52 |  INonceHolder constant NONCE_HOLDER_SYSTEM_CONTRACT = INonceHolder(address(SYSTEM_CONTRACTS_OFFSET + 0x03));

     |  // @audit-issue Separate top-level declarations with at least two lines
  52 |  INonceHolder constant NONCE_HOLDER_SYSTEM_CONTRACT = INonceHolder(address(SYSTEM_CONTRACTS_OFFSET + 0x03));
  53 |  IKnownCodesStorage constant KNOWN_CODE_STORAGE_CONTRACT = IKnownCodesStorage(address(SYSTEM_CONTRACTS_OFFSET + 0x04));

     |  // @audit-issue Separate top-level declarations with at least two lines
  53 |  IKnownCodesStorage constant KNOWN_CODE_STORAGE_CONTRACT = IKnownCodesStorage(address(SYSTEM_CONTRACTS_OFFSET + 0x04));
  54 |  IImmutableSimulator constant IMMUTABLE_SIMULATOR_SYSTEM_CONTRACT = IImmutableSimulator(

     |  // @audit-issue Separate top-level declarations with at least two lines
  56 |  );
  57 |  IContractDeployer constant DEPLOYER_SYSTEM_CONTRACT = IContractDeployer(address(SYSTEM_CONTRACTS_OFFSET + 0x06));

     |  // @audit-issue Separate top-level declarations with at least two lines
  61 |  address constant FORCE_DEPLOYER = address(SYSTEM_CONTRACTS_OFFSET + 0x07);
  62 |  IL1Messenger constant L1_MESSENGER_CONTRACT = IL1Messenger(address(SYSTEM_CONTRACTS_OFFSET + 0x08));

     |  // @audit-issue Separate top-level declarations with at least two lines
  62 |  IL1Messenger constant L1_MESSENGER_CONTRACT = IL1Messenger(address(SYSTEM_CONTRACTS_OFFSET + 0x08));
  63 |  address constant MSG_VALUE_SYSTEM_CONTRACT = address(SYSTEM_CONTRACTS_OFFSET + 0x09);

     |  // @audit-issue Separate top-level declarations with at least two lines
  63 |  address constant MSG_VALUE_SYSTEM_CONTRACT = address(SYSTEM_CONTRACTS_OFFSET + 0x09);
  65 |  IBaseToken constant BASE_TOKEN_SYSTEM_CONTRACT = IBaseToken(address(SYSTEM_CONTRACTS_OFFSET + 0x0a));

     |  // @audit-issue Separate top-level declarations with at least two lines
  65 |  IBaseToken constant BASE_TOKEN_SYSTEM_CONTRACT = IBaseToken(address(SYSTEM_CONTRACTS_OFFSET + 0x0a));
  66 |  IBaseToken constant REAL_BASE_TOKEN_SYSTEM_CONTRACT = IBaseToken(address(REAL_SYSTEM_CONTRACTS_OFFSET + 0x0a));

     |  // @audit-issue Separate top-level declarations with at least two lines
  71 |  address constant KECCAK256_SYSTEM_CONTRACT = address(0x8010);
  73 |  ISystemContext constant SYSTEM_CONTEXT_CONTRACT = ISystemContext(payable(address(SYSTEM_CONTRACTS_OFFSET + 0x0b)));

     |  // @audit-issue Separate top-level declarations with at least two lines
  73 |  ISystemContext constant SYSTEM_CONTEXT_CONTRACT = ISystemContext(payable(address(SYSTEM_CONTRACTS_OFFSET + 0x0b)));
  74 |  ISystemContext constant REAL_SYSTEM_CONTEXT_CONTRACT = ISystemContext(payable(address(REAL_SYSTEM_CONTRACTS_OFFSET + 0x0b)));

     |  // @audit-issue Separate top-level declarations with at least two lines
  74 |  ISystemContext constant REAL_SYSTEM_CONTEXT_CONTRACT = ISystemContext(payable(address(REAL_SYSTEM_CONTRACTS_OFFSET + 0x0b)));
  76 |  IBootloaderUtilities constant BOOTLOADER_UTILITIES = IBootloaderUtilities(address(SYSTEM_CONTRACTS_OFFSET + 0x0c));

     |  // @audit-issue Separate top-level declarations with at least two lines
  79 |  address constant EVENT_WRITER_CONTRACT = address(SYSTEM_CONTRACTS_OFFSET + 0x0d);
  81 |  ICompressor constant COMPRESSOR_CONTRACT = ICompressor(address(SYSTEM_CONTRACTS_OFFSET + 0x0e));

     |  // @audit-issue Separate top-level declarations with at least two lines
  81 |  ICompressor constant COMPRESSOR_CONTRACT = ICompressor(address(SYSTEM_CONTRACTS_OFFSET + 0x0e));
  83 |  IComplexUpgrader constant COMPLEX_UPGRADER_CONTRACT = IComplexUpgrader(address(SYSTEM_CONTRACTS_OFFSET + 0x0f));

     |  // @audit-issue Separate top-level declarations with at least two lines
  83 |  IComplexUpgrader constant COMPLEX_UPGRADER_CONTRACT = IComplexUpgrader(address(SYSTEM_CONTRACTS_OFFSET + 0x0f));
  85 |  IPubdataChunkPublisher constant PUBDATA_CHUNK_PUBLISHER = IPubdataChunkPublisher(

     |  // @audit-issue Separate top-level declarations with at least two lines
 108 |  uint256 constant MAX_ALLOWED_PUBDATA_PER_BATCH = 520000;
 110 |  enum SystemLogKey {

     |  // @audit-issue Separate top-level declarations with at least two lines
 128 |  uint256 constant DERIVED_KEY_LENGTH = 32;
 129 |  /// @dev The length of the enum index in bytes inside compressed state diffs.
 130 |  uint256 constant ENUM_INDEX_LENGTH = 8;

     |  // @audit-issue Separate top-level declarations with at least two lines
 130 |  uint256 constant ENUM_INDEX_LENGTH = 8;
 131 |  /// @dev The length of value in bytes inside compressed state diffs.
 132 |  uint256 constant VALUE_LENGTH = 32;

     |  // @audit-issue Separate top-level declarations with at least two lines
 135 |  uint256 constant COMPRESSED_INITIAL_WRITE_SIZE = DERIVED_KEY_LENGTH + VALUE_LENGTH;
 136 |  /// @dev The length of the compressed repeated storage write in bytes.
 137 |  uint256 constant COMPRESSED_REPEATED_WRITE_SIZE = ENUM_INDEX_LENGTH + VALUE_LENGTH;

     |  // @audit-issue Separate top-level declarations with at least two lines
 145 |  uint256 constant STATE_DIFF_DERIVED_KEY_OFFSET = 52;
 146 |  /// @dev The offset of the enum index in a storage diff.
 147 |  uint256 constant STATE_DIFF_ENUM_INDEX_OFFSET = 84;

     |  // @audit-issue Separate top-level declarations with at least two lines
 147 |  uint256 constant STATE_DIFF_ENUM_INDEX_OFFSET = 84;
 148 |  /// @dev The offset of the final value in a storage diff.
 149 |  uint256 constant STATE_DIFF_FINAL_VALUE_OFFSET = 124;
```
GitHub: [3-5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Constants.sol#L3-L5), [29-31](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Constants.sol#L29-L31), [31-32](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Constants.sol#L31-L32), [32-33](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Constants.sol#L32-L33), [33-34](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Constants.sol#L33-L34), [46-48](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Constants.sol#L46-L48), [48-49](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Constants.sol#L48-L49), [51-52](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Constants.sol#L51-L52), [52-53](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Constants.sol#L52-L53), [53-54](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Constants.sol#L53-L54), [56-57](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Constants.sol#L56-L57), [61-62](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Constants.sol#L61-L62), [62-63](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Constants.sol#L62-L63), [63-65](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Constants.sol#L63-L65), [65-66](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Constants.sol#L65-L66), [71-73](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Constants.sol#L71-L73), [73-74](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Constants.sol#L73-L74), [74-76](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Constants.sol#L74-L76), [79-81](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Constants.sol#L79-L81), [81-83](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Constants.sol#L81-L83), [83-85](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Constants.sol#L83-L85), [108-110](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Constants.sol#L108-L110), [128-130](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Constants.sol#L128-L130), [130-132](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Constants.sol#L130-L132), [135-137](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Constants.sol#L135-L137), [145-147](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Constants.sol#L145-L147), [147-149](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Constants.sol#L147-L149)


```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

     |  // @audit-issue Separate top-level declarations with at least two lines
   3 |  pragma solidity 0.8.20;
   5 |  import {ImmutableData} from "./interfaces/IImmutableSimulator.sol";
```
GitHub: [3-5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L3-L5)


```solidity
File: code/system-contracts/contracts/DefaultAccount.sol

     |  // @audit-issue Separate top-level declarations with at least two lines
   3 |  pragma solidity 0.8.20;
   5 |  import "./interfaces/IAccount.sol";
```
GitHub: [3-5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L3-L5)


```solidity
File: code/system-contracts/contracts/ImmutableSimulator.sol

     |  // @audit-issue Separate top-level declarations with at least two lines
   3 |  pragma solidity 0.8.20;
   5 |  import {IImmutableSimulator, ImmutableData} from "./interfaces/IImmutableSimulator.sol";
```
GitHub: [3-5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ImmutableSimulator.sol#L3-L5)


```solidity
File: code/system-contracts/contracts/KnownCodesStorage.sol

     |  // @audit-issue Separate top-level declarations with at least two lines
   3 |  pragma solidity 0.8.20;
   5 |  import {IKnownCodesStorage} from "./interfaces/IKnownCodesStorage.sol";
```
GitHub: [3-5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/KnownCodesStorage.sol#L3-L5)


```solidity
File: code/system-contracts/contracts/L1Messenger.sol

     |  // @audit-issue Separate top-level declarations with at least two lines
   3 |  pragma solidity 0.8.20;
   5 |  import {IL1Messenger, L2ToL1Log, L2_L1_LOGS_TREE_DEFAULT_LEAF_HASH, L2_TO_L1_LOG_SERIALIZE_SIZE, STATE_DIFF_COMPRESSION_VERSION_NUMBER} from "./interfaces/IL1Messenger.sol";
```
GitHub: [3-5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L3-L5)


```solidity
File: code/system-contracts/contracts/L2BaseToken.sol

     |  // @audit-issue Separate top-level declarations with at least two lines
   3 |  pragma solidity 0.8.20;
   5 |  import {IBaseToken} from "./interfaces/IBaseToken.sol";
```
GitHub: [3-5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L2BaseToken.sol#L3-L5)


```solidity
File: code/system-contracts/contracts/MsgValueSimulator.sol

     |  // @audit-issue Separate top-level declarations with at least two lines
   3 |  pragma solidity 0.8.20;
   5 |  import {Utils} from "./libraries/Utils.sol";
```
GitHub: [3-5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/MsgValueSimulator.sol#L3-L5)


```solidity
File: code/system-contracts/contracts/NonceHolder.sol

     |  // @audit-issue Separate top-level declarations with at least two lines
   3 |  pragma solidity 0.8.20;
   5 |  import {INonceHolder} from "./interfaces/INonceHolder.sol";
```
GitHub: [3-5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/NonceHolder.sol#L3-L5)


```solidity
File: code/system-contracts/contracts/PubdataChunkPublisher.sol

     |  // @audit-issue Separate top-level declarations with at least two lines
   2 |  pragma solidity 0.8.20;
   4 |  import {IPubdataChunkPublisher} from "./interfaces/IPubdataChunkPublisher.sol";
```
GitHub: [2-4](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/PubdataChunkPublisher.sol#L2-L4)


```solidity
File: code/system-contracts/contracts/SystemContext.sol

     |  // @audit-issue Separate top-level declarations with at least two lines
   3 |  pragma solidity 0.8.20;
   5 |  import {ISystemContext} from "./interfaces/ISystemContext.sol";
```
GitHub: [3-5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L3-L5)


```solidity
File: code/system-contracts/contracts/GasBoundCaller.sol

     |  // @audit-issue Separate top-level declarations with at least two lines
   3 |  pragma solidity 0.8.20;
   5 |  import {EfficientCall} from "./libraries/EfficientCall.sol";
```
GitHub: [3-5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/GasBoundCaller.sol#L3-L5)


```solidity
File: code/system-contracts/contracts/libraries/EfficientCall.sol

     |  // @audit-issue Separate top-level declarations with at least two lines
   3 |  pragma solidity 0.8.20;
   5 |  import "./SystemContractHelper.sol";
```
GitHub: [3-5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L3-L5)


```solidity
File: code/system-contracts/contracts/libraries/SystemContractHelper.sol

     |  // @audit-issue Separate top-level declarations with at least two lines
   3 |  pragma solidity 0.8.20;
   5 |  import {MAX_SYSTEM_CONTRACT_ADDRESS} from "../Constants.sol";

     |  // @audit-issue Separate top-level declarations with at least two lines
   7 |  import {SystemContractsCaller, CalldataForwardingMode, CALLFLAGS_CALL_ADDRESS, CODE_ADDRESS_CALL_ADDRESS, EVENT_WRITE_ADDRESS, EVENT_INITIALIZE_ADDRESS, GET_EXTRA_ABI_DATA_ADDRESS, LOAD_CALLDATA_INTO_ACTIVE_PTR_CALL_ADDRESS, META_CODE_SHARD_ID_OFFSET, META_CALLER_SHARD_ID_OFFSET, META_SHARD_ID_OFFSET, META_AUX_HEAP_SIZE_OFFSET, META_HEAP_SIZE_OFFSET, META_GAS_PER_PUBDATA_BYTE_OFFSET, MIMIC_CALL_BY_REF_CALL_ADDRESS, META_CALL_ADDRESS, MSG_VALUE_SIMULATOR_IS_SYSTEM_BIT, PTR_CALLDATA_CALL_ADDRESS, PTR_ADD_INTO_ACTIVE_CALL_ADDRESS, PTR_SHRINK_INTO_ACTIVE_CALL_ADDRESS, PTR_PACK_INTO_ACTIVE_CALL_ADDRESS, RAW_FAR_CALL_BY_REF_CALL_ADDRESS, PRECOMPILE_CALL_ADDRESS, SET_CONTEXT_VALUE_CALL_ADDRESS, SYSTEM_CALL_BY_REF_CALL_ADDRESS, TO_L1_CALL_ADDRESS} from "./SystemContractsCaller.sol";
   9 |  uint256 constant UINT32_MASK = type(uint32).max;

     |  // @audit-issue Separate top-level declarations with at least two lines
   9 |  uint256 constant UINT32_MASK = type(uint32).max;
  10 |  uint256 constant UINT64_MASK = type(uint64).max;

     |  // @audit-issue Separate top-level declarations with at least two lines
  10 |  uint256 constant UINT64_MASK = type(uint64).max;
  11 |  uint256 constant UINT128_MASK = type(uint128).max;

     |  // @audit-issue Separate top-level declarations with at least two lines
  11 |  uint256 constant UINT128_MASK = type(uint128).max;
  12 |  uint256 constant ADDRESS_MASK = type(uint160).max;

     |  // @audit-issue Separate top-level declarations with at least two lines
  22 |  }
  24 |  enum Global {
```
GitHub: [3-5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L3-L5), [7-9](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L7-L9), [9-10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L9-L10), [10-11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L10-L11), [11-12](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L11-L12), [22-24](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L22-L24)


## [N-95] Syntax: place constants on left-hand side of comparisons

When writing a comparison, it is easy to accidentally use the `=` (assignment) operator. By placing constants on the left-hand side of the expression, the compiler will produce an error when an assignment has been accidentally used, thus preventing a bug.

*Instances: 99*

```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

     |  // @audit-issue Swap left- and right-hand sides to avoid accidental assignments
 141 |  require(_amount != 0, "0T"); // empty deposit

     |  // @audit-issue Swap left- and right-hand sides to avoid accidental assignments
 186 |  require(amount != 0, "2T"); // empty deposit
```
GitHub: [141](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L141), [186](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L186)


```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

     |  // @audit-issue Swap left- and right-hand sides to avoid accidental assignments
 158 |  require(msg.value == 0, "ShB m.v > 0 b d.it");

     |  // @audit-issue Swap left- and right-hand sides to avoid accidental assignments
 200 |  require(_depositAmount == 0, "ShB wrong withdraw amount");

     |  // @audit-issue Swap left- and right-hand sides to avoid accidental assignments
 202 |  require(msg.value == 0, "ShB m.v > 0 for BH d.it 2");

     |  // @audit-issue Swap left- and right-hand sides to avoid accidental assignments
 208 |  require(amount != 0, "6T"); // empty deposit amount

     |  // @audit-issue Swap left- and right-hand sides to avoid accidental assignments
 237 |  require(depositHappened[_chainId][_txHash] == 0x00, "ShB tx hap");

     |  // @audit-issue Swap left- and right-hand sides to avoid accidental assignments
 501 |  require(_l2ToL1message.length >= 56, "ShB wrong msg len"); // wrong messsage length

     |  // @audit-issue Swap left- and right-hand sides to avoid accidental assignments
 517 |  require(_l2ToL1message.length == 76, "ShB wrong msg len 2");
```
GitHub: [158](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L158), [200](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L200), [202](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L202), [208](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L208), [237](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L237), [501](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L501), [517](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L517)


```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

     |  // @audit-issue Swap left- and right-hand sides to avoid accidental assignments
 122 |  require(_chainId != 0, "Bridgehub: chainId cannot be 0");

     |  // @audit-issue Swap left- and right-hand sides to avoid accidental assignments
 225 |  require(msg.value == 0, "Bridgehub: non-eth bridge with msg.value");
```
GitHub: [122](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L122), [225](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L225)


```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

     |  // @audit-issue Swap left- and right-hand sides to avoid accidental assignments
 107 |  if (timestamp == 0) {
```
GitHub: [107](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L107)


```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

     |  // @audit-issue Swap left- and right-hand sides to avoid accidental assignments
  68 |  require(validators[_chainId][msg.sender] == true, "ValidatorTimelock: only validator");
```
GitHub: [68](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L68)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol

     |  // @audit-issue Swap left- and right-hand sides to avoid accidental assignments
  25 |  require(msg.data.length >= 4 || msg.data.length == 0, "Ut");

     |  // @audit-issue Swap left- and right-hand sides to avoid accidental assignments
  25 |  require(msg.data.length >= 4 || msg.data.length == 0, "Ut");
```
GitHub: [25](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol#L25), [25](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol#L25)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol

     |  // @audit-issue Swap left- and right-hand sides to avoid accidental assignments
  90 |  require(s.totalBatchesCommitted == 0, "AdminFacet: set validium only after genesis"); // Validium mode can be set only before the first batch is committed
```
GitHub: [90](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L90)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

     |  // @audit-issue Swap left- and right-hand sides to avoid accidental assignments
  50 |  require(logOutput.pubdataHash == 0x00, "v0h");

     |  // @audit-issue Swap left- and right-hand sides to avoid accidental assignments
  51 |  require(_newBatch.pubdataCommitments.length == 1);

     |  // @audit-issue Swap left- and right-hand sides to avoid accidental assignments
 192 |  require(processedLogs == 511, "b7");

     |  // @audit-issue Swap left- and right-hand sides to avoid accidental assignments
 194 |  require(processedLogs == 1023, "b8");

     |  // @audit-issue Swap left- and right-hand sides to avoid accidental assignments
 231 |  require(_newBatchesData.length == 1, "e4");

     |  // @audit-issue Swap left- and right-hand sides to avoid accidental assignments
 237 |  if (systemContractsUpgradeTxHash == bytes32(0) || s.l2SystemContractsUpgradeBatchNumber != 0) {

     |  // @audit-issue Swap left- and right-hand sides to avoid accidental assignments
 284 |  require(s.l2SystemContractsUpgradeBatchNumber == 0, "ik");

     |  // @audit-issue Swap left- and right-hand sides to avoid accidental assignments
 291 |  bytes32 expectedUpgradeTxHash = i == 0 ? _systemContractUpgradeTxHash : bytes32(0);

     |  // @audit-issue Swap left- and right-hand sides to avoid accidental assignments
 361 |  if (batchWhenUpgradeHappened != 0 && batchWhenUpgradeHappened <= newTotalBatchesExecuted) {

     |  // @audit-issue Swap left- and right-hand sides to avoid accidental assignments
 426 |  assert(block.chainid != 1);

     |  // @audit-issue Swap left- and right-hand sides to avoid accidental assignments
 442 |  require(proofPublicInput.length == 1, "t4");

     |  // @audit-issue Swap left- and right-hand sides to avoid accidental assignments
 633 |  require(_pubdataCommitments.length % PUBDATA_COMMITMENT_SIZE == 0, "bs");
```
GitHub: [50](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L50), [51](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L51), [192](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L192), [194](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L194), [231](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L231), [237](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L237), [284](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L284), [291](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L291), [361](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L361), [426](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L426), [442](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L442), [633](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L633)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol

     |  // @audit-issue Swap left- and right-hand sides to avoid accidental assignments
 169 |  if (selectorsArrayLen != 0) {
```
GitHub: [169](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L169)


```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol

     |  // @audit-issue Swap left- and right-hand sides to avoid accidental assignments
 186 |  if (_l2ProtocolUpgradeTx.txType == 0) {

     |  // @audit-issue Swap left- and right-hand sides to avoid accidental assignments
 251 |  s.l2SystemContractsUpgradeBatchNumber == 0,
```
GitHub: [186](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L186), [251](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L251)


```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol

     |  // @audit-issue Swap left- and right-hand sides to avoid accidental assignments
  35 |  s.l2SystemContractsUpgradeBatchNumber == 0,
```
GitHub: [35](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L35)


```solidity
File: code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol

     |  // @audit-issue Swap left- and right-hand sides to avoid accidental assignments
  23 |  require(_bytecode.length % 32 == 0, "pq");

     |  // @audit-issue Swap left- and right-hand sides to avoid accidental assignments
  27 |  require(bytecodeLenInWords % 2 == 1, "ps"); // bytecode length in words must be odd

     |  // @audit-issue Swap left- and right-hand sides to avoid accidental assignments
  41 |  require(version == 1 && _bytecodeHash[1] == bytes1(0), "zf"); // Incorrectly formatted bytecodeHash

     |  // @audit-issue Swap left- and right-hand sides to avoid accidental assignments
  43 |  require(bytecodeLen(_bytecodeHash) % 2 == 1, "uy"); // Code length in words must be odd
```
GitHub: [23](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L23), [27](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L27), [41](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L41), [43](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L43)


```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol

     |  // @audit-issue Swap left- and right-hand sides to avoid accidental assignments
 194 |  if (selectorsLength == 0) {

     |  // @audit-issue Swap left- and right-hand sides to avoid accidental assignments
 213 |  if (selectorPosition != 0) {

     |  // @audit-issue Swap left- and right-hand sides to avoid accidental assignments
 250 |  if (lastSelectorPosition == 0) {

     |  // @audit-issue Swap left- and right-hand sides to avoid accidental assignments
 280 |  require(_calldata.length == 0, "H"); // Non-empty calldata for zero address

     |  // @audit-issue Swap left- and right-hand sides to avoid accidental assignments
 286 |  if (data.length <= 4) {

     |  // @audit-issue Swap left- and right-hand sides to avoid accidental assignments
 297 |  require(data.length == 32, "lp");
```
GitHub: [194](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L194), [213](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L213), [250](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L250), [280](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L280), [286](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L286), [297](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L297)


```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol

     |  // @audit-issue Swap left- and right-hand sides to avoid accidental assignments
  30 |  currentHash = (_index % 2 == 0)
```
GitHub: [30](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol#L30)


```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol

     |  // @audit-issue Swap left- and right-hand sides to avoid accidental assignments
  50 |  require(_transaction.paymaster == 0, "uc");

     |  // @audit-issue Swap left- and right-hand sides to avoid accidental assignments
  51 |  require(_transaction.value == 0, "ud");

     |  // @audit-issue Swap left- and right-hand sides to avoid accidental assignments
  52 |  require(_transaction.maxFeePerGas == 0, "uq");

     |  // @audit-issue Swap left- and right-hand sides to avoid accidental assignments
  53 |  require(_transaction.maxPriorityFeePerGas == 0, "ux");

     |  // @audit-issue Swap left- and right-hand sides to avoid accidental assignments
  54 |  require(_transaction.reserved[0] == 0, "ue");

     |  // @audit-issue Swap left- and right-hand sides to avoid accidental assignments
  56 |  require(_transaction.reserved[2] == 0, "ug");

     |  // @audit-issue Swap left- and right-hand sides to avoid accidental assignments
  57 |  require(_transaction.reserved[3] == 0, "uo");

     |  // @audit-issue Swap left- and right-hand sides to avoid accidental assignments
  58 |  require(_transaction.signature.length == 0, "uh");

     |  // @audit-issue Swap left- and right-hand sides to avoid accidental assignments
  59 |  require(_transaction.paymasterInput.length == 0, "ul1");

     |  // @audit-issue Swap left- and right-hand sides to avoid accidental assignments
  60 |  require(_transaction.reservedDynamic.length == 0, "um");
```
GitHub: [50](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L50), [51](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L51), [52](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L52), [53](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L53), [54](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L54), [56](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L56), [57](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L57), [58](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L58), [59](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L59), [60](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L60)


```solidity
File: code/contracts/ethereum/contracts/common/ReentrancyGuard.sol

     |  // @audit-issue Swap left- and right-hand sides to avoid accidental assignments
  58 |  require(lockSlotOldValue == 0, "1B");
```
GitHub: [58](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/ReentrancyGuard.sol#L58)


```solidity
File: code/system-contracts/contracts/AccountCodeStorage.sol

     |  // @audit-issue Swap left- and right-hand sides to avoid accidental assignments
 102 |  if (codeHash == 0x00 && NONCE_HOLDER_SYSTEM_CONTRACT.getRawNonce(account) > 0) {

     |  // @audit-issue Swap left- and right-hand sides to avoid accidental assignments
 133 |  codeHash != 0x00 &&
```
GitHub: [102](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L102), [133](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L133)


```solidity
File: code/system-contracts/contracts/BootloaderUtilities.sol

     |  // @audit-issue Swap left- and right-hand sides to avoid accidental assignments
  69 |  if (txDataLen != 1) {

     |  // @audit-issue Swap left- and right-hand sides to avoid accidental assignments
  72 |  } else if (_transaction.data[0] >= 0x80) {

     |  // @audit-issue Swap left- and right-hand sides to avoid accidental assignments
  92 |  require(vInt == 27 || vInt == 28, "Invalid v value");

     |  // @audit-issue Swap left- and right-hand sides to avoid accidental assignments
  92 |  require(vInt == 27 || vInt == 28, "Invalid v value");

     |  // @audit-issue Swap left- and right-hand sides to avoid accidental assignments
  96 |  if (_transaction.reserved[0] != 0) {

     |  // @audit-issue Swap left- and right-hand sides to avoid accidental assignments
 165 |  if (txDataLen != 1) {

     |  // @audit-issue Swap left- and right-hand sides to avoid accidental assignments
 168 |  } else if (_transaction.data[0] >= 0x80) {

     |  // @audit-issue Swap left- and right-hand sides to avoid accidental assignments
 191 |  require(vInt == 27 || vInt == 28, "Invalid v value");

     |  // @audit-issue Swap left- and right-hand sides to avoid accidental assignments
 191 |  require(vInt == 27 || vInt == 28, "Invalid v value");

     |  // @audit-issue Swap left- and right-hand sides to avoid accidental assignments
 260 |  if (txDataLen != 1) {

     |  // @audit-issue Swap left- and right-hand sides to avoid accidental assignments
 263 |  } else if (_transaction.data[0] >= 0x80) {

     |  // @audit-issue Swap left- and right-hand sides to avoid accidental assignments
 286 |  require(vInt == 27 || vInt == 28, "Invalid v value");

     |  // @audit-issue Swap left- and right-hand sides to avoid accidental assignments
 286 |  require(vInt == 27 || vInt == 28, "Invalid v value");
```
GitHub: [69](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L69), [72](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L72), [92](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L92), [92](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L92), [96](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L96), [165](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L165), [168](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L168), [191](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L191), [191](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L191), [260](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L260), [263](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L263), [286](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L286), [286](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L286)


```solidity
File: code/system-contracts/contracts/Compressor.sol

     |  // @audit-issue Swap left- and right-hand sides to avoid accidental assignments
 130 |  if (enumIndex != 0) {

     |  // @audit-issue Swap left- and right-hand sides to avoid accidental assignments
 146 |  uint8 len = operation == 0 ? 32 : metadata >> LENGTH_BITS_OFFSET;

     |  // @audit-issue Swap left- and right-hand sides to avoid accidental assignments
 162 |  if (enumIndex == 0) {

     |  // @audit-issue Swap left- and right-hand sides to avoid accidental assignments
 177 |  uint8 len = operation == 0 ? 32 : metadata >> LENGTH_BITS_OFFSET;

     |  // @audit-issue Swap left- and right-hand sides to avoid accidental assignments
 229 |  if (_operation == 0 || _operation == 3) {

     |  // @audit-issue Swap left- and right-hand sides to avoid accidental assignments
 229 |  if (_operation == 0 || _operation == 3) {

     |  // @audit-issue Swap left- and right-hand sides to avoid accidental assignments
 231 |  } else if (_operation == 1) {

     |  // @audit-issue Swap left- and right-hand sides to avoid accidental assignments
 236 |  } else if (_operation == 2) {
```
GitHub: [130](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L130), [146](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L146), [162](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L162), [177](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L177), [229](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L229), [229](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L229), [231](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L231), [236](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L236)


```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

     |  // @audit-issue Swap left- and right-hand sides to avoid accidental assignments
  49 |  ACCOUNT_CODE_STORAGE_SYSTEM_CONTRACT.getRawCodeHash(_address) == 0

     |  // @audit-issue Swap left- and right-hand sides to avoid accidental assignments
 269 |  ACCOUNT_CODE_STORAGE_SYSTEM_CONTRACT.getCodeHash(uint256(uint160(_newAddress))) == 0x0,

     |  // @audit-issue Swap left- and right-hand sides to avoid accidental assignments
 273 |  require(NONCE_HOLDER_SYSTEM_CONTRACT.getRawNonce(_newAddress) == 0x00, "Account is occupied");

     |  // @audit-issue Swap left- and right-hand sides to avoid accidental assignments
 350 |  require(value == 0, "The value must be zero if we do not call the constructor");
```
GitHub: [49](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L49), [269](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L269), [273](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L273), [350](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L350)


```solidity
File: code/system-contracts/contracts/DefaultAccount.sol

     |  // @audit-issue Swap left- and right-hand sides to avoid accidental assignments
 139 |  if (to == address(DEPLOYER_SYSTEM_CONTRACT) && data.length >= 4) {

     |  // @audit-issue Swap left- and right-hand sides to avoid accidental assignments
 160 |  require(_signature.length == 65, "Signature length is incorrect");

     |  // @audit-issue Swap left- and right-hand sides to avoid accidental assignments
 173 |  require(v == 27 || v == 28, "v is neither 27 nor 28");

     |  // @audit-issue Swap left- and right-hand sides to avoid accidental assignments
 173 |  require(v == 27 || v == 28, "v is neither 27 nor 28");

     |  // @audit-issue Swap left- and right-hand sides to avoid accidental assignments
 184 |  require(uint256(s) <= 0x7FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF5D576E7357A4501DDFE92F46681B20A0, "Invalid s");
```
GitHub: [139](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L139), [160](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L160), [173](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L173), [173](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L173), [184](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L184)


```solidity
File: code/system-contracts/contracts/KnownCodesStorage.sol

     |  // @audit-issue Swap left- and right-hand sides to avoid accidental assignments
  47 |  if (getMarker(_bytecodeHash) == 0) {

     |  // @audit-issue Swap left- and right-hand sides to avoid accidental assignments
  76 |  require(version == 1 && _bytecodeHash[1] == bytes1(0), "Incorrectly formatted bytecodeHash");

     |  // @audit-issue Swap left- and right-hand sides to avoid accidental assignments
  78 |  require(Utils.bytecodeLenInWords(_bytecodeHash) % 2 == 1, "Code length in words must be odd");
```
GitHub: [47](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/KnownCodesStorage.sol#L47), [76](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/KnownCodesStorage.sol#L76), [78](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/KnownCodesStorage.sol#L78)


```solidity
File: code/system-contracts/contracts/MsgValueSimulator.sol

     |  // @audit-issue Swap left- and right-hand sides to avoid accidental assignments
  30 |  isSystemCall = (mask & MSG_VALUE_SIMULATOR_IS_SYSTEM_BIT) != 0;

     |  // @audit-issue Swap left- and right-hand sides to avoid accidental assignments
  62 |  if (value != 0) {
```
GitHub: [30](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/MsgValueSimulator.sol#L30), [62](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/MsgValueSimulator.sol#L62)


```solidity
File: code/system-contracts/contracts/NonceHolder.sol

     |  // @audit-issue Swap left- and right-hand sides to avoid accidental assignments
  85 |  require(_value != 0, "Nonce value cannot be set to 0");

     |  // @audit-issue Swap left- and right-hand sides to avoid accidental assignments
  88 |  if (accountInfo.nonceOrdering == IContractDeployer.AccountNonceOrdering.Sequential && _key != 0) {
```
GitHub: [85](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/NonceHolder.sol#L85), [88](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/NonceHolder.sol#L88)


```solidity
File: code/system-contracts/contracts/SystemContext.sol

     |  // @audit-issue Swap left- and right-hand sides to avoid accidental assignments
 268 |  if (virtualBlockUpgradeInfo.virtualBlockFinishL2Block != 0) {

     |  // @audit-issue Swap left- and right-hand sides to avoid accidental assignments
 277 |  if (currentVirtualL2BlockInfo.number == 0 && virtualBlockInfo.timestamp == 0) {

     |  // @audit-issue Swap left- and right-hand sides to avoid accidental assignments
 277 |  if (currentVirtualL2BlockInfo.number == 0 && virtualBlockInfo.timestamp == 0) {

     |  // @audit-issue Swap left- and right-hand sides to avoid accidental assignments
 289 |  } else if (_maxVirtualBlocksToCreate == 0) {

     |  // @audit-issue Swap left- and right-hand sides to avoid accidental assignments
 360 |  if (currentL2BlockNumber == 0 && currentL2BlockTimestamp == 0) {

     |  // @audit-issue Swap left- and right-hand sides to avoid accidental assignments
 360 |  if (currentL2BlockNumber == 0 && currentL2BlockTimestamp == 0) {
```
GitHub: [268](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L268), [277](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L277), [277](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L277), [289](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L289), [360](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L360), [360](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L360)


## [N-96] Syntax: unnecessary `override`

Starting with Solidity version [0.8.8](https://docs.soliditylang.org/en/v0.8.20/contracts.html#function-overriding), using the `override` keyword when the function solely overrides an interface function, and the function doesn't exist in multiple base contracts, is unnecessary.

*Instances: 63*

```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

     |  // @audit-issue Remove `override`
 182 |  function bridgehubDeposit(
 183 |      uint256 _chainId,
 184 |      address _prevMsgSender,
 185 |      uint256, // l2Value, needed for Weth deposits in the future
 186 |      bytes calldata _data
 187 |  ) external payable override onlyBridgehub returns (L2TransactionRequestTwoBridgesInner memory request) {

     |  // @audit-issue Remove `override`
 232 |  function bridgehubConfirmL2Transaction(
 233 |      uint256 _chainId,
 234 |      bytes32 _txDataHash,
 235 |      bytes32 _txHash
 236 |  ) external override onlyBridgehub {

     |  // @audit-issue Remove `override`
 277 |  function claimFailedDeposit(
 278 |      uint256 _chainId,
 279 |      address _depositSender,
 280 |      address _l1Token,
 281 |      uint256 _amount,
 282 |      bytes32 _l2TxHash,
 283 |      uint256 _l2BatchNumber,
 284 |      uint256 _l2MessageIndex,
 285 |      uint16 _l2TxNumberInBatch,
 286 |      bytes32[] calldata _merkleProof
 287 |  ) external override {

     |  // @audit-issue Remove `override`
 385 |  function finalizeWithdrawal(
 386 |      uint256 _chainId,
 387 |      uint256 _l2BatchNumber,
 388 |      uint256 _l2MessageIndex,
 389 |      uint16 _l2TxNumberInBatch,
 390 |      bytes calldata _message,
 391 |      bytes32[] calldata _merkleProof
 392 |  ) external override {

     |  // @audit-issue Remove `override`
 554 |  function depositLegacyErc20Bridge(
 555 |      address _prevMsgSender,
 556 |      address _l2Receiver,
 557 |      address _l1Token,
 558 |      uint256 _amount,
 559 |      uint256 _l2TxGasLimit,
 560 |      uint256 _l2TxGasPerPubdataByte,
 561 |      address _refundRecipient
 562 |  ) external payable override onlyLegacyBridge nonReentrant returns (bytes32 l2TxHash) {

     |  // @audit-issue Remove `override`
 615 |  function finalizeWithdrawalLegacyErc20Bridge(
 616 |      uint256 _l2BatchNumber,
 617 |      uint256 _l2MessageIndex,
 618 |      uint16 _l2TxNumberInBatch,
 619 |      bytes calldata _message,
 620 |      bytes32[] calldata _merkleProof
 621 |  ) external override onlyLegacyBridge returns (address l1Receiver, address l1Token, uint256 amount) {

     |  // @audit-issue Remove `override`
 644 |  function claimFailedDepositLegacyErc20Bridge(
 645 |      address _depositSender,
 646 |      address _l1Token,
 647 |      uint256 _amount,
 648 |      bytes32 _l2TxHash,
 649 |      uint256 _l2BatchNumber,
 650 |      uint256 _l2MessageIndex,
 651 |      uint16 _l2TxNumberInBatch,
 652 |      bytes32[] calldata _merkleProof
 653 |  ) external override onlyLegacyBridge {
```
GitHub: [182-187](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L182-L187), [232-236](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L232-L236), [277-287](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L277-L287), [385-392](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L385-L392), [554-562](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L554-L562), [615-621](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L615-L621), [644-653](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L644-L653)


```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

     |  // @audit-issue Remove `override`
 152 |  function proveL2MessageInclusion(
 153 |      uint256 _chainId,
 154 |      uint256 _batchNumber,
 155 |      uint256 _index,
 156 |      L2Message calldata _message,
 157 |      bytes32[] calldata _proof
 158 |  ) external view override returns (bool) {

     |  // @audit-issue Remove `override`
 164 |  function proveL2LogInclusion(
 165 |      uint256 _chainId,
 166 |      uint256 _batchNumber,
 167 |      uint256 _index,
 168 |      L2Log memory _log,
 169 |      bytes32[] calldata _proof
 170 |  ) external view override returns (bool) {

     |  // @audit-issue Remove `override`
 176 |  function proveL1ToL2TransactionStatus(
 177 |      uint256 _chainId,
 178 |      bytes32 _l2TxHash,
 179 |      uint256 _l2BatchNumber,
 180 |      uint256 _l2MessageIndex,
 181 |      uint16 _l2TxNumberInBatch,
 182 |      bytes32[] calldata _merkleProof,
 183 |      TxStatus _status
 184 |  ) external view override returns (bool) {

     |  // @audit-issue Remove `override`
 217 |  function requestL2TransactionDirect(
 218 |      L2TransactionRequestDirect calldata _request
 219 |  ) external payable override nonReentrant returns (bytes32 canonicalTxHash) {

     |  // @audit-issue Remove `override`
 262 |  function requestL2TransactionTwoBridges(
 263 |      L2TransactionRequestTwoBridgesOuter calldata _request
 264 |  ) external payable override nonReentrant returns (bytes32 canonicalTxHash) {
```
GitHub: [152-158](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L152-L158), [164-170](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L164-L170), [176-184](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L176-L184), [217-219](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L217-L219), [262-264](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L262-L264)


```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

     |  // @audit-issue Remove `override`
  76 |  function getChainAdmin(uint256 _chainId) external view override returns (address) {
```
GitHub: [76](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L76)


```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol

     |  // @audit-issue Remove `override`
  20 |  function _setNewProtocolVersion(uint256 _newProtocolVersion) internal override {

     |  // @audit-issue Remove `override`
  47 |  function upgrade(ProposedUpgrade calldata _proposedUpgrade) public virtual override returns (bytes32) {
```
GitHub: [20](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L20), [47](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L47)


```solidity
File: code/contracts/ethereum/contracts/upgrades/DefaultUpgrade.sol

     |  // @audit-issue Remove `override`
  13 |  function upgrade(ProposedUpgrade calldata _proposedUpgrade) public override returns (bytes32) {
```
GitHub: [13](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/DefaultUpgrade.sol#L13)


```solidity
File: code/contracts/ethereum/contracts/upgrades/GenesisUpgrade.sol

     |  // @audit-issue Remove `override`
  14 |  function upgrade(ProposedUpgrade calldata _proposedUpgrade) public override returns (bytes32) {
```
GitHub: [14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/GenesisUpgrade.sol#L14)


```solidity
File: code/contracts/ethereum/contracts/upgrades/Upgrade_4844.sol

     |  // @audit-issue Remove `override`
  15 |  function upgrade(ProposedUpgrade calldata _proposedUpgrade) public override returns (bytes32) {
```
GitHub: [15](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/Upgrade_4844.sol#L15)


```solidity
File: code/contracts/ethereum/contracts/upgrades/Upgrade_v1_4_1.sol

     |  // @audit-issue Remove `override`
  33 |  function upgrade(ProposedUpgrade calldata _proposedUpgrade) public override returns (bytes32) {
```
GitHub: [33](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/Upgrade_v1_4_1.sol#L33)


```solidity
File: code/system-contracts/contracts/AccountCodeStorage.sol

     |  // @audit-issue Remove `override`
  35 |  function storeAccountConstructingCodeHash(address _address, bytes32 _hash) external override onlyDeployer {

     |  // @audit-issue Remove `override`
  46 |  function storeAccountConstructedCodeHash(address _address, bytes32 _hash) external override onlyDeployer {

     |  // @audit-issue Remove `override`
  54 |  function markAccountCodeHashAsConstructed(address _address) external override onlyDeployer {

     |  // @audit-issue Remove `override`
  78 |  function getRawCodeHash(address _address) public view override returns (bytes32 codeHash) {

     |  // @audit-issue Remove `override`
  89 |  function getCodeHash(uint256 _input) external view override returns (bytes32) {

     |  // @audit-issue Remove `override`
 117 |  function getCodeSize(uint256 _input) external view override returns (uint256 codeSize) {
```
GitHub: [35](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L35), [46](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L46), [54](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L54), [78](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L78), [89](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L89), [117](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L117)


```solidity
File: code/system-contracts/contracts/BootloaderUtilities.sol

     |  // @audit-issue Remove `override`
  24 |  function getTransactionHashes(
  25 |      Transaction calldata _transaction
  26 |  ) external view override returns (bytes32 txHash, bytes32 signedTxHash) {
```
GitHub: [24-26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L24-L26)


```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

     |  // @audit-issue Remove `override`
  95 |  function getNewAddressCreate2(
  96 |      address _sender,
  97 |      bytes32 _bytecodeHash,
  98 |      bytes32 _salt,
  99 |      bytes calldata _input
 100 |  ) public view override returns (address newAddress) {

     |  // @audit-issue Remove `override`
 115 |  function getNewAddressCreate(
 116 |      address _sender,
 117 |      uint256 _senderNonce
 118 |  ) public pure override returns (address newAddress) {

     |  // @audit-issue Remove `override`
 132 |  function create2(
 133 |      bytes32 _salt,
 134 |      bytes32 _bytecodeHash,
 135 |      bytes calldata _input
 136 |  ) external payable override returns (address) {

     |  // @audit-issue Remove `override`
 147 |  function create(
 148 |      bytes32 _salt,
 149 |      bytes32 _bytecodeHash,
 150 |      bytes calldata _input
 151 |  ) external payable override returns (address) {

     |  // @audit-issue Remove `override`
 162 |  function create2Account(
 163 |      bytes32 _salt,
 164 |      bytes32 _bytecodeHash,
 165 |      bytes calldata _input,
 166 |      AccountAbstractionVersion _aaVersion
 167 |  ) public payable override onlySystemCall returns (address) {

     |  // @audit-issue Remove `override`
 182 |  function createAccount(
 183 |      bytes32, // salt
 184 |      bytes32 _bytecodeHash,
 185 |      bytes calldata _input,
 186 |      AccountAbstractionVersion _aaVersion
 187 |  ) public payable override onlySystemCall returns (address) {
```
GitHub: [95-100](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L95-L100), [115-118](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L115-L118), [132-136](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L132-L136), [147-151](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L147-L151), [162-167](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L162-L167), [182-187](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L182-L187)


```solidity
File: code/system-contracts/contracts/DefaultAccount.sol

     |  // @audit-issue Remove `override`
  67 |  function validateTransaction(
  68 |      bytes32, // _txHash
  69 |      bytes32 _suggestedSignedHash,
  70 |      Transaction calldata _transaction
  71 |  ) external payable override ignoreNonBootloader ignoreInDelegateCall returns (bytes4 magic) {

     |  // @audit-issue Remove `override`
 112 |  function executeTransaction(
 113 |      bytes32, // _txHash
 114 |      bytes32, // _suggestedSignedHash
 115 |      Transaction calldata _transaction
 116 |  ) external payable override ignoreNonBootloader ignoreInDelegateCall {

     |  // @audit-issue Remove `override`
 125 |  function executeTransactionFromOutside(Transaction calldata _transaction) external payable override {
```
GitHub: [67-71](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L67-L71), [112-116](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L112-L116), [125](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L125)


```solidity
File: code/system-contracts/contracts/ImmutableSimulator.sol

     |  // @audit-issue Remove `override`
  27 |  function getImmutable(address _dest, uint256 _index) external view override returns (bytes32) {

     |  // @audit-issue Remove `override`
  34 |  function setImmutables(address _dest, ImmutableData[] calldata _immutables) external override {
```
GitHub: [27](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ImmutableSimulator.sol#L27), [34](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ImmutableSimulator.sol#L34)


```solidity
File: code/system-contracts/contracts/KnownCodesStorage.sol

     |  // @audit-issue Remove `override`
  65 |  function getMarker(bytes32 _hash) public view override returns (uint256 marker) {
```
GitHub: [65](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/KnownCodesStorage.sol#L65)


```solidity
File: code/system-contracts/contracts/L1Messenger.sol

     |  // @audit-issue Remove `override`
 116 |  function sendToL1(bytes calldata _message) external override returns (bytes32 hash) {

     |  // @audit-issue Remove `override`
 161 |  function requestBytecodeL1Publication(
 162 |      bytes32 _bytecodeHash
 163 |  ) external override onlyCallFrom(address(KNOWN_CODE_STORAGE_CONTRACT)) {
```
GitHub: [116](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L116), [161-163](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L161-L163)


```solidity
File: code/system-contracts/contracts/L2BaseToken.sol

     |  // @audit-issue Remove `override`
  32 |  function transferFromTo(address _from, address _to, uint256 _amount) external override {

     |  // @audit-issue Remove `override`
  56 |  function balanceOf(uint256 _account) external view override returns (uint256) {

     |  // @audit-issue Remove `override`
  64 |  function mint(address _account, uint256 _amount) external override onlyCallFromBootloader {

     |  // @audit-issue Remove `override`
  72 |  function withdraw(address _l1Receiver) external payable override {

     |  // @audit-issue Remove `override`
  85 |  function withdrawWithMessage(address _l1Receiver, bytes memory _additionalData) external payable override {

     |  // @audit-issue Remove `override`
 128 |  function name() external pure override returns (string memory) {

     |  // @audit-issue Remove `override`
 134 |  function symbol() external pure override returns (string memory) {

     |  // @audit-issue Remove `override`
 140 |  function decimals() external pure override returns (uint8) {
```
GitHub: [32](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L2BaseToken.sol#L32), [56](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L2BaseToken.sol#L56), [64](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L2BaseToken.sol#L64), [72](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L2BaseToken.sol#L72), [85](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L2BaseToken.sol#L85), [128](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L2BaseToken.sol#L128), [134](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L2BaseToken.sol#L134), [140](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L2BaseToken.sol#L140)


```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

     |  // @audit-issue Remove `override`
  79 |  function finalizeDeposit(
  80 |      address _l1Sender,
  81 |      address _l2Receiver,
  82 |      address _l1Token,
  83 |      uint256 _amount,
  84 |      bytes calldata _data
  85 |  ) external payable override {

     |  // @audit-issue Remove `override`
 123 |  function withdraw(address _l1Receiver, address _l2Token, uint256 _amount) external override {

     |  // @audit-issue Remove `override`
 149 |  function l2TokenAddress(address _l1Token) public view override returns (address) {
```
GitHub: [79-85](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L79-L85), [123](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L123), [149](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L149)


```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

     |  // @audit-issue Remove `override`
 145 |  function bridgeMint(address _to, uint256 _amount) external override onlyBridge {

     |  // @audit-issue Remove `override`
 154 |  function bridgeBurn(address _from, uint256 _amount) external override onlyBridge {

     |  // @audit-issue Remove `override`
 159 |  function name() public view override returns (string memory) {

     |  // @audit-issue Remove `override`
 165 |  function symbol() public view override returns (string memory) {

     |  // @audit-issue Remove `override`
 171 |  function decimals() public view override returns (uint8) {
```
GitHub: [145](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L145), [154](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L154), [159](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L159), [165](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L165), [171](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L171)


```solidity
File: code/contracts/zksync/contracts/TestnetPaymaster.sol

     |  // @audit-issue Remove `override`
  70 |  function postTransaction(
  71 |      bytes calldata _context,
  72 |      Transaction calldata _transaction,
  73 |      bytes32,
  74 |      bytes32,
  75 |      ExecutionResult _txResult,
  76 |      uint256 _maxRefundedGas
  77 |  ) external payable override {
```
GitHub: [70-77](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/TestnetPaymaster.sol#L70-L77)


```solidity
File: code/contracts/zksync/contracts/bridge/L2WrappedBaseToken.sol

     |  // @audit-issue Remove `override`
  72 |  function bridgeMint(address _to, uint256 _amount) external override onlyBridge {

     |  // @audit-issue Remove `override`
  80 |  function bridgeBurn(address _from, uint256 _amount) external override onlyBridge {

     |  // @audit-issue Remove `override`
  90 |  function deposit() external payable override {

     |  // @audit-issue Remove `override`
  95 |  function withdraw(uint256 _amount) external override {

     |  // @audit-issue Remove `override`
 100 |  function depositTo(address _to) public payable override {

     |  // @audit-issue Remove `override`
 106 |  function withdrawTo(address _to, uint256 _amount) public override {
```
GitHub: [72](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2WrappedBaseToken.sol#L72), [80](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2WrappedBaseToken.sol#L80), [90](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2WrappedBaseToken.sol#L90), [95](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2WrappedBaseToken.sol#L95), [100](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2WrappedBaseToken.sol#L100), [106](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2WrappedBaseToken.sol#L106)


## [N-97] The `nonReentrant` `modifier` should occur before all other modifiers

This is a best-practice to protect against reentrancy in other modifiers.

*Instances: 2*

```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

     |  // @audit-issue Invoke the nonReentrant modifier first
 554 |  function depositLegacyErc20Bridge(
 555 |      address _prevMsgSender,
 556 |      address _l2Receiver,
 557 |      address _l1Token,
 558 |      uint256 _amount,
 559 |      uint256 _l2TxGasLimit,
 560 |      uint256 _l2TxGasPerPubdataByte,
 561 |      address _refundRecipient
 562 |  ) external payable override onlyLegacyBridge nonReentrant returns (bytes32 l2TxHash) {
```
GitHub: [554-562](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L554-L562)


```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

     |  // @audit-issue Invoke the nonReentrant modifier first
 114 |  function createNewChain(
 115 |      uint256 _chainId,
 116 |      address _stateTransitionManager,
 117 |      address _baseToken,
 118 |      uint256, //_salt
 119 |      address _admin,
 120 |      bytes calldata _initData
 121 |  ) external onlyOwnerOrAdmin nonReentrant returns (uint256 chainId) {
```
GitHub: [114-121](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L114-L121)


## [N-98] Typos

Consider correcting these spelling errors.

*Instances: 565*

```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

     |  // @audit-issue Typo: matterlabs
  15 |  /// @custom:security-contact security@matterlabs.dev
     |  // @audit-issue Typo: hyperchains
  16 |  /// @notice Smart contract that allows depositing ERC20 tokens from Ethereum to hyperchains
     |  // @audit-issue Typo: zk
  17 |  /// @dev It is a legacy bridge from zkSync Era, that was deprecated in favour of shared bridge.
  :  |
     |      // @audit-issue Typo: zk
  26 |      /// @dev Used to indicate that L2 -> L1 message was already processed for zkSync Era withdrawals.
  :  |
     |      // @audit-issue Typo: zk
  31 |      /// @dev Used for saving the number of deposited funds, to claim them in case the deposit transaction will fail in zkSync Era.
  :  |
     |      // @audit-issue Typo: zk
  35 |      /// @dev The address that is used as a L2 bridge counterpart in zkSync Era.
  :  |
     |      // @audit-issue Typo: zk
  38 |      /// @dev The address that is used as a beacon for L2 tokens in zkSync Era.
  :  |
     |      // @audit-issue Typo: zk
  41 |      /// @dev Stores the hash of the L2 token proxy contract's bytecode on zkSync Era.
  :  |
     |      // @audit-issue Typo: zk
  74 |      /// @return The L2 token address that would be minted for deposit of the given L1 token on zkSync Era.
  :  |
     |      // @audit-issue Typo: Pubdata
     |      // @audit-issue Typo: Pubdata
  95 |      /// @param _l2TxGasPerPubdataByte The gasPerPubdataByteLimit to be used in the corresponding L2 transaction
  :  |
     |      // @audit-issue Typo: nonreentrant
  97 |      /// NOTE: the function doesn't use `nonreentrant` modifier, because the inner method does.
  :  |
     |      // @audit-issue Typo: Pubdata
     |      // @audit-issue Typo: Pubdata
 117 |      /// @param _l2TxGasPerPubdataByte The gasPerPubdataByteLimit to be used in the corresponding L2 transaction
```
GitHub: [15](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L15), [16](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L16), [17](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L17), [26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L26), [31](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L31), [35](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L35), [38](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L38), [41](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L41), [74](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L74), [95](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L95), [95](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L95), [97](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L97), [117](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L117), [117](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L117)


```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

     |  // @audit-issue Typo: matterlabs
  27 |  /// @custom:security-contact security@matterlabs.dev
     |  // @audit-issue Typo: hyperchains
  28 |  /// @dev Bridges assets between L1 and hyperchains, supporting both ETH and ERC20 tokens.
     |  // @audit-issue Typo: upgradability
  29 |  /// @dev Designed for use with a proxy for upgradability.
  :  |
     |      // @audit-issue Typo: zk
  42 |      /// @dev Stores the first batch number on the zkSync Era Diamond Proxy that was settled after Shared Bridge upgrade.
  :  |
     |      // @audit-issue Typo: hyperbridging
  60 |      /// @dev Indicates whether the hyperbridging is enabled for a given chain.
  :  |
     |      // @audit-issue Typo: hyperchains
  63 |      /// @dev Maps token balances for each chain to prevent unauthorized spending across hyperchains.
     |      // @audit-issue Typo: hyperbridging
  64 |      /// This serves as a security measure until hyperbridging is implemented.
  :  |
     |      // @audit-issue Typo: zk
  73 |      /// @notice Checks that the message sender is the bridgehub or zkSync Era Diamond Proxy.
  :  |
     |      // @audit-issue Typo: tranfer
 115 |      /// @dev tranfer tokens from legacy erc20 bridge or mailbox and set chainBalance as part of migration process
  :  |
     |          // @audit-issue Typo: Weth
 185 |          uint256, // l2Value, needed for Weth deposits in the future
  :  |
     |              // @audit-issue Typo: weth
     |              // @audit-issue Typo: weth
 363 |              // Note we don't allow weth deposits anymore, but there might be legacy weth deposits.
     |              // @audit-issue Typo: Weth
     |              // @audit-issue Typo: weth
 364 |              // until we add Weth bridging capabilities, we don't wrap/unwrap weth to ether.
  :  |
     |      // @audit-issue Typo: zk
 370 |      /// @dev Determines if a withdrawal was initiated on zkSync Era before the upgrade to the Shared Bridge.
  :  |
     |      // @audit-issue Typo: zk
 373 |      /// @return Whether withdrawal was initiated on zkSync Era before Shared Bridge upgrade.
  :  |
     |          // @audit-issue Typo: rewithdrawing
     |          // @audit-issue Typo: txs
 393 |          // To avoid rewithdrawing txs that have already happened on the legacy bridge.
  :  |
     |          // @audit-issue Typo: zk
 420 |          // Handling special case for withdrawal from zkSync Era initiated before Shared Bridge.
  :  |
     |              // @audit-issue Typo: enought
 439 |              require(chainBalance[_chainId][l1Token] >= amount, "ShB not enough funds 2"); // not enought funds
  :  |
     |          // @audit-issue Typo: messsage
 501 |          require(_l2ToL1message.length >= 56, "ShB wrong msg len"); // wrong messsage length
  :  |
     |      // @audit-issue Typo: Pubdata
     |      // @audit-issue Typo: Pubdata
 538 |      /// @param _l2TxGasPerPubdataByte The gasPerPubdataByteLimit to be used in the corresponding L2 transaction
  :  |
     |      // @audit-issue Typo: withdrawns
 614 |      /// @return amount The amount of the token being withdrawns
  :  |
     |      // @audit-issue Typo: zk
 632 |      /// @notice Withdraw funds from the initiated deposit, that failed when finalizing on zkSync Era chain.
```
GitHub: [27](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L27), [28](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L28), [29](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L29), [42](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L42), [60](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L60), [63](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L63), [64](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L64), [73](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L73), [115](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L115), [185](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L185), [363](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L363), [363](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L363), [364](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L364), [364](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L364), [370](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L370), [373](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L373), [393](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L393), [393](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L393), [420](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L420), [439](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L439), [501](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L501), [538](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L538), [538](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L538), [614](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L614), [632](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L632)


```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

     |  // @audit-issue Typo: weth
  17 |  /// @notice all the ether is held by the weth bridge
  :  |
     |      // @audit-issue Typo: precompiles
 303 |      ); // to avoid calls to precompiles
```
GitHub: [17](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L17), [303](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L303)


```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

     |  // @audit-issue Typo: matterlabs
   9 |  /// @custom:security-contact security@matterlabs.dev
  :  |
     |  // @audit-issue Typo: zk
     |  // @audit-issue Typo: hyperchain
  14 |  /// and changes in all zkSync hyperchain governed contracts.
```
GitHub: [9](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L9), [14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L14), [14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L14)


```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

     |  // @audit-issue Typo: matterlabs
  26 |  /// @custom:security-contact security@matterlabs.dev
  :  |
     |          // @audit-issue Typo: preimages
 107 |          // Length of the L2Log encoding should not be equal to the length of other L2Logs' tree nodes preimages
  :  |
     |      // @audit-issue Typo: blockhashzero
 178 |      /// @dev we have to set the chainId at genesis, as blockhashzero is the same for all chains with the same chainId
```
GitHub: [26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L26), [107](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L107), [178](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L178)


```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

     |  // @audit-issue Typo: matterlabs
  12 |  /// @custom:security-contact security@matterlabs.dev
     |  // @audit-issue Typo: hyperchains
  13 |  /// @notice Intermediate smart contract between the validator EOA account and the hyperchains state transition diamond smart contract.
  :  |
     |  // @audit-issue Typo: hyperchain
  15 |  /// modifying the main hyperchain diamond contract. As such, even if this contract is compromised, it will not impact the main
  :  |
     |  // @audit-issue Typo: zk
  17 |  /// @dev zkSync actively monitors the chain activity and reacts to any suspicious activity by freezing the chain.
  :  |
     |      // @audit-issue Typo: hyperchain
 107 |      /// a call to the hyperchain diamond contract with the same calldata.
  :  |
     |      // @audit-issue Typo: hyperchain
 125 |      /// a call to the hyperchain diamond contract with the same calldata.
  :  |
     |      // @audit-issue Typo: hyperchain
 143 |      /// @dev Make a call to the hyperchain diamond contract with the same calldata.
  :  |
     |      // @audit-issue Typo: hyperchain
 150 |      /// @dev Make a call to the hyperchain diamond contract with the same calldata.
  :  |
     |      // @audit-issue Typo: hyperchain
 157 |      /// @dev Make a call to the hyperchain diamond contract with the same calldata.
  :  |
     |      // @audit-issue Typo: hyperchain
 168 |      /// @dev Make a call to the hyperchain diamond contract with the same calldata.
  :  |
     |      // @audit-issue Typo: hyperchain
 181 |      /// make a call to the hyperchain diamond contract with the same calldata.
  :  |
     |                  // @audit-issue Typo: zk
 192 |                  // * The batch wasn't committed at all, so execution will fail in the zkSync contract.
  :  |
     |      // @audit-issue Typo: hyperchain
 202 |      /// make a call to the hyperchain diamond contract with the same calldata.
  :  |
     |                  // @audit-issue Typo: zk
 214 |                  // * The batch wasn't committed at all, so execution will fail in the zkSync contract.
  :  |
     |      // @audit-issue Typo: hyperchain
 223 |      /// @dev Call the hyperchain diamond contract with the same calldata as this contract was called.
     |      // @audit-issue Typo: hyperchain
 224 |      /// Note: it is called the hyperchain diamond contract, not delegatecalled!
  :  |
     |              // @audit-issue Typo: hyperchain
 230 |              // Call method of the hyperchain diamond contract returns 0 on error
```
GitHub: [12](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L12), [13](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L13), [15](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L15), [17](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L17), [107](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L107), [125](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L125), [143](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L143), [150](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L150), [157](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L157), [168](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L168), [181](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L181), [192](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L192), [202](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L202), [214](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L214), [223](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L223), [224](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L224), [230](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L230)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol

     |  // @audit-issue Typo: hyperchain
  21 |  /// @notice hyperchain diamond contract initialization
  :  |
     |      // @audit-issue Typo: preimages
  50 |      // Length of the L2Log encoding should not be equal to the length of other L2Logs' tree nodes preimages
```
GitHub: [21](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol#L21), [50](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol#L50)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol

     |  // @audit-issue Typo: matterlabs
   9 |  /// @custom:security-contact security@matterlabs.dev
```
GitHub: [9](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol#L9)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol

     |  // @audit-issue Typo: pubdata
  36 |  /// @notice The struct that describes whether users will be charged for pubdata for L1->L2 transactions.
     |  // @audit-issue Typo: Rollup
     |  // @audit-issue Typo: pubdata
  37 |  /// @param Rollup The users are charged for pubdata & it is priced based on the gas price on Ethereum.
     |  // @audit-issue Typo: Validium
     |  // @audit-issue Typo: pubdata
  38 |  /// @param Validium The pubdata is considered free with regard to the L1 gas price.
  :  |
     |  // @audit-issue Typo: pubdata
     |  // @audit-issue Typo: pubdata
  45 |  /// @param pubdataPricingMode How the users will charged for pubdata in L1->L2 transactions.
  :  |
     |  // @audit-issue Typo: Pubdata
     |  // @audit-issue Typo: pubdata
  47 |  /// @param maxPubdataPerBatch The maximal number of pubdata that can be emitted per batch.
     |  // @audit-issue Typo: Pubdata
     |  // @audit-issue Typo: pubdata
  48 |  /// @param priorityTxMaxPubdata The maximal amount of pubdata a priority transaction is allowed to publish.
     |  // @audit-issue Typo: Pubdata
  49 |  /// It can be slightly less than maxPubdataPerBatch in order to have some margin for the bootloader execution.
  :  |
     |  // @audit-issue Typo: hyperchain
  61 |  /// @dev storing all storage variables for hyperchain diamond facets
  :  |
     |      // @audit-issue Typo: zkp
  96 |      /// @dev Used as an input to zkp-circuit.
  :  |
     |      // @audit-issue Typo: zkp
  99 |      /// @dev Used as an input to zkp-circuit.
  :  |
     |      // @audit-issue Typo: zkp
 102 |      /// @dev Used as an input to zkp-circuit.
  :  |
     |      // @audit-issue Typo: versioned
     |      // @audit-issue Typo: versioned
 136 |      /// @dev Address of the blob versioned hash getter smart contract used for EIP-4844 versioned hashes.
  :  |
     |      // @audit-issue Typo: Tokenbridge
 147 |      /// @dev The address of the baseTokenbridge. Eth also uses the shared bridge
```
GitHub: [36](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L36), [37](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L37), [37](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L37), [38](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L38), [38](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L38), [45](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L45), [45](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L45), [47](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L47), [47](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L47), [48](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L48), [48](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L48), [49](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L49), [61](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L61), [96](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L96), [99](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L99), [102](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L102), [136](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L136), [136](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L136), [147](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L147)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol

     |  // @audit-issue Typo: matterlabs
  17 |  /// @custom:security-contact security@matterlabs.dev
  :  |
     |      // @audit-issue Typo: Zk
  19 |      /// @inheritdoc IZkSyncStateTransitionBase
  :  |
     |          // @audit-issue Typo: pubdata
     |          // @audit-issue Typo: pubdata
  69 |          // the maximal pubdata per batch is not less than the maximal pubdata per priority transaction.
  :  |
     |          // @audit-issue Typo: Validium
  90 |          require(s.totalBatchesCommitted == 0, "AdminFacet: set validium only after genesis"); // Validium mode can be set only before the first batch is committed
```
GitHub: [17](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L17), [19](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L19), [69](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L69), [69](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L69), [90](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L90)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

     |  // @audit-issue Typo: zk
     |  // @audit-issue Typo: hyperchain
     |  // @audit-issue Typo: zk
     |  // @audit-issue Typo: hyperchain
  19 |  /// @title zkSync hyperchain Executor contract capable of processing events emitted in the zkSync hyperchain protocol.
  :  |
     |  // @audit-issue Typo: matterlabs
  21 |  /// @custom:security-contact security@matterlabs.dev
  :  |
     |      // @audit-issue Typo: Zk
  26 |      /// @inheritdoc IZkSyncStateTransitionBase
  :  |
     |              // @audit-issue Typo: validium
  49 |              // skipping data validation for validium, we just check that the data is empty
  :  |
     |              // @audit-issue Typo: pubdata
  53 |              // We want only want to include the actual blob linear hashes when we send pubdata via blobs.
  :  |
     |              // @audit-issue Typo: pubdata
  57 |              // In this scenario, pubdataCommitments is a list of: opening point (16 bytes) || claimed value (32 bytes) || commitment (48 bytes) || proof (48 bytes)) = 144 bytes
  :  |
     |              // @audit-issue Typo: pubdata
     |              // @audit-issue Typo: pubdata
     |              // @audit-issue Typo: diffs
  60 |              // In this scenario pubdataCommitments is actual pubdata consisting of l2 to l1 logs, l2 to l1 message, compressed smart contract bytecode, and compressed state diffs
  :  |
     |          // @audit-issue Typo: txs
 222 |          // to solve this we will need to add the feature to create batches with only the protocol upgrade tx, without any other txs.
  :  |
     |          // @audit-issue Typo: thier
     |          // @audit-issue Typo: protocolversion
 224 |          // as thier protocolversion would be outdated, and they also cannot process the protocol upgrade tx as they have a pending upgrade.
     |          // @audit-issue Typo: Zk
 225 |          // 3. The protocol upgrade is increased in the BaseZkSyncUpgrade, in the executor only the systemContractsUpgradeTxHash is checked
  :  |
     |          // @audit-issue Typo: encure
 283 |          // this check is added just in case. Since it is a hot read, it does not encure noticeable gas cost.
  :  |
     |      // @audit-issue Typo: Idx
 320 |      /// @dev _executedBatchIdx is an index in the array of the batches that we want to execute together
  :  |
     |          // @audit-issue Typo: zkp
 427 |          // We allow skipping the zkp verification for the test(net) environment
  :  |
     |          // @audit-issue Typo: endif
 434 |          // #endif
  :  |
     |      // @audit-issue Typo: zk
 452 |      /// @dev Gets zk proof public input
  :  |
     |                  // @audit-issue Typo: zk
 520 |                  uint64(0), // index repeated storage changes in zkPorter
     |                  // @audit-issue Typo: zk
 521 |                  bytes32(0) // zkPorter batch hash
  :  |
     |          // @audit-issue Typo: versioned
 572 |          // output hash of blob commitments: keccak(versioned hash || opening point || evaluation value)
     |          // @audit-issue Typo: pubdata
 573 |          // These values will all be bytes32(0) when we submit pubdata via calldata instead of blobs.
  :  |
     |      // @audit-issue Typo: versioned
 603 |      /// Also verify that the provided commitment matches the provided versioned_hash.
  :  |
     |      // @audit-issue Typo: versioned
 622 |      /// versioned hash || opening point || opening value || commitment || proof
     |      // @audit-issue Typo: versioned
 623 |      /// the _pubdataCommitments will contain the last 4 values, the versioned hash is pulled from the BLOBHASH opcode
     |      // @audit-issue Typo: pubdata
 624 |      /// pubdataCommitments is a list of: opening point (16 bytes) || claimed value (32 bytes) || commitment (48 bytes) || proof (48 bytes)) = 144 bytes
  :  |
     |              // @audit-issue Typo: versioned
 653 |              // Take the hash of the versioned hash || opening point || claimed value
  :  |
     |      // @audit-issue Typo: opecode
     |      // @audit-issue Typo: yul
 676 |      /// @dev Since we don't have access to the new BLOBHASH opecode we need to leverage a static call to a yul contract
```
GitHub: [19](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L19), [19](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L19), [19](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L19), [19](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L19), [21](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L21), [26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L26), [49](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L49), [53](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L53), [57](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L57), [60](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L60), [60](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L60), [60](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L60), [222](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L222), [224](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L224), [224](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L224), [225](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L225), [283](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L283), [320](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L320), [427](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L427), [434](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L434), [452](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L452), [520](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L520), [521](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L521), [572](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L572), [573](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L573), [603](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L603), [622](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L622), [623](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L623), [624](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L624), [653](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L653), [676](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L676), [676](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L676)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol

     |  // @audit-issue Typo: blockchain
  17 |  /// @title Getters Contract implements functions for getting contract state from outside the blockchain.
  :  |
     |  // @audit-issue Typo: matterlabs
  19 |  /// @custom:security-contact security@matterlabs.dev
  :  |
     |      // @audit-issue Typo: Zk
  24 |      /// @inheritdoc IZkSyncStateTransitionBase
```
GitHub: [17](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L17), [19](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L19), [24](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L24)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

     |  // @audit-issue Typo: zk
  27 |  /// @title zkSync Mailbox contract providing interfaces for L1 <-> L2 interaction.
  :  |
     |  // @audit-issue Typo: matterlabs
  29 |  /// @custom:security-contact security@matterlabs.dev
  :  |
     |      // @audit-issue Typo: Zk
  34 |      /// @inheritdoc IZkSyncStateTransitionBase
  :  |
     |          // @audit-issue Typo: preimages
 121 |          // equal to the length of other nodes preimages (which are `2 * 32`)
  :  |
     |      // @audit-issue Typo: Pubdata
     |      // @audit-issue Typo: pubdata
 154 |      /// @param _gasPerPubdata The price for each pubdata byte in L2 gas
  :  |
     |          // @audit-issue Typo: zk
 232 |          // Please note, currently zkSync address derivation is different from Ethereum one, but it may be changed in the future.
  :  |
     |          // @audit-issue Typo: Pubdata
 238 |          // Enforcing that `_request.l2GasPerPubdataByteLimit` equals to a certain constant number. This is needed
     |          // @audit-issue Typo: Pubdata
 239 |          // to ensure that users do not get used to using "exotic" numbers for _request.l2GasPerPubdataByteLimit, e.g. 1-2, etc.
  :  |
     |          // @audit-issue Typo: Pubdata
 241 |          // ability to provide `_request.l2GasPerPubdataByteLimit` for each independent transaction.
  :  |
     |      // @audit-issue Typo: bytecodes
 352 |      /// @notice Hashes the L2 bytecodes and returns them in the format in which they are processed by the bootloader
```
GitHub: [27](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L27), [29](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L29), [34](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L34), [121](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L121), [154](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L154), [154](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L154), [232](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L232), [238](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L238), [239](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L239), [241](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L241), [352](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L352)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol

     |  // @audit-issue Typo: matterlabs
  10 |  /// @custom:security-contact security@matterlabs.dev
```
GitHub: [10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L10)


```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol

     |  // @audit-issue Typo: Deps
     |  // @audit-issue Typo: deps
  16 |  /// @param factoryDeps The list of factory deps for the l2ProtocolUpgradeTx.
  :  |
     |  // @audit-issue Typo: matterlabs
  42 |  /// @custom:security-contact security@matterlabs.dev
  :  |
     |          // @audit-issue Typo: commited
 129 |          // Batches committed expecting the old verifier will fail. Ensure all commited batches are finalized before the
  :  |
     |          // @audit-issue Typo: commited
 145 |          // Batches committed expecting the old verifier params will fail. Ensure all commited batches are finalized before the
  :  |
     |      // @audit-issue Typo: deps
 219 |      /// @notice Verifies that the factory deps correspond to the proper hashes
     |      // @audit-issue Typo: Deps
     |      // @audit-issue Typo: deps
 220 |      /// @param _factoryDeps The list of factory deps
  :  |
     |          // @audit-issue Typo: hyperchains
 248 |          // Note it is important to keep this check, as otherwise hyperchains might skip upgrades by overwriting
```
GitHub: [16](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L16), [16](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L16), [42](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L42), [129](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L129), [145](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L145), [219](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L219), [220](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L220), [220](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L220), [248](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L248)


```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol

     |  // @audit-issue Typo: matterlabs
  15 |  /// @custom:security-contact security@matterlabs.dev
```
GitHub: [15](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L15)


```solidity
File: code/contracts/ethereum/contracts/upgrades/DefaultUpgrade.sol

     |  // @audit-issue Typo: matterlabs
   9 |  /// @custom:security-contact security@matterlabs.dev
```
GitHub: [9](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/DefaultUpgrade.sol#L9)


```solidity
File: code/contracts/ethereum/contracts/upgrades/GenesisUpgrade.sol

     |  // @audit-issue Typo: matterlabs
  10 |  /// @custom:security-contact security@matterlabs.dev
```
GitHub: [10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/GenesisUpgrade.sol#L10)


```solidity
File: code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol

     |  // @audit-issue Typo: matterlabs
   7 |  * @custom:security-contact security@matterlabs.dev
  :  |
     |     // @audit-issue Typo: formam
  37 |     /// @dev The function reverts on invalid bytecode hash formam.
```
GitHub: [7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L7), [37](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L37)


```solidity
File: code/contracts/ethereum/contracts/common/libraries/UncheckedMath.sol

     |  // @audit-issue Typo: matterlabs
   7 |  * @custom:security-contact security@matterlabs.dev
```
GitHub: [7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/UncheckedMath.sol#L7)


```solidity
File: code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol

     |  // @audit-issue Typo: matterlabs
   7 |  * @custom:security-contact security@matterlabs.dev
```
GitHub: [7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol#L7)


```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol

     |  // @audit-issue Typo: matterlabs
   9 |  /// @custom:security-contact security@matterlabs.dev
  :  |
     |          // @audit-issue Typo: freezability
 211 |          // so the freezability of the first selector must be matched to _isSelectorFreezable
     |          // @audit-issue Typo: freezability
 212 |          // so all the selectors in a facet will have the same freezability
```
GitHub: [9](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L9), [211](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L211), [212](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L212)


```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/LibMap.sol

     |  // @audit-issue Typo: matterlabs
   7 |  /// @custom:security-contact security@matterlabs.dev
  :  |
     |              // @audit-issue Typo: XO
  50 |              // XORing a value A with B, and then with A again, gives the original value B.
```
GitHub: [7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/LibMap.sol#L7), [50](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/LibMap.sol#L50)


```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol

     |  // @audit-issue Typo: matterlabs
   8 |  /// @custom:security-contact security@matterlabs.dev
```
GitHub: [8](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol#L8)


```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol

     |  // @audit-issue Typo: matterlabs
  17 |  /// @custom:security-contact security@matterlabs.dev
```
GitHub: [17](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L17)


```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol

     |  // @audit-issue Typo: zk
  10 |  /// @title zkSync Library for validating L1 -> L2 transactions
  :  |
     |  // @audit-issue Typo: matterlabs
  12 |  /// @custom:security-contact security@matterlabs.dev
  :  |
     |      // @audit-issue Typo: Pubdata
     |      // @audit-issue Typo: pubdata
  18 |      /// @param _priorityTxMaxPubdata The maximal amount of pubdata that a single L1->L2 transaction can emit
  :  |
     |          // @audit-issue Typo: pubdata
  29 |          // Ensuring that the transaction cannot output more pubdata than is processable
  :  |
     |      // @audit-issue Typo: Pubdata
  66 |      /// @param _l2GasPricePerPubdata The L2 gas price for publishing the priority transaction on L2.
  :  |
     |      // @audit-issue Typo: zk
 125 |      /// of the fee model of zkSync. The appropriate comments are also present
```
GitHub: [10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L10), [12](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L12), [18](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L18), [18](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L18), [29](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L29), [66](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L66), [125](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L125)


```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol

     |  // @audit-issue Typo: matterlabs
   9 |  /// @custom:security-contact security@matterlabs.dev
     |  // @audit-issue Typo: hyperchain
     |  // @audit-issue Typo: zk
  10 |  /// @notice Legacy Bridge interface before hyperchain migration, used for backward compatibility with zkSync Era
```
GitHub: [9](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L9), [10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L10), [10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L10)


```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol

     |  // @audit-issue Typo: matterlabs
  11 |  /// @custom:security-contact security@matterlabs.dev
```
GitHub: [11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L11)


```solidity
File: code/contracts/ethereum/contracts/common/interfaces/IL2ContractDeployer.sol

     |  // @audit-issue Typo: zk
     |  // @audit-issue Typo: hyperchain
   7 |  * @notice System smart contract that is responsible for deploying other smart contracts on a zkSync hyperchain.
  :  |
     |     // @audit-issue Typo: bytecodehash
  12 |     /// @param newAddress The address on which to deploy the bytecodehash to.
  :  |
     |     // @audit-issue Typo: bytecodes
  24 |     /// @notice This method is to be used only during an upgrade to set bytecodes on specific addresses.
```
GitHub: [7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/interfaces/IL2ContractDeployer.sol#L7), [7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/interfaces/IL2ContractDeployer.sol#L7), [12](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/interfaces/IL2ContractDeployer.sol#L12), [24](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/interfaces/IL2ContractDeployer.sol#L24)


```solidity
File: code/contracts/ethereum/contracts/governance/IGovernance.sol

     |  // @audit-issue Typo: matterlabs
   7 |  /// @custom:security-contact security@matterlabs.dev
```
GitHub: [7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/IGovernance.sol#L7)


```solidity
File: code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol

     |  // @audit-issue Typo: zk
  14 |  /// @param _genesisBatchCommitment The zk-proof commitment for the genesis batch
```
GitHub: [14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L14)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol

     |  // @audit-issue Typo: matterlabs
  12 |  /// @custom:security-contact security@matterlabs.dev
  :  |
     |      // @audit-issue Typo: Validator
  23 |      /// @param _validator Validator address
  :  |
     |      // @audit-issue Typo: zk
  27 |      /// @notice Change zk porter availability
     |      // @audit-issue Typo: zk
  28 |      /// @param _zkPorterIsAvailable The availability of zk porter shard
  :  |
     |      // @audit-issue Typo: validium
  42 |      /// @notice Used to set to validium directly after genesis
  :  |
     |      // @audit-issue Typo: Validator
  63 |      /// @notice Validator's status changed
  :  |
     |      // @audit-issue Typo: Validium
  79 |      /// @notice Validium mode status changed
```
GitHub: [12](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L12), [23](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L23), [27](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L27), [28](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L28), [42](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L42), [63](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L63), [79](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L79)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol

     |  // @audit-issue Typo: Versioned
     |  // @audit-issue Typo: versioned
  24 |  /// @param blobVersionedHashRetriever Address of contract used to pull the blob versioned hash for a transaction.
  :  |
     |  // @audit-issue Typo: Versioned
     |  // @audit-issue Typo: versioned
  50 |  /// @param blobVersionedHashRetriever Address of contract used to pull the blob versioned hash for a transaction.
```
GitHub: [24](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol#L24), [24](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol#L24), [50](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol#L50), [50](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol#L50)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol

     |  // @audit-issue Typo: pubdata
  21 |  /// @dev Enum used to determine the source of pubdata. At first we will support calldata and blobs but this can be extended.
  :  |
     |  // @audit-issue Typo: pubdata
  52 |  /// @dev Packed pubdata commitments.
  :  |
     |  // @audit-issue Typo: pubdata
  56 |  /// @dev Offset in pubdata commitment of blobs for claimed value
  :  |
     |  // @audit-issue Typo: pubdata
     |  // @audit-issue Typo: kzg
  59 |  /// @dev Offset in pubdata commitment of blobs for kzg commitment
  :  |
     |  // @audit-issue Typo: zk
     |  // @audit-issue Typo: zk
  70 |  /// @title The interface of the zkSync Executor contract capable of processing events emitted in the zkSync protocol.
  :  |
     |  // @audit-issue Typo: matterlabs
  72 |  /// @custom:security-contact security@matterlabs.dev
  :  |
     |      // @audit-issue Typo: Rollup
  74 |      /// @notice Rollup batch stored data
     |      // @audit-issue Typo: Rollup
  75 |      /// @param batchNumber Rollup batch number
  :  |
     |      // @audit-issue Typo: Txs
  78 |      /// @param numberOfLayer1Txs Number of priority operations to be processed
  :  |
     |      // @audit-issue Typo: Rollup
  81 |      /// @param timestamp Rollup batch timestamp, have the same format as Ethereum batch constant
     |      // @audit-issue Typo: zk
  82 |      /// @param commitment Verified input for the zkSync circuit
  :  |
     |      // @audit-issue Typo: Txs
  99 |      /// @param numberOfLayer1Txs Number of priority operations to be processed
  :  |
     |      // @audit-issue Typo: pubdata
     |      // @audit-issue Typo: pubdata
 104 |      /// @param pubdataCommitments Packed pubdata commitments/data.
     |      // @audit-issue Typo: pubdata
     |      // @audit-issue Typo: pubdata
 105 |      /// @dev pubdataCommitments format: This will always start with a 1 byte pubdataSource flag. Current allowed values are 0 (calldata) or 1 (blobs)
     |      // @audit-issue Typo: kzg
 106 |      ///                             kzg: list of: opening point (16 bytes) || claimed value (32 bytes) || commitment (48 bytes) || proof (48 bytes) = 144 bytes
     |      // @audit-issue Typo: pubdata
     |      // @audit-issue Typo: pubdata
 107 |      ///                             calldata: pubdataCommitments.length - 1 - 32 bytes of pubdata
  :  |
     |      // @audit-issue Typo: pubdata
 109 |      /// @dev For 2 blobs we will be sending 288 bytes of calldata instead of the full amount for pubdata.
  :  |
     |      // @audit-issue Typo: Validator
 142 |      /// @notice same as `commitBatches` but with the chainId so ValidatorTimelock can sort the inputs.
  :  |
     |      // @audit-issue Typo: Validator
 160 |      /// @notice same as `proveBatches` but with the chainId so ValidatorTimelock can sort the inputs.
  :  |
     |      // @audit-issue Typo: commpleting
 169 |      /// - Processing all pending operations (commpleting priority requests).
  :  |
     |      // @audit-issue Typo: Validator
 174 |      /// @notice same as `executeBatches` but with the chainId so ValidatorTimelock can sort the inputs.
  :  |
     |      // @audit-issue Typo: Validator
 183 |      /// @notice same as `revertBatches` but with the chainId so ValidatorTimelock can sort the inputs.
  :  |
     |      // @audit-issue Typo: zk
 189 |      /// @param commitment Calculated input for the zkSync circuit
  :  |
     |      // @audit-issue Typo: zk
 202 |      /// @param commitment Verified input for the zkSync circuit
```
GitHub: [21](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L21), [52](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L52), [56](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L56), [59](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L59), [59](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L59), [70](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L70), [70](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L70), [72](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L72), [74](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L74), [75](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L75), [78](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L78), [81](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L81), [82](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L82), [99](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L99), [104](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L104), [104](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L104), [105](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L105), [105](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L105), [106](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L106), [107](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L107), [107](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L107), [109](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L109), [142](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L142), [160](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L160), [169](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L169), [174](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L174), [183](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L183), [189](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L189), [202](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L202)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol

     |  // @audit-issue Typo: blockchain
  10 |  /// @title The interface of the Getters Contract that implements functions for getting contract state from outside the blockchain.
  :  |
     |  // @audit-issue Typo: matterlabs
  12 |  /// @custom:security-contact security@matterlabs.dev
  :  |
     |      // @audit-issue Typo: unfinalized
  70 |      /// @notice For unfinalized (non executed) batches may change
  :  |
     |      // @audit-issue Typo: pubdata
 108 |      /// @return The pubdata pricing mode.
```
GitHub: [10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L10), [12](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L12), [70](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L70), [108](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IGetters.sol#L108)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/ILegacyGetters.sol

     |  // @audit-issue Typo: zk
   8 |  /// @dev This interface contains getters for the zkSync contract that should not be used,
  :  |
     |  // @audit-issue Typo: matterlabs
  10 |  /// @custom:security-contact security@matterlabs.dev
  :  |
     |      // @audit-issue Typo: unfinalized
  24 |      /// @notice For unfinalized (non executed) batches may change
```
GitHub: [8](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/ILegacyGetters.sol#L8), [10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/ILegacyGetters.sol#L10), [24](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/ILegacyGetters.sol#L24)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol

     |  // @audit-issue Typo: zk
   8 |  /// @title The interface of the zkSync Mailbox contract that provides interfaces for L1 <-> L2 interaction.
  :  |
     |  // @audit-issue Typo: matterlabs
  10 |  /// @custom:security-contact security@matterlabs.dev
  :  |
     |      // @audit-issue Typo: Pubdata
     |      // @audit-issue Typo: pubdata
  75 |      /// @param _l2GasPerPubdataByteLimit The maximum amount L2 gas that the operator may charge the user for single byte of pubdata.
     |      // @audit-issue Typo: Deps
     |      // @audit-issue Typo: bytecodes
  76 |      /// @param _factoryDeps An array of L2 bytecodes that will be marked as known on L2
  :  |
     |      // @audit-issue Typo: Pubdata
     |      // @audit-issue Typo: pubdata
 105 |      /// @param _l2GasPerPubdataByteLimit The maximum amount of L2 gas that the operator may charge the user for a single byte of pubdata.
  :  |
     |      // @audit-issue Typo: tranfer
 113 |      /// @notice tranfer Eth to shared bridge as part of migration process
  :  |
     |      // @audit-issue Typo: Deps
     |      // @audit-issue Typo: bytecodes
 121 |      /// @param factoryDeps An array of bytecodes that were shown in the L1 public data.
     |      // @audit-issue Typo: bytecodes
 122 |      /// Will be marked as known bytecodes in L2
```
GitHub: [8](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L8), [10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L10), [75](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L75), [75](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L75), [76](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L76), [76](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L76), [105](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L105), [105](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L105), [113](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L113), [121](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L121), [121](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L121), [122](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L122)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IVerifier.sol

     |  // @audit-issue Typo: matterlabs
  14 |  /// @custom:security-contact security@matterlabs.dev
  :  |
     |      // @audit-issue Typo: zk
  16 |      /// @dev Verifies a zk-SNARK proof.
     |      // @audit-issue Typo: zk
  17 |      /// @return A boolean value indicating whether the zk-SNARK proof is valid.
  :  |
     |      // @audit-issue Typo: vk
  26 |      /// @return vkHash The keccak256 hash of the loaded verification keys.
```
GitHub: [14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IVerifier.sol#L14), [16](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IVerifier.sol#L16), [17](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IVerifier.sol#L17), [26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IVerifier.sol#L26)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol

     |  // @audit-issue Typo: todo
  16 |  // KL todo: need this in the server for now
```
GitHub: [16](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol#L16)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransitionBase.sol

     |  // @audit-issue Typo: zk
     |  // @audit-issue Typo: zk
   4 |  /// @title The interface of the zkSync contract, responsible for the main zkSync logic.
  :  |
     |  // @audit-issue Typo: matterlabs
   6 |  /// @custom:security-contact security@matterlabs.dev
```
GitHub: [4](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransitionBase.sol#L4), [4](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransitionBase.sol#L4), [6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransitionBase.sol#L6)


```solidity
File: code/contracts/ethereum/contracts/common/Config.sol

     |  // @audit-issue Typo: zk
  26 |  /// @dev Denotes the type of the zkSync transaction that came from L1.
  :  |
     |  // @audit-issue Typo: zk
  29 |  /// @dev Denotes the type of the zkSync transaction that is used for system upgrades.
  :  |
     |  // @audit-issue Typo: testnet
  33 |  /// in case a protocol version has been tested on testnet, but then not launched on mainnet, e.g.
  :  |
     |  // @audit-issue Typo: pubdata
  54 |  /// @dev Even though the price for 1 byte of pubdata is 16 L1 gas, we have a slightly increased
  :  |
     |  // @audit-issue Typo: pubdata
  61 |  /// @dev The intrinsic cost of the L1->l2 transaction in pubdata
  :  |
     |  // @audit-issue Typo: pubdata
  76 |  /// @dev The number of pubdata an L1->L2 transaction requires with each new factory dependency
  :  |
     |  // @audit-issue Typo: Pubdata
  79 |  /// @dev The L2 gasPricePerPubdata required to be used in bridges.
  :  |
     |  // @audit-issue Typo: zk
 111 |  /// @dev The address of zkSync Era diamond proxy contract.
```
GitHub: [26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/Config.sol#L26), [29](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/Config.sol#L29), [33](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/Config.sol#L33), [54](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/Config.sol#L54), [61](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/Config.sol#L61), [76](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/Config.sol#L76), [79](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/Config.sol#L79), [111](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/Config.sol#L111)


```solidity
File: code/contracts/ethereum/contracts/common/L2ContractAddresses.sol

     |  // @audit-issue Typo: bytecodes
  16 |  /// @dev The L2 deployer system contract allows changing bytecodes on any address if the `msg.sender` is this address.
  :  |
     |  // @audit-issue Typo: pubdata
  32 |  /// @dev The address of the pubdata chunk publisher contract
```
GitHub: [16](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/L2ContractAddresses.sol#L16), [32](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/L2ContractAddresses.sol#L32)


```solidity
File: code/contracts/ethereum/contracts/common/Messaging.sol

     |  // @audit-issue Typo: rollup
  14 |  /// @param l2ShardId The shard identifier, 0 - rollup, 1 - porter
  :  |
     |  // @audit-issue Typo: Pubdata
     |  // @audit-issue Typo: pubdata
  51 |  /// @param l2GasPricePerPubdata The price for a single pubdata byte in L2 gas.
  :  |
     |  // @audit-issue Typo: Pubdata
     |  // @audit-issue Typo: pubdata
  79 |  /// @param gasPerPubdataByteLimit Maximum number of L2 gas that will cost one byte of pubdata
  :  |
     |  // @audit-issue Typo: Deps
     |  // @audit-issue Typo: preimages
  95 |  /// @param factoryDeps The set of L2 bytecode hashes whose preimages were shown on L1
```
GitHub: [14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/Messaging.sol#L14), [51](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/Messaging.sol#L51), [51](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/Messaging.sol#L51), [79](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/Messaging.sol#L79), [79](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/Messaging.sol#L79), [95](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/Messaging.sol#L95), [95](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/Messaging.sol#L95)


```solidity
File: code/contracts/ethereum/contracts/common/ReentrancyGuard.sol

     |  // @audit-issue Typo: matterlabs
   6 |  * @custom:security-contact security@matterlabs.dev
  :  |
     |  // @audit-issue Typo: blog
  19 |  * to protect against it, check out our blog post
  :  |
     |  // @audit-issue Typo: hardfork
  23 |  * metering changes introduced in the Istanbul hardfork.
```
GitHub: [6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/ReentrancyGuard.sol#L6), [19](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/ReentrancyGuard.sol#L19), [23](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/ReentrancyGuard.sol#L23)


```solidity
File: code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol

     |  // @audit-issue Typo: http
     |  // @audit-issue Typo: www
  10 |  *    http://www.apache.org/licenses/LICENSE-2.0
  :  |
     |     // @audit-issue Typo: inbox
  25 |     /// to the inbox on L1 to the msg.sender viewed on L2
  :  |
     |     // @audit-issue Typo: inbox
  35 |     /// address that submitted a tx to the inbox on L1
```
GitHub: [10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol#L10), [10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol#L10), [25](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol#L25), [35](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol#L35)


```solidity
File: code/contracts/ethereum/contracts/state-transition/Verifier.sol

     |  // @audit-issue Typo: Lagrange
   9 |  /// @notice Modified version of the Permutations over Lagrange-bases for Oecumenical Noninteractive arguments of
  :  |
     |  // @audit-issue Typo: zk
     |  // @audit-issue Typo: hyperchain
  11 |  /// Modifications have been made to optimize the proof system for zkSync hyperchain circuits.
  :  |
     |      // @audit-issue Typo: precompiles
  25 |      // Memory slots from 0x000 to 0x200 are reserved for intermediate computations and call to precompiles.
  :  |
     |          // @audit-issue Typo: Begining
 351 |          // Begining of the big inline assembly block that makes all the verification work.
  :  |
     |              // @audit-issue Typo: zk
 488 |              /// @dev This function loads a zk-SNARK proof, ensures it's properly formatted, and stores it in memory.
  :  |
     |              // @audit-issue Typo: Lagrange
 892 |              /// @dev L_i is a Lagrange polynomial for our domain such that:
```
GitHub: [9](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L9), [11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L11), [11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L11), [25](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L25), [351](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L351), [488](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L488), [892](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L892)


```solidity
File: code/contracts/ethereum/contracts/upgrades/Upgrade_4844.sol

     |  // @audit-issue Typo: matterlabs
  11 |  /// @custom:security-contact security@matterlabs.dev
  :  |
     |          // @audit-issue Typo: versioned
  16 |          // Check to make sure that the new blob versioned hash address is not the zero address.
```
GitHub: [11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/Upgrade_4844.sol#L11), [16](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/Upgrade_4844.sol#L16)


```solidity
File: code/contracts/ethereum/contracts/upgrades/Upgrade_v1_4_1.sol

     |  // @audit-issue Typo: matterlabs
  12 |  /// @custom:security-contact security@matterlabs.dev
  :  |
     |          // @audit-issue Typo: pubdata
     |          // @audit-issue Typo: pubdata
  22 |          // the maximal pubdata per batch is not less than the maximal pubdata per priority transaction.
```
GitHub: [12](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/Upgrade_v1_4_1.sol#L12), [22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/Upgrade_v1_4_1.sol#L22), [22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/Upgrade_v1_4_1.sol#L22)


```solidity
File: code/system-contracts/contracts/AccountCodeStorage.sol

     |  // @audit-issue Typo: matterlabs
  11 |  * @custom:security-contact security@matterlabs.dev
  :  |
     |  // @audit-issue Typo: zk
  16 |  * @dev In this version of zkSync, the first byte of the hash MUST be 1.
  :  |
     |  // @audit-issue Typo: bytecodes
  18 |  * @dev It is also assumed that all the bytecode hashes are *known*, i.e. the full bytecodes
  :  |
     |     // @audit-issue Typo: codehash
  31 |     /// @param _address The address of the account to set the codehash to.
  :  |
     |     // @audit-issue Typo: codehash
  42 |     /// @param _address The address of the account to set the codehash to.
  :  |
     |     // @audit-issue Typo: codehash
  65 |     /// @dev Store the codehash of the account without any checks.
     |     // @audit-issue Typo: codehash
  66 |     /// @param _address The address of the account to set the codehash to.
  :  |
     |     // @audit-issue Typo: codehash
  75 |     /// @notice Get the codehash stored for an address.
     |     // @audit-issue Typo: codehash
  76 |     /// @param _address The address of the account of which the codehash to return
     |     // @audit-issue Typo: codehash
  77 |     /// @return codeHash The codehash stored for this account.
  :  |
     |     // @audit-issue Typo: extcodehash
  86 |     /// @notice Simulate the behavior of the `extcodehash` EVM opcode.
  :  |
     |     // @audit-issue Typo: extcodesize
 114 |     /// @notice Simulate the behavior of the `extcodesize` EVM opcode.
  :  |
     |         // @audit-issue Typo: precompiles
 125 |         // NOTE: zero address and precompiles are a special case, they are contracts, but we
  :  |
     |         // @audit-issue Typo: codehash
 128 |         // - `codehash(0) == 0`
```
GitHub: [11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L11), [16](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L16), [18](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L18), [31](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L31), [42](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L42), [65](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L65), [66](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L66), [75](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L75), [76](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L76), [77](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L77), [86](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L86), [114](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L114), [125](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L125), [128](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L128)


```solidity
File: code/system-contracts/contracts/BootloaderUtilities.sol

     |  // @audit-issue Typo: matterlabs
  12 |  * @custom:security-contact security@matterlabs.dev
  :  |
     |  // @audit-issue Typo: Yul
  14 |  * that is very hard to write in Yul.
  :  |
     |         // @audit-issue Typo: zk
 175 |         // On zkSync, access lists are always zero length (at least for now).
  :  |
     |         // @audit-issue Typo: zk
 270 |         // On zkSync, access lists are always zero length (at least for now).
```
GitHub: [12](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L12), [14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L14), [175](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L175), [270](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L270)


```solidity
File: code/system-contracts/contracts/ComplexUpgrader.sol

     |  // @audit-issue Typo: matterlabs
  10 |  * @custom:security-contact security@matterlabs.dev
```
GitHub: [10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ComplexUpgrader.sol#L10)


```solidity
File: code/system-contracts/contracts/Compressor.sol

     |  // @audit-issue Typo: matterlabs
  14 |  * @custom:security-contact security@matterlabs.dev
     |  // @audit-issue Typo: zk
  15 |  * @notice Contract with code pertaining to compression for zkEVM; at the moment this is used for bytecode compression
  :  |
     |  // @audit-issue Typo: diffs
     |  // @audit-issue Typo: zk
  17 |  * @dev Every deployed bytecode/published state diffs in zkEVM should be publicly restorable from the L1 data availability.
  :  |
     |  // @audit-issue Typo: pubdata
     |  // @audit-issue Typo: diffs
  20 |  * we publish pubdata, part of which contains the state diffs that occurred within the batch.
  :  |
     |     // @audit-issue Typo: bytecodes
  41 |     /// @dev Currently, the method may be called only from the bootloader because the server is not ready to publish bytecodes
     |     // @audit-issue Typo: bytecodes
  42 |     /// in internal transactions. However, in the future, we will allow everyone to publish compressed bytecodes.
  :  |
     |     // @audit-issue Typo: diffs
     |     // @audit-issue Typo: Diffs
  77 |     /// @notice Verifies that the compression of state diffs has been done correctly for the {_stateDiffs} param.
     |     // @audit-issue Typo: Diffs
     |     // @audit-issue Typo: diffs
  78 |     /// @param _numberOfStateDiffs The number of state diffs being checked.
  :  |
     |     // @audit-issue Typo: Diffs
  80 |     /// @param _stateDiffs Encoded full state diff structs. See the first dev comment below for encoding.
     |     // @audit-issue Typo: Diffs
     |     // @audit-issue Typo: diffs
  81 |     /// @param _compressedStateDiffs The compressed state diffs
     |     // @audit-issue Typo: Diffs
     |     // @audit-issue Typo: Diffs
  82 |     /// @dev We don't verify that the size of {_stateDiffs} is equivalent to {_numberOfStateDiffs} * STATE_DIFF_ENTRY_SIZE since that check is
  :  |
     |     // @audit-issue Typo: diffs
  84 |     /// @return stateDiffHash Hash of the encoded (uncompressed) state diffs to be committed to via system log.
     |     // @audit-issue Typo: diffs
     |     // @audit-issue Typo: diffs
  85 |     /// @dev This check assumes that the ordering of state diffs are sorted by (address, key) for the encoded state diffs and
```
GitHub: [14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L14), [15](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L15), [17](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L17), [17](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L17), [20](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L20), [20](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L20), [41](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L41), [42](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L42), [77](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L77), [77](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L77), [78](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L78), [78](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L78), [80](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L80), [81](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L81), [81](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L81), [82](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L82), [82](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L82), [84](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L84), [85](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L85), [85](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L85)


```solidity
File: code/system-contracts/contracts/Constants.sol

     |  // @audit-issue Typo: zk
  18 |  /// @dev All the system contracts introduced by zkSync have their addresses
     |  // @audit-issue Typo: precompiles
  19 |  /// started from 2^15 in order to avoid collision with Ethereum precompiles.
  :  |
     |  // @audit-issue Typo: pubdata
     |  // @audit-issue Typo: pubdata
  37 |  /// @dev The number of ergs that need to be spent for a single byte of pubdata regardless of the pubdata price.
  :  |
     |  // @audit-issue Typo: pubdata
  40 |  /// - That it is not possible that the pubdata counter grows too high without spending proportional amount of computation.
  :  |
     |  // @audit-issue Typo: precompie
     |  // @audit-issue Typo: precompiles
  43 |  /// @dev The maximal possible address of an L1-like precompie. These precompiles maintain the following properties:
     |  // @audit-issue Typo: extcodehash
  44 |  /// - Their extcodehash is EMPTY_STRING_KECCAK
     |  // @audit-issue Typo: extcodesize
  45 |  /// - Their extcodesize is 0 despite having a bytecode formally deployed there.
  :  |
     |  // @audit-issue Typo: codehash
  59 |  // A contract that is allowed to deploy any codehash
  :  |
     |  // @audit-issue Typo: pubdata
 106 |  /// @dev While the "real" amount of pubdata that can be sent rarely exceeds the BLOB_SIZE_BYTES * MAX_NUMBER_OF_BLOBS, it is better to
  :  |
     |  // @audit-issue Typo: diffs
 127 |  /// @dev The length of the derived key in bytes inside compressed state diffs.
  :  |
     |  // @audit-issue Typo: diffs
 129 |  /// @dev The length of the enum index in bytes inside compressed state diffs.
  :  |
     |  // @audit-issue Typo: diffs
 131 |  /// @dev The length of value in bytes inside compressed state diffs.
  :  |
     |  // @audit-issue Typo: diffs
 139 |  /// @dev The position from which the initial writes start in the compressed state diffs.
  :  |
     |  // @audit-issue Typo: diffs
 142 |  /// @dev Each storage diffs consists of the following elements:
  :  |
     |  // @audit-issue Typo: deriived
 144 |  /// @dev The offset of the deriived key in a storage diff.
```
GitHub: [18](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Constants.sol#L18), [19](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Constants.sol#L19), [37](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Constants.sol#L37), [37](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Constants.sol#L37), [40](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Constants.sol#L40), [43](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Constants.sol#L43), [43](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Constants.sol#L43), [44](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Constants.sol#L44), [45](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Constants.sol#L45), [59](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Constants.sol#L59), [106](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Constants.sol#L106), [127](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Constants.sol#L127), [129](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Constants.sol#L129), [131](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Constants.sol#L131), [139](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Constants.sol#L139), [142](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Constants.sol#L142), [144](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Constants.sol#L144)


```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

     |  // @audit-issue Typo: matterlabs
  16 |  * @custom:security-contact security@matterlabs.dev
     |  // @audit-issue Typo: zk
  17 |  * @notice System smart contract that is responsible for deploying other smart contracts on zkSync.
  :  |
     |         // @audit-issue Typo: bytecodehash
 200 |         // The address on which to deploy the bytecodehash to
  :  |
     |         // @audit-issue Typo: bytecodes
 217 |         // the addresses to deploy the new bytecodes to and to assess whether overriding the AccountInfo for the "force-deployed"
  :  |
     |     // @audit-issue Typo: bytecodes
 235 |     /// @notice This method is to be used only during an upgrade to set bytecodes on specific addresses.
```
GitHub: [16](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L16), [17](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L17), [200](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L200), [217](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L217), [235](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L235)


```solidity
File: code/system-contracts/contracts/DefaultAccount.sol

     |  // @audit-issue Typo: matterlabs
  13 |  * @custom:security-contact security@matterlabs.dev
  :  |
     |  // @audit-issue Typo: bytecodes
  15 |  * @dev The bytecode of the contract is set by default for all addresses for which no other bytecodes are deployed.
  :  |
     |     // @audit-issue Typo: paramter
  65 |     /// @dev Besides the params above, it also accepts unused first paramter "_txHash", which
  :  |
     |     // @audit-issue Typo: signaure
 158 |     /// @return EIP1271_SUCCESS_RETURN_VALUE if the signaure is correct. It reverts otherwise.
  :  |
     |         // @audit-issue Typo: ecrecover
 175 |         // EIP-2 still allows signature malleability for ecrecover(). Remove this possibility and make the signature
```
GitHub: [13](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L13), [15](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L15), [65](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L65), [158](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L158), [175](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L175)


```solidity
File: code/system-contracts/contracts/EmptyContract.sol

     |  // @audit-issue Typo: matterlabs
   7 |  * @custom:security-contact security@matterlabs.dev
```
GitHub: [7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/EmptyContract.sol#L7)


```solidity
File: code/system-contracts/contracts/ImmutableSimulator.sol

     |  // @audit-issue Typo: matterlabs
  10 |  * @custom:security-contact security@matterlabs.dev
```
GitHub: [10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ImmutableSimulator.sol#L10)


```solidity
File: code/system-contracts/contracts/KnownCodesStorage.sol

     |  // @audit-issue Typo: matterlabs
  12 |  * @custom:security-contact security@matterlabs.dev
  :  |
     |     // @audit-issue Typo: bytecodes
  26 |     /// @param _hashes Hashes of the bytecodes to be marked as known.
  :  |
     |     // @audit-issue Typo: bytecodehash
  71 |     /// @notice Validates the format of bytecodehash
     |     // @audit-issue Typo: zk
  72 |     /// @dev zk-circuit accepts & handles only valid format of bytecode hash, other input has undefined behavior
```
GitHub: [12](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/KnownCodesStorage.sol#L12), [26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/KnownCodesStorage.sol#L26), [71](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/KnownCodesStorage.sol#L71), [72](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/KnownCodesStorage.sol#L72)


```solidity
File: code/system-contracts/contracts/L1Messenger.sol

     |  // @audit-issue Typo: matterlabs
  14 |  * @custom:security-contact security@matterlabs.dev
  :  |
     |  // @audit-issue Typo: Zk
  16 |  * @dev by default ZkSync can send fixed length messages on L1.
  :  |
     |         // @audit-issue Typo: Pubdata
  85 |         // We need to charge cost of hashing, as it will be used in `publishPubdataAndClearState`:
  :  |
     |         // @audit-issue Typo: pubdata
 135 |         // Get cost of one byte pubdata in gas from context.
  :  |
     |             // @audit-issue Typo: Pubdata
 138 |             // 4 bytes used to encode the length of the message (see `publishPubdataAndClearState`)
  :  |
     |         // @audit-issue Typo: Pubdata
 143 |         // We need to charge cost of hashing, as it will be used in `publishPubdataAndClearState`:
  :  |
     |             // @audit-issue Typo: Pubdata
 170 |             // 4 bytes used to encode the length of the bytecode (see `publishPubdataAndClearState`)
  :  |
     |         // @audit-issue Typo: Pubdata
 174 |         // We need to charge cost of hashing, as it will be used in `publishPubdataAndClearState`
  :  |
     |     // @audit-issue Typo: Pubdata
     |     // @audit-issue Typo: Diffs
 184 |     /// @notice Verifies that the {_totalL2ToL1PubdataAndStateDiffs} reflects what occurred within the L1Batch and that
     |     // @audit-issue Typo: statediffs
     |     // @audit-issue Typo: diffs
 185 |     ///         the compressed statediffs are equivalent to the full state diffs.
     |     // @audit-issue Typo: Pubdata
     |     // @audit-issue Typo: Diffs
     |     // @audit-issue Typo: pubdata
     |     // @audit-issue Typo: diffs
 186 |     /// @param _totalL2ToL1PubdataAndStateDiffs The total pubdata and uncompressed state diffs of transactions that were
     |     // @audit-issue Typo: Pubdata
     |     // @audit-issue Typo: diffs
 187 |     ///        processed in the current L1 Batch. Pubdata consists of L2 to L1 Logs, messages, deployed bytecode, and state diffs.
  :  |
     |     // @audit-issue Typo: Pubdata
 189 |     /// @dev Checks that totalL2ToL1Pubdata is strictly packed data that should to be published to L1.
     |     // @audit-issue Typo: diffs
 190 |     /// @dev The data passed in also contains the encoded state diffs to be checked again, however this is aux data that is not
     |     // @audit-issue Typo: pubdata
 191 |     ///      part of the committed pubdata.
  :  |
     |         // @audit-issue Typo: bytecodes
 250 |         /// Check bytecodes
  :  |
     |         // @audit-issue Typo: Diffs
 274 |         /// Check State Diffs
  :  |
     |         // @audit-issue Typo: diffs
     |         // @audit-issue Typo: Diffs
     |         // @audit-issue Typo: diffs
 277 |         /// body (`compressedStateDiffSize` bytes, 4 bytes number of state diffs, `numberOfStateDiffs` * `STATE_DIFF_ENTRY_SIZE` bytes for the uncompressed state diffs)
     |         // @audit-issue Typo: diffs
 278 |         /// encoded state diffs: [20bytes address][32bytes key][32bytes derived key][8bytes enum index][32bytes initial value][32bytes final value]
```
GitHub: [14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L14), [16](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L16), [85](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L85), [135](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L135), [138](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L138), [143](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L143), [170](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L170), [174](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L174), [184](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L184), [184](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L184), [185](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L185), [185](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L185), [186](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L186), [186](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L186), [186](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L186), [186](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L186), [187](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L187), [187](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L187), [189](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L189), [190](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L190), [191](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L191), [250](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L250), [274](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L274), [277](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L277), [277](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L277), [277](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L277), [278](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L278)


```solidity
File: code/system-contracts/contracts/L2BaseToken.sol

     |  // @audit-issue Typo: matterlabs
  12 |  * @custom:security-contact security@matterlabs.dev
```
GitHub: [12](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L2BaseToken.sol#L12)


```solidity
File: code/system-contracts/contracts/MsgValueSimulator.sol

     |  // @audit-issue Typo: matterlabs
  13 |  * @custom:security-contact security@matterlabs.dev
     |  // @audit-issue Typo: zk
  14 |  * @notice The contract responsible for simulating transactions with `msg.value` inside zkEVM.
  :  |
     |     // @audit-issue Typo: callee
  21 |     /// @dev The contract accepts value, the callee and whether the call should be a system one via its ABI params.
  :  |
     |     // @audit-issue Typo: callee
  24 |     /// The second ABI params contains the callee.
  :  |
     |     // @audit-issue Typo: callee
  35 |     /// @notice The maximal number of gas out of the stipend that should be passed to the callee.
  :  |
     |     // @audit-issue Typo: callee
  44 |     /// @dev The contract accepts value, the callee and whether the call should be a system one via its ABI params.
     |     // @audit-issue Typo: callee
  45 |     /// @param _data The calldata to be passed to the callee.
     |     // @audit-issue Typo: callee
  46 |     /// @return The return data from the callee.
  :  |
     |         // @audit-issue Typo: gasleft
  52 |         // by the time we retrieve it, some gas might have already been spent, e.g. on the `gasleft` opcode itself.
  :  |
     |         // @audit-issue Typo: callee
  59 |         // Prevent mimic call to the MsgValueSimulator to prevent an unexpected change of callee.
  :  |
     |             // @audit-issue Typo: callee
  74 |             // If value is non-zero, we also provide additional gas to the callee.
```
GitHub: [13](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/MsgValueSimulator.sol#L13), [14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/MsgValueSimulator.sol#L14), [21](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/MsgValueSimulator.sol#L21), [24](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/MsgValueSimulator.sol#L24), [35](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/MsgValueSimulator.sol#L35), [44](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/MsgValueSimulator.sol#L44), [45](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/MsgValueSimulator.sol#L45), [46](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/MsgValueSimulator.sol#L46), [52](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/MsgValueSimulator.sol#L52), [59](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/MsgValueSimulator.sol#L59), [74](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/MsgValueSimulator.sol#L74)


```solidity
File: code/system-contracts/contracts/NonceHolder.sol

     |  // @audit-issue Typo: matterlabs
  12 |  * @custom:security-contact security@matterlabs.dev
```
GitHub: [12](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/NonceHolder.sol#L12)


```solidity
File: code/system-contracts/contracts/PubdataChunkPublisher.sol

     |  // @audit-issue Typo: matterlabs
  13 |  * @custom:security-contact security@matterlabs.dev
     |  // @audit-issue Typo: pubdata
  14 |  * @notice Smart contract for chunking pubdata into the appropriate size for EIP-4844 blobs.
  :  |
     |     // @audit-issue Typo: pubdata
  17 |     /// @notice Chunks pubdata into pieces that can fit into blobs.
     |     // @audit-issue Typo: pubdata
  18 |     /// @param _pubdata The total l2 to l1 pubdata that will be sent via L1 blobs.
  :  |
     |     // @audit-issue Typo: pubdata
  20 |     /// @dev We always publish 2 system logs even if our pubdata fits into a single blob. This makes processing logs on L1 easier.
  :  |
     |             // @audit-issue Typo: pubdata
  39 |             // We break if the pubdata isn't enough to cover 2 blobs. On L1 it is expected that the hash
```
GitHub: [13](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/PubdataChunkPublisher.sol#L13), [14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/PubdataChunkPublisher.sol#L14), [17](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/PubdataChunkPublisher.sol#L17), [18](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/PubdataChunkPublisher.sol#L18), [20](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/PubdataChunkPublisher.sol#L20), [39](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/PubdataChunkPublisher.sol#L39)


```solidity
File: code/system-contracts/contracts/SystemContext.sol

     |  // @audit-issue Typo: matterlabs
  13 |  * @custom:security-contact security@matterlabs.dev
  :  |
     |     // @audit-issue Typo: basefee
  46 |     /// @notice The `block.basefee`.
  :  |
     |     // @audit-issue Typo: miniblocks
  65 |     /// of the miniblocks cheaper, we only store the previous MINIBLOCK_HASHES_TO_STORE ones. Since whenever we need to publish a state
  :  |
     |     // @audit-issue Typo: miniblock
  67 |     /// By having this data in a cyclic array of MINIBLOCK_HASHES_TO_STORE blocks, we bring the costs down by 40% (i.e. 40 bytes per miniblock instead of 64 bytes).
     |     // @audit-issue Typo: miniblock
  68 |     /// @dev The hash of a miniblock with number N would be stored under slot N%MINIBLOCK_HASHES_TO_STORE.
  :  |
     |     // @audit-issue Typo: blockhash
  73 |     /// about which will be returned by the EVM-like methods: block.number/block.timestamp/blockhash.
  :  |
     |     // @audit-issue Typo: pubdata
  91 |     /// @notice The current gas per pubdata byte
  :  |
     |     // @audit-issue Typo: pubdata
  94 |     /// @notice The number of pubdata spent as of the start of the transaction
  :  |
     |     // @audit-issue Typo: pubdata
 109 |     /// @notice Sets the number of L2 gas that is needed to pay a single byte of pubdata.
  :  |
     |     // @audit-issue Typo: pubdata
 111 |     /// to access the current gas price for the pubdata.
  :  |
     |     // @audit-issue Typo: blockhash
 126 |     /// @notice The method that emulates `blockhash` opcode in EVM.
     |     // @audit-issue Typo: blockhash
 127 |     /// @dev Just like the blockhash in the EVM, it returns bytes32(0),
  :  |
     |     // @audit-issue Typo: zksolc
     |     // @audit-issue Typo: blockhash
 129 |     /// @dev Since zksolc compiler calls this method to emulate `blockhash`,
  :  |
     |     // @audit-issue Typo: blockhash
 131 |     /// @return hash The blockhash of the block with the given number.
  :  |
     |         // @audit-issue Typo: retreiving
     |         // @audit-issue Typo: blockhash
 137 |         // Due to virtual blocks upgrade, we'll have to use the following logic for retreiving the blockhash:
  :  |
     |     // @audit-issue Typo: zksolc
 187 |     /// @dev Since zksolc compiler calls this method to emulate `block.number`,
  :  |
     |     // @audit-issue Typo: zksolc
 195 |     /// @dev Since zksolc compiler calls this method to emulate `block.timestamp`,
  :  |
     |     // @audit-issue Typo: Txs
 220 |     /// @param _blockTxsRollingHash The rolling hash of the transactions in the L2 block.
  :  |
     |         // @audit-issue Typo: Reseting
 321 |         // Reseting the rolling hash
  :  |
     |         // @audit-issue Typo: pubdata
 415 |         // In order to spend less pubdata, the packed version is published
```
GitHub: [13](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L13), [46](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L46), [65](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L65), [67](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L67), [68](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L68), [73](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L73), [91](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L91), [94](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L94), [109](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L109), [111](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L111), [126](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L126), [127](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L127), [129](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L129), [129](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L129), [131](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L131), [137](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L137), [137](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L137), [187](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L187), [195](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L195), [220](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L220), [321](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L321), [415](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L415)


```solidity
File: code/system-contracts/contracts/GasBoundCaller.sol

     |  // @audit-issue Typo: matterlabs
  10 |  * @custom:security-contact security@matterlabs.dev
  :  |
     |     // @audit-issue Typo: pubdata
  24 |     /// @dev On Era, the gas for pubdata is charged at the end of the execution of the entire transaction, meaning
     |     // @audit-issue Typo: subcall
     |     // @audit-issue Typo: pubdata
  25 |     /// that if a subcall is not trusted, it can consume lots of pubdata in the process. This function ensures that
  :  |
     |     // @audit-issue Typo: callee
     |     // @audit-issue Typo: callee
  31 |     /// @dev The function relays the `returndata` returned by the callee. In case the `callee` reverts, it reverts with the same error.
  :  |
     |         // @audit-issue Typo: pubdata
  48 |         // This is the amount of gas that can be spent *exclusively* on pubdata in addition to the `gas` provided to this function.
  :  |
     |         // @audit-issue Typo: pubdata
  55 |         // Since the revert is propagated, the pubdata published wouldn't change and so no
  :  |
     |         // @audit-issue Typo: pubdata
     |         // @audit-issue Typo: pubdata
  61 |         // It is possible that pubdataPublishedAfter < pubdataPublishedBefore if the call, e.g. removes
     |         // @audit-issue Typo: diffs
  62 |         // some of the previously created state diffs
  :  |
     |         // @audit-issue Typo: wouldbn
  69 |         // In case there is an overflow here, the `_maxTotalGas` wouldbn't be able to cover it anyway, so
  :  |
     |             // @audit-issue Typo: gasleft
     |             // @audit-issue Typo: pubdata
  75 |             // Note, that the `gasleft()` can be spent on pubdata too.
```
GitHub: [10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/GasBoundCaller.sol#L10), [24](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/GasBoundCaller.sol#L24), [25](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/GasBoundCaller.sol#L25), [25](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/GasBoundCaller.sol#L25), [31](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/GasBoundCaller.sol#L31), [31](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/GasBoundCaller.sol#L31), [48](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/GasBoundCaller.sol#L48), [55](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/GasBoundCaller.sol#L55), [61](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/GasBoundCaller.sol#L61), [61](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/GasBoundCaller.sol#L61), [62](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/GasBoundCaller.sol#L62), [69](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/GasBoundCaller.sol#L69), [75](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/GasBoundCaller.sol#L75), [75](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/GasBoundCaller.sol#L75)


```solidity
File: code/system-contracts/contracts/libraries/EfficientCall.sol

     |  // @audit-issue Typo: matterlabs
  11 |  * @custom:security-contact security@matterlabs.dev
     |  // @audit-issue Typo: zk
  12 |  * @notice This library is used to perform ultra-efficient calls using zkEVM-specific features.
  :  |
     |  // @audit-issue Typo: zk
  16 |  * In turn, zkEVM operates over a fat pointer, which is a set of (memory page, offset, start, length) in the memory/calldata/returndata.
  :  |
     |  // @audit-issue Typo: zk
     |  // @audit-issue Typo: wellformed
  19 |  * zkEVM creates the wellformed fat pointers for all the calldata/returndata regions, later
  :  |
     |  // @audit-issue Typo: opcodes
  27 |  * @dev The call opcodes accept the fat pointer and change it to its canonical form before passing it to the child call
  :  |
     |             // @audit-issue Typo: rollup
 267 |             // Only rollup is supported for now
```
GitHub: [11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L11), [12](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L12), [16](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L16), [19](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L19), [19](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L19), [27](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L27), [267](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L267)


```solidity
File: code/system-contracts/contracts/libraries/RLPEncoder.sol

     |  // @audit-issue Typo: matterlabs
   7 |  * @custom:security-contact security@matterlabs.dev
  :  |
     |     // @audit-issue Typo: endian
  82 |     /// @notice Uses little endian ordering (The least significant byte has index `0`).
```
GitHub: [7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/RLPEncoder.sol#L7), [82](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/RLPEncoder.sol#L82)


```solidity
File: code/system-contracts/contracts/libraries/SystemContractHelper.sol

     |  // @audit-issue Typo: Zk
  14 |  /// @notice NOTE: The `getZkSyncMeta` that is used to obtain this struct will experience a breaking change in 2024.
  :  |
     |   // @audit-issue Typo: matterlabs
  34 |   * @custom:security-contact security@matterlabs.dev
     |   // @audit-issue Typo: zk
     |   // @audit-issue Typo: opcodes
  35 |   * @notice Library used for accessing zkEVM-specific opcodes, needed for the development
  :  |
     |   // @audit-issue Typo: possilbe
  38 |   * methods won't work for non-system contracts and also breaking changes at short notice are possilbe.
  :  |
     |      // @audit-issue Typo: precompilecall
 122 |      /// each precompile. For information, please read the documentation of the precompilecall log in
  :  |
     |      // @audit-issue Typo: precompiles
     |      // @audit-issue Typo: ecrecover
 143 |      /// @dev The list of currently available precompiles sha256, keccak256, ecrecover.
  :  |
     |      // @audit-issue Typo: precompiles
 145 |      /// system contracts corresponding to the list of precompiles above can do `precompileCall`.
     |      // @audit-issue Typo: ecrecover
 146 |      /// @dev If used not in the `sha256`, `keccak256` or `ecrecover` contracts, it will just burn the gas provided.
  :  |
     |      // @audit-issue Typo: Zk
 198 |      /// @notice Get the packed representation of the `ZkSyncMeta` from the current context.
  :  |
     |      // @audit-issue Typo: Zk
 200 |      /// @return meta The packed representation of the ZkSyncMeta.
     |      // @audit-issue Typo: Zk
 201 |      /// @dev The fields in ZkSyncMeta are NOT tightly packed, i.e. there is a special rule on how
     |      // @audit-issue Typo: Zk
 202 |      /// they are packed. For more information, please read the documentation on ZkSyncMeta.
  :  |
     |      // @audit-issue Typo: Zk
 211 |      /// @param meta Packed representation of the ZkSyncMeta.
  :  |
     |      // @audit-issue Typo: Zk
 222 |      /// @notice Given the packed representation of `ZkSyncMeta`, retrieves the number of gas
     |      // @audit-issue Typo: pubdata
 223 |      /// that a single byte sent to L1 as pubdata costs.
  :  |
     |      // @audit-issue Typo: Zk
 225 |      /// @param meta Packed representation of the ZkSyncMeta.
     |      // @audit-issue Typo: pubdata
     |      // @audit-issue Typo: pubdata
 226 |      /// @return pubdataPublished The current price in gas per pubdata byte.
  :  |
     |      // @audit-issue Typo: Zk
 231 |      /// @notice Given the packed representation of `ZkSyncMeta`, retrieves the number of the current size
  :  |
     |      // @audit-issue Typo: Zk
 233 |      /// @param meta Packed representation of the ZkSyncMeta.
  :  |
     |      // @audit-issue Typo: Zk
 235 |      /// @dev The following expression: getHeapSizeFromMeta(getZkSyncMetaBytes()) is
  :  |
     |      // @audit-issue Typo: Zk
 241 |      /// @notice Given the packed representation of `ZkSyncMeta`, retrieves the number of the current size
     |      // @audit-issue Typo: auxilary
 242 |      /// of the auxilary heap in bytes.
     |      // @audit-issue Typo: Zk
 243 |      /// @param meta Packed representation of the ZkSyncMeta.
     |      // @audit-issue Typo: auxilary
 244 |      /// @return auxHeapSize The size of the auxilary memory in bytes byte.
     |      // @audit-issue Typo: auxilary
 245 |      /// @dev You can read more on auxilary memory in the VM1.2 documentation.
  :  |
     |      // @audit-issue Typo: Zk
 250 |      /// @notice Given the packed representation of `ZkSyncMeta`, retrieves the shardId of `this`.
     |      // @audit-issue Typo: Zk
 251 |      /// @param meta Packed representation of the ZkSyncMeta.
  :  |
     |      // @audit-issue Typo: zk
     |      // @audit-issue Typo: Rollup
 253 |      /// @dev Currently only shard 0 (zkRollup) is supported.
  :  |
     |      // @audit-issue Typo: Zk
 258 |      /// @notice Given the packed representation of `ZkSyncMeta`, retrieves the shardId of
  :  |
     |      // @audit-issue Typo: Zk
 260 |      /// @param meta Packed representation of the ZkSyncMeta.
  :  |
     |      // @audit-issue Typo: zk
     |      // @audit-issue Typo: Rollup
 262 |      /// @dev Currently only shard 0 (zkRollup) is supported.
  :  |
     |      // @audit-issue Typo: Zk
 267 |      /// @notice Given the packed representation of `ZkSyncMeta`, retrieves the shardId of
  :  |
     |      // @audit-issue Typo: Zk
 269 |      /// @param meta Packed representation of the ZkSyncMeta.
  :  |
     |      // @audit-issue Typo: zk
     |      // @audit-issue Typo: Rollup
 271 |      /// @dev Currently only shard 0 (zkRollup) is supported.
  :  |
     |      // @audit-issue Typo: Zk
 276 |      /// @notice Retrieves the ZkSyncMeta structure.
  :  |
     |      // @audit-issue Typo: Zk
 278 |      /// @return meta The ZkSyncMeta execution context parameters.
  :  |
     |      // @audit-issue Typo: bitmask
     |      // @audit-issue Typo: callflags
 290 |      /// @return callFlags The bitmask of the callflags.
  :  |
     |      // @audit-issue Typo: Retuns
 327 |      /// @notice Retuns whether the current call is a system call.
```
GitHub: [14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L14), [34](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L34), [35](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L35), [35](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L35), [38](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L38), [122](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L122), [143](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L143), [143](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L143), [145](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L145), [146](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L146), [198](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L198), [200](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L200), [201](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L201), [202](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L202), [211](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L211), [222](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L222), [223](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L223), [225](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L225), [226](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L226), [226](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L226), [231](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L231), [233](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L233), [235](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L235), [241](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L241), [242](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L242), [243](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L243), [244](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L244), [245](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L245), [250](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L250), [251](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L251), [253](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L253), [253](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L253), [258](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L258), [260](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L260), [262](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L262), [262](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L262), [267](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L267), [269](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L269), [271](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L271), [271](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L271), [276](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L276), [278](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L278), [290](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L290), [290](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L290), [327](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L327)


```solidity
File: code/system-contracts/contracts/libraries/SystemContractsCaller.sol

     |  // @audit-issue Typo: zk
     |  // @audit-issue Typo: opcodes
   9 |  // zkSync-specific opcodes during the compilation.
  :  |
     |  // @audit-issue Typo: Yul
  11 |  // only if used in-place by Yul optimizer.
  :  |
     |   // @audit-issue Typo: matterlabs
  64 |   * @custom:security-contact security@matterlabs.dev
  :  |
     |              // @audit-issue Typo: rollup
  91 |              // Only rollup is supported for now
  :  |
     |      // @audit-issue Typo: Ptr
 249 |      /// @return farCallAbiWithEmptyFatPtr The far call ABI with zero fat pointer fields.
```
GitHub: [9](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L9), [9](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L9), [11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L11), [64](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L64), [91](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L91), [249](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L249)


```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

     |  // @audit-issue Typo: zk
  14 |  /// @dev The type id of zkSync's EIP-712-signed transaction.
  :  |
     |  // @audit-issue Typo: zk
  24 |  /// @notice Structure used to represent a zkSync transaction.
  :  |
     |      // @audit-issue Typo: callee
  30 |      // The callee.
  :  |
     |      // @audit-issue Typo: pubdata
  35 |      // The maximum amount of gas the user is willing to pay for a byte of pubdata.
  :  |
     |      // @audit-issue Typo: bytecodes
  62 |      // The properly formatted hashes of bytecodes that must be published on L1
  :  |
     |   // @audit-issue Typo: matterlabs
  75 |   * @custom:security-contact security@matterlabs.dev
  :  |
     |      // @audit-issue Typo: EOAs
  99 |      /// i.e. the hash that is signed by EOAs and is recommended to be signed by other accounts.
  :  |
     |      // @audit-issue Typo: zk
 116 |      /// @notice Encode hash of the zkSync native transaction type.
  :  |
     |          // @audit-issue Typo: zk
 223 |          // Note, that on zkSync access lists are not supported and should always be empty.
  :  |
     |          // @audit-issue Typo: zk
 260 |          // On zkSync, access lists are always zero length (at least for now).
  :  |
     |          // @audit-issue Typo: zk
 293 |          // Note, that on zkSync access lists are not supported and should always be empty.
  :  |
     |          // @audit-issue Typo: zk
 332 |          // On zkSync, access lists are always zero length (at least for now).
  :  |
     |                  // @audit-issue Typo: firsty
 379 |                  // Some tokens, e.g. USDT require that the allowance is firsty set to zero
```
GitHub: [14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L14), [24](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L24), [30](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L30), [35](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L35), [62](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L62), [75](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L75), [99](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L99), [116](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L116), [223](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L223), [260](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L260), [293](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L293), [332](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L332), [379](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L379)


```solidity
File: code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol

     |  // @audit-issue Typo: matterlabs
   7 |  * @custom:security-contact security@matterlabs.dev
```
GitHub: [7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol#L7)


```solidity
File: code/system-contracts/contracts/libraries/Utils.sol

     |  // @audit-issue Typo: matterlabs
   8 |  * @custom:security-contact security@matterlabs.dev
     |  // @audit-issue Typo: zk
   9 |  * @dev Common utilities used in zkSync system contracts
```
GitHub: [8](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L8), [9](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L9)


```solidity
File: code/system-contracts/contracts/interfaces/IAccount.sol

     |  // @audit-issue Typo: EOAs
  13 |  /// @param _suggestedSignedHash The hash of the transaction is signed by EOAs
```
GitHub: [13](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IAccount.sol#L13)


```solidity
File: code/system-contracts/contracts/interfaces/IComplexUpgrader.sol

     |  // @audit-issue Typo: matterlabs
   7 |  * @custom:security-contact security@matterlabs.dev
```
GitHub: [7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IComplexUpgrader.sol#L7)


```solidity
File: code/system-contracts/contracts/interfaces/ICompressor.sol

     |  // @audit-issue Typo: bitmask
   5 |  // The bitmask by applying which to the compressed state diff metadata we retrieve its operation.
  :  |
     |   // @audit-issue Typo: matterlabs
  14 |   * @custom:security-contact security@matterlabs.dev
  :  |
     |   // @audit-issue Typo: diffs
     |   // @audit-issue Typo: bytecodes
  16 |   * the compression of the state diffs and bytecodes.
```
GitHub: [5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ICompressor.sol#L5), [14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ICompressor.sol#L14), [16](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ICompressor.sol#L16), [16](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ICompressor.sol#L16)


```solidity
File: code/system-contracts/contracts/interfaces/IContractDeployer.sol

     |  // @audit-issue Typo: EOAs
  18 |  /// at a time (the same as EOAs).
```
GitHub: [18](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IContractDeployer.sol#L18)


```solidity
File: code/system-contracts/contracts/interfaces/IKnownCodesStorage.sol

     |  // @audit-issue Typo: matterlabs
   7 |  * @custom:security-contact security@matterlabs.dev
  :  |
     |  // @audit-issue Typo: bytecodes
   9 |  * for storing the hashes of the bytecodes that have been published to the network.
```
GitHub: [7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IKnownCodesStorage.sol#L7), [9](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IKnownCodesStorage.sol#L9)


```solidity
File: code/system-contracts/contracts/interfaces/IL1Messenger.sol

     |  // @audit-issue Typo: rollup
   6 |  /// @param l2ShardId The shard identifier, 0 - rollup, 1 - porter. All other values are not used but are reserved for the future
  :  |
     |   // @audit-issue Typo: matterlabs
  37 |   * @custom:security-contact security@matterlabs.dev
```
GitHub: [6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL1Messenger.sol#L6), [37](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL1Messenger.sol#L37)


```solidity
File: code/system-contracts/contracts/interfaces/IPaymaster.sol

     |  // @audit-issue Typo: amout
  40 |  /// @param _maxRefundedGas, the upper bound on the amout of gas that could be refunded to the paymaster.
```
GitHub: [40](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IPaymaster.sol#L40)


```solidity
File: code/system-contracts/contracts/interfaces/IPaymasterFlow.sol

     |  // @audit-issue Typo: implementated
   9 |  * @notice This is NOT an interface to be implementated
```
GitHub: [9](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IPaymasterFlow.sol#L9)


```solidity
File: code/system-contracts/contracts/interfaces/IPubdataChunkPublisher.sol

     |  // @audit-issue Typo: matterlabs
   6 |  * @custom:security-contact security@matterlabs.dev
     |  // @audit-issue Typo: pubdata
   7 |  * @notice Interface for contract responsible chunking pubdata into the appropriate size for EIP-4844 blobs.
  :  |
     |     // @audit-issue Typo: pubdata
  10 |     /// @notice Chunks pubdata into pieces that can fit into blobs.
     |     // @audit-issue Typo: pubdata
  11 |     /// @param _pubdata The total l2 to l1 pubdata that will be sent via L1 blobs.
```
GitHub: [6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IPubdataChunkPublisher.sol#L6), [7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IPubdataChunkPublisher.sol#L7), [10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IPubdataChunkPublisher.sol#L10), [11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IPubdataChunkPublisher.sol#L11)


```solidity
File: code/system-contracts/contracts/interfaces/ISystemContext.sol

     |  // @audit-issue Typo: matterlabs
   7 |  * @custom:security-contact security@matterlabs.dev
  :  |
     |     // @audit-issue Typo: timeline
  17 |     /// @notice A structure representing the timeline for the upgrade from the batch numbers to the L2 block numbers.
  :  |
     |         // @audit-issue Typo: blockhash
  20 |         /// @notice In order to maintain consistent results for `blockhash` requests, we'll
```
GitHub: [7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L7), [17](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L17), [20](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L20)


```solidity
File: code/system-contracts/contracts/interfaces/ISystemContextDeprecated.sol

     |  // @audit-issue Typo: matterlabs
   7 |  * @custom:security-contact security@matterlabs.dev
```
GitHub: [7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContextDeprecated.sol#L7)


```solidity
File: code/system-contracts/contracts/interfaces/ISystemContract.sol

     |  // @audit-issue Typo: matterlabs
  10 |  * @custom:security-contact security@matterlabs.dev
```
GitHub: [10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContract.sol#L10)


```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

     |  // @audit-issue Typo: matterlabs
  20 |  /// @custom:security-contact security@matterlabs.dev
```
GitHub: [20](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L20)


```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

     |  // @audit-issue Typo: matterlabs
  12 |  /// @custom:security-contact security@matterlabs.dev
  :  |
     |      // @audit-issue Typo: reinitialization
 110 |      /// to ensure that the governor can not accidentally disable future reinitialization of the token.
  :  |
     |          // @audit-issue Typo: reinitialization
 136 |          // future reinitialization of the token by providing too large a version.
```
GitHub: [12](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L12), [110](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L110), [136](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L136)


```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL1SharedBridge.sol

     |  // @audit-issue Typo: matterlabs
   7 |  /// @custom:security-contact security@matterlabs.dev
```
GitHub: [7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL1SharedBridge.sol#L7)


```solidity
File: code/contracts/zksync/contracts/interfaces/IPaymaster.sol

     |  // @audit-issue Typo: amout
  40 |  /// @param _maxRefundedGas, the upper bound on the amout of gas that could be refunded to the paymaster.
```
GitHub: [40](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/interfaces/IPaymaster.sol#L40)


```solidity
File: code/contracts/zksync/contracts/interfaces/IPaymasterFlow.sol

     |  // @audit-issue Typo: matterlabs
   7 |  * @custom:security-contact security@matterlabs.dev
  :  |
     |  // @audit-issue Typo: implementated
  10 |  * @notice This is NOT an interface to be implementated
```
GitHub: [7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/interfaces/IPaymasterFlow.sol#L7), [10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/interfaces/IPaymasterFlow.sol#L10)


```solidity
File: code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol

     |  // @audit-issue Typo: http
     |  // @audit-issue Typo: www
  10 |  *    http://www.apache.org/licenses/LICENSE-2.0
  :  |
     |     // @audit-issue Typo: inbox
  25 |     /// to the inbox on L1 to the msg.sender viewed on L2
  :  |
     |     // @audit-issue Typo: inbox
  35 |     /// address that submitted a tx to the inbox on L1
```
GitHub: [10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol#L10), [10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol#L10), [25](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol#L25), [35](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol#L35)


```solidity
File: code/contracts/zksync/contracts/ForceDeployUpgrader.sol

     |  // @audit-issue Typo: matterlabs
   7 |  /// @custom:security-contact security@matterlabs.dev
```
GitHub: [7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/ForceDeployUpgrader.sol#L7)


```solidity
File: code/contracts/zksync/contracts/L2ContractHelper.sol

     |   // @audit-issue Typo: matterlabs
   7 |   * @custom:security-contact security@matterlabs.dev
  :  |
     |   // @audit-issue Typo: Zk
   9 |   * @dev by default ZkSync can send fixed-length messages on L1.
  :  |
     |   // @audit-issue Typo: matterlabs
  27 |   * @custom:security-contact security@matterlabs.dev
  :  |
     |      // @audit-issue Typo: bytecodehash
  33 |      /// @param newAddress The address on which to deploy the bytecodehash to.
  :  |
     |      // @audit-issue Typo: bytecodes
  45 |      /// @notice This method is to be used only during an upgrade to set bytecodes on specific addresses.
  :  |
     |      // @audit-issue Typo: bytecodehash
  51 |      /// @param _bytecodeHash the bytecodehash of the new contract to be deployed
  :  |
     |   // @audit-issue Typo: matterlabs
  58 |   * @custom:security-contact security@matterlabs.dev
  :  |
     |   // @audit-issue Typo: matterlabs
  80 |   * @custom:security-contact security@matterlabs.dev
  :  |
     |  // @audit-issue Typo: zk
 116 |  /// @notice Structure used to represent a zkSync transaction.
  :  |
     |      // @audit-issue Typo: callee
 122 |      // The callee.
  :  |
     |      // @audit-issue Typo: pubdata
 127 |      // The maximum amount of gas the user is willing to pay for a byte of pubdata.
  :  |
     |      // @audit-issue Typo: bytecodes
 154 |      // The properly formatted hashes of bytecodes that must be published on L1
```
GitHub: [7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/L2ContractHelper.sol#L7), [9](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/L2ContractHelper.sol#L9), [27](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/L2ContractHelper.sol#L27), [33](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/L2ContractHelper.sol#L33), [45](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/L2ContractHelper.sol#L45), [51](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/L2ContractHelper.sol#L51), [58](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/L2ContractHelper.sol#L58), [80](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/L2ContractHelper.sol#L80), [116](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/L2ContractHelper.sol#L116), [122](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/L2ContractHelper.sol#L122), [127](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/L2ContractHelper.sol#L127), [154](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/L2ContractHelper.sol#L154)


```solidity
File: code/contracts/zksync/contracts/SystemContractsCaller.sol

     |  // @audit-issue Typo: repo
  35 |  /// @dev A more detailed description of the library and its methods can be found in the `system-contracts` repo.
  :  |
     |              // @audit-issue Typo: rollup
  52 |              // Only rollup is supported for now
```
GitHub: [35](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/SystemContractsCaller.sol#L35), [52](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/SystemContractsCaller.sol#L52)


```solidity
File: code/contracts/zksync/contracts/TestnetPaymaster.sol

     |  // @audit-issue Typo: testnet
  28 |  // the data is not needed for the testnet paymaster
  :  |
     |  // @audit-issue Typo: testnet
  38 |  // The testnet paymaster exchanges X wei of the token to the X wei of ETH.
```
GitHub: [28](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/TestnetPaymaster.sol#L28), [38](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/TestnetPaymaster.sol#L38)


```solidity
File: code/contracts/zksync/contracts/bridge/L2WrappedBaseToken.sol

     |  // @audit-issue Typo: matterlabs
  11 |  /// @custom:security-contact security@matterlabs.dev
  :  |
     |  // @audit-issue Typo: Rollup
     |  // @audit-issue Typo: upgradability
  22 |  /// But for now, when the Rollup has instant upgradability, we leave the possibility of upgrading to improve the contract if needed.
```
GitHub: [11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2WrappedBaseToken.sol#L11), [22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2WrappedBaseToken.sol#L22), [22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2WrappedBaseToken.sol#L22)


## [N-99] Unnecessary cast

Unnecessary casts can be removed.

*Instances: 17*

```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

     |  // @audit-issue Cast to uint256 is redundant
 268 |  bytes32(uint256(protocolVersion)),

     |  // @audit-issue Cast to bytes32 is redundant
 273 |  bytes32(storedBatchZero),
```
GitHub: [268](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L268), [273](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L273)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

     |  // @audit-issue Cast to bytes1 is redundant
  39 |  uint8 pubdataSource = uint8(bytes1(_newBatch.pubdataCommitments[0]));
```
GitHub: [39](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L39)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol

     |  // @audit-issue Cast to address is redundant
  48 |  return address(s.bridgehub);

     |  // @audit-issue Cast to address is redundant
  53 |  return address(s.stateTransitionManager);

     |  // @audit-issue Cast to address is redundant
  58 |  return address(s.baseToken);

     |  // @audit-issue Cast to address is redundant
  63 |  return address(s.baseTokenBridge);
```
GitHub: [48](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L48), [53](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L53), [58](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L58), [63](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L63)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

     |  // @audit-issue Cast to uint256 is redundant
 300 |  maxFeePerGas: uint256(_priorityOpParams.l2GasPrice),

     |  // @audit-issue Cast to uint256 is redundant
 304 |  nonce: uint256(_priorityOpParams.txId),
```
GitHub: [300](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L300), [304](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L304)


```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol

     |  // @audit-issue Cast to uint256 is redundant
  46 |  return uint256(_queue.tail - _queue.head);
```
GitHub: [46](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L46)


```solidity
File: code/system-contracts/contracts/Compressor.sol

     |  // @audit-issue Cast to bytes1 is redundant
 143 |  uint8 metadata = uint8(bytes1(_compressedStateDiffs[stateDiffPtr]));

     |  // @audit-issue Cast to bytes1 is redundant
 174 |  uint8 metadata = uint8(bytes1(_compressedStateDiffs[stateDiffPtr]));
```
GitHub: [143](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L143), [174](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L174)


```solidity
File: code/system-contracts/contracts/L1Messenger.sol

     |  // @audit-issue Cast to bytes1 is redundant
 280 |  uint256(uint8(bytes1(_totalL2ToL1PubdataAndStateDiffs[calldataPtr]))) ==

     |  // @audit-issue Cast to bytes1 is redundant
 289 |  uint8 enumerationIndexSize = uint8(bytes1(_totalL2ToL1PubdataAndStateDiffs[calldataPtr]));
```
GitHub: [280](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L280), [289](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L289)


```solidity
File: code/system-contracts/contracts/libraries/SystemContractHelper.sol

     |  // @audit-issue Cast to uint160 is redundant
 339 |  return uint160(_address) <= uint160(MAX_SYSTEM_CONTRACT_ADDRESS);
```
GitHub: [339](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L339)


```solidity
File: code/system-contracts/contracts/libraries/SystemContractsCaller.sol

     |  // @audit-issue Cast to uint32 is redundant
  83 |  uint32 dataLength = uint32(Utils.safeCastToU32(data.length));
```
GitHub: [83](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L83)


```solidity
File: code/contracts/zksync/contracts/SystemContractsCaller.sol

     |  // @audit-issue Cast to uint32 is redundant
  44 |  uint32 dataLength = uint32(Utils.safeCastToU32(data.length));
```
GitHub: [44](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/SystemContractsCaller.sol#L44)


## [N-100] Unresolved TODOs are present

Code architecture, incentives, and error handling/reporting questions/issues should be resolved before deployment.

*Instances: 2*

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

     |  // @audit-issue Resolve this TODO
 338 |  layer2Tip: uint192(0) // TODO: Restore after fee modeling will be stable. (SMA-1230)
```
GitHub: [338](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L338)


```solidity
File: code/contracts/ethereum/contracts/common/Config.sol

     |  // @audit-issue Resolve this TODO
  23 |  // TODO: change constant to the real root hash of empty Merkle tree (SMA-184)
```
GitHub: [23](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/Config.sol#L23)


## [N-101] Unused `event` definition

Note that there may be cases where an event superficially appears to be used, but this is only because there are multiple definitions of the event in different files. In such cases, the event definition should be moved into a separate file. The instances below are the unused definitions.

*Instances: 5*

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol

     |  // @audit-issue Unused by files in analysis scope
 134 |  event EthWithdrawalFinalized(address indexed to, uint256 amount);
```
GitHub: [134](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L134)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol

     |  // @audit-issue Unused by files in analysis scope
  17 |  event ProposeTransparentUpgrade(
  18 |      Diamond.DiamondCutData diamondCut,
  19 |      uint256 indexed proposalId,
  20 |      bytes32 proposalSalt
  21 |  );
```
GitHub: [17-21](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol#L17-L21)


```solidity
File: code/system-contracts/contracts/interfaces/IL2StandardToken.sol

     |  // @audit-issue Unused by files in analysis scope
   6 |  event BridgeMint(address indexed _account, uint256 _amount);
  :  |
     |  // @audit-issue Unused by files in analysis scope
   8 |  event BridgeBurn(address indexed _account, uint256 _amount);
```
GitHub: [6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL2StandardToken.sol#L6), [8](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL2StandardToken.sol#L8)


```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol

     |  // @audit-issue Unused by files in analysis scope
  22 |  event BaseTokenReceived(uint256 amount);
```
GitHub: [22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol#L22)


## [N-102] Unused `function` definition

Note that there may be cases where a function superficially appears to be used, but this is only because there are multiple definitions of the function in different files. In such cases, the function definition should be moved into a separate file. The instances below are the unused definitions *within the defined scope of analysis*. It is possible these functions are used outside the scope of the analysis.

*Instances: 72*

```solidity
File: code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol

     |  // @audit-issue hashL2Bytecode is unused by files in analysis scope
  21 |  function hashL2Bytecode(bytes memory _bytecode) internal pure returns (bytes32 hashedBytecode) {

     |  // @audit-issue validateBytecodeHash is unused by files in analysis scope
  39 |  function validateBytecodeHash(bytes32 _bytecodeHash) internal pure {

     |  // @audit-issue computeCreate2Address is unused by files in analysis scope
  60 |  function computeCreate2Address(
  61 |      address _sender,
  62 |      bytes32 _salt,
  63 |      bytes32 _bytecodeHash,
  64 |      bytes32 _constructorInputHash
  65 |  ) internal pure returns (address) {
```
GitHub: [21](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L21), [39](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L39), [60-65](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L60-L65)


```solidity
File: code/contracts/ethereum/contracts/common/libraries/UncheckedMath.sol

     |  // @audit-issue uncheckedInc is unused by files in analysis scope
  11 |  function uncheckedInc(uint256 _number) internal pure returns (uint256) {

     |  // @audit-issue uncheckedAdd is unused by files in analysis scope
  17 |  function uncheckedAdd(uint256 _lhs, uint256 _rhs) internal pure returns (uint256) {
```
GitHub: [11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/UncheckedMath.sol#L11), [17](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/UncheckedMath.sol#L17)


```solidity
File: code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol

     |  // @audit-issue readUint32 is unused by files in analysis scope
  19 |  function readUint32(bytes memory _bytes, uint256 _start) internal pure returns (uint32 result, uint256 offset) {

     |  // @audit-issue readAddress is unused by files in analysis scope
  26 |  function readAddress(bytes memory _bytes, uint256 _start) internal pure returns (address result, uint256 offset) {

     |  // @audit-issue readUint256 is unused by files in analysis scope
  33 |  function readUint256(bytes memory _bytes, uint256 _start) internal pure returns (uint256 result, uint256 offset) {

     |  // @audit-issue readBytes32 is unused by files in analysis scope
  40 |  function readBytes32(bytes memory _bytes, uint256 _start) internal pure returns (bytes32 result, uint256 offset) {
```
GitHub: [19](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol#L19), [26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol#L26), [33](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol#L33), [40](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/UnsafeBytes.sol#L40)


```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol

     |  // @audit-issue diamondCut is unused by files in analysis scope
  96 |  function diamondCut(DiamondCutData memory _diamondCut) internal {
```
GitHub: [96](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L96)


```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/LibMap.sol

     |  // @audit-issue get is unused by files in analysis scope
  18 |  function get(Uint32Map storage _map, uint256 _index) internal view returns (uint32 result) {

     |  // @audit-issue set is unused by files in analysis scope
  38 |  function set(Uint32Map storage _map, uint256 _index, uint32 _value) internal {
```
GitHub: [18](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/LibMap.sol#L18), [38](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/LibMap.sol#L38)


```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol

     |  // @audit-issue calculateRoot is unused by files in analysis scope
  18 |  function calculateRoot(
  19 |      bytes32[] calldata _path,
  20 |      uint256 _index,
  21 |      bytes32 _itemHash
  22 |  ) internal pure returns (bytes32) {
```
GitHub: [18-22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol#L18-L22)


```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol

     |  // @audit-issue getFirstUnprocessedPriorityTx is unused by files in analysis scope
  35 |  function getFirstUnprocessedPriorityTx(Queue storage _queue) internal view returns (uint256) {

     |  // @audit-issue getTotalPriorityTxs is unused by files in analysis scope
  40 |  function getTotalPriorityTxs(Queue storage _queue) internal view returns (uint256) {

     |  // @audit-issue getSize is unused by files in analysis scope
  45 |  function getSize(Queue storage _queue) internal view returns (uint256) {

     |  // @audit-issue pushBack is unused by files in analysis scope
  55 |  function pushBack(Queue storage _queue, PriorityOperation memory _operation) internal {

     |  // @audit-issue front is unused by files in analysis scope
  64 |  function front(Queue storage _queue) internal view returns (PriorityOperation memory) {

     |  // @audit-issue popFront is unused by files in analysis scope
  72 |  function popFront(Queue storage _queue) internal returns (PriorityOperation memory priorityOperation) {
```
GitHub: [35](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L35), [40](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L40), [45](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L45), [55](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L55), [64](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L64), [72](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/PriorityQueue.sol#L72)


```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol

     |  // @audit-issue validateL1ToL2Transaction is unused by files in analysis scope
  19 |  function validateL1ToL2Transaction(
  20 |      L2CanonicalTransaction memory _transaction,
  21 |      bytes memory _encoded,
  22 |      uint256 _priorityTxMaxGasLimit,
  23 |      uint256 _priorityTxMaxPubdata
  24 |  ) internal pure {

     |  // @audit-issue validateUpgradeTransaction is unused by files in analysis scope
  46 |  function validateUpgradeTransaction(L2CanonicalTransaction memory _transaction) internal pure {
```
GitHub: [19-24](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L19-L24), [46](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L46)


```solidity
File: code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol

     |  // @audit-issue applyL1ToL2Alias is unused by files in analysis scope
  28 |  function applyL1ToL2Alias(address l1Address) internal pure returns (address l2Address) {

     |  // @audit-issue undoL1ToL2Alias is unused by files in analysis scope
  38 |  function undoL1ToL2Alias(address l2Address) internal pure returns (address l1Address) {
```
GitHub: [28](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol#L28), [38](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol#L38)


```solidity
File: code/system-contracts/contracts/libraries/EfficientCall.sol

     |  // @audit-issue keccak is unused by files in analysis scope
  36 |  function keccak(bytes calldata _data) internal view returns (bytes32) {

     |  // @audit-issue sha is unused by files in analysis scope
  45 |  function sha(bytes calldata _data) internal view returns (bytes32) {

     |  // @audit-issue call is unused by files in analysis scope
  58 |  function call(
  59 |      uint256 _gas,
  60 |      address _address,
  61 |      uint256 _value,
  62 |      bytes calldata _data,
  63 |      bool _isSystem
  64 |  ) internal returns (bytes memory returnData) {

     |  // @audit-issue delegateCall is unused by files in analysis scope
  88 |  function delegateCall(
  89 |      uint256 _gas,
  90 |      address _address,
  91 |      bytes calldata _data
  92 |  ) internal returns (bytes memory returnData) {

     |  // @audit-issue mimicCall is unused by files in analysis scope
 105 |  function mimicCall(
 106 |      uint256 _gas,
 107 |      address _address,
 108 |      bytes calldata _data,
 109 |      address _whoToMimic,
 110 |      bool _isConstructor,
 111 |      bool _isSystem
 112 |  ) internal returns (bytes memory returnData) {
```
GitHub: [36](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L36), [45](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L45), [58-64](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L58-L64), [88-92](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L88-L92), [105-112](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L105-L112)


```solidity
File: code/system-contracts/contracts/libraries/RLPEncoder.sol

     |  // @audit-issue encodeAddress is unused by files in analysis scope
  11 |  function encodeAddress(address _val) internal pure returns (bytes memory encoded) {

     |  // @audit-issue encodeUint256 is unused by files in analysis scope
  24 |  function encodeUint256(uint256 _val) internal pure returns (bytes memory encoded) {

     |  // @audit-issue encodeNonSingleBytesLen is unused by files in analysis scope
  49 |  function encodeNonSingleBytesLen(uint64 _len) internal pure returns (bytes memory) {

     |  // @audit-issue encodeListLen is unused by files in analysis scope
  56 |  function encodeListLen(uint64 _len) internal pure returns (bytes memory) {
```
GitHub: [11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/RLPEncoder.sol#L11), [24](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/RLPEncoder.sol#L24), [49](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/RLPEncoder.sol#L49), [56](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/RLPEncoder.sol#L56)


```solidity
File: code/system-contracts/contracts/libraries/SystemContractHelper.sol

     |  // @audit-issue toL1 is unused by files in analysis scope
  48 |  function toL1(bool _isService, bytes32 _key, bytes32 _value) internal {

     |  // @audit-issue getCodeAddress is unused by files in analysis scope
  63 |  function getCodeAddress() internal view returns (address addr) {

     |  // @audit-issue loadCalldataIntoActivePtr is unused by files in analysis scope
  74 |  function loadCalldataIntoActivePtr() internal view {

     |  // @audit-issue ptrPackIntoActivePtr is unused by files in analysis scope
  85 |  function ptrPackIntoActivePtr(uint256 _farCallAbi) internal view {

     |  // @audit-issue ptrAddIntoActive is unused by files in analysis scope
  94 |  function ptrAddIntoActive(uint32 _value) internal view {

     |  // @audit-issue ptrShrinkIntoActive is unused by files in analysis scope
 106 |  function ptrShrinkIntoActive(uint32 _shrink) internal view {

     |  // @audit-issue packPrecompileParams is unused by files in analysis scope
 124 |  function packPrecompileParams(
 125 |      uint32 _inputMemoryOffset,
 126 |      uint32 _inputMemoryLength,
 127 |      uint32 _outputMemoryOffset,
 128 |      uint32 _outputMemoryLength,
 129 |      uint64 _perPrecompileInterpreted
 130 |  ) internal pure returns (uint256 rawParams) {

     |  // @audit-issue setValueForNextFarCall is unused by files in analysis scope
 168 |  function setValueForNextFarCall(uint128 _value) internal returns (bool success) {

     |  // @audit-issue eventInitialize is unused by files in analysis scope
 181 |  function eventInitialize(uint256 initializer, uint256 value1) internal {

     |  // @audit-issue eventWrite is unused by files in analysis scope
 191 |  function eventWrite(uint256 value1, uint256 value2) internal {

     |  // @audit-issue getZkSyncMeta is unused by files in analysis scope
 279 |  function getZkSyncMeta() internal view returns (ZkSyncMeta memory meta) {

     |  // @audit-issue getCalldataPtr is unused by files in analysis scope
 307 |  function getCalldataPtr() internal view returns (uint256 ptr) {

     |  // @audit-issue getExtraAbiData is unused by files in analysis scope
 318 |  function getExtraAbiData(uint256 index) internal view returns (uint256 extraAbiData) {

     |  // @audit-issue isSystemCall is unused by files in analysis scope
 329 |  function isSystemCall() internal view returns (bool) {

     |  // @audit-issue isSystemContract is unused by files in analysis scope
 338 |  function isSystemContract(address _address) internal pure returns (bool) {

     |  // @audit-issue burnGas is unused by files in analysis scope
 344 |  function burnGas(uint32 _gasToPay, uint32 _pubdataToSpend) internal view {
```
GitHub: [48](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L48), [63](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L63), [74](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L74), [85](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L85), [94](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L94), [106](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L106), [124-130](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L124-L130), [168](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L168), [181](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L181), [191](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L191), [279](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L279), [307](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L307), [318](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L318), [329](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L329), [338](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L338), [344](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L344)


```solidity
File: code/system-contracts/contracts/libraries/SystemContractsCaller.sol

     |  // @audit-issue systemCallWithPropagatedRevert is unused by files in analysis scope
 150 |  function systemCallWithPropagatedRevert(
 151 |      uint32 gasLimit,
 152 |      address to,
 153 |      uint128 value,
 154 |      bytes memory data
 155 |  ) internal returns (bytes memory returnData) {
```
GitHub: [150-155](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L150-L155)


```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

     |  // @audit-issue isEthToken is unused by files in analysis scope
  94 |  function isEthToken(uint256 _addr) internal pure returns (bool) {

     |  // @audit-issue encodeHash is unused by files in analysis scope
 100 |  function encodeHash(Transaction calldata _transaction) internal view returns (bytes32 resultHash) {

     |  // @audit-issue processPaymasterInput is unused by files in analysis scope
 362 |  function processPaymasterInput(Transaction calldata _transaction) internal {

     |  // @audit-issue payToTheBootloader is unused by files in analysis scope
 395 |  function payToTheBootloader(Transaction calldata _transaction) internal returns (bool success) {

     |  // @audit-issue totalRequiredBalance is unused by files in analysis scope
 405 |  function totalRequiredBalance(Transaction calldata _transaction) internal pure returns (uint256 requiredBalance) {
```
GitHub: [94](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L94), [100](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L100), [362](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L362), [395](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L395), [405](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L405)


```solidity
File: code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol

     |  // @audit-issue readUint16 is unused by files in analysis scope
  19 |  function readUint16(bytes calldata _bytes, uint256 _start) internal pure returns (uint16 result) {

     |  // @audit-issue readUint32 is unused by files in analysis scope
  26 |  function readUint32(bytes calldata _bytes, uint256 _start) internal pure returns (uint32 result) {

     |  // @audit-issue readUint64 is unused by files in analysis scope
  33 |  function readUint64(bytes calldata _bytes, uint256 _start) internal pure returns (uint64 result) {

     |  // @audit-issue readBytes32 is unused by files in analysis scope
  40 |  function readBytes32(bytes calldata _bytes, uint256 _start) internal pure returns (bytes32 result) {

     |  // @audit-issue readUint256 is unused by files in analysis scope
  46 |  function readUint256(bytes calldata _bytes, uint256 _start) internal pure returns (uint256 result) {
```
GitHub: [19](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol#L19), [26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol#L26), [33](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol#L33), [40](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol#L40), [46](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/UnsafeBytesCalldata.sol#L46)


```solidity
File: code/system-contracts/contracts/libraries/Utils.sol

     |  // @audit-issue safeCastToU128 is unused by files in analysis scope
  20 |  function safeCastToU128(uint256 _x) internal pure returns (uint128) {

     |  // @audit-issue safeCastToU32 is unused by files in analysis scope
  26 |  function safeCastToU32(uint256 _x) internal pure returns (uint32) {

     |  // @audit-issue safeCastToU24 is unused by files in analysis scope
  32 |  function safeCastToU24(uint256 _x) internal pure returns (uint24) {

     |  // @audit-issue bytecodeLenInBytes is unused by files in analysis scope
  39 |  function bytecodeLenInBytes(bytes32 _bytecodeHash) internal pure returns (uint256 codeLength) {

     |  // @audit-issue isContractConstructed is unused by files in analysis scope
  51 |  function isContractConstructed(bytes32 _bytecodeHash) internal pure returns (bool) {

     |  // @audit-issue isContractConstructing is unused by files in analysis scope
  56 |  function isContractConstructing(bytes32 _bytecodeHash) internal pure returns (bool) {

     |  // @audit-issue constructingBytecodeHash is unused by files in analysis scope
  63 |  function constructingBytecodeHash(bytes32 _bytecodeHash) internal pure returns (bytes32) {

     |  // @audit-issue hashL2Bytecode is unused by files in analysis scope
  82 |  function hashL2Bytecode(bytes calldata _bytecode) internal view returns (bytes32 hashedBytecode) {
```
GitHub: [20](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L20), [26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L26), [32](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L32), [39](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L39), [51](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L51), [56](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L56), [63](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L63), [82](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L82)


```solidity
File: code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol

     |  // @audit-issue applyL1ToL2Alias is unused by files in analysis scope
  28 |  function applyL1ToL2Alias(address l1Address) internal pure returns (address l2Address) {

     |  // @audit-issue undoL1ToL2Alias is unused by files in analysis scope
  38 |  function undoL1ToL2Alias(address l2Address) internal pure returns (address l1Address) {
```
GitHub: [28](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol#L28), [38](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol#L38)


```solidity
File: code/contracts/zksync/contracts/L2ContractHelper.sol

     |  // @audit-issue sendMessageToL1 is unused by files in analysis scope
  90 |  function sendMessageToL1(bytes memory _message) internal returns (bytes32) {

     |  // @audit-issue computeCreate2Address is unused by files in analysis scope
 101 |  function computeCreate2Address(
 102 |      address _sender,
 103 |      bytes32 _salt,
 104 |      bytes32 _bytecodeHash,
 105 |      bytes32 _constructorInputHash
 106 |  ) internal pure returns (address) {
```
GitHub: [90](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/L2ContractHelper.sol#L90), [101-106](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/L2ContractHelper.sol#L101-L106)


```solidity
File: code/contracts/zksync/contracts/SystemContractsCaller.sol

     |  // @audit-issue systemCallWithReturndata is unused by files in analysis scope
  76 |  function systemCallWithReturndata(
  77 |      uint32 gasLimit,
  78 |      address to,
  79 |      uint128 value,
  80 |      bytes memory data
  81 |  ) internal returns (bool success, bytes memory returnData) {
```
GitHub: [76-81](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/SystemContractsCaller.sol#L76-L81)


## [N-103] Unused `struct` definition

Note that there may be cases where a struct superficially appears to be used, but this is only because there are multiple definitions of the struct in different files. In such cases, the struct definition should be moved into a separate file. The instances below are the unused definitions.

*Instances: 13*

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol

     |  // @audit-issue ZkSyncStateTransitionStorage is unused by files in analysis scope
  66 |  struct ZkSyncStateTransitionStorage {
```
GitHub: [66](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L66)


```solidity
File: code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol

     |  // @audit-issue L2TransactionRequestTwoBridgesInner is unused by files in analysis scope
  34 |  struct L2TransactionRequestTwoBridgesInner {
```
GitHub: [34](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L34)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol

     |  // @audit-issue InitializeDataNewChain is unused by files in analysis scope
  51 |  struct InitializeDataNewChain {
```
GitHub: [51](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol#L51)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol

     |  // @audit-issue LogProcessingOutput is unused by files in analysis scope
  27 |  struct LogProcessingOutput {
```
GitHub: [27](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L27)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IVerifier.sol

     |  // @audit-issue VerifierParams is unused by files in analysis scope
   6 |  struct VerifierParams {
```
GitHub: [6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IVerifier.sol#L6)


```solidity
File: code/contracts/ethereum/contracts/common/Messaging.sol

     |  // @audit-issue L2Log is unused by files in analysis scope
  23 |  struct L2Log {

     |  // @audit-issue L2Message is unused by files in analysis scope
  37 |  struct L2Message {

     |  // @audit-issue WritePriorityOpParams is unused by files in analysis scope
  55 |  struct WritePriorityOpParams {

     |  // @audit-issue L2CanonicalTransaction is unused by files in analysis scope
  98 |  struct L2CanonicalTransaction {

     |  // @audit-issue BridgehubL2TransactionRequest is unused by files in analysis scope
 127 |  struct BridgehubL2TransactionRequest {
```
GitHub: [23](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/Messaging.sol#L23), [37](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/Messaging.sol#L37), [55](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/Messaging.sol#L55), [98](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/Messaging.sol#L98), [127](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/Messaging.sol#L127)


```solidity
File: code/system-contracts/contracts/interfaces/ISystemContext.sol

     |  // @audit-issue BlockInfo is unused by files in analysis scope
  12 |  struct BlockInfo {

     |  // @audit-issue VirtualBlockUpgradeInfo is unused by files in analysis scope
  19 |  struct VirtualBlockUpgradeInfo {
```
GitHub: [12](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L12), [19](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContext.sol#L19)


```solidity
File: code/contracts/zksync/contracts/L2ContractHelper.sol

     |  // @audit-issue Transaction is unused by files in analysis scope
 117 |  struct Transaction {
```
GitHub: [117](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/L2ContractHelper.sol#L117)


## [N-104] Unused function parameter

An unused function parameter could represent a defect (e.g. a different parameter was used when the intention was to use the unused parameter), or just stale code due to a refactor. For the avoidance of doubt, remove the unused parameter.

*Instances: 3*

```solidity
File: code/system-contracts/contracts/DefaultAccount.sol

     |  // @audit-issue `_transaction` is unused
 125 |  function executeTransactionFromOutside(Transaction calldata _transaction) external payable override {
```
GitHub: [125](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L125)


```solidity
File: code/contracts/zksync/contracts/TestnetPaymaster.sol

     |  // @audit-issue `_context` is unused
     |  // `_transaction` is unused
     |  // `_txResult` is unused
     |  // `_maxRefundedGas` is unused
  70 |  function postTransaction(
  71 |      bytes calldata _context,
  72 |      Transaction calldata _transaction,
  73 |      bytes32,
  74 |      bytes32,
  75 |      ExecutionResult _txResult,
  76 |      uint256 _maxRefundedGas
  77 |  ) external payable override {
```
GitHub: [70-77](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/TestnetPaymaster.sol#L70-L77)


```solidity
File: code/contracts/zksync/contracts/bridge/L2WrappedBaseToken.sol

     |  // @audit-issue `_to` is unused
     |  // `_amount` is unused
  72 |  function bridgeMint(address _to, uint256 _amount) external override onlyBridge {
```
GitHub: [72](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2WrappedBaseToken.sol#L72)


## [N-105] Unused import

Some imports are not used, consider removing them.

*Instances: 40*

```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

     |  // @audit-issue ERA_DIAMOND_PROXY is unused
  21 |  import {REQUIRED_L2_GAS_PRICE_PER_PUBDATA, L2_TO_L1_LOG_SERIALIZE_SIZE, DEFAULT_L2_LOGS_TREE_ROOT_HASH, EMPTY_STRING_KECCAK, SYSTEM_UPGRADE_L2_TX_TYPE, ERA_DIAMOND_PROXY, ERA_CHAIN_ID} from "../common/Config.sol";

     |  // @audit-issue ERA_CHAIN_ID is unused
  21 |  import {REQUIRED_L2_GAS_PRICE_PER_PUBDATA, L2_TO_L1_LOG_SERIALIZE_SIZE, DEFAULT_L2_LOGS_TREE_ROOT_HASH, EMPTY_STRING_KECCAK, SYSTEM_UPGRADE_L2_TX_TYPE, ERA_DIAMOND_PROXY, ERA_CHAIN_ID} from "../common/Config.sol";
```
GitHub: [21](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L21), [21](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L21)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol

     |  // @audit-issue FeeParams is unused
   7 |  import {FeeParams} from "./ZkSyncStateTransitionStorage.sol";

     |  // @audit-issue VerifierParams is unused
  10 |  import {VerifierParams} from "../chain-interfaces/IVerifier.sol";
```
GitHub: [7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol#L7), [10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol#L10)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol

     |  // @audit-issue PriorityQueue is unused
   6 |  import {PriorityQueue} from "../../state-transition/libraries/PriorityQueue.sol";
```
GitHub: [6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L6)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol

     |  // @audit-issue IZkSyncStateTransitionBase is unused
  13 |  import {IZkSyncStateTransitionBase} from "../../chain-interfaces/IZkSyncStateTransitionBase.sol";
```
GitHub: [13](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L13)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

     |  // @audit-issue IZkSyncStateTransitionBase is unused
  17 |  import {IZkSyncStateTransitionBase} from "../../chain-interfaces/IZkSyncStateTransitionBase.sol";
```
GitHub: [17](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L17)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol

     |  // @audit-issue IZkSyncStateTransitionBase is unused
  15 |  import {IZkSyncStateTransitionBase} from "../../chain-interfaces/IZkSyncStateTransitionBase.sol";
```
GitHub: [15](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L15)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

     |  // @audit-issue UnsafeBytes is unused
  14 |  import {UnsafeBytes} from "../../../common/libraries/UnsafeBytes.sol";

     |  // @audit-issue L2_BASE_TOKEN_SYSTEM_CONTRACT_ADDR is unused
  19 |  import {L2_BOOTLOADER_ADDRESS, L2_TO_L1_MESSENGER_SYSTEM_CONTRACT_ADDR, L2_BASE_TOKEN_SYSTEM_CONTRACT_ADDR} from "../../../common/L2ContractAddresses.sol";

     |  // @audit-issue IBridgehub is unused
  21 |  import {IBridgehub} from "../../../bridgehub/IBridgehub.sol";

     |  // @audit-issue IZkSyncStateTransitionBase is unused
  25 |  import {IZkSyncStateTransitionBase} from "../../chain-interfaces/IZkSyncStateTransitionBase.sol";
```
GitHub: [14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L14), [19](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L19), [21](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L21), [25](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L25)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol

     |  // @audit-issue ZkSyncStateTransitionStorage is unused
   5 |  import {ZkSyncStateTransitionStorage} from "../ZkSyncStateTransitionStorage.sol";
```
GitHub: [5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L5)


```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol

     |  // @audit-issue IMailbox is unused
   6 |  import {IMailbox} from "../state-transition/chain-interfaces/IMailbox.sol";
```
GitHub: [6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L6)


```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol

     |  // @audit-issue MAX_NEW_FACTORY_DEPS is unused
  11 |  import {MAX_NEW_FACTORY_DEPS, SYSTEM_UPGRADE_L2_TX_TYPE, MAX_ALLOWED_PROTOCOL_VERSION_DELTA} from "../common/Config.sol";

     |  // @audit-issue SYSTEM_UPGRADE_L2_TX_TYPE is unused
  11 |  import {MAX_NEW_FACTORY_DEPS, SYSTEM_UPGRADE_L2_TX_TYPE, MAX_ALLOWED_PROTOCOL_VERSION_DELTA} from "../common/Config.sol";
```
GitHub: [11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L11), [11](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L11)


```solidity
File: code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol

     |  // @audit-issue Diamond is unused
   5 |  import {Diamond} from "./libraries/Diamond.sol";
```
GitHub: [5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L5)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol

     |  // @audit-issue Diamond is unused
   7 |  import {Diamond} from "../libraries/Diamond.sol";
```
GitHub: [7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IAdmin.sol#L7)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol

     |  // @audit-issue L2CanonicalTransaction is unused
   5 |  import {L2CanonicalTransaction} from "../../common/Messaging.sol";
```
GitHub: [5](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IDiamondInit.sol#L5)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol

     |  // @audit-issue Verifier is unused
   9 |  import {Verifier} from "../Verifier.sol";

     |  // @audit-issue VerifierParams is unused
  10 |  import {VerifierParams} from "./IVerifier.sol";
```
GitHub: [9](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol#L9), [10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IZkSyncStateTransition.sol#L10)


```solidity
File: code/system-contracts/contracts/Compressor.sol

     |  // @audit-issue INITIAL_WRITE_STARTING_POSITION is unused
  10 |  import {L1_MESSENGER_CONTRACT, INITIAL_WRITE_STARTING_POSITION, COMPRESSED_INITIAL_WRITE_SIZE, STATE_DIFF_ENTRY_SIZE, STATE_DIFF_ENUM_INDEX_OFFSET, STATE_DIFF_FINAL_VALUE_OFFSET, STATE_DIFF_DERIVED_KEY_OFFSET, DERIVED_KEY_LENGTH, VALUE_LENGTH, ENUM_INDEX_LENGTH, KNOWN_CODE_STORAGE_CONTRACT} from "./Constants.sol";

     |  // @audit-issue COMPRESSED_INITIAL_WRITE_SIZE is unused
  10 |  import {L1_MESSENGER_CONTRACT, INITIAL_WRITE_STARTING_POSITION, COMPRESSED_INITIAL_WRITE_SIZE, STATE_DIFF_ENTRY_SIZE, STATE_DIFF_ENUM_INDEX_OFFSET, STATE_DIFF_FINAL_VALUE_OFFSET, STATE_DIFF_DERIVED_KEY_OFFSET, DERIVED_KEY_LENGTH, VALUE_LENGTH, ENUM_INDEX_LENGTH, KNOWN_CODE_STORAGE_CONTRACT} from "./Constants.sol";

     |  // @audit-issue STATE_DIFF_ENUM_INDEX_OFFSET is unused
  10 |  import {L1_MESSENGER_CONTRACT, INITIAL_WRITE_STARTING_POSITION, COMPRESSED_INITIAL_WRITE_SIZE, STATE_DIFF_ENTRY_SIZE, STATE_DIFF_ENUM_INDEX_OFFSET, STATE_DIFF_FINAL_VALUE_OFFSET, STATE_DIFF_DERIVED_KEY_OFFSET, DERIVED_KEY_LENGTH, VALUE_LENGTH, ENUM_INDEX_LENGTH, KNOWN_CODE_STORAGE_CONTRACT} from "./Constants.sol";

     |  // @audit-issue STATE_DIFF_FINAL_VALUE_OFFSET is unused
  10 |  import {L1_MESSENGER_CONTRACT, INITIAL_WRITE_STARTING_POSITION, COMPRESSED_INITIAL_WRITE_SIZE, STATE_DIFF_ENTRY_SIZE, STATE_DIFF_ENUM_INDEX_OFFSET, STATE_DIFF_FINAL_VALUE_OFFSET, STATE_DIFF_DERIVED_KEY_OFFSET, DERIVED_KEY_LENGTH, VALUE_LENGTH, ENUM_INDEX_LENGTH, KNOWN_CODE_STORAGE_CONTRACT} from "./Constants.sol";

     |  // @audit-issue STATE_DIFF_DERIVED_KEY_OFFSET is unused
  10 |  import {L1_MESSENGER_CONTRACT, INITIAL_WRITE_STARTING_POSITION, COMPRESSED_INITIAL_WRITE_SIZE, STATE_DIFF_ENTRY_SIZE, STATE_DIFF_ENUM_INDEX_OFFSET, STATE_DIFF_FINAL_VALUE_OFFSET, STATE_DIFF_DERIVED_KEY_OFFSET, DERIVED_KEY_LENGTH, VALUE_LENGTH, ENUM_INDEX_LENGTH, KNOWN_CODE_STORAGE_CONTRACT} from "./Constants.sol";

     |  // @audit-issue DERIVED_KEY_LENGTH is unused
  10 |  import {L1_MESSENGER_CONTRACT, INITIAL_WRITE_STARTING_POSITION, COMPRESSED_INITIAL_WRITE_SIZE, STATE_DIFF_ENTRY_SIZE, STATE_DIFF_ENUM_INDEX_OFFSET, STATE_DIFF_FINAL_VALUE_OFFSET, STATE_DIFF_DERIVED_KEY_OFFSET, DERIVED_KEY_LENGTH, VALUE_LENGTH, ENUM_INDEX_LENGTH, KNOWN_CODE_STORAGE_CONTRACT} from "./Constants.sol";

     |  // @audit-issue VALUE_LENGTH is unused
  10 |  import {L1_MESSENGER_CONTRACT, INITIAL_WRITE_STARTING_POSITION, COMPRESSED_INITIAL_WRITE_SIZE, STATE_DIFF_ENTRY_SIZE, STATE_DIFF_ENUM_INDEX_OFFSET, STATE_DIFF_FINAL_VALUE_OFFSET, STATE_DIFF_DERIVED_KEY_OFFSET, DERIVED_KEY_LENGTH, VALUE_LENGTH, ENUM_INDEX_LENGTH, KNOWN_CODE_STORAGE_CONTRACT} from "./Constants.sol";

     |  // @audit-issue ENUM_INDEX_LENGTH is unused
  10 |  import {L1_MESSENGER_CONTRACT, INITIAL_WRITE_STARTING_POSITION, COMPRESSED_INITIAL_WRITE_SIZE, STATE_DIFF_ENTRY_SIZE, STATE_DIFF_ENUM_INDEX_OFFSET, STATE_DIFF_FINAL_VALUE_OFFSET, STATE_DIFF_DERIVED_KEY_OFFSET, DERIVED_KEY_LENGTH, VALUE_LENGTH, ENUM_INDEX_LENGTH, KNOWN_CODE_STORAGE_CONTRACT} from "./Constants.sol";
```
GitHub: [10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L10), [10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L10), [10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L10), [10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L10), [10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L10), [10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L10), [10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L10), [10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L10)


```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

     |  // @audit-issue KECCAK256_SYSTEM_CONTRACT is unused
   7 |  import {CREATE2_PREFIX, CREATE_PREFIX, NONCE_HOLDER_SYSTEM_CONTRACT, ACCOUNT_CODE_STORAGE_SYSTEM_CONTRACT, FORCE_DEPLOYER, MAX_SYSTEM_CONTRACT_ADDRESS, KNOWN_CODE_STORAGE_CONTRACT, BASE_TOKEN_SYSTEM_CONTRACT, IMMUTABLE_SIMULATOR_SYSTEM_CONTRACT, COMPLEX_UPGRADER_CONTRACT, KECCAK256_SYSTEM_CONTRACT} from "./Constants.sol";
```
GitHub: [7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L7)


```solidity
File: code/system-contracts/contracts/PubdataChunkPublisher.sol

     |  // @audit-issue EfficientCall is unused
   7 |  import {EfficientCall} from "./libraries/EfficientCall.sol";
```
GitHub: [7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/PubdataChunkPublisher.sol#L7)


```solidity
File: code/system-contracts/contracts/libraries/SystemContractHelper.sol

     |  // @audit-issue SystemContractsCaller is unused
   7 |  import {SystemContractsCaller, CalldataForwardingMode, CALLFLAGS_CALL_ADDRESS, CODE_ADDRESS_CALL_ADDRESS, EVENT_WRITE_ADDRESS, EVENT_INITIALIZE_ADDRESS, GET_EXTRA_ABI_DATA_ADDRESS, LOAD_CALLDATA_INTO_ACTIVE_PTR_CALL_ADDRESS, META_CODE_SHARD_ID_OFFSET, META_CALLER_SHARD_ID_OFFSET, META_SHARD_ID_OFFSET, META_AUX_HEAP_SIZE_OFFSET, META_HEAP_SIZE_OFFSET, META_GAS_PER_PUBDATA_BYTE_OFFSET, MIMIC_CALL_BY_REF_CALL_ADDRESS, META_CALL_ADDRESS, MSG_VALUE_SIMULATOR_IS_SYSTEM_BIT, PTR_CALLDATA_CALL_ADDRESS, PTR_ADD_INTO_ACTIVE_CALL_ADDRESS, PTR_SHRINK_INTO_ACTIVE_CALL_ADDRESS, PTR_PACK_INTO_ACTIVE_CALL_ADDRESS, RAW_FAR_CALL_BY_REF_CALL_ADDRESS, PRECOMPILE_CALL_ADDRESS, SET_CONTEXT_VALUE_CALL_ADDRESS, SYSTEM_CALL_BY_REF_CALL_ADDRESS, TO_L1_CALL_ADDRESS} from "./SystemContractsCaller.sol";

     |  // @audit-issue CalldataForwardingMode is unused
   7 |  import {SystemContractsCaller, CalldataForwardingMode, CALLFLAGS_CALL_ADDRESS, CODE_ADDRESS_CALL_ADDRESS, EVENT_WRITE_ADDRESS, EVENT_INITIALIZE_ADDRESS, GET_EXTRA_ABI_DATA_ADDRESS, LOAD_CALLDATA_INTO_ACTIVE_PTR_CALL_ADDRESS, META_CODE_SHARD_ID_OFFSET, META_CALLER_SHARD_ID_OFFSET, META_SHARD_ID_OFFSET, META_AUX_HEAP_SIZE_OFFSET, META_HEAP_SIZE_OFFSET, META_GAS_PER_PUBDATA_BYTE_OFFSET, MIMIC_CALL_BY_REF_CALL_ADDRESS, META_CALL_ADDRESS, MSG_VALUE_SIMULATOR_IS_SYSTEM_BIT, PTR_CALLDATA_CALL_ADDRESS, PTR_ADD_INTO_ACTIVE_CALL_ADDRESS, PTR_SHRINK_INTO_ACTIVE_CALL_ADDRESS, PTR_PACK_INTO_ACTIVE_CALL_ADDRESS, RAW_FAR_CALL_BY_REF_CALL_ADDRESS, PRECOMPILE_CALL_ADDRESS, SET_CONTEXT_VALUE_CALL_ADDRESS, SYSTEM_CALL_BY_REF_CALL_ADDRESS, TO_L1_CALL_ADDRESS} from "./SystemContractsCaller.sol";

     |  // @audit-issue MIMIC_CALL_BY_REF_CALL_ADDRESS is unused
   7 |  import {SystemContractsCaller, CalldataForwardingMode, CALLFLAGS_CALL_ADDRESS, CODE_ADDRESS_CALL_ADDRESS, EVENT_WRITE_ADDRESS, EVENT_INITIALIZE_ADDRESS, GET_EXTRA_ABI_DATA_ADDRESS, LOAD_CALLDATA_INTO_ACTIVE_PTR_CALL_ADDRESS, META_CODE_SHARD_ID_OFFSET, META_CALLER_SHARD_ID_OFFSET, META_SHARD_ID_OFFSET, META_AUX_HEAP_SIZE_OFFSET, META_HEAP_SIZE_OFFSET, META_GAS_PER_PUBDATA_BYTE_OFFSET, MIMIC_CALL_BY_REF_CALL_ADDRESS, META_CALL_ADDRESS, MSG_VALUE_SIMULATOR_IS_SYSTEM_BIT, PTR_CALLDATA_CALL_ADDRESS, PTR_ADD_INTO_ACTIVE_CALL_ADDRESS, PTR_SHRINK_INTO_ACTIVE_CALL_ADDRESS, PTR_PACK_INTO_ACTIVE_CALL_ADDRESS, RAW_FAR_CALL_BY_REF_CALL_ADDRESS, PRECOMPILE_CALL_ADDRESS, SET_CONTEXT_VALUE_CALL_ADDRESS, SYSTEM_CALL_BY_REF_CALL_ADDRESS, TO_L1_CALL_ADDRESS} from "./SystemContractsCaller.sol";

     |  // @audit-issue MSG_VALUE_SIMULATOR_IS_SYSTEM_BIT is unused
   7 |  import {SystemContractsCaller, CalldataForwardingMode, CALLFLAGS_CALL_ADDRESS, CODE_ADDRESS_CALL_ADDRESS, EVENT_WRITE_ADDRESS, EVENT_INITIALIZE_ADDRESS, GET_EXTRA_ABI_DATA_ADDRESS, LOAD_CALLDATA_INTO_ACTIVE_PTR_CALL_ADDRESS, META_CODE_SHARD_ID_OFFSET, META_CALLER_SHARD_ID_OFFSET, META_SHARD_ID_OFFSET, META_AUX_HEAP_SIZE_OFFSET, META_HEAP_SIZE_OFFSET, META_GAS_PER_PUBDATA_BYTE_OFFSET, MIMIC_CALL_BY_REF_CALL_ADDRESS, META_CALL_ADDRESS, MSG_VALUE_SIMULATOR_IS_SYSTEM_BIT, PTR_CALLDATA_CALL_ADDRESS, PTR_ADD_INTO_ACTIVE_CALL_ADDRESS, PTR_SHRINK_INTO_ACTIVE_CALL_ADDRESS, PTR_PACK_INTO_ACTIVE_CALL_ADDRESS, RAW_FAR_CALL_BY_REF_CALL_ADDRESS, PRECOMPILE_CALL_ADDRESS, SET_CONTEXT_VALUE_CALL_ADDRESS, SYSTEM_CALL_BY_REF_CALL_ADDRESS, TO_L1_CALL_ADDRESS} from "./SystemContractsCaller.sol";

     |  // @audit-issue RAW_FAR_CALL_BY_REF_CALL_ADDRESS is unused
   7 |  import {SystemContractsCaller, CalldataForwardingMode, CALLFLAGS_CALL_ADDRESS, CODE_ADDRESS_CALL_ADDRESS, EVENT_WRITE_ADDRESS, EVENT_INITIALIZE_ADDRESS, GET_EXTRA_ABI_DATA_ADDRESS, LOAD_CALLDATA_INTO_ACTIVE_PTR_CALL_ADDRESS, META_CODE_SHARD_ID_OFFSET, META_CALLER_SHARD_ID_OFFSET, META_SHARD_ID_OFFSET, META_AUX_HEAP_SIZE_OFFSET, META_HEAP_SIZE_OFFSET, META_GAS_PER_PUBDATA_BYTE_OFFSET, MIMIC_CALL_BY_REF_CALL_ADDRESS, META_CALL_ADDRESS, MSG_VALUE_SIMULATOR_IS_SYSTEM_BIT, PTR_CALLDATA_CALL_ADDRESS, PTR_ADD_INTO_ACTIVE_CALL_ADDRESS, PTR_SHRINK_INTO_ACTIVE_CALL_ADDRESS, PTR_PACK_INTO_ACTIVE_CALL_ADDRESS, RAW_FAR_CALL_BY_REF_CALL_ADDRESS, PRECOMPILE_CALL_ADDRESS, SET_CONTEXT_VALUE_CALL_ADDRESS, SYSTEM_CALL_BY_REF_CALL_ADDRESS, TO_L1_CALL_ADDRESS} from "./SystemContractsCaller.sol";

     |  // @audit-issue SYSTEM_CALL_BY_REF_CALL_ADDRESS is unused
   7 |  import {SystemContractsCaller, CalldataForwardingMode, CALLFLAGS_CALL_ADDRESS, CODE_ADDRESS_CALL_ADDRESS, EVENT_WRITE_ADDRESS, EVENT_INITIALIZE_ADDRESS, GET_EXTRA_ABI_DATA_ADDRESS, LOAD_CALLDATA_INTO_ACTIVE_PTR_CALL_ADDRESS, META_CODE_SHARD_ID_OFFSET, META_CALLER_SHARD_ID_OFFSET, META_SHARD_ID_OFFSET, META_AUX_HEAP_SIZE_OFFSET, META_HEAP_SIZE_OFFSET, META_GAS_PER_PUBDATA_BYTE_OFFSET, MIMIC_CALL_BY_REF_CALL_ADDRESS, META_CALL_ADDRESS, MSG_VALUE_SIMULATOR_IS_SYSTEM_BIT, PTR_CALLDATA_CALL_ADDRESS, PTR_ADD_INTO_ACTIVE_CALL_ADDRESS, PTR_SHRINK_INTO_ACTIVE_CALL_ADDRESS, PTR_PACK_INTO_ACTIVE_CALL_ADDRESS, RAW_FAR_CALL_BY_REF_CALL_ADDRESS, PRECOMPILE_CALL_ADDRESS, SET_CONTEXT_VALUE_CALL_ADDRESS, SYSTEM_CALL_BY_REF_CALL_ADDRESS, TO_L1_CALL_ADDRESS} from "./SystemContractsCaller.sol";
```
GitHub: [7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L7), [7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L7), [7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L7), [7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L7), [7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L7), [7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L7)


```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

     |  // @audit-issue UpgradeableBeacon is unused
   7 |  import {UpgradeableBeacon} from "@openzeppelin/contracts/proxy/beacon/UpgradeableBeacon.sol";

     |  // @audit-issue L2_BASE_TOKEN_ADDRESS is unused
  15 |  import {L2ContractHelper, DEPLOYER_SYSTEM_CONTRACT, L2_BASE_TOKEN_ADDRESS, IContractDeployer} from "../L2ContractHelper.sol";

     |  // @audit-issue ERA_WETH_ADDRESS is unused
  17 |  import {ERA_CHAIN_ID, ERA_WETH_ADDRESS} from "../Config.sol";
```
GitHub: [7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L7), [15](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L15), [17](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L17)


## [N-106] Unused named `return` variable

Declaring named returns, but not using them, is confusing to the reader. Consider either completely removing them (by declaring just the type without a name), or remove the return statement and do a variable assignment.

This would improve the readability of the code, and it may also help reduce regressions during future code refactors.

*Instances: 4*

```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

     |  // @audit-issue Stop naming unreferenced variable `chainId` to avoid confusion
 121 |  ) external onlyOwnerOrAdmin nonReentrant returns (uint256 chainId) {
```
GitHub: [121](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L121)


```solidity
File: code/system-contracts/contracts/BootloaderUtilities.sol

     |  // @audit-issue Stop naming unreferenced variable `txHash` to avoid confusion
  44 |  function encodeLegacyTransactionHash(Transaction calldata _transaction) internal view returns (bytes32 txHash) {
```
GitHub: [44](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L44)


```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

     |  // @audit-issue Stop naming unreferenced variable `info` to avoid confusion
  34 |  function getAccountInfo(address _address) external view returns (AccountInfo memory info) {
```
GitHub: [34](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L34)


```solidity
File: code/contracts/zksync/contracts/TestnetPaymaster.sol

     |  // @audit-issue Stop naming unreferenced variable `context` to avoid confusion
  18 |  ) external payable returns (bytes4 magic, bytes memory context) {
```
GitHub: [18](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/TestnetPaymaster.sol#L18)


## [N-107] Use `uint256`/`int256` instead of `uint`/`int`

Instead of using `(u)int` to declare `(u)int256`, explicitly define `(u)int256` to ensure there is no confusion.

*Instances: 1*

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

     |  // @audit-issue Explicitly declare size as uint256/int256
 580 |  for (uint i = 0; i < MAX_NUMBER_OF_BLOBS; i++) {
```
GitHub: [580](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L580)


## [N-108] Use a single file for system wide constants

Consider grouping all the system constants under a single file. This finding shows only the first constant for each file, for brevity.

*Instances: 37*

```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

     |  // @audit-issue Consider grouping constants like this into a single file
  23 |  IL1SharedBridge public immutable override sharedBridge;
```
GitHub: [23](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L23)


```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

     |  // @audit-issue Consider grouping constants like this into a single file
  34 |  address public immutable override l1WethAddress;
```
GitHub: [34](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L34)


```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

     |  // @audit-issue Consider grouping constants like this into a single file
  22 |  uint256 internal constant EXECUTED_PROPOSAL_TIMESTAMP = uint256(1);
```
GitHub: [22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L22)


```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

     |  // @audit-issue Consider grouping constants like this into a single file
  29 |  address public immutable bridgehub;
```
GitHub: [29](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L29)


```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

     |  // @audit-issue Consider grouping constants like this into a single file
  26 |  string public constant override getName = "ValidatorTimelock";
```
GitHub: [26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L26)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol

     |  // @audit-issue Consider grouping constants like this into a single file
  20 |  string public constant override getName = "AdminFacet";
```
GitHub: [20](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L20)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

     |  // @audit-issue Consider grouping constants like this into a single file
  27 |  string public constant override getName = "ExecutorFacet";
```
GitHub: [27](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L27)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol

     |  // @audit-issue Consider grouping constants like this into a single file
  25 |  string public constant override getName = "GettersFacet";
```
GitHub: [25](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L25)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

     |  // @audit-issue Consider grouping constants like this into a single file
  35 |  string public constant override getName = "MailboxFacet";
```
GitHub: [35](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L35)


```solidity
File: code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol

     |  // @audit-issue Consider grouping constants like this into a single file
  12 |  bytes32 private constant CREATE2_PREFIX = keccak256("zksyncCreate2");
```
GitHub: [12](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L12)


```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol

     |  // @audit-issue Consider grouping constants like this into a single file
  17 |  bytes32 internal constant DIAMOND_INIT_SUCCESS_RETURN_VALUE =
  18 |      0x33774e659306e47509050e97cb651e731180a42d458212294d30751925c551a2; // keccak256("diamond.zksync.init") - 1
```
GitHub: [17-18](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L17-L18)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol

     |  // @audit-issue Consider grouping constants like this into a single file
  40 |  uint256 constant L2_LOG_ADDRESS_OFFSET = 4;
```
GitHub: [40](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L40)


```solidity
File: code/contracts/ethereum/contracts/common/Config.sol

     |  // @audit-issue Consider grouping constants like this into a single file
   8 |  bytes32 constant EMPTY_STRING_KECCAK = 0xc5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470;
```
GitHub: [8](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/Config.sol#L8)


```solidity
File: code/contracts/ethereum/contracts/common/L2ContractAddresses.sol

     |  // @audit-issue Consider grouping constants like this into a single file
   6 |  address constant L2_BOOTLOADER_ADDRESS = address(0x8001);
```
GitHub: [6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/L2ContractAddresses.sol#L6)


```solidity
File: code/contracts/ethereum/contracts/common/ReentrancyGuard.sol

     |  // @audit-issue Consider grouping constants like this into a single file
  29 |  uint256 private constant LOCK_FLAG_ADDRESS = 0x8e94fed44239eb2314ab7a406345e6c5a8f0ccedf3b600de3d004e672c33abf4;
```
GitHub: [29](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/ReentrancyGuard.sol#L29)


```solidity
File: code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol

     |  // @audit-issue Consider grouping constants like this into a single file
  22 |  uint160 constant offset = uint160(0x1111000000000000000000000000000000001111);
```
GitHub: [22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol#L22)


```solidity
File: code/contracts/ethereum/contracts/state-transition/Verifier.sol

     |  // @audit-issue Consider grouping constants like this into a single file
  27 |  uint256 internal constant VK_GATE_SETUP_0_X_SLOT = 0x200 + 0x000;
```
GitHub: [27](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L27)


```solidity
File: code/system-contracts/contracts/AccountCodeStorage.sol

     |  // @audit-issue Consider grouping constants like this into a single file
  23 |  bytes32 constant EMPTY_STRING_KECCAK = 0xc5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470;
```
GitHub: [23](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L23)


```solidity
File: code/system-contracts/contracts/Constants.sol

     |  // @audit-issue Consider grouping constants like this into a single file
  20 |  uint160 constant SYSTEM_CONTRACTS_OFFSET = 0x8000;
```
GitHub: [20](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Constants.sol#L20)


```solidity
File: code/system-contracts/contracts/L1Messenger.sol

     |  // @audit-issue Consider grouping constants like this into a single file
  44 |  uint256 internal constant KECCAK_ROUND_GAS_COST = 40;
```
GitHub: [44](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L44)


```solidity
File: code/system-contracts/contracts/MsgValueSimulator.sol

     |  // @audit-issue Consider grouping constants like this into a single file
  36 |  uint256 constant GAS_TO_PASS = 2300;
```
GitHub: [36](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/MsgValueSimulator.sol#L36)


```solidity
File: code/system-contracts/contracts/NonceHolder.sol

     |  // @audit-issue Consider grouping constants like this into a single file
  28 |  uint256 private constant DEPLOY_NONCE_MULTIPLIER = 2 ** 128;
```
GitHub: [28](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/NonceHolder.sol#L28)


```solidity
File: code/system-contracts/contracts/SystemContext.sol

     |  // @audit-issue Consider grouping constants like this into a single file
  23 |  uint256 internal constant MINIBLOCK_HASHES_TO_STORE = 257;
```
GitHub: [23](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L23)


```solidity
File: code/system-contracts/contracts/GasBoundCaller.sol

     |  // @audit-issue Consider grouping constants like this into a single file
  18 |  uint256 constant CALL_ENTRY_OVERHEAD = 800;
```
GitHub: [18](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/GasBoundCaller.sol#L18)


```solidity
File: code/system-contracts/contracts/libraries/SystemContractHelper.sol

     |  // @audit-issue Consider grouping constants like this into a single file
   9 |  uint256 constant UINT32_MASK = type(uint32).max;
```
GitHub: [9](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L9)


```solidity
File: code/system-contracts/contracts/libraries/SystemContractsCaller.sol

     |  // @audit-issue Consider grouping constants like this into a single file
  12 |  address constant TO_L1_CALL_ADDRESS = address((1 << 16) - 1);
```
GitHub: [12](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L12)


```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

     |  // @audit-issue Consider grouping constants like this into a single file
  15 |  uint8 constant EIP_712_TX_TYPE = 0x71;
```
GitHub: [15](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L15)


```solidity
File: code/system-contracts/contracts/libraries/Utils.sol

     |  // @audit-issue Consider grouping constants like this into a single file
  13 |  bytes32 constant IS_CONSTRUCTOR_BYTECODE_HASH_BIT_MASK =
  14 |      0x00ff000000000000000000000000000000000000000000000000000000000000;
```
GitHub: [13-14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L13-L14)


```solidity
File: code/system-contracts/contracts/interfaces/IAccount.sol

     |  // @audit-issue Consider grouping constants like this into a single file
   7 |  bytes4 constant ACCOUNT_VALIDATION_SUCCESS_MAGIC = IAccount.validateTransaction.selector;
```
GitHub: [7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IAccount.sol#L7)


```solidity
File: code/system-contracts/contracts/interfaces/ICompressor.sol

     |  // @audit-issue Consider grouping constants like this into a single file
   6 |  uint8 constant OPERATION_BITMASK = 7;
```
GitHub: [6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ICompressor.sol#L6)


```solidity
File: code/system-contracts/contracts/interfaces/IL1Messenger.sol

     |  // @audit-issue Consider grouping constants like this into a single file
  25 |  uint256 constant L2_TO_L1_LOG_SERIALIZE_SIZE = 88;
```
GitHub: [25](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL1Messenger.sol#L25)


```solidity
File: code/system-contracts/contracts/interfaces/IPaymaster.sol

     |  // @audit-issue Consider grouping constants like this into a single file
  12 |  bytes4 constant PAYMASTER_VALIDATION_SUCCESS_MAGIC = IPaymaster.validateAndPayForPaymasterTransaction.selector;
```
GitHub: [12](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IPaymaster.sol#L12)


```solidity
File: code/contracts/zksync/contracts/interfaces/IPaymaster.sol

     |  // @audit-issue Consider grouping constants like this into a single file
  12 |  bytes4 constant PAYMASTER_VALIDATION_SUCCESS_MAGIC = IPaymaster.validateAndPayForPaymasterTransaction.selector;
```
GitHub: [12](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/interfaces/IPaymaster.sol#L12)


```solidity
File: code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol

     |  // @audit-issue Consider grouping constants like this into a single file
  22 |  uint160 constant offset = uint160(0x1111000000000000000000000000000000001111);
```
GitHub: [22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol#L22)


```solidity
File: code/contracts/zksync/contracts/L2ContractHelper.sol

     |  // @audit-issue Consider grouping constants like this into a single file
  68 |  uint160 constant SYSTEM_CONTRACTS_OFFSET = 0x8000; // 2^15
```
GitHub: [68](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/L2ContractHelper.sol#L68)


```solidity
File: code/contracts/zksync/contracts/SystemContractsCaller.sol

     |  // @audit-issue Consider grouping constants like this into a single file
   7 |  address constant SYSTEM_CALL_CALL_ADDRESS = address((1 << 16) - 11);
```
GitHub: [7](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/SystemContractsCaller.sol#L7)


```solidity
File: code/contracts/zksync/contracts/Config.sol

     |  // @audit-issue Consider grouping constants like this into a single file
   8 |  uint256 constant ERA_CHAIN_ID = 9;
```
GitHub: [8](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/Config.sol#L8)


## [N-109] Use a struct to encapsulate multiple function parameters

If a function has too many parameters, replacing them with a struct can improve code readability and maintainability, increase reusability, and reduce the likelihood of errors when passing the parameters.

*Instances: 56*

```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

     |  // @audit-issue Consider replacing multiple parameters with structs
  98 |  function deposit(
  99 |      address _l2Receiver,
 100 |      address _l1Token,
 101 |      uint256 _amount,
 102 |      uint256 _l2TxGasLimit,
 103 |      uint256 _l2TxGasPerPubdataByte
 104 |  ) external payable returns (bytes32 l2TxHash) {

     |  // @audit-issue Consider replacing multiple parameters with structs
 133 |  function deposit(
 134 |      address _l2Receiver,
 135 |      address _l1Token,
 136 |      uint256 _amount,
 137 |      uint256 _l2TxGasLimit,
 138 |      uint256 _l2TxGasPerPubdataByte,
 139 |      address _refundRecipient
 140 |  ) public payable nonReentrant returns (bytes32 l2TxHash) {

     |  // @audit-issue Consider replacing multiple parameters with structs
 176 |  function claimFailedDeposit(
 177 |      address _depositSender,
 178 |      address _l1Token,
 179 |      bytes32 _l2TxHash,
 180 |      uint256 _l2BatchNumber,
 181 |      uint256 _l2MessageIndex,
 182 |      uint16 _l2TxNumberInBatch,
 183 |      bytes32[] calldata _merkleProof
 184 |  ) external nonReentrant {

     |  // @audit-issue Consider replacing multiple parameters with structs
 208 |  function finalizeWithdrawal(
 209 |      uint256 _l2BatchNumber,
 210 |      uint256 _l2MessageIndex,
 211 |      uint16 _l2TxNumberInBatch,
 212 |      bytes calldata _message,
 213 |      bytes32[] calldata _merkleProof
 214 |  ) external nonReentrant {
```
GitHub: [98-104](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L98-L104), [133-140](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L133-L140), [176-184](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L176-L184), [208-214](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L208-L214)


```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

     |  // @audit-issue Consider replacing multiple parameters with structs
 277 |  function claimFailedDeposit(
 278 |      uint256 _chainId,
 279 |      address _depositSender,
 280 |      address _l1Token,
 281 |      uint256 _amount,
 282 |      bytes32 _l2TxHash,
 283 |      uint256 _l2BatchNumber,
 284 |      uint256 _l2MessageIndex,
 285 |      uint16 _l2TxNumberInBatch,
 286 |      bytes32[] calldata _merkleProof
 287 |  ) external override {

     |  // @audit-issue Consider replacing multiple parameters with structs
 303 |  function _claimFailedDeposit(
 304 |      bool _checkedInLegacyBridge,
 305 |      uint256 _chainId,
 306 |      address _depositSender,
 307 |      address _l1Token,
 308 |      uint256 _amount,
 309 |      bytes32 _l2TxHash,
 310 |      uint256 _l2BatchNumber,
 311 |      uint256 _l2MessageIndex,
 312 |      uint16 _l2TxNumberInBatch,
 313 |      bytes32[] calldata _merkleProof
 314 |  ) internal nonReentrant {

     |  // @audit-issue Consider replacing multiple parameters with structs
 385 |  function finalizeWithdrawal(
 386 |      uint256 _chainId,
 387 |      uint256 _l2BatchNumber,
 388 |      uint256 _l2MessageIndex,
 389 |      uint16 _l2TxNumberInBatch,
 390 |      bytes calldata _message,
 391 |      bytes32[] calldata _merkleProof
 392 |  ) external override {

     |  // @audit-issue Consider replacing multiple parameters with structs
 409 |  function _finalizeWithdrawal(
 410 |      uint256 _chainId,
 411 |      uint256 _l2BatchNumber,
 412 |      uint256 _l2MessageIndex,
 413 |      uint16 _l2TxNumberInBatch,
 414 |      bytes calldata _message,
 415 |      bytes32[] calldata _merkleProof
 416 |  ) internal nonReentrant returns (address l1Receiver, address l1Token, uint256 amount) {

     |  // @audit-issue Consider replacing multiple parameters with structs
 554 |  function depositLegacyErc20Bridge(
 555 |      address _prevMsgSender,
 556 |      address _l2Receiver,
 557 |      address _l1Token,
 558 |      uint256 _amount,
 559 |      uint256 _l2TxGasLimit,
 560 |      uint256 _l2TxGasPerPubdataByte,
 561 |      address _refundRecipient
 562 |  ) external payable override onlyLegacyBridge nonReentrant returns (bytes32 l2TxHash) {

     |  // @audit-issue Consider replacing multiple parameters with structs
 615 |  function finalizeWithdrawalLegacyErc20Bridge(
 616 |      uint256 _l2BatchNumber,
 617 |      uint256 _l2MessageIndex,
 618 |      uint16 _l2TxNumberInBatch,
 619 |      bytes calldata _message,
 620 |      bytes32[] calldata _merkleProof
 621 |  ) external override onlyLegacyBridge returns (address l1Receiver, address l1Token, uint256 amount) {

     |  // @audit-issue Consider replacing multiple parameters with structs
 644 |  function claimFailedDepositLegacyErc20Bridge(
 645 |      address _depositSender,
 646 |      address _l1Token,
 647 |      uint256 _amount,
 648 |      bytes32 _l2TxHash,
 649 |      uint256 _l2BatchNumber,
 650 |      uint256 _l2MessageIndex,
 651 |      uint16 _l2TxNumberInBatch,
 652 |      bytes32[] calldata _merkleProof
 653 |  ) external override onlyLegacyBridge {
```
GitHub: [277-287](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L277-L287), [303-314](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L303-L314), [385-392](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L385-L392), [409-416](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L409-L416), [554-562](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L554-L562), [615-621](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L615-L621), [644-653](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L644-L653)


```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

     |  // @audit-issue Consider replacing multiple parameters with structs
 114 |  function createNewChain(
 115 |      uint256 _chainId,
 116 |      address _stateTransitionManager,
 117 |      address _baseToken,
 118 |      uint256, //_salt
 119 |      address _admin,
 120 |      bytes calldata _initData
 121 |  ) external onlyOwnerOrAdmin nonReentrant returns (uint256 chainId) {

     |  // @audit-issue Consider replacing multiple parameters with structs
 152 |  function proveL2MessageInclusion(
 153 |      uint256 _chainId,
 154 |      uint256 _batchNumber,
 155 |      uint256 _index,
 156 |      L2Message calldata _message,
 157 |      bytes32[] calldata _proof
 158 |  ) external view override returns (bool) {

     |  // @audit-issue Consider replacing multiple parameters with structs
 164 |  function proveL2LogInclusion(
 165 |      uint256 _chainId,
 166 |      uint256 _batchNumber,
 167 |      uint256 _index,
 168 |      L2Log memory _log,
 169 |      bytes32[] calldata _proof
 170 |  ) external view override returns (bool) {

     |  // @audit-issue Consider replacing multiple parameters with structs
 176 |  function proveL1ToL2TransactionStatus(
 177 |      uint256 _chainId,
 178 |      bytes32 _l2TxHash,
 179 |      uint256 _l2BatchNumber,
 180 |      uint256 _l2MessageIndex,
 181 |      uint16 _l2TxNumberInBatch,
 182 |      bytes32[] calldata _merkleProof,
 183 |      TxStatus _status
 184 |  ) external view override returns (bool) {
```
GitHub: [114-121](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L114-L121), [152-158](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L152-L158), [164-170](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L164-L170), [176-184](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L176-L184)


```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

     |  // @audit-issue Consider replacing multiple parameters with structs
 241 |  function createNewChain(
 242 |      uint256 _chainId,
 243 |      address _baseToken,
 244 |      address _sharedBridge,
 245 |      address _admin,
 246 |      bytes calldata _diamondCut
 247 |  ) external onlyBridgehub {
```
GitHub: [241-247](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L241-L247)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

     |  // @audit-issue Consider replacing multiple parameters with structs
  74 |  function proveL1ToL2TransactionStatus(
  75 |      bytes32 _l2TxHash,
  76 |      uint256 _l2BatchNumber,
  77 |      uint256 _l2MessageIndex,
  78 |      uint16 _l2TxNumberInBatch,
  79 |      bytes32[] calldata _merkleProof,
  80 |      TxStatus _status
  81 |  ) public view returns (bool) {

     |  // @audit-issue Consider replacing multiple parameters with structs
 178 |  function finalizeEthWithdrawal(
 179 |      uint256 _l2BatchNumber,
 180 |      uint256 _l2MessageIndex,
 181 |      uint16 _l2TxNumberInBatch,
 182 |      bytes calldata _message,
 183 |      bytes32[] calldata _merkleProof
 184 |  ) external nonReentrant {

     |  // @audit-issue Consider replacing multiple parameters with structs
 197 |  function requestL2Transaction(
 198 |      address _contractL2,
 199 |      uint256 _l2Value,
 200 |      bytes calldata _calldata,
 201 |      uint256 _l2GasLimit,
 202 |      uint256 _l2GasPerPubdataByteLimit,
 203 |      bytes[] calldata _factoryDeps,
 204 |      address _refundRecipient
 205 |  ) external payable returns (bytes32 canonicalTxHash) {
```
GitHub: [74-81](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L74-L81), [178-184](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L178-L184), [197-205](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L197-L205)


```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol

     |  // @audit-issue Consider replacing multiple parameters with structs
  26 |  function deposit(
  27 |      address _l2Receiver,
  28 |      address _l1Token,
  29 |      uint256 _amount,
  30 |      uint256 _l2TxGasLimit,
  31 |      uint256 _l2TxGasPerPubdataByte,
  32 |      address _refundRecipient
  33 |  ) external payable returns (bytes32 txHash);

     |  // @audit-issue Consider replacing multiple parameters with structs
  35 |  function deposit(
  36 |      address _l2Receiver,
  37 |      address _l1Token,
  38 |      uint256 _amount,
  39 |      uint256 _l2TxGasLimit,
  40 |      uint256 _l2TxGasPerPubdataByte
  41 |  ) external payable returns (bytes32 txHash);

     |  // @audit-issue Consider replacing multiple parameters with structs
  43 |  function claimFailedDeposit(
  44 |      address _depositSender,
  45 |      address _l1Token,
  46 |      bytes32 _l2TxHash,
  47 |      uint256 _l2BatchNumber,
  48 |      uint256 _l2MessageIndex,
  49 |      uint16 _l2TxNumberInBatch,
  50 |      bytes32[] calldata _merkleProof
  51 |  ) external;

     |  // @audit-issue Consider replacing multiple parameters with structs
  53 |  function finalizeWithdrawal(
  54 |      uint256 _l2BatchNumber,
  55 |      uint256 _l2MessageIndex,
  56 |      uint16 _l2TxNumberInBatch,
  57 |      bytes calldata _message,
  58 |      bytes32[] calldata _merkleProof
  59 |  ) external;
```
GitHub: [26-33](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L26-L33), [35-41](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L35-L41), [43-51](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L43-L51), [53-59](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L53-L59)


```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol

     |  // @audit-issue Consider replacing multiple parameters with structs
  64 |  function depositLegacyErc20Bridge(
  65 |      address _msgSender,
  66 |      address _l2Receiver,
  67 |      address _l1Token,
  68 |      uint256 _amount,
  69 |      uint256 _l2TxGasLimit,
  70 |      uint256 _l2TxGasPerPubdataByte,
  71 |      address _refundRecipient
  72 |  ) external payable returns (bytes32 txHash);

     |  // @audit-issue Consider replacing multiple parameters with structs
  74 |  function claimFailedDepositLegacyErc20Bridge(
  75 |      address _depositSender,
  76 |      address _l1Token,
  77 |      uint256 _amount,
  78 |      bytes32 _l2TxHash,
  79 |      uint256 _l2BatchNumber,
  80 |      uint256 _l2MessageIndex,
  81 |      uint16 _l2TxNumberInBatch,
  82 |      bytes32[] calldata _merkleProof
  83 |  ) external;

     |  // @audit-issue Consider replacing multiple parameters with structs
  85 |  function claimFailedDeposit(
  86 |      uint256 _chainId,
  87 |      address _depositSender,
  88 |      address _l1Token,
  89 |      uint256 _amount,
  90 |      bytes32 _l2TxHash,
  91 |      uint256 _l2BatchNumber,
  92 |      uint256 _l2MessageIndex,
  93 |      uint16 _l2TxNumberInBatch,
  94 |      bytes32[] calldata _merkleProof
  95 |  ) external;

     |  // @audit-issue Consider replacing multiple parameters with structs
  97 |  function finalizeWithdrawalLegacyErc20Bridge(
  98 |      uint256 _l2BatchNumber,
  99 |      uint256 _l2MessageIndex,
 100 |      uint16 _l2TxNumberInBatch,
 101 |      bytes calldata _message,
 102 |      bytes32[] calldata _merkleProof
 103 |  ) external returns (address l1Receiver, address l1Token, uint256 amount);

     |  // @audit-issue Consider replacing multiple parameters with structs
 105 |  function finalizeWithdrawal(
 106 |      uint256 _chainId,
 107 |      uint256 _l2BatchNumber,
 108 |      uint256 _l2MessageIndex,
 109 |      uint16 _l2TxNumberInBatch,
 110 |      bytes calldata _message,
 111 |      bytes32[] calldata _merkleProof
 112 |  ) external;
```
GitHub: [64-72](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L64-L72), [74-83](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L74-L83), [85-95](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L85-L95), [97-103](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L97-L103), [105-112](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL1SharedBridge.sol#L105-L112)


```solidity
File: code/contracts/ethereum/contracts/bridge/interfaces/IL2Bridge.sol

     |  // @audit-issue Consider replacing multiple parameters with structs
   7 |  function finalizeDeposit(
   8 |      address _l1Sender,
   9 |      address _l2Receiver,
  10 |      address _l1Token,
  11 |      uint256 _amount,
  12 |      bytes calldata _data
  13 |  ) external payable;
```
GitHub: [7-13](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/interfaces/IL2Bridge.sol#L7-L13)


```solidity
File: code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol

     |  // @audit-issue Consider replacing multiple parameters with structs
  73 |  function proveL2MessageInclusion(
  74 |      uint256 _chainId,
  75 |      uint256 _batchNumber,
  76 |      uint256 _index,
  77 |      L2Message calldata _message,
  78 |      bytes32[] calldata _proof
  79 |  ) external view returns (bool);

     |  // @audit-issue Consider replacing multiple parameters with structs
  81 |  function proveL2LogInclusion(
  82 |      uint256 _chainId,
  83 |      uint256 _batchNumber,
  84 |      uint256 _index,
  85 |      L2Log memory _log,
  86 |      bytes32[] calldata _proof
  87 |  ) external view returns (bool);

     |  // @audit-issue Consider replacing multiple parameters with structs
  89 |  function proveL1ToL2TransactionStatus(
  90 |      uint256 _chainId,
  91 |      bytes32 _l2TxHash,
  92 |      uint256 _l2BatchNumber,
  93 |      uint256 _l2MessageIndex,
  94 |      uint16 _l2TxNumberInBatch,
  95 |      bytes32[] calldata _merkleProof,
  96 |      TxStatus _status
  97 |  ) external view returns (bool);

     |  // @audit-issue Consider replacing multiple parameters with structs
 116 |  function createNewChain(
 117 |      uint256 _chainId,
 118 |      address _stateTransitionManager,
 119 |      address _baseToken,
 120 |      uint256 _salt,
 121 |      address _admin,
 122 |      bytes calldata _initData
 123 |  ) external returns (uint256 chainId);
```
GitHub: [73-79](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L73-L79), [81-87](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L81-L87), [89-97](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L89-L97), [116-123](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/IBridgehub.sol#L116-L123)


```solidity
File: code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol

     |  // @audit-issue Consider replacing multiple parameters with structs
  74 |  function createNewChain(
  75 |      uint256 _chainId,
  76 |      address _baseToken,
  77 |      address _sharedBridge,
  78 |      address _admin,
  79 |      bytes calldata _diamondCut
  80 |  ) external;
```
GitHub: [74-80](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/IStateTransitionManager.sol#L74-L80)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol

     |  // @audit-issue Consider replacing multiple parameters with structs
  47 |  function proveL1ToL2TransactionStatus(
  48 |      bytes32 _l2TxHash,
  49 |      uint256 _l2BatchNumber,
  50 |      uint256 _l2MessageIndex,
  51 |      uint16 _l2TxNumberInBatch,
  52 |      bytes32[] calldata _merkleProof,
  53 |      TxStatus _status
  54 |  ) external view returns (bool);

     |  // @audit-issue Consider replacing multiple parameters with structs
  62 |  function finalizeEthWithdrawal(
  63 |      uint256 _l2BatchNumber,
  64 |      uint256 _l2MessageIndex,
  65 |      uint16 _l2TxNumberInBatch,
  66 |      bytes calldata _message,
  67 |      bytes32[] calldata _merkleProof
  68 |  ) external;

     |  // @audit-issue Consider replacing multiple parameters with structs
  88 |  function requestL2Transaction(
  89 |      address _contractL2,
  90 |      uint256 _l2Value,
  91 |      bytes calldata _calldata,
  92 |      uint256 _l2GasLimit,
  93 |      uint256 _l2GasPerPubdataByteLimit,
  94 |      bytes[] calldata _factoryDeps,
  95 |      address _refundRecipient
  96 |  ) external payable returns (bytes32 canonicalTxHash);
```
GitHub: [47-54](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L47-L54), [62-68](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L62-L68), [88-96](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IMailbox.sol#L88-L96)


```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

     |  // @audit-issue Consider replacing multiple parameters with structs
 321 |  function _constructContract(
 322 |      address _sender,
 323 |      address _newAddress,
 324 |      bytes32 _bytecodeHash,
 325 |      bytes calldata _input,
 326 |      bool _isSystem,
 327 |      bool _callConstructor
 328 |  ) internal {
```
GitHub: [321-328](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L321-L328)


```solidity
File: code/system-contracts/contracts/SystemContext.sol

     |  // @audit-issue Consider replacing multiple parameters with structs
 341 |  function setL2Block(
 342 |      uint128 _l2BlockNumber,
 343 |      uint128 _l2BlockTimestamp,
 344 |      bytes32 _expectedPrevL2BlockHash,
 345 |      bool _isFirstInBatch,
 346 |      uint128 _maxVirtualBlocksToCreate
 347 |  ) external onlyCallFromBootloader {
```
GitHub: [341-347](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L341-L347)


```solidity
File: code/system-contracts/contracts/libraries/EfficientCall.sol

     |  // @audit-issue Consider replacing multiple parameters with structs
  58 |  function call(
  59 |      uint256 _gas,
  60 |      address _address,
  61 |      uint256 _value,
  62 |      bytes calldata _data,
  63 |      bool _isSystem
  64 |  ) internal returns (bytes memory returnData) {

     |  // @audit-issue Consider replacing multiple parameters with structs
 105 |  function mimicCall(
 106 |      uint256 _gas,
 107 |      address _address,
 108 |      bytes calldata _data,
 109 |      address _whoToMimic,
 110 |      bool _isConstructor,
 111 |      bool _isSystem
 112 |  ) internal returns (bytes memory returnData) {

     |  // @audit-issue Consider replacing multiple parameters with structs
 124 |  function rawCall(
 125 |      uint256 _gas,
 126 |      address _address,
 127 |      uint256 _value,
 128 |      bytes calldata _data,
 129 |      bool _isSystem
 130 |  ) internal returns (bool success) {

     |  // @audit-issue Consider replacing multiple parameters with structs
 191 |  function rawMimicCall(
 192 |      uint256 _gas,
 193 |      address _address,
 194 |      bytes calldata _data,
 195 |      address _whoToMimic,
 196 |      bool _isConstructor,
 197 |      bool _isSystem
 198 |  ) internal returns (bool success) {
```
GitHub: [58-64](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L58-L64), [105-112](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L105-L112), [124-130](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L124-L130), [191-198](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/EfficientCall.sol#L191-L198)


```solidity
File: code/system-contracts/contracts/libraries/SystemContractHelper.sol

     |  // @audit-issue Consider replacing multiple parameters with structs
 124 |  function packPrecompileParams(
 125 |      uint32 _inputMemoryOffset,
 126 |      uint32 _inputMemoryLength,
 127 |      uint32 _outputMemoryOffset,
 128 |      uint32 _outputMemoryLength,
 129 |      uint64 _perPrecompileInterpreted
 130 |  ) internal pure returns (uint256 rawParams) {
```
GitHub: [124-130](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractHelper.sol#L124-L130)


```solidity
File: code/system-contracts/contracts/libraries/SystemContractsCaller.sol

     |  // @audit-issue Consider replacing multiple parameters with structs
 214 |  function getFarCallABI(
 215 |      uint32 dataOffset,
 216 |      uint32 memoryPage,
 217 |      uint32 dataStart,
 218 |      uint32 dataLength,
 219 |      uint32 gasPassed,
 220 |      uint8 shardId,
 221 |      CalldataForwardingMode forwardingMode,
 222 |      bool isConstructorCall,
 223 |      bool isSystemCall
 224 |  ) internal pure returns (uint256 farCallAbi) {

     |  // @audit-issue Consider replacing multiple parameters with structs
 250 |  function getFarCallABIWithEmptyFatPointer(
 251 |      uint32 gasPassed,
 252 |      uint8 shardId,
 253 |      CalldataForwardingMode forwardingMode,
 254 |      bool isConstructorCall,
 255 |      bool isSystemCall
 256 |  ) internal pure returns (uint256 farCallAbiWithEmptyFatPtr) {
```
GitHub: [214-224](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L214-L224), [250-256](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L250-L256)


```solidity
File: code/system-contracts/contracts/interfaces/IMailbox.sol

     |  // @audit-issue Consider replacing multiple parameters with structs
   6 |  function finalizeEthWithdrawal(
   7 |      uint256 _l2BatchNumber,
   8 |      uint256 _l2MessageIndex,
   9 |      uint16 _l2TxNumberInBlock,
  10 |      bytes calldata _message,
  11 |      bytes32[] calldata _merkleProof
  12 |  ) external;
```
GitHub: [6-12](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IMailbox.sol#L6-L12)


```solidity
File: code/system-contracts/contracts/interfaces/IPaymaster.sol

     |  // @audit-issue Consider replacing multiple parameters with structs
  43 |  function postTransaction(
  44 |      bytes calldata _context,
  45 |      Transaction calldata _transaction,
  46 |      bytes32 _txHash,
  47 |      bytes32 _suggestedSignedHash,
  48 |      ExecutionResult _txResult,
  49 |      uint256 _maxRefundedGas
  50 |  ) external payable;
```
GitHub: [43-50](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IPaymaster.sol#L43-L50)


```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

     |  // @audit-issue Consider replacing multiple parameters with structs
  79 |  function finalizeDeposit(
  80 |      address _l1Sender,
  81 |      address _l2Receiver,
  82 |      address _l1Token,
  83 |      uint256 _amount,
  84 |      bytes calldata _data
  85 |  ) external payable override {
```
GitHub: [79-85](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L79-L85)


```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL1ERC20Bridge.sol

     |  // @audit-issue Consider replacing multiple parameters with structs
   9 |  function finalizeWithdrawal(
  10 |      uint256 _l2BatchNumber,
  11 |      uint256 _l2MessageIndex,
  12 |      uint16 _l2TxNumberInBatch,
  13 |      bytes calldata _message,
  14 |      bytes32[] calldata _merkleProof
  15 |  ) external;
```
GitHub: [9-15](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL1ERC20Bridge.sol#L9-L15)


```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL1SharedBridge.sol

     |  // @audit-issue Consider replacing multiple parameters with structs
   9 |  function finalizeWithdrawal(
  10 |      uint256 _chainId,
  11 |      uint256 _l2BatchNumber,
  12 |      uint256 _l2MessageIndex,
  13 |      uint16 _l2TxNumberInBatch,
  14 |      bytes calldata _message,
  15 |      bytes32[] calldata _merkleProof
  16 |  ) external;
```
GitHub: [9-16](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL1SharedBridge.sol#L9-L16)


```solidity
File: code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol

     |  // @audit-issue Consider replacing multiple parameters with structs
  24 |  function finalizeDeposit(
  25 |      address _l1Sender,
  26 |      address _l2Receiver,
  27 |      address _l1Token,
  28 |      uint256 _amount,
  29 |      bytes calldata _data
  30 |  ) external payable;
```
GitHub: [24-30](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/interfaces/IL2SharedBridge.sol#L24-L30)


```solidity
File: code/contracts/zksync/contracts/interfaces/IPaymaster.sol

     |  // @audit-issue Consider replacing multiple parameters with structs
  43 |  function postTransaction(
  44 |      bytes calldata _context,
  45 |      Transaction calldata _transaction,
  46 |      bytes32 _txHash,
  47 |      bytes32 _suggestedSignedHash,
  48 |      ExecutionResult _txResult,
  49 |      uint256 _maxRefundedGas
  50 |  ) external payable;
```
GitHub: [43-50](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/interfaces/IPaymaster.sol#L43-L50)


```solidity
File: code/contracts/zksync/contracts/SystemContractsCaller.sol

     |  // @audit-issue Consider replacing multiple parameters with structs
  95 |  function getFarCallABI(
  96 |      uint32 dataOffset,
  97 |      uint32 memoryPage,
  98 |      uint32 dataStart,
  99 |      uint32 dataLength,
 100 |      uint32 gasPassed,
 101 |      uint8 shardId,
 102 |      CalldataForwardingMode forwardingMode,
 103 |      bool isConstructorCall,
 104 |      bool isSystemCall
 105 |  ) internal pure returns (uint256 farCallAbi) {

     |  // @audit-issue Consider replacing multiple parameters with structs
 121 |  function getFarCallABIWithEmptyFatPointer(
 122 |      uint32 gasPassed,
 123 |      uint8 shardId,
 124 |      CalldataForwardingMode forwardingMode,
 125 |      bool isConstructorCall,
 126 |      bool isSystemCall
 127 |  ) internal pure returns (uint256 farCallAbiWithEmptyFatPtr) {
```
GitHub: [95-105](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/SystemContractsCaller.sol#L95-L105), [121-127](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/SystemContractsCaller.sol#L121-L127)


```solidity
File: code/contracts/zksync/contracts/TestnetPaymaster.sol

     |  // @audit-issue Consider replacing multiple parameters with structs
  70 |  function postTransaction(
  71 |      bytes calldata _context,
  72 |      Transaction calldata _transaction,
  73 |      bytes32,
  74 |      bytes32,
  75 |      ExecutionResult _txResult,
  76 |      uint256 _maxRefundedGas
  77 |  ) external payable override {
```
GitHub: [70-77](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/TestnetPaymaster.sol#L70-L77)


## [N-110] Use ternary expressions over `if`/`else` where possible

The code can be made more compact while also increasing readability by converting the following `if`-statements to ternaries (e.g. `foo += (x > y) ? a : b`)

*Instances: 1*

```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

     |  // @audit-issue Convert to a ternary expression
 406 |  if (address(uint160(_transaction.paymaster)) != address(0)) {
 407 |      // Paymaster pays for the fee
 408 |      requiredBalance = _transaction.value;
 409 |  } else {
 410 |      // The user should have enough balance for both the fee and the value of the transaction
 411 |      requiredBalance = _transaction.maxFeePerGas * _transaction.gasLimit + _transaction.value;
 412 |  }
```
GitHub: [406-412](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L406-L412)


## [N-111] Use the latest Solidity version for deployment

When deploying contracts, you should use the latest released version of Solidity (0.8.25). Apart from exceptional cases, only the latest version receives security fixes. Since deployed contracts should not use floating pragmas, I've flagged all instances where a version prior to 0.8.25 is allowed by the version pragma.

*Instances: 43*

```solidity
File: code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol

     |  // @audit-issue Update to target 0.8.25
   3 |  pragma solidity 0.8.20;
```
GitHub: [3](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1ERC20Bridge.sol#L3)


```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

     |  // @audit-issue Update to target 0.8.25
   3 |  pragma solidity 0.8.20;
```
GitHub: [3](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L3)


```solidity
File: code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol

     |  // @audit-issue Update to target 0.8.25
   3 |  pragma solidity 0.8.20;
```
GitHub: [3](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridgehub/Bridgehub.sol#L3)


```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

     |  // @audit-issue Update to target 0.8.25
   3 |  pragma solidity 0.8.20;
```
GitHub: [3](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L3)


```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

     |  // @audit-issue Update to target 0.8.25
   1 |  pragma solidity 0.8.20;
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

     |  // @audit-issue Update to target 0.8.25
   3 |  pragma solidity 0.8.20;
```
GitHub: [3](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L3)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol

     |  // @audit-issue Update to target 0.8.25
   3 |  pragma solidity 0.8.20;
```
GitHub: [3](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol#L3)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol

     |  // @audit-issue Update to target 0.8.25
   3 |  pragma solidity 0.8.20;
```
GitHub: [3](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol#L3)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol

     |  // @audit-issue Update to target 0.8.25
   3 |  pragma solidity 0.8.20;
```
GitHub: [3](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Admin.sol#L3)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

     |  // @audit-issue Update to target 0.8.25
   3 |  pragma solidity 0.8.20;
```
GitHub: [3](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L3)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol

     |  // @audit-issue Update to target 0.8.25
   3 |  pragma solidity 0.8.20;
```
GitHub: [3](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L3)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

     |  // @audit-issue Update to target 0.8.25
   3 |  pragma solidity 0.8.20;
```
GitHub: [3](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L3)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol

     |  // @audit-issue Update to target 0.8.25
   3 |  pragma solidity 0.8.20;
```
GitHub: [3](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/ZkSyncStateTransitionBase.sol#L3)


```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol

     |  // @audit-issue Update to target 0.8.25
   3 |  pragma solidity 0.8.20;
```
GitHub: [3](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L3)


```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol

     |  // @audit-issue Update to target 0.8.25
   3 |  pragma solidity 0.8.20;
```
GitHub: [3](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L3)


```solidity
File: code/contracts/ethereum/contracts/upgrades/DefaultUpgrade.sol

     |  // @audit-issue Update to target 0.8.25
   3 |  pragma solidity 0.8.20;
```
GitHub: [3](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/DefaultUpgrade.sol#L3)


```solidity
File: code/contracts/ethereum/contracts/upgrades/GenesisUpgrade.sol

     |  // @audit-issue Update to target 0.8.25
   3 |  pragma solidity 0.8.20;
```
GitHub: [3](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/GenesisUpgrade.sol#L3)


```solidity
File: code/contracts/ethereum/contracts/common/ReentrancyGuard.sol

     |  // @audit-issue Update to target 0.8.25
   3 |  pragma solidity 0.8.20;
```
GitHub: [3](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/ReentrancyGuard.sol#L3)


```solidity
File: code/contracts/ethereum/contracts/state-transition/Verifier.sol

     |  // @audit-issue Update to target 0.8.25
   3 |  pragma solidity 0.8.20;
```
GitHub: [3](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/Verifier.sol#L3)


```solidity
File: code/contracts/ethereum/contracts/upgrades/Upgrade_4844.sol

     |  // @audit-issue Update to target 0.8.25
   1 |  pragma solidity 0.8.20;
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/Upgrade_4844.sol#L1)


```solidity
File: code/contracts/ethereum/contracts/upgrades/Upgrade_v1_4_1.sol

     |  // @audit-issue Update to target 0.8.25
   1 |  pragma solidity 0.8.20;
```
GitHub: [1](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/Upgrade_v1_4_1.sol#L1)


```solidity
File: code/system-contracts/contracts/AccountCodeStorage.sol

     |  // @audit-issue Update to target 0.8.25
   3 |  pragma solidity 0.8.20;
```
GitHub: [3](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L3)


```solidity
File: code/system-contracts/contracts/BootloaderUtilities.sol

     |  // @audit-issue Update to target 0.8.25
   3 |  pragma solidity 0.8.20;
```
GitHub: [3](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/BootloaderUtilities.sol#L3)


```solidity
File: code/system-contracts/contracts/ComplexUpgrader.sol

     |  // @audit-issue Update to target 0.8.25
   3 |  pragma solidity 0.8.20;
```
GitHub: [3](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ComplexUpgrader.sol#L3)


```solidity
File: code/system-contracts/contracts/Compressor.sol

     |  // @audit-issue Update to target 0.8.25
   3 |  pragma solidity 0.8.20;
```
GitHub: [3](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L3)


```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

     |  // @audit-issue Update to target 0.8.25
   3 |  pragma solidity 0.8.20;
```
GitHub: [3](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L3)


```solidity
File: code/system-contracts/contracts/DefaultAccount.sol

     |  // @audit-issue Update to target 0.8.25
   3 |  pragma solidity 0.8.20;
```
GitHub: [3](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/DefaultAccount.sol#L3)


```solidity
File: code/system-contracts/contracts/EmptyContract.sol

     |  // @audit-issue Update to target 0.8.25
   3 |  pragma solidity 0.8.20;
```
GitHub: [3](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/EmptyContract.sol#L3)


```solidity
File: code/system-contracts/contracts/ImmutableSimulator.sol

     |  // @audit-issue Update to target 0.8.25
   3 |  pragma solidity 0.8.20;
```
GitHub: [3](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ImmutableSimulator.sol#L3)


```solidity
File: code/system-contracts/contracts/KnownCodesStorage.sol

     |  // @audit-issue Update to target 0.8.25
   3 |  pragma solidity 0.8.20;
```
GitHub: [3](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/KnownCodesStorage.sol#L3)


```solidity
File: code/system-contracts/contracts/L1Messenger.sol

     |  // @audit-issue Update to target 0.8.25
   3 |  pragma solidity 0.8.20;
```
GitHub: [3](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L3)


```solidity
File: code/system-contracts/contracts/L2BaseToken.sol

     |  // @audit-issue Update to target 0.8.25
   3 |  pragma solidity 0.8.20;
```
GitHub: [3](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L2BaseToken.sol#L3)


```solidity
File: code/system-contracts/contracts/MsgValueSimulator.sol

     |  // @audit-issue Update to target 0.8.25
   3 |  pragma solidity 0.8.20;
```
GitHub: [3](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/MsgValueSimulator.sol#L3)


```solidity
File: code/system-contracts/contracts/NonceHolder.sol

     |  // @audit-issue Update to target 0.8.25
   3 |  pragma solidity 0.8.20;
```
GitHub: [3](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/NonceHolder.sol#L3)


```solidity
File: code/system-contracts/contracts/PubdataChunkPublisher.sol

     |  // @audit-issue Update to target 0.8.25
   2 |  pragma solidity 0.8.20;
```
GitHub: [2](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/PubdataChunkPublisher.sol#L2)


```solidity
File: code/system-contracts/contracts/SystemContext.sol

     |  // @audit-issue Update to target 0.8.25
   3 |  pragma solidity 0.8.20;
```
GitHub: [3](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L3)


```solidity
File: code/system-contracts/contracts/GasBoundCaller.sol

     |  // @audit-issue Update to target 0.8.25
   3 |  pragma solidity 0.8.20;
```
GitHub: [3](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/GasBoundCaller.sol#L3)


```solidity
File: code/system-contracts/contracts/interfaces/ISystemContract.sol

     |  // @audit-issue Update to target 0.8.25
   3 |  pragma solidity 0.8.20;
```
GitHub: [3](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContract.sol#L3)


```solidity
File: code/contracts/zksync/contracts/bridge/L2SharedBridge.sol

     |  // @audit-issue Update to target 0.8.25
   3 |  pragma solidity 0.8.20;
```
GitHub: [3](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2SharedBridge.sol#L3)


```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

     |  // @audit-issue Update to target 0.8.25
   3 |  pragma solidity 0.8.20;
```
GitHub: [3](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L3)


```solidity
File: code/contracts/zksync/contracts/ForceDeployUpgrader.sol

     |  // @audit-issue Update to target 0.8.25
   3 |  pragma solidity 0.8.20;
```
GitHub: [3](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/ForceDeployUpgrader.sol#L3)


```solidity
File: code/contracts/zksync/contracts/TestnetPaymaster.sol

     |  // @audit-issue Update to target 0.8.25
   3 |  pragma solidity 0.8.20;
```
GitHub: [3](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/TestnetPaymaster.sol#L3)


```solidity
File: code/contracts/zksync/contracts/bridge/L2WrappedBaseToken.sol

     |  // @audit-issue Update to target 0.8.25
   3 |  pragma solidity 0.8.20;
```
GitHub: [3](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2WrappedBaseToken.sol#L3)


## [N-112] Variables need not be initialized to zero

The default value for variables is zero, so initializing them to zero is superfluous. This will also save gas if the variable is a mutable state variable.

*Instances: 38*

```solidity
File: code/contracts/ethereum/contracts/governance/Governance.sol

     |  // @audit-issue Initial value is unnecessary
 225 |  for (uint256 i = 0; i < _calls.length; ++i) {
```
GitHub: [225](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/governance/Governance.sol#L225)


```solidity
File: code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol

     |  // @audit-issue Initial value is unnecessary
 116 |  for (uint256 i = 0; i < _newBatchesData.length; ++i) {

     |  // @audit-issue Initial value is unnecessary
 135 |  for (uint256 i = 0; i < _newBatchesData.length; ++i) {

     |  // @audit-issue Initial value is unnecessary
 185 |  for (uint256 i = 0; i < _newBatchesData.length; ++i) {

     |  // @audit-issue Initial value is unnecessary
 209 |  for (uint256 i = 0; i < _newBatchesData.length; ++i) {
```
GitHub: [116](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L116), [135](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L135), [185](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L185), [209](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/ValidatorTimelock.sol#L209)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

     |  // @audit-issue Initial value is unnecessary
 142 |  for (uint256 i = 0; i < emittedL2Logs.length; i = i.uncheckedAdd(L2_TO_L1_LOG_SERIALIZE_SIZE)) {

     |  // @audit-issue Initial value is unnecessary
 257 |  for (uint256 i = 0; i < _newBatchesData.length; i = i.uncheckedInc()) {

     |  // @audit-issue Initial value is unnecessary
 289 |  for (uint256 i = 0; i < _newBatchesData.length; i = i.uncheckedInc()) {

     |  // @audit-issue Initial value is unnecessary
 311 |  for (uint256 i = 0; i < _nPriorityOps; i = i.uncheckedInc()) {

     |  // @audit-issue Initial value is unnecessary
 351 |  for (uint256 i = 0; i < nBatches; i = i.uncheckedInc()) {

     |  // @audit-issue Initial value is unnecessary
 405 |  for (uint256 i = 0; i < committedBatchesLength; i = i.uncheckedInc()) {

     |  // @audit-issue Initial value is unnecessary
 580 |  for (uint i = 0; i < MAX_NUMBER_OF_BLOBS; i++) {

     |  // @audit-issue Initial value is unnecessary
 629 |  uint256 versionedHashIndex = 0;

     |  // @audit-issue Initial value is unnecessary
 636 |  for (uint256 i = 0; i < _pubdataCommitments.length; i += PUBDATA_COMMITMENT_SIZE) {

     |  // @audit-issue Initial value is unnecessary
 667 |  for (uint256 i = 0; i < MAX_NUMBER_OF_BLOBS; i++) {
```
GitHub: [142](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L142), [257](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L257), [289](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L289), [311](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L311), [351](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L351), [405](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L405), [580](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L580), [629](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L629), [636](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L636), [667](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L667)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol

     |  // @audit-issue Initial value is unnecessary
 208 |  for (uint256 i = 0; i < facetsLen; i = i.uncheckedInc()) {
```
GitHub: [208](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Getters.sol#L208)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

     |  // @audit-issue Initial value is unnecessary
 356 |  for (uint256 i = 0; i < factoryDepsLen; i = i.uncheckedInc()) {
```
GitHub: [356](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L356)


```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol

     |  // @audit-issue Initial value is unnecessary
 226 |  for (uint256 i = 0; i < _factoryDeps.length; ++i) {
```
GitHub: [226](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L226)


```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol

     |  // @audit-issue Initial value is unnecessary
 101 |  for (uint256 i = 0; i < facetCutsLength; i = i.uncheckedInc()) {

     |  // @audit-issue Initial value is unnecessary
 138 |  for (uint256 i = 0; i < selectorsLength; i = i.uncheckedInc()) {

     |  // @audit-issue Initial value is unnecessary
 158 |  for (uint256 i = 0; i < selectorsLength; i = i.uncheckedInc()) {

     |  // @audit-issue Initial value is unnecessary
 178 |  for (uint256 i = 0; i < selectorsLength; i = i.uncheckedInc()) {
```
GitHub: [101](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L101), [138](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L138), [158](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L158), [178](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L178)


```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol

     |  // @audit-issue Initial value is unnecessary
  92 |  uint256 costForPubdata = 0;
```
GitHub: [92](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L92)


```solidity
File: code/system-contracts/contracts/Compressor.sol

     |  // @audit-issue Initial value is unnecessary
  61 |  for (uint256 encodedDataPointer = 0; encodedDataPointer < encodedData.length; encodedDataPointer += 2) {

     |  // @audit-issue Initial value is unnecessary
 124 |  uint256 numInitialWritesProcessed = 0;

     |  // @audit-issue Initial value is unnecessary
 127 |  for (uint256 i = 0; i < _numberOfStateDiffs * STATE_DIFF_ENTRY_SIZE; i += STATE_DIFF_ENTRY_SIZE) {

     |  // @audit-issue Initial value is unnecessary
 159 |  for (uint256 i = 0; i < _numberOfStateDiffs * STATE_DIFF_ENTRY_SIZE; i += STATE_DIFF_ENTRY_SIZE) {
```
GitHub: [61](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L61), [124](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L124), [127](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L127), [159](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Compressor.sol#L159)


```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

     |  // @audit-issue Initial value is unnecessary
 247 |  uint256 sumOfValues = 0;

     |  // @audit-issue Initial value is unnecessary
 248 |  for (uint256 i = 0; i < deploymentsLength; ++i) {

     |  // @audit-issue Initial value is unnecessary
 253 |  for (uint256 i = 0; i < deploymentsLength; ++i) {
```
GitHub: [247](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L247), [248](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L248), [253](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L253)


```solidity
File: code/system-contracts/contracts/ImmutableSimulator.sol

     |  // @audit-issue Initial value is unnecessary
  38 |  for (uint256 i = 0; i < immutablesLength; ++i) {
```
GitHub: [38](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ImmutableSimulator.sol#L38)


```solidity
File: code/system-contracts/contracts/KnownCodesStorage.sol

     |  // @audit-issue Initial value is unnecessary
  30 |  for (uint256 i = 0; i < hashesLen; ++i) {
```
GitHub: [30](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/KnownCodesStorage.sol#L30)


```solidity
File: code/system-contracts/contracts/L1Messenger.sol

     |  // @audit-issue Initial value is unnecessary
 197 |  uint256 calldataPtr = 0;

     |  // @audit-issue Initial value is unnecessary
 206 |  for (uint256 i = 0; i < numberOfL2ToL1Logs; ++i) {

     |  // @audit-issue Initial value is unnecessary
 224 |  for (uint256 i = 0; i < nodesOnCurrentLevel; ++i) {

     |  // @audit-issue Initial value is unnecessary
 236 |  for (uint256 i = 0; i < numberOfMessages; ++i) {

     |  // @audit-issue Initial value is unnecessary
 254 |  for (uint256 i = 0; i < numberOfBytecodes; ++i) {
```
GitHub: [197](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L197), [206](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L206), [224](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L224), [236](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L236), [254](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L254)


```solidity
File: code/system-contracts/contracts/PubdataChunkPublisher.sol

     |  // @audit-issue Initial value is unnecessary
  36 |  for (uint256 i = 0; i < MAX_NUMBER_OF_BLOBS; i++) {
```
GitHub: [36](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/PubdataChunkPublisher.sol#L36)


## [N-113] Visibility should be explicitly set rather than defaulting to `internal`

The default visibility for mappings and state variables is `internal`. Explicitly defining visibility improves readability and reduces margin for error during development, testing and auditing.

*Instances: 11*

```solidity
File: code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol

     |  // @audit-issue Explicitly declare visibility
  22 |  uint160 constant offset = uint160(0x1111000000000000000000000000000000001111);
```
GitHub: [22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/vendor/AddressAliasHelper.sol#L22)


```solidity
File: code/system-contracts/contracts/AccountCodeStorage.sol

     |  // @audit-issue Explicitly declare visibility
  23 |  bytes32 constant EMPTY_STRING_KECCAK = 0xc5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470;
```
GitHub: [23](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/AccountCodeStorage.sol#L23)


```solidity
File: code/system-contracts/contracts/MsgValueSimulator.sol

     |  // @audit-issue Explicitly declare visibility
  36 |  uint256 constant GAS_TO_PASS = 2300;

     |  // @audit-issue Explicitly declare visibility
  41 |  uint256 constant MSG_VALUE_SIMULATOR_STIPEND_GAS = 27000;
```
GitHub: [36](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/MsgValueSimulator.sol#L36), [41](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/MsgValueSimulator.sol#L41)


```solidity
File: code/system-contracts/contracts/GasBoundCaller.sol

     |  // @audit-issue Explicitly declare visibility
  18 |  uint256 constant CALL_ENTRY_OVERHEAD = 800;

     |  // @audit-issue Explicitly declare visibility
  21 |  uint256 constant CALL_RETURN_OVERHEAD = 200;
```
GitHub: [18](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/GasBoundCaller.sol#L18), [21](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/GasBoundCaller.sol#L21)


```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

     |  // @audit-issue Explicitly declare visibility
  82 |  bytes32 constant EIP712_DOMAIN_TYPEHASH = keccak256("EIP712Domain(string name,string version,uint256 chainId)");

     |  // @audit-issue Explicitly declare visibility
  84 |  bytes32 constant EIP712_TRANSACTION_TYPE_HASH =
  85 |      keccak256(
  86 |          "Transaction(uint256 txType,uint256 from,uint256 to,uint256 gasLimit,uint256 gasPerPubdataByteLimit,uint256 maxFeePerGas,uint256 maxPriorityFeePerGas,uint256 paymaster,uint256 nonce,uint256 value,bytes data,bytes32[] factoryDeps,bytes paymasterInput)"
  87 |      );
```
GitHub: [82](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L82), [84-87](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L84-L87)


```solidity
File: code/system-contracts/contracts/libraries/Utils.sol

     |  // @audit-issue Explicitly declare visibility
  13 |  bytes32 constant IS_CONSTRUCTOR_BYTECODE_HASH_BIT_MASK =
  14 |      0x00ff000000000000000000000000000000000000000000000000000000000000;

     |  // @audit-issue Explicitly declare visibility
  17 |  bytes32 constant SET_IS_CONSTRUCTOR_MARKER_BIT_MASK =
  18 |      0x0001000000000000000000000000000000000000000000000000000000000000;
```
GitHub: [13-14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L13-L14), [17-18](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L17-L18)


```solidity
File: code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol

     |  // @audit-issue Explicitly declare visibility
  22 |  uint160 constant offset = uint160(0x1111000000000000000000000000000000001111);
```
GitHub: [22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/vendor/AddressAliasHelper.sol#L22)


## [N-114] `2**<n> - 1` should be re-written as `type(uint<n>).max`

Earlier versions of solidity can use `uint<n>(-1)` instead. Expressions not including the `- 1` can often be re-written to accomodate the change (e.g. by using a `>` rather than a `>=`, which will also save some gas).

*Instances: 3*

```solidity
File: code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol

     |  // @audit-issue Rewrite as with type(uint<n>).max (<=)
  26 |  require(bytecodeLenInWords < 2 ** 16, "pp"); // bytecode length must be less than 2^16 words
```
GitHub: [26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L26)


```solidity
File: code/system-contracts/contracts/Constants.sol

     |  // @audit-issue Rewrite as with type(uint<n>).max (<=)
  94 |  uint256 constant MAX_MSG_VALUE = 2 ** 128 - 1;
```
GitHub: [94](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/Constants.sol#L94)


```solidity
File: code/system-contracts/contracts/libraries/Utils.sol

     |  // @audit-issue Rewrite as with type(uint<n>).max (<=)
  87 |  require(lengthInWords < 2 ** 16, "pp"); // bytecode length must be less than 2^16 words
```
GitHub: [87](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/Utils.sol#L87)


## [N-115] `abi.encodePacked()` should not be used with dynamic types when passing the result to a hash function such as `keccak256()`

Use `abi.encode()` instead which will pad items to 32 bytes, which will [prevent hash collisions](https://docs.soliditylang.org/en/v0.8.13/abi-spec.html#non-standard-packed-mode) (e.g. `abi.encodePacked(0x123,0x456)` => `0x123456` => `abi.encodePacked(0x1,0x23456)`, but `abi.encode(0x123,0x456)` => `0x0...1230...456`). "Unless there is a compelling reason, `abi.encode` should be preferred". If there is only one argument to `abi.encodePacked()` it can often be cast to `bytes()` or `bytes32()` [instead](https://ethereum.stackexchange.com/questions/30912/how-to-compare-strings-in-solidity#answer-82739). If all arguments are strings and or bytes, `bytes.concat()` should be used instead

*Instances: 8*

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

     |  // @audit-issue Use abi.encode instead to prevent dynamic-length hash collisions
 460 |  keccak256(
 461 |      abi.encodePacked(
 462 |          _prevBatchCommitment,
 463 |          _currentBatchCommitment,
 464 |          _verifierParams.recursionNodeLevelVkHash,
 465 |          _verifierParams.recursionLeafLevelVkHash
 466 |      )
 467 |  )

     |  // @audit-issue Use abi.encode instead to prevent dynamic-length hash collisions
 654 |  blobCommitments[versionedHashIndex] = keccak256(
 655 |      abi.encodePacked(blobVersionedHash, _pubdataCommitments[i:i + PUBDATA_COMMITMENT_COMMITMENT_OFFSET])
 656 |  );
```
GitHub: [460-467](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L460-L467), [654-656](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L654-L656)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

     |  // @audit-issue Use abi.encode instead to prevent dynamic-length hash collisions
 112 |  bytes32 hashedLog = keccak256(
 113 |      abi.encodePacked(_log.l2ShardId, _log.isService, _log.txNumberInBatch, _log.sender, _log.key, _log.value)
 114 |  );
```
GitHub: [112-114](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L112-L114)


```solidity
File: code/system-contracts/contracts/L1Messenger.sol

     |  // @audit-issue Use abi.encode instead to prevent dynamic-length hash collisions
  95 |  bytes32 hashedLog = keccak256(
  96 |      abi.encodePacked(
  97 |          _l2ToL1Log.l2ShardId,
  98 |          _l2ToL1Log.isService,
  99 |          _l2ToL1Log.txNumberInBlock,
 100 |          _l2ToL1Log.sender,
 101 |          _l2ToL1Log.key,
 102 |          _l2ToL1Log.value
 103 |      )
 104 |  );
```
GitHub: [95-104](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/L1Messenger.sol#L95-L104)


```solidity
File: code/system-contracts/contracts/SystemContext.sol

     |  // @audit-issue Use abi.encode instead to prevent dynamic-length hash collisions
 234 |  return keccak256(abi.encodePacked(uint32(_blockNumber)));
```
GitHub: [234](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L234)


```solidity
File: code/system-contracts/contracts/libraries/TransactionHelper.sol

     |  // @audit-issue Use abi.encode instead to prevent dynamic-length hash collisions
 119 |  bytes32 structHash = keccak256(
 120 |      abi.encode(
 121 |          EIP712_TRANSACTION_TYPE_HASH,
 122 |          _transaction.txType,
 123 |          _transaction.from,
 124 |          _transaction.to,
 125 |          _transaction.gasLimit,
 126 |          _transaction.gasPerPubdataByteLimit,
 127 |          _transaction.maxFeePerGas,
 128 |          _transaction.maxPriorityFeePerGas,
 129 |          _transaction.paymaster,
 130 |          _transaction.nonce,
 131 |          _transaction.value,
 132 |          EfficientCall.keccak(_transaction.data),
 133 |          keccak256(abi.encodePacked(_transaction.factoryDeps)),
 134 |          EfficientCall.keccak(_transaction.paymasterInput)
 135 |      )
 136 |  );

     |  // @audit-issue Use abi.encode instead to prevent dynamic-length hash collisions
 133 |  keccak256(abi.encodePacked(_transaction.factoryDeps)),

     |  // @audit-issue Use abi.encode instead to prevent dynamic-length hash collisions
 142 |  return keccak256(abi.encodePacked("\x19\x01", domainSeparator, structHash));
```
GitHub: [119-136](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L119-L136), [133](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L133), [142](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/TransactionHelper.sol#L142)


## [N-116] `constant`s should be defined rather than using magic numbers

Magic numbers are prone to error and reduce contract readability. This applies to assembly, too.

*Instances: 56*

```solidity
File: code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol

     |      // @audit-issue Define a named constant instead of using `18`
 258 |      bytes memory decimals = abi.encode(uint8(18));
  :  |
     |  // @audit-issue Define a named constant instead of using `56`
 501 |  require(_l2ToL1message.length >= 56, "ShB wrong msg len"); // wrong messsage length
  :  |
     |      // @audit-issue Define a named constant instead of using `76`
 517 |      require(_l2ToL1message.length == 76, "ShB wrong msg len 2");
```
GitHub: [258](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L258), [501](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L501), [517](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/bridge/L1SharedBridge.sol#L517)


```solidity
File: code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol

     |  // @audit-issue Define a named constant instead of using `2`
     |  // @audit-issue Define a named constant instead of using `32`
 108 |  assert(L2_TO_L1_LOG_SERIALIZE_SIZE != 2 * 32);
  :  |
     |      // @audit-issue Define a named constant instead of using `72000000`
 188 |      gasLimit: 72000000,
```
GitHub: [108](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L108), [108](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L108), [188](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/StateTransitionManager.sol#L188)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol

     |  // @audit-issue Define a named constant instead of using `2`
     |  // @audit-issue Define a named constant instead of using `32`
  51 |  assert(L2_TO_L1_LOG_SERIALIZE_SIZE != 2 * 32);
```
GitHub: [51](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol#L51), [51](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondInit.sol#L51)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol

     |  // @audit-issue Define a named constant instead of using `4`
  25 |  require(msg.data.length >= 4 || msg.data.length == 0, "Ut");
```
GitHub: [25](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/DiamondProxy.sol#L25)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol

     |  // @audit-issue Define a named constant instead of using `7`
  68 |  uint256[7] __DEPRECATED_diamondCutStorage;
```
GitHub: [68](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/ZkSyncStateTransitionStorage.sol#L68)


```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

     |              // @audit-issue Define a named constant instead of using `32`
  63 |              keccak256(_newBatch.pubdataCommitments[1:_newBatch.pubdataCommitments.length - 32]),
  :  |
     |          // @audit-issue Define a named constant instead of using `32`
  68 |          _newBatch.pubdataCommitments[_newBatch.pubdataCommitments.length - 32:_newBatch
  :  |
     |  // @audit-issue Define a named constant instead of using `128`
 109 |  uint256 batchTimestamp = _packedBatchAndL2BlockTimestamp >> 128;
  :  |
     |      // @audit-issue Define a named constant instead of using `511`
 192 |      require(processedLogs == 511, "b7");
  :  |
     |      // @audit-issue Define a named constant instead of using `1023`
 194 |      require(processedLogs == 1023, "b8");
  :  |
     |  // @audit-issue Define a named constant instead of using `2`
 578 |  blobAuxOutputWords = new bytes32[](2 * TOTAL_BLOBS_IN_COMMITMENT);
  :  |
     |      // @audit-issue Define a named constant instead of using `2`
 581 |      blobAuxOutputWords[i * 2] = _blobHashes[i];
     |      // @audit-issue Define a named constant instead of using `2`
 582 |      blobAuxOutputWords[i * 2 + 1] = _blobCommitments[i];
```
GitHub: [63](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L63), [68](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L68), [109](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L109), [192](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L192), [194](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L194), [578](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L578), [581](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L581), [582](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L582)


```solidity
File: code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol

     |  // @audit-issue Define a named constant instead of using `32`
  23 |  require(_bytecode.length % 32 == 0, "pq");
  :  |
     |  // @audit-issue Define a named constant instead of using `32`
  25 |  uint256 bytecodeLenInWords = _bytecode.length / 32;
     |  // @audit-issue Define a named constant instead of using `2 ** 16`
  26 |  require(bytecodeLenInWords < 2 ** 16, "pp"); // bytecode length must be less than 2^16 words
     |  // @audit-issue Define a named constant instead of using `2`
  27 |  require(bytecodeLenInWords % 2 == 1, "ps"); // bytecode length in words must be odd
     |  // @audit-issue Define a named constant instead of using `0x00000000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF`
  28 |  hashedBytecode = sha256(_bytecode) & 0x00000000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF;
  :  |
     |  // @audit-issue Define a named constant instead of using `248`
  30 |  hashedBytecode = (hashedBytecode | bytes32(uint256(1 << 248)));
  :  |
     |  // @audit-issue Define a named constant instead of using `224`
  32 |  hashedBytecode = hashedBytecode | bytes32(bytecodeLenInWords << 224);
  :  |
     |  // @audit-issue Define a named constant instead of using `2`
  43 |  require(bytecodeLen(_bytecodeHash) % 2 == 1, "uy"); // Code length in words must be odd
  :  |
     |  // @audit-issue Define a named constant instead of using `2`
     |  // @audit-issue Define a named constant instead of using `256`
     |  // @audit-issue Define a named constant instead of using `3`
  50 |  codeLengthInWords = uint256(uint8(_bytecodeHash[2])) * 256 + uint256(uint8(_bytecodeHash[3]));
```
GitHub: [23](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L23), [25](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L25), [26](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L26), [27](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L27), [28](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L28), [30](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L30), [32](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L32), [43](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L43), [50](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L50), [50](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L50), [50](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol#L50)


```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol

     |      // @audit-issue Define a named constant instead of using `4`
 286 |      if (data.length <= 4) {
  :  |
     |  // @audit-issue Define a named constant instead of using `32`
 297 |  require(data.length == 32, "lp");
```
GitHub: [286](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L286), [297](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Diamond.sol#L297)


```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/LibMap.sol

     |  // @audit-issue Define a named constant instead of using `8`
  23 |  uint256 mapValue = _map.map[_index / 8];
  :  |
     |  // @audit-issue Define a named constant instead of using `7`
     |  // @audit-issue Define a named constant instead of using `32`
  27 |  uint256 bitOffset = (_index & 7) * 32;
  :  |
     |  // @audit-issue Define a named constant instead of using `8`
  43 |  uint256 mapIndex = _index / 8;
  :  |
     |  // @audit-issue Define a named constant instead of using `7`
     |  // @audit-issue Define a named constant instead of using `32`
  48 |  uint256 bitOffset = (_index & 7) * 32;
```
GitHub: [23](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/LibMap.sol#L23), [27](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/LibMap.sol#L27), [27](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/LibMap.sol#L27), [43](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/LibMap.sol#L43), [48](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/LibMap.sol#L48), [48](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/LibMap.sol#L48)


```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol

     |  // @audit-issue Define a named constant instead of using `256`
  25 |  require(pathLength < 256, "bt");
  :  |
     |      // @audit-issue Define a named constant instead of using `2`
  30 |      currentHash = (_index % 2 == 0)
  :  |
     |      // @audit-issue Define a named constant instead of using `2`
  33 |      _index /= 2;
```
GitHub: [25](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol#L25), [30](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol#L30), [33](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/Merkle.sol#L33)


```solidity
File: code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol

     |  // @audit-issue Define a named constant instead of using `2`
  56 |  require(_transaction.reserved[2] == 0, "ug");
     |  // @audit-issue Define a named constant instead of using `3`
  57 |  require(_transaction.reserved[3] == 0, "uo");
  :  |
     |      // @audit-issue Define a named constant instead of using `544`
  83 |      costForComputation += Math.ceilDiv(_encodingLength * L1_TX_DELTA_544_ENCODING_BYTES, 544);
```
GitHub: [56](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L56), [57](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L57), [83](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/libraries/TransactionValidator.sol#L83)


```solidity
File: code/contracts/ethereum/contracts/common/Config.sol

     |  // @audit-issue Define a named constant instead of using `4`
     |  // @audit-issue Define a named constant instead of using `512`
  16 |  uint256 constant MAX_L2_TO_L1_LOGS_COMMITMENT_BYTES = 4 + L2_TO_L1_LOG_SERIALIZE_SIZE * 512;
  :  |
     |  // @audit-issue Define a named constant instead of using `0x0A`
  87 |  address constant POINT_EVALUATION_PRECOMPILE_ADDR = address(0x0A);
  :  |
     |  // @audit-issue Define a named constant instead of using `1233`
 109 |  address constant ERA_ERC20_BRIDGE_ADDRESS = address(1233);
```
GitHub: [16](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/Config.sol#L16), [16](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/Config.sol#L16), [87](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/Config.sol#L87), [109](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/Config.sol#L109)


```solidity
File: code/contracts/ethereum/contracts/common/L2ContractAddresses.sol

     |  // @audit-issue Define a named constant instead of using `0x8001`
   6 |  address constant L2_BOOTLOADER_ADDRESS = address(0x8001);
  :  |
     |  // @audit-issue Define a named constant instead of using `0x8004`
   9 |  address constant L2_KNOWN_CODE_STORAGE_SYSTEM_CONTRACT_ADDR = address(0x8004);
  :  |
     |  // @audit-issue Define a named constant instead of using `0x8006`
  12 |  address constant L2_DEPLOYER_SYSTEM_CONTRACT_ADDR = address(0x8006);
  :  |
     |  // @audit-issue Define a named constant instead of using `0x8007`
  21 |  address constant L2_FORCE_DEPLOYER_ADDR = address(0x8007);
  :  |
     |  // @audit-issue Define a named constant instead of using `0x8008`
  24 |  address constant L2_TO_L1_MESSENGER_SYSTEM_CONTRACT_ADDR = address(0x8008);
  :  |
     |  // @audit-issue Define a named constant instead of using `0x800a`
  27 |  address constant L2_BASE_TOKEN_SYSTEM_CONTRACT_ADDR = address(0x800a);
  :  |
     |  // @audit-issue Define a named constant instead of using `0x800b`
  30 |  address constant L2_SYSTEM_CONTEXT_SYSTEM_CONTRACT_ADDR = address(0x800b);
  :  |
     |  // @audit-issue Define a named constant instead of using `0x8011`
  33 |  address constant L2_PUBDATA_CHUNK_PUBLISHER_ADDR = address(0x8011);
```
GitHub: [6](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/L2ContractAddresses.sol#L6), [9](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/L2ContractAddresses.sol#L9), [12](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/L2ContractAddresses.sol#L12), [21](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/L2ContractAddresses.sol#L21), [24](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/L2ContractAddresses.sol#L24), [27](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/L2ContractAddresses.sol#L27), [30](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/L2ContractAddresses.sol#L30), [33](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/L2ContractAddresses.sol#L33)


```solidity
File: code/contracts/ethereum/contracts/common/Messaging.sol

     |  // @audit-issue Define a named constant instead of using `4`
 117 |  uint256[4] reserved;
```
GitHub: [117](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/Messaging.sol#L117)


## [N-117] `constant`s/`immutable`s redefined elsewhere

Consider defining in only one contract so that values cannot become out of sync when only one location is updated. A [cheap way](https://medium.com/coinmonks/gas-cost-of-solidity-library-functions-dbe0cedd4678) to store constants in a single location is to create an `internal constant` in a `library`. If the variable is a local cache of another contract's value, consider making the cache variable internal or private, which will require external users to query the contract with the source of truth, so that callers don't get out of sync.

*Instances: 10*

```solidity
File: code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol

     |  // @audit-info Duplicates of this constant variable were detected
  12 |  bytes32 private constant CREATE2_PREFIX = keccak256("zksyncCreate2");

File: code/contracts/zksync/contracts/L2ContractHelper.sol
     |  // @audit-issue First seen at code/contracts/ethereum/contracts/common/libraries/L2ContractHelper.sol:12
  85 |  bytes32 private constant CREATE2_PREFIX = keccak256("zksyncCreate2");
```
GitHub: [85](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/L2ContractHelper.sol#L85)


```solidity
File: code/system-contracts/contracts/Constants.sol

     |  // @audit-info Duplicates of this constant variable were detected
 157 |  uint256 constant MAX_NUMBER_OF_BLOBS = 2;

File: code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol
     |  // @audit-issue First seen at code/system-contracts/contracts/Constants.sol:157
  63 |  uint256 constant MAX_NUMBER_OF_BLOBS = 2;
```
GitHub: [63](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-interfaces/IExecutor.sol#L63)


```solidity
File: code/system-contracts/contracts/AccountCodeStorage.sol

     |      // @audit-info Duplicates of this constant variable were detected
  23 |      bytes32 constant EMPTY_STRING_KECCAK = 0xc5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470;

File: code/contracts/ethereum/contracts/common/Config.sol
     |  // @audit-issue First seen at code/system-contracts/contracts/AccountCodeStorage.sol:23
   8 |  bytes32 constant EMPTY_STRING_KECCAK = 0xc5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470;
```
GitHub: [8](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/common/Config.sol#L8)


```solidity
File: code/contracts/ethereum/contracts/common/Config.sol

     |  // @audit-info Duplicates of this constant variable were detected
  13 |  uint256 constant L2_TO_L1_LOG_SERIALIZE_SIZE = 88;

File: code/system-contracts/contracts/interfaces/IL1Messenger.sol
     |  // @audit-issue First seen at code/contracts/ethereum/contracts/common/Config.sol:13
  25 |  uint256 constant L2_TO_L1_LOG_SERIALIZE_SIZE = 88;
```
GitHub: [25](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL1Messenger.sol#L25)


```solidity
File: code/contracts/ethereum/contracts/common/Config.sol

     |  // @audit-info Duplicates of this constant variable were detected
  21 |  bytes32 constant L2_L1_LOGS_TREE_DEFAULT_LEAF_HASH = 0x72abee45b59e344af8a6e520241c4744aff26ed411f4c4b00f8af09adada43ba;

File: code/system-contracts/contracts/interfaces/IL1Messenger.sol
     |  // @audit-issue First seen at code/contracts/ethereum/contracts/common/Config.sol:21
  30 |  bytes32 constant L2_L1_LOGS_TREE_DEFAULT_LEAF_HASH = 0x72abee45b59e344af8a6e520241c4744aff26ed411f4c4b00f8af09adada43ba;
```
GitHub: [30](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/IL1Messenger.sol#L30)


```solidity
File: code/contracts/ethereum/contracts/common/Config.sol

     |  // @audit-info Duplicates of this constant variable were detected
 106 |  uint256 constant ERA_CHAIN_ID = 9;

File: code/contracts/zksync/contracts/Config.sol
     |  // @audit-issue First seen at code/contracts/ethereum/contracts/common/Config.sol:106
   8 |  uint256 constant ERA_CHAIN_ID = 9;
```
GitHub: [8](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/Config.sol#L8)


```solidity
File: code/system-contracts/contracts/Constants.sol

     |  // @audit-info Duplicates of this constant variable were detected
  63 |  address constant MSG_VALUE_SYSTEM_CONTRACT = address(SYSTEM_CONTRACTS_OFFSET + 0x09);

File: code/contracts/zksync/contracts/L2ContractHelper.sol
     |  // @audit-issue First seen at code/system-contracts/contracts/Constants.sol:63
  71 |  address constant MSG_VALUE_SYSTEM_CONTRACT = address(SYSTEM_CONTRACTS_OFFSET + 0x09);
```
GitHub: [71](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/L2ContractHelper.sol#L71)


```solidity
File: code/system-contracts/contracts/Constants.sol

     |  // @audit-info Duplicates of this constant variable were detected
  91 |  uint256 constant MSG_VALUE_SIMULATOR_IS_SYSTEM_BIT = 1;

File: code/contracts/zksync/contracts/SystemContractsCaller.sol
     |  // @audit-issue First seen at code/system-contracts/contracts/Constants.sol:91
  10 |  uint256 constant MSG_VALUE_SIMULATOR_IS_SYSTEM_BIT = 1;
```
GitHub: [10](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/SystemContractsCaller.sol#L10)


```solidity
File: code/contracts/zksync/contracts/SystemContractsCaller.sol

     |  // @audit-info Duplicates of this constant variable were detected
   7 |  address constant SYSTEM_CALL_CALL_ADDRESS = address((1 << 16) - 11);

File: code/system-contracts/contracts/libraries/SystemContractsCaller.sol
     |  // @audit-issue First seen at code/contracts/zksync/contracts/SystemContractsCaller.sol:7
  22 |  address constant SYSTEM_CALL_CALL_ADDRESS = address((1 << 16) - 11);
```
GitHub: [22](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/libraries/SystemContractsCaller.sol#L22)


```solidity
File: code/system-contracts/contracts/interfaces/IPaymaster.sol

     |  // @audit-info Duplicates of this constant variable were detected
  12 |  bytes4 constant PAYMASTER_VALIDATION_SUCCESS_MAGIC = IPaymaster.validateAndPayForPaymasterTransaction.selector;

File: code/contracts/zksync/contracts/interfaces/IPaymaster.sol
     |  // @audit-issue First seen at code/system-contracts/contracts/interfaces/IPaymaster.sol:12
  12 |  bytes4 constant PAYMASTER_VALIDATION_SUCCESS_MAGIC = IPaymaster.validateAndPayForPaymasterTransaction.selector;
```
GitHub: [12](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/interfaces/IPaymaster.sol#L12)


## [N-118] `public` functions not called by the contract should be declared `external` instead

Contracts [are allowed](https://docs.soliditylang.org/en/latest/contracts.html#function-overriding) to override their parents' functions and change the visibility from `external` to `public`.

*Instances: 19*

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol

     |  // @audit-info Context
  30 |  contract MailboxFacet is ZkSyncStateTransitionBase, IMailbox {
  :  |
     |      // @audit-issue Not called internally by this contract
  54 |      function proveL2MessageInclusion(
  55 |          uint256 _batchNumber,
  56 |          uint256 _index,
  57 |          L2Message memory _message,
  58 |          bytes32[] calldata _proof
  59 |      ) public view returns (bool) {
  :  |
     |      // @audit-issue Not called internally by this contract
  74 |      function proveL1ToL2TransactionStatus(
  75 |          bytes32 _l2TxHash,
  76 |          uint256 _l2BatchNumber,
  77 |          uint256 _l2MessageIndex,
  78 |          uint16 _l2TxNumberInBatch,
  79 |          bytes32[] calldata _merkleProof,
  80 |          TxStatus _status
  81 |      ) public view returns (bool) {
  :  |
     |      // @audit-issue Not called internally by this contract
 143 |      function l2TransactionBaseCost(
 144 |          uint256 _gasPrice,
 145 |          uint256 _l2GasLimit,
 146 |          uint256 _l2GasPerPubdataByteLimit
 147 |      ) public view returns (uint256) {
```
GitHub: [54-59](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L54-L59), [74-81](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L74-L81), [143-147](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Mailbox.sol#L143-L147)


```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol

     |  // @audit-info Context
  44 |  abstract contract BaseZkSyncUpgrade is ZkSyncStateTransitionBase {
  :  |
     |      // @audit-issue Not called internally by this contract
  67 |      function upgrade(ProposedUpgrade calldata _proposedUpgrade) public virtual returns (bytes32 txHash) {
```
GitHub: [67](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgrade.sol#L67)


```solidity
File: code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol

     |  // @audit-info Context
  17 |  abstract contract BaseZkSyncUpgradeGenesis is BaseZkSyncUpgrade {
  :  |
     |      // @audit-issue Not called internally by this contract
  47 |      function upgrade(ProposedUpgrade calldata _proposedUpgrade) public virtual override returns (bytes32) {
```
GitHub: [47](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/BaseZkSyncUpgradeGenesis.sol#L47)


```solidity
File: code/contracts/ethereum/contracts/upgrades/DefaultUpgrade.sol

     |  // @audit-info Context
  10 |  contract DefaultUpgrade is BaseZkSyncUpgrade {
  :  |
     |      // @audit-issue Not called internally by this contract
  13 |      function upgrade(ProposedUpgrade calldata _proposedUpgrade) public override returns (bytes32) {
```
GitHub: [13](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/DefaultUpgrade.sol#L13)


```solidity
File: code/contracts/ethereum/contracts/upgrades/GenesisUpgrade.sol

     |  // @audit-info Context
  11 |  contract GenesisUpgrade is BaseZkSyncUpgradeGenesis {
  :  |
     |      // @audit-issue Not called internally by this contract
  14 |      function upgrade(ProposedUpgrade calldata _proposedUpgrade) public override returns (bytes32) {
```
GitHub: [14](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/GenesisUpgrade.sol#L14)


```solidity
File: code/contracts/ethereum/contracts/upgrades/Upgrade_4844.sol

     |  // @audit-info Context
  12 |  contract Upgrade_4844 is BaseZkSyncUpgrade {
  :  |
     |      // @audit-issue Not called internally by this contract
  15 |      function upgrade(ProposedUpgrade calldata _proposedUpgrade) public override returns (bytes32) {
```
GitHub: [15](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/Upgrade_4844.sol#L15)


```solidity
File: code/contracts/ethereum/contracts/upgrades/Upgrade_v1_4_1.sol

     |  // @audit-info Context
  13 |  contract Upgrade_v1_4_1 is BaseZkSyncUpgrade {
  :  |
     |      // @audit-issue Not called internally by this contract
  33 |      function upgrade(ProposedUpgrade calldata _proposedUpgrade) public override returns (bytes32) {
```
GitHub: [33](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/upgrades/Upgrade_v1_4_1.sol#L33)


```solidity
File: code/system-contracts/contracts/ContractDeployer.sol

     |  // @audit-info Context
  23 |  contract ContractDeployer is IContractDeployer, ISystemContract {
  :  |
     |      // @audit-issue Not called internally by this contract
  40 |      function extendedAccountVersion(address _address) public view returns (AccountAbstractionVersion) {
```
GitHub: [40](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/ContractDeployer.sol#L40)


```solidity
File: code/system-contracts/contracts/NonceHolder.sol

     |  // @audit-info Context
  27 |  contract NonceHolder is INonceHolder, ISystemContract {
  :  |
     |      // @audit-issue Not called internally by this contract
  57 |      function getRawNonce(address _address) public view returns (uint256) {
  :  |
     |      // @audit-issue Not called internally by this contract
  65 |      function increaseMinNonce(uint256 _value) public onlySystemCall returns (uint256 oldMinNonce) {
  :  |
     |      // @audit-issue Not called internally by this contract
  82 |      function setValueUnderNonce(uint256 _key, uint256 _value) public onlySystemCall {
  :  |
     |      // @audit-issue Not called internally by this contract
 102 |      function getValueUnderNonce(uint256 _key) public view returns (uint256) {
```
GitHub: [57](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/NonceHolder.sol#L57), [65](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/NonceHolder.sol#L65), [82](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/NonceHolder.sol#L82), [102](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/NonceHolder.sol#L102)


```solidity
File: code/system-contracts/contracts/SystemContext.sol

     |  // @audit-info Context
  17 |  contract SystemContext is ISystemContext, ISystemContextDeprecated, ISystemContract {
  :  |
     |      // @audit-issue Not called internally by this contract
 190 |      function getBlockNumber() public view returns (uint128) {
  :  |
     |      // @audit-issue Not called internally by this contract
 198 |      function getBlockTimestamp() public view returns (uint128) {
```
GitHub: [190](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L190), [198](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/SystemContext.sol#L198)


```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

     |  // @audit-info Context
  15 |  contract L2StandardERC20 is ERC20PermitUpgradeable, IL2StandardToken, ERC1967Upgrade {
  :  |
     |      // @audit-issue Not called internally by this contract
 159 |      function name() public view override returns (string memory) {
  :  |
     |      // @audit-issue Not called internally by this contract
 165 |      function symbol() public view override returns (string memory) {
  :  |
     |      // @audit-issue Not called internally by this contract
 171 |      function decimals() public view override returns (uint8) {
```
GitHub: [159](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L159), [165](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L165), [171](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L171)


## [N-119] `require()`/`revert()` statements should have descriptive reason strings

The error message should clearly state _how_/_why_ something is an error, not just that a specific error state was reached; someone shouldn't have to read the code in order to see how to resolve the problem.

*Instances: 5*

```solidity
File: code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol

     |  // @audit-issue Add an error description, ideally with a custom error
  51 |  require(_newBatch.pubdataCommitments.length == 1);
```
GitHub: [51](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/ethereum/contracts/state-transition/chain-deps/facets/Executor.sol#L51)


```solidity
File: code/system-contracts/contracts/interfaces/ISystemContract.sol

     |  // @audit-issue Add an error description, ideally with a custom error
  55 |  require(msg.sender == FORCE_DEPLOYER);
```
GitHub: [55](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/interfaces/ISystemContract.sol#L55)


```solidity
File: code/contracts/zksync/contracts/bridge/L2StandardERC20.sol

     |  // @audit-issue Add an error description, ideally with a custom error
 161 |  if (availableGetters.ignoreName) revert();

     |  // @audit-issue Add an error description, ideally with a custom error
 167 |  if (availableGetters.ignoreSymbol) revert();

     |  // @audit-issue Add an error description, ideally with a custom error
 173 |  if (availableGetters.ignoreDecimals) revert();
```
GitHub: [161](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L161), [167](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L167), [173](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/contracts/zksync/contracts/bridge/L2StandardERC20.sol#L173)


## [N-120] `return <parameter>` is redundant when `parameter` is a function return parameter

If you're using named return variables, and assigning those return variables, there is no need to explicitly use the `return` statement.

*Instances: 1*

```solidity
File: code/system-contracts/contracts/NonceHolder.sol

     |  // @audit-info This function declares a return parameter
 125 |  function getDeploymentNonce(address _address) external view returns (uint256 deploymentNonce) {
  :  |
     |      // @audit-issue This return statement is redundant since it returns the solo return parameter itself
 129 |      return deploymentNonce;
```
GitHub: [129](https://github.com/code-423n4/2024-03-zksync/blob/4f0ba34f34a864c354c7e8c47643ed8f4a250e13/code/system-contracts/contracts/NonceHolder.sol#L129)
